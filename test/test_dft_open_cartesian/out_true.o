 ----------------------------------------------------------------------------
 TurboRVB version 1.0.0  git rev. N/A                                     
 
   Ab-initio Quantum Monte Carlo Package
 
     Developer: Sandro Sorella
     Website: https://turborvb.sissa.it
     GitHub: https://github.com/sissaschool/turborvb
     Project PIs: Michele Casula and Kosuke Nakano
     Contacts: michele.casula@gmail.com and kousuke_1123@icloud.com
 
   When you publish a paper using TurboRVB, please cite the following paper.
 
     TurboRVB: a many-body toolkit for ab initio electronic simulations,
     K. Nakano*, C. Attaccalite, M. Barborini, L. Capriotti, M. Casula*,
     E. Coccia, M. Dagrada, Y. Luo, G. Mazzola, A. Zen, and S. Sorella*,
     J. Chem. Phys. 152, 204121 (2020), doi:10.1063/5.0005037
 
 ----------------------------------------------------------------------------
  Number of threads /mpi proc =           1
  Warning init. value of threads/mpi task           1
  Initial path : 
 /app/minicode/test/test_dft_open_cartesian                                     
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                     
  After  reading simulation  
  Default value of pseudorandom = T
  After reading pseudo 
  Pseudopotential file name : pseudo.dat
  Read value of epscut   1.000000000000000E-005
  After reading vmc 
  Default value of parcut =   0.000000000000000E+000
  After reading optimization   
  Default value of epsdgel =  1.000000000000000E-003
  Default value of nweight for forces nweight X           -1
  Default value for tolcg   =  1.000000000000000E-006
  Default value for minzj =  -1000.00000000000     
  Default value of minimum one-two body Jastrow =  5.000000000000000E-002
  After reading readio 
  Default value of  iread            0
  Default value of epsbas =  1.000000000000000E-009
  After reading parameters 
  Default value of add_pulay =           2
  Default value for ieser=           0
  Basis set cutoff chosen:  1.000000000000000E-009
  after parameters   
  Parameters: iesinv,iesm,iesd,iesfree,iessw,iesup,ieskin 
  Parameters before read            0           0           0           0
           0           0           0
  Reading the begin in fast. . . . 
  Reading zeta and rion  in fast . . . . 
  Reading ieskin in fast. . . . 
  Reading 2-body jastrow in fast . . . . 
  Reading det shells in fast. . . . 
  Reading jas shells in fast. . . . 
  Reading det occupation in fast. . . .           35
  Reading jas occupation in fast. . . .            0
  Reading det nnozero in fast. . . . 
  Reading det nnozero symmetries in fast....
  Reading jas nnozero in fast....
  Reading jas nnozero symmetries in fast....
  Reading Z-det  symmetries in fast....
  Reading Z-jas  symmetries in fast....
  Warning NO DMC cutoff on the local energy
  Default value of epscuttype=            2
  Read value of epscut=  1.000000000000000E-005
  Default value of tstep=   2.00000000000000     
  Read value for nintpsa            0
  Parameters after  read            0           0           0           0
           0           0           0           0
  Default value of prep           0
  Default value for nscra            6
  Default value for nbra            8
  Warning ncg<= #parameters!, changed to            0
  kl read =          -7
  before dynamic 
  Fixing the parameters EACH TIME 
  Total number of bins per processor =           1
  Collective + normal  parameters 
  np read =           0
  Warning srcomplex turned to false (real case) 
 
  tparf =  0.350000000000000     
 Default cutoff on the weight =  0.000000000000000E+000
 itestrfn =          -5
  
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
     from  prep  : Warning #        -1
     Warning   Scratch files not written 
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  Scratch extension ./scratch
 
  START reading the wave function fort.10 
 
  Reading the begin . . . . 
  Number of different atomic species =           1
  Open Boundary Conditions 
  Reading ieskin . . . . 
 Number of moved ionic coordinates           2
  Reading 2-body jastrow . . . . 
 opposite phase = F
 same  phase = T
 yes_hermite before = F
  Reading det shells . . . . 
 Warn. Ions are not in ascending order in Det !
 Check shell det =          17
 USING           1 CONTRACTED DET ORBITALS
 USING           1 MOLECULAR  DET ORBITALS
  iesup dimension  atomic basis =          16          84
  Reading jas shells . . . . 
  USING UNCONTRACTED JASTROW ORBITALS 
  Reading det occupation . . . . 
 Number of total det orbitals          35
 Number of occupied det orbitals          35
  Preliminary allocation   2.016000000000000E-006
  transpip =  6.560000000000001E-007
 Number of total det orbitals (root)          34
 Number of occupied det orbitals (root)          34
  Reading jas occupation . . . . 
 Number of total Jas orbitals           0
 Number of occupied Jas orbitals           0
  Before allocation standard 
  nion =            2
  nel =            2
  indt=           0
  npm=            1
  nwm=            1
  nws=            1
  nelorbj=            0
  iscrapip=            7
  iscraipsip=          253
  nelorb=           34
  nelcol=           34
  nelup=            1
  nelorb_c=           35
  nelorbj_c=            0
  nelcol_c=           35
  nshell=           16
  nshellj=            0
  npsamax=            4
  nintpseudo=            0
  Memory required DFT =  1.618400000000000E-005 Gbyte
  Memory winv =  1.360000000000000E-006
  iscramax for master =          259
  Reading det nnozero . . . . 
  Reading det nnozero symmetries ....
 Number of non zero geminal lambda for det          126
 Number of non fixed geminal lambda for det         126
 Number of non zero lambda (root)         595
  Reading jas nnozero ....
 Location constant orbitals in Jastrow
  Reading jas nnozero symmetries ....           0
 Number of non zero geminal lambda for Jas           0
 Number of non fixed geminal lambda for Jas           0
  Number of accepted nnozeron Jas Sz            0
  Check repeated in the symmetry table Jastrow  
  Reading Z-AGP symmetries ....
  Touched det zeta par =           8
  Touched Jas zeta par =           0
  Time spent in  update_kgrid=  9.536743164062500E-007
  Warning number niesd suggested (# par one/two body Jastrow) =            2
  in such case one has an independent one body for each different  atomic specie
  scale one body = -0.915879398033504     
 
  END reading the wave function fort.10 
 
  symmagp = T
 Number 1body Jastrow parameters:            1
           1   1.00000000000000     
  initial costz, costz3, zeta_Q_Caffarel 
           1   1.18920711500272        1.68179283050743     
   1.00000000000000     
           2   1.18920711500272        1.68179283050743     
   1.00000000000000     
  After reading molecul 
  Warning yesavopt forced to false with mol optimiz.!!! 
  Default value of nmol            1
  Default value of nmolmin            1
  Default value of nmolmax            1
  after  read molec 
  Default value of nmolmaxw=           1
  error converter    1.000000000000000E-014
  # mesh read           50          30          30
 Default value for buffer =        1000
  lattice mesh read ax,ay,az   0.250000000000000       0.250000000000000     
  0.250000000000000     
 # molecular orbital Det considered/projected
           1           1           1
  Default value of shift_origin T
  Default value for relative machine precision =  1.110223024625157E-016
  mixing used =  0.500000000000000     
  Default value of typedft  =           1
  Default value of mixingder =  5.000000000000000E-002
  Warning epsover used =  1.000000000000000E-013
  maxold used =           3
  Warning epssr set to zero in this case 
  decoupled run = F
  Warning corr_hartree set to false
 
   CALCULATION INFORMATION 
 # Hartree Atomic Units used
 # computation type  = single phase                  
 # iopt              =     1
 # memlarge          =  F
 # basis type        = OPEN 
 # basis dim         =         34
 # Number MOs        =          1
 # contracted_on     =  F
 # One-body Jastrow  =     1
 # typedft           =     1
 # typeopt           =     4
 # spin calculation  =  F
 # external H charge field  =  0.00000
 # bands             =     2
 # mixing            =   0.50000
 # optocc            =     0
 # smearing          =   0.00000000
 # k-points          =     1
 # Optimize overlaps   =  T
 
 
  --------------------------------------------
      DFT calculation - Gamma point calculation 
  --------------------------------------------
 
  Minimum ion-mesh distance =  0.197735241593094     
  Origin shift used =  -6.00000000000000       -3.62500000000000     
  -3.62500000000000     
 New center of mesh =  0.125000000000000       0.000000000000000E+000
  0.000000000000000E+000
  Total number of buffers (lower bound)           45
  after initialize_mesh 
  after initialize molecorb  F
  after initialize dent  F
  Warning if you do not see after initialize fourier, try to use larger OMP_NUM_
 THREADS  
  after initialize fourier 
 
  Total occupation UP read from std input
           1   2.00000000000000     
           2  0.000000000000000E+000
  Read last occupied paired orbital =           1
 Asymptotic value of one-body dft pot =        0.7559674441
 Read molecular orbitals     1     1    35    34     2
 Molecorb read:          0.18093492E+01
  Correction Coulomb =  0.176809131489431     
 0.10830E-03 Gbyte per MPI task for threading in initialize_mats_new!
 0.81600E-03 Gbyte per MPI task for the buffer, proportional to nbufd!
 0.13600E-05 Gbyte per MPI task for the buffer, proportional to threads!
 Computing overlap matrices:
 double_overs/same_phase:   F  T
  scale one body = -0.915879398033504     
 Buf number =     1 taking     0.01 sec.
 Buf number =     2 taking     0.01 sec.
 Buf number =     3 taking     0.01 sec.
 Buf number =     4 taking     0.01 sec.
 Buf number =     5 taking     0.01 sec.
 Buf number =     6 taking     0.01 sec.
 Buf number =     7 taking     0.01 sec.
 Buf number =     8 taking     0.01 sec.
 Buf number =     9 taking     0.01 sec.
 Buf number =    10 taking     0.00 sec.
 Buf number =    11 taking     0.00 sec.
 Buf number =    12 taking     0.00 sec.
 Buf number =    13 taking     0.00 sec.
 Buf number =    14 taking     0.00 sec.
 Buf number =    15 taking     0.00 sec.
 Buf number =    16 taking     0.00 sec.
 Buf number =    17 taking     0.00 sec.
 Buf number =    18 taking     0.00 sec.
 Buf number =    19 taking     0.00 sec.
 Buf number =    20 taking     0.00 sec.
 Buf number =    21 taking     0.00 sec.
 Buf number =    22 taking     0.00 sec.
 Buf number =    23 taking     0.00 sec.
 Buf number =    24 taking     0.00 sec.
 Buf number =    25 taking     0.00 sec.
 Buf number =    26 taking     0.00 sec.
 Buf number =    27 taking     0.00 sec.
 Buf number =    28 taking     0.00 sec.
 Buf number =    29 taking     0.00 sec.
 Buf number =    30 taking     0.00 sec.
 Buf number =    31 taking     0.00 sec.
 Buf number =    32 taking     0.00 sec.
 Buf number =    33 taking     0.00 sec.
 Buf number =    34 taking     0.00 sec.
 Buf number =    35 taking     0.00 sec.
 Buf number =    36 taking     0.00 sec.
 Buf number =    37 taking     0.00 sec.
 Buf number =    38 taking     0.00 sec.
 Buf number =    39 taking     0.00 sec.
 Buf number =    40 taking     0.00 sec.
 Buf number =    41 taking     0.00 sec.
 Buf number =    42 taking     0.00 sec.
 Buf number =    43 taking     0.00 sec.
 Buf number =    44 taking     0.00 sec.
 Buf number =    45 taking     0.00 sec.
 overlap/hamiltonian matrix elements computed
  q=0 contribution Ewald (H)  =  0.000000000000000E+000   6.28318530717959     
 Total time initialization =  0.171569108963013     
  Eigenvalue one body Ham  
 
 Check matrix elements sum: 
  overs       66.6446186548540     
  overham    -117.292196864084     
  oversdo    0.000000000000000E+000
  overhamdo  0.000000000000000E+000
  hamilt     0.000000000000000E+000
 
  Lowest/Max  eigenvalue overlap mat =  2.772488728013528E-004
   3.96816105521753     
  Condition number basis set =  6.986835184948259E-005
  Optimal lwork  found =         918
 Total occupations found up/down:        2.0000000000        0.0000000000
 
 Eigenvalues/occupations before starting SC cycle 
 
 # k-point:    0.00000000  0.00000000  0.00000000
            1       -17.6126147983        2.0000000000
            2       -17.0595628252        0.0000000000
 
    Fermi energy:             -17.33608881
    Entropic contribution:      0.00000000
 Total charge:           2.000000
  Spin variance before =  0.000000000000000E+000
  |spin|  =  0.000000000000000E+000
  Efree   -35.2252295966495     
 DFT initialization OK 
 # Molecorb start:                  4.249825
  
  ------------------------------ 
         Starting SC cycle       
  ------------------------------ 
  
 Total occupations found up/down:        2.0000000000        0.0000000000
 
    Fermi energy:             -14.12910384
    Entropic contribution:      0.00000000
 
 Iter,E,xc,corr     1       -32.3132356        -2.8116832        -0.1686544         2.9119940
 
 Total charge:           2.000000
  Full norm correction before =  3.476947276401199E-006
 Total occupations found up/down:        2.0000000000        0.0000000000
 
    Fermi energy:             -14.13069236
    Entropic contribution:      0.00000000
  Full norm correction after  =  3.052707448055237E-006
  jac diag= -7.178790863093814E-007
 Norm corr.=     1        0.0007937586
  Warning simple mixing =  0.425686009368853     
 Total charge:           2.000000
 Total occupations found up/down:        2.0000000000        0.0000000000
 
    Fermi energy:             -14.14252698
    Entropic contribution:      0.00000000
 
 Iter,E,xc,corr     2       -32.3131199        -2.7968226        -0.1682179         0.0001157
 
 Total charge:           2.000000
  Full norm correction before =  2.733293613031752E-006
 Total occupations found up/down:        2.0000000000        0.0000000000
 
    Fermi energy:             -14.14344880
    Entropic contribution:      0.00000000
  Full norm correction after  =  1.298801073164567E-006
  jac diag= -4.053191568509362E-005 -1.935624709668505E-006
 Norm corr.=     2        0.0005296461
  Warning last mixing =   2.72315780073842     
 Total charge:           2.000000
 Total occupations found up/down:        2.0000000000        0.0000000000
 
    Fermi energy:             -14.15146664
    Entropic contribution:      0.00000000
 
 Iter,E,xc,corr     3       -32.3130528        -2.7869735        -0.1679284         0.0000671
 
 Total charge:           2.000000
  Full norm correction before =  2.803754094765289E-007
 Total occupations found up/down:        2.0000000000        0.0000000000
 
    Fermi energy:             -14.15190837
    Entropic contribution:      0.00000000
  Full norm correction after  =  2.449615945066339E-007
  jac diag= -1.034121541174215E-004 -1.049166892912521E-006
  4.758276040322888E-015
 Norm corr.=     3        0.0002584098
  Warning last mixing =  -281.823132735642     
 Total charge:           2.000000
 Total occupations found up/down:        2.0000000000        0.0000000000
 
    Fermi energy:             -14.15608926
    Entropic contribution:      0.00000000
 
 Iter,E,xc,corr     4       -32.3130406        -2.7820511        -0.1677848         0.0000123
 
 Total charge:           2.000000
  Full norm correction before =  6.683527435095086E-008
 Total occupations found up/down:        2.0000000000        0.0000000000
 
    Fermi energy:             -14.15630532
    Entropic contribution:      0.00000000
  Full norm correction after  =  6.016931453141681E-008
  jac diag= -3.821744868215404E-005 -6.998923877512186E-008
 -6.662138083216155E-011
 Norm corr.=     4        0.0001284153
  Warning last mixing =   12.6178762760372     
 Total charge:           2.000000
 Total occupations found up/down:        2.0000000000        0.0000000000
 
    Fermi energy:             -14.15822269
    Entropic contribution:      0.00000000
 
 Iter,E,xc,corr     5       -32.3130377        -2.7796464        -0.1677144         0.0000029
 
 Total charge:           2.000000
  Full norm correction before =  1.649155723331469E-008
 Total occupations found up/down:        2.0000000000        0.0000000000
 
    Fermi energy:             -14.15832826
    Entropic contribution:      0.00000000
  Full norm correction after  =  1.486491650307479E-008
  jac diag= -9.192114677780702E-006 -3.870221128050366E-009
 -3.931332393604530E-013
 Norm corr.=     5        0.0000638375
  Warning last mixing =  -2.08292762550928     
 Total charge:           2.000000
  
  ------------------------ 
      SC cycle completed   
  ------------------------ 
  
  Sorted eigenvalues/occupations up 
           1  -14.4631815542715        2.00000000000000     
           2  -13.8532638319445       0.000000000000000E+000
  Check orthogonality h psi with psi i =/ j   0.000000000000000E+000
  Variational energy without orth.   -32.3130366846186     
  Variational const with no orth.   -3.38227558744281     
  Final molecorb written    4.62515994777317     
 OK Turbo-DFT converged  with energy tollerance              0.000002928230515 <           0.000009999999747
 # Iterations =     5
 Final variational DFT  energy (Ha) =           -32.313036684618638
 Final self consistent energy (Ha) =          -32.313037654234648
 Final exchange  energy            =           -2.777243108842488
 Final correlation  energy         =           -0.167643986924337
 Final Fermi energy  =          -14.158328259481893 Ha =        -385.267738866248784 eV
 Final Hartree energy(H)  =            5.081576400016431
 
 Turbo-DFT TIMINGS 
 Total time (sec.)  =            2.355763196945190
 Total initialization time (sec.)  =            0.171569108963013
 Total loading time matrices (sec.)  =            1.420242547988892
 Total diagonalization  time (sec.) =            0.000649690628052
 Total/Upload FFT  time (sec.) =            0.142464637756348           0.000000000000000
 Total self-consistent cycle time (sec.)  =            1.805390119552612
 Total density symmetrization time (sec.) =            0.000000000000000
 Total time dgemm =            0.045932531356812
 
 
 Write the parameters of the final wavefunction!
  Passi qui from real to eff V 
  Passi qui from eff to real  VI 
