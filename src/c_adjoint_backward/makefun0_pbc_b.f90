

!###########################################################
!#                                                         #
!#     This is code was generated by preprocess script     #
!#                                                         #
!###########################################################

    !TL off
!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.3 (r3163) - 09/25/2009 09:03
!
!  Differentiation of makefun_pbc in reverse (adjoint) mode:
!   gradient, with respect to input variables: dd r sinphase rphase
!                z cellscale rmusin rmucos rmu cosphase distp
!   of linear combination of output variables: dd r sinphase rphase
!                z cellscale rmusin rmucos rmu cosphase
SUBROUTINE makefun0_pbc_b (iopt,iocc,indt,typec,indpar,indorb,indshell,nelskip,z,zb,dd,ddb,r,rb,rmu,rmub,distp,distpb,iflagnorm_fake,c,rmucos,rmucosb,rmusin,rmusinb,sinphase,sinphaseb,cosphase,cosphaseb,cellscale,cellscaleb,rphase,rphaseb)

  USE CONSTANTS
  IMPLICIT NONE
! TAPENADE adBuffer vars
  integer :: adi4ibuf,adr8ibuf,adi4buf(1024)
  real*8  :: adr8buf(1024)
! ---
! Add these input variables
  DOUBLE PRECISION, INTENT(IN) :: cellscale(3), rphase(3)
  DOUBLE PRECISION :: cellscaleb(3), rphaseb(3)
! ---
  INTEGER, INTENT(IN) :: iopt, iocc(*), nelskip, indt, iflagnorm_fake,   typec
  INTEGER :: i, k, indpar, indorbp, indorb, indshell, indshellp, ic, indparp
  DOUBLE PRECISION :: z(nelskip, 0:*)
  DOUBLE PRECISION :: zb(nelskip, 0:*)
  DOUBLE PRECISION, INTENT(IN) :: rmu(3, 0:0), r(0:0), rmucos(3  , 0:0), rmusin(3, 0:0), sinphase(3, 0:0), cosphase(0:0  )
  DOUBLE PRECISION :: rmub(3, 0:0), rb(0:0), rmucosb(3, 0:0)  , rmusinb(3, 0:0), sinphaseb(3, 0:0), cosphaseb(0:0)
  REAL*8 :: distp(0:0, 20), fun, fun0, fun2, rp0, rp1, rp2, dd1, dd2  , c, DSQRT, c0, c1, dd(*), hess3d(3, 5), radhess4f(3), der4f(2),   hess4f(3)
  REAL*8 :: distpb(0:0, 20), funb, fun0b, fun2b, rp0b, rp1b, rp2b,   dd1b, dd2b, cb, c0b, c1b, ddb(*), hess3db(3, 5), radhess4fb(3), der4fb  (2), hess4fb(3)
  REAL*8 :: hess(3), fun3
  REAL*8 :: hessb(3), fun3b
  INTEGER :: npower
  INTEGER :: branch
  DOUBLE PRECISION :: temp3(3)
  DOUBLE PRECISION :: temp29(3)
  REAL*8 :: temp79b3
  DOUBLE PRECISION :: temp81b0
  DOUBLE PRECISION :: temp153b
  REAL*8 :: temp155b0
  REAL*8 :: temp204b29
  DOUBLE PRECISION :: temp214b4
  REAL*8 :: temp236b0
  REAL*8 :: temp296
  DOUBLE PRECISION :: temp340
  DOUBLE PRECISION :: temp377
  DOUBLE PRECISION :: temp421
  REAL*8 :: temp432b2
  REAL*8 :: temp451b16
  DOUBLE PRECISION :: temp458
  DOUBLE PRECISION :: temp502
  DOUBLE PRECISION :: temp539
  REAL*8 :: temp582b11
  REAL*8 :: temp719b19
  REAL*8 :: temp731b0
  REAL*8 :: temp768b0
  REAL*8 :: temp766b
  REAL*8 :: temp778b9
  DOUBLE PRECISION :: temp791
  DOUBLE PRECISION :: temp810b
  DOUBLE PRECISION :: temp847b
  REAL*8 :: temp861b6
  REAL*8 :: temp866b1
  REAL*8 :: temp872
  REAL*8 :: temp883b2
  DOUBLE PRECISION :: temp953
  REAL*8 :: temp947b1
  REAL*8 :: temp981b3
  REAL*8 :: temp1008b11
  REAL*8 :: temp1020b4
  REAL*8 :: temp1030b34
  REAL*8 :: temp1042b0
  REAL*8 :: temp1080
  REAL*8 :: temp1079b0
  REAL*8 :: temp1123b0
  REAL*8 :: temp1140b1
  REAL*8 :: temp1161
  DOUBLE PRECISION :: temp1198
  REAL*8 :: temp1217b
  DOUBLE PRECISION :: temp1242
  REAL*8 :: temp1258b1
  DOUBLE PRECISION :: temp1279
  REAL*8 :: temp1302b1
  DOUBLE PRECISION :: temp1323
  DOUBLE PRECISION :: temp1404
  REAL*8 :: temp1493b0
  REAL*8 :: temp1587b
  REAL*8 :: temp1655b0
  REAL*8 :: temp1693
  REAL*8 :: temp1712b
  REAL*8 :: temp1745b22
  DOUBLE PRECISION :: temp1749b
  REAL*8 :: temp1770b2
  DOUBLE PRECISION :: temp1774
  REAL*8 :: temp1792b11
  DOUBLE PRECISION :: temp2(3)
  DOUBLE PRECISION :: temp28(3)
  REAL*8 :: temp79b2(3)
  REAL*8 :: temp161b
  REAL*8 :: temp204b28
  REAL*8 :: temp214b3
  REAL*8 :: temp242b
  REAL*8 :: temp279b
  DOUBLE PRECISION :: temp295
  DOUBLE PRECISION :: temp376
  REAL*8 :: temp420
  REAL*8 :: temp432b1
  REAL*8 :: temp451b15
  REAL*8 :: temp457
  DOUBLE PRECISION :: temp486b2
  DOUBLE PRECISION :: temp501
  REAL*8 :: temp538
  REAL*8 :: temp582b10
  DOUBLE PRECISION :: temp619
  DOUBLE PRECISION :: temp693b
  REAL*8 :: temp719b18
  REAL*8 :: temp774b
  REAL*8 :: temp778b8
  DOUBLE PRECISION :: temp790
  REAL*8 :: temp861b5
  REAL*8 :: temp866b0
  DOUBLE PRECISION :: temp871
  REAL*8 :: temp883b1
  REAL*8 :: temp910b0
  REAL*8 :: temp936b
  DOUBLE PRECISION :: temp952
  REAL*8 :: temp947b0
  REAL*8 :: temp981b2
  DOUBLE PRECISION :: temp989
  REAL*8 :: temp1008b10
  REAL*8 :: temp1020b3
  REAL*8 :: temp1030b33
  REAL*8 :: temp1063b
  REAL*8 :: temp1101b3
  REAL*8 :: temp1140b0
  REAL*8 :: temp1144b
  DOUBLE PRECISION :: temp1160
  DOUBLE PRECISION :: temp1197
  REAL*8 :: temp1221b0
  DOUBLE PRECISION :: temp1241
  REAL*8 :: temp1258b0
  DOUBLE PRECISION :: temp1278
  REAL*8 :: temp1302b0
  DOUBLE PRECISION :: temp1306b
  DOUBLE PRECISION :: temp1322
  DOUBLE PRECISION :: temp1359
  REAL*8 :: temp1400b1
  DOUBLE PRECISION :: temp1403
  REAL*8 :: temp1591b0
  REAL*8 :: temp1595b
  REAL*8 :: temp1676b
  DOUBLE PRECISION :: temp1692
  REAL*8 :: temp1720b
  REAL*8 :: temp1745b21
  REAL*8 :: temp1753b0
  REAL*8 :: temp1770b1
  DOUBLE PRECISION :: temp1773
  REAL*8 :: temp1792b10
  REAL*8 :: temp1834b0
  REAL*8 :: temp1838b
  REAL*8 :: temp1
  DOUBLE PRECISION :: temp27(3)
  REAL*8 :: temp79b1(3)
  DOUBLE PRECISION :: temp133b2
  REAL*8 :: temp204b27
  REAL*8 :: temp214b2
  DOUBLE PRECISION :: temp250b
  REAL*8 :: temp287b
  DOUBLE PRECISION :: temp294
  REAL*8 :: temp331b
  REAL*8 :: temp375
  REAL*8 :: temp412b
  REAL*8 :: temp432b0
  REAL*8 :: temp449b
  REAL*8 :: temp451b14
  DOUBLE PRECISION :: temp456
  DOUBLE PRECISION :: temp486b1
  REAL*8 :: temp500
  REAL*8 :: temp537
  REAL*8 :: temp567b1
  DOUBLE PRECISION :: temp618
  DOUBLE PRECISION :: temp611b1
  REAL*8 :: temp719b17
  REAL*8 :: temp778b7
  DOUBLE PRECISION :: temp782b
  REAL*8 :: temp861b4
  REAL*8 :: temp863b
  DOUBLE PRECISION :: temp870
  REAL*8 :: temp883b0
  DOUBLE PRECISION :: temp951
  REAL*8 :: temp981b1
  REAL*8 :: temp979b4
  DOUBLE PRECISION :: temp988
  DOUBLE PRECISION :: temp1018b5
  REAL*8 :: temp1020b2
  REAL*8 :: temp1030b32
  REAL*8 :: temp1101b2
  DOUBLE PRECISION :: temp1152b
  DOUBLE PRECISION :: temp1196
  REAL*8 :: temp1189b
  REAL*8 :: temp1233b
  DOUBLE PRECISION :: temp1240
  REAL*8 :: temp1277
  REAL*8 :: temp1292b1
  DOUBLE PRECISION :: temp1321
  DOUBLE PRECISION :: temp1358
  REAL*8 :: temp1356b0
  DOUBLE PRECISION :: temp1402
  REAL*8 :: temp1400b0
  DOUBLE PRECISION :: temp1439
  REAL*8 :: temp1454b1
  REAL*8 :: temp1633b2
  DOUBLE PRECISION :: temp1684b
  REAL*8 :: temp1691
  REAL*8 :: temp1745b20
  DOUBLE PRECISION :: temp1765b
  REAL*8 :: temp1770b0
  DOUBLE PRECISION :: temp1772
  REAL*8 :: temp1846b
  REAL*8 :: temp0
  DOUBLE PRECISION :: temp26(3)
  REAL*8 :: temp79b0(3)
  DOUBLE PRECISION :: temp133b1
  REAL*8 :: temp204b26
  REAL*8 :: temp214b1
  DOUBLE PRECISION :: temp293
  DOUBLE PRECISION :: temp295b
  DOUBLE PRECISION :: temp374
  REAL*8 :: temp376b
  REAL*8 :: temp451b13
  REAL*8 :: temp455
  REAL*8 :: temp457b
  DOUBLE PRECISION :: temp486b0
  DOUBLE PRECISION :: temp501b
  DOUBLE PRECISION :: temp536
  REAL*8 :: temp538b
  REAL*8 :: temp567b0
  DOUBLE PRECISION :: temp617
  DOUBLE PRECISION :: temp611b0
  DOUBLE PRECISION :: temp619b
  REAL*8 :: temp665b1
  REAL*8 :: temp719b16
  REAL*8 :: temp778b6
  DOUBLE PRECISION :: temp780b3
  REAL*8 :: temp827b1
  REAL*8 :: temp861b3
  DOUBLE PRECISION :: temp871b
  DOUBLE PRECISION :: temp950
  REAL*8 :: temp981b0
  DOUBLE PRECISION :: temp979b3
  DOUBLE PRECISION :: temp987
  REAL*8 :: temp989b
  REAL*8 :: temp1003b0
  REAL*8 :: temp1018b4
  REAL*8 :: temp1020b1
  REAL*8 :: temp1030b31
  REAL*8 :: temp1101b1
  REAL*8 :: temp1138b1
  DOUBLE PRECISION :: temp1195
  REAL*8 :: temp1197b
  REAL*8 :: temp1241b
  DOUBLE PRECISION :: temp1276
  REAL*8 :: temp1292b0
  DOUBLE PRECISION :: temp1320
  DOUBLE PRECISION :: temp1322b
  DOUBLE PRECISION :: temp1357
  DOUBLE PRECISION :: temp1401
  DOUBLE PRECISION :: temp1403b
  REAL*8 :: temp1438
  REAL*8 :: temp1454b0
  REAL*8 :: temp1471b1
  DOUBLE PRECISION :: temp1519
  REAL*8 :: temp1616b0
  REAL*8 :: temp1633b1
  DOUBLE PRECISION :: temp1690
  REAL*8 :: temp1767b16
  DOUBLE PRECISION :: temp1771
  DOUBLE PRECISION :: temp1773b
  REAL*8 :: temp1812b2
  REAL*8 :: temp25
  REAL*8 :: temp58b(3)
  DOUBLE PRECISION :: temp133b0
  REAL*8 :: temp187b1
  REAL*8 :: temp204b25
  REAL*8 :: temp214b0
  REAL*8 :: temp292
  DOUBLE PRECISION :: temp373
  REAL*8 :: temp451b12
  DOUBLE PRECISION :: temp454
  DOUBLE PRECISION :: temp535
  DOUBLE PRECISION :: temp616
  REAL*8 :: temp665b0
  REAL*8 :: temp708b
  REAL*8 :: temp702b8
  REAL*8 :: temp719b15
  REAL*8 :: temp748b22
  REAL*8 :: temp763b1
  REAL*8 :: temp780b2
  REAL*8 :: temp778b5
  REAL*8 :: temp827b0
  REAL*8 :: temp861b2
  REAL*8 :: temp979b2
  DOUBLE PRECISION :: temp986
  DOUBLE PRECISION :: temp997b
  REAL*8 :: temp1018b3
  REAL*8 :: temp1020b0
  REAL*8 :: temp1030b9
  REAL*8 :: temp1030b30
  REAL*8 :: temp1074b1
  REAL*8 :: temp1101b0
  REAL*8 :: temp1138b0
  DOUBLE PRECISION :: temp1194
  REAL*8 :: temp1219b0
  DOUBLE PRECISION :: temp1275
  REAL*8 :: temp1286b
  REAL*8 :: temp1330b
  DOUBLE PRECISION :: temp1356
  REAL*8 :: temp1367b
  REAL*8 :: temp1400
  REAL*8 :: temp1411b
  DOUBLE PRECISION :: temp1437
  REAL*8 :: temp1471b0
  DOUBLE PRECISION :: temp1518
  REAL*8 :: temp1529b
  REAL*8 :: temp1552b0
  REAL*8 :: temp1589b0
  REAL*8 :: temp1633b0
  REAL*8 :: temp1714b0
  REAL*8 :: temp1724b9
  REAL*8 :: temp1730b15
  REAL*8 :: temp1768b1
  REAL*8 :: temp1767b15
  DOUBLE PRECISION :: temp1770
  REAL*8 :: temp1812b1
  DOUBLE PRECISION :: temp24
  DOUBLE PRECISION :: temp66b
  DOUBLE PRECISION :: temp103b
  REAL*8 :: temp187b0
  REAL*8 :: temp204b24
  DOUBLE PRECISION :: temp229b3
  REAL*8 :: temp268b0
  DOUBLE PRECISION :: temp291
  REAL*8 :: temp372
  REAL*8 :: temp426b19
  REAL*8 :: temp451b11
  REAL*8 :: temp453
  REAL*8 :: temp473b
  DOUBLE PRECISION :: temp534
  REAL*8 :: temp615
  REAL*8 :: temp635b
  REAL*8 :: temp682b0
  REAL*8 :: temp702b7
  REAL*8 :: temp719b14
  REAL*8 :: temp748b21
  REAL*8 :: temp763b0
  REAL*8 :: temp780b1
  REAL*8 :: temp778b4
  REAL*8 :: temp861b1
  REAL*8 :: temp925b0
  REAL*8 :: temp979b1
  DOUBLE PRECISION :: temp985
  REAL*8 :: temp1018b2
  REAL*8 :: temp1030b8
  REAL*8 :: temp1074b0
  REAL*8 :: temp1091b1
  REAL*8 :: temp1155b0
  DOUBLE PRECISION :: temp1193
  REAL*8 :: temp1214b4
  DOUBLE PRECISION :: temp1274
  REAL*8 :: temp1294b
  DOUBLE PRECISION :: temp1355
  REAL*8 :: temp1432b2
  DOUBLE PRECISION :: temp1436
  DOUBLE PRECISION :: temp1517
  REAL*8 :: temp1537b
  REAL*8 :: temp1618b
  DOUBLE PRECISION :: temp1660b9
  REAL*8 :: temp1724b8
  REAL*8 :: temp1731b0
  REAL*8 :: temp1730b14
  REAL*8 :: temp1741b9
  REAL*8 :: temp1768b0
  REAL*8 :: temp1767b14
  REAL*8 :: temp1812b0
  INTRINSIC DEXP
  REAL*8 :: temp9b2(3)
  REAL*8 :: temp23
  REAL*8 :: temp119
  REAL*8 :: temp204b23
  REAL*8 :: temp229b
  DOUBLE PRECISION :: temp229b2
  REAL*8 :: temp290
  DOUBLE PRECISION :: temp371
  REAL*8 :: temp426b18
  REAL*8 :: temp451b10
  DOUBLE PRECISION :: temp452
  DOUBLE PRECISION :: temp489
  REAL*8 :: temp533
  REAL*8 :: temp545b1
  REAL*8 :: temp599b
  DOUBLE PRECISION :: temp614
  REAL*8 :: temp707b1
  REAL*8 :: temp702b6
  REAL*8 :: temp719b13
  REAL*8 :: temp724b
  REAL*8 :: temp748b20
  REAL*8 :: temp780b0
  REAL*8 :: temp778b3
  REAL*8 :: temp861b0
  REAL*8 :: temp979b0
  DOUBLE PRECISION :: temp984
  REAL*8 :: temp1018b1
  REAL*8 :: temp1030b7
  REAL*8 :: temp1091b0
  DOUBLE PRECISION :: temp1192
  REAL*8 :: temp1214b3
  DOUBLE PRECISION :: temp1273
  DOUBLE PRECISION :: temp1354
  REAL*8 :: temp1383b
  DOUBLE PRECISION :: temp1435
  REAL*8 :: temp1432b1
  DOUBLE PRECISION :: temp1464b
  DOUBLE PRECISION :: temp1516
  REAL*8 :: temp1626b
  DOUBLE PRECISION :: temp1660b8
  DOUBLE PRECISION :: temp1707b
  REAL*8 :: temp1724b7
  REAL*8 :: temp1730b13
  REAL*8 :: temp1741b8
  DOUBLE PRECISION :: temp1767b13
  REAL*8 :: temp1785b0
  REAL*8 :: temp9b1(3)
  REAL*8 :: temp22
  DOUBLE PRECISION :: temp59
  DOUBLE PRECISION :: temp118
  REAL*8 :: temp200b
  REAL*8 :: temp204b22
  REAL*8 :: temp237b
  DOUBLE PRECISION :: temp229b1
  REAL*8 :: temp318b
  DOUBLE PRECISION :: temp370
  REAL*8 :: temp426b17
  REAL*8 :: temp451
  REAL*8 :: temp474b9
  DOUBLE PRECISION :: temp488
  DOUBLE PRECISION :: temp532
  REAL*8 :: temp545b0
  REAL*8 :: temp569
  REAL*8 :: temp570b
  DOUBLE PRECISION :: temp613
  DOUBLE PRECISION :: temp651b
  DOUBLE PRECISION :: temp688b
  REAL*8 :: temp707b0
  REAL*8 :: temp702b5
  REAL*8 :: temp719b12
  REAL*8 :: temp719b49
  REAL*8 :: temp769b
  REAL*8 :: temp778b2
  DOUBLE PRECISION :: temp802b19
  REAL*8 :: temp983
  REAL*8 :: temp1018b0
  REAL*8 :: temp1030b6
  REAL*8 :: temp1052b2
  REAL*8 :: temp1058b
  REAL*8 :: temp1102b
  DOUBLE PRECISION :: temp1191
  REAL*8 :: temp1214b2
  DOUBLE PRECISION :: temp1272
  DOUBLE PRECISION :: temp1353
  REAL*8 :: temp1388b0
  DOUBLE PRECISION :: temp1434
  REAL*8 :: temp1432b0
  DOUBLE PRECISION :: temp1515
  DOUBLE PRECISION :: temp1660b7
  REAL*8 :: temp1715b
  REAL*8 :: temp1724b6
  DOUBLE PRECISION :: temp1730b12
  REAL*8 :: temp1741b7
  REAL*8 :: temp1767b12
  REAL*8 :: temp1827b2
  REAL*8 :: temp9b0(3)
  DOUBLE PRECISION :: temp21
  DOUBLE PRECISION :: temp58
  REAL*8 :: temp117
  REAL*8 :: temp204b21
  REAL*8 :: temp229b0
  REAL*8 :: temp326b
  DOUBLE PRECISION :: temp407b
  REAL*8 :: temp426b16
  DOUBLE PRECISION :: temp450
  REAL*8 :: temp474b8
  REAL*8 :: temp487
  DOUBLE PRECISION :: temp531
  DOUBLE PRECISION :: temp568
  REAL*8 :: temp612
  DOUBLE PRECISION :: temp649
  REAL*8 :: temp660b1
  REAL*8 :: temp696b
  REAL*8 :: temp702b4
  REAL*8 :: temp719b11
  REAL*8 :: temp719b48
  DOUBLE PRECISION :: temp777b
  REAL*8 :: temp778b1
  REAL*8 :: temp802b18
  REAL*8 :: temp858b
  REAL*8 :: temp902b
  DOUBLE PRECISION :: temp982
  DOUBLE PRECISION :: temp1019
  REAL*8 :: temp1030b5
  REAL*8 :: temp1052b1
  DOUBLE PRECISION :: temp1190
  REAL*8 :: temp1214b1
  REAL*8 :: temp1228b
  DOUBLE PRECISION :: temp1271
  DOUBLE PRECISION :: temp1309b
  DOUBLE PRECISION :: temp1352
  REAL*8 :: temp1389
  REAL*8 :: temp1410b3
  DOUBLE PRECISION :: temp1433
  REAL*8 :: temp1480b
  DOUBLE PRECISION :: temp1514
  DOUBLE PRECISION :: temp1561b
  REAL*8 :: temp1584b1
  REAL*8 :: temp1598b
  DOUBLE PRECISION :: temp1660b6
  REAL*8 :: temp1679b
  REAL*8 :: temp1723b
  REAL*8 :: temp1724b5
  REAL*8 :: temp1730b11
  REAL*8 :: temp1741b6
  REAL*8 :: temp1767b11
  REAL*8 :: temp1827b1
  REAL*8 :: temp20
  DOUBLE PRECISION :: temp35b2
  DOUBLE PRECISION :: temp57(3)
  REAL*8 :: temp116
  REAL*8 :: temp172b(3)
  REAL*8 :: temp204b20
  REAL*8 :: temp246b0
  REAL*8 :: temp344b1
  REAL*8 :: temp426b15
  REAL*8 :: temp474b7
  DOUBLE PRECISION :: temp486
  REAL*8 :: temp506b1
  REAL*8 :: temp530
  DOUBLE PRECISION :: temp567
  DOUBLE PRECISION :: temp611
  DOUBLE PRECISION :: temp648
  REAL*8 :: temp660b0
  REAL*8 :: temp702b3
  REAL*8 :: temp719b10
  REAL*8 :: temp719b47
  REAL*8 :: temp729
  REAL*8 :: temp778b0
  REAL*8 :: temp802b17
  REAL*8 :: temp822b0
  REAL*8 :: temp866b
  REAL*8 :: temp910b
  REAL*8 :: temp920b1
  REAL*8 :: temp947b
  REAL*8 :: temp981
  DOUBLE PRECISION :: temp1018
  REAL*8 :: temp1030b4
  REAL*8 :: temp1052b0
  REAL*8 :: temp1074b
  REAL*8 :: temp1089b0
  REAL*8 :: temp1150b1
  DOUBLE PRECISION :: temp1155b
  REAL*8 :: temp1214b0
  DOUBLE PRECISION :: temp1270
  DOUBLE PRECISION :: temp1351
  REAL*8 :: temp1388
  REAL*8 :: temp1410b2
  REAL*8 :: temp1432
  DOUBLE PRECISION :: temp1469
  REAL*8 :: temp1513
  REAL*8 :: temp1584b0
  REAL*8 :: temp1665b0
  DOUBLE PRECISION :: temp1660b5
  REAL*8 :: temp1687b
  REAL*8 :: temp1724b4
  REAL*8 :: temp1730b10
  DOUBLE PRECISION :: temp1731b
  REAL*8 :: temp1741b5
  REAL*8 :: temp1746b0
  REAL*8 :: temp1767b10
  REAL*8 :: temp1768b
  DOUBLE PRECISION :: temp1812b
  REAL*8 :: temp1827b0
  REAL*8 :: temp1844b1
  DOUBLE PRECISION :: temp35b1
  DOUBLE PRECISION :: temp56(3)
  DOUBLE PRECISION :: temp115
  DOUBLE PRECISION :: temp180b
  REAL*8 :: temp261b
  REAL*8 :: temp263b0
  REAL*8 :: temp344b0
  REAL*8 :: temp426b14
  REAL*8 :: temp474b6
  DOUBLE PRECISION :: temp485
  REAL*8 :: temp506b0
  REAL*8 :: temp566
  DOUBLE PRECISION :: temp610
  DOUBLE PRECISION :: temp647
  REAL*8 :: temp702b2
  REAL*8 :: temp719b46
  REAL*8 :: temp728
  REAL*8 :: temp793b
  REAL*8 :: temp802b16
  DOUBLE PRECISION :: temp809
  REAL*8 :: temp886b9
  REAL*8 :: temp920b0
  DOUBLE PRECISION :: temp955b
  REAL*8 :: temp967b9
  DOUBLE PRECISION :: temp980
  DOUBLE PRECISION :: temp1017
  REAL*8 :: temp1030b3
  REAL*8 :: temp1150b0
  REAL*8 :: temp1231b0
  DOUBLE PRECISION :: temp1244b
  REAL*8 :: temp1325b
  DOUBLE PRECISION :: temp1350
  DOUBLE PRECISION :: temp1387
  REAL*8 :: temp1406b
  REAL*8 :: temp1410b1
  DOUBLE PRECISION :: temp1431
  REAL*8 :: temp1447b1
  DOUBLE PRECISION :: temp1468
  DOUBLE PRECISION :: temp1512
  DOUBLE PRECISION :: temp1549
  REAL*8 :: temp1660b4(3)
  REAL*8 :: temp1695b
  REAL*8 :: temp1724b3
  REAL*8 :: temp1741b4
  REAL*8 :: temp1844b0
  DOUBLE PRECISION :: temp35b0
  DOUBLE PRECISION :: temp55(3)
  REAL*8 :: temp114
  REAL*8 :: temp322b3
  REAL*8 :: temp350b
  REAL*8 :: temp398b0
  REAL*8 :: temp387b
  REAL*8 :: temp426b13
  REAL*8 :: temp431b
  DOUBLE PRECISION :: temp468b
  REAL*8 :: temp474b5
  DOUBLE PRECISION :: temp484
  REAL*8 :: temp512b
  REAL*8 :: temp549b
  DOUBLE PRECISION :: temp565
  DOUBLE PRECISION :: temp594b2
  REAL*8 :: temp646
  REAL*8 :: temp702b1
  REAL*8 :: temp719b45
  DOUBLE PRECISION :: temp727
  REAL*8 :: temp802b15
  DOUBLE PRECISION :: temp808
  REAL*8 :: temp882b
  REAL*8 :: temp886b8
  REAL*8 :: temp963b
  REAL*8 :: temp967b8
  DOUBLE PRECISION :: temp1016
  REAL*8 :: temp1030b2
  DOUBLE PRECISION :: temp1090b
  REAL*8 :: temp1165b3
  REAL*8 :: temp1171b
  REAL*8 :: temp1252b
  REAL*8 :: temp1289b
  REAL*8 :: temp1333b
  REAL*8 :: temp1383b1
  DOUBLE PRECISION :: temp1386
  REAL*8 :: temp1410b0
  REAL*8 :: temp1414b
  DOUBLE PRECISION :: temp1430
  REAL*8 :: temp1447b0
  DOUBLE PRECISION :: temp1467
  DOUBLE PRECISION :: temp1511
  REAL*8 :: temp1548
  DOUBLE PRECISION :: temp1629
  REAL*8 :: temp1660b3(3)
  REAL*8 :: temp1697b3
  REAL*8 :: temp1724b2
  REAL*8 :: temp1741b3
  DOUBLE PRECISION :: temp1784b
  DOUBLE PRECISION :: temp32b
  DOUBLE PRECISION :: temp54
  DOUBLE PRECISION :: temp106b
  DOUBLE PRECISION :: temp113
  DOUBLE PRECISION :: temp175b6
  REAL*8 :: temp305b1
  REAL*8 :: temp322b2
  REAL*8 :: temp426b12
  REAL*8 :: temp457b3
  REAL*8 :: temp474b4
  REAL*8 :: temp483
  REAL*8 :: temp476b
  DOUBLE PRECISION :: temp520b
  REAL*8 :: temp557b
  DOUBLE PRECISION :: temp564
  DOUBLE PRECISION :: temp594b1
  REAL*8 :: temp645
  REAL*8 :: temp675b1
  REAL*8 :: temp698b39
  REAL*8 :: temp702b0
  REAL*8 :: temp719b
  REAL*8 :: temp719b44
  DOUBLE PRECISION :: temp726
  REAL*8 :: temp802b14
  DOUBLE PRECISION :: temp807
  REAL*8 :: temp886b7
  DOUBLE PRECISION :: temp890b
  REAL*8 :: temp967b7
  REAL*8 :: temp971b
  REAL*8 :: temp991b0
  REAL*8 :: temp989b3
  REAL*8 :: temp1008b
  DOUBLE PRECISION :: temp1015
  REAL*8 :: temp1030b1
  REAL*8 :: temp1028b4
  REAL*8 :: temp1148b1
  REAL*8 :: temp1165b2
  REAL*8 :: temp1341b
  REAL*8 :: temp1378b
  REAL*8 :: temp1383b0
  DOUBLE PRECISION :: temp1385
  REAL*8 :: temp1422b
  REAL*8 :: temp1459b
  DOUBLE PRECISION :: temp1466
  REAL*8 :: temp1464b0
  REAL*8 :: temp1503b
  REAL*8 :: temp1510
  DOUBLE PRECISION :: temp1547
  REAL*8 :: temp1626b0
  DOUBLE PRECISION :: temp1628
  DOUBLE PRECISION :: temp1660b2
  REAL*8 :: temp1697b2
  REAL*8 :: temp1709
  REAL*8 :: temp1724b1
  REAL*8 :: temp1741b2
  REAL*8 :: temp1792b
  DOUBLE PRECISION :: temp53(3)
  REAL*8 :: temp112
  REAL*8 :: temp114b
  DOUBLE PRECISION :: temp149(3)
  DOUBLE PRECISION :: temp175b5
  REAL*8 :: temp305b0
  REAL*8 :: temp322b1
  REAL*8 :: temp426b11
  REAL*8 :: temp457b2
  REAL*8 :: temp474b3
  DOUBLE PRECISION :: temp482
  REAL*8 :: temp484b
  DOUBLE PRECISION :: temp563
  DOUBLE PRECISION :: temp565b
  DOUBLE PRECISION :: temp594b0
  DOUBLE PRECISION :: temp644
  REAL*8 :: temp646b
  REAL*8 :: temp675b0
  REAL*8 :: temp698b38
  REAL*8 :: temp719b43
  REAL*8 :: temp725
  REAL*8 :: temp756b0
  REAL*8 :: temp773b1
  REAL*8 :: temp802b13
  REAL*8 :: temp806
  REAL*8 :: temp808b
  REAL*8 :: temp886b6
  REAL*8 :: temp967b6
  REAL*8 :: temp989b2
  DOUBLE PRECISION :: temp1014
  REAL*8 :: temp1016b
  REAL*8 :: temp1030b0
  DOUBLE PRECISION :: temp1028b3
  REAL*8 :: temp1067b0
  REAL*8 :: temp1148b0
  REAL*8 :: temp1165b1
  REAL*8 :: temp1229b0
  DOUBLE PRECISION :: temp1384
  REAL*8 :: temp1386b
  REAL*8 :: temp1465
  DOUBLE PRECISION :: temp1511b
  DOUBLE PRECISION :: temp1546
  REAL*8 :: temp1548b
  REAL*8 :: temp1562b0
  REAL*8 :: temp1599b0
  DOUBLE PRECISION :: temp1627
  REAL*8 :: temp1660b1
  REAL*8 :: temp1697b1
  DOUBLE PRECISION :: temp1708
  REAL*8 :: temp1724b0
  REAL*8 :: temp1741b1
  DOUBLE PRECISION :: temp52(3)
  REAL*8 :: temp89
  DOUBLE PRECISION :: temp111(3)
  DOUBLE PRECISION :: temp122b(3)
  DOUBLE PRECISION :: temp148(3)
  DOUBLE PRECISION :: temp175b4
  REAL*8 :: temp203b(3)
  DOUBLE PRECISION :: temp229
  REAL*8 :: temp322b0
  REAL*8 :: temp376b1
  DOUBLE PRECISION :: temp403b0
  REAL*8 :: temp426b10
  REAL*8 :: temp457b1
  REAL*8 :: temp474b2
  DOUBLE PRECISION :: temp481
  REAL*8 :: temp562
  DOUBLE PRECISION :: temp599
  DOUBLE PRECISION :: temp643
  REAL*8 :: temp698b37
  REAL*8 :: temp719b42
  REAL*8 :: temp724
  REAL*8 :: temp719b79
  REAL*8 :: temp735b
  REAL*8 :: temp773b0
  REAL*8 :: temp802b12
  DOUBLE PRECISION :: temp805
  DOUBLE PRECISION :: temp816b
  REAL*8 :: temp854b0
  REAL*8 :: temp886b5
  REAL*8 :: temp959b19
  REAL*8 :: temp967b5
  REAL*8 :: temp989b1
  DOUBLE PRECISION :: temp1013
  REAL*8 :: temp1024b
  REAL*8 :: temp1028b2
  REAL*8 :: temp1105b
  REAL*8 :: temp1165b0
  REAL*8 :: temp1383
  REAL*8 :: temp1394b
  DOUBLE PRECISION :: temp1464
  REAL*8 :: temp1475b
  DOUBLE PRECISION :: temp1545
  DOUBLE PRECISION :: temp1626
  REAL*8 :: temp1660b0(3)
  REAL*8 :: temp1697b0
  DOUBLE PRECISION :: temp1707
  REAL*8 :: temp1718b
  REAL*8 :: temp1741b0
  REAL*8 :: temp1778b0
  REAL*8 :: temp1788b9
  REAL*8 :: temp1822b0
  DOUBLE PRECISION :: temp51(3)
  DOUBLE PRECISION :: temp67b1
  DOUBLE PRECISION :: temp88
  DOUBLE PRECISION :: temp110(3)
  REAL*8 :: temp130b
  DOUBLE PRECISION :: temp147(3)
  REAL*8 :: temp175b3
  DOUBLE PRECISION :: temp228
  DOUBLE PRECISION :: temp295b0
  DOUBLE PRECISION :: temp309
  REAL*8 :: temp376b0
  REAL*8 :: temp457b0
  REAL*8 :: temp474b1
  REAL*8 :: temp480
  REAL*8 :: temp538b0
  DOUBLE PRECISION :: temp561
  DOUBLE PRECISION :: temp598
  DOUBLE PRECISION :: temp642
  DOUBLE PRECISION :: temp679
  REAL*8 :: temp698b36
  REAL*8 :: temp699b
  REAL*8 :: temp719b41
  REAL*8 :: temp719b78
  DOUBLE PRECISION :: temp723
  REAL*8 :: temp802b11
  DOUBLE PRECISION :: temp804
  REAL*8 :: temp871b0
  REAL*8 :: temp886b4
  REAL*8 :: temp905b
  REAL*8 :: temp959b18
  REAL*8 :: temp967b4
  REAL*8 :: temp989b0
  DOUBLE PRECISION :: temp1012
  REAL*8 :: temp1028b1
  REAL*8 :: temp1032b
  DOUBLE PRECISION :: temp1049
  REAL*8 :: temp1062b3
  REAL*8 :: temp1069b
  REAL*8 :: temp1113b
  DOUBLE PRECISION :: temp1382
  DOUBLE PRECISION :: temp1463
  DOUBLE PRECISION :: temp1544
  REAL*8 :: temp1564b
  DOUBLE PRECISION :: temp1625
  REAL*8 :: temp1645b
  REAL*8 :: temp1658b2
  DOUBLE PRECISION :: temp1706
  REAL*8 :: temp1726b
  REAL*8 :: temp1788b8
  DOUBLE PRECISION :: temp50(3)
  DOUBLE PRECISION :: temp67b0
  REAL*8 :: temp87
  REAL*8 :: temp146
  DOUBLE PRECISION :: temp175b
  REAL*8 :: temp175b2
  DOUBLE PRECISION :: temp227
  REAL*8 :: temp308
  REAL*8 :: temp300b
  REAL*8 :: temp337b
  REAL*8 :: temp393b0
  REAL*8 :: temp474b0
  REAL*8 :: temp560
  DOUBLE PRECISION :: temp597
  REAL*8 :: temp641
  REAL*8 :: temp653b1
  DOUBLE PRECISION :: temp678
  REAL*8 :: temp698b35
  REAL*8 :: temp719b40
  REAL*8 :: temp719b77
  DOUBLE PRECISION :: temp722
  DOUBLE PRECISION :: temp759
  REAL*8 :: temp802b10
  REAL*8 :: temp803
  REAL*8 :: temp839b10
  REAL*8 :: temp869b
  REAL*8 :: temp886b3
  DOUBLE PRECISION :: temp913b
  REAL*8 :: temp959b17
  REAL*8 :: temp967b3
  REAL*8 :: temp984b4
  DOUBLE PRECISION :: temp1011
  REAL*8 :: temp1028b0
  DOUBLE PRECISION :: temp1048
  REAL*8 :: temp1062b2
  REAL*8 :: temp1077b
  REAL*8 :: temp1129
  REAL*8 :: temp1239b
  REAL*8 :: temp1322b3
  DOUBLE PRECISION :: temp1381
  REAL*8 :: temp1398b0
  DOUBLE PRECISION :: temp1462
  DOUBLE PRECISION :: temp1499
  DOUBLE PRECISION :: temp1543
  REAL*8 :: temp1540b1
  DOUBLE PRECISION :: temp1624
  REAL*8 :: temp1653b
  REAL*8 :: temp1658b1
  REAL*8 :: temp1705
  REAL*8 :: temp1788b7
  REAL*8 :: temp1815b
  REAL*8 :: temp19b
  DOUBLE PRECISION :: temp86(3)
  DOUBLE PRECISION :: temp145
  REAL*8 :: temp175b1
  REAL*8 :: temp183b(3)
  DOUBLE PRECISION :: temp226
  REAL*8 :: temp264b
  DOUBLE PRECISION :: temp307
  REAL*8 :: temp300b1
  DOUBLE PRECISION :: temp345b
  REAL*8 :: temp426b
  REAL*8 :: temp507b
  REAL*8 :: temp582b9
  DOUBLE PRECISION :: temp596
  DOUBLE PRECISION :: temp640
  REAL*8 :: temp653b0
  REAL*8 :: temp677
  REAL*8 :: temp698b34
  REAL*8 :: temp719b76
  REAL*8 :: temp721
  DOUBLE PRECISION :: temp758
  DOUBLE PRECISION :: temp802
  DOUBLE PRECISION :: temp839
  DOUBLE PRECISION :: temp877b
  REAL*8 :: temp886b2
  REAL*8 :: temp959b16
  REAL*8 :: temp967b2
  REAL*8 :: temp981b39
  REAL*8 :: temp984b3
  DOUBLE PRECISION :: temp1010
  DOUBLE PRECISION :: temp1047
  REAL*8 :: temp1062b1
  REAL*8 :: temp1085b
  DOUBLE PRECISION :: temp1128
  REAL*8 :: temp1166b
  REAL*8 :: temp1207b0
  DOUBLE PRECISION :: temp1209
  REAL*8 :: temp1210b
  REAL*8 :: temp1322b2
  DOUBLE PRECISION :: temp1380
  DOUBLE PRECISION :: temp1461
  DOUBLE PRECISION :: temp1498
  REAL*8 :: temp1501b3
  REAL*8 :: temp1542
  REAL*8 :: temp1540b0
  DOUBLE PRECISION :: temp1579
  REAL*8 :: temp1580b
  DOUBLE PRECISION :: temp1623
  DOUBLE PRECISION :: temp1653b5(3)
  REAL*8 :: temp1658b0(3)
  REAL*8 :: temp1698b
  REAL*8 :: temp1702b0
  DOUBLE PRECISION :: temp1704
  REAL*8 :: temp1742b
  REAL*8 :: temp1756b1
  REAL*8 :: temp1779b
  REAL*8 :: temp1788b6
  REAL*8 :: temp1823b
  DOUBLE PRECISION :: temp85(3)
  REAL*8 :: temp144
  DOUBLE PRECISION :: temp175b0
  REAL*8 :: temp191b(3)
  DOUBLE PRECISION :: temp192b1
  DOUBLE PRECISION :: temp225
  DOUBLE PRECISION :: temp306
  REAL*8 :: temp300b0
  DOUBLE PRECISION :: temp353b
  REAL*8 :: temp434b
  DOUBLE PRECISION :: temp484b7
  REAL*8 :: temp582b8
  REAL*8 :: temp595
  DOUBLE PRECISION :: temp676
  REAL*8 :: temp698b33
  REAL*8 :: temp719b75
  DOUBLE PRECISION :: temp720
  REAL*8 :: temp757
  DOUBLE PRECISION :: temp801
  REAL*8 :: temp838
  REAL*8 :: temp869b0
  REAL*8 :: temp885b
  REAL*8 :: temp886b1
  REAL*8 :: temp913b0
  DOUBLE PRECISION :: temp919
  REAL*8 :: temp930b1
  REAL*8 :: temp959b15
  REAL*8 :: temp967b1
  DOUBLE PRECISION :: temp966b
  REAL*8 :: temp981b38
  REAL*8 :: temp984b2
  DOUBLE PRECISION :: temp1046
  REAL*8 :: temp1062b0
  REAL*8 :: temp1104b3
  DOUBLE PRECISION :: temp1127
  DOUBLE PRECISION :: temp1208
  DOUBLE PRECISION :: temp1255b
  REAL*8 :: temp1305b0
  REAL*8 :: temp1322b1
  REAL*8 :: temp1417b
  DOUBLE PRECISION :: temp1460
  REAL*8 :: temp1474b3
  DOUBLE PRECISION :: temp1497
  REAL*8 :: temp1501b2
  DOUBLE PRECISION :: temp1541
  DOUBLE PRECISION :: temp1578
  DOUBLE PRECISION :: temp1622
  DOUBLE PRECISION :: temp1653b4
  REAL*8 :: temp1659
  REAL*8 :: temp1703
  REAL*8 :: temp1717b3
  REAL*8 :: temp1750b
  REAL*8 :: temp1756b0
  REAL*8 :: temp1788b5
  REAL*8 :: temp1800b0
  DOUBLE PRECISION :: temp35b
  DOUBLE PRECISION :: temp84(3)
  REAL*8 :: temp109b(3)
  REAL*8 :: temp143
  DOUBLE PRECISION :: temp192b0
  REAL*8 :: temp224
  DOUBLE PRECISION :: temp273b0
  DOUBLE PRECISION :: temp305
  DOUBLE PRECISION :: temp310b8
  DOUBLE PRECISION :: temp354b0
  REAL*8 :: temp398b
  REAL*8 :: temp435b0
  DOUBLE PRECISION :: temp442b
  REAL*8 :: temp484b6
  REAL*8 :: temp489b1
  REAL*8 :: temp516b0
  REAL*8 :: temp582b7
  DOUBLE PRECISION :: temp594
  REAL*8 :: temp614b1
  DOUBLE PRECISION :: temp675
  REAL*8 :: temp698b32
  REAL*8 :: temp698b69
  REAL*8 :: temp719b74
  DOUBLE PRECISION :: temp756
  DOUBLE PRECISION :: temp800
  REAL*8 :: temp806b22
  REAL*8 :: temp837
  DOUBLE PRECISION :: temp886b0
  REAL*8 :: temp909b19
  DOUBLE PRECISION :: temp918
  REAL*8 :: temp930b0
  REAL*8 :: temp959b14
  REAL*8 :: temp967b0
  DOUBLE PRECISION :: temp974b
  REAL*8 :: temp977b9
  REAL*8 :: temp981b37
  REAL*8 :: temp984b1
  DOUBLE PRECISION :: temp1045
  REAL*8 :: temp1104b2
  DOUBLE PRECISION :: temp1126
  REAL*8 :: temp1197b0
  DOUBLE PRECISION :: temp1207
  REAL*8 :: temp1241b0
  REAL*8 :: temp1322b0
  REAL*8 :: temp1344b
  REAL*8 :: temp1457b1
  REAL*8 :: temp1474b2
  REAL*8 :: temp1496
  REAL*8 :: temp1501b1
  DOUBLE PRECISION :: temp1540
  REAL*8 :: temp1555b2
  DOUBLE PRECISION :: temp1577
  DOUBLE PRECISION :: temp1621
  REAL*8 :: temp1619b1
  REAL*8 :: temp1653b3
  REAL*8 :: temp1658
  DOUBLE PRECISION :: temp1702
  REAL*8 :: temp1717b2
  DOUBLE PRECISION :: temp1739
  REAL*8 :: temp1788b4
  REAL*8 :: temp43b
  REAL*8 :: temp83(3)
  REAL*8 :: temp117b
  DOUBLE PRECISION :: temp142
  REAL*8 :: temp179
  DOUBLE PRECISION :: temp223
  REAL*8 :: temp304
  REAL*8 :: temp310b7
  DOUBLE PRECISION :: temp371b0
  REAL*8 :: temp452b0
  DOUBLE PRECISION :: temp484b5
  REAL*8 :: temp489b0
  REAL*8 :: temp531b
  REAL*8 :: temp533b0
  REAL*8 :: temp582b6
  DOUBLE PRECISION :: temp593
  REAL*8 :: temp614b0
  REAL*8 :: temp674
  REAL*8 :: temp698b31
  REAL*8 :: temp698b68
  REAL*8 :: temp719b73
  DOUBLE PRECISION :: temp755
  REAL*8 :: temp806b21
  DOUBLE PRECISION :: temp836
  REAL*8 :: temp909b18
  DOUBLE PRECISION :: temp917
  REAL*8 :: temp959b13
  REAL*8 :: temp977b8
  REAL*8 :: temp981b36
  DOUBLE PRECISION :: temp984b0
  REAL*8 :: temp982b
  REAL*8 :: temp1016b9
  REAL*8 :: temp1019b
  DOUBLE PRECISION :: temp1044
  REAL*8 :: temp1104b1
  DOUBLE PRECISION :: temp1125
  DOUBLE PRECISION :: temp1206
  DOUBLE PRECISION :: temp1271b
  REAL*8 :: temp1295b0
  REAL*8 :: temp1352b
  REAL*8 :: temp1376b0
  REAL*8 :: temp1389b
  REAL*8 :: temp1457b0
  REAL*8 :: temp1474b1
  DOUBLE PRECISION :: temp1495
  REAL*8 :: temp1501b0
  REAL*8 :: temp1555b1
  DOUBLE PRECISION :: temp1576
  DOUBLE PRECISION :: temp1620
  REAL*8 :: temp1619b0
  REAL*8 :: temp1636b1
  REAL*8 :: temp1653b2
  REAL*8 :: temp1657
  REAL*8 :: temp1701
  REAL*8 :: temp1717b1
  REAL*8 :: temp1738
  REAL*8 :: temp1788b3
  INTEGER :: temp1819
  REAL*8 :: temp0b
  DOUBLE PRECISION :: temp51b(3)
  REAL*8 :: temp82
  REAL*8 :: temp88b
  REAL*8 :: temp125b
  REAL*8 :: temp141
  DOUBLE PRECISION :: temp178
  REAL*8 :: temp206b
  DOUBLE PRECISION :: temp222
  DOUBLE PRECISION :: temp259
  REAL*8 :: temp303
  REAL*8 :: temp310b6
  REAL*8 :: temp430b3
  DOUBLE PRECISION :: temp484b4
  REAL*8 :: temp495b
  REAL*8 :: temp582b5
  DOUBLE PRECISION :: temp592
  REAL*8 :: temp620b
  REAL*8 :: temp657b
  DOUBLE PRECISION :: temp673
  REAL*8 :: temp698b30
  REAL*8 :: temp698b67
  DOUBLE PRECISION :: temp701b
  REAL*8 :: temp719b72
  DOUBLE PRECISION :: temp738b
  REAL*8 :: temp749b0
  DOUBLE PRECISION :: temp754
  REAL*8 :: temp806b20
  DOUBLE PRECISION :: temp835
  REAL*8 :: temp909b17
  DOUBLE PRECISION :: temp916
  REAL*8 :: temp959b12
  REAL*8 :: temp977b7
  REAL*8 :: temp981b35
  REAL*8 :: temp1016b8
  DOUBLE PRECISION :: temp1043
  REAL*8 :: temp1104b0
  REAL*8 :: temp1108b
  DOUBLE PRECISION :: temp1124
  DOUBLE PRECISION :: temp1205
  REAL*8 :: temp1239b1
  REAL*8 :: temp1360b
  REAL*8 :: temp1354b3
  REAL*8 :: temp1441b
  REAL*8 :: temp1474b0
  REAL*8 :: temp1478b
  DOUBLE PRECISION :: temp1494
  REAL*8 :: temp1522b
  REAL*8 :: temp1555b0
  REAL*8 :: temp1559b
  DOUBLE PRECISION :: temp1575
  REAL*8 :: temp1636b0
  REAL*8 :: temp1653b1(3)
  DOUBLE PRECISION :: temp1656
  DOUBLE PRECISION :: temp1700
  REAL*8 :: temp1717b0
  DOUBLE PRECISION :: temp1737
  REAL*8 :: temp1788b2
  REAL*8 :: temp1815b1
  DOUBLE PRECISION :: temp1818
  DOUBLE PRECISION :: temp81
  DOUBLE PRECISION :: temp133b
  DOUBLE PRECISION :: temp140
  DOUBLE PRECISION :: temp177(3)
  REAL*8 :: temp214b
  DOUBLE PRECISION :: temp221
  DOUBLE PRECISION :: temp258
  DOUBLE PRECISION :: temp302
  REAL*8 :: temp310b5
  DOUBLE PRECISION :: temp339
  REAL*8 :: temp369b1
  REAL*8 :: temp430b2
  REAL*8 :: temp484b3
  REAL*8 :: temp582b4
  REAL*8 :: temp591
  REAL*8 :: temp584b
  REAL*8 :: temp665b
  DOUBLE PRECISION :: temp672
  REAL*8 :: temp698b66
  REAL*8 :: temp719b71
  DOUBLE PRECISION :: temp753
  REAL*8 :: temp766b0
  REAL*8 :: temp810b0
  REAL*8 :: temp827b
  REAL*8 :: temp828b16
  REAL*8 :: temp834
  REAL*8 :: temp847b0
  REAL*8 :: temp857b9
  REAL*8 :: temp881b2
  REAL*8 :: temp909b16
  DOUBLE PRECISION :: temp915
  REAL*8 :: temp959b11
  REAL*8 :: temp977b6
  REAL*8 :: temp981b34
  REAL*8 :: temp1016b7
  REAL*8 :: temp1035b
  DOUBLE PRECISION :: temp1042
  REAL*8 :: temp1079
  REAL*8 :: temp1077b0
  REAL*8 :: temp1123
  DOUBLE PRECISION :: temp1204
  REAL*8 :: temp1239b0
  REAL*8 :: temp1354b2
  REAL*8 :: temp1371b3
  REAL*8 :: temp1493
  DOUBLE PRECISION :: temp1574
  DOUBLE PRECISION :: temp1653b0
  DOUBLE PRECISION :: temp1655
  REAL*8 :: temp1670b1
  DOUBLE PRECISION :: temp1736
  REAL*8 :: temp1788b1
  REAL*8 :: temp1815b0
  INTEGER :: temp1817
  DOUBLE PRECISION :: temp80
  REAL*8 :: temp141b
  DOUBLE PRECISION :: temp176(3)
  REAL*8 :: temp178b(3)
  DOUBLE PRECISION :: temp220
  REAL*8 :: temp251b0
  DOUBLE PRECISION :: temp257
  DOUBLE PRECISION :: temp259b
  DOUBLE PRECISION :: temp301
  REAL*8 :: temp310b4
  DOUBLE PRECISION :: temp338
  REAL*8 :: temp369b0
  DOUBLE PRECISION :: temp419
  REAL*8 :: temp430b1
  REAL*8 :: temp484b2
  REAL*8 :: temp582b3
  DOUBLE PRECISION :: temp590
  REAL*8 :: temp592b
  DOUBLE PRECISION :: temp671
  DOUBLE PRECISION :: temp673b
  REAL*8 :: temp698b65
  REAL*8 :: temp719b70
  REAL*8 :: temp752
  REAL*8 :: temp754b
  REAL*8 :: temp789
  REAL*8 :: temp828b15
  REAL*8 :: temp833
  DOUBLE PRECISION :: temp835b
  REAL*8 :: temp857b8
  REAL*8 :: temp857b22
  REAL*8 :: temp881b1
  REAL*8 :: temp909b15
  REAL*8 :: temp914
  REAL*8 :: temp945b0
  REAL*8 :: temp959b10
  REAL*8 :: temp977b5
  REAL*8 :: temp981b33
  REAL*8 :: temp1016b6
  DOUBLE PRECISION :: temp1041
  DOUBLE PRECISION :: temp1078
  DOUBLE PRECISION :: temp1122
  DOUBLE PRECISION :: temp1159
  REAL*8 :: temp1175b0
  DOUBLE PRECISION :: temp1203
  REAL*8 :: temp1256b0
  REAL*8 :: temp1337b0
  REAL*8 :: temp1354b1
  REAL*8 :: temp1371b2
  DOUBLE PRECISION :: temp1492
  DOUBLE PRECISION :: temp1573
  REAL*8 :: temp1575b
  REAL*8 :: temp1654
  REAL*8 :: temp1670b0
  DOUBLE PRECISION :: temp1680b9
  REAL*8 :: temp1700b
  DOUBLE PRECISION :: temp1735
  DOUBLE PRECISION :: temp1737b
  REAL*8 :: temp1788b0
  REAL*8 :: temp1816
  DOUBLE PRECISION :: temp175(3)
  REAL*8 :: temp212b2
  REAL*8 :: temp256
  DOUBLE PRECISION :: temp300
  REAL*8 :: temp310b3
  DOUBLE PRECISION :: temp337
  REAL*8 :: temp348b
  DOUBLE PRECISION :: temp418
  REAL*8 :: temp429b
  REAL*8 :: temp428b3
  REAL*8 :: temp430b0
  REAL*8 :: temp484b1
  REAL*8 :: temp582b2
  REAL*8 :: temp629b0
  REAL*8 :: temp670
  REAL*8 :: temp698b64
  REAL*8 :: temp744b2
  DOUBLE PRECISION :: temp751
  DOUBLE PRECISION :: temp762b
  DOUBLE PRECISION :: temp788
  REAL*8 :: temp799b
  REAL*8 :: temp828b14
  DOUBLE PRECISION :: temp832
  REAL*8 :: temp857b7
  REAL*8 :: temp857b21
  DOUBLE PRECISION :: temp869
  REAL*8 :: temp881b0
  REAL*8 :: temp909b14
  DOUBLE PRECISION :: temp913
  REAL*8 :: temp977b4
  REAL*8 :: temp981b32
  REAL*8 :: temp1016b5
  REAL*8 :: temp1040
  DOUBLE PRECISION :: temp1077
  DOUBLE PRECISION :: temp1121
  REAL*8 :: temp1132b
  DOUBLE PRECISION :: temp1158
  REAL*8 :: temp1169b
  REAL*8 :: temp1202
  REAL*8 :: temp1239
  REAL*8 :: temp1354b0
  REAL*8 :: temp1369b4
  REAL*8 :: temp1371b1
  DOUBLE PRECISION :: temp1491
  DOUBLE PRECISION :: temp1572
  DOUBLE PRECISION :: temp1653(3)
  REAL*8 :: temp1664b
  DOUBLE PRECISION :: temp1680b8
  DOUBLE PRECISION :: temp1734
  REAL*8 :: temp1745b
  REAL*8 :: temp1745b19
  DOUBLE PRECISION :: temp1815
  DOUBLE PRECISION :: temp1826b
  DOUBLE PRECISION :: temp174
  REAL*8 :: temp212b1
  DOUBLE PRECISION :: temp255
  REAL*8 :: temp275b
  REAL*8 :: temp310b2
  REAL*8 :: temp336
  DOUBLE PRECISION :: temp417
  REAL*8 :: temp428b2
  REAL*8 :: temp437b
  REAL*8 :: temp484b0
  DOUBLE PRECISION :: temp565b0
  REAL*8 :: temp582b1
  DOUBLE PRECISION :: temp607b3
  REAL*8 :: temp646b0
  REAL*8 :: temp698b63
  REAL*8 :: temp737b9
  REAL*8 :: temp744b1
  DOUBLE PRECISION :: temp750
  DOUBLE PRECISION :: temp787
  REAL*8 :: temp798b2
  REAL*8 :: temp808b0
  DOUBLE PRECISION :: temp828b13
  DOUBLE PRECISION :: temp831
  REAL*8 :: temp857b6
  REAL*8 :: temp857b20
  DOUBLE PRECISION :: temp868
  REAL*8 :: temp888b
  REAL*8 :: temp909b13
  DOUBLE PRECISION :: temp912
  REAL*8 :: temp932b
  DOUBLE PRECISION :: temp949
  REAL*8 :: temp969b
  REAL*8 :: temp977b3
  REAL*8 :: temp981b31
  REAL*8 :: temp1016b4
  DOUBLE PRECISION :: temp1076
  DOUBLE PRECISION :: temp1120
  REAL*8 :: temp1140b
  DOUBLE PRECISION :: temp1157
  REAL*8 :: temp1201
  DOUBLE PRECISION :: temp1221b
  REAL*8 :: temp1234b2
  DOUBLE PRECISION :: temp1238
  DOUBLE PRECISION :: temp1258b
  REAL*8 :: temp1302b
  DOUBLE PRECISION :: temp1319
  REAL*8 :: temp1369b3
  REAL*8 :: temp1371b0
  REAL*8 :: temp1413b3
  DOUBLE PRECISION :: temp1490
  DOUBLE PRECISION :: temp1571
  DOUBLE PRECISION :: temp1591b
  REAL*8 :: temp1652
  DOUBLE PRECISION :: temp1680b7
  DOUBLE PRECISION :: temp1689
  DOUBLE PRECISION :: temp1733
  REAL*8 :: temp1745b18
  REAL*8 :: temp1753b
  REAL*8 :: temp1770b10
  DOUBLE PRECISION :: temp1814
  REAL*8 :: temp1834b
  REAL*8 :: temp38b(3)
  DOUBLE PRECISION :: temp55b3
  DOUBLE PRECISION :: temp173(3)
  REAL*8 :: temp212b0
  DOUBLE PRECISION :: temp254
  REAL*8 :: temp310b1
  DOUBLE PRECISION :: temp335
  REAL*8 :: temp364b
  REAL*8 :: temp416
  REAL*8 :: temp428b1
  DOUBLE PRECISION :: temp499b3
  REAL*8 :: temp582b0
  REAL*8 :: temp607b
  DOUBLE PRECISION :: temp607b2
  REAL*8 :: temp698b62
  REAL*8 :: temp737b8
  REAL*8 :: temp744b0
  DOUBLE PRECISION :: temp786
  REAL*8 :: temp798b1
  REAL*8 :: temp828b12
  REAL*8 :: temp830
  REAL*8 :: temp857b5
  DOUBLE PRECISION :: temp867
  REAL*8 :: temp896b
  REAL*8 :: temp906b0
  REAL*8 :: temp909b12
  DOUBLE PRECISION :: temp911
  DOUBLE PRECISION :: temp940b
  DOUBLE PRECISION :: temp948
  REAL*8 :: temp977b
  REAL*8 :: temp977b2
  REAL*8 :: temp981b30
  REAL*8 :: temp1016b3
  REAL*8 :: temp1030b29
  DOUBLE PRECISION :: temp1075
  REAL*8 :: temp1072b1
  REAL*8 :: temp1156
  DOUBLE PRECISION :: temp1200
  REAL*8 :: temp1212b5
  REAL*8 :: temp1217b0
  REAL*8 :: temp1234b1
  DOUBLE PRECISION :: temp1237
  DOUBLE PRECISION :: temp1266b
  REAL*8 :: temp1310b
  DOUBLE PRECISION :: temp1318
  REAL*8 :: temp1369b2
  REAL*8 :: temp1413b2
  DOUBLE PRECISION :: temp1509b
  REAL*8 :: temp1570
  REAL*8 :: temp1587b0
  REAL*8 :: temp1651
  REAL*8 :: temp1680b(3)
  DOUBLE PRECISION :: temp1680b6
  REAL*8 :: temp1685b1
  REAL*8 :: temp1688
  REAL*8 :: temp1712b0
  DOUBLE PRECISION :: temp1732
  REAL*8 :: temp1745b17
  REAL*8 :: temp1749b0
  DOUBLE PRECISION :: temp1761b
  REAL*8 :: temp1766b1
  REAL*8 :: temp1769
  DOUBLE PRECISION :: temp1813
  REAL*8 :: temp46b
  DOUBLE PRECISION :: temp55b2
  DOUBLE PRECISION :: temp172(3)
  REAL*8 :: temp185b0
  DOUBLE PRECISION :: temp253
  DOUBLE PRECISION :: temp291b
  REAL*8 :: temp310b0
  DOUBLE PRECISION :: temp334
  REAL*8 :: temp415
  REAL*8 :: temp428b0
  REAL*8 :: temp453b
  DOUBLE PRECISION :: temp499b2
  REAL*8 :: temp534b
  REAL*8 :: temp615b
  DOUBLE PRECISION :: temp607b1
  REAL*8 :: temp698b61
  REAL*8 :: temp737b7
  DOUBLE PRECISION :: temp785
  REAL*8 :: temp798b0
  REAL*8 :: temp828b11
  REAL*8 :: temp857b4
  REAL*8 :: temp866
  REAL*8 :: temp909b11
  DOUBLE PRECISION :: temp910
  REAL*8 :: temp923b0
  DOUBLE PRECISION :: temp947
  REAL*8 :: temp977b1
  REAL*8 :: temp985b
  REAL*8 :: temp1016b2
  REAL*8 :: temp1030b28
  REAL*8 :: temp1074
  REAL*8 :: temp1072b0
  DOUBLE PRECISION :: temp1155
  REAL*8 :: temp1153b0
  REAL*8 :: temp1193b
  REAL*8 :: temp1212b4
  DOUBLE PRECISION :: temp1236
  REAL*8 :: temp1234b0
  DOUBLE PRECISION :: temp1317
  REAL*8 :: temp1315b0
  REAL*8 :: temp1369b1
  REAL*8 :: temp1413b1
  REAL*8 :: temp1436b
  REAL*8 :: temp1517b
  DOUBLE PRECISION :: temp1650
  DOUBLE PRECISION :: temp1680b5
  REAL*8 :: temp1685b0
  REAL*8 :: temp1687
  DOUBLE PRECISION :: temp1731
  REAL*8 :: temp1745b16
  REAL*8 :: temp1766b0
  DOUBLE PRECISION :: temp1768
  DOUBLE PRECISION :: temp1812
  REAL*8 :: temp54b
  DOUBLE PRECISION :: temp55b1
  REAL*8 :: temp129b1
  DOUBLE PRECISION :: temp171(3)
  DOUBLE PRECISION :: temp252
  DOUBLE PRECISION :: temp289
  DOUBLE PRECISION :: temp333
  REAL*8 :: temp381b1
  REAL*8 :: temp380b
  DOUBLE PRECISION :: temp414
  DOUBLE PRECISION :: temp440b5
  REAL*8 :: temp461b
  DOUBLE PRECISION :: temp498b
  DOUBLE PRECISION :: temp499b1
  REAL*8 :: temp579b
  DOUBLE PRECISION :: temp592b7
  REAL*8 :: temp607b0
  REAL*8 :: temp698b60
  REAL*8 :: temp704b
  REAL*8 :: temp737b6
  DOUBLE PRECISION :: temp748b19
  DOUBLE PRECISION :: temp784
  REAL*8 :: temp828b10
  REAL*8 :: temp857b3
  DOUBLE PRECISION :: temp865
  REAL*8 :: temp909b10
  DOUBLE PRECISION :: temp946
  DOUBLE PRECISION :: temp955b4
  REAL*8 :: temp977b0
  REAL*8 :: temp993b
  REAL*8 :: temp1016b1
  REAL*8 :: temp1030b27
  DOUBLE PRECISION :: temp1073
  DOUBLE PRECISION :: temp1154
  REAL*8 :: temp1168b3
  REAL*8 :: temp1212b3
  DOUBLE PRECISION :: temp1235
  REAL*8 :: temp1251b0
  REAL*8 :: temp1288b0
  DOUBLE PRECISION :: temp1316
  DOUBLE PRECISION :: temp1363b
  REAL*8 :: temp1369b0
  REAL*8 :: temp1413b0
  REAL*8 :: temp1444b
  DOUBLE PRECISION :: temp1511b1
  DOUBLE PRECISION :: temp1525b
  REAL*8 :: temp1548b1
  DOUBLE PRECISION :: temp1680b4
  REAL*8 :: temp1686
  DOUBLE PRECISION :: temp1730
  REAL*8 :: temp1745b15
  DOUBLE PRECISION :: temp1767
  DOUBLE PRECISION :: temp1811
  INTRINSIC ABS
  REAL*8 :: temp55b0
  DOUBLE PRECISION :: temp62b(3)
  REAL*8 :: temp129b0
  REAL*8 :: temp136b(3)
  DOUBLE PRECISION :: temp170(3)
  REAL*8 :: temp251
  DOUBLE PRECISION :: temp288
  DOUBLE PRECISION :: temp332
  DOUBLE PRECISION :: temp369
  REAL*8 :: temp381b0
  DOUBLE PRECISION :: temp413
  REAL*8 :: temp440b4
  REAL*8 :: temp462b0
  DOUBLE PRECISION :: temp472b9
  REAL*8 :: temp499b0
  DOUBLE PRECISION :: temp543b0
  REAL*8 :: temp592b6
  REAL*8 :: temp597b1
  REAL*8 :: temp624b0
  REAL*8 :: temp678b1
  REAL*8 :: temp737b5
  REAL*8 :: temp748b18
  REAL*8 :: temp749b
  REAL*8 :: temp752b22
  DOUBLE PRECISION :: temp783
  REAL*8 :: temp857b2
  DOUBLE PRECISION :: temp864
  REAL*8 :: temp901b2
  DOUBLE PRECISION :: temp945
  REAL*8 :: temp955b3
  REAL*8 :: temp1016b0
  REAL*8 :: temp1026b9
  REAL*8 :: temp1030b26
  DOUBLE PRECISION :: temp1072
  DOUBLE PRECISION :: temp1153
  REAL*8 :: temp1168b2
  REAL*8 :: temp1212b2
  REAL*8 :: temp1234
  REAL*8 :: temp1315
  DOUBLE PRECISION :: temp1371b
  REAL*8 :: temp1386b0
  REAL*8 :: temp1511b0
  DOUBLE PRECISION :: temp1533b
  REAL*8 :: temp1548b0
  REAL*8 :: temp1565b1
  DOUBLE PRECISION :: temp1680b3
  REAL*8 :: temp1685
  REAL*8 :: temp1745b14
  DOUBLE PRECISION :: temp1766
  DOUBLE PRECISION :: temp1810
  REAL*8 :: temp70b(3)
  REAL*8 :: temp144b
  REAL*8 :: temp225b
  DOUBLE PRECISION :: temp250
  DOUBLE PRECISION :: temp287
  DOUBLE PRECISION :: temp331
  REAL*8 :: temp368
  DOUBLE PRECISION :: temp412
  REAL*8 :: temp440b3
  REAL*8 :: temp449
  REAL*8 :: temp472b8
  DOUBLE PRECISION :: temp592b5
  REAL*8 :: temp597b0
  REAL*8 :: temp641b0
  REAL*8 :: temp678b0
  REAL*8 :: temp720b
  REAL*8 :: temp737b4
  REAL*8 :: temp748b17
  REAL*8 :: temp752b21
  REAL*8 :: temp757b
  REAL*8 :: temp776b1
  DOUBLE PRECISION :: temp782
  REAL*8 :: temp803b0
  REAL*8 :: temp857b1
  DOUBLE PRECISION :: temp863
  REAL*8 :: temp901b1
  DOUBLE PRECISION :: temp919b
  DOUBLE PRECISION :: temp944
  REAL*8 :: temp955b2
  REAL*8 :: temp1016b21
  REAL*8 :: temp1026b8
  REAL*8 :: temp1030b25
  REAL*8 :: temp1046b
  DOUBLE PRECISION :: temp1071
  REAL*8 :: temp1127b
  DOUBLE PRECISION :: temp1152
  REAL*8 :: temp1168b1
  DOUBLE PRECISION :: temp1189
  DOUBLE PRECISION :: temp1208b
  REAL*8 :: temp1212b1
  REAL*8 :: temp1233
  REAL*8 :: temp1310b2
  DOUBLE PRECISION :: temp1314
  REAL*8 :: temp1460b
  REAL*8 :: temp1484b0
  DOUBLE PRECISION :: temp1497b
  REAL*8 :: temp1565b0
  DOUBLE PRECISION :: temp1622b
  REAL*8 :: temp1659b
  DOUBLE PRECISION :: temp1684
  DOUBLE PRECISION :: temp1680b2
  REAL*8 :: temp1703b
  REAL*8 :: temp1745b13
  DOUBLE PRECISION :: temp1765
  REAL*8 :: temp1808b0
  REAL*8 :: temp1814b16
  DOUBLE PRECISION :: temp19
  REAL*8 :: temp152b
  DOUBLE PRECISION :: temp180b1
  DOUBLE PRECISION :: temp195b5
  REAL*8 :: temp204b19
  DOUBLE PRECISION :: temp233b
  REAL*8 :: temp261b1
  REAL*8 :: temp286
  DOUBLE PRECISION :: temp330
  DOUBLE PRECISION :: temp367
  REAL*8 :: temp411
  REAL*8 :: temp440b2
  DOUBLE PRECISION :: temp448
  REAL*8 :: temp472b7
  DOUBLE PRECISION :: temp529
  DOUBLE PRECISION :: temp592b4
  REAL*8 :: temp688b8
  REAL*8 :: temp737b3
  REAL*8 :: temp748b16
  REAL*8 :: temp752b20
  REAL*8 :: temp776b0
  REAL*8 :: temp781
  REAL*8 :: temp820b0
  REAL*8 :: temp846b
  REAL*8 :: temp857b0
  DOUBLE PRECISION :: temp862
  DOUBLE PRECISION :: temp899
  REAL*8 :: temp901b0
  REAL*8 :: temp938b0
  DOUBLE PRECISION :: temp943
  REAL*8 :: temp955b1
  DOUBLE PRECISION :: temp1016b20
  REAL*8 :: temp1026b7
  REAL*8 :: temp1030b24
  REAL*8 :: temp1050b0
  DOUBLE PRECISION :: temp1054b
  DOUBLE PRECISION :: temp1070
  REAL*8 :: temp1087b0
  REAL*8 :: temp1135b
  DOUBLE PRECISION :: temp1151
  REAL*8 :: temp1168b0
  DOUBLE PRECISION :: temp1188
  REAL*8 :: temp1212b0
  DOUBLE PRECISION :: temp1216b
  DOUBLE PRECISION :: temp1232
  REAL*8 :: temp1249b0
  DOUBLE PRECISION :: temp1269
  REAL*8 :: temp1310b1
  DOUBLE PRECISION :: temp1313
  REAL*8 :: temp1586b
  DOUBLE PRECISION :: temp1673b9
  REAL*8 :: temp1683
  DOUBLE PRECISION :: temp1680b1
  REAL*8 :: temp1711b
  REAL*8 :: temp1745b12
  DOUBLE PRECISION :: temp1764
  REAL*8 :: temp1814b15
  REAL*8 :: temp1829b
  REAL*8 :: temp1845
  REAL*8 :: temp18
  DOUBLE PRECISION :: temp180b0
  REAL*8 :: temp195b4
  DOUBLE PRECISION :: temp197b
  REAL*8 :: temp204b18
  DOUBLE PRECISION :: temp241b
  REAL*8 :: temp261b0
  REAL*8 :: temp285
  REAL*8 :: temp322b
  DOUBLE PRECISION :: temp366
  REAL*8 :: temp359b
  DOUBLE PRECISION :: temp410
  DOUBLE PRECISION :: temp403b
  REAL*8 :: temp440b1
  DOUBLE PRECISION :: temp447
  REAL*8 :: temp472b6
  DOUBLE PRECISION :: temp528
  REAL*8 :: temp592b3
  DOUBLE PRECISION :: temp609
  REAL*8 :: temp639b1
  DOUBLE PRECISION :: temp692b
  REAL*8 :: temp688b7
  REAL*8 :: temp737b2
  REAL*8 :: temp748b15
  REAL*8 :: temp773b
  REAL*8 :: temp774b16
  REAL*8 :: temp780
  REAL*8 :: temp854b
  REAL*8 :: temp861
  DOUBLE PRECISION :: temp898
  DOUBLE PRECISION :: temp942
  REAL*8 :: temp955b0
  REAL*8 :: temp965b9
  DOUBLE PRECISION :: temp979
  REAL*8 :: temp1026b6
  REAL*8 :: temp1030b23
  DOUBLE PRECISION :: temp1062b
  REAL*8 :: temp1150
  REAL*8 :: temp1187
  DOUBLE PRECISION :: temp1231
  REAL*8 :: temp1261b5
  DOUBLE PRECISION :: temp1268
  REAL*8 :: temp1266b0
  REAL*8 :: temp1283b1
  REAL*8 :: temp1305b
  DOUBLE PRECISION :: temp1312
  REAL*8 :: temp1310b0
  REAL*8 :: temp1349
  REAL*8 :: temp1526b1
  REAL*8 :: temp1607b1
  DOUBLE PRECISION :: temp1673b8
  DOUBLE PRECISION :: temp1682(3)
  REAL*8 :: temp1680b0(3)
  REAL*8 :: temp1745b11
  REAL*8 :: temp1756b
  DOUBLE PRECISION :: temp1763
  REAL*8 :: temp1761b0
  REAL*8 :: temp1800b
  REAL*8 :: temp1814b14
  REAL*8 :: temp1837b
  REAL*8 :: temp1844
  DOUBLE PRECISION :: temp17(3)
  REAL*8 :: temp178b2(3)
  REAL*8 :: temp195b3
  REAL*8 :: temp204b17
  DOUBLE PRECISION :: temp284
  REAL*8 :: temp286b
  DOUBLE PRECISION :: temp330b
  DOUBLE PRECISION :: temp365
  REAL*8 :: temp367b
  REAL*8 :: temp411b
  REAL*8 :: temp440b0
  DOUBLE PRECISION :: temp446
  REAL*8 :: temp472b5
  REAL*8 :: temp521b0
  DOUBLE PRECISION :: temp527
  DOUBLE PRECISION :: temp529b
  REAL*8 :: temp575b1
  REAL*8 :: temp592b2
  REAL*8 :: temp608
  REAL*8 :: temp639b0
  REAL*8 :: temp690b3
  REAL*8 :: temp688b6
  REAL*8 :: temp737b1
  REAL*8 :: temp748b14
  REAL*8 :: temp774b15
  DOUBLE PRECISION :: temp860
  REAL*8 :: temp862b
  DOUBLE PRECISION :: temp897
  REAL*8 :: temp941
  REAL*8 :: temp943b
  REAL*8 :: temp965b8
  DOUBLE PRECISION :: temp978
  REAL*8 :: temp1026b5
  REAL*8 :: temp1030b22
  REAL*8 :: temp1107b5
  REAL*8 :: temp1129b1
  REAL*8 :: temp1151b
  DOUBLE PRECISION :: temp1186
  DOUBLE PRECISION :: temp1188b
  DOUBLE PRECISION :: temp1230
  REAL*8 :: temp1261b4
  REAL*8 :: temp1267
  REAL*8 :: temp1283b0
  DOUBLE PRECISION :: temp1311
  REAL*8 :: temp1313b
  REAL*8 :: temp1348
  REAL*8 :: temp1381b1
  DOUBLE PRECISION :: temp1429
  REAL*8 :: temp1526b0
  REAL*8 :: temp1607b0
  REAL*8 :: temp1641b2
  DOUBLE PRECISION :: temp1673b7
  DOUBLE PRECISION :: temp1678b2
  DOUBLE PRECISION :: temp1681(3)
  REAL*8 :: temp1683b
  REAL*8 :: temp1695b3
  REAL*8 :: temp1745b10
  REAL*8 :: temp1762
  DOUBLE PRECISION :: temp1799
  DOUBLE PRECISION :: temp1814b13
  REAL*8 :: temp1843
  REAL*8 :: temp1845b
  DOUBLE PRECISION :: temp2b1
  DOUBLE PRECISION :: temp12b
  DOUBLE PRECISION :: temp16(3)
  REAL*8 :: temp49b
  REAL*8 :: temp178b1(3)
  REAL*8 :: temp195b2(3)
  REAL*8 :: temp204b16
  DOUBLE PRECISION :: temp283
  DOUBLE PRECISION :: temp364
  REAL*8 :: temp375b
  DOUBLE PRECISION :: temp445
  REAL*8 :: temp456b
  REAL*8 :: temp455b3
  REAL*8 :: temp472b4
  REAL*8 :: temp526
  REAL*8 :: temp575b0
  REAL*8 :: temp592b1
  DOUBLE PRECISION :: temp607
  REAL*8 :: temp690b2
  REAL*8 :: temp688b5
  REAL*8 :: temp737b0
  REAL*8 :: temp748b13
  REAL*8 :: temp774b14
  REAL*8 :: temp828b9
  DOUBLE PRECISION :: temp896
  REAL*8 :: temp909b9
  REAL*8 :: temp940
  REAL*8 :: temp951b
  REAL*8 :: temp965b7
  DOUBLE PRECISION :: temp977
  REAL*8 :: temp1026b4
  REAL*8 :: temp1030b21
  REAL*8 :: temp1048b0
  REAL*8 :: temp1107b4
  REAL*8 :: temp1129b0
  DOUBLE PRECISION :: temp1185
  REAL*8 :: temp1240b
  REAL*8 :: temp1261b3
  DOUBLE PRECISION :: temp1266
  REAL*8 :: temp1277b
  REAL*8 :: temp1310
  DOUBLE PRECISION :: temp1347
  REAL*8 :: temp1358b
  REAL*8 :: temp1381b0
  DOUBLE PRECISION :: temp1428
  REAL*8 :: temp1439b
  REAL*8 :: temp1462b0
  REAL*8 :: temp1499b0
  REAL*8 :: temp1509
  REAL*8 :: temp1543b0
  REAL*8 :: temp1597b1
  REAL*8 :: temp1641b1
  DOUBLE PRECISION :: temp1673b6
  DOUBLE PRECISION :: temp1678b1
  DOUBLE PRECISION :: temp1680(3)
  REAL*8 :: temp1691b
  REAL*8 :: temp1695b2
  DOUBLE PRECISION :: temp1761
  REAL*8 :: temp1772b
  DOUBLE PRECISION :: temp1798
  REAL*8 :: temp1803b1
  REAL*8 :: temp1814b12
  DOUBLE PRECISION :: temp1842(3)
  DOUBLE PRECISION :: temp1840b13
  DOUBLE PRECISION :: temp2b0
  DOUBLE PRECISION :: temp6b
  DOUBLE PRECISION :: temp15(3)
  REAL*8 :: temp20b
  REAL*8 :: temp65b3
  REAL*8 :: temp178b0(3)
  REAL*8 :: temp195b1(3)
  REAL*8 :: temp204b15
  DOUBLE PRECISION :: temp259b0
  DOUBLE PRECISION :: temp282
  REAL*8 :: temp363
  DOUBLE PRECISION :: temp444
  REAL*8 :: temp455b2
  REAL*8 :: temp464b
  REAL*8 :: temp472b3
  DOUBLE PRECISION :: temp525
  REAL*8 :: temp545b
  REAL*8 :: temp592b0
  DOUBLE PRECISION :: temp606
  DOUBLE PRECISION :: temp673b0
  REAL*8 :: temp690b1
  REAL*8 :: temp688b4
  DOUBLE PRECISION :: temp707b
  REAL*8 :: temp748b12
  REAL*8 :: temp754b0
  DOUBLE PRECISION :: temp774b13
  REAL*8 :: temp828b8
  REAL*8 :: temp835b0
  DOUBLE PRECISION :: temp895
  REAL*8 :: temp909b8
  REAL*8 :: temp933b1
  REAL*8 :: temp965b6
  DOUBLE PRECISION :: temp976
  REAL*8 :: temp1026b3
  REAL*8 :: temp1030b20
  REAL*8 :: temp1065b0
  REAL*8 :: temp1107b3
  REAL*8 :: temp1184
  REAL*8 :: temp1261b2
  DOUBLE PRECISION :: temp1265
  DOUBLE PRECISION :: temp1285b
  REAL*8 :: temp1325b1
  DOUBLE PRECISION :: temp1346
  DOUBLE PRECISION :: temp1410b
  DOUBLE PRECISION :: temp1427
  REAL*8 :: temp1447b
  REAL*8 :: temp1477b3
  DOUBLE PRECISION :: temp1508
  REAL*8 :: temp1558b3
  REAL*8 :: temp1597b0
  DOUBLE PRECISION :: temp1609b
  REAL*8 :: temp1641b0
  DOUBLE PRECISION :: temp1673b5
  REAL*8 :: temp1678b0
  REAL*8 :: temp1695b1
  REAL*8 :: temp1722b0
  DOUBLE PRECISION :: temp1760
  REAL*8 :: temp1759b0
  REAL*8 :: temp1797
  REAL*8 :: temp1803b0
  REAL*8 :: temp1814b11
  DOUBLE PRECISION :: temp1841(3)
  DOUBLE PRECISION :: temp1840b12
  REAL*8 :: temp14(3)
  REAL*8 :: temp65b(3)
  REAL*8 :: temp65b2(3)
  DOUBLE PRECISION :: temp102b
  REAL*8 :: temp139b
  REAL*8 :: temp195b0(3)
  REAL*8 :: temp204b14
  REAL*8 :: temp281
  REAL*8 :: temp293b1
  DOUBLE PRECISION :: temp362
  DOUBLE PRECISION :: temp399
  REAL*8 :: temp391b
  DOUBLE PRECISION :: temp443
  REAL*8 :: temp455b1
  REAL*8 :: temp472b
  REAL*8 :: temp472b2
  DOUBLE PRECISION :: temp524
  DOUBLE PRECISION :: temp605
  REAL*8 :: temp690b0
  REAL*8 :: temp688b3
  REAL*8 :: temp715b
  DOUBLE PRECISION :: temp715b2
  REAL*8 :: temp748b11
  REAL*8 :: temp774b12
  REAL*8 :: temp828b7
  DOUBLE PRECISION :: temp894
  REAL*8 :: temp909b7
  REAL*8 :: temp933b0
  REAL*8 :: temp965b5
  DOUBLE PRECISION :: temp975
  REAL*8 :: temp1004b
  REAL*8 :: temp1026b2
  REAL*8 :: temp1060b4
  REAL*8 :: temp1107b2
  DOUBLE PRECISION :: temp1183
  REAL*8 :: temp1244b0
  REAL*8 :: temp1261b1
  DOUBLE PRECISION :: temp1264
  REAL*8 :: temp1325b0
  REAL*8 :: temp1345
  REAL*8 :: temp1374b
  REAL*8 :: temp1406b0
  DOUBLE PRECISION :: temp1426
  REAL*8 :: temp1477b2
  DOUBLE PRECISION :: temp1507
  REAL*8 :: temp1536b
  REAL*8 :: temp1558b2
  DOUBLE PRECISION :: temp1673b4
  REAL*8 :: temp1695b0
  DOUBLE PRECISION :: temp1796
  REAL*8 :: temp1814b10
  DOUBLE PRECISION :: temp1840(3)
  DOUBLE PRECISION :: temp1840b11
  REAL*8 :: temp13
  REAL*8 :: temp65b1(3)
  DOUBLE PRECISION :: temp73b
  DOUBLE PRECISION :: temp109(3)
  REAL*8 :: temp147b
  DOUBLE PRECISION :: temp200b2
  REAL*8 :: temp204b13
  DOUBLE PRECISION :: temp228b
  DOUBLE PRECISION :: temp280
  REAL*8 :: temp293b0
  REAL*8 :: temp309b
  DOUBLE PRECISION :: temp361
  REAL*8 :: temp398
  REAL*8 :: temp391b1
  DOUBLE PRECISION :: temp442
  REAL*8 :: temp455b0
  REAL*8 :: temp472b1
  DOUBLE PRECISION :: temp479
  REAL*8 :: temp480b
  DOUBLE PRECISION :: temp523
  DOUBLE PRECISION :: temp561b
  DOUBLE PRECISION :: temp604
  DOUBLE PRECISION :: temp598b
  REAL*8 :: temp642b
  REAL*8 :: temp688b2
  REAL*8 :: temp715b1
  REAL*8 :: temp748b10
  REAL*8 :: temp774b11
  REAL*8 :: temp828b6
  DOUBLE PRECISION :: temp893
  REAL*8 :: temp909b6
  REAL*8 :: temp965b4
  DOUBLE PRECISION :: temp974
  REAL*8 :: temp987b0
  REAL*8 :: temp1012b
  REAL*8 :: temp1026b1
  REAL*8 :: temp1060b3
  REAL*8 :: temp1107b1
  DOUBLE PRECISION :: temp1182
  REAL*8 :: temp1261b0
  DOUBLE PRECISION :: temp1263
  REAL*8 :: temp1298b0
  REAL*8 :: temp1344
  DOUBLE PRECISION :: temp1425
  REAL*8 :: temp1477b1
  DOUBLE PRECISION :: temp1506
  REAL*8 :: temp1544b
  REAL*8 :: temp1558b1
  REAL*8 :: temp1602b1
  DOUBLE PRECISION :: temp1625b
  DOUBLE PRECISION :: temp1673b3
  REAL*8 :: temp1706b
  REAL*8 :: temp1737b2
  REAL*8 :: temp1793b0
  DOUBLE PRECISION :: temp1795
  DOUBLE PRECISION :: temp1840b10
  DOUBLE PRECISION :: temp12
  DOUBLE PRECISION :: temp49(3)
  REAL*8 :: temp65b0(3)
  DOUBLE PRECISION :: temp81b
  REAL*8 :: temp108(3)
  DOUBLE PRECISION :: temp155b
  DOUBLE PRECISION :: temp200b1
  REAL*8 :: temp204b12
  REAL*8 :: temp236b
  DOUBLE PRECISION :: temp360
  REAL*8 :: temp397
  REAL*8 :: temp391b0
  REAL*8 :: temp441
  REAL*8 :: temp472b0
  DOUBLE PRECISION :: temp478
  DOUBLE PRECISION :: temp522
  DOUBLE PRECISION :: temp559
  REAL*8 :: temp570b1
  DOUBLE PRECISION :: temp603
  REAL*8 :: temp687b
  REAL*8 :: temp688b1
  REAL*8 :: temp715b0
  REAL*8 :: temp719b39
  REAL*8 :: temp731b
  REAL*8 :: temp769b1
  DOUBLE PRECISION :: temp768b
  REAL*8 :: temp774b10
  REAL*8 :: temp806b9
  REAL*8 :: temp828b5
  REAL*8 :: temp892
  REAL*8 :: temp909b5
  REAL*8 :: temp965b3
  DOUBLE PRECISION :: temp973
  REAL*8 :: temp1008b31
  REAL*8 :: temp1020b
  REAL*8 :: temp1026b0
  REAL*8 :: temp1058b5
  REAL*8 :: temp1060b2
  DOUBLE PRECISION :: temp1101b
  REAL*8 :: temp1107b0
  REAL*8 :: temp1138b
  DOUBLE PRECISION :: temp1181
  REAL*8 :: temp1219b
  DOUBLE PRECISION :: temp1262
  DOUBLE PRECISION :: temp1299
  DOUBLE PRECISION :: temp1343
  REAL*8 :: temp1396b0
  DOUBLE PRECISION :: temp1424
  REAL*8 :: temp1471b
  REAL*8 :: temp1477b0
  DOUBLE PRECISION :: temp1505
  REAL*8 :: temp1519b3
  REAL*8 :: temp1552b
  REAL*8 :: temp1558b0
  REAL*8 :: temp1575b1
  REAL*8 :: temp1592b2
  REAL*8 :: temp1589b
  REAL*8 :: temp1602b0
  REAL*8 :: temp1633b
  DOUBLE PRECISION :: temp1673b2
  REAL*8 :: temp1714b
  REAL*8 :: temp1737b1
  DOUBLE PRECISION :: temp1794
  DOUBLE PRECISION :: temp11
  REAL*8 :: temp26b2(3)
  REAL*8 :: temp48
  REAL*8 :: temp107
  REAL*8 :: temp163b
  DOUBLE PRECISION :: temp200b0
  REAL*8 :: temp204b11
  DOUBLE PRECISION :: temp396
  REAL*8 :: temp440
  DOUBLE PRECISION :: temp477
  REAL*8 :: temp521
  DOUBLE PRECISION :: temp558
  REAL*8 :: temp570b0
  REAL*8 :: temp602
  DOUBLE PRECISION :: temp639
  DOUBLE PRECISION :: temp651b0
  REAL*8 :: temp688b0
  REAL*8 :: temp698b9
  REAL*8 :: temp719b38
  REAL*8 :: temp769b0
  REAL*8 :: temp776b
  REAL*8 :: temp806b8
  REAL*8 :: temp820b
  REAL*8 :: temp828b4
  REAL*8 :: temp830b1
  REAL*8 :: temp857b
  DOUBLE PRECISION :: temp891
  DOUBLE PRECISION :: temp901b
  REAL*8 :: temp909b4
  DOUBLE PRECISION :: temp938b
  REAL*8 :: temp965b2
  DOUBLE PRECISION :: temp972
  DOUBLE PRECISION :: temp1009
  REAL*8 :: temp1008b30
  REAL*8 :: temp1058b4
  REAL*8 :: temp1060b1
  REAL*8 :: temp1065b
  DOUBLE PRECISION :: temp1180
  DOUBLE PRECISION :: temp1261
  REAL*8 :: temp1298
  DOUBLE PRECISION :: temp1342
  DOUBLE PRECISION :: temp1379
  DOUBLE PRECISION :: temp1423
  DOUBLE PRECISION :: temp1504
  REAL*8 :: temp1519b2
  REAL*8 :: temp1575b0
  REAL*8 :: temp1592b1
  REAL*8 :: temp1597b
  REAL*8 :: temp1641b
  DOUBLE PRECISION :: temp1666b9
  REAL*8 :: temp1678b
  DOUBLE PRECISION :: temp1673b1
  REAL*8 :: temp1700b0
  REAL*8 :: temp1722b
  REAL*8 :: temp1737b0
  REAL*8 :: temp1759b
  DOUBLE PRECISION :: temp1793
  REAL*8 :: temp1803b
  REAL*8 :: temp10
  REAL*8 :: temp26b1(3)
  DOUBLE PRECISION :: temp47
  DOUBLE PRECISION :: temp106
  DOUBLE PRECISION :: temp171b(3)
  REAL*8 :: temp204b10
  REAL*8 :: temp252b
  REAL*8 :: temp333b
  DOUBLE PRECISION :: temp395
  REAL*8 :: temp416b0
  REAL*8 :: temp426b9
  REAL*8 :: temp476
  DOUBLE PRECISION :: temp520
  DOUBLE PRECISION :: temp557
  DOUBLE PRECISION :: temp601
  REAL*8 :: temp638
  REAL*8 :: temp698b8
  REAL*8 :: temp719b37
  REAL*8 :: temp719
  REAL*8 :: temp786b0
  REAL*8 :: temp806b7
  REAL*8 :: temp828b3
  REAL*8 :: temp830b0
  DOUBLE PRECISION :: temp865b
  REAL*8 :: temp884b1
  DOUBLE PRECISION :: temp890
  REAL*8 :: temp894b15
  REAL*8 :: temp909b3
  REAL*8 :: temp911b0
  REAL*8 :: temp943b5
  REAL*8 :: temp965b1
  DOUBLE PRECISION :: temp971
  DOUBLE PRECISION :: temp1004b2
  DOUBLE PRECISION :: temp1008
  DOUBLE PRECISION :: temp1019b6
  REAL*8 :: temp1058b3
  REAL*8 :: temp1060b0
  REAL*8 :: temp1097b0
  REAL*8 :: temp1141b0
  REAL*8 :: temp1222b0
  DOUBLE PRECISION :: temp1260
  REAL*8 :: temp1259b0
  DOUBLE PRECISION :: temp1297
  REAL*8 :: temp1316b
  REAL*8 :: temp1341
  REAL*8 :: temp1378
  REAL*8 :: temp1416b5
  REAL*8 :: temp1422
  REAL*8 :: temp1438b1
  REAL*8 :: temp1459
  DOUBLE PRECISION :: temp1503
  REAL*8 :: temp1519b1
  REAL*8 :: temp1592b0
  DOUBLE PRECISION :: temp1666b8
  REAL*8 :: temp1673b0(3)
  DOUBLE PRECISION :: temp1686b
  REAL*8 :: temp1715b3
  REAL*8 :: temp1730b
  REAL*8 :: temp1767b
  REAL*8 :: temp1792
  REAL*8 :: temp1835b0
  REAL*8 :: temp26b0(3)
  REAL*8 :: temp15b(3)
  REAL*8 :: temp46
  DOUBLE PRECISION :: temp105
  REAL*8 :: temp297b
  REAL*8 :: temp341b
  DOUBLE PRECISION :: temp394
  DOUBLE PRECISION :: temp389b0
  REAL*8 :: temp422b
  REAL*8 :: temp426b8
  REAL*8 :: temp433b0
  REAL*8 :: temp459b
  REAL*8 :: temp475
  DOUBLE PRECISION :: temp503b
  REAL*8 :: temp531b1
  REAL*8 :: temp556
  DOUBLE PRECISION :: temp600
  DOUBLE PRECISION :: temp637
  REAL*8 :: temp698b7
  DOUBLE PRECISION :: temp718
  REAL*8 :: temp719b36
  DOUBLE PRECISION :: temp792b
  REAL*8 :: temp806b6
  REAL*8 :: temp828b2
  REAL*8 :: temp884b0
  REAL*8 :: temp894b9
  REAL*8 :: temp894b14
  REAL*8 :: temp909b2
  REAL*8 :: temp943b4
  REAL*8 :: temp965b0
  DOUBLE PRECISION :: temp970
  REAL*8 :: temp982b1
  REAL*8 :: temp1004b1
  DOUBLE PRECISION :: temp1007
  REAL*8 :: temp1019b5
  REAL*8 :: temp1026b10
  REAL*8 :: temp1058b2
  REAL*8 :: temp1162b
  REAL*8 :: temp1199b
  REAL*8 :: temp1195b0
  DOUBLE PRECISION :: temp1243b
  REAL*8 :: temp1276b0
  DOUBLE PRECISION :: temp1296
  REAL*8 :: temp1320b0
  DOUBLE PRECISION :: temp1340
  DOUBLE PRECISION :: temp1377
  REAL*8 :: temp1416b4
  DOUBLE PRECISION :: temp1421
  REAL*8 :: temp1438b0
  DOUBLE PRECISION :: temp1458
  DOUBLE PRECISION :: temp1502
  REAL*8 :: temp1519b0
  DOUBLE PRECISION :: temp1539
  REAL*8 :: temp1666b7(3)
  REAL*8 :: temp1694b
  REAL*8 :: temp1715b2
  REAL*8 :: temp1775b
  DOUBLE PRECISION :: temp1791
  REAL*8 :: temp9b(3)
  REAL*8 :: temp23b
  REAL*8 :: temp45
  REAL*8 :: temp104
  DOUBLE PRECISION :: temp188b2
  REAL*8 :: temp393
  REAL*8 :: temp426b7
  REAL*8 :: temp430b
  REAL*8 :: temp474
  DOUBLE PRECISION :: temp511b
  REAL*8 :: temp531b0
  REAL*8 :: temp555
  REAL*8 :: temp629b
  DOUBLE PRECISION :: temp636
  REAL*8 :: temp698b6
  REAL*8 :: temp717
  REAL*8 :: temp719b35
  REAL*8 :: temp806b5
  REAL*8 :: temp828b1
  DOUBLE PRECISION :: temp881b
  REAL*8 :: temp894b8
  REAL*8 :: temp894b13
  REAL*8 :: temp909b1
  REAL*8 :: temp943b3
  DOUBLE PRECISION :: temp962b
  REAL*8 :: temp982b0
  DOUBLE PRECISION :: temp999b
  REAL*8 :: temp1004b0
  REAL*8 :: temp1006
  REAL*8 :: temp1014b9
  DOUBLE PRECISION :: temp1014b12
  REAL*8 :: temp1019b4
  REAL*8 :: temp1058b1
  REAL*8 :: temp1156b2
  REAL*8 :: temp1251b
  DOUBLE PRECISION :: temp1288b
  DOUBLE PRECISION :: temp1295
  REAL*8 :: temp1369b
  DOUBLE PRECISION :: temp1376
  REAL*8 :: temp1374b0
  DOUBLE PRECISION :: temp1413b
  REAL*8 :: temp1416b3
  DOUBLE PRECISION :: temp1420
  DOUBLE PRECISION :: temp1457
  DOUBLE PRECISION :: temp1501
  DOUBLE PRECISION :: temp1538
  REAL*8 :: temp1536b0
  REAL*8 :: temp1570b2
  DOUBLE PRECISION :: temp1619
  REAL*8 :: temp1666b6(3)
  REAL*8 :: temp1715b1
  DOUBLE PRECISION :: temp1790
  REAL*8 :: temp31b
  DOUBLE PRECISION :: temp44
  REAL*8 :: temp58b3
  DOUBLE PRECISION :: temp103
  DOUBLE PRECISION :: temp188b1
  REAL*8 :: temp232b1
  REAL*8 :: temp269b1
  DOUBLE PRECISION :: temp392
  REAL*8 :: temp394b
  REAL*8 :: temp426b6
  REAL*8 :: temp473
  DOUBLE PRECISION :: temp554
  REAL*8 :: temp556b
  DOUBLE PRECISION :: temp635
  DOUBLE PRECISION :: temp637b
  REAL*8 :: temp683b1
  REAL*8 :: temp698b5
  REAL*8 :: temp698b29
  DOUBLE PRECISION :: temp716
  REAL*8 :: temp719b34
  REAL*8 :: temp806b4
  REAL*8 :: temp806b19
  REAL*8 :: temp828b0
  REAL*8 :: temp894b7
  DOUBLE PRECISION :: temp894b12
  REAL*8 :: temp909b0
  REAL*8 :: temp926b1
  REAL*8 :: temp943b2
  REAL*8 :: temp970b
  REAL*8 :: temp975b7
  DOUBLE PRECISION :: temp1005
  REAL*8 :: temp1014b8
  REAL*8 :: temp1014b11
  REAL*8 :: temp1019b3
  REAL*8 :: temp1058b0
  REAL*8 :: temp1102b0
  REAL*8 :: temp1156b1
  REAL*8 :: temp1237b1
  REAL*8 :: temp1294
  REAL*8 :: temp1296b
  DOUBLE PRECISION :: temp1375
  DOUBLE PRECISION :: temp1377b
  REAL*8 :: temp1416b2
  DOUBLE PRECISION :: temp1421b
  DOUBLE PRECISION :: temp1456
  DOUBLE PRECISION :: temp1500
  REAL*8 :: temp1537
  REAL*8 :: temp1570b1
  REAL*8 :: temp1618
  REAL*8 :: temp1666b5
  REAL*8 :: temp1715b0
  REAL*8 :: temp1769b1
  REAL*8 :: temp1788b22
  REAL*8 :: temp1813b1
  REAL*8 :: temp43
  REAL*8 :: temp58b2(3)
  DOUBLE PRECISION :: temp76b(3)
  DOUBLE PRECISION :: temp102
  REAL*8 :: temp113b
  REAL*8 :: temp139
  DOUBLE PRECISION :: temp188b0
  REAL*8 :: temp232b0
  REAL*8 :: temp269b0
  DOUBLE PRECISION :: temp367b1
  DOUBLE PRECISION :: temp391
  REAL*8 :: temp426b5
  REAL*8 :: temp472
  DOUBLE PRECISION :: temp553
  REAL*8 :: temp634
  REAL*8 :: temp683b0
  REAL*8 :: temp698b4
  REAL*8 :: temp698b28
  DOUBLE PRECISION :: temp715
  REAL*8 :: temp719b33
  DOUBLE PRECISION :: temp726b
  REAL*8 :: temp737b15
  REAL*8 :: temp774b9
  REAL*8 :: temp806b3
  REAL*8 :: temp806b18
  REAL*8 :: temp807b
  REAL*8 :: temp894b6
  REAL*8 :: temp894b11
  REAL*8 :: temp926b0
  REAL*8 :: temp943b1
  REAL*8 :: temp975b6
  DOUBLE PRECISION :: temp1004
  REAL*8 :: temp1014b7
  REAL*8 :: temp1014b10
  DOUBLE PRECISION :: temp1015b
  REAL*8 :: temp1019b2
  REAL*8 :: temp1075b0
  REAL*8 :: temp1156b0
  REAL*8 :: temp1237b0
  DOUBLE PRECISION :: temp1293
  DOUBLE PRECISION :: temp1374
  REAL*8 :: temp1389b2
  DOUBLE PRECISION :: temp1385b
  REAL*8 :: temp1416b1
  DOUBLE PRECISION :: temp1455
  REAL*8 :: temp1536
  DOUBLE PRECISION :: temp1547b
  REAL*8 :: temp1570b0
  DOUBLE PRECISION :: temp1617
  REAL*8 :: temp1628b
  REAL*8 :: temp1666b4
  REAL*8 :: temp1688b0
  REAL*8 :: temp1709b
  REAL*8 :: temp1769b0
  REAL*8 :: temp1788b21
  REAL*8 :: temp1813b0
  DOUBLE PRECISION :: temp42
  REAL*8 :: temp58b1(3)
  DOUBLE PRECISION :: temp75b2(3)
  DOUBLE PRECISION :: temp79
  REAL*8 :: temp84b(3)
  DOUBLE PRECISION :: temp101
  DOUBLE PRECISION :: temp138(3)
  REAL*8 :: temp158b(3)
  REAL*8 :: temp210b3
  DOUBLE PRECISION :: temp219
  REAL*8 :: temp286b0
  DOUBLE PRECISION :: temp367b0
  REAL*8 :: temp390
  REAL*8 :: temp411b0
  REAL*8 :: temp426b4
  REAL*8 :: temp471
  REAL*8 :: temp482b2
  REAL*8 :: temp491b
  DOUBLE PRECISION :: temp529b0
  DOUBLE PRECISION :: temp552
  DOUBLE PRECISION :: temp589
  DOUBLE PRECISION :: temp633
  REAL*8 :: temp653b
  REAL*8 :: temp698b3
  REAL*8 :: temp698b27
  DOUBLE PRECISION :: temp708b1
  DOUBLE PRECISION :: temp714
  REAL*8 :: temp719b32
  REAL*8 :: temp719b69
  REAL*8 :: temp737b14
  REAL*8 :: temp774b8
  REAL*8 :: temp791b9
  REAL*8 :: temp806b2
  REAL*8 :: temp806b17
  REAL*8 :: temp862b0
  REAL*8 :: temp894b5
  REAL*8 :: temp894b10
  REAL*8 :: temp943b0
  REAL*8 :: temp975b5
  DOUBLE PRECISION :: temp1003
  REAL*8 :: temp1014b6
  REAL*8 :: temp1019b1
  DOUBLE PRECISION :: temp1023b
  DOUBLE PRECISION :: temp1104b
  REAL*8 :: temp1188b4
  DOUBLE PRECISION :: temp1292
  REAL*8 :: temp1367b5
  DOUBLE PRECISION :: temp1373
  REAL*8 :: temp1389b1
  REAL*8 :: temp1416b0
  DOUBLE PRECISION :: temp1454
  DOUBLE PRECISION :: temp1474b
  DOUBLE PRECISION :: temp1535
  REAL*8 :: temp1555b
  DOUBLE PRECISION :: temp1616
  REAL*8 :: temp1636b
  REAL*8 :: temp1666b3
  DOUBLE PRECISION :: temp1666b16
  REAL*8 :: temp1717b
  REAL*8 :: temp1788b20
  DOUBLE PRECISION :: temp1840b9
  REAL*8 :: temp41
  REAL*8 :: temp58b0(3)
  DOUBLE PRECISION :: temp75b1
  DOUBLE PRECISION :: temp78(3)
  REAL*8 :: temp100
  REAL*8 :: temp92b
  DOUBLE PRECISION :: temp137(3)
  REAL*8 :: temp166b
  REAL*8 :: temp210b
  REAL*8 :: temp210b2
  DOUBLE PRECISION :: temp218
  REAL*8 :: temp247b
  REAL*8 :: temp328b
  DOUBLE PRECISION :: temp328b2
  REAL*8 :: temp409b
  REAL*8 :: temp426b3
  REAL*8 :: temp470
  REAL*8 :: temp482b1
  REAL*8 :: temp551
  REAL*8 :: temp563b1
  REAL*8 :: temp580b
  REAL*8 :: temp588
  DOUBLE PRECISION :: temp632
  DOUBLE PRECISION :: temp669
  REAL*8 :: temp698b
  REAL*8 :: temp698b2
  REAL*8 :: temp698b26
  REAL*8 :: temp708b0
  DOUBLE PRECISION :: temp713
  REAL*8 :: temp719b31
  REAL*8 :: temp719b68
  REAL*8 :: temp737b13
  REAL*8 :: temp774b7
  REAL*8 :: temp791b8
  REAL*8 :: temp806b1
  REAL*8 :: temp806b16
  REAL*8 :: temp823b
  REAL*8 :: temp894b4
  REAL*8 :: temp975b4
  DOUBLE PRECISION :: temp1002
  REAL*8 :: temp1014b5
  REAL*8 :: temp1019b0
  REAL*8 :: temp1039
  REAL*8 :: temp1031b
  DOUBLE PRECISION :: temp1068b
  DOUBLE PRECISION :: temp1112b
  REAL*8 :: temp1188b3
  DOUBLE PRECISION :: temp1291
  REAL*8 :: temp1352b0
  REAL*8 :: temp1367b4
  DOUBLE PRECISION :: temp1372
  REAL*8 :: temp1389b0
  REAL*8 :: temp1453
  REAL*8 :: temp1531b1
  DOUBLE PRECISION :: temp1534
  DOUBLE PRECISION :: temp1615
  REAL*8 :: temp1644b
  DOUBLE PRECISION :: temp1666b2
  DOUBLE PRECISION :: temp1666b15
  REAL*8 :: temp1806b
  DOUBLE PRECISION :: temp1840b8
  DOUBLE PRECISION :: temp40(3)
  DOUBLE PRECISION :: temp75b0
  DOUBLE PRECISION :: temp77(3)
  DOUBLE PRECISION :: temp136(3)
  REAL*8 :: temp174b
  REAL*8 :: temp183b2(3)
  REAL*8 :: temp210b1
  REAL*8 :: temp217
  REAL*8 :: temp255b
  DOUBLE PRECISION :: temp316b28
  REAL*8 :: temp336b
  DOUBLE PRECISION :: temp328b1
  REAL*8 :: temp417b
  REAL*8 :: temp409b1
  REAL*8 :: temp426b2
  REAL*8 :: temp482b0
  DOUBLE PRECISION :: temp550
  REAL*8 :: temp563b0
  REAL*8 :: temp580b1
  DOUBLE PRECISION :: temp587
  DOUBLE PRECISION :: temp631
  REAL*8 :: temp668
  REAL*8 :: temp698b1
  REAL*8 :: temp698b25
  DOUBLE PRECISION :: temp712
  REAL*8 :: temp719b30
  REAL*8 :: temp719b67
  DOUBLE PRECISION :: temp737b12
  REAL*8 :: temp749
  REAL*8 :: temp774b6
  DOUBLE PRECISION :: temp787b
  REAL*8 :: temp791b7
  REAL*8 :: temp806b0
  REAL*8 :: temp806b15
  REAL*8 :: temp823b1
  REAL*8 :: temp831b
  DOUBLE PRECISION :: temp857b19
  REAL*8 :: temp894b3
  REAL*8 :: temp949b
  REAL*8 :: temp975b3
  DOUBLE PRECISION :: temp1001
  REAL*8 :: temp1014b4
  DOUBLE PRECISION :: temp1038
  DOUBLE PRECISION :: temp1076b
  DOUBLE PRECISION :: temp1119
  REAL*8 :: temp1188b2
  DOUBLE PRECISION :: temp1201b
  DOUBLE PRECISION :: temp1290
  DOUBLE PRECISION :: temp1319b
  REAL*8 :: temp1367b3
  DOUBLE PRECISION :: temp1371
  REAL*8 :: temp1450b0
  DOUBLE PRECISION :: temp1452
  DOUBLE PRECISION :: temp1489
  REAL*8 :: temp1531b0
  DOUBLE PRECISION :: temp1533
  DOUBLE PRECISION :: temp1614
  REAL*8 :: temp1612b0
  REAL*8 :: temp1649b0
  DOUBLE PRECISION :: temp1666b1
  DOUBLE PRECISION :: temp1666b14
  DOUBLE PRECISION :: temp1689b
  REAL*8 :: temp1814b
  DOUBLE PRECISION :: temp1840b7
  INTRINSIC SUM
  REAL*8 :: temp18b
  DOUBLE PRECISION :: temp76(3)
  REAL*8 :: temp135(3)
  REAL*8 :: temp183b1(3)
  REAL*8 :: temp210b0
  DOUBLE PRECISION :: temp216
  REAL*8 :: temp264b1
  REAL*8 :: temp263b
  DOUBLE PRECISION :: temp316b27
  DOUBLE PRECISION :: temp328b0
  REAL*8 :: temp344b
  DOUBLE PRECISION :: temp345b1
  REAL*8 :: temp409b0
  REAL*8 :: temp426b1
  REAL*8 :: temp506b
  REAL*8 :: temp580b0
  DOUBLE PRECISION :: temp586
  DOUBLE PRECISION :: temp630
  DOUBLE PRECISION :: temp667
  REAL*8 :: temp698b0
  REAL*8 :: temp698b24
  DOUBLE PRECISION :: temp711
  REAL*8 :: temp719b66
  REAL*8 :: temp737b11
  DOUBLE PRECISION :: temp748
  REAL*8 :: temp752b9
  REAL*8 :: temp774b5
  REAL*8 :: temp791b6
  REAL*8 :: temp806b14
  REAL*8 :: temp823b0
  DOUBLE PRECISION :: temp829
  REAL*8 :: temp857b18
  REAL*8 :: temp861b22
  REAL*8 :: temp894b2
  REAL*8 :: temp920b
  REAL*8 :: temp957b
  REAL*8 :: temp975b2
  REAL*8 :: temp981b29
  DOUBLE PRECISION :: temp1000
  REAL*8 :: temp1014b3
  DOUBLE PRECISION :: temp1037
  DOUBLE PRECISION :: temp1118
  REAL*8 :: temp1134b0
  DOUBLE PRECISION :: temp1165b
  REAL*8 :: temp1188b1
  REAL*8 :: temp1330b2
  REAL*8 :: temp1367b2
  DOUBLE PRECISION :: temp1370
  DOUBLE PRECISION :: temp1451
  DOUBLE PRECISION :: temp1488
  DOUBLE PRECISION :: temp1532
  DOUBLE PRECISION :: temp1569
  REAL*8 :: temp1613
  DOUBLE PRECISION :: temp1660b
  REAL*8 :: temp1666b0
  DOUBLE PRECISION :: temp1666b13
  REAL*8 :: temp1697b
  REAL*8 :: temp1741b
  REAL*8 :: temp1747b0
  DOUBLE PRECISION :: temp1778b
  REAL*8 :: temp1822b
  DOUBLE PRECISION :: temp1840b6
  REAL*8 :: temp5b3
  REAL*8 :: temp26b
  REAL*8 :: temp70b3
  DOUBLE PRECISION :: temp75(3)
  REAL*8 :: temp134
  REAL*8 :: temp183b0(3)
  DOUBLE PRECISION :: temp215
  REAL*8 :: temp264b0
  DOUBLE PRECISION :: temp316b26
  DOUBLE PRECISION :: temp345b0
  REAL*8 :: temp399b1
  DOUBLE PRECISION :: temp389b
  REAL*8 :: temp426b0
  REAL*8 :: temp433b
  DOUBLE PRECISION :: temp585
  DOUBLE PRECISION :: temp666
  REAL*8 :: temp698b23
  DOUBLE PRECISION :: temp710
  REAL*8 :: temp719b65
  REAL*8 :: temp737b10
  DOUBLE PRECISION :: temp747
  REAL*8 :: temp752b8
  REAL*8 :: temp774b4
  REAL*8 :: temp791b5
  REAL*8 :: temp806b13
  DOUBLE PRECISION :: temp828
  REAL*8 :: temp857b17
  REAL*8 :: temp861b21
  REAL*8 :: temp877b0
  REAL*8 :: temp884b
  REAL*8 :: temp894b1
  REAL*8 :: temp909
  REAL*8 :: temp931b9
  REAL*8 :: temp965b
  DOUBLE PRECISION :: temp970b6
  REAL*8 :: temp975b1
  REAL*8 :: temp981b28
  REAL*8 :: temp1014b2
  REAL*8 :: temp1036
  DOUBLE PRECISION :: temp1117
  REAL*8 :: temp1151b0
  DOUBLE PRECISION :: temp1188b0
  REAL*8 :: temp1313b0
  REAL*8 :: temp1330b1
  REAL*8 :: temp1367b1
  REAL*8 :: temp1416b
  DOUBLE PRECISION :: temp1450
  REAL*8 :: temp1465b2
  DOUBLE PRECISION :: temp1487
  REAL*8 :: temp1497b7
  REAL*8 :: temp1531
  REAL*8 :: temp1529b1
  DOUBLE PRECISION :: temp1568
  DOUBLE PRECISION :: temp1612
  DOUBLE PRECISION :: temp1649
  DOUBLE PRECISION :: temp1666b12
  REAL*8 :: temp1693b9
  REAL*8 :: temp1845b0
  DOUBLE PRECISION :: temp1840b5
  REAL*8 :: temp5b2(3)
  DOUBLE PRECISION :: temp31b5
  REAL*8 :: temp34b
  REAL*8 :: temp70b2(3)
  DOUBLE PRECISION :: temp74
  DOUBLE PRECISION :: temp108b
  DOUBLE PRECISION :: temp133
  DOUBLE PRECISION :: temp214
  REAL*8 :: temp281b0
  DOUBLE PRECISION :: temp316b25
  REAL*8 :: temp399b0
  REAL*8 :: temp522b
  REAL*8 :: temp584
  REAL*8 :: temp603b
  DOUBLE PRECISION :: temp665
  REAL*8 :: temp698b22
  REAL*8 :: temp698b59
  REAL*8 :: temp719b64
  DOUBLE PRECISION :: temp746
  REAL*8 :: temp752b7
  REAL*8 :: temp774b3
  REAL*8 :: temp791b4
  REAL*8 :: temp806b12
  DOUBLE PRECISION :: temp827
  REAL*8 :: temp857b16
  REAL*8 :: temp861b20
  REAL*8 :: temp892b
  REAL*8 :: temp894b0
  DOUBLE PRECISION :: temp908
  REAL*8 :: temp931b8
  REAL*8 :: temp953b4
  REAL*8 :: temp970b5
  REAL*8 :: temp973b
  REAL*8 :: temp975b0
  REAL*8 :: temp981b27
  REAL*8 :: temp1014b1
  REAL*8 :: temp1035
  DOUBLE PRECISION :: temp1116
  REAL*8 :: temp1262b
  REAL*8 :: temp1286b0
  REAL*8 :: temp1299b
  REAL*8 :: temp1330b0
  REAL*8 :: temp1367b0
  REAL*8 :: temp1411b0
  REAL*8 :: temp1465b1
  DOUBLE PRECISION :: temp1486
  REAL*8 :: temp1505b
  REAL*8 :: temp1497b6
  DOUBLE PRECISION :: temp1530
  REAL*8 :: temp1529b0
  DOUBLE PRECISION :: temp1567
  DOUBLE PRECISION :: temp1611
  REAL*8 :: temp1648
  DOUBLE PRECISION :: temp1666b11
  REAL*8 :: temp1693b8
  DOUBLE PRECISION :: temp1729
  REAL*8 :: temp1794b
  REAL*8 :: temp1840b4(3)
  REAL*8 :: temp5b1(3)
  DOUBLE PRECISION :: temp31b4
  REAL*8 :: temp42b
  REAL*8 :: temp70b1(3)
  REAL*8 :: temp73
  REAL*8 :: temp79b(3)
  DOUBLE PRECISION :: temp132
  DOUBLE PRECISION :: temp169(3)
  REAL*8 :: temp213
  DOUBLE PRECISION :: temp316b24
  REAL*8 :: temp460b0
  REAL*8 :: temp486b
  REAL*8 :: temp567b
  REAL*8 :: temp583
  DOUBLE PRECISION :: temp611b
  REAL*8 :: temp664
  REAL*8 :: temp659b0
  REAL*8 :: temp698b21
  REAL*8 :: temp698b58
  REAL*8 :: temp719b63
  REAL*8 :: temp720b1
  REAL*8 :: temp745
  REAL*8 :: temp752b6
  REAL*8 :: temp757b1
  REAL*8 :: temp774b2
  REAL*8 :: temp791b3
  REAL*8 :: temp806b11
  DOUBLE PRECISION :: temp826
  REAL*8 :: temp857b15
  REAL*8 :: temp883b16
  DOUBLE PRECISION :: temp907
  REAL*8 :: temp931b7
  REAL*8 :: temp953b3
  REAL*8 :: temp970b4
  REAL*8 :: temp981b
  REAL*8 :: temp981b26
  REAL*8 :: temp1014b0
  REAL*8 :: temp1018b
  DOUBLE PRECISION :: temp1034
  REAL*8 :: temp1031b1
  DOUBLE PRECISION :: temp1115
  REAL*8 :: temp1384b0
  REAL*8 :: temp1388b
  REAL*8 :: temp1432b
  REAL*8 :: temp1465b0
  REAL*8 :: temp1485
  REAL*8 :: temp1497b5
  REAL*8 :: temp1513b
  REAL*8 :: temp1546b0
  DOUBLE PRECISION :: temp1566
  REAL*8 :: temp1580b2
  DOUBLE PRECISION :: temp1610
  REAL*8 :: temp1647
  DOUBLE PRECISION :: temp1666b10
  REAL*8 :: temp1693b7
  REAL*8 :: temp1711b19
  REAL*8 :: temp1728
  REAL*8 :: temp1809
  REAL*8 :: temp1840b3(3)
  REAL*8 :: temp5b0(3)
  REAL*8 :: temp14b2(3)
  DOUBLE PRECISION :: temp31b3
  REAL*8 :: temp70b0(3)
  REAL*8 :: temp72
  REAL*8 :: temp87b
  DOUBLE PRECISION :: temp131
  REAL*8 :: temp168
  DOUBLE PRECISION :: temp212
  DOUBLE PRECISION :: temp249
  REAL*8 :: temp279b1
  REAL*8 :: temp316b9
  REAL*8 :: temp316b23
  REAL*8 :: temp494b
  REAL*8 :: temp575b
  REAL*8 :: temp582
  REAL*8 :: temp663
  REAL*8 :: temp693b1
  REAL*8 :: temp698b20
  REAL*8 :: temp698b57
  REAL*8 :: temp700b
  REAL*8 :: temp719b62
  REAL*8 :: temp720b0
  REAL*8 :: temp737b
  DOUBLE PRECISION :: temp744
  REAL*8 :: temp752b5
  REAL*8 :: temp757b0
  REAL*8 :: temp774b1
  REAL*8 :: temp791b2
  REAL*8 :: temp806b10
  DOUBLE PRECISION :: temp825
  REAL*8 :: temp857b14
  REAL*8 :: temp883b15
  REAL*8 :: temp906
  REAL*8 :: temp919b0
  REAL*8 :: temp931b6
  REAL*8 :: temp953b2
  REAL*8 :: temp967b21
  REAL*8 :: temp970b3
  REAL*8 :: temp981b25
  REAL*8 :: temp1026b
  DOUBLE PRECISION :: temp1033
  REAL*8 :: temp1031b0
  REAL*8 :: temp1068b0
  REAL*8 :: temp1085b1
  REAL*8 :: temp1107b
  DOUBLE PRECISION :: temp1114
  REAL*8 :: temp1112b0
  REAL*8 :: temp1396b
  DOUBLE PRECISION :: temp1440b
  DOUBLE PRECISION :: temp1477b
  DOUBLE PRECISION :: temp1484
  REAL*8 :: temp1497b4
  REAL*8 :: temp1507b2
  DOUBLE PRECISION :: temp1558b
  DOUBLE PRECISION :: temp1565
  REAL*8 :: temp1580b1
  REAL*8 :: temp1602b
  DOUBLE PRECISION :: temp1646
  REAL*8 :: temp1693b6
  REAL*8 :: temp1693b19
  REAL*8 :: temp1711b18
  DOUBLE PRECISION :: temp1727
  DOUBLE PRECISION :: temp1808
  REAL*8 :: temp1806b0
  REAL*8 :: temp1840b2
  REAL*8 :: temp14b1(3)
  REAL*8 :: temp31b2
  REAL*8 :: temp71
  REAL*8 :: temp95b
  REAL*8 :: temp130
  REAL*8 :: temp132b
  DOUBLE PRECISION :: temp167
  REAL*8 :: temp169b
  REAL*8 :: temp203b3
  DOUBLE PRECISION :: temp211
  DOUBLE PRECISION :: temp248
  DOUBLE PRECISION :: temp242b0
  REAL*8 :: temp279b0
  REAL*8 :: temp316b8
  REAL*8 :: temp316b22
  REAL*8 :: temp329
  REAL*8 :: temp502b1
  REAL*8 :: temp539b1
  REAL*8 :: temp581
  DOUBLE PRECISION :: temp662
  REAL*8 :: temp664b
  REAL*8 :: temp693b0
  REAL*8 :: temp698b56
  DOUBLE PRECISION :: temp699
  REAL*8 :: temp719b61
  DOUBLE PRECISION :: temp743
  REAL*8 :: temp745b
  REAL*8 :: temp752b4
  REAL*8 :: temp752b19
  REAL*8 :: temp774b0
  REAL*8 :: temp791b1
  DOUBLE PRECISION :: temp824
  DOUBLE PRECISION :: temp826b
  REAL*8 :: temp857b13
  REAL*8 :: temp872b1
  REAL*8 :: temp883b14
  DOUBLE PRECISION :: temp905
  REAL*8 :: temp931b5
  REAL*8 :: temp953b1
  DOUBLE PRECISION :: temp967b20
  REAL*8 :: temp970b2
  REAL*8 :: temp981b24
  REAL*8 :: temp1016b19
  REAL*8 :: temp1024b7
  REAL*8 :: temp1032
  REAL*8 :: temp1046b3
  REAL*8 :: temp1069
  REAL*8 :: temp1085b0
  REAL*8 :: temp1113
  REAL*8 :: temp1166b0
  DOUBLE PRECISION :: temp1483
  REAL*8 :: temp1485b
  REAL*8 :: temp1497b3
  REAL*8 :: temp1507b1
  DOUBLE PRECISION :: temp1564
  REAL*8 :: temp1580b0
  REAL*8 :: temp1610b
  REAL*8 :: temp1622b3
  DOUBLE PRECISION :: temp1645
  REAL*8 :: temp1647b
  REAL*8 :: temp1693b5
  REAL*8 :: temp1693b18
  REAL*8 :: temp1698b0
  REAL*8 :: temp1703b3
  REAL*8 :: temp1711b17
  DOUBLE PRECISION :: temp1726
  REAL*8 :: temp1728b
  REAL*8 :: temp1742b0
  DOUBLE PRECISION :: temp1807
  REAL*8 :: temp1809b
  REAL*8 :: temp1840b1
  REAL*8 :: temp31b1(3)
  DOUBLE PRECISION :: temp14b0
  DOUBLE PRECISION :: temp70
  REAL*8 :: temp140b
  REAL*8 :: temp166
  REAL*8 :: temp203b2(3)
  REAL*8 :: temp210
  REAL*8 :: temp221b
  DOUBLE PRECISION :: temp247
  REAL*8 :: temp316b7
  REAL*8 :: temp316b21
  DOUBLE PRECISION :: temp328
  REAL*8 :: temp394b1
  DOUBLE PRECISION :: temp409
  REAL*8 :: temp458b0
  DOUBLE PRECISION :: temp474b26
  REAL*8 :: temp502b0
  REAL*8 :: temp539b0
  REAL*8 :: temp580
  DOUBLE PRECISION :: temp661
  REAL*8 :: temp698b55
  REAL*8 :: temp698
  REAL*8 :: temp719b60
  DOUBLE PRECISION :: temp742
  REAL*8 :: temp752b3
  REAL*8 :: temp752b18
  REAL*8 :: temp753b
  DOUBLE PRECISION :: temp779
  REAL*8 :: temp791b0
  REAL*8 :: temp823
  REAL*8 :: temp857b12
  REAL*8 :: temp872b0
  DOUBLE PRECISION :: temp883b13
  DOUBLE PRECISION :: temp904
  REAL*8 :: temp931b4
  REAL*8 :: temp953b0
  REAL*8 :: temp970b1
  REAL*8 :: temp981b23
  REAL*8 :: temp985b5
  REAL*8 :: temp1016b18
  REAL*8 :: temp1024b6
  DOUBLE PRECISION :: temp1031
  REAL*8 :: temp1046b2
  REAL*8 :: temp1042b
  DOUBLE PRECISION :: temp1068
  REAL*8 :: temp1079b
  DOUBLE PRECISION :: temp1112
  REAL*8 :: temp1123b
  DOUBLE PRECISION :: temp1149
  REAL*8 :: temp1183b0
  REAL*8 :: temp1281b1
  DOUBLE PRECISION :: temp1482
  REAL*8 :: temp1493b
  REAL*8 :: temp1497b2
  REAL*8 :: temp1507b0
  DOUBLE PRECISION :: temp1563
  DOUBLE PRECISION :: temp1574b
  REAL*8 :: temp1605b1
  REAL*8 :: temp1622b2
  REAL*8 :: temp1644
  REAL*8 :: temp1655b
  REAL*8 :: temp1693b4
  REAL*8 :: temp1693b17
  REAL*8 :: temp1703b2
  REAL*8 :: temp1711b16
  DOUBLE PRECISION :: temp1725
  REAL*8 :: temp1796b0
  DOUBLE PRECISION :: temp1806
  REAL*8 :: temp1817b
  REAL*8 :: temp1840b0
  REAL*8 :: temp31b0
  REAL*8 :: temp165
  DOUBLE PRECISION :: temp185b
  REAL*8 :: temp203b1(3)
  DOUBLE PRECISION :: temp246
  REAL*8 :: temp310b
  REAL*8 :: temp316b6
  REAL*8 :: temp316b20(3)
  DOUBLE PRECISION :: temp327
  DOUBLE PRECISION :: temp347b
  REAL*8 :: temp394b0
  REAL*8 :: temp408
  REAL*8 :: temp428b
  REAL*8 :: temp436b3
  DOUBLE PRECISION :: temp474b25
  REAL*8 :: temp556b0
  REAL*8 :: temp590b2
  DOUBLE PRECISION :: temp637b0
  DOUBLE PRECISION :: temp660
  DOUBLE PRECISION :: temp697
  REAL*8 :: temp698b54
  DOUBLE PRECISION :: temp741
  REAL*8 :: temp752b2
  REAL*8 :: temp752b17
  DOUBLE PRECISION :: temp778
  DOUBLE PRECISION :: temp798b
  DOUBLE PRECISION :: temp822
  DOUBLE PRECISION :: temp842b
  REAL*8 :: temp857b11
  DOUBLE PRECISION :: temp859
  REAL*8 :: temp883b12
  DOUBLE PRECISION :: temp903
  REAL*8 :: temp923b
  REAL*8 :: temp931b3
  REAL*8 :: temp963b8
  REAL*8 :: temp970b0
  REAL*8 :: temp981b22
  REAL*8 :: temp985b4
  REAL*8 :: temp1016b17
  REAL*8 :: temp1024b5
  REAL*8 :: temp1030
  REAL*8 :: temp1050b
  REAL*8 :: temp1046b1
  DOUBLE PRECISION :: temp1067
  REAL*8 :: temp1087b
  DOUBLE PRECISION :: temp1111
  REAL*8 :: temp1127b1
  DOUBLE PRECISION :: temp1131b
  DOUBLE PRECISION :: temp1148
  DOUBLE PRECISION :: temp1168b
  REAL*8 :: temp1212b
  DOUBLE PRECISION :: temp1229
  REAL*8 :: temp1249b
  REAL*8 :: temp1281b0
  REAL*8 :: temp1362b0
  REAL*8 :: temp1399b0
  REAL*8 :: temp1443b0
  DOUBLE PRECISION :: temp1481
  REAL*8 :: temp1497b1
  REAL*8 :: temp1524b0
  DOUBLE PRECISION :: temp1562
  DOUBLE PRECISION :: temp1599
  REAL*8 :: temp1605b0
  REAL*8 :: temp1622b1
  DOUBLE PRECISION :: temp1643
  REAL*8 :: temp1659b1
  REAL*8 :: temp1663b
  REAL*8 :: temp1693b3
  REAL*8 :: temp1693b16
  REAL*8 :: temp1703b1
  REAL*8 :: temp1711b15
  DOUBLE PRECISION :: temp1724
  DOUBLE PRECISION :: temp1805
  REAL*8 :: temp29b(3)
  DOUBLE PRECISION :: temp164
  REAL*8 :: temp203b0(3)
  DOUBLE PRECISION :: temp245
  REAL*8 :: temp257b1
  REAL*8 :: temp316b5
  DOUBLE PRECISION :: temp326
  REAL*8 :: temp355b
  DOUBLE PRECISION :: temp407
  REAL*8 :: temp436b
  REAL*8 :: temp436b2
  REAL*8 :: temp453b3
  DOUBLE PRECISION :: temp474b24
  REAL*8 :: temp517b
  REAL*8 :: temp590b1
  REAL*8 :: temp671b1
  REAL*8 :: temp696
  REAL*8 :: temp698b53
  DOUBLE PRECISION :: temp740
  REAL*8 :: temp752b1
  REAL*8 :: temp752b16
  DOUBLE PRECISION :: temp777
  REAL*8 :: temp816b0
  DOUBLE PRECISION :: temp821
  REAL*8 :: temp857b10
  REAL*8 :: temp858
  REAL*8 :: temp883b11
  REAL*8 :: temp902
  REAL*8 :: temp914b1
  REAL*8 :: temp931b
  REAL*8 :: temp931b2
  DOUBLE PRECISION :: temp939
  REAL*8 :: temp963b7
  DOUBLE PRECISION :: temp968b
  REAL*8 :: temp981b21
  REAL*8 :: temp985b3
  REAL*8 :: temp1016b16
  REAL*8 :: temp1024b4
  REAL*8 :: temp1046b0
  DOUBLE PRECISION :: temp1066
  REAL*8 :: temp1080b2
  REAL*8 :: temp1095b
  DOUBLE PRECISION :: temp1110
  REAL*8 :: temp1127b0
  DOUBLE PRECISION :: temp1147
  REAL*8 :: temp1176b
  REAL*8 :: temp1228
  DOUBLE PRECISION :: temp1309
  REAL*8 :: temp1338b
  REAL*8 :: temp1460b0
  DOUBLE PRECISION :: temp1480
  DOUBLE PRECISION :: temp1497b0
  DOUBLE PRECISION :: temp1561
  DOUBLE PRECISION :: temp1598
  REAL*8 :: temp1595b1
  REAL*8 :: temp1622b0
  DOUBLE PRECISION :: temp1642
  REAL*8 :: temp1659b0
  REAL*8 :: temp1671b
  REAL*8 :: temp1679
  REAL*8 :: temp1693b2
  REAL*8 :: temp1693b15
  REAL*8 :: temp1703b0
  REAL*8 :: temp1711b14
  REAL*8 :: temp1723
  REAL*8 :: temp1789b
  DOUBLE PRECISION :: temp1804
  REAL*8 :: temp1833b
  REAL*8 :: temp0b0
  DOUBLE PRECISION :: temp37b
  REAL*8 :: temp163
  DOUBLE PRECISION :: temp244
  REAL*8 :: temp257b0
  REAL*8 :: temp282b
  REAL*8 :: temp316b4
  REAL*8 :: temp325
  REAL*8 :: temp363b
  DOUBLE PRECISION :: temp406
  REAL*8 :: temp436b1
  REAL*8 :: temp453b2
  DOUBLE PRECISION :: temp474b23
  REAL*8 :: temp525b
  REAL*8 :: temp590b0
  REAL*8 :: temp588b3
  DOUBLE PRECISION :: temp606b
  REAL*8 :: temp671b0
  DOUBLE PRECISION :: temp695
  REAL*8 :: temp698b52
  REAL*8 :: temp752b0
  REAL*8 :: temp752b15
  REAL*8 :: temp776
  DOUBLE PRECISION :: temp820
  DOUBLE PRECISION :: temp857
  REAL*8 :: temp883b10
  DOUBLE PRECISION :: temp895b
  DOUBLE PRECISION :: temp901
  REAL*8 :: temp914b0
  REAL*8 :: temp931b1
  DOUBLE PRECISION :: temp938
  REAL*8 :: temp963b6
  REAL*8 :: temp981b20
  REAL*8 :: temp985b2
  REAL*8 :: temp1016b15
  REAL*8 :: temp1024b3
  REAL*8 :: temp1030b19
  REAL*8 :: temp1063b0
  DOUBLE PRECISION :: temp1065
  REAL*8 :: temp1080b1
  DOUBLE PRECISION :: temp1146
  REAL*8 :: temp1144b0
  REAL*8 :: temp1184b
  DOUBLE PRECISION :: temp1227
  DOUBLE PRECISION :: temp1308
  DOUBLE PRECISION :: temp1346b
  REAL*8 :: temp1427b
  DOUBLE PRECISION :: temp1560
  REAL*8 :: temp1597
  REAL*8 :: temp1595b0
  REAL*8 :: temp1641
  DOUBLE PRECISION :: temp1678
  REAL*8 :: temp1693b1
  REAL*8 :: temp1693b14
  REAL*8 :: temp1711b13
  REAL*8 :: temp1720b0
  DOUBLE PRECISION :: temp1722
  REAL*8 :: temp1730b9
  DOUBLE PRECISION :: temp1759
  REAL*8 :: temp1767b9
  REAL*8 :: temp1797b
  REAL*8 :: temp1803
  REAL*8 :: temp1838b0
  DOUBLE PRECISION :: temp162
  REAL*8 :: temp199
  DOUBLE PRECISION :: temp243
  REAL*8 :: temp316b3
  DOUBLE PRECISION :: temp324
  DOUBLE PRECISION :: temp371b
  DOUBLE PRECISION :: temp405
  REAL*8 :: temp436b0
  REAL*8 :: temp452b
  REAL*8 :: temp453b1
  DOUBLE PRECISION :: temp474b22
  REAL*8 :: temp489b
  REAL*8 :: temp534b1
  REAL*8 :: temp533b
  REAL*8 :: temp588b2
  REAL*8 :: temp614b
  DOUBLE PRECISION :: temp694
  REAL*8 :: temp698b51
  REAL*8 :: temp752b14
  DOUBLE PRECISION :: temp775
  DOUBLE PRECISION :: temp856
  DOUBLE PRECISION :: temp900
  REAL*8 :: temp931b0
  REAL*8 :: temp937
  REAL*8 :: temp963b5
  DOUBLE PRECISION :: temp984b
  REAL*8 :: temp985b1
  REAL*8 :: temp1016b14
  REAL*8 :: temp1024b2
  REAL*8 :: temp1030b18
  DOUBLE PRECISION :: temp1064
  REAL*8 :: temp1080b0
  DOUBLE PRECISION :: temp1145
  REAL*8 :: temp1161b0
  DOUBLE PRECISION :: temp1226
  DOUBLE PRECISION :: temp1307
  REAL*8 :: temp1323b0
  REAL*8 :: temp1354b
  REAL*8 :: temp1404b0
  DOUBLE PRECISION :: temp1596
  DOUBLE PRECISION :: temp1640
  REAL*8 :: temp1671b4
  DOUBLE PRECISION :: temp1677
  REAL*8 :: temp1686b8
  REAL*8 :: temp1693b0
  REAL*8 :: temp1693b13
  REAL*8 :: temp1711b12
  REAL*8 :: temp1721
  REAL*8 :: temp1730b8
  DOUBLE PRECISION :: temp1758
  REAL*8 :: temp1767b8
  DOUBLE PRECISION :: temp1802
  REAL*8 :: temp1839
  DOUBLE PRECISION :: temp2b
  DOUBLE PRECISION :: temp80b2
  DOUBLE PRECISION :: temp127b
  REAL*8 :: temp161
  DOUBLE PRECISION :: temp198
  DOUBLE PRECISION :: temp242
  DOUBLE PRECISION :: temp279
  DOUBLE PRECISION :: temp291b0
  REAL*8 :: temp316b2
  DOUBLE PRECISION :: temp323
  REAL*8 :: temp404
  REAL*8 :: temp453b0
  REAL*8 :: temp460b
  REAL*8 :: temp474b21
  REAL*8 :: temp534b0
  REAL*8 :: temp588b1
  REAL*8 :: temp659b
  DOUBLE PRECISION :: temp693
  REAL*8 :: temp698b50
  DOUBLE PRECISION :: temp703b
  REAL*8 :: temp752b13
  DOUBLE PRECISION :: temp774
  DOUBLE PRECISION :: temp855
  REAL*8 :: temp905b22
  REAL*8 :: temp929b2
  REAL*8 :: temp936
  REAL*8 :: temp963b4
  REAL*8 :: temp985b0
  REAL*8 :: temp1016b13
  REAL*8 :: temp1024b1
  DOUBLE PRECISION :: temp1029b
  REAL*8 :: temp1030b17
  DOUBLE PRECISION :: temp1063
  REAL*8 :: temp1144
  DOUBLE PRECISION :: temp1225
  REAL*8 :: temp1281b
  REAL*8 :: temp1296b0
  DOUBLE PRECISION :: temp1306
  DOUBLE PRECISION :: temp1362b
  REAL*8 :: temp1377b0
  REAL*8 :: temp1394b1
  DOUBLE PRECISION :: temp1399b
  REAL*8 :: temp1421b0
  DOUBLE PRECISION :: temp1443b
  REAL*8 :: temp1517b4
  DOUBLE PRECISION :: temp1524b
  DOUBLE PRECISION :: temp1595
  REAL*8 :: temp1605b
  REAL*8 :: temp1654b2
  REAL*8 :: temp1671b3
  REAL*8 :: temp1676
  REAL*8 :: temp1686b7
  REAL*8 :: temp1693b12
  REAL*8 :: temp1711b11
  DOUBLE PRECISION :: temp1720
  REAL*8 :: temp1730b7
  DOUBLE PRECISION :: temp1757
  REAL*8 :: temp1767b7
  DOUBLE PRECISION :: temp1801
  DOUBLE PRECISION :: temp1829b11
  REAL*8 :: temp1838
  REAL*8 :: temp61b
  DOUBLE PRECISION :: temp80b1
  REAL*8 :: temp100b0(3)
  REAL*8 :: temp98b(3)
  DOUBLE PRECISION :: temp135b
  DOUBLE PRECISION :: temp160(3)
  DOUBLE PRECISION :: temp197
  REAL*8 :: temp216b
  DOUBLE PRECISION :: temp241
  REAL*8 :: temp278
  REAL*8 :: temp316b1
  REAL*8 :: temp322
  DOUBLE PRECISION :: temp359
  DOUBLE PRECISION :: temp403
  REAL*8 :: temp474b20(3)
  REAL*8 :: temp551b0
  REAL*8 :: temp588b0
  REAL*8 :: temp630b
  DOUBLE PRECISION :: temp669b0
  DOUBLE PRECISION :: temp692
  REAL*8 :: temp748b
  REAL*8 :: temp752b12
  DOUBLE PRECISION :: temp773
  REAL*8 :: temp811b1
  REAL*8 :: temp829b
  REAL*8 :: temp854
  REAL*8 :: temp905b21
  REAL*8 :: temp929b1
  DOUBLE PRECISION :: temp935
  REAL*8 :: temp959b31
  REAL*8 :: temp963b3
  REAL*8 :: temp1016b12
  REAL*8 :: temp1024b0
  REAL*8 :: temp1030b16
  DOUBLE PRECISION :: temp1037b
  DOUBLE PRECISION :: temp1062
  DOUBLE PRECISION :: temp1099
  REAL*8 :: temp1105b0
  REAL*8 :: temp1118b
  DOUBLE PRECISION :: temp1143
  REAL*8 :: temp1176b2
  REAL*8 :: temp1193b3
  DOUBLE PRECISION :: temp1224
  DOUBLE PRECISION :: temp1305
  REAL*8 :: temp1338b2
  REAL*8 :: temp1394b0
  REAL*8 :: temp1451b
  REAL*8 :: temp1475b0
  REAL*8 :: temp1488b
  REAL*8 :: temp1517b3
  REAL*8 :: temp1532b
  DOUBLE PRECISION :: temp1569b
  DOUBLE PRECISION :: temp1594
  REAL*8 :: temp1613b
  REAL*8 :: temp1654b1
  DOUBLE PRECISION :: temp1671b2
  DOUBLE PRECISION :: temp1675(3)
  REAL*8 :: temp1686b6(3)
  REAL*8 :: temp1693b11
  REAL*8 :: temp1711b10
  REAL*8 :: temp1718b0
  REAL*8 :: temp1730b6
  REAL*8 :: temp1756
  REAL*8 :: temp1767b6
  DOUBLE PRECISION :: temp1800
  REAL*8 :: temp1816b1
  DOUBLE PRECISION :: temp1829b10
  REAL*8 :: temp1837
  DOUBLE PRECISION :: temp80b0
  DOUBLE PRECISION :: temp196
  REAL*8 :: temp224b
  DOUBLE PRECISION :: temp240
  DOUBLE PRECISION :: temp277
  REAL*8 :: temp305b
  REAL*8 :: temp316b0
  DOUBLE PRECISION :: temp321
  DOUBLE PRECISION :: temp358
  REAL*8 :: temp402
  DOUBLE PRECISION :: temp439
  REAL*8 :: temp594b
  REAL*8 :: temp675b
  DOUBLE PRECISION :: temp691
  REAL*8 :: temp752b11
  DOUBLE PRECISION :: temp756b
  DOUBLE PRECISION :: temp772
  REAL*8 :: temp811b0
  DOUBLE PRECISION :: temp837b
  DOUBLE PRECISION :: temp853
  REAL*8 :: temp905b20
  REAL*8 :: temp929b0
  DOUBLE PRECISION :: temp934
  REAL*8 :: temp959b30
  REAL*8 :: temp963b2
  REAL*8 :: temp1008b29
  REAL*8 :: temp1016b11
  REAL*8 :: temp1030b15
  DOUBLE PRECISION :: temp1061
  REAL*8 :: temp1098
  REAL*8 :: temp1122b0
  DOUBLE PRECISION :: temp1142
  REAL*8 :: temp1159b0
  REAL*8 :: temp1176b1
  DOUBLE PRECISION :: temp1179
  REAL*8 :: temp1193b2
  REAL*8 :: temp1207b
  REAL*8 :: temp1223
  REAL*8 :: temp1304
  REAL*8 :: temp1338b1
  REAL*8 :: temp1492b0
  REAL*8 :: temp1496b
  REAL*8 :: temp1517b2
  REAL*8 :: temp1540b
  DOUBLE PRECISION :: temp1593
  REAL*8 :: temp1654b0(3)
  REAL*8 :: temp1655b12
  DOUBLE PRECISION :: temp1658b
  DOUBLE PRECISION :: temp1671b1
  DOUBLE PRECISION :: temp1674(3)
  DOUBLE PRECISION :: temp1686b5
  REAL*8 :: temp1693b10
  REAL*8 :: temp1702b
  REAL*8 :: temp1730b5
  REAL*8 :: temp1745b9
  DOUBLE PRECISION :: temp1755
  REAL*8 :: temp1767b5
  REAL*8 :: temp1816b0
  REAL*8 :: temp1833b1
  DOUBLE PRECISION :: temp1836
  REAL*8 :: temp188b
  DOUBLE PRECISION :: temp195
  REAL*8 :: temp232b
  REAL*8 :: temp269b
  DOUBLE PRECISION :: temp276
  DOUBLE PRECISION :: temp320
  DOUBLE PRECISION :: temp357
  DOUBLE PRECISION :: temp401
  REAL*8 :: temp387b1
  REAL*8 :: temp438
  DOUBLE PRECISION :: temp519
  REAL*8 :: temp549b1
  REAL*8 :: temp683b
  DOUBLE PRECISION :: temp690
  REAL*8 :: temp752b10
  DOUBLE PRECISION :: temp771
  DOUBLE PRECISION :: temp852
  REAL*8 :: temp865b0
  REAL*8 :: temp882b1
  REAL*8 :: temp889
  REAL*8 :: temp926b
  REAL*8 :: temp933
  REAL*8 :: temp963b1
  REAL*8 :: temp1008b28
  REAL*8 :: temp1016b10
  REAL*8 :: temp1030b14
  DOUBLE PRECISION :: temp1060
  REAL*8 :: temp1097
  REAL*8 :: temp1095b0
  DOUBLE PRECISION :: temp1134b
  DOUBLE PRECISION :: temp1141
  DOUBLE PRECISION :: temp1178
  REAL*8 :: temp1176b0
  REAL*8 :: temp1193b1
  DOUBLE PRECISION :: temp1222
  DOUBLE PRECISION :: temp1259
  DOUBLE PRECISION :: temp1303
  REAL*8 :: temp1338b0
  REAL*8 :: temp1436b1
  REAL*8 :: temp1517b1
  REAL*8 :: temp1592
  REAL*8 :: temp1655b11
  REAL*8 :: temp1666b
  REAL*8 :: temp1671b0
  DOUBLE PRECISION :: temp1673(3)
  REAL*8 :: temp1686b4
  REAL*8 :: temp1713b3
  REAL*8 :: temp1730b4
  REAL*8 :: temp1745b8
  REAL*8 :: temp1747b
  DOUBLE PRECISION :: temp1754
  REAL*8 :: temp1767b4
  REAL*8 :: temp1789b0
  REAL*8 :: temp1828b
  REAL*8 :: temp1833b0
  INTEGER :: temp1835
  REAL*8 :: temp95b2(3)
  REAL*8 :: temp169b2(3)
  DOUBLE PRECISION :: temp194(3)
  DOUBLE PRECISION :: temp275
  DOUBLE PRECISION :: temp277b
  DOUBLE PRECISION :: temp326b7
  DOUBLE PRECISION :: temp356
  DOUBLE PRECISION :: temp358b
  DOUBLE PRECISION :: temp400
  REAL*8 :: temp387b0
  REAL*8 :: temp431b0
  DOUBLE PRECISION :: temp437
  DOUBLE PRECISION :: temp439b
  REAL*8 :: temp468b0
  DOUBLE PRECISION :: temp518
  DOUBLE PRECISION :: temp512b0
  REAL*8 :: temp549b0
  REAL*8 :: temp610b1
  REAL*8 :: temp647b1
  DOUBLE PRECISION :: temp770
  DOUBLE PRECISION :: temp772b
  REAL*8 :: temp826b2
  DOUBLE PRECISION :: temp851
  REAL*8 :: temp846b15
  DOUBLE PRECISION :: temp853b
  REAL*8 :: temp882b0
  REAL*8 :: temp888
  DOUBLE PRECISION :: temp932
  REAL*8 :: temp934b
  REAL*8 :: temp963b0
  DOUBLE PRECISION :: temp969
  REAL*8 :: temp977b10
  REAL*8 :: temp1008b27
  REAL*8 :: temp1030b13
  DOUBLE PRECISION :: temp1096
  REAL*8 :: temp1098b
  REAL*8 :: temp1140
  REAL*8 :: temp1142b
  DOUBLE PRECISION :: temp1177
  REAL*8 :: temp1179b
  REAL*8 :: temp1193b0
  DOUBLE PRECISION :: temp1221
  REAL*8 :: temp1223b
  DOUBLE PRECISION :: temp1258
  DOUBLE PRECISION :: temp1302
  REAL*8 :: temp1304b
  DOUBLE PRECISION :: temp1339
  REAL*8 :: temp1436b0
  REAL*8 :: temp1517b0
  DOUBLE PRECISION :: temp1591
  REAL*8 :: temp1655b10
  DOUBLE PRECISION :: temp1672
  REAL*8 :: temp1686b3
  REAL*8 :: temp1713b2
  REAL*8 :: temp1730b3
  REAL*8 :: temp1745b7
  DOUBLE PRECISION :: temp1753
  DOUBLE PRECISION :: temp1755b
  REAL*8 :: temp1767b3
  REAL*8 :: temp1834
  REAL*8 :: temp95b1(3)
  REAL*8 :: temp169b1(3)
  DOUBLE PRECISION :: temp193(3)
  REAL*8 :: temp274
  REAL*8 :: temp326b6
  DOUBLE PRECISION :: temp355
  REAL*8 :: temp436
  DOUBLE PRECISION :: temp447b
  DOUBLE PRECISION :: temp517
  DOUBLE PRECISION :: temp582b26
  REAL*8 :: temp610b0
  DOUBLE PRECISION :: temp609b
  REAL*8 :: temp647b0
  REAL*8 :: temp780b
  REAL*8 :: temp791b15
  REAL*8 :: temp826b1
  DOUBLE PRECISION :: temp850
  REAL*8 :: temp846b14
  REAL*8 :: temp861b
  DOUBLE PRECISION :: temp887
  DOUBLE PRECISION :: temp931
  REAL*8 :: temp942b
  DOUBLE PRECISION :: temp965b12
  DOUBLE PRECISION :: temp968
  REAL*8 :: temp979b
  REAL*8 :: temp995b4
  REAL*8 :: temp1008b26
  REAL*8 :: temp1030b12
  DOUBLE PRECISION :: temp1095
  REAL*8 :: temp1150b
  REAL*8 :: temp1176
  REAL*8 :: temp1187b
  DOUBLE PRECISION :: temp1220
  REAL*8 :: temp1231b
  DOUBLE PRECISION :: temp1257
  DOUBLE PRECISION :: temp1301
  REAL*8 :: temp1338
  REAL*8 :: temp1372b0
  DOUBLE PRECISION :: temp1419
  REAL*8 :: temp1453b0
  REAL*8 :: temp1534b0
  DOUBLE PRECISION :: temp1590
  REAL*8 :: temp1671
  REAL*8 :: temp1686b2
  REAL*8 :: temp1713b1
  REAL*8 :: temp1730b2
  REAL*8 :: temp1741b22
  REAL*8 :: temp1745b6
  DOUBLE PRECISION :: temp1752
  REAL*8 :: temp1767b2
  REAL*8 :: temp1789
  REAL*8 :: temp1833
  REAL*8 :: temp1844b
  REAL*8 :: temp11b
  REAL*8 :: temp73b4
  REAL*8 :: temp95b0(3)
  REAL*8 :: temp169b0(3)
  DOUBLE PRECISION :: temp192(3)
  DOUBLE PRECISION :: temp273
  REAL*8 :: temp293b
  DOUBLE PRECISION :: temp326b5
  DOUBLE PRECISION :: temp354
  REAL*8 :: temp348b1
  DOUBLE PRECISION :: temp435
  REAL*8 :: temp455b
  DOUBLE PRECISION :: temp516
  DOUBLE PRECISION :: temp582b25
  REAL*8 :: temp664b0
  REAL*8 :: temp745b0
  REAL*8 :: temp791b14
  REAL*8 :: temp826b0
  REAL*8 :: temp846b13
  DOUBLE PRECISION :: temp886
  DOUBLE PRECISION :: temp930
  REAL*8 :: temp965b11
  DOUBLE PRECISION :: temp967
  REAL*8 :: temp995b3
  REAL*8 :: temp987b
  REAL*8 :: temp1008b25
  REAL*8 :: temp1012b8
  REAL*8 :: temp1030b11
  DOUBLE PRECISION :: temp1094
  DOUBLE PRECISION :: temp1175
  REAL*8 :: temp1195b
  REAL*8 :: temp1252b2
  DOUBLE PRECISION :: temp1256
  DOUBLE PRECISION :: temp1276b
  REAL*8 :: temp1289b2
  DOUBLE PRECISION :: temp1300
  REAL*8 :: temp1316b1
  REAL*8 :: temp1320b
  DOUBLE PRECISION :: temp1337
  DOUBLE PRECISION :: temp1418
  REAL*8 :: temp1438b
  REAL*8 :: temp1470b0
  DOUBLE PRECISION :: temp1519b
  REAL*8 :: temp1632b0
  DOUBLE PRECISION :: temp1670
  REAL*8 :: temp1686b1
  REAL*8 :: temp1706b8
  REAL*8 :: temp1713b0
  REAL*8 :: temp1730b1
  REAL*8 :: temp1741b21
  REAL*8 :: temp1745b5
  DOUBLE PRECISION :: temp1751
  REAL*8 :: temp1767b1
  REAL*8 :: temp1784b2
  DOUBLE PRECISION :: temp1788
  REAL*8 :: temp1832
  REAL*8 :: temp5b(3)
  REAL*8 :: temp73b3
  REAL*8 :: temp191
  REAL*8 :: temp272
  DOUBLE PRECISION :: temp326b4
  DOUBLE PRECISION :: temp353
  REAL*8 :: temp348b0
  REAL*8 :: temp429b0
  REAL*8 :: temp434
  REAL*8 :: temp463b
  REAL*8 :: temp480b3
  DOUBLE PRECISION :: temp515
  REAL*8 :: temp527b1
  DOUBLE PRECISION :: temp582b24
  REAL*8 :: temp625b
  DOUBLE PRECISION :: temp706b
  REAL*8 :: temp762b0
  REAL*8 :: temp777b4
  REAL*8 :: temp791b13
  REAL*8 :: temp799b0
  DOUBLE PRECISION :: temp846b12
  REAL*8 :: temp885
  REAL*8 :: temp965b10
  DOUBLE PRECISION :: temp966
  REAL*8 :: temp995b
  REAL*8 :: temp995b2
  REAL*8 :: temp1008b24
  REAL*8 :: temp1012b7
  REAL*8 :: temp1030b10
  DOUBLE PRECISION :: temp1093
  DOUBLE PRECISION :: temp1174
  REAL*8 :: temp1171b1
  REAL*8 :: temp1252b1
  DOUBLE PRECISION :: temp1255
  REAL*8 :: temp1284b
  REAL*8 :: temp1289b1
  REAL*8 :: temp1316b0
  DOUBLE PRECISION :: temp1336
  REAL*8 :: temp1333b1
  REAL*8 :: temp1350b2
  REAL*8 :: temp1365b
  DOUBLE PRECISION :: temp1417
  REAL*8 :: temp1608b
  REAL*8 :: temp1686b0(3)
  REAL*8 :: temp1706b7
  REAL*8 :: temp1724b10
  REAL*8 :: temp1730b0
  REAL*8 :: temp1741b20
  REAL*8 :: temp1745b4
  REAL*8 :: temp1750
  REAL*8 :: temp1767b0
  REAL*8 :: temp1777b9
  DOUBLE PRECISION :: temp1787
  REAL*8 :: temp1784b1
  DOUBLE PRECISION :: temp1831(3)
  REAL*8 :: temp73b2
  REAL*8 :: temp101b
  REAL*8 :: temp147b2(3)
  DOUBLE PRECISION :: temp190(3)
  REAL*8 :: temp219b
  DOUBLE PRECISION :: temp271
  REAL*8 :: temp326b3
  DOUBLE PRECISION :: temp352
  DOUBLE PRECISION :: temp389
  DOUBLE PRECISION :: temp433
  REAL*8 :: temp446b0
  REAL*8 :: temp480b2
  DOUBLE PRECISION :: temp514
  REAL*8 :: temp527b0
  REAL*8 :: temp552b
  DOUBLE PRECISION :: temp582b23
  REAL*8 :: temp633b
  REAL*8 :: temp714b
  REAL*8 :: temp777b3
  DOUBLE PRECISION :: temp791b12
  REAL*8 :: temp846b11
  DOUBLE PRECISION :: temp884
  DOUBLE PRECISION :: temp965
  REAL*8 :: temp995b1
  REAL*8 :: temp1003b
  REAL*8 :: temp1008b23
  REAL*8 :: temp1012b6
  DOUBLE PRECISION :: temp1092
  REAL*8 :: temp1090b0
  DOUBLE PRECISION :: temp1173
  REAL*8 :: temp1171b0
  DOUBLE PRECISION :: temp1254
  REAL*8 :: temp1252b0
  REAL*8 :: temp1289b0
  REAL*8 :: temp1292b
  DOUBLE PRECISION :: temp1335
  REAL*8 :: temp1333b0
  REAL*8 :: temp1350b1
  REAL*8 :: temp1414b0
  DOUBLE PRECISION :: temp1416
  REAL*8 :: temp1454b
  REAL*8 :: temp1485b2
  REAL*8 :: temp1616b
  DOUBLE PRECISION :: temp1706b6
  REAL*8 :: temp1745b3
  REAL*8 :: temp1777b8
  DOUBLE PRECISION :: temp1786
  REAL*8 :: temp1784b0
  DOUBLE PRECISION :: temp1788b19
  DOUBLE PRECISION :: temp1830(3)
  REAL*8 :: temp73b1
  REAL*8 :: temp147b1(3)
  DOUBLE PRECISION :: temp270
  REAL*8 :: temp326b2
  DOUBLE PRECISION :: temp351
  DOUBLE PRECISION :: temp388
  REAL*8 :: temp432
  DOUBLE PRECISION :: temp469
  REAL*8 :: temp480b1
  DOUBLE PRECISION :: temp513
  DOUBLE PRECISION :: temp582b22
  REAL*8 :: temp597b
  REAL*8 :: temp642b1
  REAL*8 :: temp641b
  REAL*8 :: temp678b
  REAL*8 :: temp722b
  REAL*8 :: temp777b2
  REAL*8 :: temp791b11
  REAL*8 :: temp803b
  REAL*8 :: temp846b10
  DOUBLE PRECISION :: temp883
  DOUBLE PRECISION :: temp964
  REAL*8 :: temp973b4
  REAL*8 :: temp995b0
  REAL*8 :: temp1008b22
  REAL*8 :: temp1012b5
  DOUBLE PRECISION :: temp1011b
  REAL*8 :: temp1048b
  REAL*8 :: temp1091
  REAL*8 :: temp1129b
  DOUBLE PRECISION :: temp1172
  DOUBLE PRECISION :: temp1253
  DOUBLE PRECISION :: temp1334
  REAL*8 :: temp1350b0
  REAL*8 :: temp1381b
  DOUBLE PRECISION :: temp1415
  REAL*8 :: temp1431b0
  REAL*8 :: temp1462b
  REAL*8 :: temp1468b0
  REAL*8 :: temp1485b1
  REAL*8 :: temp1499b
  REAL*8 :: temp1543b
  REAL*8 :: temp1705b
  REAL*8 :: temp1706b5
  REAL*8 :: temp1745b2
  REAL*8 :: temp1777b7
  REAL*8 :: temp1785
  REAL*8 :: temp1788b18
  REAL*8 :: temp1792b22
  REAL*8 :: temp1809b1
  DOUBLE PRECISION :: temp39(3)
  REAL*8 :: temp73b0
  DOUBLE PRECISION :: temp80b
  REAL*8 :: temp147b0(3)
  DOUBLE PRECISION :: temp235b
  REAL*8 :: temp316b
  REAL*8 :: temp326b1
  DOUBLE PRECISION :: temp350
  DOUBLE PRECISION :: temp387
  DOUBLE PRECISION :: temp431
  DOUBLE PRECISION :: temp468
  REAL*8 :: temp480b0
  DOUBLE PRECISION :: temp512
  DOUBLE PRECISION :: temp549
  DOUBLE PRECISION :: temp561b0
  REAL*8 :: temp582b21
  REAL*8 :: temp642b0
  REAL*8 :: temp701b4
  REAL*8 :: temp719b29
  REAL*8 :: temp730b
  REAL*8 :: temp777b1
  REAL*8 :: temp791b10
  REAL*8 :: temp811b
  REAL*8 :: temp848b
  DOUBLE PRECISION :: temp882
  DOUBLE PRECISION :: temp929b
  DOUBLE PRECISION :: temp963
  DOUBLE PRECISION :: temp973b3
  REAL*8 :: temp1008b21
  REAL*8 :: temp1012b4
  REAL*8 :: temp1056b
  DOUBLE PRECISION :: temp1090
  DOUBLE PRECISION :: temp1171
  REAL*8 :: temp1252
  REAL*8 :: temp1267b2
  REAL*8 :: temp1289
  DOUBLE PRECISION :: temp1333
  DOUBLE PRECISION :: temp1414
  REAL*8 :: temp1470b
  REAL*8 :: temp1485b0
  DOUBLE PRECISION :: temp1551b
  DOUBLE PRECISION :: temp1588b
  REAL*8 :: temp1610b0
  DOUBLE PRECISION :: temp1632b
  REAL*8 :: temp1664b1
  REAL*8 :: temp1669b
  REAL*8 :: temp1706b4
  REAL*8 :: temp1713b
  REAL*8 :: temp1745b1
  REAL*8 :: temp1777b6
  DOUBLE PRECISION :: temp1784
  REAL*8 :: temp1788b17
  REAL*8 :: temp1792b21
  REAL*8 :: temp1809b0
  DOUBLE PRECISION :: temp38(3)
  REAL*8 :: temp108b2(3)
  REAL*8 :: temp162b
  REAL*8 :: temp199b
  REAL*8 :: temp243b
  REAL*8 :: temp324b
  REAL*8 :: temp326b0
  REAL*8 :: temp386
  REAL*8 :: temp405b
  DOUBLE PRECISION :: temp407b0
  REAL*8 :: temp430
  REAL*8 :: temp467
  DOUBLE PRECISION :: temp511
  REAL*8 :: temp548
  REAL*8 :: temp582b20(3)
  REAL*8 :: temp629
  REAL*8 :: temp694b
  REAL*8 :: temp701b3
  REAL*8 :: temp719b28
  REAL*8 :: temp775b
  DOUBLE PRECISION :: temp777b0
  REAL*8 :: temp858b0
  DOUBLE PRECISION :: temp881
  REAL*8 :: temp902b0
  DOUBLE PRECISION :: temp962
  REAL*8 :: temp973b2
  DOUBLE PRECISION :: temp999
  REAL*8 :: temp1008b20
  REAL*8 :: temp1012b3
  REAL*8 :: temp1132b0
  REAL*8 :: temp1145b
  DOUBLE PRECISION :: temp1170
  REAL*8 :: temp1169b0
  REAL*8 :: temp1226b
  REAL*8 :: temp1251
  REAL*8 :: temp1267b1
  DOUBLE PRECISION :: temp1288
  REAL*8 :: temp1307b
  DOUBLE PRECISION :: temp1332
  DOUBLE PRECISION :: temp1369
  DOUBLE PRECISION :: temp1413
  REAL*8 :: temp1625b3
  DOUBLE PRECISION :: temp1640b
  REAL*8 :: temp1664b0
  DOUBLE PRECISION :: temp1677b
  REAL*8 :: temp1706b3
  REAL*8 :: temp1721b
  REAL*8 :: temp1745b0
  REAL*8 :: temp1762b1
  REAL*8 :: temp1777b5
  DOUBLE PRECISION :: temp1783
  REAL*8 :: temp1788b16
  REAL*8 :: temp1792b20
  DOUBLE PRECISION :: temp1802b
  REAL*8 :: temp1826b0
  REAL*8 :: temp1839b
  REAL*8 :: temp37(3)
  REAL*8 :: temp108b1(3)
  REAL*8 :: temp125b2
  REAL*8 :: temp251b
  REAL*8 :: temp299b0
  DOUBLE PRECISION :: temp332b
  REAL*8 :: temp369b
  DOUBLE PRECISION :: temp385
  REAL*8 :: temp439b4
  REAL*8 :: temp466
  DOUBLE PRECISION :: temp510
  DOUBLE PRECISION :: temp547
  DOUBLE PRECISION :: temp628
  REAL*8 :: temp701b2
  REAL*8 :: temp709
  REAL*8 :: temp719b27
  DOUBLE PRECISION :: temp880
  REAL*8 :: temp875b0
  REAL*8 :: temp945b
  DOUBLE PRECISION :: temp961
  REAL*8 :: temp973b1
  REAL*8 :: temp998
  REAL*8 :: temp1012b2
  REAL*8 :: temp1030b42
  REAL*8 :: temp1072b
  REAL*8 :: temp1153b
  REAL*8 :: temp1234b
  DOUBLE PRECISION :: temp1250
  REAL*8 :: temp1267b0
  DOUBLE PRECISION :: temp1287
  REAL*8 :: temp1315b
  DOUBLE PRECISION :: temp1331
  DOUBLE PRECISION :: temp1368
  DOUBLE PRECISION :: temp1412
  REAL*8 :: temp1449
  REAL*8 :: temp1561b3
  REAL*8 :: temp1625b2
  REAL*8 :: temp1685b
  REAL*8 :: temp1706b2
  REAL*8 :: temp1762b0
  REAL*8 :: temp1766b
  REAL*8 :: temp1777b4
  DOUBLE PRECISION :: temp1782
  REAL*8 :: temp1788b15
  DOUBLE PRECISION :: temp14b
  REAL*8 :: temp36
  REAL*8 :: temp125b1(3)
  DOUBLE PRECISION :: temp108b0
  REAL*8 :: temp179b2
  DOUBLE PRECISION :: temp340b
  REAL*8 :: temp384
  REAL*8 :: temp421b
  REAL*8 :: temp439b3
  REAL*8 :: temp451b9
  REAL*8 :: temp458b
  DOUBLE PRECISION :: temp465
  REAL*8 :: temp502b
  REAL*8 :: temp539b
  DOUBLE PRECISION :: temp546
  DOUBLE PRECISION :: temp627
  REAL*8 :: temp657b1
  REAL*8 :: temp701b1
  REAL*8 :: temp708
  REAL*8 :: temp719b26
  REAL*8 :: temp791b
  REAL*8 :: temp861b19
  REAL*8 :: temp872b
  REAL*8 :: temp953b
  DOUBLE PRECISION :: temp960
  REAL*8 :: temp973b0
  REAL*8 :: temp997
  REAL*8 :: temp1012b1
  REAL*8 :: temp1030b41
  REAL*8 :: temp1080b
  REAL*8 :: temp1161b
  REAL*8 :: temp1284b0
  DOUBLE PRECISION :: temp1286
  REAL*8 :: temp1323b
  REAL*8 :: temp1330
  DOUBLE PRECISION :: temp1367
  REAL*8 :: temp1404b
  DOUBLE PRECISION :: temp1411
  DOUBLE PRECISION :: temp1448
  DOUBLE PRECISION :: temp1529
  REAL*8 :: temp1561b2
  REAL*8 :: temp1608b0
  REAL*8 :: temp1625b1
  REAL*8 :: temp1693b
  REAL*8 :: temp1706b1
  REAL*8 :: temp1777b3
  DOUBLE PRECISION :: temp1781
  REAL*8 :: temp1788b14
  DOUBLE PRECISION :: temp35
  DOUBLE PRECISION :: temp59b
  REAL*8 :: temp125b0
  DOUBLE PRECISION :: temp179b1
  DOUBLE PRECISION :: temp204b35
  DOUBLE PRECISION :: temp383
  DOUBLE PRECISION :: temp385b
  REAL*8 :: temp439b2
  REAL*8 :: temp451b8
  DOUBLE PRECISION :: temp464
  REAL*8 :: temp466b
  REAL*8 :: temp472b10
  DOUBLE PRECISION :: temp545
  DOUBLE PRECISION :: temp547b
  DOUBLE PRECISION :: temp626
  DOUBLE PRECISION :: temp628b
  DOUBLE PRECISION :: temp620b0
  REAL*8 :: temp657b0
  DOUBLE PRECISION :: temp701b0
  DOUBLE PRECISION :: temp707
  REAL*8 :: temp719b25
  DOUBLE PRECISION :: temp733b5
  REAL*8 :: temp738b0
  REAL*8 :: temp748b9
  REAL*8 :: temp772b2
  REAL*8 :: temp853b2
  REAL*8 :: temp861b18
  REAL*8 :: temp961b
  DOUBLE PRECISION :: temp996
  REAL*8 :: temp1012b0
  REAL*8 :: temp1030b40
  REAL*8 :: temp1228b1
  DOUBLE PRECISION :: temp1285
  DOUBLE PRECISION :: temp1366
  REAL*8 :: temp1407b2
  DOUBLE PRECISION :: temp1410
  DOUBLE PRECISION :: temp1447
  REAL*8 :: temp1449b
  REAL*8 :: temp1480b1
  DOUBLE PRECISION :: temp1528
  REAL*8 :: temp1544b0
  REAL*8 :: temp1561b1
  DOUBLE PRECISION :: temp1609
  REAL*8 :: temp1625b0
  REAL*8 :: temp1706b0
  REAL*8 :: temp1777b2
  DOUBLE PRECISION :: temp1780
  REAL*8 :: temp1788b13
  DOUBLE PRECISION :: temp12b2
  DOUBLE PRECISION :: temp34
  REAL*8 :: temp49b2(3)
  DOUBLE PRECISION :: temp67b
  REAL*8 :: temp104b
  DOUBLE PRECISION :: temp179b0
  DOUBLE PRECISION :: temp204b34
  REAL*8 :: temp304b0
  DOUBLE PRECISION :: temp382
  REAL*8 :: temp393b
  REAL*8 :: temp439b1
  REAL*8 :: temp451b7
  REAL*8 :: temp463
  REAL*8 :: temp474b
  REAL*8 :: temp544
  DOUBLE PRECISION :: temp625
  REAL*8 :: temp698b19
  DOUBLE PRECISION :: temp706
  REAL*8 :: temp717b
  REAL*8 :: temp719b24
  REAL*8 :: temp733b4
  REAL*8 :: temp748b8
  REAL*8 :: temp772b1
  REAL*8 :: temp846b9
  REAL*8 :: temp853b1
  REAL*8 :: temp861b17
  REAL*8 :: temp917b0
  DOUBLE PRECISION :: temp995
  REAL*8 :: temp1006b
  REAL*8 :: temp1083b1
  REAL*8 :: temp1228b0
  REAL*8 :: temp1245b1
  DOUBLE PRECISION :: temp1284
  REAL*8 :: temp1295b
  REAL*8 :: temp1309b0
  REAL*8 :: temp1365
  DOUBLE PRECISION :: temp1376b
  REAL*8 :: temp1407b1
  DOUBLE PRECISION :: temp1446
  REAL*8 :: temp1457b
  REAL*8 :: temp1480b0
  REAL*8 :: temp1501b
  DOUBLE PRECISION :: temp1527
  REAL*8 :: temp1561b0
  REAL*8 :: temp1598b0
  DOUBLE PRECISION :: temp1608
  REAL*8 :: temp1619b
  DOUBLE PRECISION :: temp1689b9
  REAL*8 :: temp1777b1
  REAL*8 :: temp1788b12
  REAL*8 :: temp1814b9
  DOUBLE PRECISION :: temp12b1
  REAL*8 :: temp33
  REAL*8 :: temp49b1(3)
  DOUBLE PRECISION :: temp75b
  REAL*8 :: temp112b
  REAL*8 :: temp129
  DOUBLE PRECISION :: temp149b(3)
  REAL*8 :: temp191b5
  DOUBLE PRECISION :: temp204b33
  DOUBLE PRECISION :: temp277b0
  REAL*8 :: temp358b0
  DOUBLE PRECISION :: temp381
  DOUBLE PRECISION :: temp439b0
  REAL*8 :: temp451b6
  DOUBLE PRECISION :: temp462
  REAL*8 :: temp482b
  DOUBLE PRECISION :: temp499
  DOUBLE PRECISION :: temp543
  REAL*8 :: temp563b
  DOUBLE PRECISION :: temp624
  REAL*8 :: temp698b18
  DOUBLE PRECISION :: temp705
  REAL*8 :: temp719b23
  DOUBLE PRECISION :: temp733b3
  REAL*8 :: temp748b7
  REAL*8 :: temp772b0
  REAL*8 :: temp806b
  REAL*8 :: temp846b8
  REAL*8 :: temp853b0
  REAL*8 :: temp861b16
  REAL*8 :: temp967b19
  DOUBLE PRECISION :: temp994
  REAL*8 :: temp1014b
  REAL*8 :: temp1083b0
  REAL*8 :: temp1245b0
  REAL*8 :: temp1262b1
  REAL*8 :: temp1283
  REAL*8 :: temp1299b1
  REAL*8 :: temp1360b2
  DOUBLE PRECISION :: temp1364
  REAL*8 :: temp1384b
  REAL*8 :: temp1407b0
  DOUBLE PRECISION :: temp1445
  REAL*8 :: temp1465b
  REAL*8 :: temp1526
  DOUBLE PRECISION :: temp1546b
  REAL*8 :: temp1607
  REAL*8 :: temp1657b3
  REAL*8 :: temp1689b8
  REAL*8 :: temp1696b0
  REAL*8 :: temp1701b3
  REAL*8 :: temp1772b5
  REAL*8 :: temp1777b0
  REAL*8 :: temp1788b11
  REAL*8 :: temp1814b8
  REAL*8 :: temp1819b3
  DOUBLE PRECISION :: temp12b0
  REAL*8 :: temp32
  REAL*8 :: temp49b0(3)
  DOUBLE PRECISION :: temp61b6(3)
  REAL*8 :: temp66b1
  DOUBLE PRECISION :: temp69(3)
  DOUBLE PRECISION :: temp83b
  REAL*8 :: temp83b2(3)
  DOUBLE PRECISION :: temp103b1
  REAL*8 :: temp120b
  REAL*8 :: temp120b2(3)
  DOUBLE PRECISION :: temp128
  DOUBLE PRECISION :: temp157b
  REAL*8 :: temp157b2(3)
  DOUBLE PRECISION :: temp191b4
  DOUBLE PRECISION :: temp209
  DOUBLE PRECISION :: temp204b32
  REAL*8 :: temp238b
  REAL*8 :: temp380
  REAL*8 :: temp375b0
  REAL*8 :: temp451b5
  REAL*8 :: temp456b0
  REAL*8 :: temp461
  DOUBLE PRECISION :: temp498
  DOUBLE PRECISION :: temp490b
  REAL*8 :: temp542
  REAL*8 :: temp579
  DOUBLE PRECISION :: temp623
  REAL*8 :: temp635b1
  DOUBLE PRECISION :: temp689b
  REAL*8 :: temp698b17
  DOUBLE PRECISION :: temp704
  REAL*8 :: temp719b22
  REAL*8 :: temp719b59
  REAL*8 :: temp733b
  REAL*8 :: temp733b2
  REAL*8 :: temp748b6
  REAL*8 :: temp814b
  REAL*8 :: temp846b7
  REAL*8 :: temp861b15
  REAL*8 :: temp951b0
  REAL*8 :: temp967b18
  DOUBLE PRECISION :: temp993
  REAL*8 :: temp1022b
  REAL*8 :: temp1108b1
  REAL*8 :: temp1262b0
  DOUBLE PRECISION :: temp1282
  REAL*8 :: temp1299b0
  REAL*8 :: temp1360b1
  DOUBLE PRECISION :: temp1363
  REAL*8 :: temp1392b
  REAL*8 :: temp1444
  REAL*8 :: temp1505b0
  DOUBLE PRECISION :: temp1525
  REAL*8 :: temp1554b
  DOUBLE PRECISION :: temp1606
  DOUBLE PRECISION :: temp1657b2
  REAL*8 :: temp1689b7
  REAL*8 :: temp1701b2
  REAL*8 :: temp1716b
  REAL*8 :: temp1772b4
  REAL*8 :: temp1788b10
  REAL*8 :: temp1794b0
  REAL*8 :: temp1814b7
  REAL*8 :: temp1819b2(3)
  DOUBLE PRECISION :: temp31
  DOUBLE PRECISION :: temp61b5
  REAL*8 :: temp66b0
  DOUBLE PRECISION :: temp68(3)
  REAL*8 :: temp83b1(3)
  DOUBLE PRECISION :: temp103b0
  REAL*8 :: temp120b1(3)
  DOUBLE PRECISION :: temp127
  REAL*8 :: temp157b1(3)
  REAL*8 :: temp174b2
  REAL*8 :: temp191b3
  DOUBLE PRECISION :: temp208
  DOUBLE PRECISION :: temp204b31
  DOUBLE PRECISION :: temp246b
  REAL*8 :: temp316b19
  REAL*8 :: temp327b
  REAL*8 :: temp434b3
  REAL*8 :: temp451b4
  DOUBLE PRECISION :: temp460
  DOUBLE PRECISION :: temp497
  DOUBLE PRECISION :: temp541
  REAL*8 :: temp578
  DOUBLE PRECISION :: temp622
  REAL*8 :: temp635b0
  REAL*8 :: temp659
  REAL*8 :: temp660b
  REAL*8 :: temp698b16
  DOUBLE PRECISION :: temp703
  REAL*8 :: temp719b21
  REAL*8 :: temp719b58
  REAL*8 :: temp733b1
  REAL*8 :: temp748b5
  REAL*8 :: temp778b
  DOUBLE PRECISION :: temp822b
  REAL*8 :: temp846b6
  REAL*8 :: temp861b14
  REAL*8 :: temp967b17
  DOUBLE PRECISION :: temp992
  DOUBLE PRECISION :: temp1029
  REAL*8 :: temp1030b
  DOUBLE PRECISION :: temp1067b
  REAL*8 :: temp1098b2
  REAL*8 :: temp1108b0
  REAL*8 :: temp1148b
  REAL*8 :: temp1229b
  DOUBLE PRECISION :: temp1281
  REAL*8 :: temp1360b0
  REAL*8 :: temp1362
  DOUBLE PRECISION :: temp1399
  DOUBLE PRECISION :: temp1443
  REAL*8 :: temp1441b0
  REAL*8 :: temp1478b0
  DOUBLE PRECISION :: temp1524
  REAL*8 :: temp1522b0
  REAL*8 :: temp1559b0
  REAL*8 :: temp1562b
  REAL*8 :: temp1599b
  DOUBLE PRECISION :: temp1605
  REAL*8 :: temp1657b1
  REAL*8 :: temp1689b6
  REAL*8 :: temp1701b1
  REAL*8 :: temp1724b
  DOUBLE PRECISION :: temp1772b3
  REAL*8 :: temp1814b6
  REAL*8 :: temp1819b1
  DOUBLE PRECISION :: temp30(3)
  DOUBLE PRECISION :: temp61b4
  DOUBLE PRECISION :: temp67(3)
  DOUBLE PRECISION :: temp83b0
  REAL*8 :: temp120b0(3)
  REAL*8 :: temp126
  REAL*8 :: temp174b1(3)
  DOUBLE PRECISION :: temp157b0
  REAL*8 :: temp191b2(3)
  REAL*8 :: temp204b30(3)
  DOUBLE PRECISION :: temp207
  DOUBLE PRECISION :: temp255b1
  REAL*8 :: temp316b18
  REAL*8 :: temp417b1
  REAL*8 :: temp416b
  REAL*8 :: temp434b2
  REAL*8 :: temp451b3
  DOUBLE PRECISION :: temp496
  DOUBLE PRECISION :: temp540
  DOUBLE PRECISION :: temp577
  DOUBLE PRECISION :: temp621
  DOUBLE PRECISION :: temp658
  REAL*8 :: temp698b15
  DOUBLE PRECISION :: temp702
  REAL*8 :: temp719b20
  REAL*8 :: temp719b57
  REAL*8 :: temp733b0
  DOUBLE PRECISION :: temp739
  REAL*8 :: temp748b4
  REAL*8 :: temp786b
  REAL*8 :: temp814b0
  REAL*8 :: temp830b
  REAL*8 :: temp846b5
  REAL*8 :: temp861b13
  REAL*8 :: temp905b9
  REAL*8 :: temp911b
  REAL*8 :: temp967b16
  DOUBLE PRECISION :: temp991
  REAL*8 :: temp1022b4
  DOUBLE PRECISION :: temp1028
  REAL*8 :: temp1044b0
  REAL*8 :: temp1075b
  REAL*8 :: temp1098b1
  DOUBLE PRECISION :: temp1109
  REAL*8 :: temp1156b
  REAL*8 :: temp1179b1
  REAL*8 :: temp1223b1
  REAL*8 :: temp1237b
  DOUBLE PRECISION :: temp1280
  REAL*8 :: temp1277b2
  REAL*8 :: temp1304b1
  DOUBLE PRECISION :: temp1361
  DOUBLE PRECISION :: temp1398
  DOUBLE PRECISION :: temp1442
  DOUBLE PRECISION :: temp1479
  DOUBLE PRECISION :: temp1523
  REAL*8 :: temp1570b
  DOUBLE PRECISION :: temp1604
  DOUBLE PRECISION :: temp1651b
  REAL*8 :: temp1657b0(3)
  REAL*8 :: temp1688b
  REAL*8 :: temp1689b5
  REAL*8 :: temp1701b0
  REAL*8 :: temp1711b9
  REAL*8 :: temp1732b
  REAL*8 :: temp1738b0
  REAL*8 :: temp1769b
  REAL*8 :: temp1772b2
  REAL*8 :: temp1813b
  REAL*8 :: temp1814b5
  REAL*8 :: temp1819b0
  DOUBLE PRECISION :: temp1829b9
  DOUBLE PRECISION :: temp61b3
  REAL*8 :: temp66
  DOUBLE PRECISION :: temp125
  REAL*8 :: temp174b0
  REAL*8 :: temp191b1(3)
  REAL*8 :: temp206
  DOUBLE PRECISION :: temp255b0
  REAL*8 :: temp299b
  REAL*8 :: temp316b17
  DOUBLE PRECISION :: temp343b
  REAL*8 :: temp417b0
  REAL*8 :: temp424b
  REAL*8 :: temp434b1
  REAL*8 :: temp451b2
  DOUBLE PRECISION :: temp495
  DOUBLE PRECISION :: temp505b
  DOUBLE PRECISION :: temp576
  DOUBLE PRECISION :: temp620
  DOUBLE PRECISION :: temp657
  REAL*8 :: temp698b14
  DOUBLE PRECISION :: temp701
  REAL*8 :: temp719b56
  DOUBLE PRECISION :: temp738
  REAL*8 :: temp748b3
  DOUBLE PRECISION :: temp819
  REAL*8 :: temp846b4
  REAL*8 :: temp861b12
  REAL*8 :: temp875b
  REAL*8 :: temp885b1
  REAL*8 :: temp886b15
  REAL*8 :: temp905b8
  REAL*8 :: temp949b0
  REAL*8 :: temp959b9
  REAL*8 :: temp967b15
  REAL*8 :: temp981b19
  DOUBLE PRECISION :: temp990
  DOUBLE PRECISION :: temp1022b3
  DOUBLE PRECISION :: temp1027
  REAL*8 :: temp1083b
  REAL*8 :: temp1098b0
  DOUBLE PRECISION :: temp1108
  REAL*8 :: temp1142b0
  REAL*8 :: temp1179b0
  REAL*8 :: temp1223b0
  REAL*8 :: temp1245b
  REAL*8 :: temp1277b1
  REAL*8 :: temp1304b0
  DOUBLE PRECISION :: temp1360
  DOUBLE PRECISION :: temp1397
  REAL*8 :: temp1407b
  DOUBLE PRECISION :: temp1441
  DOUBLE PRECISION :: temp1478
  DOUBLE PRECISION :: temp1522
  REAL*8 :: temp1537b2
  DOUBLE PRECISION :: temp1559
  DOUBLE PRECISION :: temp1603
  REAL*8 :: temp1689b4
  REAL*8 :: temp1696b
  REAL*8 :: temp1711b8
  REAL*8 :: temp1755b0
  REAL*8 :: temp1772b1
  REAL*8 :: temp1777b
  REAL*8 :: temp1814b4
  REAL*8 :: temp1821b
  DOUBLE PRECISION :: temp1829b8
  REAL*8 :: temp61b2
  DOUBLE PRECISION :: temp65
  DOUBLE PRECISION :: temp124(3)
  REAL*8 :: temp135b2(3)
  REAL*8 :: temp191b0(3)
  REAL*8 :: temp205
  DOUBLE PRECISION :: temp216b2
  REAL*8 :: temp316b16
  REAL*8 :: temp432b
  REAL*8 :: temp434b0
  REAL*8 :: temp451b1
  REAL*8 :: temp494
  REAL*8 :: temp513b
  DOUBLE PRECISION :: temp575
  REAL*8 :: temp656
  REAL*8 :: temp698b13
  REAL*8 :: temp700
  REAL*8 :: temp719b55
  DOUBLE PRECISION :: temp737
  REAL*8 :: temp748b2
  DOUBLE PRECISION :: temp818
  REAL*8 :: temp846b3
  REAL*8 :: temp861b11
  REAL*8 :: temp883b
  REAL*8 :: temp885b0
  REAL*8 :: temp886b14
  REAL*8 :: temp905b7
  REAL*8 :: temp959b8
  REAL*8 :: temp967b14
  REAL*8 :: temp981b18
  REAL*8 :: temp1022b2
  DOUBLE PRECISION :: temp1026
  REAL*8 :: temp1091b
  DOUBLE PRECISION :: temp1107
  REAL*8 :: temp1240b0
  REAL*8 :: temp1277b0
  REAL*8 :: temp1294b1
  REAL*8 :: temp1319b3
  REAL*8 :: temp1358b0
  DOUBLE PRECISION :: temp1396
  REAL*8 :: temp1439b0
  DOUBLE PRECISION :: temp1440
  DOUBLE PRECISION :: temp1477
  REAL*8 :: temp1515b5
  DOUBLE PRECISION :: temp1521
  REAL*8 :: temp1537b1
  DOUBLE PRECISION :: temp1558
  DOUBLE PRECISION :: temp1602
  DOUBLE PRECISION :: temp1639
  REAL*8 :: temp1689b3
  REAL*8 :: temp1711b7
  REAL*8 :: temp1772b0
  REAL*8 :: temp1785b
  REAL*8 :: temp1814b3
  DOUBLE PRECISION :: temp1829b7
  REAL*8 :: temp33b
  REAL*8 :: temp61b1
  DOUBLE PRECISION :: temp64(3)
  DOUBLE PRECISION :: temp123(3)
  REAL*8 :: temp135b1(3)
  REAL*8 :: temp152b2
  REAL*8 :: temp204
  DOUBLE PRECISION :: temp216b1
  REAL*8 :: temp316b15
  REAL*8 :: temp440b
  REAL*8 :: temp451b0
  DOUBLE PRECISION :: temp493
  REAL*8 :: temp521b
  REAL*8 :: temp574
  REAL*8 :: temp569b0
  REAL*8 :: temp579b9
  REAL*8 :: temp602b
  REAL*8 :: temp639b
  DOUBLE PRECISION :: temp655
  REAL*8 :: temp698b12
  REAL*8 :: temp698b49
  REAL*8 :: temp719b54
  DOUBLE PRECISION :: temp736
  REAL*8 :: temp748b1
  REAL*8 :: temp817
  REAL*8 :: temp829b1
  REAL*8 :: temp846b2
  REAL*8 :: temp861b10
  REAL*8 :: temp886b13
  REAL*8 :: temp905b6
  REAL*8 :: temp959b7
  REAL*8 :: temp967b13
  REAL*8 :: temp981b17
  REAL*8 :: temp1022b1
  DOUBLE PRECISION :: temp1025
  DOUBLE PRECISION :: temp1106
  REAL*8 :: temp1255b3
  REAL*8 :: temp1261b
  REAL*8 :: temp1294b0
  REAL*8 :: temp1298b
  REAL*8 :: temp1319b2
  REAL*8 :: temp1342b
  DOUBLE PRECISION :: temp1395
  REAL*8 :: temp1392b1
  DOUBLE PRECISION :: temp1476
  REAL*8 :: temp1515b4
  DOUBLE PRECISION :: temp1520
  REAL*8 :: temp1537b0
  DOUBLE PRECISION :: temp1557
  REAL*8 :: temp1601
  REAL*8 :: temp1618b0
  DOUBLE PRECISION :: temp1638
  REAL*8 :: temp1689b2
  REAL*8 :: temp1711b6
  REAL*8 :: temp1719
  REAL*8 :: temp1793b
  REAL*8 :: temp1814b2
  DOUBLE PRECISION :: temp1829b6
  REAL*8 :: temp41b
  REAL*8 :: temp61b0
  DOUBLE PRECISION :: temp63(3)
  DOUBLE PRECISION :: temp122(3)
  REAL*8 :: temp152b1(3)
  DOUBLE PRECISION :: temp135b0
  DOUBLE PRECISION :: temp159(3)
  DOUBLE PRECISION :: temp203
  DOUBLE PRECISION :: temp216b0
  DOUBLE PRECISION :: temp233b1
  REAL*8 :: temp316b14
  REAL*8 :: temp474b19
  REAL*8 :: temp485b
  DOUBLE PRECISION :: temp492
  REAL*8 :: temp573
  REAL*8 :: temp579b8
  REAL*8 :: temp610b
  REAL*8 :: temp647b
  DOUBLE PRECISION :: temp654
  REAL*8 :: temp698b11
  REAL*8 :: temp698b48
  REAL*8 :: temp719b53
  DOUBLE PRECISION :: temp728b
  REAL*8 :: temp735
  REAL*8 :: temp748b0
  REAL*8 :: temp802b9
  DOUBLE PRECISION :: temp816
  REAL*8 :: temp829b0
  REAL*8 :: temp839b9
  REAL*8 :: temp846b1
  REAL*8 :: temp886b12
  REAL*8 :: temp905b5
  REAL*8 :: temp959b6
  DOUBLE PRECISION :: temp961b3
  REAL*8 :: temp967b12
  DOUBLE PRECISION :: temp980b
  REAL*8 :: temp981b16
  DOUBLE PRECISION :: temp1017b
  REAL*8 :: temp1022b0
  DOUBLE PRECISION :: temp1024
  DOUBLE PRECISION :: temp1105
  REAL*8 :: temp1255b2
  REAL*8 :: temp1319b1
  REAL*8 :: temp1350b
  REAL*8 :: temp1394
  REAL*8 :: temp1392b0
  DOUBLE PRECISION :: temp1431b
  REAL*8 :: temp1468b
  DOUBLE PRECISION :: temp1475
  REAL*8 :: temp1515b3
  DOUBLE PRECISION :: temp1556
  REAL*8 :: temp1554b0
  DOUBLE PRECISION :: temp1600
  DOUBLE PRECISION :: temp1637
  REAL*8 :: temp1689b1
  REAL*8 :: temp1711b5
  REAL*8 :: temp1716b0
  DOUBLE PRECISION :: temp1718
  REAL*8 :: temp1814b1
  DOUBLE PRECISION :: temp1829b5
  DOUBLE PRECISION :: temp62(3)
  DOUBLE PRECISION :: temp99(3)
  DOUBLE PRECISION :: temp121(3)
  REAL*8 :: temp123b(3)
  REAL*8 :: temp152b0
  DOUBLE PRECISION :: temp158(3)
  DOUBLE PRECISION :: temp202(3)
  REAL*8 :: temp204b
  DOUBLE PRECISION :: temp239
  DOUBLE PRECISION :: temp233b0
  REAL*8 :: temp287b1
  REAL*8 :: temp316b13
  REAL*8 :: temp331b1
  REAL*8 :: temp412b1
  REAL*8 :: temp474b18
  DOUBLE PRECISION :: temp491
  DOUBLE PRECISION :: temp572
  REAL*8 :: temp574b
  REAL*8 :: temp579b7
  REAL*8 :: temp579b12
  DOUBLE PRECISION :: temp653
  DOUBLE PRECISION :: temp655b
  REAL*8 :: temp698b10
  REAL*8 :: temp698b47
  REAL*8 :: temp719b52
  DOUBLE PRECISION :: temp734
  REAL*8 :: temp802b8
  REAL*8 :: temp802b22
  DOUBLE PRECISION :: temp815
  REAL*8 :: temp817b
  REAL*8 :: temp839b8
  REAL*8 :: temp846b0
  REAL*8 :: temp886b11
  REAL*8 :: temp905b4
  DOUBLE PRECISION :: temp905b19
  REAL*8 :: temp959b5
  REAL*8 :: temp961b2
  REAL*8 :: temp959b29
  REAL*8 :: temp967b11
  REAL*8 :: temp981b15
  DOUBLE PRECISION :: temp1023
  DOUBLE PRECISION :: temp1104
  REAL*8 :: temp1255b1
  REAL*8 :: temp1319b0
  DOUBLE PRECISION :: temp1393
  REAL*8 :: temp1395b
  REAL*8 :: temp1417b1
  DOUBLE PRECISION :: temp1474
  REAL*8 :: temp1515b2
  REAL*8 :: temp1520b
  REAL*8 :: temp1555
  REAL*8 :: temp1601b
  DOUBLE PRECISION :: temp1636
  REAL*8 :: temp1689b0(3)
  REAL*8 :: temp1711b4
  REAL*8 :: temp1717
  REAL*8 :: temp1719b
  REAL*8 :: temp1750b1
  REAL*8 :: temp1777b15
  REAL*8 :: temp1814b0
  DOUBLE PRECISION :: temp1829b4
  DOUBLE PRECISION :: temp61(3)
  DOUBLE PRECISION :: temp98(3)
  DOUBLE PRECISION :: temp120(3)
  DOUBLE PRECISION :: temp131b
  REAL*8 :: temp157(3)
  DOUBLE PRECISION :: temp201(3)
  REAL*8 :: temp212b
  DOUBLE PRECISION :: temp238
  REAL*8 :: temp287b0
  REAL*8 :: temp316b12
  DOUBLE PRECISION :: temp319
  REAL*8 :: temp331b0
  REAL*8 :: temp412b0
  REAL*8 :: temp474b17
  DOUBLE PRECISION :: temp490
  DOUBLE PRECISION :: temp571
  REAL*8 :: temp579b6
  DOUBLE PRECISION :: temp579b11
  REAL*8 :: temp582b
  REAL*8 :: temp652
  DOUBLE PRECISION :: temp689
  REAL*8 :: temp698b46
  REAL*8 :: temp719b51
  DOUBLE PRECISION :: temp733
  DOUBLE PRECISION :: temp744b
  REAL*8 :: temp802b7
  REAL*8 :: temp802b21
  DOUBLE PRECISION :: temp814
  REAL*8 :: temp839b7
  REAL*8 :: temp841b4
  REAL*8 :: temp863b0
  REAL*8 :: temp886b10
  REAL*8 :: temp905b3
  REAL*8 :: temp905b18
  REAL*8 :: temp906b
  REAL*8 :: temp959b4
  REAL*8 :: temp959b28
  REAL*8 :: temp961b1
  REAL*8 :: temp967b10
  REAL*8 :: temp981b14
  DOUBLE PRECISION :: temp1022
  REAL*8 :: temp1033b
  DOUBLE PRECISION :: temp1059
  DOUBLE PRECISION :: temp1103
  REAL*8 :: temp1216b3
  REAL*8 :: temp1255b0
  REAL*8 :: temp1272b1
  DOUBLE PRECISION :: temp1392
  REAL*8 :: temp1417b0
  DOUBLE PRECISION :: temp1473
  DOUBLE PRECISION :: temp1484b
  REAL*8 :: temp1515b1
  REAL*8 :: temp1554
  REAL*8 :: temp1565b
  REAL*8 :: temp1613b2
  DOUBLE PRECISION :: temp1635
  REAL*8 :: temp1711b3
  DOUBLE PRECISION :: temp1716
  REAL*8 :: temp1750b0
  REAL*8 :: temp1777b14
  DOUBLE PRECISION :: temp1808b
  DOUBLE PRECISION :: temp1829b3
  REAL*8 :: temp60
  DOUBLE PRECISION :: temp59b0
  DOUBLE PRECISION :: temp97(3)
  REAL*8 :: temp156
  DOUBLE PRECISION :: temp200(3)
  DOUBLE PRECISION :: temp220b
  REAL*8 :: temp237
  REAL*8 :: temp257b
  REAL*8 :: temp316b11
  REAL*8 :: temp318
  DOUBLE PRECISION :: temp385b0
  REAL*8 :: temp474b16
  DOUBLE PRECISION :: temp547b0
  DOUBLE PRECISION :: temp570
  REAL*8 :: temp579b5
  REAL*8 :: temp579b10
  REAL*8 :: temp590b
  DOUBLE PRECISION :: temp651
  REAL*8 :: temp671b
  DOUBLE PRECISION :: temp688
  REAL*8 :: temp698b45
  REAL*8 :: temp719b9
  REAL*8 :: temp719b50
  DOUBLE PRECISION :: temp732
  REAL*8 :: temp752b
  REAL*8 :: temp769
  REAL*8 :: temp789b
  REAL*8 :: temp802b6
  REAL*8 :: temp802b20
  DOUBLE PRECISION :: temp813
  REAL*8 :: temp833b
  REAL*8 :: temp839b6
  DOUBLE PRECISION :: temp841b3
  REAL*8 :: temp905b2
  REAL*8 :: temp905b17
  REAL*8 :: temp914b
  REAL*8 :: temp959b3
  REAL*8 :: temp959b27
  REAL*8 :: temp961b0
  REAL*8 :: temp981b13
  DOUBLE PRECISION :: temp1021
  REAL*8 :: temp1041b
  DOUBLE PRECISION :: temp1058
  DOUBLE PRECISION :: temp1102
  DOUBLE PRECISION :: temp1122b
  REAL*8 :: temp1118b1
  REAL*8 :: temp1135b2
  DOUBLE PRECISION :: temp1139
  REAL*8 :: temp1159b
  REAL*8 :: temp1191b0
  DOUBLE PRECISION :: temp1203b
  REAL*8 :: temp1216b2
  REAL*8 :: temp1272b0
  DOUBLE PRECISION :: temp1391
  DOUBLE PRECISION :: temp1472
  DOUBLE PRECISION :: temp1492b
  REAL*8 :: temp1488b1
  REAL*8 :: temp1515b0
  DOUBLE PRECISION :: temp1553
  REAL*8 :: temp1613b1
  DOUBLE PRECISION :: temp1634
  REAL*8 :: temp1654b(3)
  REAL*8 :: temp1711b2
  REAL*8 :: temp1715
  REAL*8 :: temp1777b13
  REAL*8 :: temp1816b
  REAL*8 :: temp1829b2(3)
  DOUBLE PRECISION :: temp96(3)
  DOUBLE PRECISION :: temp155
  REAL*8 :: temp184b
  REAL*8 :: temp204b9
  DOUBLE PRECISION :: temp236
  REAL*8 :: temp316b10
  REAL*8 :: temp317
  DOUBLE PRECISION :: temp422b7
  REAL*8 :: temp427b
  REAL*8 :: temp474b15
  REAL*8 :: temp508b
  REAL*8 :: temp579b4
  REAL*8 :: temp650
  DOUBLE PRECISION :: temp687
  DOUBLE PRECISION :: temp694b6
  REAL*8 :: temp698b44
  REAL*8 :: temp699b1
  REAL*8 :: temp719b8
  REAL*8 :: temp726b0
  DOUBLE PRECISION :: temp731
  REAL*8 :: temp760b
  DOUBLE PRECISION :: temp768
  REAL*8 :: temp802b5
  REAL*8 :: temp807b0
  DOUBLE PRECISION :: temp812
  REAL*8 :: temp841b
  REAL*8 :: temp841b2
  REAL*8 :: temp839b5
  DOUBLE PRECISION :: temp849
  REAL*8 :: temp878b
  REAL*8 :: temp905b1
  REAL*8 :: temp905b16
  REAL*8 :: temp959b
  REAL*8 :: temp959b2
  REAL*8 :: temp959b26
  REAL*8 :: temp971b8
  REAL*8 :: temp981b12
  DOUBLE PRECISION :: temp1020
  REAL*8 :: temp1037b0
  DOUBLE PRECISION :: temp1057
  DOUBLE PRECISION :: temp1054b1
  REAL*8 :: temp1086b
  DOUBLE PRECISION :: temp1101
  REAL*8 :: temp1118b0
  REAL*8 :: temp1130b
  REAL*8 :: temp1135b1
  DOUBLE PRECISION :: temp1138
  REAL*8 :: temp1216b1
  DOUBLE PRECISION :: temp1219
  DOUBLE PRECISION :: temp1248b
  DOUBLE PRECISION :: temp1329b
  DOUBLE PRECISION :: temp1390
  REAL*8 :: temp1451b0
  DOUBLE PRECISION :: temp1471
  REAL*8 :: temp1488b0
  REAL*8 :: temp1532b0
  DOUBLE PRECISION :: temp1552
  REAL*8 :: temp1564b5
  REAL*8 :: temp1569b0
  REAL*8 :: temp1586b1
  DOUBLE PRECISION :: temp1589
  REAL*8 :: temp1613b0
  REAL*8 :: temp1633
  REAL*8 :: temp1699b
  REAL*8 :: temp1711b1
  DOUBLE PRECISION :: temp1714
  REAL*8 :: temp1765b2
  DOUBLE PRECISION :: temp1777b12
  REAL*8 :: temp1824b
  REAL*8 :: temp1829b1(3)
  DOUBLE PRECISION :: temp28b(3)
  REAL*8 :: temp37b2(3)
  DOUBLE PRECISION :: temp95(3)
  REAL*8 :: temp130b0
  REAL*8 :: temp154
  DOUBLE PRECISION :: temp184b1
  DOUBLE PRECISION :: temp192b
  DOUBLE PRECISION :: temp204b8
  DOUBLE PRECISION :: temp235
  DOUBLE PRECISION :: temp273b
  REAL*8 :: temp316
  REAL*8 :: temp354b
  REAL*8 :: temp422b6
  REAL*8 :: temp435b
  REAL*8 :: temp461b3
  REAL*8 :: temp474b14
  DOUBLE PRECISION :: temp516b
  REAL*8 :: temp579b3
  REAL*8 :: temp686
  REAL*8 :: temp694b5
  REAL*8 :: temp698b43
  REAL*8 :: temp699b0
  REAL*8 :: temp704b3
  REAL*8 :: temp719b7
  DOUBLE PRECISION :: temp730
  DOUBLE PRECISION :: temp767
  REAL*8 :: temp802b4
  REAL*8 :: temp811
  REAL*8 :: temp841b1
  REAL*8 :: temp839b4
  DOUBLE PRECISION :: temp848
  REAL*8 :: temp878b1
  DOUBLE PRECISION :: temp886b
  REAL*8 :: temp905b0
  REAL*8 :: temp905b15
  DOUBLE PRECISION :: temp929
  REAL*8 :: temp930b
  REAL*8 :: temp931b16
  REAL*8 :: temp959b1
  REAL*8 :: temp959b25
  REAL*8 :: temp967b
  REAL*8 :: temp971b7
  REAL*8 :: temp981b11
  REAL*8 :: temp1054b0
  REAL*8 :: temp1056
  DOUBLE PRECISION :: temp1100
  DOUBLE PRECISION :: temp1094b
  DOUBLE PRECISION :: temp1137
  REAL*8 :: temp1135b0
  DOUBLE PRECISION :: temp1175b
  REAL*8 :: temp1189b1
  DOUBLE PRECISION :: temp1218
  REAL*8 :: temp1216b0
  REAL*8 :: temp1256b
  DOUBLE PRECISION :: temp1337b
  REAL*8 :: temp1470
  DOUBLE PRECISION :: temp1551
  REAL*8 :: temp1564b4
  REAL*8 :: temp1586b0
  DOUBLE PRECISION :: temp1588
  DOUBLE PRECISION :: temp1632
  REAL*8 :: temp1669
  DOUBLE PRECISION :: temp1670b
  REAL*8 :: temp1684b1
  REAL*8 :: temp1711b0
  REAL*8 :: temp1713
  DOUBLE PRECISION :: temp1726b4
  REAL*8 :: temp1765b1
  REAL*8 :: temp1777b11
  REAL*8 :: temp1788b
  REAL*8 :: temp1829b0
  REAL*8 :: temp1832b
  REAL*8 :: temp37b1(3)
  REAL*8 :: temp54b2
  REAL*8 :: temp94
  REAL*8 :: temp153
  REAL*8 :: temp184b0
  REAL*8 :: temp204b7
  REAL*8 :: temp234
  REAL*8 :: temp282b1
  REAL*8 :: temp281b
  DOUBLE PRECISION :: temp315
  DOUBLE PRECISION :: temp362b
  REAL*8 :: temp399b
  DOUBLE PRECISION :: temp422b5
  REAL*8 :: temp427b0
  REAL*8 :: temp461b2
  REAL*8 :: temp474b13
  DOUBLE PRECISION :: temp525b1
  REAL*8 :: temp579b2
  DOUBLE PRECISION :: temp685
  REAL*8 :: temp694b4
  REAL*8 :: temp698b42
  REAL*8 :: temp698b79
  REAL*8 :: temp704b2
  REAL*8 :: temp719b6
  REAL*8 :: temp760b0
  DOUBLE PRECISION :: temp766
  REAL*8 :: temp802b3
  DOUBLE PRECISION :: temp810
  REAL*8 :: temp841b0
  REAL*8 :: temp839b3
  DOUBLE PRECISION :: temp847
  REAL*8 :: temp878b0
  REAL*8 :: temp894b
  REAL*8 :: temp905b14
  DOUBLE PRECISION :: temp928
  REAL*8 :: temp931b15
  REAL*8 :: temp959b0
  REAL*8 :: temp959b24
  REAL*8 :: temp971b6
  REAL*8 :: temp975b
  REAL*8 :: temp981b10
  DOUBLE PRECISION :: temp1055
  DOUBLE PRECISION :: temp1136
  DOUBLE PRECISION :: temp1183b
  REAL*8 :: temp1189b0
  DOUBLE PRECISION :: temp1217
  REAL*8 :: temp1233b0
  DOUBLE PRECISION :: temp1426b
  REAL*8 :: temp1449b1
  REAL*8 :: temp1507b
  DOUBLE PRECISION :: temp1550
  REAL*8 :: temp1564b3
  DOUBLE PRECISION :: temp1587
  DOUBLE PRECISION :: temp1631
  DOUBLE PRECISION :: temp1668(3)
  REAL*8 :: temp1684b0
  DOUBLE PRECISION :: temp1712
  REAL*8 :: temp1726b3
  DOUBLE PRECISION :: temp1741b19
  DOUBLE PRECISION :: temp1749
  REAL*8 :: temp1765b0
  REAL*8 :: temp1777b10
  DOUBLE PRECISION :: temp1796b
  REAL*8 :: temp1824b4
  REAL*8 :: temp1840b
  REAL*8 :: temp54b1(3)
  DOUBLE PRECISION :: temp37b0
  DOUBLE PRECISION :: temp93
  DOUBLE PRECISION :: temp152
  DOUBLE PRECISION :: temp189(3)
  REAL*8 :: temp204b6
  DOUBLE PRECISION :: temp233
  REAL*8 :: temp282b0
  DOUBLE PRECISION :: temp314
  REAL*8 :: temp363b0
  REAL*8 :: temp422b4
  REAL*8 :: temp451b
  REAL*8 :: temp461b1
  REAL*8 :: temp474b12
  DOUBLE PRECISION :: temp488b
  DOUBLE PRECISION :: temp525b0
  REAL*8 :: temp569b
  REAL*8 :: temp579b1
  DOUBLE PRECISION :: temp613b
  DOUBLE PRECISION :: temp684
  REAL*8 :: temp694b3
  REAL*8 :: temp698b41
  REAL*8 :: temp698b78
  REAL*8 :: temp704b1
  REAL*8 :: temp719b5
  DOUBLE PRECISION :: temp765
  REAL*8 :: temp802b2
  REAL*8 :: temp839b2
  DOUBLE PRECISION :: temp846
  REAL*8 :: temp895b0
  REAL*8 :: temp905b13
  DOUBLE PRECISION :: temp927
  REAL*8 :: temp931b14
  REAL*8 :: temp959b23
  REAL*8 :: temp971b5
  REAL*8 :: temp983b
  REAL*8 :: temp1008b9
  DOUBLE PRECISION :: temp1054
  REAL*8 :: temp1113b2
  REAL*8 :: temp1135
  REAL*8 :: temp1191b
  DOUBLE PRECISION :: temp1216
  REAL*8 :: temp1272b
  REAL*8 :: temp1449b0
  REAL*8 :: temp1515b
  REAL*8 :: temp1564b2
  REAL*8 :: temp1586
  DOUBLE PRECISION :: temp1630
  REAL*8 :: temp1628b1
  DOUBLE PRECISION :: temp1667(3)
  REAL*8 :: temp1699b3
  REAL*8 :: temp1711
  REAL*8 :: temp1726b2
  REAL*8 :: temp1741b18
  DOUBLE PRECISION :: temp1748
  REAL*8 :: temp1792b9
  REAL*8 :: temp1824b3(3)
  DOUBLE PRECISION :: temp1829(3)
  REAL*8 :: temp1b
  DOUBLE PRECISION :: temp6b1
  REAL*8 :: temp54b0
  REAL*8 :: temp52b(3)
  REAL*8 :: temp92
  REAL*8 :: temp89b
  REAL*8 :: temp126b
  DOUBLE PRECISION :: temp151(3)
  DOUBLE PRECISION :: temp188(3)
  REAL*8 :: temp199b2
  REAL*8 :: temp204b5
  DOUBLE PRECISION :: temp232
  DOUBLE PRECISION :: temp269
  DOUBLE PRECISION :: temp313
  REAL*8 :: temp324b2
  DOUBLE PRECISION :: temp341b3
  REAL*8 :: temp380b0
  REAL*8 :: temp422b3
  REAL*8 :: temp459b3
  REAL*8 :: temp461b0
  REAL*8 :: temp474b11
  REAL*8 :: temp579b0
  REAL*8 :: temp621b
  DOUBLE PRECISION :: temp683
  REAL*8 :: temp694b2
  REAL*8 :: temp698b40
  REAL*8 :: temp698b77
  REAL*8 :: temp704b0
  DOUBLE PRECISION :: temp702b
  REAL*8 :: temp719b4
  REAL*8 :: temp739b
  DOUBLE PRECISION :: temp764
  REAL*8 :: temp802b1
  REAL*8 :: temp839b1
  DOUBLE PRECISION :: temp845
  REAL*8 :: temp905b12
  REAL*8 :: temp926
  DOUBLE PRECISION :: temp931b13
  REAL*8 :: temp959b22
  REAL*8 :: temp971b4
  REAL*8 :: temp993b0
  REAL*8 :: temp991b
  REAL*8 :: temp1008b8
  REAL*8 :: temp1028b
  DOUBLE PRECISION :: temp1053
  REAL*8 :: temp1069b1
  REAL*8 :: temp1113b1
  DOUBLE PRECISION :: temp1134
  DOUBLE PRECISION :: temp1215
  DOUBLE PRECISION :: temp1398b
  REAL*8 :: temp1547b0
  REAL*8 :: temp1564b1
  DOUBLE PRECISION :: temp1585
  REAL*8 :: temp1628b0
  DOUBLE PRECISION :: temp1666(3)
  REAL*8 :: temp1699b2
  DOUBLE PRECISION :: temp1710
  REAL*8 :: temp1726b1
  REAL*8 :: temp1741b17
  DOUBLE PRECISION :: temp1747
  REAL*8 :: temp1792b8
  REAL*8 :: temp1824b2
  REAL*8 :: temp1828
  DOUBLE PRECISION :: temp
  DOUBLE PRECISION :: temp6b0
  REAL*8 :: temp91
  DOUBLE PRECISION :: temp97b(3)
  DOUBLE PRECISION :: temp150(3)
  REAL*8 :: temp187
  REAL*8 :: temp199b1
  REAL*8 :: temp204b4
  REAL*8 :: temp215b
  DOUBLE PRECISION :: temp231
  REAL*8 :: temp268
  DOUBLE PRECISION :: temp312
  REAL*8 :: temp324b1
  REAL*8 :: temp349
  DOUBLE PRECISION :: temp341b2
  REAL*8 :: temp405b1
  REAL*8 :: temp422b2
  REAL*8 :: temp459b2
  REAL*8 :: temp474b10
  REAL*8 :: temp682
  REAL*8 :: temp677b0
  DOUBLE PRECISION :: temp694b1
  REAL*8 :: temp698b76
  DOUBLE PRECISION :: temp710b
  REAL*8 :: temp719b3
  REAL*8 :: temp731b9
  REAL*8 :: temp763
  REAL*8 :: temp775b1
  REAL*8 :: temp802b0
  REAL*8 :: temp828b
  REAL*8 :: temp839b0
  REAL*8 :: temp844
  REAL*8 :: temp905b11
  REAL*8 :: temp909b
  DOUBLE PRECISION :: temp925
  REAL*8 :: temp931b12
  REAL*8 :: temp959b21
  REAL*8 :: temp971b3
  REAL*8 :: temp1008b7
  DOUBLE PRECISION :: temp1052
  REAL*8 :: temp1069b0
  DOUBLE PRECISION :: temp1089
  REAL*8 :: temp1113b0
  DOUBLE PRECISION :: temp1117b
  DOUBLE PRECISION :: temp1133
  REAL*8 :: temp1184b2
  DOUBLE PRECISION :: temp1214
  REAL*8 :: temp1450b
  REAL*8 :: temp1531b
  REAL*8 :: temp1564b0
  DOUBLE PRECISION :: temp1584
  DOUBLE PRECISION :: temp1612b
  DOUBLE PRECISION :: temp1649b
  REAL*8 :: temp1655b9
  REAL*8 :: temp1665
  REAL*8 :: temp1699b1
  REAL*8 :: temp1726b0
  REAL*8 :: temp1741b16
  DOUBLE PRECISION :: temp1746
  REAL*8 :: temp1792b7
  REAL*8 :: temp1824b1
  REAL*8 :: temp1827
  DOUBLE PRECISION :: temp90
  DOUBLE PRECISION :: temp106b2
  REAL*8 :: temp179b
  REAL*8 :: temp186
  REAL*8 :: temp199b0
  REAL*8 :: temp204b3
  REAL*8 :: temp230
  REAL*8 :: temp267
  REAL*8 :: temp304b
  REAL*8 :: temp297b1
  REAL*8 :: temp311
  REAL*8 :: temp324b0
  DOUBLE PRECISION :: temp348
  DOUBLE PRECISION :: temp341b1
  REAL*8 :: temp405b0
  REAL*8 :: temp422b1
  DOUBLE PRECISION :: temp429
  REAL*8 :: temp459b1
  DOUBLE PRECISION :: temp503b1
  REAL*8 :: temp582b19
  REAL*8 :: temp593b
  REAL*8 :: temp681
  REAL*8 :: temp694b0
  REAL*8 :: temp698b75
  REAL*8 :: temp719b2
  REAL*8 :: temp731b8
  DOUBLE PRECISION :: temp762
  REAL*8 :: temp775b0
  REAL*8 :: temp799
  DOUBLE PRECISION :: temp843
  REAL*8 :: temp905b10
  REAL*8 :: temp917b
  DOUBLE PRECISION :: temp924
  REAL*8 :: temp931b11
  REAL*8 :: temp959b20
  DOUBLE PRECISION :: temp969b5
  REAL*8 :: temp971b2
  REAL*8 :: temp1008b6
  REAL*8 :: temp1008b19
  DOUBLE PRECISION :: temp1010b3
  DOUBLE PRECISION :: temp1051
  REAL*8 :: temp1044b
  REAL*8 :: temp1086b0
  DOUBLE PRECISION :: temp1088
  REAL*8 :: temp1130b0
  DOUBLE PRECISION :: temp1132
  DOUBLE PRECISION :: temp1169
  REAL*8 :: temp1184b1
  DOUBLE PRECISION :: temp1213
  REAL*8 :: temp1329b0
  REAL*8 :: temp1427b1
  REAL*8 :: temp1444b2
  DOUBLE PRECISION :: temp1583
  REAL*8 :: temp1655b8(3)
  DOUBLE PRECISION :: temp1657b
  REAL*8 :: temp1664
  REAL*8 :: temp1699b0
  REAL*8 :: temp1701b
  REAL*8 :: temp1738b
  REAL*8 :: temp1741b15
  REAL*8 :: temp1745
  REAL*8 :: temp1792b6
  REAL*8 :: temp1792b19
  REAL*8 :: temp1797b1
  REAL*8 :: temp1819b
  REAL*8 :: temp1824b0
  REAL*8 :: temp1826
  REAL*8 :: temp32b1
  DOUBLE PRECISION :: temp106b1
  REAL*8 :: temp150b(3)
  REAL*8 :: temp185
  REAL*8 :: temp187b
  REAL*8 :: temp204b2
  DOUBLE PRECISION :: temp231b
  DOUBLE PRECISION :: temp266
  REAL*8 :: temp268b
  REAL*8 :: temp297b0
  REAL*8 :: temp310
  DOUBLE PRECISION :: temp312b
  REAL*8 :: temp341b0
  DOUBLE PRECISION :: temp347
  REAL*8 :: temp349b
  REAL*8 :: temp422b0
  REAL*8 :: temp428
  REAL*8 :: temp459b0
  DOUBLE PRECISION :: temp509
  DOUBLE PRECISION :: temp503b0
  REAL*8 :: temp557b1
  REAL*8 :: temp582b18
  DOUBLE PRECISION :: temp680
  REAL*8 :: temp682b
  REAL*8 :: temp698b74
  REAL*8 :: temp719b1
  REAL*8 :: temp731b7
  DOUBLE PRECISION :: temp761
  REAL*8 :: temp763b
  REAL*8 :: temp792b0
  DOUBLE PRECISION :: temp798
  DOUBLE PRECISION :: temp842
  REAL*8 :: temp844b
  DOUBLE PRECISION :: temp879
  REAL*8 :: temp883b9
  DOUBLE PRECISION :: temp890b1
  DOUBLE PRECISION :: temp923
  DOUBLE PRECISION :: temp925b
  REAL*8 :: temp931b10
  REAL*8 :: temp969b4
  REAL*8 :: temp971b1
  REAL*8 :: temp981b42
  REAL*8 :: temp1008b5
  REAL*8 :: temp1008b18
  REAL*8 :: temp1010b2
  DOUBLE PRECISION :: temp1050
  REAL*8 :: temp1052b
  DOUBLE PRECISION :: temp1087
  DOUBLE PRECISION :: temp1089b
  DOUBLE PRECISION :: temp1131
  DOUBLE PRECISION :: temp1168
  REAL*8 :: temp1184b0
  DOUBLE PRECISION :: temp1212
  REAL*8 :: temp1214b
  DOUBLE PRECISION :: temp1249
  REAL*8 :: temp1346b0
  REAL*8 :: temp1427b0
  REAL*8 :: temp1444b1
  DOUBLE PRECISION :: temp1582
  REAL*8 :: temp1584b
  DOUBLE PRECISION :: temp1655b7
  REAL*8 :: temp1663
  REAL*8 :: temp1665b
  REAL*8 :: temp1721b3
  REAL*8 :: temp1741b14
  DOUBLE PRECISION :: temp1744
  REAL*8 :: temp1746b
  REAL*8 :: temp1770b9
  REAL*8 :: temp1792b5
  REAL*8 :: temp1792b18
  REAL*8 :: temp1797b0
  DOUBLE PRECISION :: temp1825
  REAL*8 :: temp1827b
  DOUBLE PRECISION :: temp9
  REAL*8 :: temp32b0
  DOUBLE PRECISION :: temp106b0
  DOUBLE PRECISION :: temp155b6
  REAL*8 :: temp184
  REAL*8 :: temp195b(3)
  REAL*8 :: temp204b1
  DOUBLE PRECISION :: temp265
  REAL*8 :: temp346
  DOUBLE PRECISION :: temp427
  REAL*8 :: temp438b
  DOUBLE PRECISION :: temp508
  REAL*8 :: temp557b0
  REAL*8 :: temp582b17
  REAL*8 :: temp690b
  REAL*8 :: temp698b73
  REAL*8 :: temp719b0
  REAL*8 :: temp731b6
  DOUBLE PRECISION :: temp760
  DOUBLE PRECISION :: temp797
  REAL*8 :: temp817b1
  REAL*8 :: temp841
  REAL*8 :: temp878
  REAL*8 :: temp883b8
  DOUBLE PRECISION :: temp888b3
  REAL*8 :: temp890b0
  DOUBLE PRECISION :: temp922
  REAL*8 :: temp933b
  DOUBLE PRECISION :: temp959
  REAL*8 :: temp969b3
  REAL*8 :: temp971b0
  REAL*8 :: temp981b9
  REAL*8 :: temp981b41
  REAL*8 :: temp1008b4
  REAL*8 :: temp1008b17
  REAL*8 :: temp1010b1
  REAL*8 :: temp1060b
  DOUBLE PRECISION :: temp1086
  REAL*8 :: temp1097b
  DOUBLE PRECISION :: temp1130
  REAL*8 :: temp1141b
  DOUBLE PRECISION :: temp1167
  DOUBLE PRECISION :: temp1211
  DOUBLE PRECISION :: temp1222b
  DOUBLE PRECISION :: temp1248
  REAL*8 :: temp1259b
  DOUBLE PRECISION :: temp1329
  REAL*8 :: temp1444b0
  REAL*8 :: temp1525b0
  REAL*8 :: temp1542b1
  DOUBLE PRECISION :: temp1581
  REAL*8 :: temp1592b
  REAL*8 :: temp1655b6
  DOUBLE PRECISION :: temp1662(3)
  DOUBLE PRECISION :: temp1660b13
  REAL*8 :: temp1673b(3)
  REAL*8 :: temp1699
  REAL*8 :: temp1721b2
  REAL*8 :: temp1741b13
  DOUBLE PRECISION :: temp1743
  REAL*8 :: temp1770b8
  REAL*8 :: temp1792b4
  REAL*8 :: temp1792b17
  INTEGER :: temp1824
  REAL*8 :: temp1835b
  DOUBLE PRECISION :: temp8(3)
  DOUBLE PRECISION :: temp155b5
  DOUBLE PRECISION :: temp183
  REAL*8 :: temp204b0
  DOUBLE PRECISION :: temp264
  DOUBLE PRECISION :: temp345
  REAL*8 :: temp426
  REAL*8 :: temp446b
  REAL*8 :: temp507
  REAL*8 :: temp527b
  REAL*8 :: temp574b0
  REAL*8 :: temp582b16
  DOUBLE PRECISION :: temp655b0
  REAL*8 :: temp698b72
  REAL*8 :: temp731b5
  DOUBLE PRECISION :: temp796
  REAL*8 :: temp817b0
  DOUBLE PRECISION :: temp840
  DOUBLE PRECISION :: temp877
  REAL*8 :: temp883b7
  REAL*8 :: temp888b2
  REAL*8 :: temp909b22
  DOUBLE PRECISION :: temp921
  DOUBLE PRECISION :: temp958
  REAL*8 :: temp969b2
  REAL*8 :: temp981b8
  REAL*8 :: temp981b40
  REAL*8 :: temp1008b3
  REAL*8 :: temp1008b16
  REAL*8 :: temp1010b0
  REAL*8 :: temp1030b39
  REAL*8 :: temp1085
  REAL*8 :: temp1145b1
  DOUBLE PRECISION :: temp1166
  REAL*8 :: temp1199b2
  REAL*8 :: temp1210
  REAL*8 :: temp1226b1
  DOUBLE PRECISION :: temp1230b
  DOUBLE PRECISION :: temp1247
  REAL*8 :: temp1267b
  DOUBLE PRECISION :: temp1328
  DOUBLE PRECISION :: temp1348b
  DOUBLE PRECISION :: temp1409
  REAL*8 :: temp1542b0
  REAL*8 :: temp1580
  REAL*8 :: temp1579b0
  REAL*8 :: temp1623b0
  REAL*8 :: temp1655b5
  DOUBLE PRECISION :: temp1661(3)
  DOUBLE PRECISION :: temp1660b12
  REAL*8 :: temp1677b1
  DOUBLE PRECISION :: temp1698
  REAL*8 :: temp1704b0
  REAL*8 :: temp1721b1
  REAL*8 :: temp1741b12
  REAL*8 :: temp1742
  REAL*8 :: temp1762b
  REAL*8 :: temp1770b7
  DOUBLE PRECISION :: temp1779
  REAL*8 :: temp1792b3
  REAL*8 :: temp1792b16
  REAL*8 :: temp1823
  REAL*8 :: temp1843b
  DOUBLE PRECISION :: temp7(3)
  REAL*8 :: temp10b
  REAL*8 :: temp10b2
  DOUBLE PRECISION :: temp155b4
  DOUBLE PRECISION :: temp182(3)
  REAL*8 :: temp263
  REAL*8 :: temp275b1
  DOUBLE PRECISION :: temp344
  REAL*8 :: temp373b
  DOUBLE PRECISION :: temp425
  REAL*8 :: temp454b
  DOUBLE PRECISION :: temp506
  REAL*8 :: temp582b15
  REAL*8 :: temp616b
  REAL*8 :: temp698b71
  REAL*8 :: temp731b4
  REAL*8 :: temp753b0
  DOUBLE PRECISION :: temp795
  DOUBLE PRECISION :: temp876
  REAL*8 :: temp883b6
  REAL*8 :: temp888b1
  REAL*8 :: temp909b21
  REAL*8 :: temp920
  REAL*8 :: temp932b1
  REAL*8 :: temp957
  REAL*8 :: temp969b1
  REAL*8 :: temp981b7
  REAL*8 :: temp1008b2
  REAL*8 :: temp1008b15
  REAL*8 :: temp1020b8
  REAL*8 :: temp1030b38
  DOUBLE PRECISION :: temp1084
  REAL*8 :: temp1145b0
  REAL*8 :: temp1162b1
  DOUBLE PRECISION :: temp1165
  REAL*8 :: temp1199b1
  REAL*8 :: temp1226b0
  DOUBLE PRECISION :: temp1246
  REAL*8 :: temp1307b0
  DOUBLE PRECISION :: temp1327
  REAL*8 :: temp1356b
  REAL*8 :: temp1400b
  DOUBLE PRECISION :: temp1408
  REAL*8 :: temp1422b2
  REAL*8 :: temp1640b0
  REAL*8 :: temp1655b4
  DOUBLE PRECISION :: temp1660(3)
  DOUBLE PRECISION :: temp1660b11
  REAL*8 :: temp1677b0
  REAL*8 :: temp1697
  REAL*8 :: temp1719b3
  REAL*8 :: temp1721b0
  REAL*8 :: temp1741b11
  DOUBLE PRECISION :: temp1741
  REAL*8 :: temp1770b
  REAL*8 :: temp1770b6
  DOUBLE PRECISION :: temp1778
  REAL*8 :: temp1792b2
  REAL*8 :: temp1792b15
  REAL*8 :: temp1802b0
  REAL*8 :: temp1822
  DOUBLE PRECISION :: temp6(3)
  DOUBLE PRECISION :: temp10b1
  DOUBLE PRECISION :: temp55b
  DOUBLE PRECISION :: temp129b
  DOUBLE PRECISION :: temp155b3
  DOUBLE PRECISION :: temp181(3)
  DOUBLE PRECISION :: temp214b7
  DOUBLE PRECISION :: temp262
  REAL*8 :: temp275b0
  REAL*8 :: temp299
  DOUBLE PRECISION :: temp343
  REAL*8 :: temp381b
  REAL*8 :: temp373b1
  REAL*8 :: temp424
  REAL*8 :: temp437b0
  REAL*8 :: temp451b19
  REAL*8 :: temp462b
  REAL*8 :: temp499b
  DOUBLE PRECISION :: temp505
  DOUBLE PRECISION :: temp543b
  REAL*8 :: temp582b14
  DOUBLE PRECISION :: temp624b
  REAL*8 :: temp698b70
  REAL*8 :: temp731b3
  DOUBLE PRECISION :: temp794
  REAL*8 :: temp861b9
  DOUBLE PRECISION :: temp875
  REAL*8 :: temp883b5
  REAL*8 :: temp888b0
  REAL*8 :: temp909b20
  REAL*8 :: temp932b0
  DOUBLE PRECISION :: temp956
  REAL*8 :: temp969b0
  REAL*8 :: temp981b6
  REAL*8 :: temp1008b1
  REAL*8 :: temp1008b14
  REAL*8 :: temp1020b7
  REAL*8 :: temp1030b37
  DOUBLE PRECISION :: temp1083
  DOUBLE PRECISION :: temp1164
  REAL*8 :: temp1162b0
  REAL*8 :: temp1199b0
  REAL*8 :: temp1245
  REAL*8 :: temp1243b0
  REAL*8 :: temp1283b
  DOUBLE PRECISION :: temp1326
  REAL*8 :: temp1378b1
  REAL*8 :: temp1407
  REAL*8 :: temp1422b1
  REAL*8 :: temp1459b1
  REAL*8 :: temp1526b
  REAL*8 :: temp1607b
  REAL*8 :: temp1655b3
  DOUBLE PRECISION :: temp1660b10
  REAL*8 :: temp1694b0
  DOUBLE PRECISION :: temp1696
  REAL*8 :: temp1719b2
  DOUBLE PRECISION :: temp1740
  REAL*8 :: temp1741b10
  REAL*8 :: temp1770b5
  DOUBLE PRECISION :: temp1777
  REAL*8 :: temp1792b1
  REAL*8 :: temp1792b14
  REAL*8 :: temp1821
  DOUBLE PRECISION :: temp5
  DOUBLE PRECISION :: temp10b0
  REAL*8 :: temp100b
  REAL*8 :: temp155b2
  DOUBLE PRECISION :: temp180(3)
  REAL*8 :: temp214b6
  DOUBLE PRECISION :: temp218b
  REAL*8 :: temp219b1
  DOUBLE PRECISION :: temp261
  DOUBLE PRECISION :: temp298
  REAL*8 :: temp342
  REAL*8 :: temp379
  REAL*8 :: temp373b0
  DOUBLE PRECISION :: temp423
  REAL*8 :: temp451b18
  REAL*8 :: temp454b0
  DOUBLE PRECISION :: temp470b
  REAL*8 :: temp504
  REAL*8 :: temp552b1
  REAL*8 :: temp551b
  REAL*8 :: temp582b13
  REAL*8 :: temp588b
  DOUBLE PRECISION :: temp633b1
  DOUBLE PRECISION :: temp669b
  REAL*8 :: temp731b2
  DOUBLE PRECISION :: temp793
  REAL*8 :: temp861b8
  DOUBLE PRECISION :: temp874
  REAL*8 :: temp883b4
  REAL*8 :: temp947b3
  DOUBLE PRECISION :: temp955
  REAL*8 :: temp981b5
  REAL*8 :: temp1008b0
  REAL*8 :: temp1008b13
  REAL*8 :: temp1020b6
  REAL*8 :: temp1030b36
  DOUBLE PRECISION :: temp1039b
  DOUBLE PRECISION :: temp1082
  REAL*8 :: temp1123b2
  DOUBLE PRECISION :: temp1163
  DOUBLE PRECISION :: temp1244
  REAL*8 :: temp1258b3
  DOUBLE PRECISION :: temp1325
  REAL*8 :: temp1372b
  REAL*8 :: temp1378b0
  REAL*8 :: temp1406
  REAL*8 :: temp1422b0
  REAL*8 :: temp1453b
  REAL*8 :: temp1459b0
  REAL*8 :: temp1493b2
  REAL*8 :: temp1503b0
  REAL*8 :: temp1534b
  REAL*8 :: temp1655b2(3)
  REAL*8 :: temp1695
  REAL*8 :: temp1719b1
  REAL*8 :: temp1770b4
  DOUBLE PRECISION :: temp1776
  REAL*8 :: temp1792b0
  REAL*8 :: temp1792b13
  DOUBLE PRECISION :: temp1820
  DOUBLE PRECISION :: temp4(3)
  REAL*8 :: temp101b0
  REAL*8 :: temp155b1
  DOUBLE PRECISION :: temp214b5
  REAL*8 :: temp219b0
  REAL*8 :: temp236b1
  REAL*8 :: temp260
  DOUBLE PRECISION :: temp297
  DOUBLE PRECISION :: temp341
  DOUBLE PRECISION :: temp378
  DOUBLE PRECISION :: temp422
  REAL*8 :: temp432b3
  REAL*8 :: temp451b17
  REAL*8 :: temp459
  DOUBLE PRECISION :: temp503
  REAL*8 :: temp552b0
  REAL*8 :: temp582b12
  DOUBLE PRECISION :: temp596b
  DOUBLE PRECISION :: temp633b0
  REAL*8 :: temp677b
  REAL*8 :: temp714b0
  REAL*8 :: temp721b
  REAL*8 :: temp731b1
  DOUBLE PRECISION :: temp792
  REAL*8 :: temp802b
  REAL*8 :: temp839b
  REAL*8 :: temp861b7
  DOUBLE PRECISION :: temp873
  REAL*8 :: temp883b3
  DOUBLE PRECISION :: temp954
  REAL*8 :: temp947b2
  REAL*8 :: temp981b4
  REAL*8 :: temp1008b12
  REAL*8 :: temp1010b
  REAL*8 :: temp1020b5
  REAL*8 :: temp1030b35
  REAL*8 :: temp1042b1
  DOUBLE PRECISION :: temp1081
  REAL*8 :: temp1123b1
  DOUBLE PRECISION :: temp1162
  DOUBLE PRECISION :: temp1199
  DOUBLE PRECISION :: temp1243
  REAL*8 :: temp1258b2
  DOUBLE PRECISION :: temp1324
  REAL*8 :: temp1395b0
  DOUBLE PRECISION :: temp1405
  DOUBLE PRECISION :: temp1461b
  REAL*8 :: temp1493b1
  REAL*8 :: temp1520b0
  REAL*8 :: temp1542b
  DOUBLE PRECISION :: temp1579b
  REAL*8 :: temp1601b0
  REAL*8 :: temp1623b
  DOUBLE PRECISION :: temp1655b1
  DOUBLE PRECISION :: temp1694
  REAL*8 :: temp1704b
  REAL*8 :: temp1719b0
  REAL*8 :: temp1770b3
  REAL*8 :: temp1775
  REAL*8 :: temp1792b12
!        indorb are the number of orbitals occupied before calling
!        this subroutine
!
!        indpar is the number of variational parameters used
!        before calling this subroutine
!
!        indshell is the index of the last  occupied orbital
!        in the shell, characterized by occupation number iocc(indshell+
!
!        z(i,indt+4)   contains the laplacian of the orbital i
!        z(i,indt+mu) contains the gradient of the orbital i (mu=1,2,3)
!       fun0 = f(r)   ! the radial part without the angular component
!       fun =1/r  d/dr f(r)
!       fun3 =(1/r  d/dr ) ( 1/r d/dr ) f(r)
  adi4ibuf=1
  adr8ibuf=1
  SELECT CASE  (iopt)
  CASE (1)
! 1s single Z NO CUSP!
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!           c=dd1*dsqrt(dd1)/dsqrt(pi)
      c = dd1*DSQRT(dd1)*0.56418958354775628695d0
!           endif
      indorbp = indorb + 1
      DO k=0,0
        distp(k, 1) = c*DEXP(-(dd1*r(k)))
      END DO
      IF (typec .NE. 1) THEN
        fun = -(dd1*distp(0, 1)/r(0))
        fun3 = (-dd1-1.d0/r(0))*fun/r(0)
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = (fun3*rmu(:, 0)**2*rmucos(:, 0)**2+fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2))*cosphase(0)
        hess(:) = hess(:) - 2.d0*fun*rmu(:, 0)*rmucos(:, 0)*sinphase(:, &
&          0)*rphase(:) - cosphase(0)*distp(0, 1)*rphase(:)**2
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        distpb = 0.0_8
        temp5b = -(sinphase(:, 0)*fun*rphase(:)*2.d0*hessb(:))
        temp5b0 = -(rmu(:, 0)*rmucos(:, 0)*2.d0*hessb(:))
        temp5b1 = -(rphase(:)**2*hessb(:))
        temp5b2 = cosphase(0)*hessb(:)
        temp4 = rmucos(:, 0)**2
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp4*temp5b2 + &
&          rmucos(:, 0)*temp5b
        temp3 = rmu(:, 0)**2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp3*&
&          temp5b2 + rmu(:, 0)*temp5b
        sinphaseb(:, 0) = sinphaseb(:, 0) + fun*rphase(:)*temp5b0
        temp2 = -(2.d0*rmusin(:, 0)**2) + 1.d0
        funb = SUM(temp2*temp5b2) + SUM(rphase(:)*sinphase(:, 0)*temp5b0&
&          )
        rphaseb(:) = rphaseb(:) + fun*sinphase(:, 0)*temp5b0 - 2*rphase(&
&          :)*cosphase(0)*distp(0, 1)*hessb(:)
        cosphaseb(0) = cosphaseb(0) + SUM((fun3*temp3*temp4+fun*temp2)*&
&          hessb(:)) + distp(0, 1)*SUM(temp5b1)
        distpb(0, 1) = cosphase(0)*SUM(temp5b1)
        fun3b = SUM(temp3*temp4*temp5b2)
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*temp5b2
        DO i=3,1,-1
          temp2b = fun*cosphase(0)*zb(indorbp, indt+i)
          temp2b0 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
          temp2b1 = -(sinphase(i, 0)*zb(indorbp, indt+i))
          rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp2b
          rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp2b
          funb = funb + cosphase(0)*temp2b0
          cosphaseb(0) = cosphaseb(0) + fun*temp2b0
          sinphaseb(i, 0) = sinphaseb(i, 0) - distp(0, 1)*rphase(i)*zb(&
&            indorbp, indt+i)
          distpb(0, 1) = distpb(0, 1) + rphase(i)*temp2b1
          rphaseb(i) = rphaseb(i) + distp(0, 1)*temp2b1
          zb(indorbp, indt+i) = 0.D0
        END DO
        temp1 = fun/r(0)
        temp1b = (-dd1-1.0/r(0))*fun3b/r(0)
        funb = funb + temp1b
        temp0b0 = -(distp(0, 1)*funb/r(0))
        dd1b = temp0b0 - temp1*fun3b
        temp0 = dd1/r(0)
        rb(0) = rb(0) + temp1*fun3b/r(0)**2 - temp1*temp1b - temp0*&
&          temp0b0
        distpb(0, 1) = distpb(0, 1) - temp0*funb
      ELSE
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) + cosphase(i)*zb(indorbp, i)
        cosphaseb(i) = cosphaseb(i) + distp(i, 1)*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
      cb = 0.0_8
      DO k=0,0,-1
        temp0b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
        cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
        dd1b = dd1b - r(k)*temp0b
        rb(k) = rb(k) - dd1*temp0b
        distpb(k, 1) = 0.0_8
      END DO
      temp = DSQRT(dd1)
      IF (dd1 .EQ. 0.0) THEN
        dd1b = dd1b + 0.56418958354775628695d0*temp*cb
      ELSE
        dd1b = dd1b + (0.56418958354775628695d0*dd1/(2.D0*DSQRT(dd1))+&
&          0.56418958354775628695d0*temp)*cb
      END IF
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (161, 16)
! 2s gaussian periodic equal to 16
! R(r)=exp(-z*r**2) single zeta
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!            if(iflagnorm.gt.2) then
!           we use here the normalization of the
!           non periodic gaussian if dd1>0
!           unnormalized for dd1< 0 (hopefully small)
      c = .71270547035499016035d0*dd1**0.75d0
!                 if(c.gt.0) then
!                 c=c**0.75d0
!                 else
!                 c=1.d0
!                 endif
!            endif
      DO k=0,0
        distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
      END DO
      IF (typec .NE. 1) THEN
        fun = -(2.d0*dd1*distp(0, 1))
        fun3 = 4.d0*dd1**2*distp(0, 1)
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = (fun3*rmu(:, 0)**2*rmucos(:, 0)**2+fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2))*cosphase(0)
        hess(:) = hess(:) - 2.d0*fun*rmu(:, 0)*rmucos(:, 0)*sinphase(:, &
&          0)*rphase(:) - cosphase(0)*distp(0, 1)*rphase(:)**2
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        distpb = 0.0_8
        temp9b = -(sinphase(:, 0)*fun*rphase(:)*2.d0*hessb(:))
        temp9b0 = -(rmu(:, 0)*rmucos(:, 0)*2.d0*hessb(:))
        temp9b1 = -(rphase(:)**2*hessb(:))
        temp9b2 = cosphase(0)*hessb(:)
        temp8 = rmucos(:, 0)**2
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp8*temp9b2 + &
&          rmucos(:, 0)*temp9b
        temp7 = rmu(:, 0)**2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp7*&
&          temp9b2 + rmu(:, 0)*temp9b
        sinphaseb(:, 0) = sinphaseb(:, 0) + fun*rphase(:)*temp9b0
        temp6 = -(2.d0*rmusin(:, 0)**2) + 1.d0
        funb = SUM(temp6*temp9b2) + SUM(rphase(:)*sinphase(:, 0)*temp9b0&
&          )
        rphaseb(:) = rphaseb(:) + fun*sinphase(:, 0)*temp9b0 - 2*rphase(&
&          :)*cosphase(0)*distp(0, 1)*hessb(:)
        cosphaseb(0) = cosphaseb(0) + SUM((fun3*temp7*temp8+fun*temp6)*&
&          hessb(:)) + distp(0, 1)*SUM(temp9b1)
        distpb(0, 1) = cosphase(0)*SUM(temp9b1)
        fun3b = SUM(temp7*temp8*temp9b2)
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*temp9b2
        DO i=3,1,-1
          temp6b = fun*cosphase(0)*zb(indorbp, indt+i)
          temp6b0 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
          temp6b1 = -(sinphase(i, 0)*zb(indorbp, indt+i))
          rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp6b
          rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp6b
          funb = funb + cosphase(0)*temp6b0
          cosphaseb(0) = cosphaseb(0) + fun*temp6b0
          sinphaseb(i, 0) = sinphaseb(i, 0) - distp(0, 1)*rphase(i)*zb(&
&            indorbp, indt+i)
          distpb(0, 1) = distpb(0, 1) + rphase(i)*temp6b1
          rphaseb(i) = rphaseb(i) + distp(0, 1)*temp6b1
          zb(indorbp, indt+i) = 0.D0
        END DO
        dd1b = 4.d0*distp(0, 1)*2*dd1*fun3b - 2.d0*distp(0, 1)*funb
        distpb(0, 1) = distpb(0, 1) + 4.d0*dd1**2*fun3b - 2.d0*dd1*funb
      ELSE
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) + cosphase(i)*zb(indorbp, i)
        cosphaseb(i) = cosphaseb(i) + distp(i, 1)*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
      cb = 0.0_8
      DO k=0,0,-1
        temp5 = r(k)**2
        temp5b3 = c*DEXP(-(dd1*temp5))*distpb(k, 1)
        cb = cb + DEXP(-(dd1*temp5))*distpb(k, 1)
        dd1b = dd1b - temp5*temp5b3
        rb(k) = rb(k) - dd1*2*r(k)*temp5b3
        distpb(k, 1) = 0.0_8
      END DO
      dd1b = dd1b + .71270547035499016035d0*0.75d0*dd1**(-0.25D0)*cb
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (20)
! single exp p orbital periodic
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then
!         if(dd1.gt.0) then
    c = DSQRT((2.d0*dd1)**5/8.d0/pi)/2.d0
!         c=dd1**2.5d0*0.5641895835477562d0
!         else
!         c=1.d0
!         endif
!        endif
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    indorbp = indorb
!
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      rp1 = dd1*(1.d0+dd1*r(0))
      fun0 = distp(0, 1)
      fun = -(dd1*distp(0, 1)/r(0))
      fun3 = rp1*distp(0, 1)/r(0)**3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
! 3)
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(1.d0-2.d0*rmusin(:, 0)**2))*cosphase(0)
          hess(ic) = hess(ic) + (fun*(1.d0-2.d0*rmusin(ic, 0)**2)*rmu(ic&
&            , 0)*rmucos(ic, 0)+fun*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic, &
&            0)*rmucos(ic, 0)-fun0*4.d0*rmusin(ic, 0)*rmucos(ic, 0)*pi/&
&            cellscale(ic))*cosphase(0)
!from 1)
          hess(:) = hess(:) - rmu(:, 0)*rmucos(:, 0)*rphase(:)*fun*&
&            sinphase(:, 0)*rmucos(ic, 0)*rmu(ic, 0)
! from 2)
! from 1)
          hess(:) = hess(:) + rphase(:)*(-(fun*rmu(:, 0)*rmucos(:, 0)*&
&            sinphase(:, 0))-fun0*cosphase(0)*rphase(:))*rmucos(ic, 0)*&
&            rmu(ic, 0)
! from 3) and 1)
          hess(ic) = hess(ic) - 2.d0*fun0*(2.d0*rmucos(ic, 0)**2-1.d0)*&
&            rphase(ic)*sinphase(ic, 0)
!                z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp31b = -(2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic))
          temp31b0 = sinphase(ic, 0)*temp31b
          rmucosb(ic, 0) = rmucosb(ic, 0) - 2.d0**2*fun0*rphase(ic)*&
&            sinphase(ic, 0)*2*rmucos(ic, 0)*hessb(ic)
          temp28 = rphase(:)*rmucos(ic, 0)
          temp31b1 = temp28*rmu(ic, 0)*hessb(:)
          temp26b = cosphase(0)*hessb(ic)
          temp19 = rmusin(ic, 0)*rmucos(ic, 0)
          temp19b = -(pi*4.d0*temp26b)
          temp18b = temp19*temp19b/cellscale(ic)
          temp14b0 = (2.d0*rmucos(ic, 0)**2-1.d0)*zb(indorbp, indt+ic)
          fun0b = fun0b + SUM(-(cosphase(0)*rphase(:)*temp31b1)) + &
&            cosphase(0)*temp14b0 + temp18b + rphase(ic)*temp31b0
          rphaseb(ic) = rphaseb(ic) + fun0*temp31b0
          sinphaseb(ic, 0) = sinphaseb(ic, 0) + fun0*rphase(ic)*temp31b
          temp30 = rmucos(:, 0)*sinphase(:, 0)
          temp29 = fun*rmu(:, 0)
          temp29b = (-(temp29*temp30)-fun0*cosphase(0)*rphase(:))*hessb(&
&            :)
          temp28b = rmu(ic, 0)*temp29b
          temp27 = sinphase(:, 0)*rmucos(ic, 0)
          temp26 = rmu(:, 0)*rmucos(:, 0)
          temp26b0 = -(temp26*temp27*hessb(:))
          temp26b1 = rmu(ic, 0)*temp26b0
          temp24 = -(2.d0*rmusin(ic, 0)**2) + 1.d0
          temp23b = temp24*rmucos(ic, 0)*temp26b
          temp21 = 2.d0*rmucos(ic, 0)**2 - 1.d0
          temp20b = temp21*rmucos(ic, 0)*temp26b
          temp17 = -(2.d0*rmusin(:, 0)**2) + 1.d0
          temp14 = rmu(ic, 0)*cosphase(0)
          temp14b1 = temp14*rmucos(ic, 0)*hessb(:)
          funb = funb + SUM(rphase(:)*temp26b1) + SUM(temp17*temp14b1) +&
&            rmu(ic, 0)*temp20b + rmu(ic, 0)*temp23b + SUM(-(rmu(:, 0)*&
&            temp30*temp31b1))
          rmub(:, 0) = rmub(:, 0) - fun*temp30*temp31b1
          rmucosb(:, 0) = rmucosb(:, 0) - sinphase(:, 0)*temp29*temp31b1
          temp26b2 = -(rphase(:)*fun*rmu(ic, 0)*hessb(:))
          sinphaseb(:, 0) = sinphaseb(:, 0) + rmucos(ic, 0)*temp26*&
&            temp26b2 - rmucos(:, 0)*temp29*temp31b1
          temp23 = fun*rmu(ic, 0)
          temp25 = temp23*rmucos(ic, 0)
          temp20 = fun*rmu(ic, 0)
          temp22 = temp20*rmucos(ic, 0)
          temp18 = fun0/cellscale(ic)
          temp16 = rmucos(:, 0)**2
          temp15 = rmu(:, 0)**2
          temp15b = (fun3*temp15*temp16+fun*temp17)*hessb(:)
          temp14b2 = rmucos(ic, 0)*temp15b
          cosphaseb(0) = cosphaseb(0) + (temp24*temp25+temp21*temp22-pi*&
&            4.d0*(temp19*temp18))*hessb(ic) + fun0*temp14b0 + rmu(ic, 0)&
&            *SUM(temp14b2) + SUM(-(fun0*rphase(:)*temp31b1))
          rphaseb(:) = rphaseb(:) + fun*temp26b1 + rmucos(ic, 0)*SUM(&
&            temp28b) - fun0*cosphase(0)*temp31b1
          rmucosb(ic, 0) = rmucosb(ic, 0) + SUM(rphase(:)*temp28b)
          rmub(ic, 0) = rmub(ic, 0) + SUM(rphase(:)*fun*temp26b0) + SUM(&
&            temp28*temp29b)
          rmub(:, 0) = rmub(:, 0) + rmucos(:, 0)*temp27*temp26b2
          rmucosb(:, 0) = rmucosb(:, 0) + rmu(:, 0)*temp27*temp26b2
          rmucosb(ic, 0) = rmucosb(ic, 0) + (temp21*temp20+temp22*2.d0*2&
&            *rmucos(ic, 0)+temp24*temp23)*temp26b + temp18*rmusin(ic, 0)&
&            *temp19b + SUM(temp14*temp15b) + SUM(sinphase(:, 0)*temp26*&
&            temp26b2)
          rmusinb(ic, 0) = rmusinb(ic, 0) + temp18*rmucos(ic, 0)*temp19b&
&            - temp25*2.d0*2*rmusin(ic, 0)*temp26b
          rmub(ic, 0) = rmub(ic, 0) + cosphase(0)*SUM(temp14b2) + fun*&
&            temp20b + fun*temp23b
          cellscaleb(ic) = cellscaleb(ic) - temp18*temp18b
          fun3b = fun3b + SUM(temp15*temp16*temp14b1)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp16*temp14b1
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp15*&
&            temp14b1
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&            temp14b1
          rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*cosphase(0)*2.d0*2*&
&            rmucos(ic, 0)*zb(indorbp, indt+ic)
          DO i=3,1,-1
            temp14b = rmu(ic, 0)*rmucos(ic, 0)*zb(indorbp, indt+i)
            temp13 = fun*cosphase(0)
            temp12 = rmu(i, 0)*rmucos(i, 0)
            temp12b = temp12*temp13*zb(indorbp, indt+i)
            temp12b0 = -(sinphase(i, 0)*rmu(ic, 0)*zb(indorbp, indt+i))
            temp12b1 = rmucos(ic, 0)*temp12b0
            temp12b2 = -(fun0*rphase(i)*rmucos(ic, 0)*zb(indorbp, indt+i&
&              ))
            rmub(i, 0) = rmub(i, 0) + temp13*rmucos(i, 0)*temp14b
            rmucosb(i, 0) = rmucosb(i, 0) + temp13*rmu(i, 0)*temp14b
            funb = funb + temp12*cosphase(0)*temp14b
            cosphaseb(0) = cosphaseb(0) + temp12*fun*temp14b
            rmub(ic, 0) = rmub(ic, 0) + sinphase(i, 0)*temp12b2 + rmucos&
&              (ic, 0)*temp12b
            rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*rphase(i)*temp12b0 + &
&              rmu(ic, 0)*temp12b
            fun0b = fun0b + rphase(i)*temp12b1
            rphaseb(i) = rphaseb(i) + fun0*temp12b1
            sinphaseb(i, 0) = sinphaseb(i, 0) + rmu(ic, 0)*temp12b2
            zb(indorbp, indt+i) = 0.D0
          END DO
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      distpb = 0.0_8
      temp11 = r(0)**3
      temp11b = fun3b/temp11
      rp1b = distp(0, 1)*temp11b
      temp10 = dd1/r(0)
      distpb(0, 1) = fun0b - temp10*funb + rp1*temp11b
      temp10b2 = -(distp(0, 1)*funb/r(0))
      rb(0) = rb(0) + dd1**2*rp1b - temp10*temp10b2 - rp1*distp(0, 1)*3*&
&        r(0)**2*temp11b/temp11
      dd1b = (2*(dd1*r(0))+1.d0)*rp1b + temp10b2
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          temp10b0 = rmu(ic, i)*rmucos(ic, i)*zb(indorbp, i)
          temp10b1 = distp(i, 1)*cosphase(i)*zb(indorbp, i)
          distpb(i, 1) = distpb(i, 1) + cosphase(i)*temp10b0
          cosphaseb(i) = cosphaseb(i) + distp(i, 1)*temp10b0
          rmub(ic, i) = rmub(ic, i) + rmucos(ic, i)*temp10b1
          rmucosb(ic, i) = rmucosb(ic, i) + rmu(ic, i)*temp10b1
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp10b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp10b
      rb(k) = rb(k) - dd1*temp10b
      distpb(k, 1) = 0.0_8
    END DO
    temp9 = 2.d0**5
    IF (.NOT.temp9*(dd1**5/(8.d0*pi)) .EQ. 0.0) dd1b = dd1b + temp9*5*&
&        dd1**4*cb/(2.d0*2.D0*DSQRT(temp9*(dd1**5/(8.d0*pi)))*8.d0*pi)
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (40)
! derivative of 20 with respect zeta
! R(r)=c*(c1-r)*exp(-z*r)
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then
!         if(dd1.gt.0) then
    c = dd1**2.5d0*0.5641895835477562d0
!         c=dsqrt((2.d0*dd1)**5/8.d0/pi)/2.d0
!         else
!         c=1.d0
!         endif
!        endif
    IF (dd1 .GT. 0.d0) THEN
      c1 = 2.5d0/dd1
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      c1 = 0.d0
    END IF
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    indorbp = indorb
!
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      rp0 = r(0)
      rp1 = dd1*rp0
      rp2 = rp1*rp1
      fun0 = distp(0, 1)*(c1-rp0)
      fun = distp(0, 1)*(rp1-1.d0-c1*dd1)/r(0)
      fun3 = distp(0, 1)*(1.d0+rp1-rp2+c1*dd1*(1.d0+rp1))/r(0)**3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
! 3)
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(1.d0-2.d0*rmusin(:, 0)**2))*cosphase(0)
          hess(ic) = hess(ic) + (fun*(1.d0-2.d0*rmusin(ic, 0)**2)*rmu(ic&
&            , 0)*rmucos(ic, 0)+fun*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic, &
&            0)*rmucos(ic, 0)-fun0*4.d0*rmusin(ic, 0)*rmucos(ic, 0)*pi/&
&            cellscale(ic))*cosphase(0)
!from 1)
          hess(:) = hess(:) - rmu(:, 0)*rmucos(:, 0)*rphase(:)*fun*&
&            sinphase(:, 0)*rmucos(ic, 0)*rmu(ic, 0)
! from 2)
! from 1)
          hess(:) = hess(:) + rphase(:)*(-(fun*rmu(:, 0)*rmucos(:, 0)*&
&            sinphase(:, 0))-fun0*cosphase(0)*rphase(:))*rmucos(ic, 0)*&
&            rmu(ic, 0)
! from 3) and 1)
          hess(ic) = hess(ic) - 2.d0*fun0*(2.d0*rmucos(ic, 0)**2-1.d0)*&
&            rphase(ic)*sinphase(ic, 0)
!                z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp54b = -(2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic))
          temp54b0 = sinphase(ic, 0)*temp54b
          rmucosb(ic, 0) = rmucosb(ic, 0) - 2.d0**2*fun0*rphase(ic)*&
&            sinphase(ic, 0)*2*rmucos(ic, 0)*hessb(ic)
          temp51 = rphase(:)*rmucos(ic, 0)
          temp54b1 = temp51*rmu(ic, 0)*hessb(:)
          temp49b = cosphase(0)*hessb(ic)
          temp42 = rmusin(ic, 0)*rmucos(ic, 0)
          temp42b = -(pi*4.d0*temp49b)
          temp41b = temp42*temp42b/cellscale(ic)
          temp37b0 = (2.d0*rmucos(ic, 0)**2-1.d0)*zb(indorbp, indt+ic)
          fun0b = fun0b + SUM(-(cosphase(0)*rphase(:)*temp54b1)) + &
&            cosphase(0)*temp37b0 + temp41b + rphase(ic)*temp54b0
          rphaseb(ic) = rphaseb(ic) + fun0*temp54b0
          sinphaseb(ic, 0) = sinphaseb(ic, 0) + fun0*rphase(ic)*temp54b
          temp53 = rmucos(:, 0)*sinphase(:, 0)
          temp52 = fun*rmu(:, 0)
          temp52b = (-(temp52*temp53)-fun0*cosphase(0)*rphase(:))*hessb(&
&            :)
          temp51b = rmu(ic, 0)*temp52b
          temp50 = sinphase(:, 0)*rmucos(ic, 0)
          temp49 = rmu(:, 0)*rmucos(:, 0)
          temp49b0 = -(temp49*temp50*hessb(:))
          temp49b1 = rmu(ic, 0)*temp49b0
          temp47 = -(2.d0*rmusin(ic, 0)**2) + 1.d0
          temp46b = temp47*rmucos(ic, 0)*temp49b
          temp44 = 2.d0*rmucos(ic, 0)**2 - 1.d0
          temp43b = temp44*rmucos(ic, 0)*temp49b
          temp40 = -(2.d0*rmusin(:, 0)**2) + 1.d0
          temp37 = rmu(ic, 0)*cosphase(0)
          temp37b1 = temp37*rmucos(ic, 0)*hessb(:)
          funb = funb + SUM(rphase(:)*temp49b1) + SUM(temp40*temp37b1) +&
&            rmu(ic, 0)*temp43b + rmu(ic, 0)*temp46b + SUM(-(rmu(:, 0)*&
&            temp53*temp54b1))
          rmub(:, 0) = rmub(:, 0) - fun*temp53*temp54b1
          rmucosb(:, 0) = rmucosb(:, 0) - sinphase(:, 0)*temp52*temp54b1
          temp49b2 = -(rphase(:)*fun*rmu(ic, 0)*hessb(:))
          sinphaseb(:, 0) = sinphaseb(:, 0) + rmucos(ic, 0)*temp49*&
&            temp49b2 - rmucos(:, 0)*temp52*temp54b1
          temp46 = fun*rmu(ic, 0)
          temp48 = temp46*rmucos(ic, 0)
          temp43 = fun*rmu(ic, 0)
          temp45 = temp43*rmucos(ic, 0)
          temp41 = fun0/cellscale(ic)
          temp39 = rmucos(:, 0)**2
          temp38 = rmu(:, 0)**2
          temp38b = (fun3*temp38*temp39+fun*temp40)*hessb(:)
          temp37b2 = rmucos(ic, 0)*temp38b
          cosphaseb(0) = cosphaseb(0) + (temp47*temp48+temp44*temp45-pi*&
&            4.d0*(temp42*temp41))*hessb(ic) + fun0*temp37b0 + rmu(ic, 0)&
&            *SUM(temp37b2) + SUM(-(fun0*rphase(:)*temp54b1))
          rphaseb(:) = rphaseb(:) + fun*temp49b1 + rmucos(ic, 0)*SUM(&
&            temp51b) - fun0*cosphase(0)*temp54b1
          rmucosb(ic, 0) = rmucosb(ic, 0) + SUM(rphase(:)*temp51b)
          rmub(ic, 0) = rmub(ic, 0) + SUM(rphase(:)*fun*temp49b0) + SUM(&
&            temp51*temp52b)
          rmub(:, 0) = rmub(:, 0) + rmucos(:, 0)*temp50*temp49b2
          rmucosb(:, 0) = rmucosb(:, 0) + rmu(:, 0)*temp50*temp49b2
          rmucosb(ic, 0) = rmucosb(ic, 0) + (temp44*temp43+temp45*2.d0*2&
&            *rmucos(ic, 0)+temp47*temp46)*temp49b + temp41*rmusin(ic, 0)&
&            *temp42b + SUM(temp37*temp38b) + SUM(sinphase(:, 0)*temp49*&
&            temp49b2)
          rmusinb(ic, 0) = rmusinb(ic, 0) + temp41*rmucos(ic, 0)*temp42b&
&            - temp48*2.d0*2*rmusin(ic, 0)*temp49b
          rmub(ic, 0) = rmub(ic, 0) + cosphase(0)*SUM(temp37b2) + fun*&
&            temp43b + fun*temp46b
          cellscaleb(ic) = cellscaleb(ic) - temp41*temp41b
          fun3b = fun3b + SUM(temp38*temp39*temp37b1)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp39*temp37b1
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp38*&
&            temp37b1
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&            temp37b1
          rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*cosphase(0)*2.d0*2*&
&            rmucos(ic, 0)*zb(indorbp, indt+ic)
          DO i=3,1,-1
            temp37b = rmu(ic, 0)*rmucos(ic, 0)*zb(indorbp, indt+i)
            temp36 = fun*cosphase(0)
            temp35 = rmu(i, 0)*rmucos(i, 0)
            temp35b = temp35*temp36*zb(indorbp, indt+i)
            temp35b0 = -(sinphase(i, 0)*rmu(ic, 0)*zb(indorbp, indt+i))
            temp35b1 = rmucos(ic, 0)*temp35b0
            temp35b2 = -(fun0*rphase(i)*rmucos(ic, 0)*zb(indorbp, indt+i&
&              ))
            rmub(i, 0) = rmub(i, 0) + temp36*rmucos(i, 0)*temp37b
            rmucosb(i, 0) = rmucosb(i, 0) + temp36*rmu(i, 0)*temp37b
            funb = funb + temp35*cosphase(0)*temp37b
            cosphaseb(0) = cosphaseb(0) + temp35*fun*temp37b
            rmub(ic, 0) = rmub(ic, 0) + sinphase(i, 0)*temp35b2 + rmucos&
&              (ic, 0)*temp35b
            rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*rphase(i)*temp35b0 + &
&              rmu(ic, 0)*temp35b
            fun0b = fun0b + rphase(i)*temp35b1
            rphaseb(i) = rphaseb(i) + fun0*temp35b1
            sinphaseb(i, 0) = sinphaseb(i, 0) + rmu(ic, 0)*temp35b2
            zb(indorbp, indt+i) = 0.D0
          END DO
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      distpb = 0.0_8
      temp34 = r(0)**3
      temp33 = distp(0, 1)/temp34
      temp34b = temp33*fun3b
      temp33b = (rp1-rp2+c1*dd1*(rp1+1.d0)+1.d0)*fun3b/temp34
      rp2b = -temp34b
      temp32 = distp(0, 1)/r(0)
      temp32b0 = temp32*funb
      rp1b = temp32b0 + 2*rp1*rp2b + (c1*dd1+1.0_8)*temp34b
      c1b = distp(0, 1)*fun0b - dd1*temp32b0 + (rp1+1.d0)*dd1*temp34b
      dd1b = rp0*rp1b - c1*temp32b0 + (rp1+1.d0)*c1*temp34b
      temp32b1 = (rp1-c1*dd1-1.d0)*funb/r(0)
      distpb(0, 1) = temp32b1 + (c1-rp0)*fun0b + temp33b
      rp0b = dd1*rp1b - distp(0, 1)*fun0b
      rb(0) = rb(0) + rp0b - temp32*temp32b1 - temp33*3*r(0)**2*temp33b
    ELSE
      distpb = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          temp32b = rmu(ic, i)*(c1-r(i))*zb(indorbp, i)
          temp31b3 = rmucos(ic, i)*temp32b
          temp31 = distp(i, 1)*cosphase(i)
          temp31b4 = temp31*rmucos(ic, i)*zb(indorbp, i)
          temp31b5 = rmu(ic, i)*temp31b4
          distpb(i, 1) = distpb(i, 1) + cosphase(i)*temp31b3
          cosphaseb(i) = cosphaseb(i) + distp(i, 1)*temp31b3
          rmucosb(ic, i) = rmucosb(ic, i) + temp31*temp32b
          rmub(ic, i) = rmub(ic, i) + (c1-r(i))*temp31b4
          c1b = c1b + temp31b5
          rb(i) = rb(i) - temp31b5
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp31b2 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp31b2
      rb(k) = rb(k) - dd1*temp31b2
      distpb(k, 1) = 0.0_8
    END DO
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) dd1b = dd1b - 2.5d0*c1b/dd1**2
    dd1b = dd1b + 0.5641895835477562d0*2.5d0*dd1**1.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (17)
! 2s gaussian periodic
! R(r)=r^2*exp(-z*r**2) single zeta
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!           we use here the normalization of the
!           non periodic gaussian if dd1>0
!           unnormalized for dd1< 0 (hopefully small)
!                 if(dd1.gt.0) then
!        c=4.d0*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)/dsqrt(15.d0)
      c = 0.73607904464954686606d0*dd1**1.75d0
!                 else
!                 c=1.d0
!                 endif
!           endif
      DO k=0,0
        distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
      END DO
      IF (typec .NE. 1) THEN
        rp1 = dd1*r(0)**2
        fun0 = distp(0, 1)*r(0)**2
        fun = 2.d0*(1.d0-rp1)*distp(0, 1)
        fun3 = 4.d0*dd1*(rp1-2.d0)*distp(0, 1)
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = (fun3*rmu(:, 0)**2*rmucos(:, 0)**2+fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2))*cosphase(0)
        hess(:) = hess(:) - 2.d0*fun*rmu(:, 0)*rmucos(:, 0)*sinphase(:, &
&          0)*rphase(:) - cosphase(0)*fun0*rphase(:)**2
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp58b = -(sinphase(:, 0)*fun*rphase(:)*2.d0*hessb(:))
        temp58b0 = -(rmu(:, 0)*rmucos(:, 0)*2.d0*hessb(:))
        temp58b1 = -(rphase(:)**2*hessb(:))
        temp58b2 = cosphase(0)*hessb(:)
        temp57 = rmucos(:, 0)**2
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp57*temp58b2 + &
&          rmucos(:, 0)*temp58b
        temp56 = rmu(:, 0)**2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp56*&
&          temp58b2 + rmu(:, 0)*temp58b
        sinphaseb(:, 0) = sinphaseb(:, 0) + fun*rphase(:)*temp58b0
        temp55 = -(2.d0*rmusin(:, 0)**2) + 1.d0
        funb = SUM(temp55*temp58b2) + SUM(rphase(:)*sinphase(:, 0)*&
&          temp58b0)
        rphaseb(:) = rphaseb(:) + fun*sinphase(:, 0)*temp58b0 - 2*rphase&
&          (:)*cosphase(0)*fun0*hessb(:)
        cosphaseb(0) = cosphaseb(0) + SUM((fun3*temp56*temp57+fun*temp55&
&          )*hessb(:)) + fun0*SUM(temp58b1)
        fun0b = cosphase(0)*SUM(temp58b1)
        fun3b = SUM(temp56*temp57*temp58b2)
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*temp58b2
        DO i=3,1,-1
          temp55b1 = fun*cosphase(0)*zb(indorbp, indt+i)
          temp55b2 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
          temp55b3 = -(sinphase(i, 0)*zb(indorbp, indt+i))
          rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp55b1
          rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp55b1
          funb = funb + cosphase(0)*temp55b2
          cosphaseb(0) = cosphaseb(0) + fun*temp55b2
          sinphaseb(i, 0) = sinphaseb(i, 0) - fun0*rphase(i)*zb(indorbp&
&            , indt+i)
          fun0b = fun0b + rphase(i)*temp55b3
          rphaseb(i) = rphaseb(i) + fun0*temp55b3
          zb(indorbp, indt+i) = 0.D0
        END DO
        distpb = 0.0_8
        temp55b0 = 4.d0*distp(0, 1)*fun3b
        rp1b = dd1*temp55b0 - 2.d0*distp(0, 1)*funb
        dd1b = r(0)**2*rp1b + (rp1-2.d0)*temp55b0
        distpb(0, 1) = 2.d0*(1.d0-rp1)*funb + r(0)**2*fun0b + 4.d0*dd1*(&
&          rp1-2.d0)*fun3b
        rb(0) = rb(0) + dd1*2*r(0)*rp1b + distp(0, 1)*2*r(0)*fun0b
      ELSE
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=0,0,-1
        temp55b = r(i)**2*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + cosphase(i)*temp55b
        cosphaseb(i) = cosphaseb(i) + distp(i, 1)*temp55b
        rb(i) = rb(i) + distp(i, 1)*cosphase(i)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
      cb = 0.0_8
      DO k=0,0,-1
        temp54 = r(k)**2
        temp54b2 = c*DEXP(-(dd1*temp54))*distpb(k, 1)
        cb = cb + DEXP(-(dd1*temp54))*distpb(k, 1)
        dd1b = dd1b - temp54*temp54b2
        rb(k) = rb(k) - dd1*2*r(k)*temp54b2
        distpb(k, 1) = 0.0_8
      END DO
      dd1b = dd1b + 0.73607904464954686606d0*1.75d0*dd1**0.75D0*cb
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (46)
!   derivative of 17
! R(r)=exp(-z*r**2)*(-c*r^4  +c1 r^2)
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!                 if(dd1.gt.0) then
!        c=4.d0*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)/dsqrt(15.d0)
      c = .73607904464954686606d0*dd1**1.75d0
!        c=4.d0*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)/dsqrt(15.d0)
!                 else
!                 c=1.d0
!                 endif
!           endif
      IF (dd1 .GT. 0.d0) THEN
        c1 = 1.75d0/dd1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        c1 = 0.d0
      END IF
      DO k=0,0
        distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
      END DO
      IF (typec .NE. 1) THEN
        rp1 = r(0)**2
        rp2 = dd1*rp1
        fun0 = distp(0, 1)*r(0)**2*(c1-r(0)**2)
        fun = 2.d0*distp(0, 1)*(c1*(1-rp2)+rp1*rp2-2.d0*rp1)
        fun3 = 4.d0*distp(0, 1)*(4*rp2-2.d0-rp2**2+c1*dd1*(rp2-2.d0))
! ********** DIAGONAL PART HESSIAN ******************
        hess(:) = (fun3*rmu(:, 0)**2*rmucos(:, 0)**2+fun*(rmucos(:, 0)**&
&          2-pi*rmu(:, 0)*rmusin(:, 0)/cellscale(1:3)))*cosphase(0)
        hess(:) = hess(:) - 2.d0*fun*rmu(:, 0)*rmucos(:, 0)*sinphase(:, &
&          0)*rphase(:) - cosphase(0)*fun0*rphase(:)**2
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp65b = -(sinphase(:, 0)*fun*rphase(:)*2.d0*hessb(:))
        temp65b0 = -(rmu(:, 0)*rmucos(:, 0)*2.d0*hessb(:))
        temp65b1 = -(rphase(:)**2*hessb(:))
        temp65b2 = cosphase(0)*hessb(:)
        temp64 = rmucos(:, 0)**2
        temp62b = fun*temp65b2
        temp61b6 = -(pi*rmusin(:, 0)*temp62b/cellscale(1:3))
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp64*temp65b2 + &
&          temp61b6 + rmucos(:, 0)*temp65b
        temp63 = rmu(:, 0)**2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp63*&
&          temp65b2 + 2*rmucos(:, 0)*temp62b + rmu(:, 0)*temp65b
        sinphaseb(:, 0) = sinphaseb(:, 0) + fun*rphase(:)*temp65b0
        temp61 = rmu(:, 0)/cellscale(1:3)
        temp62 = rmucos(:, 0)**2 - pi*temp61*rmusin(:, 0)
        funb = SUM(temp62*temp65b2) + SUM(rphase(:)*sinphase(:, 0)*&
&          temp65b0)
        rphaseb(:) = rphaseb(:) + fun*sinphase(:, 0)*temp65b0 - 2*rphase&
&          (:)*cosphase(0)*fun0*hessb(:)
        cosphaseb(0) = cosphaseb(0) + SUM((fun3*temp63*temp64+fun*temp62&
&          )*hessb(:)) + fun0*SUM(temp65b1)
        fun0b = cosphase(0)*SUM(temp65b1)
        fun3b = SUM(temp63*temp64*temp65b2)
        cellscaleb(1:3) = cellscaleb(1:3) - temp61*temp61b6
        rmusinb(:, 0) = rmusinb(:, 0) - temp61*pi*temp62b
        DO i=3,1,-1
          temp61b3 = fun*cosphase(0)*zb(indorbp, indt+i)
          temp61b4 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
          temp61b5 = -(sinphase(i, 0)*zb(indorbp, indt+i))
          rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp61b3
          rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp61b3
          funb = funb + cosphase(0)*temp61b4
          cosphaseb(0) = cosphaseb(0) + fun*temp61b4
          sinphaseb(i, 0) = sinphaseb(i, 0) - fun0*rphase(i)*zb(indorbp&
&            , indt+i)
          fun0b = fun0b + rphase(i)*temp61b5
          rphaseb(i) = rphaseb(i) + fun0*temp61b5
          zb(indorbp, indt+i) = 0.D0
        END DO
        distpb = 0.0_8
        temp61b = 4.d0*distp(0, 1)*fun3b
        temp61b0 = (c1-r(0)**2)*fun0b
        distpb(0, 1) = 2.d0*(c1*(1-rp2)+rp1*rp2-2.d0*rp1)*funb + r(0)**2&
&          *temp61b0 + 4.d0*(4*rp2-rp2**2+c1*dd1*(rp2-2.d0)-2.d0)*fun3b
        temp61b1 = 2.d0*distp(0, 1)*funb
        rp2b = (rp1-c1)*temp61b1 + (c1*dd1-2*rp2+4)*temp61b
        temp61b2 = distp(0, 1)*r(0)**2*fun0b
        c1b = (1-rp2)*temp61b1 + temp61b2 + (rp2-2.d0)*dd1*temp61b
        dd1b = rp1*rp2b + (rp2-2.d0)*c1*temp61b
        rp1b = dd1*rp2b + (rp2-2.d0)*temp61b1
        rb(0) = rb(0) + 2*r(0)*rp1b - 2*r(0)*temp61b2 + distp(0, 1)*2*r(&
&          0)*temp61b0
      ELSE
        distpb = 0.0_8
        c1b = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=0,0,-1
        temp60 = c1 - r(i)**2
        temp59 = r(i)**2
        temp59b = temp59*temp60*zb(indorbp, i)
        temp59b0 = distp(i, 1)*cosphase(i)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + cosphase(i)*temp59b
        cosphaseb(i) = cosphaseb(i) + distp(i, 1)*temp59b
        rb(i) = rb(i) + (temp60*2*r(i)-temp59*2*r(i))*temp59b0
        c1b = c1b + temp59*temp59b0
        zb(indorbp, i) = 0.D0
      END DO
      cb = 0.0_8
      DO k=0,0,-1
        temp58 = r(k)**2
        temp58b3 = c*DEXP(-(dd1*temp58))*distpb(k, 1)
        cb = cb + DEXP(-(dd1*temp58))*distpb(k, 1)
        dd1b = dd1b - temp58*temp58b3
        rb(k) = rb(k) - dd1*2*r(k)*temp58b3
        distpb(k, 1) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 1) dd1b = dd1b - 1.75d0*c1b/dd1**2
      dd1b = dd1b + .73607904464954686606d0*1.75d0*dd1**0.75D0*cb
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (60)
! r^3 x Gaussian
! R(r)=r^3*exp(-z*r**2) single zeta
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!          if(iflagnorm.gt.2) then
!                 if(dd1.gt.0) then
!     c=2.d0/pi**(3.d0/4.d0)*(2.d0*dd1)**(9.d0/4.d0)*dsqrt(2.d0/105.d0)
      c = dd1**2.25d0*.55642345640820284397d0
!                 else
!                 c=1.d0
!                 endif
!           endif
      DO k=0,0
        distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
      END DO
      IF (typec .NE. 1) THEN
        rp1 = dd1*r(0)**2
        fun0 = distp(0, 1)*r(0)**3
        fun = r(0)*(3.d0-2.d0*rp1)*distp(0, 1)
        fun3 = (3.d0-12.d0*rp1+4.d0*rp1**2)*distp(0, 1)/r(0)
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = (fun3*rmu(:, 0)**2*rmucos(:, 0)**2+fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2))*cosphase(0)
        hess(:) = hess(:) - 2.d0*fun*rmu(:, 0)*rmucos(:, 0)*sinphase(:, &
&          0)*rphase(:) - cosphase(0)*fun0*rphase(:)**2
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp70b = -(sinphase(:, 0)*fun*rphase(:)*2.d0*hessb(:))
        temp70b0 = -(rmu(:, 0)*rmucos(:, 0)*2.d0*hessb(:))
        temp70b1 = -(rphase(:)**2*hessb(:))
        temp70b2 = cosphase(0)*hessb(:)
        temp69 = rmucos(:, 0)**2
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp69*temp70b2 + &
&          rmucos(:, 0)*temp70b
        temp68 = rmu(:, 0)**2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp68*&
&          temp70b2 + rmu(:, 0)*temp70b
        sinphaseb(:, 0) = sinphaseb(:, 0) + fun*rphase(:)*temp70b0
        temp67 = -(2.d0*rmusin(:, 0)**2) + 1.d0
        funb = SUM(temp67*temp70b2) + SUM(rphase(:)*sinphase(:, 0)*&
&          temp70b0)
        rphaseb(:) = rphaseb(:) + fun*sinphase(:, 0)*temp70b0 - 2*rphase&
&          (:)*cosphase(0)*fun0*hessb(:)
        cosphaseb(0) = cosphaseb(0) + SUM((fun3*temp68*temp69+fun*temp67&
&          )*hessb(:)) + fun0*SUM(temp70b1)
        fun0b = cosphase(0)*SUM(temp70b1)
        fun3b = SUM(temp68*temp69*temp70b2)
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*temp70b2
        DO i=3,1,-1
          temp67b = fun*cosphase(0)*zb(indorbp, indt+i)
          temp67b0 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
          temp67b1 = -(sinphase(i, 0)*zb(indorbp, indt+i))
          rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp67b
          rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp67b
          funb = funb + cosphase(0)*temp67b0
          cosphaseb(0) = cosphaseb(0) + fun*temp67b0
          sinphaseb(i, 0) = sinphaseb(i, 0) - fun0*rphase(i)*zb(indorbp&
&            , indt+i)
          fun0b = fun0b + rphase(i)*temp67b1
          rphaseb(i) = rphaseb(i) + fun0*temp67b1
          zb(indorbp, indt+i) = 0.D0
        END DO
        distpb = 0.0_8
        temp66 = distp(0, 1)/r(0)
        temp66b0 = (4.d0*rp1**2-12.d0*rp1+3.d0)*fun3b/r(0)
        rp1b = (temp66*4.d0*2*rp1-temp66*12.d0)*fun3b - r(0)*distp(0, 1)&
&          *2.d0*funb
        temp66b1 = (3.d0-2.d0*rp1)*funb
        distpb(0, 1) = r(0)*temp66b1 + r(0)**3*fun0b + temp66b0
        rb(0) = rb(0) + distp(0, 1)*temp66b1 + dd1*2*r(0)*rp1b + distp(0&
&          , 1)*3*r(0)**2*fun0b - temp66*temp66b0
        dd1b = r(0)**2*rp1b
      ELSE
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=0,0,-1
        temp66b = r(i)**3*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + cosphase(i)*temp66b
        cosphaseb(i) = cosphaseb(i) + distp(i, 1)*temp66b
        rb(i) = rb(i) + distp(i, 1)*cosphase(i)*3*r(i)**2*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
      cb = 0.0_8
      DO k=0,0,-1
        temp65 = r(k)**2
        temp65b3 = c*DEXP(-(dd1*temp65))*distpb(k, 1)
        cb = cb + DEXP(-(dd1*temp65))*distpb(k, 1)
        dd1b = dd1b - temp65*temp65b3
        rb(k) = rb(k) - dd1*2*r(k)*temp65b3
        distpb(k, 1) = 0.0_8
      END DO
      dd1b = dd1b + .55642345640820284397d0*2.25d0*dd1**1.25D0*cb
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (61)
!   derivative of 60
! R(r)=exp(-z*r**2)*(-c *r^5  +c1 r^3)
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!          if(iflagnorm.gt.2) then
!                 if(dd1.gt.0) then
      c = dd1**2.25d0*.55642345640820284397d0
!
!     c=2.d0/pi**(3.d0/4.d0)*(2.d0*dd1)**(9.d0/4.d0)*dsqrt(2.d0/105.d0)
!                 else
!                 c=1.d0
!                 endif
!           endif
!           if(dd1.gt.0.d0) then
      c1 = 2.25d0/dd1
!           else
!           c1=0.d0
!           endif
      DO k=0,0
        distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
      END DO
      IF (typec .NE. 1) THEN
        rp1 = r(0)**2
        rp2 = dd1*rp1
        fun0 = distp(0, 1)*r(0)**3*(c1-r(0)**2)
        fun = r(0)*distp(0, 1)*(c1*(3.d0-2.d0*rp2)+2.d0*rp1*rp2-5.d0*rp1&
&          )
        fun3 = distp(0, 1)*(-(15.d0*rp1)+20.d0*rp1*rp2-4.d0*rp2**2*rp1+&
&          c1*(3.d0-12.d0*rp2+4.d0*rp2**2))/r(0)
! ********** DIAGONAL PART HESSIAN ******************
        hess(:) = (fun3*rmu(:, 0)**2*rmucos(:, 0)**2+fun*(rmucos(:, 0)**&
&          2-pi*rmu(:, 0)*rmusin(:, 0)/cellscale(1:3)))*cosphase(0)
        hess(:) = hess(:) - 2.d0*fun*rmu(:, 0)*rmucos(:, 0)*sinphase(:, &
&          0)*rphase(:) - cosphase(0)*fun0*rphase(:)**2
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp79b = -(sinphase(:, 0)*fun*rphase(:)*2.d0*hessb(:))
        temp79b0 = -(rmu(:, 0)*rmucos(:, 0)*2.d0*hessb(:))
        temp79b1 = -(rphase(:)**2*hessb(:))
        temp79b2 = cosphase(0)*hessb(:)
        temp78 = rmucos(:, 0)**2
        temp76b = fun*temp79b2
        temp75b2 = -(pi*rmusin(:, 0)*temp76b/cellscale(1:3))
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp78*temp79b2 + &
&          temp75b2 + rmucos(:, 0)*temp79b
        temp77 = rmu(:, 0)**2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp77*&
&          temp79b2 + 2*rmucos(:, 0)*temp76b + rmu(:, 0)*temp79b
        sinphaseb(:, 0) = sinphaseb(:, 0) + fun*rphase(:)*temp79b0
        temp75 = rmu(:, 0)/cellscale(1:3)
        temp76 = rmucos(:, 0)**2 - pi*temp75*rmusin(:, 0)
        funb = SUM(temp76*temp79b2) + SUM(rphase(:)*sinphase(:, 0)*&
&          temp79b0)
        rphaseb(:) = rphaseb(:) + fun*sinphase(:, 0)*temp79b0 - 2*rphase&
&          (:)*cosphase(0)*fun0*hessb(:)
        cosphaseb(0) = cosphaseb(0) + SUM((fun3*temp77*temp78+fun*temp76&
&          )*hessb(:)) + fun0*SUM(temp79b1)
        fun0b = cosphase(0)*SUM(temp79b1)
        fun3b = SUM(temp77*temp78*temp79b2)
        cellscaleb(1:3) = cellscaleb(1:3) - temp75*temp75b2
        rmusinb(:, 0) = rmusinb(:, 0) - temp75*pi*temp76b
        DO i=3,1,-1
          temp75b = fun*cosphase(0)*zb(indorbp, indt+i)
          temp75b0 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
          temp75b1 = -(sinphase(i, 0)*zb(indorbp, indt+i))
          rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp75b
          rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp75b
          funb = funb + cosphase(0)*temp75b0
          cosphaseb(0) = cosphaseb(0) + fun*temp75b0
          sinphaseb(i, 0) = sinphaseb(i, 0) - fun0*rphase(i)*zb(indorbp&
&            , indt+i)
          fun0b = fun0b + rphase(i)*temp75b1
          rphaseb(i) = rphaseb(i) + fun0*temp75b1
          zb(indorbp, indt+i) = 0.D0
        END DO
        distpb = 0.0_8
        temp74 = 4.d0*rp2**2 - 12.d0*rp2 + 3.d0
        temp73b0 = (20.d0*(rp1*rp2)-15.d0*rp1+c1*temp74-4.d0*(rp2**2*rp1&
&          ))*fun3b/r(0)
        temp73 = distp(0, 1)/r(0)
        temp73b1 = temp73*fun3b
        temp73b2 = (c1*(3.d0-2.d0*rp2)+2.d0*(rp1*rp2)-5.d0*rp1)*funb
        temp73b3 = r(0)**3*fun0b
        distpb(0, 1) = r(0)*temp73b2 + (c1-r(0)**2)*temp73b3 + temp73b0
        temp73b4 = r(0)*distp(0, 1)*funb
        rp2b = (2.d0*rp1-c1*2.d0)*temp73b4 + (c1*4.d0*2*rp2-c1*12.d0-&
&          4.d0*rp1*2*rp2+20.d0*rp1)*temp73b1
        rp1b = (2.d0*rp2-5.d0)*temp73b4 + dd1*rp2b + (20.d0*rp2-4.d0*rp2&
&          **2-15.d0)*temp73b1
        rb(0) = rb(0) + distp(0, 1)*temp73b2 + 2*r(0)*rp1b - distp(0, 1)&
&          *2*r(0)*temp73b3 + distp(0, 1)*(c1-r(0)**2)*3*r(0)**2*fun0b - &
&          temp73*temp73b0
        c1b = (3.d0-2.d0*rp2)*temp73b4 + distp(0, 1)*temp73b3 + temp74*&
&          temp73b1
        dd1b = rp1*rp2b
      ELSE
        distpb = 0.0_8
        c1b = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=0,0,-1
        temp73b = r(i)**3*zb(indorbp, i)
        temp72 = c1 - r(i)**2
        temp71 = distp(i, 1)*cosphase(i)
        distpb(i, 1) = distpb(i, 1) + temp72*cosphase(i)*temp73b
        cosphaseb(i) = cosphaseb(i) + temp72*distp(i, 1)*temp73b
        c1b = c1b + temp71*temp73b
        rb(i) = rb(i) + temp71*temp72*3*r(i)**2*zb(indorbp, i) - temp71*&
&          2*r(i)*temp73b
        zb(indorbp, i) = 0.D0
      END DO
      cb = 0.0_8
      DO k=0,0,-1
        temp70 = r(k)**2
        temp70b3 = c*DEXP(-(dd1*temp70))*distpb(k, 1)
        cb = cb + DEXP(-(dd1*temp70))*distpb(k, 1)
        dd1b = dd1b - temp70*temp70b3
        rb(k) = rb(k) - dd1*2*r(k)*temp70b3
        distpb(k, 1) = 0.0_8
      END DO
      dd1b = dd1b + .55642345640820284397d0*2.25d0*dd1**1.25D0*cb - &
&        2.25d0*c1b/dd1**2
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (36)
! single gaussian p orbital periodic
    dd1 = dd(indpar+1)
! normalization for non periodic one
!        if(iflagnorm.gt.2) then
!         if(dd1.gt.0) then
!         c=dsqrt(2.d0)*pi**(-0.75d0)*(2.d0*dd1)**1.25d0
!         else
!         c=dsqrt(2.d0)*pi*(-0.75d0)
!         endif
    c = dd1**1.25d0*1.42541094070998d0
!        endif
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    indorbp = indorb
!
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      fun = -(2.d0*dd1*distp(0, 1))
      fun3 = 4.d0*dd1**2*distp(0, 1)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
! 3)
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(1.d0-2.d0*rmusin(:, 0)**2))*cosphase(0)
          hess(ic) = hess(ic) + (fun*(1.d0-2.d0*rmusin(ic, 0)**2)*rmu(ic&
&            , 0)*rmucos(ic, 0)+fun*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic, &
&            0)*rmucos(ic, 0)-distp(0, 1)*4.d0*rmusin(ic, 0)*rmucos(ic, 0&
&            )*pi/cellscale(ic))*cosphase(0)
!from 1)
          hess(:) = hess(:) - rmu(:, 0)*rmucos(:, 0)*rphase(:)*fun*&
&            sinphase(:, 0)*rmucos(ic, 0)*rmu(ic, 0)
! from 2)
! from 1)
          hess(:) = hess(:) + rphase(:)*(-(fun*rmu(:, 0)*rmucos(:, 0)*&
&            sinphase(:, 0))-distp(0, 1)*cosphase(0)*rphase(:))*rmucos(ic&
&            , 0)*rmu(ic, 0)
! from 3) and 1)
          hess(ic) = hess(ic) - 2.d0*distp(0, 1)*(2.d0*rmucos(ic, 0)**2-&
&            1.d0)*rphase(ic)*sinphase(ic, 0)
!      z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp100 = distp(0, 1)*rphase(ic)
          temp101b = -(2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic))
          temp100b = sinphase(ic, 0)*temp101b
          rmucosb(ic, 0) = rmucosb(ic, 0) - 2.d0**2*temp100*sinphase(ic&
&            , 0)*2*rmucos(ic, 0)*hessb(ic)
          temp97 = rphase(:)*rmucos(ic, 0)
          temp100b0 = temp97*rmu(ic, 0)*hessb(:)
          temp95b = cosphase(0)*hessb(ic)
          temp88 = rmusin(ic, 0)*rmucos(ic, 0)
          temp88b = -(pi*4.d0*temp95b)
          temp87b = temp88*temp88b/cellscale(ic)
          temp83b0 = (2.d0*rmucos(ic, 0)**2-1.d0)*zb(indorbp, indt+ic)
          distpb(0, 1) = distpb(0, 1) + SUM(-(cosphase(0)*rphase(:)*&
&            temp100b0)) + cosphase(0)*temp83b0 + temp87b + rphase(ic)*&
&            temp100b
          rphaseb(ic) = rphaseb(ic) + distp(0, 1)*temp100b
          sinphaseb(ic, 0) = sinphaseb(ic, 0) + temp100*temp101b
          temp99 = rmucos(:, 0)*sinphase(:, 0)
          temp98 = fun*rmu(:, 0)
          temp98b = (-(temp98*temp99)-distp(0, 1)*(cosphase(0)*rphase(:)&
&            ))*hessb(:)
          temp97b = rmu(ic, 0)*temp98b
          temp96 = sinphase(:, 0)*rmucos(ic, 0)
          temp95 = rmu(:, 0)*rmucos(:, 0)
          temp95b0 = -(temp95*temp96*hessb(:))
          temp95b1 = rmu(ic, 0)*temp95b0
          temp93 = -(2.d0*rmusin(ic, 0)**2) + 1.d0
          temp92b = temp93*rmucos(ic, 0)*temp95b
          temp90 = 2.d0*rmucos(ic, 0)**2 - 1.d0
          temp89b = temp90*rmucos(ic, 0)*temp95b
          temp86 = -(2.d0*rmusin(:, 0)**2) + 1.d0
          temp83 = rmu(ic, 0)*cosphase(0)
          temp83b1 = temp83*rmucos(ic, 0)*hessb(:)
          funb = funb + SUM(rphase(:)*temp95b1) + SUM(temp86*temp83b1) +&
&            rmu(ic, 0)*temp89b + rmu(ic, 0)*temp92b + SUM(-(rmu(:, 0)*&
&            temp99*temp100b0))
          rmub(:, 0) = rmub(:, 0) - fun*temp99*temp100b0
          rmucosb(:, 0) = rmucosb(:, 0) - sinphase(:, 0)*temp98*&
&            temp100b0
          temp95b2 = -(rphase(:)*fun*rmu(ic, 0)*hessb(:))
          sinphaseb(:, 0) = sinphaseb(:, 0) + rmucos(ic, 0)*temp95*&
&            temp95b2 - rmucos(:, 0)*temp98*temp100b0
          temp92 = fun*rmu(ic, 0)
          temp94 = temp92*rmucos(ic, 0)
          temp89 = fun*rmu(ic, 0)
          temp91 = temp89*rmucos(ic, 0)
          temp87 = distp(0, 1)/cellscale(ic)
          temp85 = rmucos(:, 0)**2
          temp84 = rmu(:, 0)**2
          temp84b = (fun3*temp84*temp85+fun*temp86)*hessb(:)
          temp83b2 = rmucos(ic, 0)*temp84b
          cosphaseb(0) = cosphaseb(0) + (temp93*temp94+temp90*temp91-pi*&
&            4.d0*(temp88*temp87))*hessb(ic) + distp(0, 1)*temp83b0 + rmu&
&            (ic, 0)*SUM(temp83b2) + SUM(-(rphase(:)*distp(0, 1)*&
&            temp100b0))
          rphaseb(:) = rphaseb(:) + fun*temp95b1 + rmucos(ic, 0)*SUM(&
&            temp97b) - cosphase(0)*distp(0, 1)*temp100b0
          rmucosb(ic, 0) = rmucosb(ic, 0) + SUM(rphase(:)*temp97b)
          rmub(ic, 0) = rmub(ic, 0) + SUM(rphase(:)*fun*temp95b0) + SUM(&
&            temp97*temp98b)
          rmub(:, 0) = rmub(:, 0) + rmucos(:, 0)*temp96*temp95b2
          rmucosb(:, 0) = rmucosb(:, 0) + rmu(:, 0)*temp96*temp95b2
          rmucosb(ic, 0) = rmucosb(ic, 0) + (temp90*temp89+temp91*2.d0*2&
&            *rmucos(ic, 0)+temp93*temp92)*temp95b + temp87*rmusin(ic, 0)&
&            *temp88b + SUM(temp83*temp84b) + SUM(sinphase(:, 0)*temp95*&
&            temp95b2)
          rmusinb(ic, 0) = rmusinb(ic, 0) + temp87*rmucos(ic, 0)*temp88b&
&            - temp94*2.d0*2*rmusin(ic, 0)*temp95b
          rmub(ic, 0) = rmub(ic, 0) + cosphase(0)*SUM(temp83b2) + fun*&
&            temp89b + fun*temp92b
          cellscaleb(ic) = cellscaleb(ic) - temp87*temp87b
          fun3b = fun3b + SUM(temp84*temp85*temp83b1)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp85*temp83b1
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp84*&
&            temp83b1
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&            temp83b1
          rmucosb(ic, 0) = rmucosb(ic, 0) + distp(0, 1)*cosphase(0)*2.d0&
&            *2*rmucos(ic, 0)*zb(indorbp, indt+ic)
          DO i=3,1,-1
            temp83b = rmu(ic, 0)*rmucos(ic, 0)*zb(indorbp, indt+i)
            temp82 = fun*cosphase(0)
            temp81 = rmu(i, 0)*rmucos(i, 0)
            temp81b = temp81*temp82*zb(indorbp, indt+i)
            temp81b0 = -(sinphase(i, 0)*rmu(ic, 0)*zb(indorbp, indt+i))
            temp80b1 = rmucos(ic, 0)*temp81b0
            temp80 = distp(0, 1)*rphase(i)
            temp80b2 = -(temp80*rmucos(ic, 0)*zb(indorbp, indt+i))
            rmub(i, 0) = rmub(i, 0) + temp82*rmucos(i, 0)*temp83b
            rmucosb(i, 0) = rmucosb(i, 0) + temp82*rmu(i, 0)*temp83b
            funb = funb + temp81*cosphase(0)*temp83b
            cosphaseb(0) = cosphaseb(0) + temp81*fun*temp83b
            rmub(ic, 0) = rmub(ic, 0) + sinphase(i, 0)*temp80b2 + rmucos&
&              (ic, 0)*temp81b
            rmucosb(ic, 0) = rmucosb(ic, 0) + temp80*temp81b0 + rmu(ic, &
&              0)*temp81b
            distpb(0, 1) = distpb(0, 1) + rphase(i)*temp80b1
            rphaseb(i) = rphaseb(i) + distp(0, 1)*temp80b1
            sinphaseb(i, 0) = sinphaseb(i, 0) + rmu(ic, 0)*temp80b2
            zb(indorbp, indt+i) = 0.D0
          END DO
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      dd1b = 4.d0*distp(0, 1)*2*dd1*fun3b - 2.d0*distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) + 4.d0*dd1**2*fun3b - 2.d0*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          temp80b = rmu(ic, i)*rmucos(ic, i)*zb(indorbp, i)
          temp80b0 = distp(i, 1)*cosphase(i)*zb(indorbp, i)
          distpb(i, 1) = distpb(i, 1) + cosphase(i)*temp80b
          cosphaseb(i) = cosphaseb(i) + distp(i, 1)*temp80b
          rmub(ic, i) = rmub(ic, i) + rmucos(ic, i)*temp80b0
          rmucosb(ic, i) = rmucosb(ic, i) + rmu(ic, i)*temp80b0
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp79 = r(k)**2
      temp79b3 = c*DEXP(-(dd1*temp79))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp79))*distpb(k, 1)
      dd1b = dd1b - temp79*temp79b3
      rb(k) = rb(k) - dd1*2*r(k)*temp79b3
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.42541094070998d0*1.25d0*dd1**0.25D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (62)
! single gaussian p orbital periodic
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then
! normalization for non periodic one
!        if(dd1.gt.0) then
    c = 2.d0/pi**0.75d0*(2.d0*dd1)**1.75d0/DSQRT(5.d0)
!      c=dd1**1.75d0*1.2749263037197753d0
!        else
!        c=1.d0
!        endif
!        endif
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    indorbp = indorb
!
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      rp1 = 2.d0*dd1*r(0)**2
      fun0 = distp(0, 1)*r(0)
      fun = (1.d0-rp1)*distp(0, 1)/r(0)
      fun3 = (rp1**2-1.d0-2.d0*rp1)*distp(0, 1)/r(0)**3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
! 3)
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(1.d0-2.d0*rmusin(:, 0)**2))*cosphase(0)
          hess(ic) = hess(ic) + (fun*(1.d0-2.d0*rmusin(ic, 0)**2)*rmu(ic&
&            , 0)*rmucos(ic, 0)+fun*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic, &
&            0)*rmucos(ic, 0)-fun0*4.d0*rmusin(ic, 0)*rmucos(ic, 0)*pi/&
&            cellscale(ic))*cosphase(0)
!from 1)
          hess(:) = hess(:) - rmu(:, 0)*rmucos(:, 0)*rphase(:)*fun*&
&            sinphase(:, 0)*rmucos(ic, 0)*rmu(ic, 0)
! from 2)
! from 1)
          hess(:) = hess(:) + rphase(:)*(-(fun*rmu(:, 0)*rmucos(:, 0)*&
&            sinphase(:, 0))-fun0*cosphase(0)*rphase(:))*rmucos(ic, 0)*&
&            rmu(ic, 0)
! from 3) and 1)
          hess(ic) = hess(ic) - 2.d0*fun0*(2.d0*rmucos(ic, 0)**2-1.d0)*&
&            rphase(ic)*sinphase(ic, 0)
!                z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp125b = -(2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic))
          temp125b0 = sinphase(ic, 0)*temp125b
          rmucosb(ic, 0) = rmucosb(ic, 0) - 2.d0**2*fun0*rphase(ic)*&
&            sinphase(ic, 0)*2*rmucos(ic, 0)*hessb(ic)
          temp122 = rphase(:)*rmucos(ic, 0)
          temp125b1 = temp122*rmu(ic, 0)*hessb(:)
          temp120b = cosphase(0)*hessb(ic)
          temp113 = rmusin(ic, 0)*rmucos(ic, 0)
          temp113b = -(pi*4.d0*temp120b)
          temp112b = temp113*temp113b/cellscale(ic)
          temp108b0 = (2.d0*rmucos(ic, 0)**2-1.d0)*zb(indorbp, indt+ic)
          fun0b = fun0b + SUM(-(cosphase(0)*rphase(:)*temp125b1)) + &
&            cosphase(0)*temp108b0 + temp112b + rphase(ic)*temp125b0
          rphaseb(ic) = rphaseb(ic) + fun0*temp125b0
          sinphaseb(ic, 0) = sinphaseb(ic, 0) + fun0*rphase(ic)*temp125b
          temp124 = rmucos(:, 0)*sinphase(:, 0)
          temp123 = fun*rmu(:, 0)
          temp123b = (-(temp123*temp124)-fun0*cosphase(0)*rphase(:))*&
&            hessb(:)
          temp122b = rmu(ic, 0)*temp123b
          temp121 = sinphase(:, 0)*rmucos(ic, 0)
          temp120 = rmu(:, 0)*rmucos(:, 0)
          temp120b0 = -(temp120*temp121*hessb(:))
          temp120b1 = rmu(ic, 0)*temp120b0
          temp118 = -(2.d0*rmusin(ic, 0)**2) + 1.d0
          temp117b = temp118*rmucos(ic, 0)*temp120b
          temp115 = 2.d0*rmucos(ic, 0)**2 - 1.d0
          temp114b = temp115*rmucos(ic, 0)*temp120b
          temp111 = -(2.d0*rmusin(:, 0)**2) + 1.d0
          temp108 = rmu(ic, 0)*cosphase(0)
          temp108b1 = temp108*rmucos(ic, 0)*hessb(:)
          funb = funb + SUM(rphase(:)*temp120b1) + SUM(temp111*temp108b1&
&            ) + rmu(ic, 0)*temp114b + rmu(ic, 0)*temp117b + SUM(-(rmu(:&
&            , 0)*temp124*temp125b1))
          rmub(:, 0) = rmub(:, 0) - fun*temp124*temp125b1
          rmucosb(:, 0) = rmucosb(:, 0) - sinphase(:, 0)*temp123*&
&            temp125b1
          temp120b2 = -(rphase(:)*fun*rmu(ic, 0)*hessb(:))
          sinphaseb(:, 0) = sinphaseb(:, 0) + rmucos(ic, 0)*temp120*&
&            temp120b2 - rmucos(:, 0)*temp123*temp125b1
          temp117 = fun*rmu(ic, 0)
          temp119 = temp117*rmucos(ic, 0)
          temp114 = fun*rmu(ic, 0)
          temp116 = temp114*rmucos(ic, 0)
          temp112 = fun0/cellscale(ic)
          temp110 = rmucos(:, 0)**2
          temp109 = rmu(:, 0)**2
          temp109b = (fun3*temp109*temp110+fun*temp111)*hessb(:)
          temp108b2 = rmucos(ic, 0)*temp109b
          cosphaseb(0) = cosphaseb(0) + (temp118*temp119+temp115*temp116&
&            -pi*4.d0*(temp113*temp112))*hessb(ic) + fun0*temp108b0 + rmu&
&            (ic, 0)*SUM(temp108b2) + SUM(-(fun0*rphase(:)*temp125b1))
          rphaseb(:) = rphaseb(:) + fun*temp120b1 + rmucos(ic, 0)*SUM(&
&            temp122b) - fun0*cosphase(0)*temp125b1
          rmucosb(ic, 0) = rmucosb(ic, 0) + SUM(rphase(:)*temp122b)
          rmub(ic, 0) = rmub(ic, 0) + SUM(rphase(:)*fun*temp120b0) + SUM&
&            (temp122*temp123b)
          rmub(:, 0) = rmub(:, 0) + rmucos(:, 0)*temp121*temp120b2
          rmucosb(:, 0) = rmucosb(:, 0) + rmu(:, 0)*temp121*temp120b2
          rmucosb(ic, 0) = rmucosb(ic, 0) + (temp115*temp114+temp116*&
&            2.d0*2*rmucos(ic, 0)+temp118*temp117)*temp120b + temp112*&
&            rmusin(ic, 0)*temp113b + SUM(temp108*temp109b) + SUM(&
&            sinphase(:, 0)*temp120*temp120b2)
          rmusinb(ic, 0) = rmusinb(ic, 0) + temp112*rmucos(ic, 0)*&
&            temp113b - temp119*2.d0*2*rmusin(ic, 0)*temp120b
          rmub(ic, 0) = rmub(ic, 0) + cosphase(0)*SUM(temp108b2) + fun*&
&            temp114b + fun*temp117b
          cellscaleb(ic) = cellscaleb(ic) - temp112*temp112b
          fun3b = fun3b + SUM(temp109*temp110*temp108b1)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp110*temp108b1
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp109*&
&            temp108b1
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&            temp108b1
          rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*cosphase(0)*2.d0*2*&
&            rmucos(ic, 0)*zb(indorbp, indt+ic)
          DO i=3,1,-1
            temp108b = rmu(ic, 0)*rmucos(ic, 0)*zb(indorbp, indt+i)
            temp107 = fun*cosphase(0)
            temp106 = rmu(i, 0)*rmucos(i, 0)
            temp106b = temp106*temp107*zb(indorbp, indt+i)
            temp106b0 = -(sinphase(i, 0)*rmu(ic, 0)*zb(indorbp, indt+i))
            temp106b1 = rmucos(ic, 0)*temp106b0
            temp106b2 = -(fun0*rphase(i)*rmucos(ic, 0)*zb(indorbp, indt+&
&              i))
            rmub(i, 0) = rmub(i, 0) + temp107*rmucos(i, 0)*temp108b
            rmucosb(i, 0) = rmucosb(i, 0) + temp107*rmu(i, 0)*temp108b
            funb = funb + temp106*cosphase(0)*temp108b
            cosphaseb(0) = cosphaseb(0) + temp106*fun*temp108b
            rmub(ic, 0) = rmub(ic, 0) + sinphase(i, 0)*temp106b2 + &
&              rmucos(ic, 0)*temp106b
            rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*rphase(i)*temp106b0 +&
&              rmu(ic, 0)*temp106b
            fun0b = fun0b + rphase(i)*temp106b1
            rphaseb(i) = rphaseb(i) + fun0*temp106b1
            sinphaseb(i, 0) = sinphaseb(i, 0) + rmu(ic, 0)*temp106b2
            zb(indorbp, indt+i) = 0.D0
          END DO
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      distpb = 0.0_8
      temp105 = r(0)**3
      temp104 = distp(0, 1)/temp105
      temp104b = (rp1**2-2.d0*rp1-1.d0)*fun3b/temp105
      temp103b1 = distp(0, 1)*funb/r(0)
      rp1b = (temp104*2*rp1-temp104*2.d0)*fun3b - temp103b1
      temp103 = (-rp1+1.d0)/r(0)
      distpb(0, 1) = temp103*funb + r(0)*fun0b + temp104b
      rb(0) = rb(0) + 2.d0*dd1*2*r(0)*rp1b - temp103*temp103b1 + distp(0&
&        , 1)*fun0b - temp104*3*r(0)**2*temp104b
      dd1b = 2.d0*r(0)**2*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          temp102 = r(i)*cosphase(i)
          temp103b = rmucos(ic, i)*temp102*zb(indorbp, i)
          temp103b0 = distp(i, 1)*rmu(ic, i)*zb(indorbp, i)
          temp102b = rmucos(ic, i)*temp103b0
          distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp103b
          rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp103b
          rmucosb(ic, i) = rmucosb(ic, i) + temp102*temp103b0
          rb(i) = rb(i) + cosphase(i)*temp102b
          cosphaseb(i) = cosphaseb(i) + r(i)*temp102b
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp101 = r(k)**2
      temp101b0 = c*DEXP(-(dd1*temp101))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp101))*distpb(k, 1)
      dd1b = dd1b - temp101*temp101b0
      rb(k) = rb(k) - dd1*2*r(k)*temp101b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 2.d0**2*1.75d0*(2.d0*dd1)**0.75D0*cb/(pi**0.75d0*DSQRT&
&      (5.d0))
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (63)
! derivative of 36 with respect zeta
! R(r)=c*x*r*exp(-z*r**2)*(c1-r**2)
    dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then
! normalization for non periodic one
!         if(dd1.gt.0) then
    c = dd1**1.75d0*1.2749263037197753d0
!       c=2.d0/pi**0.75d0*(2.d0*dd1)**1.75d0/dsqrt(5.d0)
!         else
!         c=1.d0
!         endif
!         endif
    IF (dd1 .GT. 0.d0) THEN
      c1 = 1.75d0/dd1
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      c1 = 0.d0
    END IF
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    indorbp = indorb
!
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      rp0 = r(0)**2
      rp1 = 2*dd1*rp0
      rp2 = rp1*rp0
      fun = distp(0, 1)*(c1*(1.d0-rp1)+rp2-3.d0*rp0)/r(0)
      fun0 = r(0)*distp(0, 1)*(c1-rp0)
      fun3 = -(distp(0, 1)*(c1*(1.d0+2.d0*rp1-2.d0*rp2*dd1)+3.d0*rp0-&
&        6.d0*rp2+rp1*rp2)/r(0)**3)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
! 3)
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(1.d0-2.d0*rmusin(:, 0)**2))*cosphase(0)
          hess(ic) = hess(ic) + (fun*(1.d0-2.d0*rmusin(ic, 0)**2)*rmu(ic&
&            , 0)*rmucos(ic, 0)+fun*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic, &
&            0)*rmucos(ic, 0)-fun0*4.d0*rmusin(ic, 0)*rmucos(ic, 0)*pi/&
&            cellscale(ic))*cosphase(0)
!from 1)
          hess(:) = hess(:) - rmu(:, 0)*rmucos(:, 0)*rphase(:)*fun*&
&            sinphase(:, 0)*rmucos(ic, 0)*rmu(ic, 0)
! from 2)
! from 1)
          hess(:) = hess(:) + rphase(:)*(-(fun*rmu(:, 0)*rmucos(:, 0)*&
&            sinphase(:, 0))-fun0*cosphase(0)*rphase(:))*rmucos(ic, 0)*&
&            rmu(ic, 0)
! from 3) and 1)
          hess(ic) = hess(ic) - 2.d0*fun0*(2.d0*rmucos(ic, 0)**2-1.d0)*&
&            rphase(ic)*sinphase(ic, 0)
!                z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp152b = -(2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic))
          temp152b0 = sinphase(ic, 0)*temp152b
          rmucosb(ic, 0) = rmucosb(ic, 0) - 2.d0**2*fun0*rphase(ic)*&
&            sinphase(ic, 0)*2*rmucos(ic, 0)*hessb(ic)
          temp149 = rphase(:)*rmucos(ic, 0)
          temp152b1 = temp149*rmu(ic, 0)*hessb(:)
          temp147b = cosphase(0)*hessb(ic)
          temp140 = rmusin(ic, 0)*rmucos(ic, 0)
          temp140b = -(pi*4.d0*temp147b)
          temp139b = temp140*temp140b/cellscale(ic)
          temp135b0 = (2.d0*rmucos(ic, 0)**2-1.d0)*zb(indorbp, indt+ic)
          fun0b = fun0b + SUM(-(cosphase(0)*rphase(:)*temp152b1)) + &
&            cosphase(0)*temp135b0 + temp139b + rphase(ic)*temp152b0
          rphaseb(ic) = rphaseb(ic) + fun0*temp152b0
          sinphaseb(ic, 0) = sinphaseb(ic, 0) + fun0*rphase(ic)*temp152b
          temp151 = rmucos(:, 0)*sinphase(:, 0)
          temp150 = fun*rmu(:, 0)
          temp150b = (-(temp150*temp151)-fun0*cosphase(0)*rphase(:))*&
&            hessb(:)
          temp149b = rmu(ic, 0)*temp150b
          temp148 = sinphase(:, 0)*rmucos(ic, 0)
          temp147 = rmu(:, 0)*rmucos(:, 0)
          temp147b0 = -(temp147*temp148*hessb(:))
          temp147b1 = rmu(ic, 0)*temp147b0
          temp145 = -(2.d0*rmusin(ic, 0)**2) + 1.d0
          temp144b = temp145*rmucos(ic, 0)*temp147b
          temp142 = 2.d0*rmucos(ic, 0)**2 - 1.d0
          temp141b = temp142*rmucos(ic, 0)*temp147b
          temp138 = -(2.d0*rmusin(:, 0)**2) + 1.d0
          temp135 = rmu(ic, 0)*cosphase(0)
          temp135b1 = temp135*rmucos(ic, 0)*hessb(:)
          funb = funb + SUM(rphase(:)*temp147b1) + SUM(temp138*temp135b1&
&            ) + rmu(ic, 0)*temp141b + rmu(ic, 0)*temp144b + SUM(-(rmu(:&
&            , 0)*temp151*temp152b1))
          rmub(:, 0) = rmub(:, 0) - fun*temp151*temp152b1
          rmucosb(:, 0) = rmucosb(:, 0) - sinphase(:, 0)*temp150*&
&            temp152b1
          temp147b2 = -(rphase(:)*fun*rmu(ic, 0)*hessb(:))
          sinphaseb(:, 0) = sinphaseb(:, 0) + rmucos(ic, 0)*temp147*&
&            temp147b2 - rmucos(:, 0)*temp150*temp152b1
          temp144 = fun*rmu(ic, 0)
          temp146 = temp144*rmucos(ic, 0)
          temp141 = fun*rmu(ic, 0)
          temp143 = temp141*rmucos(ic, 0)
          temp139 = fun0/cellscale(ic)
          temp137 = rmucos(:, 0)**2
          temp136 = rmu(:, 0)**2
          temp136b = (fun3*temp136*temp137+fun*temp138)*hessb(:)
          temp135b2 = rmucos(ic, 0)*temp136b
          cosphaseb(0) = cosphaseb(0) + (temp145*temp146+temp142*temp143&
&            -pi*4.d0*(temp140*temp139))*hessb(ic) + fun0*temp135b0 + rmu&
&            (ic, 0)*SUM(temp135b2) + SUM(-(fun0*rphase(:)*temp152b1))
          rphaseb(:) = rphaseb(:) + fun*temp147b1 + rmucos(ic, 0)*SUM(&
&            temp149b) - fun0*cosphase(0)*temp152b1
          rmucosb(ic, 0) = rmucosb(ic, 0) + SUM(rphase(:)*temp149b)
          rmub(ic, 0) = rmub(ic, 0) + SUM(rphase(:)*fun*temp147b0) + SUM&
&            (temp149*temp150b)
          rmub(:, 0) = rmub(:, 0) + rmucos(:, 0)*temp148*temp147b2
          rmucosb(:, 0) = rmucosb(:, 0) + rmu(:, 0)*temp148*temp147b2
          rmucosb(ic, 0) = rmucosb(ic, 0) + (temp142*temp141+temp143*&
&            2.d0*2*rmucos(ic, 0)+temp145*temp144)*temp147b + temp139*&
&            rmusin(ic, 0)*temp140b + SUM(temp135*temp136b) + SUM(&
&            sinphase(:, 0)*temp147*temp147b2)
          rmusinb(ic, 0) = rmusinb(ic, 0) + temp139*rmucos(ic, 0)*&
&            temp140b - temp146*2.d0*2*rmusin(ic, 0)*temp147b
          rmub(ic, 0) = rmub(ic, 0) + cosphase(0)*SUM(temp135b2) + fun*&
&            temp141b + fun*temp144b
          cellscaleb(ic) = cellscaleb(ic) - temp139*temp139b
          fun3b = fun3b + SUM(temp136*temp137*temp135b1)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp137*temp135b1
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp136*&
&            temp135b1
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&            temp135b1
          rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*cosphase(0)*2.d0*2*&
&            rmucos(ic, 0)*zb(indorbp, indt+ic)
          DO i=3,1,-1
            temp135b = rmu(ic, 0)*rmucos(ic, 0)*zb(indorbp, indt+i)
            temp134 = fun*cosphase(0)
            temp133 = rmu(i, 0)*rmucos(i, 0)
            temp133b = temp133*temp134*zb(indorbp, indt+i)
            temp133b0 = -(sinphase(i, 0)*rmu(ic, 0)*zb(indorbp, indt+i))
            temp133b1 = rmucos(ic, 0)*temp133b0
            temp133b2 = -(fun0*rphase(i)*rmucos(ic, 0)*zb(indorbp, indt+&
&              i))
            rmub(i, 0) = rmub(i, 0) + temp134*rmucos(i, 0)*temp135b
            rmucosb(i, 0) = rmucosb(i, 0) + temp134*rmu(i, 0)*temp135b
            funb = funb + temp133*cosphase(0)*temp135b
            cosphaseb(0) = cosphaseb(0) + temp133*fun*temp135b
            rmub(ic, 0) = rmub(ic, 0) + sinphase(i, 0)*temp133b2 + &
&              rmucos(ic, 0)*temp133b
            rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*rphase(i)*temp133b0 +&
&              rmu(ic, 0)*temp133b
            fun0b = fun0b + rphase(i)*temp133b1
            rphaseb(i) = rphaseb(i) + fun0*temp133b1
            sinphaseb(i, 0) = sinphaseb(i, 0) + rmu(ic, 0)*temp133b2
            zb(indorbp, indt+i) = 0.D0
          END DO
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      distpb = 0.0_8
      temp132 = r(0)**3
      temp130 = distp(0, 1)/temp132
      temp132b = -(temp130*fun3b)
      temp131 = 2.d0*rp1 - 2.d0*rp2*dd1 + 1.d0
      temp131b = c1*temp132b
      temp130b = -((c1*temp131+3.d0*rp0+rp1*rp2-6.d0*rp2)*fun3b/temp132)
      temp130b0 = r(0)*distp(0, 1)*fun0b
      temp129 = distp(0, 1)/r(0)
      temp129b0 = temp129*funb
      c1b = temp130b0 + (1.d0-rp1)*temp129b0 + temp131*temp132b
      rp2b = temp129b0 + (rp1-6.d0)*temp132b - 2.d0*dd1*temp131b
      rp1b = rp0*rp2b - c1*temp129b0 + rp2*temp132b + 2.d0*temp131b
      dd1b = 2*rp0*rp1b - 2.d0*rp2*temp131b
      rp0b = rp1*rp2b - temp130b0 + 2*dd1*rp1b - 3.d0*temp129b0 + 3.d0*&
&        temp132b
      temp129b1 = (c1*(1.d0-rp1)+rp2-3.d0*rp0)*funb/r(0)
      distpb(0, 1) = (c1-rp0)*r(0)*fun0b + temp129b1 + temp130b
      rb(0) = rb(0) + (c1-rp0)*distp(0, 1)*fun0b + 2*r(0)*rp0b - temp129&
&        *temp129b1 - temp130*3*r(0)**2*temp130b
    ELSE
      distpb = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          temp126 = c1 - r(i)**2
          temp129b = temp126*rmucos(ic, i)*zb(indorbp, i)
          temp128 = r(i)*cosphase(i)
          temp127 = rmu(ic, i)*distp(i, 1)
          temp127b = temp127*temp128*zb(indorbp, i)
          temp126b = rmucos(ic, i)*temp127b
          rmub(ic, i) = rmub(ic, i) + temp128*distp(i, 1)*temp129b
          distpb(i, 1) = distpb(i, 1) + temp128*rmu(ic, i)*temp129b
          rb(i) = rb(i) + temp127*cosphase(i)*temp129b - 2*r(i)*temp126b
          cosphaseb(i) = cosphaseb(i) + temp127*r(i)*temp129b
          c1b = c1b + temp126b
          rmucosb(ic, i) = rmucosb(ic, i) + temp126*temp127b
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp125 = r(k)**2
      temp125b2 = c*DEXP(-(dd1*temp125))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp125))*distpb(k, 1)
      dd1b = dd1b - temp125*temp125b2
      rb(k) = rb(k) - dd1*2*r(k)*temp125b2
      distpb(k, 1) = 0.0_8
    END DO
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) dd1b = dd1b - 1.75d0*c1b/dd1**2
    dd1b = dd1b + 1.2749263037197753d0*1.75d0*dd1**0.75D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (44)
! derivative of 36 with respect zeta
! R(r)=x*exp(-z*r**2)*(5/4/z-r**2)
    dd1 = dd(indpar+1)
!       if(iflagnorm.gt.2) then
!         if(dd1.gt.0) then
!         c=dsqrt(2.d0)*pi**(-0.75d0)*(2.d0*dd1)**1.25d0
    c = dd1**1.25d0*1.42541094070998d0
!         else
!         c=dsqrt(2.d0)*pi*(-0.75d0)
!         endif
!        endif
    IF (dd1 .GT. 0) THEN
      c1 = 1.25d0/dd1
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      c1 = 0.d0
    END IF
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    indorbp = indorb
!
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      fun = 2.d0*distp(0, 1)*(dd1*r(0)**2-1.d0-c1*dd1)
      fun0 = distp(0, 1)*(c1-r(0)**2)
      fun3 = 4.d0*dd1*distp(0, 1)*(2.d0-r(0)**2*dd1+c1*dd1)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
! 3)
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(1.d0-2.d0*rmusin(:, 0)**2))*cosphase(0)
          hess(ic) = hess(ic) + (fun*(1.d0-2.d0*rmusin(ic, 0)**2)*rmu(ic&
&            , 0)*rmucos(ic, 0)+fun*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic, &
&            0)*rmucos(ic, 0)-fun0*4.d0*rmusin(ic, 0)*rmucos(ic, 0)*pi/&
&            cellscale(ic))*cosphase(0)
!from 1)
          hess(:) = hess(:) - rmu(:, 0)*rmucos(:, 0)*rphase(:)*fun*&
&            sinphase(:, 0)*rmucos(ic, 0)*rmu(ic, 0)
! from 2)
! from 1)
          hess(:) = hess(:) + rphase(:)*(-(fun*rmu(:, 0)*rmucos(:, 0)*&
&            sinphase(:, 0))-fun0*cosphase(0)*rphase(:))*rmucos(ic, 0)*&
&            rmu(ic, 0)
! from 3) and 1)
          hess(ic) = hess(ic) - 2.d0*fun0*(2.d0*rmucos(ic, 0)**2-1.d0)*&
&            rphase(ic)*sinphase(ic, 0)
!                z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp174b = -(2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic))
          temp174b0 = sinphase(ic, 0)*temp174b
          rmucosb(ic, 0) = rmucosb(ic, 0) - 2.d0**2*fun0*rphase(ic)*&
&            sinphase(ic, 0)*2*rmucos(ic, 0)*hessb(ic)
          temp171 = rphase(:)*rmucos(ic, 0)
          temp174b1 = temp171*rmu(ic, 0)*hessb(:)
          temp169b = cosphase(0)*hessb(ic)
          temp162 = rmusin(ic, 0)*rmucos(ic, 0)
          temp162b = -(pi*4.d0*temp169b)
          temp161b = temp162*temp162b/cellscale(ic)
          temp157b0 = (2.d0*rmucos(ic, 0)**2-1.d0)*zb(indorbp, indt+ic)
          fun0b = fun0b + SUM(-(cosphase(0)*rphase(:)*temp174b1)) + &
&            cosphase(0)*temp157b0 + temp161b + rphase(ic)*temp174b0
          rphaseb(ic) = rphaseb(ic) + fun0*temp174b0
          sinphaseb(ic, 0) = sinphaseb(ic, 0) + fun0*rphase(ic)*temp174b
          temp173 = rmucos(:, 0)*sinphase(:, 0)
          temp172 = fun*rmu(:, 0)
          temp172b = (-(temp172*temp173)-fun0*cosphase(0)*rphase(:))*&
&            hessb(:)
          temp171b = rmu(ic, 0)*temp172b
          temp170 = sinphase(:, 0)*rmucos(ic, 0)
          temp169 = rmu(:, 0)*rmucos(:, 0)
          temp169b0 = -(temp169*temp170*hessb(:))
          temp169b1 = rmu(ic, 0)*temp169b0
          temp167 = -(2.d0*rmusin(ic, 0)**2) + 1.d0
          temp166b = temp167*rmucos(ic, 0)*temp169b
          temp164 = 2.d0*rmucos(ic, 0)**2 - 1.d0
          temp163b = temp164*rmucos(ic, 0)*temp169b
          temp160 = -(2.d0*rmusin(:, 0)**2) + 1.d0
          temp157 = rmu(ic, 0)*cosphase(0)
          temp157b1 = temp157*rmucos(ic, 0)*hessb(:)
          funb = funb + SUM(rphase(:)*temp169b1) + SUM(temp160*temp157b1&
&            ) + rmu(ic, 0)*temp163b + rmu(ic, 0)*temp166b + SUM(-(rmu(:&
&            , 0)*temp173*temp174b1))
          rmub(:, 0) = rmub(:, 0) - fun*temp173*temp174b1
          rmucosb(:, 0) = rmucosb(:, 0) - sinphase(:, 0)*temp172*&
&            temp174b1
          temp169b2 = -(rphase(:)*fun*rmu(ic, 0)*hessb(:))
          sinphaseb(:, 0) = sinphaseb(:, 0) + rmucos(ic, 0)*temp169*&
&            temp169b2 - rmucos(:, 0)*temp172*temp174b1
          temp166 = fun*rmu(ic, 0)
          temp168 = temp166*rmucos(ic, 0)
          temp163 = fun*rmu(ic, 0)
          temp165 = temp163*rmucos(ic, 0)
          temp161 = fun0/cellscale(ic)
          temp159 = rmucos(:, 0)**2
          temp158 = rmu(:, 0)**2
          temp158b = (fun3*temp158*temp159+fun*temp160)*hessb(:)
          temp157b2 = rmucos(ic, 0)*temp158b
          cosphaseb(0) = cosphaseb(0) + (temp167*temp168+temp164*temp165&
&            -pi*4.d0*(temp162*temp161))*hessb(ic) + fun0*temp157b0 + rmu&
&            (ic, 0)*SUM(temp157b2) + SUM(-(fun0*rphase(:)*temp174b1))
          rphaseb(:) = rphaseb(:) + fun*temp169b1 + rmucos(ic, 0)*SUM(&
&            temp171b) - fun0*cosphase(0)*temp174b1
          rmucosb(ic, 0) = rmucosb(ic, 0) + SUM(rphase(:)*temp171b)
          rmub(ic, 0) = rmub(ic, 0) + SUM(rphase(:)*fun*temp169b0) + SUM&
&            (temp171*temp172b)
          rmub(:, 0) = rmub(:, 0) + rmucos(:, 0)*temp170*temp169b2
          rmucosb(:, 0) = rmucosb(:, 0) + rmu(:, 0)*temp170*temp169b2
          rmucosb(ic, 0) = rmucosb(ic, 0) + (temp164*temp163+temp165*&
&            2.d0*2*rmucos(ic, 0)+temp167*temp166)*temp169b + temp161*&
&            rmusin(ic, 0)*temp162b + SUM(temp157*temp158b) + SUM(&
&            sinphase(:, 0)*temp169*temp169b2)
          rmusinb(ic, 0) = rmusinb(ic, 0) + temp161*rmucos(ic, 0)*&
&            temp162b - temp168*2.d0*2*rmusin(ic, 0)*temp169b
          rmub(ic, 0) = rmub(ic, 0) + cosphase(0)*SUM(temp157b2) + fun*&
&            temp163b + fun*temp166b
          cellscaleb(ic) = cellscaleb(ic) - temp161*temp161b
          fun3b = fun3b + SUM(temp158*temp159*temp157b1)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp159*temp157b1
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp158*&
&            temp157b1
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&            temp157b1
          rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*cosphase(0)*2.d0*2*&
&            rmucos(ic, 0)*zb(indorbp, indt+ic)
          DO i=3,1,-1
            temp157b = rmu(ic, 0)*rmucos(ic, 0)*zb(indorbp, indt+i)
            temp156 = fun*cosphase(0)
            temp155 = rmu(i, 0)*rmucos(i, 0)
            temp155b3 = temp155*temp156*zb(indorbp, indt+i)
            temp155b4 = -(sinphase(i, 0)*rmu(ic, 0)*zb(indorbp, indt+i))
            temp155b5 = rmucos(ic, 0)*temp155b4
            temp155b6 = -(fun0*rphase(i)*rmucos(ic, 0)*zb(indorbp, indt+&
&              i))
            rmub(i, 0) = rmub(i, 0) + temp156*rmucos(i, 0)*temp157b
            rmucosb(i, 0) = rmucosb(i, 0) + temp156*rmu(i, 0)*temp157b
            funb = funb + temp155*cosphase(0)*temp157b
            cosphaseb(0) = cosphaseb(0) + temp155*fun*temp157b
            rmub(ic, 0) = rmub(ic, 0) + sinphase(i, 0)*temp155b6 + &
&              rmucos(ic, 0)*temp155b3
            rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*rphase(i)*temp155b4 +&
&              rmu(ic, 0)*temp155b3
            fun0b = fun0b + rphase(i)*temp155b5
            rphaseb(i) = rphaseb(i) + fun0*temp155b5
            sinphaseb(i, 0) = sinphaseb(i, 0) + rmu(ic, 0)*temp155b6
            zb(indorbp, indt+i) = 0.D0
          END DO
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      distpb = 0.0_8
      temp155b0 = 4.d0*(c1*dd1-r(0)**2*dd1+2.d0)*fun3b
      temp155b1 = 4.d0*dd1*distp(0, 1)*fun3b
      temp155b2 = 2.d0*distp(0, 1)*funb
      dd1b = (r(0)**2-c1)*temp155b2 + (c1-r(0)**2)*temp155b1 + distp(0, &
&        1)*temp155b0
      distpb(0, 1) = (c1-r(0)**2)*fun0b + 2.d0*(dd1*r(0)**2-c1*dd1-1.d0)&
&        *funb + dd1*temp155b0
      c1b = distp(0, 1)*fun0b - dd1*temp155b2 + dd1*temp155b1
      rb(0) = rb(0) + dd1*2*r(0)*temp155b2 - distp(0, 1)*2*r(0)*fun0b - &
&        dd1*2*r(0)*temp155b1
    ELSE
      distpb = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          temp155b = rmu(ic, i)*rmucos(ic, i)*zb(indorbp, i)
          temp154 = c1 - r(i)**2
          temp153 = distp(i, 1)*cosphase(i)
          temp153b = temp153*temp154*zb(indorbp, i)
          distpb(i, 1) = distpb(i, 1) + temp154*cosphase(i)*temp155b
          cosphaseb(i) = cosphaseb(i) + temp154*distp(i, 1)*temp155b
          c1b = c1b + temp153*temp155b
          rb(i) = rb(i) - temp153*2*r(i)*temp155b
          rmub(ic, i) = rmub(ic, i) + rmucos(ic, i)*temp153b
          rmucosb(ic, i) = rmucosb(ic, i) + rmu(ic, i)*temp153b
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp152 = r(k)**2
      temp152b2 = c*DEXP(-(dd1*temp152))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp152))*distpb(k, 1)
      dd1b = dd1b - temp152*temp152b2
      rb(k) = rb(k) - dd1*2*r(k)*temp152b2
      distpb(k, 1) = 0.0_8
    END DO
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) dd1b = dd1b - 1.25d0*c1b/dd1**2
    dd1b = dd1b + 1.42541094070998d0*1.25d0*dd1**0.25D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (19)
! derivative of 16 with respect to z
! R(r)=c*exp(-z*r**2)*(3/4/z-r**2)
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!             c=2*dd1*INV_PI
!             if(c.gt.0) then
!             c=c**0.75d0
!             else
!             c=1.d0
!             endif
      c = 0.71270547035499016d0*dd1**0.75d0
!           endif
!           if(dd1.gt.0.d0) then
      c1 = 0.75d0/dd1
!           else
!           c1=0.d0
!           endif
      DO k=0,0
        distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
      END DO
      IF (typec .NE. 1) THEN
        fun0 = distp(0, 1)*(c1-r(0)**2)
        fun = 2.d0*distp(0, 1)*(dd1*r(0)**2-c1*dd1-1.d0)
        fun3 = -(4.d0*dd1*distp(0, 1)*(dd1*r(0)**2-c1*dd1-2.d0))
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = (fun3*rmu(:, 0)**2*rmucos(:, 0)**2+fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2))*cosphase(0)
        hess(:) = hess(:) - 2.d0*fun*rmu(:, 0)*rmucos(:, 0)*sinphase(:, &
&          0)*rphase(:) - cosphase(0)*fun0*rphase(:)**2
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp178b = -(sinphase(:, 0)*fun*rphase(:)*2.d0*hessb(:))
        temp178b0 = -(rmu(:, 0)*rmucos(:, 0)*2.d0*hessb(:))
        temp178b1 = -(rphase(:)**2*hessb(:))
        temp178b2 = cosphase(0)*hessb(:)
        temp177 = rmucos(:, 0)**2
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp177*temp178b2 + &
&          rmucos(:, 0)*temp178b
        temp176 = rmu(:, 0)**2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp176*&
&          temp178b2 + rmu(:, 0)*temp178b
        sinphaseb(:, 0) = sinphaseb(:, 0) + fun*rphase(:)*temp178b0
        temp175 = -(2.d0*rmusin(:, 0)**2) + 1.d0
        funb = SUM(temp175*temp178b2) + SUM(rphase(:)*sinphase(:, 0)*&
&          temp178b0)
        rphaseb(:) = rphaseb(:) + fun*sinphase(:, 0)*temp178b0 - 2*&
&          rphase(:)*cosphase(0)*fun0*hessb(:)
        cosphaseb(0) = cosphaseb(0) + SUM((fun3*temp176*temp177+fun*&
&          temp175)*hessb(:)) + fun0*SUM(temp178b1)
        fun0b = cosphase(0)*SUM(temp178b1)
        fun3b = SUM(temp176*temp177*temp178b2)
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&          temp178b2
        DO i=3,1,-1
          temp175b4 = fun*cosphase(0)*zb(indorbp, indt+i)
          temp175b5 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
          temp175b6 = -(sinphase(i, 0)*zb(indorbp, indt+i))
          rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp175b4
          rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp175b4
          funb = funb + cosphase(0)*temp175b5
          cosphaseb(0) = cosphaseb(0) + fun*temp175b5
          sinphaseb(i, 0) = sinphaseb(i, 0) - fun0*rphase(i)*zb(indorbp&
&            , indt+i)
          fun0b = fun0b + rphase(i)*temp175b6
          rphaseb(i) = rphaseb(i) + fun0*temp175b6
          zb(indorbp, indt+i) = 0.D0
        END DO
        distpb = 0.0_8
        temp175b1 = -(4.d0*(dd1*r(0)**2-c1*dd1-2.d0)*fun3b)
        temp175b2 = -(4.d0*dd1*distp(0, 1)*fun3b)
        temp175b3 = 2.d0*distp(0, 1)*funb
        dd1b = (r(0)**2-c1)*temp175b3 + (r(0)**2-c1)*temp175b2 + distp(0&
&          , 1)*temp175b1
        distpb(0, 1) = 2.d0*(dd1*r(0)**2-c1*dd1-1.d0)*funb + (c1-r(0)**2&
&          )*fun0b + dd1*temp175b1
        rb(0) = rb(0) + dd1*2*r(0)*temp175b3 - distp(0, 1)*2*r(0)*fun0b &
&          + dd1*2*r(0)*temp175b2
        c1b = distp(0, 1)*fun0b - dd1*temp175b3 - dd1*temp175b2
      ELSE
        distpb = 0.0_8
        c1b = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=0,0,-1
        temp175b = (c1-r(i)**2)*zb(indorbp, i)
        temp175b0 = distp(i, 1)*cosphase(i)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + cosphase(i)*temp175b
        cosphaseb(i) = cosphaseb(i) + distp(i, 1)*temp175b
        c1b = c1b + temp175b0
        rb(i) = rb(i) - 2*r(i)*temp175b0
        zb(indorbp, i) = 0.D0
      END DO
      cb = 0.0_8
      DO k=0,0,-1
        temp174 = r(k)**2
        temp174b2 = c*DEXP(-(dd1*temp174))*distpb(k, 1)
        cb = cb + DEXP(-(dd1*temp174))*distpb(k, 1)
        dd1b = dd1b - temp174*temp174b2
        rb(k) = rb(k) - dd1*2*r(k)*temp174b2
        distpb(k, 1) = 0.0_8
      END DO
      dd1b = dd1b + 0.71270547035499016d0*0.75d0*dd1**(-0.25D0)*cb - &
&        0.75d0*c1b/dd1**2
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (34)
! 2s single  Z WITH CUSP zero periodic
! normalized
! exp(-dd1*r) + dd1*r*exp(-dd1*r)
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!            if(dd1.gt.0) then
!           c=1.d0/dsqrt(1.d0/4.d0/dd1**3+12.d0*dd1/(2.d0*dd1)**4+      &
!    &3.d0*dd1**2/4.d0/dd1**5)/dsqrt(4.d0*pi)
!            else
!            c1=1.d0
!            endif
      c = dd1*DSQRT(dd1)*.2132436186229231d0
!           endif
      DO k=0,0
        distp(k, 1) = c*DEXP(-(dd1*r(k)))
      END DO
      IF (typec .NE. 1) THEN
        fun0 = distp(0, 1)*(1.d0+r(0)*dd1)
        fun = -(dd1**2*distp(0, 1))
        fun3 = dd1**3*distp(0, 1)/r(0)
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = (fun3*rmu(:, 0)**2*rmucos(:, 0)**2+fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2))*cosphase(0)
        hess(:) = hess(:) - 2.d0*fun*rmu(:, 0)*rmucos(:, 0)*sinphase(:, &
&          0)*rphase(:) - cosphase(0)*fun0*rphase(:)**2
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp183b = -(sinphase(:, 0)*fun*rphase(:)*2.d0*hessb(:))
        temp183b0 = -(rmu(:, 0)*rmucos(:, 0)*2.d0*hessb(:))
        temp183b1 = -(rphase(:)**2*hessb(:))
        temp183b2 = cosphase(0)*hessb(:)
        temp182 = rmucos(:, 0)**2
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp182*temp183b2 + &
&          rmucos(:, 0)*temp183b
        temp181 = rmu(:, 0)**2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp181*&
&          temp183b2 + rmu(:, 0)*temp183b
        sinphaseb(:, 0) = sinphaseb(:, 0) + fun*rphase(:)*temp183b0
        temp180 = -(2.d0*rmusin(:, 0)**2) + 1.d0
        funb = SUM(temp180*temp183b2) + SUM(rphase(:)*sinphase(:, 0)*&
&          temp183b0)
        rphaseb(:) = rphaseb(:) + fun*sinphase(:, 0)*temp183b0 - 2*&
&          rphase(:)*cosphase(0)*fun0*hessb(:)
        cosphaseb(0) = cosphaseb(0) + SUM((fun3*temp181*temp182+fun*&
&          temp180)*hessb(:)) + fun0*SUM(temp183b1)
        fun0b = cosphase(0)*SUM(temp183b1)
        fun3b = SUM(temp181*temp182*temp183b2)
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&          temp183b2
        DO i=3,1,-1
          temp180b = fun*cosphase(0)*zb(indorbp, indt+i)
          temp180b0 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
          temp180b1 = -(sinphase(i, 0)*zb(indorbp, indt+i))
          rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp180b
          rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp180b
          funb = funb + cosphase(0)*temp180b0
          cosphaseb(0) = cosphaseb(0) + fun*temp180b0
          sinphaseb(i, 0) = sinphaseb(i, 0) - fun0*rphase(i)*zb(indorbp&
&            , indt+i)
          fun0b = fun0b + rphase(i)*temp180b1
          rphaseb(i) = rphaseb(i) + fun0*temp180b1
          zb(indorbp, indt+i) = 0.D0
        END DO
        distpb = 0.0_8
        temp179 = distp(0, 1)/r(0)
        temp179b2 = dd1**3*fun3b/r(0)
        dd1b = distp(0, 1)*r(0)*fun0b - distp(0, 1)*2*dd1*funb + temp179&
&          *3*dd1**2*fun3b
        distpb(0, 1) = (r(0)*dd1+1.d0)*fun0b - dd1**2*funb + temp179b2
        rb(0) = rb(0) + distp(0, 1)*dd1*fun0b - temp179*temp179b2
      ELSE
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=0,0,-1
        temp179b0 = (r(i)*dd1+1.d0)*zb(indorbp, i)
        temp179b1 = distp(i, 1)*cosphase(i)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + cosphase(i)*temp179b0
        cosphaseb(i) = cosphaseb(i) + distp(i, 1)*temp179b0
        rb(i) = rb(i) + dd1*temp179b1
        dd1b = dd1b + r(i)*temp179b1
        zb(indorbp, i) = 0.D0
      END DO
      cb = 0.0_8
      DO k=0,0,-1
        temp179b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
        cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
        dd1b = dd1b - r(k)*temp179b
        rb(k) = rb(k) - dd1*temp179b
        distpb(k, 1) = 0.0_8
      END DO
      temp178 = DSQRT(dd1)
      IF (dd1 .EQ. 0.0) THEN
        dd1b = dd1b + .2132436186229231d0*temp178*cb
      ELSE
        dd1b = dd1b + (.2132436186229231d0*dd1/(2.D0*DSQRT(dd1))+&
&          .2132436186229231d0*temp178)*cb
      END IF
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (38)
! 3s -derivative of 34 with respect to dd1
! R(r)=r**2*exp(-z1*r)
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!           if(dd1.gt.0.d0) then
!           c=1.d0/dsqrt(1.d0/4.d0/dd1**3+12.d0*dd1/(2.d0*dd1)**4+      &
!    &3.d0*dd1**2/4.d0/dd1**5)/dsqrt(4.d0*pi)
!           else
      c = dd1*DSQRT(dd1)*.2132436186229231d0
!           c=1.d0
!           endif
!           endif
      c0 = -(c*dd1)
!           if(dd1.gt.0) then
      c1 = 1.5d0*c/dd1
!           else
!           c1=0.d0
!           endif
      DO k=0,0
        distp(k, 1) = DEXP(-(dd1*r(k)))
      END DO
      CALL PUSHREAL8(adr8ibuf,adr8buf,c1)
      c1 = c1*dd1**2
      IF (typec .NE. 1) THEN
        fun0 = (c0*r(0)**2+c1/dd1**2*(1.d0+dd1*r(0)))*distp(0, 1)
        fun = (c0*(2.d0-dd1*r(0))-c1)*distp(0, 1)
        fun3 = -(dd1*(fun+c0*distp(0, 1))/r(0))
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = (fun3*rmu(:, 0)**2*rmucos(:, 0)**2+fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2))*cosphase(0)
        hess(:) = hess(:) - 2.d0*fun*rmu(:, 0)*rmucos(:, 0)*sinphase(:, &
&          0)*rphase(:) - cosphase(0)*fun0*rphase(:)**2
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp191b = -(sinphase(:, 0)*fun*rphase(:)*2.d0*hessb(:))
        temp191b0 = -(rmu(:, 0)*rmucos(:, 0)*2.d0*hessb(:))
        temp191b1 = -(rphase(:)**2*hessb(:))
        temp191b2 = cosphase(0)*hessb(:)
        temp190 = rmucos(:, 0)**2
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp190*temp191b2 + &
&          rmucos(:, 0)*temp191b
        temp189 = rmu(:, 0)**2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp189*&
&          temp191b2 + rmu(:, 0)*temp191b
        sinphaseb(:, 0) = sinphaseb(:, 0) + fun*rphase(:)*temp191b0
        temp188 = -(2.d0*rmusin(:, 0)**2) + 1.d0
        funb = SUM(temp188*temp191b2) + SUM(rphase(:)*sinphase(:, 0)*&
&          temp191b0)
        rphaseb(:) = rphaseb(:) + fun*sinphase(:, 0)*temp191b0 - 2*&
&          rphase(:)*cosphase(0)*fun0*hessb(:)
        cosphaseb(0) = cosphaseb(0) + SUM((fun3*temp189*temp190+fun*&
&          temp188)*hessb(:)) + fun0*SUM(temp191b1)
        fun0b = cosphase(0)*SUM(temp191b1)
        fun3b = SUM(temp189*temp190*temp191b2)
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&          temp191b2
        DO i=3,1,-1
          temp188b0 = fun*cosphase(0)*zb(indorbp, indt+i)
          temp188b1 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
          temp188b2 = -(sinphase(i, 0)*zb(indorbp, indt+i))
          rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp188b0
          rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp188b0
          funb = funb + cosphase(0)*temp188b1
          cosphaseb(0) = cosphaseb(0) + fun*temp188b1
          sinphaseb(i, 0) = sinphaseb(i, 0) - fun0*rphase(i)*zb(indorbp&
&            , indt+i)
          fun0b = fun0b + rphase(i)*temp188b2
          rphaseb(i) = rphaseb(i) + fun0*temp188b2
          zb(indorbp, indt+i) = 0.D0
        END DO
        distpb = 0.0_8
        temp187 = dd1/r(0)
        temp188b = -(temp187*fun3b)
        temp187b = -((fun+c0*distp(0, 1))*fun3b/r(0))
        funb = funb + temp188b
        temp187b0 = distp(0, 1)*funb
        temp187b1 = distp(0, 1)*fun0b
        c0b = (2.d0-dd1*r(0))*temp187b0 + r(0)**2*temp187b1 + distp(0, 1&
&          )*temp188b
        temp186 = dd1**2
        temp185 = c1/temp186
        distpb(0, 1) = (c0*(2.d0-dd1*r(0))-c1)*funb + (c0*r(0)**2+(dd1*r&
&          (0)+1.d0)*temp185)*fun0b + c0*temp188b
        temp185b0 = (dd1*r(0)+1.d0)*temp187b1/temp186
        dd1b = temp185*r(0)*temp187b1 - temp185*2*dd1*temp185b0 - c0*r(0&
&          )*temp187b0 + temp187b
        rb(0) = rb(0) + (temp185*dd1+c0*2*r(0))*temp187b1 - c0*dd1*&
&          temp187b0 - temp187*temp187b
        c1b = temp185b0 - temp187b0
      ELSE
        distpb = 0.0_8
        c0b = 0.0_8
        c1b = 0.0_8
        dd1b = 0.0_8
      END IF
      CALL POPREAL8(adr8ibuf,adr8buf,c1)
      dd1b = dd1b + c1*2*dd1*c1b
      c1b = dd1**2*c1b
      DO i=0,0,-1
        temp185b = distp(i, 1)*cosphase(i)*zb(indorbp, i)
        temp184 = dd1*r(i) + 1.d0
        temp184b1 = (c0*r(i)**2+c1*temp184)*zb(indorbp, i)
        c0b = c0b + r(i)**2*temp185b
        rb(i) = rb(i) + (c1*dd1+c0*2*r(i))*temp185b
        c1b = c1b + temp184*temp185b
        dd1b = dd1b + c1*r(i)*temp185b
        distpb(i, 1) = distpb(i, 1) + cosphase(i)*temp184b1
        cosphaseb(i) = cosphaseb(i) + distp(i, 1)*temp184b1
        zb(indorbp, i) = 0.D0
      END DO
      DO k=0,0,-1
        temp184b0 = DEXP(-(dd1*r(k)))*distpb(k, 1)
        dd1b = dd1b - r(k)*temp184b0
        rb(k) = rb(k) - dd1*temp184b0
        distpb(k, 1) = 0.0_8
      END DO
      temp184b = 1.5d0*c1b/dd1
      cb = temp184b - dd1*c0b
      temp183 = DSQRT(dd1)
      IF (dd1 .EQ. 0.0) THEN
        dd1b = dd1b + .2132436186229231d0*temp183*cb - c*c0b - c*&
&          temp184b/dd1
      ELSE
        dd1b = dd1b + (.2132436186229231d0*dd1/(2.D0*DSQRT(dd1))+&
&          .2132436186229231d0*temp183)*cb - c*c0b - c*temp184b/dd1
      END IF
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (12)
! 2s single  Z WITH CUSP zero periodic
! normalized
! r**3*exp(-dd1*r)
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!           if(dd1.gt.0) then
!           c=dsqrt((2*dd1)**9/40320.d0/pi)/2.d0
      c = dd1**4.5d0*.03178848180059307346d0
!           else
!           c=1.d0
!           endif
!           endif
      DO k=0,0
        distp(k, 1) = c*DEXP(-(dd1*r(k)))
      END DO
      IF (typec .NE. 1) THEN
        fun0 = distp(0, 1)*r(0)**3
        rp1 = dd1*r(0)
        fun = -(distp(0, 1)*r(0)*(rp1-3.d0))
        fun3 = distp(0, 1)*(3.d0-5.d0*rp1+rp1**2)/r(0)
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = (fun3*rmu(:, 0)**2*rmucos(:, 0)**2+fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2))*cosphase(0)
        hess(:) = hess(:) - 2.d0*fun*rmu(:, 0)*rmucos(:, 0)*sinphase(:, &
&          0)*rphase(:) - cosphase(0)*fun0*rphase(:)**2
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp195b = -(sinphase(:, 0)*fun*rphase(:)*2.d0*hessb(:))
        temp195b0 = -(rmu(:, 0)*rmucos(:, 0)*2.d0*hessb(:))
        temp195b1 = -(rphase(:)**2*hessb(:))
        temp195b2 = cosphase(0)*hessb(:)
        temp194 = rmucos(:, 0)**2
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp194*temp195b2 + &
&          rmucos(:, 0)*temp195b
        temp193 = rmu(:, 0)**2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp193*&
&          temp195b2 + rmu(:, 0)*temp195b
        sinphaseb(:, 0) = sinphaseb(:, 0) + fun*rphase(:)*temp195b0
        temp192 = -(2.d0*rmusin(:, 0)**2) + 1.d0
        funb = SUM(temp192*temp195b2) + SUM(rphase(:)*sinphase(:, 0)*&
&          temp195b0)
        rphaseb(:) = rphaseb(:) + fun*sinphase(:, 0)*temp195b0 - 2*&
&          rphase(:)*cosphase(0)*fun0*hessb(:)
        cosphaseb(0) = cosphaseb(0) + SUM((fun3*temp193*temp194+fun*&
&          temp192)*hessb(:)) + fun0*SUM(temp195b1)
        fun0b = cosphase(0)*SUM(temp195b1)
        fun3b = SUM(temp193*temp194*temp195b2)
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&          temp195b2
        DO i=3,1,-1
          temp192b = fun*cosphase(0)*zb(indorbp, indt+i)
          temp192b0 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
          temp192b1 = -(sinphase(i, 0)*zb(indorbp, indt+i))
          rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp192b
          rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp192b
          funb = funb + cosphase(0)*temp192b0
          cosphaseb(0) = cosphaseb(0) + fun*temp192b0
          sinphaseb(i, 0) = sinphaseb(i, 0) - fun0*rphase(i)*zb(indorbp&
&            , indt+i)
          fun0b = fun0b + rphase(i)*temp192b1
          rphaseb(i) = rphaseb(i) + fun0*temp192b1
          zb(indorbp, indt+i) = 0.D0
        END DO
        distpb = 0.0_8
        temp191b5 = (rp1**2-5.d0*rp1+3.d0)*fun3b/r(0)
        temp191 = distp(0, 1)/r(0)
        distpb(0, 1) = r(0)**3*fun0b - r(0)*(rp1-3.d0)*funb + temp191b5
        rp1b = (temp191*2*rp1-temp191*5.d0)*fun3b - distp(0, 1)*r(0)*&
&          funb
        rb(0) = rb(0) + distp(0, 1)*3*r(0)**2*fun0b - distp(0, 1)*(rp1-&
&          3.d0)*funb + dd1*rp1b - temp191*temp191b5
        dd1b = r(0)*rp1b
      ELSE
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=0,0,-1
        temp191b4 = r(i)**3*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + cosphase(i)*temp191b4
        cosphaseb(i) = cosphaseb(i) + distp(i, 1)*temp191b4
        rb(i) = rb(i) + distp(i, 1)*cosphase(i)*3*r(i)**2*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
      cb = 0.0_8
      DO k=0,0,-1
        temp191b3 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
        cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
        dd1b = dd1b - r(k)*temp191b3
        rb(k) = rb(k) - dd1*temp191b3
        distpb(k, 1) = 0.0_8
      END DO
      dd1b = dd1b + .03178848180059307346d0*4.5d0*dd1**3.5D0*cb
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (50)
! derivative of 12 with respect to dd1
! c0 *r**4*exp(-dd1*r)+c1*r^3*exp(-dd1*r)
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!           if(dd1.gt.0.d0) then
!           c=dsqrt((2*dd1)**9/40320.d0/pi)/2.d0
      c = dd1**4.5d0*.03178848180059307346d0
!           else
!           c=1.d0
!           endif
!           endif
      c0 = -c
!           if(dd1.gt.0) then
      c1 = 4.5d0*c/dd1
!           else
!           c1=0.d0
!           endif
      DO k=0,0
        distp(k, 1) = DEXP(-(dd1*r(k)))
      END DO
      IF (typec .NE. 1) THEN
        rp1 = dd1*r(0)
        rp2 = rp1*rp1
        fun0 = (c0*r(0)**4+c1*r(0)**3)*distp(0, 1)
        fun = -(distp(0, 1)*r(0)*(c0*r(0)*(rp1-4.d0)+c1*(rp1-3.d0)))
        fun3 = distp(0, 1)*(c0*(8.d0-7.d0*rp1+rp2)+c1*(3.d0-5.d0*rp1+rp2&
&          )/r(0))
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = (fun3*rmu(:, 0)**2*rmucos(:, 0)**2+fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2))*cosphase(0)
        hess(:) = hess(:) - 2.d0*fun*rmu(:, 0)*rmucos(:, 0)*sinphase(:, &
&          0)*rphase(:) - cosphase(0)*fun0*rphase(:)**2
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp203b = -(sinphase(:, 0)*fun*rphase(:)*2.d0*hessb(:))
        temp203b0 = -(rmu(:, 0)*rmucos(:, 0)*2.d0*hessb(:))
        temp203b1 = -(rphase(:)**2*hessb(:))
        temp203b2 = cosphase(0)*hessb(:)
        temp202 = rmucos(:, 0)**2
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp202*temp203b2 + &
&          rmucos(:, 0)*temp203b
        temp201 = rmu(:, 0)**2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp201*&
&          temp203b2 + rmu(:, 0)*temp203b
        sinphaseb(:, 0) = sinphaseb(:, 0) + fun*rphase(:)*temp203b0
        temp200 = -(2.d0*rmusin(:, 0)**2) + 1.d0
        funb = SUM(temp200*temp203b2) + SUM(rphase(:)*sinphase(:, 0)*&
&          temp203b0)
        rphaseb(:) = rphaseb(:) + fun*sinphase(:, 0)*temp203b0 - 2*&
&          rphase(:)*cosphase(0)*fun0*hessb(:)
        cosphaseb(0) = cosphaseb(0) + SUM((fun3*temp201*temp202+fun*&
&          temp200)*hessb(:)) + fun0*SUM(temp203b1)
        fun0b = cosphase(0)*SUM(temp203b1)
        fun3b = SUM(temp201*temp202*temp203b2)
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&          temp203b2
        DO i=3,1,-1
          temp200b0 = fun*cosphase(0)*zb(indorbp, indt+i)
          temp200b1 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
          temp200b2 = -(sinphase(i, 0)*zb(indorbp, indt+i))
          rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp200b0
          rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp200b0
          funb = funb + cosphase(0)*temp200b1
          cosphaseb(0) = cosphaseb(0) + fun*temp200b1
          sinphaseb(i, 0) = sinphaseb(i, 0) - fun0*rphase(i)*zb(indorbp&
&            , indt+i)
          fun0b = fun0b + rphase(i)*temp200b2
          rphaseb(i) = rphaseb(i) + fun0*temp200b2
          zb(indorbp, indt+i) = 0.D0
        END DO
        distpb = 0.0_8
        temp199 = c1/r(0)
        temp200b = distp(0, 1)*fun3b
        temp199b = (rp2-5.d0*rp1+3.d0)*temp200b/r(0)
        temp199b0 = -((c0*r(0)*(rp1-4.d0)+c1*(rp1-3.d0))*funb)
        temp198 = r(0)**4
        temp197 = r(0)**3
        distpb(0, 1) = r(0)*temp199b0 + (c0*temp198+c1*temp197)*fun0b + &
&          (c0*(rp2-7.d0*rp1+8.d0)+(rp2-5.d0*rp1+3.d0)*temp199)*fun3b
        temp199b1 = -(distp(0, 1)*r(0)*funb)
        temp199b2 = distp(0, 1)*fun0b
        c0b = (rp1-4.d0)*r(0)*temp199b1 + temp198*temp199b2 + (rp2-7.d0*&
&          rp1+8.d0)*temp200b
        rp2b = (temp199+c0)*temp200b
        rp1b = (c1+c0*r(0))*temp199b1 + 2*rp1*rp2b + (-(temp199*5.d0)-c0&
&          *7.d0)*temp200b
        c1b = (rp1-3.d0)*temp199b1 + temp197*temp199b2 + temp199b
        rb(0) = rb(0) + distp(0, 1)*temp199b0 + (rp1-4.d0)*c0*temp199b1 &
&          + dd1*rp1b + (c1*3*r(0)**2+c0*4*r(0)**3)*temp199b2 - temp199*&
&          temp199b
        dd1b = r(0)*rp1b
      ELSE
        distpb = 0.0_8
        c0b = 0.0_8
        c1b = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=0,0,-1
        temp197b = distp(i, 1)*cosphase(i)*zb(indorbp, i)
        temp196 = r(i)**4
        temp195 = r(i)**3
        temp195b5 = (c0*temp196+c1*temp195)*zb(indorbp, i)
        c0b = c0b + temp196*temp197b
        rb(i) = rb(i) + (c1*3*r(i)**2+c0*4*r(i)**3)*temp197b
        c1b = c1b + temp195*temp197b
        distpb(i, 1) = distpb(i, 1) + cosphase(i)*temp195b5
        cosphaseb(i) = cosphaseb(i) + distp(i, 1)*temp195b5
        zb(indorbp, i) = 0.D0
      END DO
      DO k=0,0,-1
        temp195b4 = DEXP(-(dd1*r(k)))*distpb(k, 1)
        dd1b = dd1b - r(k)*temp195b4
        rb(k) = rb(k) - dd1*temp195b4
        distpb(k, 1) = 0.0_8
      END DO
      temp195b3 = 4.5d0*c1b/dd1
      cb = temp195b3 - c0b
      dd1b = dd1b + .03178848180059307346d0*4.5d0*dd1**3.5D0*cb - c*&
&        temp195b3/dd1
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (37)
! d orbitals
! R(r)= exp(-alpha r^2)
! each gaussian term is normalized
    indorbp = indorb
    indparp = indpar + 1
    IF (dd(indpar+1) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indpar+1) = dd(indpar+1)
    ELSE
      dd(indpar+1) = -dd(indpar+1)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization
!        c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)
    c = dd1**1.75d0*1.64592278064948967213d0
!        endif
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=0,0
      distp(i, 2) = (3.d0*(rmu(3, i)*rmucos(3, i))**2-r(i)**2)*cost1d
      distp(i, 3) = ((rmu(1, i)*rmucos(1, i))**2-(rmu(2, i)*rmucos(2, i)&
&        )**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*rmucos(1, i)*rmucos(2, i)*cost3d
! lz=+/-2
      distp(i, 5) = rmu(2, i)*rmu(3, i)*rmucos(2, i)*rmucos(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*rmucos(1, i)*rmucos(3, i)*cost3d
    END DO
! lz=+/-1
    DO ic=1,5
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = 4.d0*dd1**2*distp(0, 1)
      hess3d = 0.d0
      hess3d(:, 1) = -(2.d0*rmu(:, 0)*rmucos(:, 0)*cost1d)
      hess3d(3, 1) = hess3d(3, 1) + 6.d0*rmu(3, 0)*rmucos(3, 0)*(rmucos(&
&        3, 0)**2-rmusin(3, 0)**2)*cost1d
      hess3d(1, 2) = 2.d0*rmu(1, 0)*rmucos(1, 0)*(rmucos(1, 0)**2-rmusin&
&        (1, 0)**2)*cost2d
      hess3d(2, 2) = -(2.d0*rmu(2, 0)*rmucos(2, 0)*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)*cost2d)
! lz=+/-2
      hess3d(2, 3) = rmu(1, 0)*rmucos(1, 0)*cost3d*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)
! lz=+/-2
      hess3d(1, 3) = rmu(2, 0)*rmucos(2, 0)*cost3d*(rmucos(1, 0)**2-&
&        rmusin(1, 0)**2)
! lz=+/-1
      hess3d(2, 4) = rmu(3, 0)*rmucos(3, 0)*cost3d*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)
! lz=+/-1
      hess3d(3, 4) = rmu(2, 0)*rmucos(2, 0)*cost3d*(rmucos(3, 0)**2-&
&        rmusin(3, 0)**2)
! lz=+/-1
      hess3d(1, 5) = rmu(3, 0)*rmucos(3, 0)*cost3d*(rmucos(1, 0)**2-&
&        rmusin(1, 0)**2)
! lz=+/-1
      hess3d(3, 5) = rmu(1, 0)*rmucos(1, 0)*cost3d*(rmucos(3, 0)**2-&
&        rmusin(3, 0)**2)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,5
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          DO i=1,3
! 1)
! 2)
            hess(i) = ((fun2*(rmu(i, 0)*rmucos(i, 0))**2+fun*(rmucos(i, &
&              0)**2-rmusin(i, 0)**2))*distp(0, 1+ic)+hess3d(i, ic)*fun*&
&              rmu(i, 0)*rmucos(i, 0))*cosphase(0)
!enddo for i
! from 1
! from 2
! from 2
! from 2
            hess(i) = hess(i) - distp(0, 1+ic)*fun*rmu(i, 0)*rmucos(i, 0&
&              )*sinphase(i, 0)*rphase(i) - distp(0, 1+ic)*fun0*cosphase(&
&              0)*rphase(i)**2 - distp(0, 1+ic)*fun*sinphase(i, 0)*rphase&
&              (i)*rmu(i, 0)*rmucos(i, 0) - fun0*sinphase(i, 0)*rphase(i)&
&              *hess3d(i, ic)
          END DO
          IF (ic .EQ. 1) THEN
            DO i=1,3
! 3
! from  3
              hess(i) = hess(i) + 2.d0*rmu(i, 0)*rmucos(i, 0)*fun0*&
&                cost1d*sinphase(i, 0)*rphase(i)
              hess(i) = hess(i) + (-(2.d0*fun0*cost1d*(rmucos(i, 0)**2-&
&                rmusin(i, 0)**2))-2.d0*fun*rmu(i, 0)**2*rmucos(i, 0)**2*&
&                cost1d)*cosphase(0)
            END DO
! 4
! from 4
            hess(3) = hess(3) - 6.d0*rmu(3, 0)*rmucos(3, 0)*cost1d*fun0*&
&              (rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(3) = hess(3) + (6.d0*cost1d*fun0*(rmucos(3, 0)**2-&
&              rmusin(3, 0)**2)**2-6.d0*rmu(3, 0)*rmucos(3, 0)*cost1d*&
&              fun0*4.d0*pi/cellscale(3)*rmusin(3, 0)*rmucos(3, 0)+6.d0*&
&              rmu(3, 0)**2*rmucos(3, 0)**2*cost1d*fun*(rmucos(3, 0)**2-&
&              rmusin(3, 0)**2))*cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
          ELSE IF (ic .EQ. 2) THEN
            hess(1) = hess(1) - 2.d0*rmu(1, 0)*fun0*cost2d*rmucos(1, 0)*&
&              (rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(2) = hess(2) - (-(2.d0*rmu(2, 0)*fun0*cost2d*rmucos(2, &
&              0)*(rmucos(2, 0)**2-rmusin(2, 0)**2)))*sinphase(2, 0)*&
&              rphase(2)
            hess(1) = hess(1) + (2.d0*rmu(1, 0)**2*fun*cost2d*rmucos(1, &
&              0)**2*(rmucos(1, 0)**2-rmusin(1, 0)**2)+2.d0*fun0*cost2d*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*(rmucos(1, 0)**2-rmusin(1&
&              , 0)**2)-2.d0*rmu(1, 0)*fun0*cost2d*rmucos(1, 0)*4.d0*pi/&
&              cellscale(1)*rmusin(1, 0)*rmucos(1, 0))*cosphase(0)
            hess(2) = hess(2) + (-(2.d0*rmu(2, 0)**2*fun*cost2d*rmucos(2&
&              , 0)**2*(rmucos(2, 0)**2-rmusin(2, 0)**2))-2.d0*fun0*&
&              cost2d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*(rmucos(2, 0)**2-&
&              rmusin(2, 0)**2)+2.d0*rmu(2, 0)*fun0*cost2d*rmucos(2, 0)*&
&              4.d0*pi/cellscale(2)*rmusin(2, 0)*rmucos(2, 0))*cosphase(0&
&              )
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          ELSE IF (ic .EQ. 3) THEN
            hess(1) = hess(1) - rmu(2, 0)*fun0*cost3d*rmucos(2, 0)*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(2) = hess(2) - rmu(1, 0)*fun0*cost3d*rmucos(1, 0)*(&
&              rmucos(2, 0)**2-rmusin(2, 0)**2)*sinphase(2, 0)*rphase(2)
            hess(2) = hess(2) + (-(rmu(1, 0)*cost3d*rmucos(1, 0)*(4.d0*&
&              pi/cellscale(2)*fun0*rmusin(2, 0)*rmucos(2, 0)+fun*(rmusin&
&              (2, 0)**2-rmucos(2, 0)**2)*rmu(2, 0)*rmucos(2, 0))))*&
&              cosphase(0)
            hess(1) = hess(1) + (-(rmu(2, 0)*cost3d*rmucos(2, 0)*(4.d0*&
&              pi/cellscale(1)*fun0*rmusin(1, 0)*rmucos(1, 0)+fun*(rmusin&
&              (1, 0)**2-rmucos(1, 0)**2)*rmu(1, 0)*rmucos(1, 0))))*&
&              cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE IF (ic .EQ. 4) THEN
            hess(2) = hess(2) - rmu(3, 0)*fun0*cost3d*rmucos(3, 0)*(&
&              rmucos(2, 0)**2-rmusin(2, 0)**2)*sinphase(2, 0)*rphase(2)
            hess(3) = hess(3) - rmu(2, 0)*fun0*cost3d*rmucos(2, 0)*(&
&              rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(2) = hess(2) + (-(rmu(3, 0)*cost3d*rmucos(3, 0)*(4.d0*&
&              pi/cellscale(2)*fun0*rmusin(2, 0)*rmucos(2, 0)+fun*(rmusin&
&              (2, 0)**2-rmucos(2, 0)**2)*rmu(2, 0)*rmucos(2, 0))))*&
&              cosphase(0)
            hess(3) = hess(3) + (-(rmu(2, 0)*cost3d*rmucos(2, 0)*(4.d0*&
&              pi/cellscale(3)*fun0*rmusin(3, 0)*rmucos(3, 0)+fun*(rmusin&
&              (3, 0)**2-rmucos(3, 0)**2)*rmu(3, 0)*rmucos(3, 0))))*&
&              cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
          ELSE IF (ic .EQ. 5) THEN
            hess(1) = hess(1) - rmu(3, 0)*fun0*cost3d*rmucos(3, 0)*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(3) = hess(3) - rmu(1, 0)*fun0*cost3d*rmucos(1, 0)*(&
&              rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(1) = hess(1) + (-(rmu(3, 0)*cost3d*rmucos(3, 0)*(4.d0*&
&              pi/cellscale(1)*fun0*rmusin(1, 0)*rmucos(1, 0)+fun*(rmusin&
&              (1, 0)**2-rmucos(1, 0)**2)*rmu(1, 0)*rmucos(1, 0))))*&
&              cosphase(0)
            hess(3) = hess(3) + (-(rmu(1, 0)*cost3d*rmucos(1, 0)*(4.d0*&
&              pi/cellscale(3)*fun0*rmusin(3, 0)*rmucos(3, 0)+fun*(rmusin&
&              (3, 0)**2-rmucos(3, 0)**2)*rmu(3, 0)*rmucos(3, 0))))*&
&              cosphase(0)
!endif for ic
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
          END IF
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hessb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      hess3db = 0.0_8
      DO ic=5,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb(:) = hessb(:) + zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 3) THEN
            IF (branch .LT. 2) THEN
              IF (branch .LT. 1) THEN
                temp229b = cosphase(0)*hessb(3)
                temp228 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                temp229b0 = cost1d*6.d0*temp229b
                temp228b = fun0*2*temp228*temp229b0
                temp224 = fun0/cellscale(3)
                temp227 = rmucos(3, 0)**2*temp224
                temp226 = rmu(3, 0)*rmusin(3, 0)
                temp225 = 4.d0*cost1d*pi*6.d0
                temp225b = -(temp225*temp229b)
                temp224b = temp226*rmucos(3, 0)**2*temp225b/cellscale(3)
                temp223 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                temp222 = rmucos(3, 0)**2
                temp221 = rmu(3, 0)**2
                temp220 = temp221*fun*temp222
                temp221b = cost1d*6.d0*temp229b
                temp220b = temp223*temp221b
                temp219 = rmu(3, 0)*rmucos(3, 0)
                temp219b = -(cost1d*6.d0*hessb(3))
                temp219b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp219b
                temp218b = temp219*temp219b0
                temp216 = rmu(3, 0)*rmucos(3, 0)
                temp216b0 = cost1d*6.d0*zb(indorbp, indt+3)
                temp216b1 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp216b0
                fun0b = fun0b + sinphase(3, 0)*rphase(3)*temp218b + &
&                  temp216*cosphase(0)*temp216b1 + temp224b + temp228**2*&
&                  temp229b0
                temp218 = sinphase(3, 0)*fun0*rphase(3)
                temp219b1 = temp219*temp218*temp219b
                temp217 = fun0*cosphase(0)
                temp216b2 = temp216*temp217*temp216b0
                rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp219b1&
&                  + temp218*rmu(3, 0)*temp219b0 + 2*rmucos(3, 0)*&
&                  temp216b2 + temp217*rmu(3, 0)*temp216b1 + temp220*2*&
&                  rmucos(3, 0)*temp221b + temp221*fun*2*rmucos(3, 0)*&
&                  temp220b + temp226*temp224*2*rmucos(3, 0)*temp225b + 2&
&                  *rmucos(3, 0)*temp228b
                rmusinb(3, 0) = rmusinb(3, 0) + temp227*rmu(3, 0)*&
&                  temp225b - 2*rmusin(3, 0)*temp216b2 - temp220*2*rmusin&
&                  (3, 0)*temp221b - 2*rmusin(3, 0)*temp219b1 - 2*rmusin(&
&                  3, 0)*temp228b
                rmub(3, 0) = rmub(3, 0) + temp218*rmucos(3, 0)*temp219b0&
&                  + temp217*rmucos(3, 0)*temp216b1 + temp222*fun*2*rmu(3&
&                  , 0)*temp220b + temp227*rmusin(3, 0)*temp225b
                cellscaleb(3) = cellscaleb(3) - temp224*temp224b
                funb = funb + temp222*temp221*temp220b
                cosphaseb(0) = cosphaseb(0) + temp216*fun0*temp216b1 + (&
&                  cost1d*6.d0*(fun0*temp228**2)-temp225*(temp226*temp227&
&                  )+cost1d*6.d0*(temp220*temp223))*hessb(3)
                sinphaseb(3, 0) = sinphaseb(3, 0) + fun0*rphase(3)*&
&                  temp218b
                rphaseb(3) = rphaseb(3) + sinphase(3, 0)*fun0*temp218b
                DO i=3,1,-1
                  temp216b = cosphase(0)*hessb(i)
                  temp215 = rmucos(i, 0)**2 - rmusin(i, 0)**2
                  temp215b = -(cost1d*2.d0*temp216b)
                  temp214 = rmu(i, 0)**2
                  temp214b = -(cost1d*2.d0*temp216b)
                  temp214b0 = rmucos(i, 0)**2*temp214b
                  temp214b1 = cost1d*2.d0*hessb(i)
                  temp214b2 = rmu(i, 0)*rmucos(i, 0)*temp214b1
                  temp214b3 = sinphase(i, 0)*temp214b2
                  temp214b4 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  temp214b5 = rmu(i, 0)*rmucos(i, 0)*temp214b4
                  fun0b = fun0b + rphase(i)*temp214b3 + cosphase(0)*&
&                    temp214b5 + temp215*temp215b
                  temp214b6 = sinphase(i, 0)*fun0*rphase(i)*temp214b1
                  temp214b7 = fun0*cosphase(0)*temp214b4
                  rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp214b6 + &
&                    rmu(i, 0)*temp214b7 + fun*temp214*2*rmucos(i, 0)*&
&                    temp214b + fun0*2*rmucos(i, 0)*temp215b
                  rmusinb(i, 0) = rmusinb(i, 0) - fun0*2*rmusin(i, 0)*&
&                    temp215b
                  funb = funb + temp214*temp214b0
                  rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp214b6 + &
&                    rmucos(i, 0)*temp214b7 + fun*2*rmu(i, 0)*temp214b0
                  cosphaseb(0) = cosphaseb(0) + fun0*temp214b5 + (-(&
&                    cost1d*2.d0*(fun0*temp215))-cost1d*2.d0*(fun*temp214&
&                    *rmucos(i, 0)**2))*hessb(i)
                  sinphaseb(i, 0) = sinphaseb(i, 0) + fun0*rphase(i)*&
&                    temp214b2
                  rphaseb(i) = rphaseb(i) + fun0*temp214b3
                END DO
              ELSE
                temp255b = cosphase(0)*hessb(2)
                temp251 = fun0/cellscale(2)
                temp254 = rmucos(2, 0)**2*temp251
                temp253 = rmu(2, 0)*rmusin(2, 0)
                temp252 = 4.d0*cost2d*pi*2.d0
                temp252b = temp252*temp255b
                temp251b = temp253*rmucos(2, 0)**2*temp252b/cellscale(2)
                temp250 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp251b0 = -(cost2d*2.d0*temp255b)
                temp250b = fun0*2*temp250*temp251b0
                temp249 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp248 = rmucos(2, 0)**2
                temp247 = rmu(2, 0)**2
                temp246 = temp247*fun*temp248
                temp247b = -(cost2d*2.d0*temp255b)
                temp246b = temp249*temp247b
                rmub(2, 0) = rmub(2, 0) + temp248*fun*2*rmu(2, 0)*&
&                  temp246b + temp254*rmusin(2, 0)*temp252b
                rmusinb(2, 0) = rmusinb(2, 0) + temp254*rmu(2, 0)*&
&                  temp252b - 2*rmusin(2, 0)*temp250b - temp246*2*rmusin(&
&                  2, 0)*temp247b
                rmucosb(2, 0) = rmucosb(2, 0) + temp246*2*rmucos(2, 0)*&
&                  temp247b + temp247*fun*2*rmucos(2, 0)*temp246b + 2*&
&                  rmucos(2, 0)*temp250b + temp253*temp251*2*rmucos(2, 0)&
&                  *temp252b
                temp246b0 = cosphase(0)*hessb(1)
                temp241 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp242b = cost2d*2.d0*temp246b0
                temp239 = rmu(1, 0)*rmusin(1, 0)
                temp238 = 4.d0*cost2d*pi*2.d0
                temp238b = -(temp238*temp246b0)
                temp237b = temp239*rmucos(1, 0)**2*temp238b/cellscale(1)
                temp236 = rmu(2, 0)*rmucos(2, 0)
                temp236b = cost2d*2.d0*hessb(2)
                temp236b0 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp236b
                temp235b = temp236*temp236b0
                temp233 = rmu(2, 0)*rmucos(2, 0)
                temp233b = -(cost2d*2.d0*zb(indorbp, indt+2))
                temp233b0 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp233b
                temp232 = rmu(1, 0)*rmucos(1, 0)
                temp232b = -(cost2d*2.d0*hessb(1))
                temp232b0 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp232b
                temp231b = temp232*temp232b0
                temp229 = rmu(1, 0)*rmucos(1, 0)
                temp229b1 = cost2d*2.d0*zb(indorbp, indt+1)
                temp229b2 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp229b1
                fun0b = fun0b + temp241**2*temp242b + temp237b + temp233&
&                  *cosphase(0)*temp233b0 + temp229*cosphase(0)*temp229b2&
&                  + sinphase(1, 0)*rphase(1)*temp231b + sinphase(2, 0)*&
&                  rphase(2)*temp235b + temp250**2*temp251b0 + temp251b
                cellscaleb(2) = cellscaleb(2) - temp251*temp251b
                temp245 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp244 = rmucos(1, 0)**2
                temp243 = rmu(1, 0)**2
                temp243b = cost2d*2.d0*temp246b0
                temp242b0 = temp245*temp243b
                funb = funb + temp244*temp243*temp242b0 + temp248*&
&                  temp247*temp246b
                temp242 = temp243*fun*temp244
                temp237 = fun0/cellscale(1)
                temp240 = rmucos(1, 0)**2*temp237
                cosphaseb(0) = cosphaseb(0) + (cost2d*2.d0*(temp242*&
&                  temp245)+cost2d*2.d0*(fun0*temp241**2)-temp238*(&
&                  temp239*temp240))*hessb(1) + temp229*fun0*temp229b2 + &
&                  temp233*fun0*temp233b0 + (temp252*(temp253*temp254)-&
&                  cost2d*2.d0*(fun0*temp250**2)-cost2d*2.d0*(temp246*&
&                  temp249))*hessb(2)
                temp241b = fun0*2*temp241*temp242b
                rmub(1, 0) = rmub(1, 0) + temp240*rmusin(1, 0)*temp238b &
&                  + temp244*fun*2*rmu(1, 0)*temp242b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp239*temp237*2*rmucos&
&                  (1, 0)*temp238b + 2*rmucos(1, 0)*temp241b + temp242*2*&
&                  rmucos(1, 0)*temp243b + temp243*fun*2*rmucos(1, 0)*&
&                  temp242b0
                rmusinb(1, 0) = rmusinb(1, 0) + temp240*rmu(1, 0)*&
&                  temp238b - 2*rmusin(1, 0)*temp241b - temp242*2*rmusin(&
&                  1, 0)*temp243b
                cellscaleb(1) = cellscaleb(1) - temp237*temp237b
                temp235 = sinphase(2, 0)*fun0*rphase(2)
                temp236b1 = temp236*temp235*temp236b
                temp234 = fun0*cosphase(0)
                temp233b1 = temp233*temp234*temp233b
                rmucosb(2, 0) = rmucosb(2, 0) + temp234*rmu(2, 0)*&
&                  temp233b0 + 2*rmucos(2, 0)*temp233b1 + temp235*rmu(2, &
&                  0)*temp236b0 + 2*rmucos(2, 0)*temp236b1
                rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp233b1&
&                  - 2*rmusin(2, 0)*temp236b1
                rmub(2, 0) = rmub(2, 0) + temp234*rmucos(2, 0)*temp233b0&
&                  + temp235*rmucos(2, 0)*temp236b0
                sinphaseb(2, 0) = sinphaseb(2, 0) + fun0*rphase(2)*&
&                  temp235b
                rphaseb(2) = rphaseb(2) + sinphase(2, 0)*fun0*temp235b
                temp231 = sinphase(1, 0)*fun0*rphase(1)
                temp232b1 = temp232*temp231*temp232b
                temp230 = fun0*cosphase(0)
                temp229b3 = temp229*temp230*temp229b1
                rmucosb(1, 0) = rmucosb(1, 0) + temp230*rmu(1, 0)*&
&                  temp229b2 + 2*rmucos(1, 0)*temp229b3 + temp231*rmu(1, &
&                  0)*temp232b0 + 2*rmucos(1, 0)*temp232b1
                rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp229b3&
&                  - 2*rmusin(1, 0)*temp232b1
                rmub(1, 0) = rmub(1, 0) + temp230*rmucos(1, 0)*temp229b2&
&                  + temp231*rmucos(1, 0)*temp232b0
                sinphaseb(1, 0) = sinphaseb(1, 0) + fun0*rphase(1)*&
&                  temp231b
                rphaseb(1) = rphaseb(1) + sinphase(1, 0)*fun0*temp231b
              END IF
            ELSE
              temp272 = fun*rmu(1, 0)*rmucos(1, 0)
              temp271 = rmusin(1, 0)**2 - rmucos(1, 0)**2
              temp268 = fun0/cellscale(1)
              temp270 = rmusin(1, 0)*rmucos(1, 0)
              temp269 = rmu(2, 0)*cosphase(0)
              temp269b = -(cost3d*(pi*4.d0*(temp270*temp268)+temp271*&
&                temp272)*hessb(1))
              temp269b0 = -(cost3d*temp269*rmucos(2, 0)*hessb(1))
              temp269b1 = pi*4.d0*temp269b0
              temp268b = temp270*temp269b1/cellscale(1)
              temp268b0 = temp271*rmucos(1, 0)*temp269b0
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*cosphase(0)*&
&                temp269b
              temp267 = fun*rmu(2, 0)*rmucos(2, 0)
              temp266 = rmusin(2, 0)**2 - rmucos(2, 0)**2
              temp263 = fun0/cellscale(2)
              temp265 = rmusin(2, 0)*rmucos(2, 0)
              temp264b = -(cost3d*(pi*4.d0*(temp265*temp263)+temp266*&
&                temp267)*hessb(2))
              temp259 = rmu(1, 0)*rmucos(1, 0)
              temp259b = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*zb(&
&                indorbp, indt+2)
              temp255 = rmu(2, 0)*rmucos(2, 0)
              temp255b0 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*zb(&
&                indorbp, indt+1)
              cosphaseb(0) = cosphaseb(0) + rmucos(1, 0)*rmu(1, 0)*&
&                temp264b + temp255*fun0*temp255b0 + temp259*fun0*&
&                temp259b + rmucos(2, 0)*rmu(2, 0)*temp269b
              rmucosb(2, 0) = rmucosb(2, 0) + temp269*temp269b
              rmusinb(1, 0) = rmusinb(1, 0) + temp272*2*rmusin(1, 0)*&
&                temp269b0 + temp268*rmucos(1, 0)*temp269b1
              temp264 = rmu(1, 0)*cosphase(0)
              rmucosb(1, 0) = rmucosb(1, 0) + temp264*temp264b + (&
&                temp271*fun*rmu(1, 0)-temp272*2*rmucos(1, 0))*temp269b0 &
&                + temp268*rmusin(1, 0)*temp269b1
              temp264b0 = -(cost3d*temp264*rmucos(1, 0)*hessb(2))
              temp264b1 = pi*4.d0*temp264b0
              temp263b = temp265*temp264b1/cellscale(2)
              temp261 = rmu(1, 0)*rmucos(1, 0)
              temp261b = -(cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                hessb(2))
              temp261b0 = temp261*sinphase(2, 0)*temp261b
              temp257 = rmu(2, 0)*rmucos(2, 0)
              temp257b = -(cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                hessb(1))
              temp257b0 = temp257*sinphase(1, 0)*temp257b
              fun0b = fun0b + temp263b + temp259*cosphase(0)*temp259b + &
&                temp255*cosphase(0)*temp255b0 + rphase(1)*temp257b0 + &
&                rphase(2)*temp261b0 + temp268b
              cellscaleb(1) = cellscaleb(1) - temp268*temp268b
              temp263b0 = temp266*rmucos(2, 0)*temp264b0
              funb = funb + rmu(2, 0)*temp263b0 + rmu(1, 0)*temp268b0
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*cosphase(0)*&
&                temp264b + fun*temp268b0
              temp262 = sinphase(2, 0)*fun0*rphase(2)
              temp261b1 = -(cost3d*temp261*temp262*hessb(2))
              temp260 = fun0*cosphase(0)
              temp259b0 = cost3d*temp259*temp260*zb(indorbp, indt+2)
              rmusinb(2, 0) = rmusinb(2, 0) + temp267*2*rmusin(2, 0)*&
&                temp264b0 - 2*rmusin(2, 0)*temp259b0 - 2*rmusin(2, 0)*&
&                temp261b1 + temp263*rmucos(2, 0)*temp264b1
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp261b1 +&
&                (temp266*fun*rmu(2, 0)-temp267*2*rmucos(2, 0))*temp264b0&
&                + temp263*rmusin(2, 0)*temp264b1
              cellscaleb(2) = cellscaleb(2) - temp263*temp263b
              rmub(2, 0) = rmub(2, 0) + fun*temp263b0
              rmub(1, 0) = rmub(1, 0) + temp260*rmucos(1, 0)*temp259b + &
&                temp262*rmucos(1, 0)*temp261b
              rmucosb(1, 0) = rmucosb(1, 0) + temp260*rmu(1, 0)*temp259b&
&                + temp262*rmu(1, 0)*temp261b
              sinphaseb(2, 0) = sinphaseb(2, 0) + temp261*fun0*rphase(2)&
&                *temp261b
              rphaseb(2) = rphaseb(2) + fun0*temp261b0
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp259b0
              temp258 = sinphase(1, 0)*fun0*rphase(1)
              temp257b1 = -(cost3d*temp257*temp258*hessb(1))
              rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp257b1
              temp256 = fun0*cosphase(0)
              temp255b1 = cost3d*temp255*temp256*zb(indorbp, indt+1)
              rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp255b1 -&
&                2*rmusin(1, 0)*temp257b1
              rmub(2, 0) = rmub(2, 0) + temp256*rmucos(2, 0)*temp255b0 +&
&                temp258*rmucos(2, 0)*temp257b
              rmucosb(2, 0) = rmucosb(2, 0) + temp256*rmu(2, 0)*&
&                temp255b0 + temp258*rmu(2, 0)*temp257b
              sinphaseb(1, 0) = sinphaseb(1, 0) + temp257*fun0*rphase(1)&
&                *temp257b
              rphaseb(1) = rphaseb(1) + fun0*temp257b0
              rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp255b1
            END IF
          ELSE IF (branch .LT. 5) THEN
            IF (branch .LT. 4) THEN
              temp290 = fun*rmu(3, 0)*rmucos(3, 0)
              temp289 = rmusin(3, 0)**2 - rmucos(3, 0)**2
              temp286 = fun0/cellscale(3)
              temp288 = rmusin(3, 0)*rmucos(3, 0)
              temp287 = rmu(2, 0)*cosphase(0)
              temp287b = -(cost3d*(pi*4.d0*(temp288*temp286)+temp289*&
&                temp290)*hessb(3))
              temp287b0 = -(cost3d*temp287*rmucos(2, 0)*hessb(3))
              temp287b1 = pi*4.d0*temp287b0
              temp286b = temp288*temp287b1/cellscale(3)
              temp286b0 = temp289*rmucos(3, 0)*temp287b0
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*cosphase(0)*&
&                temp287b
              temp285 = fun*rmu(2, 0)*rmucos(2, 0)
              temp284 = rmusin(2, 0)**2 - rmucos(2, 0)**2
              temp281 = fun0/cellscale(2)
              temp283 = rmusin(2, 0)*rmucos(2, 0)
              temp282b = -(cost3d*(pi*4.d0*(temp283*temp281)+temp284*&
&                temp285)*hessb(2))
              temp277 = rmu(2, 0)*rmucos(2, 0)
              temp277b = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*zb(&
&                indorbp, indt+3)
              temp273 = rmu(3, 0)*rmucos(3, 0)
              temp273b = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*zb(&
&                indorbp, indt+2)
              cosphaseb(0) = cosphaseb(0) + rmucos(3, 0)*rmu(3, 0)*&
&                temp282b + temp273*fun0*temp273b + temp277*fun0*temp277b&
&                + rmucos(2, 0)*rmu(2, 0)*temp287b
              rmucosb(2, 0) = rmucosb(2, 0) + temp287*temp287b
              rmusinb(3, 0) = rmusinb(3, 0) + temp290*2*rmusin(3, 0)*&
&                temp287b0 + temp286*rmucos(3, 0)*temp287b1
              temp282 = rmu(3, 0)*cosphase(0)
              rmucosb(3, 0) = rmucosb(3, 0) + temp282*temp282b + (&
&                temp289*fun*rmu(3, 0)-temp290*2*rmucos(3, 0))*temp287b0 &
&                + temp286*rmusin(3, 0)*temp287b1
              temp282b0 = -(cost3d*temp282*rmucos(3, 0)*hessb(2))
              temp282b1 = pi*4.d0*temp282b0
              temp281b = temp283*temp282b1/cellscale(2)
              temp279 = rmu(2, 0)*rmucos(2, 0)
              temp279b = -(cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                hessb(3))
              temp279b0 = temp279*sinphase(3, 0)*temp279b
              temp275 = rmu(3, 0)*rmucos(3, 0)
              temp275b = -(cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                hessb(2))
              temp275b0 = temp275*sinphase(2, 0)*temp275b
              fun0b = fun0b + temp281b + temp277*cosphase(0)*temp277b + &
&                temp273*cosphase(0)*temp273b + rphase(2)*temp275b0 + &
&                rphase(3)*temp279b0 + temp286b
              cellscaleb(3) = cellscaleb(3) - temp286*temp286b
              temp281b0 = temp284*rmucos(2, 0)*temp282b0
              funb = funb + rmu(2, 0)*temp281b0 + rmu(3, 0)*temp286b0
              rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*cosphase(0)*&
&                temp282b + fun*temp286b0
              rmusinb(2, 0) = rmusinb(2, 0) + temp285*2*rmusin(2, 0)*&
&                temp282b0 + temp281*rmucos(2, 0)*temp282b1
              rmucosb(2, 0) = rmucosb(2, 0) + (temp284*fun*rmu(2, 0)-&
&                temp285*2*rmucos(2, 0))*temp282b0 + temp281*rmusin(2, 0)&
&                *temp282b1
              cellscaleb(2) = cellscaleb(2) - temp281*temp281b
              temp280 = sinphase(3, 0)*fun0*rphase(3)
              temp278 = fun0*cosphase(0)
              rmub(2, 0) = rmub(2, 0) + temp280*rmucos(2, 0)*temp279b + &
&                temp278*rmucos(2, 0)*temp277b + fun*temp281b0
              temp279b1 = -(cost3d*temp279*temp280*hessb(3))
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp279b1
              temp277b0 = cost3d*temp277*temp278*zb(indorbp, indt+3)
              rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp277b0 -&
&                2*rmusin(3, 0)*temp279b1
              rmucosb(2, 0) = rmucosb(2, 0) + temp278*rmu(2, 0)*temp277b&
&                + temp280*rmu(2, 0)*temp279b
              sinphaseb(3, 0) = sinphaseb(3, 0) + temp279*fun0*rphase(3)&
&                *temp279b
              rphaseb(3) = rphaseb(3) + fun0*temp279b0
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp277b0
              temp276 = sinphase(2, 0)*fun0*rphase(2)
              temp275b1 = -(cost3d*temp275*temp276*hessb(2))
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp275b1
              temp274 = fun0*cosphase(0)
              temp273b0 = cost3d*temp273*temp274*zb(indorbp, indt+2)
              rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp273b0 -&
&                2*rmusin(2, 0)*temp275b1
              rmub(3, 0) = rmub(3, 0) + temp274*rmucos(3, 0)*temp273b + &
&                temp276*rmucos(3, 0)*temp275b
              rmucosb(3, 0) = rmucosb(3, 0) + temp274*rmu(3, 0)*temp273b&
&                + temp276*rmu(3, 0)*temp275b
              sinphaseb(2, 0) = sinphaseb(2, 0) + temp275*fun0*rphase(2)&
&                *temp275b
              rphaseb(2) = rphaseb(2) + fun0*temp275b0
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp273b0
            END IF
          ELSE
            temp308 = fun*rmu(3, 0)*rmucos(3, 0)
            temp307 = rmusin(3, 0)**2 - rmucos(3, 0)**2
            temp304 = fun0/cellscale(3)
            temp306 = rmusin(3, 0)*rmucos(3, 0)
            temp305 = rmu(1, 0)*cosphase(0)
            temp305b = -(cost3d*(pi*4.d0*(temp306*temp304)+temp307*&
&              temp308)*hessb(3))
            temp305b0 = -(cost3d*temp305*rmucos(1, 0)*hessb(3))
            temp305b1 = pi*4.d0*temp305b0
            temp304b = temp306*temp305b1/cellscale(3)
            temp304b0 = temp307*rmucos(3, 0)*temp305b0
            rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*cosphase(0)*temp305b
            temp303 = fun*rmu(1, 0)*rmucos(1, 0)
            temp302 = rmusin(1, 0)**2 - rmucos(1, 0)**2
            temp299 = fun0/cellscale(1)
            temp301 = rmusin(1, 0)*rmucos(1, 0)
            temp300b = -(cost3d*(pi*4.d0*(temp301*temp299)+temp302*&
&              temp303)*hessb(1))
            temp295 = rmu(1, 0)*rmucos(1, 0)
            temp295b = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*zb(&
&              indorbp, indt+3)
            temp291 = rmu(3, 0)*rmucos(3, 0)
            temp291b = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*zb(&
&              indorbp, indt+1)
            cosphaseb(0) = cosphaseb(0) + rmucos(3, 0)*rmu(3, 0)*&
&              temp300b + temp291*fun0*temp291b + temp295*fun0*temp295b +&
&              rmucos(1, 0)*rmu(1, 0)*temp305b
            rmucosb(1, 0) = rmucosb(1, 0) + temp305*temp305b
            rmusinb(3, 0) = rmusinb(3, 0) + temp308*2*rmusin(3, 0)*&
&              temp305b0 + temp304*rmucos(3, 0)*temp305b1
            temp300 = rmu(3, 0)*cosphase(0)
            rmucosb(3, 0) = rmucosb(3, 0) + temp300*temp300b + (temp307*&
&              fun*rmu(3, 0)-temp308*2*rmucos(3, 0))*temp305b0 + temp304*&
&              rmusin(3, 0)*temp305b1
            temp300b0 = -(cost3d*temp300*rmucos(3, 0)*hessb(1))
            temp300b1 = pi*4.d0*temp300b0
            temp299b = temp301*temp300b1/cellscale(1)
            temp297 = rmu(1, 0)*rmucos(1, 0)
            temp297b = -(cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hessb(&
&              3))
            temp297b0 = temp297*sinphase(3, 0)*temp297b
            temp293 = rmu(3, 0)*rmucos(3, 0)
            temp293b = -(cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hessb(&
&              1))
            temp293b0 = temp293*sinphase(1, 0)*temp293b
            fun0b = fun0b + temp299b + temp295*cosphase(0)*temp295b + &
&              temp291*cosphase(0)*temp291b + rphase(1)*temp293b0 + &
&              rphase(3)*temp297b0 + temp304b
            cellscaleb(3) = cellscaleb(3) - temp304*temp304b
            temp299b0 = temp302*rmucos(1, 0)*temp300b0
            funb = funb + rmu(1, 0)*temp299b0 + rmu(3, 0)*temp304b0
            rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*cosphase(0)*temp300b &
&              + fun*temp304b0
            rmusinb(1, 0) = rmusinb(1, 0) + temp303*2*rmusin(1, 0)*&
&              temp300b0 + temp299*rmucos(1, 0)*temp300b1
            rmucosb(1, 0) = rmucosb(1, 0) + (temp302*fun*rmu(1, 0)-&
&              temp303*2*rmucos(1, 0))*temp300b0 + temp299*rmusin(1, 0)*&
&              temp300b1
            cellscaleb(1) = cellscaleb(1) - temp299*temp299b
            temp298 = sinphase(3, 0)*fun0*rphase(3)
            temp296 = fun0*cosphase(0)
            rmub(1, 0) = rmub(1, 0) + temp298*rmucos(1, 0)*temp297b + &
&              temp296*rmucos(1, 0)*temp295b + fun*temp299b0
            temp297b1 = -(cost3d*temp297*temp298*hessb(3))
            rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp297b1
            temp295b0 = cost3d*temp295*temp296*zb(indorbp, indt+3)
            rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp295b0 - 2&
&              *rmusin(3, 0)*temp297b1
            rmucosb(1, 0) = rmucosb(1, 0) + temp296*rmu(1, 0)*temp295b +&
&              temp298*rmu(1, 0)*temp297b
            sinphaseb(3, 0) = sinphaseb(3, 0) + temp297*fun0*rphase(3)*&
&              temp297b
            rphaseb(3) = rphaseb(3) + fun0*temp297b0
            rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp295b0
            temp294 = sinphase(1, 0)*fun0*rphase(1)
            temp293b1 = -(cost3d*temp293*temp294*hessb(1))
            rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp293b1
            temp292 = fun0*cosphase(0)
            temp291b0 = cost3d*temp291*temp292*zb(indorbp, indt+1)
            rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp291b0 - 2&
&              *rmusin(1, 0)*temp293b1
            rmub(3, 0) = rmub(3, 0) + temp292*rmucos(3, 0)*temp291b + &
&              temp294*rmucos(3, 0)*temp293b
            rmucosb(3, 0) = rmucosb(3, 0) + temp292*rmu(3, 0)*temp291b +&
&              temp294*rmu(3, 0)*temp293b
            sinphaseb(1, 0) = sinphaseb(1, 0) + temp293*fun0*rphase(1)*&
&              temp293b
            rphaseb(1) = rphaseb(1) + fun0*temp293b0
            rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp291b0
          END IF
          DO i=3,1,-1
            temp213 = fun*rphase(i)
            temp212 = rmu(i, 0)*rmucos(i, 0)
            temp212b = -(temp212*temp213*hessb(i))
            temp212b0 = -(distp(0, 1+ic)*sinphase(i, 0)*hessb(i))
            temp212b1 = -(rphase(i)**2*hessb(i))
            temp212b2 = distp(0, 1+ic)*temp212b1
            temp211 = sinphase(i, 0)*rmu(i, 0)
            temp210 = fun*rphase(i)
            temp210b = -(temp210*temp211*hessb(i))
            temp210b0 = -(distp(0, 1+ic)*rmucos(i, 0)*hessb(i))
            temp210b1 = -(sinphase(i, 0)*hess3d(i, ic)*hessb(i))
            temp210b2 = -(fun0*rphase(i)*hessb(i))
            temp210b3 = cosphase(0)*hessb(i)
            temp209 = rmucos(i, 0)**2
            temp208 = rmu(i, 0)**2
            temp207 = rmucos(i, 0)**2 - rmusin(i, 0)**2
            temp206 = fun2*temp208*temp209 + fun*temp207
            temp204b31 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
            temp204b32 = -(fun0*rphase(i)*zb(indorbp, indt+i))
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp206*temp210b3 + &
&              sinphase(i, 0)*temp204b32 + fun*cosphase(0)*temp204b31 + &
&              rmucos(i, 0)*temp210b + fun0*cosphase(0)*temp212b1 + &
&              sinphase(i, 0)*temp212b
            sinphaseb(i, 0) = sinphaseb(i, 0) + distp(0, 1+ic)*&
&              temp204b32 + hess3d(i, ic)*temp210b2 + temp210*rmu(i, 0)*&
&              temp210b0 + distp(0, 1+ic)*temp212b
            temp206b = distp(0, 1+ic)*temp210b3
            temp204 = hess3d(i, ic)*rmucos(i, 0)
            temp204b33 = distp(0, 1+ic)*fun*cosphase(0)*zb(indorbp, indt&
&              +i)
            rmub(i, 0) = rmub(i, 0) + temp209*fun2*2*rmu(i, 0)*temp206b &
&              + temp204*fun*temp210b3 + rmucos(i, 0)*temp204b33 + &
&              temp210*sinphase(i, 0)*temp210b0 + temp213*rmucos(i, 0)*&
&              temp212b0
            temp205 = fun*rmu(i, 0)
            rmucosb(i, 0) = rmucosb(i, 0) + (fun*2*rmucos(i, 0)+fun2*&
&              temp208*2*rmucos(i, 0))*temp206b + temp205*hess3d(i, ic)*&
&              temp210b3 + rmu(i, 0)*temp204b33 + distp(0, 1+ic)*temp210b&
&              + temp213*rmu(i, 0)*temp212b0
            temp204b34 = distp(0, 1+ic)*temp204b31
            funb = funb + temp207*temp206b + temp204*rmu(i, 0)*temp210b3&
&              + cosphase(0)*temp204b34 + temp211*rphase(i)*temp210b0 + &
&              temp212*rphase(i)*temp212b0
            temp204b35 = -(distp(0, 1+ic)*sinphase(i, 0)*zb(indorbp, &
&              indt+i))
            rphaseb(i) = rphaseb(i) + fun0*temp204b35 + fun0*temp210b1 +&
&              temp211*fun*temp210b0 - distp(0, 1+ic)*fun0*cosphase(0)*2*&
&              rphase(i)*hessb(i) + temp212*fun*temp212b0
            fun0b = fun0b + rphase(i)*temp204b35 + rphase(i)*temp210b1 +&
&              cosphase(0)*temp212b2
            cosphaseb(0) = cosphaseb(0) + (temp206*distp(0, 1+ic)+&
&              temp204*temp205)*hessb(i) + fun*temp204b34 + fun0*&
&              temp212b2
            hess3db(i, ic) = hess3db(i, ic) + temp205*rmucos(i, 0)*&
&              temp210b3 + sinphase(i, 0)*temp210b2
            fun2b = fun2b + temp209*temp208*temp206b
            rmusinb(i, 0) = rmusinb(i, 0) - fun*2*rmusin(i, 0)*temp206b
            hessb(i) = 0.0_8
            zb(indorbp, indt+i) = 0.D0
          END DO
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      temp204b9 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hess3db(3, 5)
      temp204b10 = cost3d*rmu(1, 0)*rmucos(1, 0)*hess3db(3, 5)
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp204b9
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp204b9
      hess3db(3, 5) = 0.0_8
      temp204b11 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hess3db(1, 5&
&        )
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp204b11 + 2*rmucos(3&
&        , 0)*temp204b10
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp204b10
      temp204b12 = cost3d*rmu(3, 0)*rmucos(3, 0)*hess3db(1, 5)
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp204b11
      rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp204b12
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp204b12
      hess3db(1, 5) = 0.0_8
      temp204b13 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hess3db(3, 4&
&        )
      temp204b14 = cost3d*rmu(2, 0)*rmucos(2, 0)*hess3db(3, 4)
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp204b13
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp204b13
      hess3db(3, 4) = 0.0_8
      temp204b15 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*hess3db(2, 4&
&        )
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp204b15 + 2*rmucos(3&
&        , 0)*temp204b14
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp204b14
      temp204b16 = cost3d*rmu(3, 0)*rmucos(3, 0)*hess3db(2, 4)
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp204b15
      hess3db(2, 4) = 0.0_8
      temp204b17 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hess3db(1, 3&
&        )
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp204b17 + 2*rmucos(2&
&        , 0)*temp204b16
      rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp204b16
      temp204b18 = cost3d*rmu(2, 0)*rmucos(2, 0)*hess3db(1, 3)
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp204b17
      hess3db(1, 3) = 0.0_8
      temp204b19 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*hess3db(2, 3&
&        )
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp204b19 + 2*rmucos(1&
&        , 0)*temp204b18
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp204b18
      temp204b20 = cost3d*rmu(1, 0)*rmucos(1, 0)*hess3db(2, 3)
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp204b19
      hess3db(2, 3) = 0.0_8
      temp204b21 = -(cost2d*2.d0*hess3db(2, 2))
      temp204b22 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp204b21
      temp204b23 = rmu(2, 0)*rmucos(2, 0)*temp204b21
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp204b22 + 2*rmucos(2&
&        , 0)*temp204b23 + 2*rmucos(2, 0)*temp204b20
      rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp204b23 - 2*&
&        rmusin(2, 0)*temp204b20
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp204b22
      hess3db(2, 2) = 0.0_8
      temp204b24 = cost2d*2.d0*hess3db(1, 2)
      temp204b25 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp204b24
      temp204b26 = rmu(1, 0)*rmucos(1, 0)*temp204b24
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp204b25
      rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp204b26 + rmu(1&
&        , 0)*temp204b25
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp204b26
      hess3db(1, 2) = 0.0_8
      temp204b27 = cost1d*6.d0*hess3db(3, 1)
      temp204b28 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp204b27
      temp204b29 = rmu(3, 0)*rmucos(3, 0)*temp204b27
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp204b28
      rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp204b29 + rmu(3&
&        , 0)*temp204b28
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp204b29
      temp204b30 = -(cost1d*2.d0*hess3db(:, 1))
      rmub(:, 0) = rmub(:, 0) + rmucos(:, 0)*temp204b30
      rmucosb(:, 0) = rmucosb(:, 0) + rmu(:, 0)*temp204b30
      dd1b = 4.d0*distp(0, 1)*2*dd1*fun2b - 2.d0*distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb + 4.d0*dd1**2*&
&        fun2b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=5,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp204b8 = distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + cosphase(k)*temp204b8
          cosphaseb(k) = cosphaseb(k) + distp(k, 1)*temp204b8
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*cosphase(k)*zb&
&            (indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp204b = cost3d*rmucos(1, i)*rmucos(3, i)*distpb(i, 6)
      temp204b0 = cost3d*rmu(1, i)*rmu(3, i)*distpb(i, 6)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp204b
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp204b
      rmucosb(1, i) = rmucosb(1, i) + rmucos(3, i)*temp204b0
      rmucosb(3, i) = rmucosb(3, i) + rmucos(1, i)*temp204b0
      distpb(i, 6) = 0.0_8
      temp204b1 = cost3d*rmucos(2, i)*rmucos(3, i)*distpb(i, 5)
      temp204b2 = cost3d*rmu(2, i)*rmu(3, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp204b1
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp204b1
      rmucosb(2, i) = rmucosb(2, i) + rmucos(3, i)*temp204b2
      rmucosb(3, i) = rmucosb(3, i) + rmucos(2, i)*temp204b2
      distpb(i, 5) = 0.0_8
      temp204b3 = cost3d*rmucos(1, i)*rmucos(2, i)*distpb(i, 4)
      temp204b4 = cost3d*rmu(1, i)*rmu(2, i)*distpb(i, 4)
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp204b3
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp204b3
      rmucosb(1, i) = rmucosb(1, i) + rmucos(2, i)*temp204b4
      rmucosb(2, i) = rmucosb(2, i) + rmucos(1, i)*temp204b4
      distpb(i, 4) = 0.0_8
      temp204b5 = cost2d*2*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      temp204b6 = -(cost2d*2*rmu(2, i)*rmucos(2, i)*distpb(i, 3))
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp204b5
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp204b5
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp204b6
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp204b6
      distpb(i, 3) = 0.0_8
      temp204b7 = cost1d*distpb(i, 2)
      rmub(3, i) = rmub(3, i) + 3.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp204b7
      rmucosb(3, i) = rmucosb(3, i) + 3.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp204b7
      rb(i) = rb(i) - 2*r(i)*temp204b7
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    dd1b = 0.0_8
    DO k=0,0,-1
      temp203 = r(k)**2
      temp203b3 = c*DEXP(-(dd1*temp203))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp203))*distpb(k, 1)
      dd1b = dd1b - temp203*temp203b3
      rb(k) = rb(k) - dd1*2*r(k)*temp203b3
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.64592278064948967213d0*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indpar+1) = -ddb(indpar+1)
  CASE (45)
! derivative of the orbital 37 d orbitals
! d R(r) /d z = d exp(-alpha r^2) / dz = c*exp(-z r^2)*(7/4/z-r^2)
! each gaussian term is normalized
    indorbp = indorb
    indparp = indpar + 1
    IF (dd(indpar+1) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indpar+1) = dd(indpar+1)
    ELSE
      dd(indpar+1) = -dd(indpar+1)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
!         c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)
    c = dd1**1.75d0*1.64592278064948967213d0
!         endif
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=0,0
      distp(i, 2) = (3.d0*(rmu(3, i)*rmucos(3, i))**2-r(i)**2)*cost1d
! lz=0
      distp(i, 3) = ((rmu(1, i)*rmucos(1, i))**2-(rmu(2, i)*rmucos(2, i)&
&        )**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*rmucos(1, i)*rmucos(2, i)*cost3d
! lz=+/-2
      distp(i, 5) = rmu(2, i)*rmu(3, i)*rmucos(2, i)*rmucos(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*rmucos(1, i)*rmucos(3, i)*cost3d
    END DO
! lz=+/-1
    DO ic=1,5
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)*(7.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-11.d0/2.d0)
      fun2 = distp(0, 1)*4.d0*dd1 - (2.d0*dd1*r(0)**2-11.d0/2.d0)*2.d0*&
&        dd1*distp(0, 1)
      hess3d = 0.d0
      hess3d(:, 1) = -(2.d0*rmu(:, 0)*rmucos(:, 0)*cost1d)
      hess3d(3, 1) = hess3d(3, 1) + 6.d0*rmu(3, 0)*rmucos(3, 0)*(rmucos(&
&        3, 0)**2-rmusin(3, 0)**2)*cost1d
      hess3d(1, 2) = 2.d0*rmu(1, 0)*rmucos(1, 0)*(rmucos(1, 0)**2-rmusin&
&        (1, 0)**2)*cost2d
      hess3d(2, 2) = -(2.d0*rmu(2, 0)*rmucos(2, 0)*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)*cost2d)
! lz=+/-2
      hess3d(2, 3) = rmu(1, 0)*rmucos(1, 0)*cost3d*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)
! lz=+/-2
      hess3d(1, 3) = rmu(2, 0)*rmucos(2, 0)*cost3d*(rmucos(1, 0)**2-&
&        rmusin(1, 0)**2)
! lz=+/-1
      hess3d(2, 4) = rmu(3, 0)*rmucos(3, 0)*cost3d*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)
! lz=+/-1
      hess3d(3, 4) = rmu(2, 0)*rmucos(2, 0)*cost3d*(rmucos(3, 0)**2-&
&        rmusin(3, 0)**2)
! lz=+/-1
      hess3d(1, 5) = rmu(3, 0)*rmucos(3, 0)*cost3d*(rmucos(1, 0)**2-&
&        rmusin(1, 0)**2)
! lz=+/-1
      hess3d(3, 5) = rmu(1, 0)*rmucos(1, 0)*cost3d*(rmucos(3, 0)**2-&
&        rmusin(3, 0)**2)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,5
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          DO i=1,3
! 1)
! 2)
            hess(i) = ((fun2*(rmu(i, 0)*rmucos(i, 0))**2+fun*(rmucos(i, &
&              0)**2-rmusin(i, 0)**2))*distp(0, 1+ic)+hess3d(i, ic)*fun*&
&              rmu(i, 0)*rmucos(i, 0))*cosphase(0)
!enddo for i
! from 1
! from 2
! from 2
! from 2
            hess(i) = hess(i) - distp(0, 1+ic)*fun*rmu(i, 0)*rmucos(i, 0&
&              )*sinphase(i, 0)*rphase(i) - distp(0, 1+ic)*fun0*cosphase(&
&              0)*rphase(i)**2 - distp(0, 1+ic)*fun*sinphase(i, 0)*rphase&
&              (i)*rmu(i, 0)*rmucos(i, 0) - fun0*sinphase(i, 0)*rphase(i)&
&              *hess3d(i, ic)
          END DO
          IF (ic .EQ. 1) THEN
            DO i=1,3
! 3
! from  3
              hess(i) = hess(i) + 2.d0*rmu(i, 0)*rmucos(i, 0)*fun0*&
&                cost1d*sinphase(i, 0)*rphase(i)
              hess(i) = hess(i) + (-(2.d0*fun0*cost1d*(rmucos(i, 0)**2-&
&                rmusin(i, 0)**2))-2.d0*fun*rmu(i, 0)**2*rmucos(i, 0)**2*&
&                cost1d)*cosphase(0)
            END DO
! 4
! from 4
            hess(3) = hess(3) - 6.d0*rmu(3, 0)*rmucos(3, 0)*cost1d*fun0*&
&              (rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(3) = hess(3) + (6.d0*cost1d*fun0*(rmucos(3, 0)**2-&
&              rmusin(3, 0)**2)**2-6.d0*rmu(3, 0)*rmucos(3, 0)*cost1d*&
&              fun0*4.d0*pi/cellscale(3)*rmusin(3, 0)*rmucos(3, 0)+6.d0*&
&              rmu(3, 0)**2*rmucos(3, 0)**2*cost1d*fun*(rmucos(3, 0)**2-&
&              rmusin(3, 0)**2))*cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
          ELSE IF (ic .EQ. 2) THEN
            hess(1) = hess(1) - 2.d0*rmu(1, 0)*fun0*cost2d*rmucos(1, 0)*&
&              (rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(2) = hess(2) - (-(2.d0*rmu(2, 0)*fun0*cost2d*rmucos(2, &
&              0)*(rmucos(2, 0)**2-rmusin(2, 0)**2)))*sinphase(2, 0)*&
&              rphase(2)
            hess(1) = hess(1) + (2.d0*rmu(1, 0)**2*fun*cost2d*rmucos(1, &
&              0)**2*(rmucos(1, 0)**2-rmusin(1, 0)**2)+2.d0*fun0*cost2d*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*(rmucos(1, 0)**2-rmusin(1&
&              , 0)**2)-2.d0*rmu(1, 0)*fun0*cost2d*rmucos(1, 0)*4.d0*pi/&
&              cellscale(1)*rmusin(1, 0)*rmucos(1, 0))*cosphase(0)
            hess(2) = hess(2) + (-(2.d0*rmu(2, 0)**2*fun*cost2d*rmucos(2&
&              , 0)**2*(rmucos(2, 0)**2-rmusin(2, 0)**2))-2.d0*fun0*&
&              cost2d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*(rmucos(2, 0)**2-&
&              rmusin(2, 0)**2)+2.d0*rmu(2, 0)*fun0*cost2d*rmucos(2, 0)*&
&              4.d0*pi/cellscale(2)*rmusin(2, 0)*rmucos(2, 0))*cosphase(0&
&              )
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          ELSE IF (ic .EQ. 3) THEN
            hess(1) = hess(1) - rmu(2, 0)*fun0*cost3d*rmucos(2, 0)*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(2) = hess(2) - rmu(1, 0)*fun0*cost3d*rmucos(1, 0)*(&
&              rmucos(2, 0)**2-rmusin(2, 0)**2)*sinphase(2, 0)*rphase(2)
            hess(2) = hess(2) + (-(rmu(1, 0)*cost3d*rmucos(1, 0)*(4.d0*&
&              pi/cellscale(2)*fun0*rmusin(2, 0)*rmucos(2, 0)+fun*(rmusin&
&              (2, 0)**2-rmucos(2, 0)**2)*rmu(2, 0)*rmucos(2, 0))))*&
&              cosphase(0)
            hess(1) = hess(1) + (-(rmu(2, 0)*cost3d*rmucos(2, 0)*(4.d0*&
&              pi/cellscale(1)*fun0*rmusin(1, 0)*rmucos(1, 0)+fun*(rmusin&
&              (1, 0)**2-rmucos(1, 0)**2)*rmu(1, 0)*rmucos(1, 0))))*&
&              cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE IF (ic .EQ. 4) THEN
            hess(2) = hess(2) - rmu(3, 0)*fun0*cost3d*rmucos(3, 0)*(&
&              rmucos(2, 0)**2-rmusin(2, 0)**2)*sinphase(2, 0)*rphase(2)
            hess(3) = hess(3) - rmu(2, 0)*fun0*cost3d*rmucos(2, 0)*(&
&              rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(2) = hess(2) + (-(rmu(3, 0)*cost3d*rmucos(3, 0)*(4.d0*&
&              pi/cellscale(2)*fun0*rmusin(2, 0)*rmucos(2, 0)+fun*(rmusin&
&              (2, 0)**2-rmucos(2, 0)**2)*rmu(2, 0)*rmucos(2, 0))))*&
&              cosphase(0)
            hess(3) = hess(3) + (-(rmu(2, 0)*cost3d*rmucos(2, 0)*(4.d0*&
&              pi/cellscale(3)*fun0*rmusin(3, 0)*rmucos(3, 0)+fun*(rmusin&
&              (3, 0)**2-rmucos(3, 0)**2)*rmu(3, 0)*rmucos(3, 0))))*&
&              cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
          ELSE IF (ic .EQ. 5) THEN
            hess(1) = hess(1) - rmu(3, 0)*fun0*cost3d*rmucos(3, 0)*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(3) = hess(3) - rmu(1, 0)*fun0*cost3d*rmucos(1, 0)*(&
&              rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(1) = hess(1) + (-(rmu(3, 0)*cost3d*rmucos(3, 0)*(4.d0*&
&              pi/cellscale(1)*fun0*rmusin(1, 0)*rmucos(1, 0)+fun*(rmusin&
&              (1, 0)**2-rmucos(1, 0)**2)*rmu(1, 0)*rmucos(1, 0))))*&
&              cosphase(0)
            hess(3) = hess(3) + (-(rmu(1, 0)*cost3d*rmucos(1, 0)*(4.d0*&
&              pi/cellscale(3)*fun0*rmusin(3, 0)*rmucos(3, 0)+fun*(rmusin&
&              (3, 0)**2-rmucos(3, 0)**2)*rmu(3, 0)*rmucos(3, 0))))*&
&              cosphase(0)
!endif for ic
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
          END IF
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hessb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      hess3db = 0.0_8
      DO ic=5,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb(:) = hessb(:) + zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 3) THEN
            IF (branch .LT. 2) THEN
              IF (branch .LT. 1) THEN
                temp341b = cosphase(0)*hessb(3)
                temp340 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                temp341b0 = cost1d*6.d0*temp341b
                temp340b = fun0*2*temp340*temp341b0
                temp336 = fun0/cellscale(3)
                temp339 = rmucos(3, 0)**2*temp336
                temp338 = rmu(3, 0)*rmusin(3, 0)
                temp337 = 4.d0*cost1d*pi*6.d0
                temp337b = -(temp337*temp341b)
                temp336b = temp338*rmucos(3, 0)**2*temp337b/cellscale(3)
                temp335 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                temp334 = rmucos(3, 0)**2
                temp333 = rmu(3, 0)**2
                temp332 = temp333*fun*temp334
                temp333b = cost1d*6.d0*temp341b
                temp332b = temp335*temp333b
                temp331 = rmu(3, 0)*rmucos(3, 0)
                temp331b = -(cost1d*6.d0*hessb(3))
                temp331b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp331b
                temp330b = temp331*temp331b0
                temp328 = rmu(3, 0)*rmucos(3, 0)
                temp328b0 = cost1d*6.d0*zb(indorbp, indt+3)
                temp328b1 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp328b0
                fun0b = fun0b + sinphase(3, 0)*rphase(3)*temp330b + &
&                  temp328*cosphase(0)*temp328b1 + temp336b + temp340**2*&
&                  temp341b0
                temp330 = sinphase(3, 0)*fun0*rphase(3)
                temp331b1 = temp331*temp330*temp331b
                temp329 = fun0*cosphase(0)
                temp328b2 = temp328*temp329*temp328b0
                rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp331b1&
&                  + temp330*rmu(3, 0)*temp331b0 + 2*rmucos(3, 0)*&
&                  temp328b2 + temp329*rmu(3, 0)*temp328b1 + temp332*2*&
&                  rmucos(3, 0)*temp333b + temp333*fun*2*rmucos(3, 0)*&
&                  temp332b + temp338*temp336*2*rmucos(3, 0)*temp337b + 2&
&                  *rmucos(3, 0)*temp340b
                rmusinb(3, 0) = rmusinb(3, 0) + temp339*rmu(3, 0)*&
&                  temp337b - 2*rmusin(3, 0)*temp328b2 - temp332*2*rmusin&
&                  (3, 0)*temp333b - 2*rmusin(3, 0)*temp331b1 - 2*rmusin(&
&                  3, 0)*temp340b
                rmub(3, 0) = rmub(3, 0) + temp330*rmucos(3, 0)*temp331b0&
&                  + temp329*rmucos(3, 0)*temp328b1 + temp334*fun*2*rmu(3&
&                  , 0)*temp332b + temp339*rmusin(3, 0)*temp337b
                cellscaleb(3) = cellscaleb(3) - temp336*temp336b
                funb = funb + temp334*temp333*temp332b
                cosphaseb(0) = cosphaseb(0) + temp328*fun0*temp328b1 + (&
&                  cost1d*6.d0*(fun0*temp340**2)-temp337*(temp338*temp339&
&                  )+cost1d*6.d0*(temp332*temp335))*hessb(3)
                sinphaseb(3, 0) = sinphaseb(3, 0) + fun0*rphase(3)*&
&                  temp330b
                rphaseb(3) = rphaseb(3) + sinphase(3, 0)*fun0*temp330b
                DO i=3,1,-1
                  temp328b = cosphase(0)*hessb(i)
                  temp327 = rmucos(i, 0)**2 - rmusin(i, 0)**2
                  temp327b = -(cost1d*2.d0*temp328b)
                  temp326 = rmu(i, 0)**2
                  temp326b = -(cost1d*2.d0*temp328b)
                  temp326b0 = rmucos(i, 0)**2*temp326b
                  temp326b1 = cost1d*2.d0*hessb(i)
                  temp326b2 = rmu(i, 0)*rmucos(i, 0)*temp326b1
                  temp326b3 = sinphase(i, 0)*temp326b2
                  temp326b4 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  temp326b5 = rmu(i, 0)*rmucos(i, 0)*temp326b4
                  fun0b = fun0b + rphase(i)*temp326b3 + cosphase(0)*&
&                    temp326b5 + temp327*temp327b
                  temp326b6 = sinphase(i, 0)*fun0*rphase(i)*temp326b1
                  temp326b7 = fun0*cosphase(0)*temp326b4
                  rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp326b6 + &
&                    rmu(i, 0)*temp326b7 + fun*temp326*2*rmucos(i, 0)*&
&                    temp326b + fun0*2*rmucos(i, 0)*temp327b
                  rmusinb(i, 0) = rmusinb(i, 0) - fun0*2*rmusin(i, 0)*&
&                    temp327b
                  funb = funb + temp326*temp326b0
                  rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp326b6 + &
&                    rmucos(i, 0)*temp326b7 + fun*2*rmu(i, 0)*temp326b0
                  cosphaseb(0) = cosphaseb(0) + fun0*temp326b5 + (-(&
&                    cost1d*2.d0*(fun0*temp327))-cost1d*2.d0*(fun*temp326&
&                    *rmucos(i, 0)**2))*hessb(i)
                  sinphaseb(i, 0) = sinphaseb(i, 0) + fun0*rphase(i)*&
&                    temp326b2
                  rphaseb(i) = rphaseb(i) + fun0*temp326b3
                END DO
              ELSE
                temp367b = cosphase(0)*hessb(2)
                temp363 = fun0/cellscale(2)
                temp366 = rmucos(2, 0)**2*temp363
                temp365 = rmu(2, 0)*rmusin(2, 0)
                temp364 = 4.d0*cost2d*pi*2.d0
                temp364b = temp364*temp367b
                temp363b = temp365*rmucos(2, 0)**2*temp364b/cellscale(2)
                temp362 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp363b0 = -(cost2d*2.d0*temp367b)
                temp362b = fun0*2*temp362*temp363b0
                temp361 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp360 = rmucos(2, 0)**2
                temp359 = rmu(2, 0)**2
                temp358 = temp359*fun*temp360
                temp359b = -(cost2d*2.d0*temp367b)
                temp358b = temp361*temp359b
                rmub(2, 0) = rmub(2, 0) + temp360*fun*2*rmu(2, 0)*&
&                  temp358b + temp366*rmusin(2, 0)*temp364b
                rmusinb(2, 0) = rmusinb(2, 0) + temp366*rmu(2, 0)*&
&                  temp364b - 2*rmusin(2, 0)*temp362b - temp358*2*rmusin(&
&                  2, 0)*temp359b
                rmucosb(2, 0) = rmucosb(2, 0) + temp358*2*rmucos(2, 0)*&
&                  temp359b + temp359*fun*2*rmucos(2, 0)*temp358b + 2*&
&                  rmucos(2, 0)*temp362b + temp365*temp363*2*rmucos(2, 0)&
&                  *temp364b
                temp358b0 = cosphase(0)*hessb(1)
                temp353 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp354b = cost2d*2.d0*temp358b0
                temp351 = rmu(1, 0)*rmusin(1, 0)
                temp350 = 4.d0*cost2d*pi*2.d0
                temp350b = -(temp350*temp358b0)
                temp349b = temp351*rmucos(1, 0)**2*temp350b/cellscale(1)
                temp348 = rmu(2, 0)*rmucos(2, 0)
                temp348b = cost2d*2.d0*hessb(2)
                temp348b0 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp348b
                temp347b = temp348*temp348b0
                temp345 = rmu(2, 0)*rmucos(2, 0)
                temp345b = -(cost2d*2.d0*zb(indorbp, indt+2))
                temp345b0 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp345b
                temp344 = rmu(1, 0)*rmucos(1, 0)
                temp344b = -(cost2d*2.d0*hessb(1))
                temp344b0 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp344b
                temp343b = temp344*temp344b0
                temp341 = rmu(1, 0)*rmucos(1, 0)
                temp341b1 = cost2d*2.d0*zb(indorbp, indt+1)
                temp341b2 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp341b1
                fun0b = fun0b + temp353**2*temp354b + temp349b + temp345&
&                  *cosphase(0)*temp345b0 + temp341*cosphase(0)*temp341b2&
&                  + sinphase(1, 0)*rphase(1)*temp343b + sinphase(2, 0)*&
&                  rphase(2)*temp347b + temp362**2*temp363b0 + temp363b
                cellscaleb(2) = cellscaleb(2) - temp363*temp363b
                temp357 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp356 = rmucos(1, 0)**2
                temp355 = rmu(1, 0)**2
                temp355b = cost2d*2.d0*temp358b0
                temp354b0 = temp357*temp355b
                funb = funb + temp356*temp355*temp354b0 + temp360*&
&                  temp359*temp358b
                temp354 = temp355*fun*temp356
                temp349 = fun0/cellscale(1)
                temp352 = rmucos(1, 0)**2*temp349
                cosphaseb(0) = cosphaseb(0) + (cost2d*2.d0*(temp354*&
&                  temp357)+cost2d*2.d0*(fun0*temp353**2)-temp350*(&
&                  temp351*temp352))*hessb(1) + temp341*fun0*temp341b2 + &
&                  temp345*fun0*temp345b0 + (temp364*(temp365*temp366)-&
&                  cost2d*2.d0*(fun0*temp362**2)-cost2d*2.d0*(temp358*&
&                  temp361))*hessb(2)
                temp353b = fun0*2*temp353*temp354b
                rmub(1, 0) = rmub(1, 0) + temp352*rmusin(1, 0)*temp350b &
&                  + temp356*fun*2*rmu(1, 0)*temp354b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp351*temp349*2*rmucos&
&                  (1, 0)*temp350b + 2*rmucos(1, 0)*temp353b + temp354*2*&
&                  rmucos(1, 0)*temp355b + temp355*fun*2*rmucos(1, 0)*&
&                  temp354b0
                rmusinb(1, 0) = rmusinb(1, 0) + temp352*rmu(1, 0)*&
&                  temp350b - 2*rmusin(1, 0)*temp353b - temp354*2*rmusin(&
&                  1, 0)*temp355b
                cellscaleb(1) = cellscaleb(1) - temp349*temp349b
                temp347 = sinphase(2, 0)*fun0*rphase(2)
                temp348b1 = temp348*temp347*temp348b
                temp346 = fun0*cosphase(0)
                temp345b1 = temp345*temp346*temp345b
                rmucosb(2, 0) = rmucosb(2, 0) + temp346*rmu(2, 0)*&
&                  temp345b0 + 2*rmucos(2, 0)*temp345b1 + temp347*rmu(2, &
&                  0)*temp348b0 + 2*rmucos(2, 0)*temp348b1
                rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp345b1&
&                  - 2*rmusin(2, 0)*temp348b1
                rmub(2, 0) = rmub(2, 0) + temp346*rmucos(2, 0)*temp345b0&
&                  + temp347*rmucos(2, 0)*temp348b0
                sinphaseb(2, 0) = sinphaseb(2, 0) + fun0*rphase(2)*&
&                  temp347b
                rphaseb(2) = rphaseb(2) + sinphase(2, 0)*fun0*temp347b
                temp343 = sinphase(1, 0)*fun0*rphase(1)
                temp344b1 = temp344*temp343*temp344b
                temp342 = fun0*cosphase(0)
                temp341b3 = temp341*temp342*temp341b1
                rmucosb(1, 0) = rmucosb(1, 0) + temp342*rmu(1, 0)*&
&                  temp341b2 + 2*rmucos(1, 0)*temp341b3 + temp343*rmu(1, &
&                  0)*temp344b0 + 2*rmucos(1, 0)*temp344b1
                rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp341b3&
&                  - 2*rmusin(1, 0)*temp344b1
                rmub(1, 0) = rmub(1, 0) + temp342*rmucos(1, 0)*temp341b2&
&                  + temp343*rmucos(1, 0)*temp344b0
                sinphaseb(1, 0) = sinphaseb(1, 0) + fun0*rphase(1)*&
&                  temp343b
                rphaseb(1) = rphaseb(1) + sinphase(1, 0)*fun0*temp343b
              END IF
            ELSE
              temp384 = fun*rmu(1, 0)*rmucos(1, 0)
              temp383 = rmusin(1, 0)**2 - rmucos(1, 0)**2
              temp380 = fun0/cellscale(1)
              temp382 = rmusin(1, 0)*rmucos(1, 0)
              temp381 = rmu(2, 0)*cosphase(0)
              temp381b = -(cost3d*(pi*4.d0*(temp382*temp380)+temp383*&
&                temp384)*hessb(1))
              temp381b0 = -(cost3d*temp381*rmucos(2, 0)*hessb(1))
              temp381b1 = pi*4.d0*temp381b0
              temp380b = temp382*temp381b1/cellscale(1)
              temp380b0 = temp383*rmucos(1, 0)*temp381b0
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*cosphase(0)*&
&                temp381b
              temp379 = fun*rmu(2, 0)*rmucos(2, 0)
              temp378 = rmusin(2, 0)**2 - rmucos(2, 0)**2
              temp375 = fun0/cellscale(2)
              temp377 = rmusin(2, 0)*rmucos(2, 0)
              temp376b = -(cost3d*(pi*4.d0*(temp377*temp375)+temp378*&
&                temp379)*hessb(2))
              temp371 = rmu(1, 0)*rmucos(1, 0)
              temp371b = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*zb(&
&                indorbp, indt+2)
              temp367 = rmu(2, 0)*rmucos(2, 0)
              temp367b0 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*zb(&
&                indorbp, indt+1)
              cosphaseb(0) = cosphaseb(0) + rmucos(1, 0)*rmu(1, 0)*&
&                temp376b + temp367*fun0*temp367b0 + temp371*fun0*&
&                temp371b + rmucos(2, 0)*rmu(2, 0)*temp381b
              rmucosb(2, 0) = rmucosb(2, 0) + temp381*temp381b
              rmusinb(1, 0) = rmusinb(1, 0) + temp384*2*rmusin(1, 0)*&
&                temp381b0 + temp380*rmucos(1, 0)*temp381b1
              temp376 = rmu(1, 0)*cosphase(0)
              rmucosb(1, 0) = rmucosb(1, 0) + temp376*temp376b + (&
&                temp383*fun*rmu(1, 0)-temp384*2*rmucos(1, 0))*temp381b0 &
&                + temp380*rmusin(1, 0)*temp381b1
              temp376b0 = -(cost3d*temp376*rmucos(1, 0)*hessb(2))
              temp376b1 = pi*4.d0*temp376b0
              temp375b = temp377*temp376b1/cellscale(2)
              temp373 = rmu(1, 0)*rmucos(1, 0)
              temp373b = -(cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                hessb(2))
              temp373b0 = temp373*sinphase(2, 0)*temp373b
              temp369 = rmu(2, 0)*rmucos(2, 0)
              temp369b = -(cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                hessb(1))
              temp369b0 = temp369*sinphase(1, 0)*temp369b
              fun0b = fun0b + temp375b + temp371*cosphase(0)*temp371b + &
&                temp367*cosphase(0)*temp367b0 + rphase(1)*temp369b0 + &
&                rphase(2)*temp373b0 + temp380b
              cellscaleb(1) = cellscaleb(1) - temp380*temp380b
              temp375b0 = temp378*rmucos(2, 0)*temp376b0
              funb = funb + rmu(2, 0)*temp375b0 + rmu(1, 0)*temp380b0
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*cosphase(0)*&
&                temp376b + fun*temp380b0
              temp374 = sinphase(2, 0)*fun0*rphase(2)
              temp373b1 = -(cost3d*temp373*temp374*hessb(2))
              temp372 = fun0*cosphase(0)
              temp371b0 = cost3d*temp371*temp372*zb(indorbp, indt+2)
              rmusinb(2, 0) = rmusinb(2, 0) + temp379*2*rmusin(2, 0)*&
&                temp376b0 - 2*rmusin(2, 0)*temp371b0 - 2*rmusin(2, 0)*&
&                temp373b1 + temp375*rmucos(2, 0)*temp376b1
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp373b1 +&
&                (temp378*fun*rmu(2, 0)-temp379*2*rmucos(2, 0))*temp376b0&
&                + temp375*rmusin(2, 0)*temp376b1
              cellscaleb(2) = cellscaleb(2) - temp375*temp375b
              rmub(2, 0) = rmub(2, 0) + fun*temp375b0
              rmub(1, 0) = rmub(1, 0) + temp372*rmucos(1, 0)*temp371b + &
&                temp374*rmucos(1, 0)*temp373b
              rmucosb(1, 0) = rmucosb(1, 0) + temp372*rmu(1, 0)*temp371b&
&                + temp374*rmu(1, 0)*temp373b
              sinphaseb(2, 0) = sinphaseb(2, 0) + temp373*fun0*rphase(2)&
&                *temp373b
              rphaseb(2) = rphaseb(2) + fun0*temp373b0
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp371b0
              temp370 = sinphase(1, 0)*fun0*rphase(1)
              temp369b1 = -(cost3d*temp369*temp370*hessb(1))
              rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp369b1
              temp368 = fun0*cosphase(0)
              temp367b1 = cost3d*temp367*temp368*zb(indorbp, indt+1)
              rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp367b1 -&
&                2*rmusin(1, 0)*temp369b1
              rmub(2, 0) = rmub(2, 0) + temp368*rmucos(2, 0)*temp367b0 +&
&                temp370*rmucos(2, 0)*temp369b
              rmucosb(2, 0) = rmucosb(2, 0) + temp368*rmu(2, 0)*&
&                temp367b0 + temp370*rmu(2, 0)*temp369b
              sinphaseb(1, 0) = sinphaseb(1, 0) + temp369*fun0*rphase(1)&
&                *temp369b
              rphaseb(1) = rphaseb(1) + fun0*temp369b0
              rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp367b1
            END IF
          ELSE IF (branch .LT. 5) THEN
            IF (branch .LT. 4) THEN
              temp402 = fun*rmu(3, 0)*rmucos(3, 0)
              temp401 = rmusin(3, 0)**2 - rmucos(3, 0)**2
              temp398 = fun0/cellscale(3)
              temp400 = rmusin(3, 0)*rmucos(3, 0)
              temp399 = rmu(2, 0)*cosphase(0)
              temp399b = -(cost3d*(pi*4.d0*(temp400*temp398)+temp401*&
&                temp402)*hessb(3))
              temp399b0 = -(cost3d*temp399*rmucos(2, 0)*hessb(3))
              temp399b1 = pi*4.d0*temp399b0
              temp398b = temp400*temp399b1/cellscale(3)
              temp398b0 = temp401*rmucos(3, 0)*temp399b0
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*cosphase(0)*&
&                temp399b
              temp397 = fun*rmu(2, 0)*rmucos(2, 0)
              temp396 = rmusin(2, 0)**2 - rmucos(2, 0)**2
              temp393 = fun0/cellscale(2)
              temp395 = rmusin(2, 0)*rmucos(2, 0)
              temp394b = -(cost3d*(pi*4.d0*(temp395*temp393)+temp396*&
&                temp397)*hessb(2))
              temp389 = rmu(2, 0)*rmucos(2, 0)
              temp389b = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*zb(&
&                indorbp, indt+3)
              temp385 = rmu(3, 0)*rmucos(3, 0)
              temp385b = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*zb(&
&                indorbp, indt+2)
              cosphaseb(0) = cosphaseb(0) + rmucos(3, 0)*rmu(3, 0)*&
&                temp394b + temp385*fun0*temp385b + temp389*fun0*temp389b&
&                + rmucos(2, 0)*rmu(2, 0)*temp399b
              rmucosb(2, 0) = rmucosb(2, 0) + temp399*temp399b
              rmusinb(3, 0) = rmusinb(3, 0) + temp402*2*rmusin(3, 0)*&
&                temp399b0 + temp398*rmucos(3, 0)*temp399b1
              temp394 = rmu(3, 0)*cosphase(0)
              rmucosb(3, 0) = rmucosb(3, 0) + temp394*temp394b + (&
&                temp401*fun*rmu(3, 0)-temp402*2*rmucos(3, 0))*temp399b0 &
&                + temp398*rmusin(3, 0)*temp399b1
              temp394b0 = -(cost3d*temp394*rmucos(3, 0)*hessb(2))
              temp394b1 = pi*4.d0*temp394b0
              temp393b = temp395*temp394b1/cellscale(2)
              temp391 = rmu(2, 0)*rmucos(2, 0)
              temp391b = -(cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                hessb(3))
              temp391b0 = temp391*sinphase(3, 0)*temp391b
              temp387 = rmu(3, 0)*rmucos(3, 0)
              temp387b = -(cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                hessb(2))
              temp387b0 = temp387*sinphase(2, 0)*temp387b
              fun0b = fun0b + temp393b + temp389*cosphase(0)*temp389b + &
&                temp385*cosphase(0)*temp385b + rphase(2)*temp387b0 + &
&                rphase(3)*temp391b0 + temp398b
              cellscaleb(3) = cellscaleb(3) - temp398*temp398b
              temp393b0 = temp396*rmucos(2, 0)*temp394b0
              funb = funb + rmu(2, 0)*temp393b0 + rmu(3, 0)*temp398b0
              rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*cosphase(0)*&
&                temp394b + fun*temp398b0
              rmusinb(2, 0) = rmusinb(2, 0) + temp397*2*rmusin(2, 0)*&
&                temp394b0 + temp393*rmucos(2, 0)*temp394b1
              rmucosb(2, 0) = rmucosb(2, 0) + (temp396*fun*rmu(2, 0)-&
&                temp397*2*rmucos(2, 0))*temp394b0 + temp393*rmusin(2, 0)&
&                *temp394b1
              cellscaleb(2) = cellscaleb(2) - temp393*temp393b
              temp392 = sinphase(3, 0)*fun0*rphase(3)
              temp390 = fun0*cosphase(0)
              rmub(2, 0) = rmub(2, 0) + temp392*rmucos(2, 0)*temp391b + &
&                temp390*rmucos(2, 0)*temp389b + fun*temp393b0
              temp391b1 = -(cost3d*temp391*temp392*hessb(3))
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp391b1
              temp389b0 = cost3d*temp389*temp390*zb(indorbp, indt+3)
              rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp389b0 -&
&                2*rmusin(3, 0)*temp391b1
              rmucosb(2, 0) = rmucosb(2, 0) + temp390*rmu(2, 0)*temp389b&
&                + temp392*rmu(2, 0)*temp391b
              sinphaseb(3, 0) = sinphaseb(3, 0) + temp391*fun0*rphase(3)&
&                *temp391b
              rphaseb(3) = rphaseb(3) + fun0*temp391b0
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp389b0
              temp388 = sinphase(2, 0)*fun0*rphase(2)
              temp387b1 = -(cost3d*temp387*temp388*hessb(2))
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp387b1
              temp386 = fun0*cosphase(0)
              temp385b0 = cost3d*temp385*temp386*zb(indorbp, indt+2)
              rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp385b0 -&
&                2*rmusin(2, 0)*temp387b1
              rmub(3, 0) = rmub(3, 0) + temp386*rmucos(3, 0)*temp385b + &
&                temp388*rmucos(3, 0)*temp387b
              rmucosb(3, 0) = rmucosb(3, 0) + temp386*rmu(3, 0)*temp385b&
&                + temp388*rmu(3, 0)*temp387b
              sinphaseb(2, 0) = sinphaseb(2, 0) + temp387*fun0*rphase(2)&
&                *temp387b
              rphaseb(2) = rphaseb(2) + fun0*temp387b0
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp385b0
            END IF
          ELSE
            temp420 = fun*rmu(3, 0)*rmucos(3, 0)
            temp419 = rmusin(3, 0)**2 - rmucos(3, 0)**2
            temp416 = fun0/cellscale(3)
            temp418 = rmusin(3, 0)*rmucos(3, 0)
            temp417 = rmu(1, 0)*cosphase(0)
            temp417b = -(cost3d*(pi*4.d0*(temp418*temp416)+temp419*&
&              temp420)*hessb(3))
            temp417b0 = -(cost3d*temp417*rmucos(1, 0)*hessb(3))
            temp417b1 = pi*4.d0*temp417b0
            temp416b = temp418*temp417b1/cellscale(3)
            temp416b0 = temp419*rmucos(3, 0)*temp417b0
            rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*cosphase(0)*temp417b
            temp415 = fun*rmu(1, 0)*rmucos(1, 0)
            temp414 = rmusin(1, 0)**2 - rmucos(1, 0)**2
            temp411 = fun0/cellscale(1)
            temp413 = rmusin(1, 0)*rmucos(1, 0)
            temp412b = -(cost3d*(pi*4.d0*(temp413*temp411)+temp414*&
&              temp415)*hessb(1))
            temp407 = rmu(1, 0)*rmucos(1, 0)
            temp407b = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*zb(&
&              indorbp, indt+3)
            temp403 = rmu(3, 0)*rmucos(3, 0)
            temp403b = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*zb(&
&              indorbp, indt+1)
            cosphaseb(0) = cosphaseb(0) + rmucos(3, 0)*rmu(3, 0)*&
&              temp412b + temp403*fun0*temp403b + temp407*fun0*temp407b +&
&              rmucos(1, 0)*rmu(1, 0)*temp417b
            rmucosb(1, 0) = rmucosb(1, 0) + temp417*temp417b
            rmusinb(3, 0) = rmusinb(3, 0) + temp420*2*rmusin(3, 0)*&
&              temp417b0 + temp416*rmucos(3, 0)*temp417b1
            temp412 = rmu(3, 0)*cosphase(0)
            rmucosb(3, 0) = rmucosb(3, 0) + temp412*temp412b + (temp419*&
&              fun*rmu(3, 0)-temp420*2*rmucos(3, 0))*temp417b0 + temp416*&
&              rmusin(3, 0)*temp417b1
            temp412b0 = -(cost3d*temp412*rmucos(3, 0)*hessb(1))
            temp412b1 = pi*4.d0*temp412b0
            temp411b = temp413*temp412b1/cellscale(1)
            temp409 = rmu(1, 0)*rmucos(1, 0)
            temp409b = -(cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hessb(&
&              3))
            temp409b0 = temp409*sinphase(3, 0)*temp409b
            temp405 = rmu(3, 0)*rmucos(3, 0)
            temp405b = -(cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hessb(&
&              1))
            temp405b0 = temp405*sinphase(1, 0)*temp405b
            fun0b = fun0b + temp411b + temp407*cosphase(0)*temp407b + &
&              temp403*cosphase(0)*temp403b + rphase(1)*temp405b0 + &
&              rphase(3)*temp409b0 + temp416b
            cellscaleb(3) = cellscaleb(3) - temp416*temp416b
            temp411b0 = temp414*rmucos(1, 0)*temp412b0
            funb = funb + rmu(1, 0)*temp411b0 + rmu(3, 0)*temp416b0
            rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*cosphase(0)*temp412b &
&              + fun*temp416b0
            rmusinb(1, 0) = rmusinb(1, 0) + temp415*2*rmusin(1, 0)*&
&              temp412b0 + temp411*rmucos(1, 0)*temp412b1
            rmucosb(1, 0) = rmucosb(1, 0) + (temp414*fun*rmu(1, 0)-&
&              temp415*2*rmucos(1, 0))*temp412b0 + temp411*rmusin(1, 0)*&
&              temp412b1
            cellscaleb(1) = cellscaleb(1) - temp411*temp411b
            temp410 = sinphase(3, 0)*fun0*rphase(3)
            temp408 = fun0*cosphase(0)
            rmub(1, 0) = rmub(1, 0) + temp410*rmucos(1, 0)*temp409b + &
&              temp408*rmucos(1, 0)*temp407b + fun*temp411b0
            temp409b1 = -(cost3d*temp409*temp410*hessb(3))
            rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp409b1
            temp407b0 = cost3d*temp407*temp408*zb(indorbp, indt+3)
            rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp407b0 - 2&
&              *rmusin(3, 0)*temp409b1
            rmucosb(1, 0) = rmucosb(1, 0) + temp408*rmu(1, 0)*temp407b +&
&              temp410*rmu(1, 0)*temp409b
            sinphaseb(3, 0) = sinphaseb(3, 0) + temp409*fun0*rphase(3)*&
&              temp409b
            rphaseb(3) = rphaseb(3) + fun0*temp409b0
            rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp407b0
            temp406 = sinphase(1, 0)*fun0*rphase(1)
            temp405b1 = -(cost3d*temp405*temp406*hessb(1))
            rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp405b1
            temp404 = fun0*cosphase(0)
            temp403b0 = cost3d*temp403*temp404*zb(indorbp, indt+1)
            rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp403b0 - 2&
&              *rmusin(1, 0)*temp405b1
            rmub(3, 0) = rmub(3, 0) + temp404*rmucos(3, 0)*temp403b + &
&              temp406*rmucos(3, 0)*temp405b
            rmucosb(3, 0) = rmucosb(3, 0) + temp404*rmu(3, 0)*temp403b +&
&              temp406*rmu(3, 0)*temp405b
            sinphaseb(1, 0) = sinphaseb(1, 0) + temp405*fun0*rphase(1)*&
&              temp405b
            rphaseb(1) = rphaseb(1) + fun0*temp405b0
            rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp403b0
          END IF
          DO i=3,1,-1
            temp325 = fun*rphase(i)
            temp324 = rmu(i, 0)*rmucos(i, 0)
            temp324b = -(temp324*temp325*hessb(i))
            temp324b0 = -(distp(0, 1+ic)*sinphase(i, 0)*hessb(i))
            temp324b1 = -(rphase(i)**2*hessb(i))
            temp324b2 = distp(0, 1+ic)*temp324b1
            temp323 = sinphase(i, 0)*rmu(i, 0)
            temp322 = fun*rphase(i)
            temp322b = -(temp322*temp323*hessb(i))
            temp322b0 = -(distp(0, 1+ic)*rmucos(i, 0)*hessb(i))
            temp322b1 = -(sinphase(i, 0)*hess3d(i, ic)*hessb(i))
            temp322b2 = -(fun0*rphase(i)*hessb(i))
            temp322b3 = cosphase(0)*hessb(i)
            temp321 = rmucos(i, 0)**2
            temp320 = rmu(i, 0)**2
            temp319 = rmucos(i, 0)**2 - rmusin(i, 0)**2
            temp318 = fun2*temp320*temp321 + fun*temp319
            temp316b24 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
            temp316b25 = -(fun0*rphase(i)*zb(indorbp, indt+i))
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp318*temp322b3 + &
&              sinphase(i, 0)*temp316b25 + fun*cosphase(0)*temp316b24 + &
&              rmucos(i, 0)*temp322b + fun0*cosphase(0)*temp324b1 + &
&              sinphase(i, 0)*temp324b
            sinphaseb(i, 0) = sinphaseb(i, 0) + distp(0, 1+ic)*&
&              temp316b25 + hess3d(i, ic)*temp322b2 + temp322*rmu(i, 0)*&
&              temp322b0 + distp(0, 1+ic)*temp324b
            temp318b = distp(0, 1+ic)*temp322b3
            temp316 = hess3d(i, ic)*rmucos(i, 0)
            temp316b26 = distp(0, 1+ic)*fun*cosphase(0)*zb(indorbp, indt&
&              +i)
            rmub(i, 0) = rmub(i, 0) + temp321*fun2*2*rmu(i, 0)*temp318b &
&              + temp316*fun*temp322b3 + rmucos(i, 0)*temp316b26 + &
&              temp322*sinphase(i, 0)*temp322b0 + temp325*rmucos(i, 0)*&
&              temp324b0
            temp317 = fun*rmu(i, 0)
            rmucosb(i, 0) = rmucosb(i, 0) + (fun*2*rmucos(i, 0)+fun2*&
&              temp320*2*rmucos(i, 0))*temp318b + temp317*hess3d(i, ic)*&
&              temp322b3 + rmu(i, 0)*temp316b26 + distp(0, 1+ic)*temp322b&
&              + temp325*rmu(i, 0)*temp324b0
            temp316b27 = distp(0, 1+ic)*temp316b24
            funb = funb + temp319*temp318b + temp316*rmu(i, 0)*temp322b3&
&              + cosphase(0)*temp316b27 + temp323*rphase(i)*temp322b0 + &
&              temp324*rphase(i)*temp324b0
            temp316b28 = -(distp(0, 1+ic)*sinphase(i, 0)*zb(indorbp, &
&              indt+i))
            rphaseb(i) = rphaseb(i) + fun0*temp316b28 + fun0*temp322b1 +&
&              temp323*fun*temp322b0 - distp(0, 1+ic)*fun0*cosphase(0)*2*&
&              rphase(i)*hessb(i) + temp324*fun*temp324b0
            fun0b = fun0b + rphase(i)*temp316b28 + rphase(i)*temp322b1 +&
&              cosphase(0)*temp324b2
            cosphaseb(0) = cosphaseb(0) + (temp318*distp(0, 1+ic)+&
&              temp316*temp317)*hessb(i) + fun*temp316b27 + fun0*&
&              temp324b2
            hess3db(i, ic) = hess3db(i, ic) + temp317*rmucos(i, 0)*&
&              temp322b3 + sinphase(i, 0)*temp322b2
            fun2b = fun2b + temp321*temp320*temp318b
            rmusinb(i, 0) = rmusinb(i, 0) - fun*2*rmusin(i, 0)*temp318b
            hessb(i) = 0.0_8
            zb(indorbp, indt+i) = 0.D0
          END DO
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      temp316b = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hess3db(3, 5)
      temp316b0 = cost3d*rmu(1, 0)*rmucos(1, 0)*hess3db(3, 5)
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp316b
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp316b
      hess3db(3, 5) = 0.0_8
      temp316b1 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hess3db(1, 5)
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp316b1 + 2*rmucos(3, &
&        0)*temp316b0
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp316b0
      temp316b2 = cost3d*rmu(3, 0)*rmucos(3, 0)*hess3db(1, 5)
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp316b1
      rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp316b2
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp316b2
      hess3db(1, 5) = 0.0_8
      temp316b3 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hess3db(3, 4)
      temp316b4 = cost3d*rmu(2, 0)*rmucos(2, 0)*hess3db(3, 4)
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp316b3
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp316b3
      hess3db(3, 4) = 0.0_8
      temp316b5 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*hess3db(2, 4)
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp316b5 + 2*rmucos(3, &
&        0)*temp316b4
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp316b4
      temp316b6 = cost3d*rmu(3, 0)*rmucos(3, 0)*hess3db(2, 4)
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp316b5
      hess3db(2, 4) = 0.0_8
      temp316b7 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hess3db(1, 3)
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp316b7 + 2*rmucos(2, &
&        0)*temp316b6
      rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp316b6
      temp316b8 = cost3d*rmu(2, 0)*rmucos(2, 0)*hess3db(1, 3)
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp316b7
      hess3db(1, 3) = 0.0_8
      temp316b9 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*hess3db(2, 3)
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp316b9 + 2*rmucos(1, &
&        0)*temp316b8
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp316b8
      temp316b10 = cost3d*rmu(1, 0)*rmucos(1, 0)*hess3db(2, 3)
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp316b9
      hess3db(2, 3) = 0.0_8
      temp316b11 = -(cost2d*2.d0*hess3db(2, 2))
      temp316b12 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp316b11
      temp316b13 = rmu(2, 0)*rmucos(2, 0)*temp316b11
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp316b12 + 2*rmucos(2&
&        , 0)*temp316b13 + 2*rmucos(2, 0)*temp316b10
      rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp316b13 - 2*&
&        rmusin(2, 0)*temp316b10
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp316b12
      hess3db(2, 2) = 0.0_8
      temp316b14 = cost2d*2.d0*hess3db(1, 2)
      temp316b15 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp316b14
      temp316b16 = rmu(1, 0)*rmucos(1, 0)*temp316b14
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp316b15
      rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp316b16 + rmu(1&
&        , 0)*temp316b15
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp316b16
      hess3db(1, 2) = 0.0_8
      temp316b17 = cost1d*6.d0*hess3db(3, 1)
      temp316b18 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp316b17
      temp316b19 = rmu(3, 0)*rmucos(3, 0)*temp316b17
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp316b18
      rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp316b19 + rmu(3&
&        , 0)*temp316b18
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp316b19
      temp316b20 = -(cost1d*2.d0*hess3db(:, 1))
      rmub(:, 0) = rmub(:, 0) + rmucos(:, 0)*temp316b20
      rmucosb(:, 0) = rmucosb(:, 0) + rmu(:, 0)*temp316b20
      temp316b21 = -(2.d0**2*dd1*distp(0, 1)*fun2b)
      temp316b22 = -(2.d0*(2.d0*(dd1*r(0)**2)-11.d0/2.d0)*fun2b)
      temp315 = 4.d0*dd1
      temp314 = 7.d0/temp315
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-11.d0/2.d0)*funb&
&        + (temp314-r(0)**2)*fun0b + dd1*temp316b22 + 4.d0*dd1*fun2b
      temp316b23 = distp(0, 1)*2.d0*funb
      dd1b = r(0)**2*temp316b23 - distp(0, 1)*temp314*4.d0*fun0b/temp315&
&        + distp(0, 1)*temp316b22 + r(0)**2*temp316b21 + 4.d0*distp(0, 1)&
&        *fun2b
      rb(0) = rb(0) + dd1*2*r(0)*temp316b23 - distp(0, 1)*2*r(0)*fun0b +&
&        dd1*2*r(0)*temp316b21
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    dd1b = 0.0_8
    DO ic=5,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp313 = 4.d0*dd1
          temp312 = 7.d0/temp313
          temp312b = (temp312-r(k)**2)*zb(indorbp, k)
          temp311 = distp(k, 1+ic)
          temp310 = distp(k, 1)*cosphase(k)
          temp310b8 = temp310*temp311*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + temp311*cosphase(k)*temp312b
          cosphaseb(k) = cosphaseb(k) + temp311*distp(k, 1)*temp312b
          distpb(k, 1+ic) = distpb(k, 1+ic) + temp310*temp312b
          dd1b = dd1b - temp312*4.d0*temp310b8/temp313
          rb(k) = rb(k) - 2*r(k)*temp310b8
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp310b = cost3d*rmucos(1, i)*rmucos(3, i)*distpb(i, 6)
      temp310b0 = cost3d*rmu(1, i)*rmu(3, i)*distpb(i, 6)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp310b
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp310b
      rmucosb(1, i) = rmucosb(1, i) + rmucos(3, i)*temp310b0
      rmucosb(3, i) = rmucosb(3, i) + rmucos(1, i)*temp310b0
      distpb(i, 6) = 0.0_8
      temp310b1 = cost3d*rmucos(2, i)*rmucos(3, i)*distpb(i, 5)
      temp310b2 = cost3d*rmu(2, i)*rmu(3, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp310b1
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp310b1
      rmucosb(2, i) = rmucosb(2, i) + rmucos(3, i)*temp310b2
      rmucosb(3, i) = rmucosb(3, i) + rmucos(2, i)*temp310b2
      distpb(i, 5) = 0.0_8
      temp310b3 = cost3d*rmucos(1, i)*rmucos(2, i)*distpb(i, 4)
      temp310b4 = cost3d*rmu(1, i)*rmu(2, i)*distpb(i, 4)
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp310b3
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp310b3
      rmucosb(1, i) = rmucosb(1, i) + rmucos(2, i)*temp310b4
      rmucosb(2, i) = rmucosb(2, i) + rmucos(1, i)*temp310b4
      distpb(i, 4) = 0.0_8
      temp310b5 = cost2d*2*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      temp310b6 = -(cost2d*2*rmu(2, i)*rmucos(2, i)*distpb(i, 3))
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp310b5
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp310b5
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp310b6
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp310b6
      distpb(i, 3) = 0.0_8
      temp310b7 = cost1d*distpb(i, 2)
      rmub(3, i) = rmub(3, i) + 3.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp310b7
      rmucosb(3, i) = rmucosb(3, i) + 3.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp310b7
      rb(i) = rb(i) - 2*r(i)*temp310b7
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp309 = r(k)**2
      temp309b = c*DEXP(-(dd1*temp309))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp309))*distpb(k, 1)
      dd1b = dd1b - temp309*temp309b
      rb(k) = rb(k) - dd1*2*r(k)*temp309b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.64592278064948967213d0*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indpar+1) = -ddb(indpar+1)
  CASE (68)
! d single gaussian orbital
! radial R(r)= exp(-alpha r^2)
! normalized
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    IF (dd(indparp) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indparp) = dd(indparp)
    ELSE
      dd(indparp) = -dd(indparp)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
!         c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)
    c = dd1**1.75d0*1.64592278064948967213d0
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos with the minimal rmucos strategy
    DO i=0,0
      rp0 = r(i)**2
! lz=0
      distp(i, 2) = (3.d0*rmu(3, i)**2-rp0)*cost1d
! lz=+/-2
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*rmucos(1, i)*rmucos(2, i)*cost3d
! lz=+/-1
      distp(i, 5) = rmu(2, i)*rmu(3, i)*rmucos(2, i)*rmucos(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*rmucos(1, i)*rmucos(3, i)*cost3d
    END DO
! lz=+/-4
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,5
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*distp(k, 1+ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,5
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part ! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost1d*rmu(1, 0)*rmucos(1, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*2.d0*(-(rmucos(1, 0)**2)+rmusin(&
&                  1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost1d*rmu(2, 0)*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*2.d0*(-(rmucos(2, 0)**2)+rmusin(&
&                  2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 4.d0*cost1d*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*4.d0*(rmucos(3, 0)**2-rmusin(3, &
&                  0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost2d*rmu(1, 0)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2d*fun0*2.d0*(rmucos(1, 0)**2-rmusin(1, &
&                  0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2d*rmu(2, 0)*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2d*fun0*2.d0*(-(rmucos(2, 0)**2)+rmusin(&
&                  2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(2, 0)*rmucos(2, 0)*(rmucos(1, 0)**&
&                  2-rmusin(1, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(1)*rmu(2, 0)&
&                  *rmucos(1, 0)*rmucos(2, 0)*rmusin(1, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(1, 0)*rmucos(1, 0)*(rmucos(2, 0)**&
&                  2-rmusin(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(2)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmucos(2, 0)*rmusin(2, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(3, 0)*rmucos(3, 0)*(rmucos(2, 0)**&
&                  2-rmusin(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(2)*rmu(3, 0)&
&                  *rmucos(2, 0)*rmucos(3, 0)*rmusin(2, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(2, 0)*rmucos(2, 0)*(rmucos(3, 0)**&
&                  2-rmusin(3, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(3)*rmu(2, 0)&
&                  *rmucos(2, 0)*rmucos(3, 0)*rmusin(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost3d*rmu(3, 0)*rmucos(3, 0)*(rmucos(1, 0)**2-&
&                rmusin(1, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(1)*rmu(3, 0)*&
&                rmucos(1, 0)*rmucos(3, 0)*rmusin(1, 0))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost3d*rmu(1, 0)*rmucos(1, 0)*(rmucos(3, 0)**2-&
&                rmusin(3, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(3)*rmu(1, 0)*&
&                rmucos(1, 0)*rmucos(3, 0)*rmusin(3, 0))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*distp(0, 1+ic)*&
&              cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*distp(0, 1+ic)*sinphase(i, 0)*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=5,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp439b = -(distp(0, 1)*rphase(i)*zb(indorbp, indt+i))
            temp439b0 = -(distp(0, 1+ic)*sinphase(i, 0)*zb(indorbp, indt&
&              +i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp439b1 = -(distp(0, 1+ic)*rphase(i)**2*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + distp(0&
&              , 1)*temp439b1 + z(indorbp, indt+i)*zb(indorbp, indt+i)
            distpb(0, 1+ic) = distpb(0, 1+ic) + sinphase(i, 0)*temp439b
            temp439b2 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp439b2 + &
&              distp(0, 1+ic)*temp439b
            distpb(0, 1) = distpb(0, 1) + cosphase(0)*temp439b1 + rphase&
&              (i)*temp439b0
            temp439b3 = -(distp(0, 1)*cosphase(0)*hess4fb(1))
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp439b2 + distp(0&
&              , 1+ic)*2*rphase(i)*temp439b3 + distp(0, 1)*temp439b0
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + rphase(i)**2*temp439b3
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp438 = der4f(1)/cellscale(i)
            temp438b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp438*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp438b
            cellscaleb(i) = cellscaleb(i) - temp438*temp438b
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 8) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 2) THEN
                  IF (branch .LT. 1) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp426b0 = cost1d*2.d0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(1, 0)**&
&                      2-rmucos(1, 0)**2)*temp426b0
                    rmusinb(1, 0) = rmusinb(1, 0) + fun0*2*rmusin(1, 0)*&
&                      temp426b0
                    hess4fb(2) = 0.0_8
                    temp426b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp426b1 + fun0*der4fb(2)
                    temp426b2 = -(cost1d*2.d0*der4fb(2))
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp426b2 &
&                      - fun0*2*rmucos(1, 0)*temp426b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp426b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp426b2
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp426b3 = cost1d*2.d0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(2, 0)**&
&                      2-rmucos(2, 0)**2)*temp426b3
                    rmusinb(2, 0) = rmusinb(2, 0) + fun0*2*rmusin(2, 0)*&
&                      temp426b3
                    hess4fb(2) = 0.0_8
                    temp426b4 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp426b4 + fun0*der4fb(2)
                    temp426b5 = -(cost1d*2.d0*der4fb(2))
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp426b5 &
&                      - fun0*2*rmucos(2, 0)*temp426b3
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp426b4
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp426b5
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 3) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp426b6 = cost1d*4.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmucos(3, 0)**2-&
&                    rmusin(3, 0)**2)*temp426b6
                  hess4fb(2) = 0.0_8
                  temp426b7 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp426b7 + fun0*der4fb(2)
                  temp426b8 = cost1d*4.d0*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp426b8 + &
&                    fun0*2*rmucos(3, 0)*temp426b6
                  rmusinb(3, 0) = rmusinb(3, 0) - fun0*2*rmusin(3, 0)*&
&                    temp426b6
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp426b7
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp426b8
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp426b9 = cost2d*2.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmucos(1, 0)**2-&
&                    rmusin(1, 0)**2)*temp426b9
                  hess4fb(2) = 0.0_8
                  temp426b10 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp426b10 + fun0*der4fb(2)
                  temp426b11 = cost2d*2.d0*der4fb(2)
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp426b11 +&
&                    fun0*2*rmucos(1, 0)*temp426b9
                  rmusinb(1, 0) = rmusinb(1, 0) - fun0*2*rmusin(1, 0)*&
&                    temp426b9
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp426b10
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp426b11
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 6) THEN
                IF (branch .LT. 5) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp426b12 = cost2d*2.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(2, 0)**2-&
&                    rmucos(2, 0)**2)*temp426b12
                  rmusinb(2, 0) = rmusinb(2, 0) + fun0*2*rmusin(2, 0)*&
&                    temp426b12
                  hess4fb(2) = 0.0_8
                  temp426b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp426b13 + fun0*der4fb(2)
                  temp426b14 = -(cost2d*2.d0*der4fb(2))
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp426b14 -&
&                    fun0*2*rmucos(2, 0)*temp426b12
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp426b13
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp426b14
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 7) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp426 = fun0/cellscale(1)
                temp427 = rmu(2, 0)*rmucos(1, 0)
                temp427b = -(cost3d*4.d0*pi*hess4fb(2))
                temp427b0 = rmucos(2, 0)*rmusin(1, 0)*temp427b
                temp426b15 = temp427*temp427b0/cellscale(1)
                temp426b16 = temp427*temp426*temp427b
                rmub(2, 0) = rmub(2, 0) + temp426*rmucos(1, 0)*temp427b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp426*rmu(2, 0)*&
&                  temp427b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp426b15
                cellscaleb(1) = cellscaleb(1) - temp426*temp426b15
                hess4fb(2) = 0.0_8
                temp426b17 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp426b17 + fun0*der4fb(2)
                temp426b18 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                  der4fb(2)
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp426b18 + &
&                  rmusin(1, 0)*temp426b16
                temp426b19 = cost3d*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                rmusinb(1, 0) = rmusinb(1, 0) + rmucos(2, 0)*temp426b16 &
&                  - 2*rmusin(1, 0)*temp426b19
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp426b17
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp426b18
                rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*&
&                  temp426b19
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp428 = fun0/cellscale(2)
                temp429 = rmu(1, 0)*rmucos(1, 0)
                temp429b = -(cost3d*4.d0*pi*hess4fb(2))
                temp429b0 = rmucos(2, 0)*rmusin(2, 0)*temp429b
                temp428b = temp429*temp429b0/cellscale(2)
                temp428b0 = temp429*temp428*temp429b
                rmub(1, 0) = rmub(1, 0) + temp428*rmucos(1, 0)*temp429b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp428*rmu(1, 0)*&
&                  temp429b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp428b
                cellscaleb(2) = cellscaleb(2) - temp428*temp428b
                rmucosb(2, 0) = rmucosb(2, 0) + rmusin(2, 0)*temp428b0
                hess4fb(2) = 0.0_8
                temp428b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp428b1 + fun0*der4fb(2)
                temp428b2 = cost3d*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
                rmusinb(2, 0) = rmusinb(2, 0) + rmucos(2, 0)*temp428b0 -&
&                  2*rmusin(2, 0)*temp428b2
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp428b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp428b3 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                  der4fb(2)
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp428b3
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp428b3
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp428b2
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 11) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp430 = fun0/cellscale(2)
                temp431 = rmu(3, 0)*rmucos(2, 0)
                temp431b = -(cost3d*4.d0*pi*hess4fb(2))
                temp431b0 = rmucos(3, 0)*rmusin(2, 0)*temp431b
                temp430b = temp431*temp431b0/cellscale(2)
                temp430b0 = temp431*temp430*temp431b
                rmub(3, 0) = rmub(3, 0) + temp430*rmucos(2, 0)*temp431b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp430*rmu(3, 0)*&
&                  temp431b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp430b
                cellscaleb(2) = cellscaleb(2) - temp430*temp430b
                hess4fb(2) = 0.0_8
                temp430b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp430b1 + fun0*der4fb(2)
                temp430b2 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                  der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp430b2 + &
&                  rmusin(2, 0)*temp430b0
                temp430b3 = cost3d*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                rmusinb(2, 0) = rmusinb(2, 0) + rmucos(3, 0)*temp430b0 -&
&                  2*rmusin(2, 0)*temp430b3
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp430b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp430b2
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp430b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp432 = fun0/cellscale(3)
                temp433 = rmu(2, 0)*rmucos(2, 0)
                temp433b = -(cost3d*4.d0*pi*hess4fb(2))
                temp433b0 = rmucos(3, 0)*rmusin(3, 0)*temp433b
                temp432b = temp433*temp433b0/cellscale(3)
                temp432b0 = temp433*temp432*temp433b
                rmub(2, 0) = rmub(2, 0) + temp432*rmucos(2, 0)*temp433b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp432*rmu(2, 0)*&
&                  temp433b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp432b
                cellscaleb(3) = cellscaleb(3) - temp432*temp432b
                rmucosb(3, 0) = rmucosb(3, 0) + rmusin(3, 0)*temp432b0
                hess4fb(2) = 0.0_8
                temp432b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp432b1 + fun0*der4fb(2)
                temp432b2 = cost3d*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                rmusinb(3, 0) = rmusinb(3, 0) + rmucos(3, 0)*temp432b0 -&
&                  2*rmusin(3, 0)*temp432b2
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp432b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp432b3 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                  der4fb(2)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp432b3
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp432b3
                rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp432b2
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp434 = fun0/cellscale(1)
                temp435 = rmu(3, 0)*rmucos(1, 0)
                temp435b = -(cost3d*4.d0*pi*hess4fb(2))
                temp435b0 = rmucos(3, 0)*rmusin(1, 0)*temp435b
                temp434b = temp435*temp435b0/cellscale(1)
                temp434b0 = temp435*temp434*temp435b
                rmub(3, 0) = rmub(3, 0) + temp434*rmucos(1, 0)*temp435b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp434*rmu(3, 0)*&
&                  temp435b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp434b
                cellscaleb(1) = cellscaleb(1) - temp434*temp434b
                hess4fb(2) = 0.0_8
                temp434b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp434b1 + fun0*der4fb(2)
                temp434b2 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                  der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp434b2 + &
&                  rmusin(1, 0)*temp434b0
                temp434b3 = cost3d*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                rmusinb(1, 0) = rmusinb(1, 0) + rmucos(3, 0)*temp434b0 -&
&                  2*rmusin(1, 0)*temp434b3
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp434b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp434b2
                rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp434b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              temp436 = fun0/cellscale(3)
              temp437 = rmu(1, 0)*rmucos(1, 0)
              temp437b = -(cost3d*4.d0*pi*hess4fb(2))
              temp437b0 = rmucos(3, 0)*rmusin(3, 0)*temp437b
              temp436b = temp437*temp437b0/cellscale(3)
              temp436b0 = temp437*temp436*temp437b
              rmub(1, 0) = rmub(1, 0) + temp436*rmucos(1, 0)*temp437b0
              rmucosb(1, 0) = rmucosb(1, 0) + temp436*rmu(1, 0)*&
&                temp437b0
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              fun0b = fun0b + der4f(2)*der4fb(2) + temp436b
              cellscaleb(3) = cellscaleb(3) - temp436*temp436b
              rmucosb(3, 0) = rmucosb(3, 0) + rmusin(3, 0)*temp436b0
              hess4fb(2) = 0.0_8
              temp436b1 = 2.d0*rmu(i, 0)*hess4fb(3)
              der4fb(2) = fun*temp436b1 + fun0*der4fb(2)
              temp436b2 = cost3d*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
              rmusinb(3, 0) = rmusinb(3, 0) + rmucos(3, 0)*temp436b0 - 2&
&                *rmusin(3, 0)*temp436b2
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
              funb = funb + der4f(2)*temp436b1
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              temp436b3 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                der4fb(2)
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp436b3
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp436b3
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp436b2
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp426b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp426b
            funb = funb + rmu(i, 0)*temp426b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp425 = r(0)**2
        temp424 = fun2/temp425
        temp424b = rmu(i, 0)**2*radhess4fb(i)/temp425
        temp423 = r(0)**2
        temp422 = rmu(i, 0)**2/temp423
        temp422b7 = -(fun*radhess4fb(i)/temp423)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp422b7 + temp424*2*rmu(&
&          i, 0)*radhess4fb(i)
        fun2b = fun2b + temp424b
        rb(0) = rb(0) - temp422*2*r(0)*temp422b7 - temp424*2*r(0)*&
&          temp424b
        funb = funb + (1.d0-temp422)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      temp422b6 = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp422b6 - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp422b6
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp422b5 = distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + cosphase(k)*temp422b5
          cosphaseb(k) = cosphaseb(k) + distp(k, 1)*temp422b5
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*cosphase(k)*zb&
&            (indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp422b = cost3d*rmucos(1, i)*rmucos(3, i)*distpb(i, 6)
      temp422b0 = cost3d*rmu(1, i)*rmu(3, i)*distpb(i, 6)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp422b
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp422b
      rmucosb(1, i) = rmucosb(1, i) + rmucos(3, i)*temp422b0
      rmucosb(3, i) = rmucosb(3, i) + rmucos(1, i)*temp422b0
      distpb(i, 6) = 0.0_8
      temp422b1 = cost3d*rmucos(2, i)*rmucos(3, i)*distpb(i, 5)
      temp422b2 = cost3d*rmu(2, i)*rmu(3, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp422b1
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp422b1
      rmucosb(2, i) = rmucosb(2, i) + rmucos(3, i)*temp422b2
      rmucosb(3, i) = rmucosb(3, i) + rmucos(2, i)*temp422b2
      distpb(i, 5) = 0.0_8
      temp422b3 = cost3d*rmucos(1, i)*rmucos(2, i)*distpb(i, 4)
      temp422b4 = cost3d*rmu(1, i)*rmu(2, i)*distpb(i, 4)
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp422b3
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp422b3
      rmucosb(1, i) = rmucosb(1, i) + rmucos(2, i)*temp422b4
      rmucosb(2, i) = rmucosb(2, i) + rmucos(1, i)*temp422b4
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rp0b = -(cost1d*distpb(i, 2))
      distpb(i, 2) = 0.0_8
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp421 = r(k)**2
      temp421b = c*DEXP(-(dd1*temp421))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp421))*distpb(k, 1)
      dd1b = dd1b - temp421*temp421b
      rb(k) = rb(k) - dd1*2*r(k)*temp421b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.64592278064948967213d0*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indparp) = -ddb(indparp)
  CASE (69)
! d single gaussian orbital
! radial R(r)= exp(-alpha r^2)
! normalized
! orbital with the minimal power of rmucos
! orbital derivative of 68
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    IF (dd(indparp) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indparp) = dd(indparp)
    ELSE
      dd(indparp) = -dd(indparp)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
!         c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)
    c = dd1**1.75d0*1.64592278064948967213d0
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos with the minimal rmucos strategy
    DO i=0,0
      rp0 = r(i)**2
! lz=0
      distp(i, 2) = (3.d0*rmu(3, i)**2-rp0)*cost1d
! lz=+/-2
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*rmucos(1, i)*rmucos(2, i)*cost3d
! lz=+/-1
      distp(i, 5) = rmu(2, i)*rmu(3, i)*rmucos(2, i)*rmucos(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*rmucos(1, i)*rmucos(3, i)*cost3d
    END DO
! lz=+/-4
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,5
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*(7.d0/4.d0/dd1-r(k)**2)*distp(k, 1&
&            +ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)*(7.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-11.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+17.d0*dd1*r(0)**2-11.d0&
&        /2.d0)
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,5
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part ! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost1d*rmu(1, 0)*rmucos(1, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*2.d0*(-(rmucos(1, 0)**2)+rmusin(&
&                  1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost1d*rmu(2, 0)*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*2.d0*(-(rmucos(2, 0)**2)+rmusin(&
&                  2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 4.d0*cost1d*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*4.d0*(rmucos(3, 0)**2-rmusin(3, &
&                  0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost2d*rmu(1, 0)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2d*fun0*2.d0*(rmucos(1, 0)**2-rmusin(1, &
&                  0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2d*rmu(2, 0)*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2d*fun0*2.d0*(-(rmucos(2, 0)**2)+rmusin(&
&                  2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(2, 0)*rmucos(2, 0)*(rmucos(1, 0)**&
&                  2-rmusin(1, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(1)*rmu(2, 0)&
&                  *rmucos(1, 0)*rmucos(2, 0)*rmusin(1, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(1, 0)*rmucos(1, 0)*(rmucos(2, 0)**&
&                  2-rmusin(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(2)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmucos(2, 0)*rmusin(2, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(3, 0)*rmucos(3, 0)*(rmucos(2, 0)**&
&                  2-rmusin(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(2)*rmu(3, 0)&
&                  *rmucos(2, 0)*rmucos(3, 0)*rmusin(2, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(2, 0)*rmucos(2, 0)*(rmucos(3, 0)**&
&                  2-rmusin(3, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(3)*rmu(2, 0)&
&                  *rmucos(2, 0)*rmucos(3, 0)*rmusin(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost3d*rmu(3, 0)*rmucos(3, 0)*(rmucos(1, 0)**2-&
&                rmusin(1, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(1)*rmu(3, 0)*&
&                rmucos(1, 0)*rmucos(3, 0)*rmusin(1, 0))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost3d*rmu(1, 0)*rmucos(1, 0)*(rmucos(3, 0)**2-&
&                rmusin(3, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(3)*rmu(1, 0)*&
&                rmucos(1, 0)*rmucos(3, 0)*rmusin(3, 0))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*(7.d0/4.d0/dd1-r(0)&
&              **2)*distp(0, 1+ic)*cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*(7.d0/4.d0/dd1-r(0)**2)*distp(0, 1+ic)*sinphase(i, 0&
&              )*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      dd1b = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=5,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp471 = distp(0, 1)*rphase(i)
            temp470 = distp(0, 1+ic)*sinphase(i, 0)
            temp470b = -(temp470*temp471*zb(indorbp, indt+i))
            temp469 = 4.d0*dd1
            temp468 = 7.d0/temp469
            temp468b = -((temp468-r(0)**2)*zb(indorbp, indt+i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp467 = distp(0, 1+ic)*rphase(i)**2
            temp465 = 4.d0*dd1
            temp464 = 7.d0/temp465
            temp464b = -((temp464-r(0)**2)*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + temp467&
&              *distp(0, 1)*temp464b + z(indorbp, indt+i)*zb(indorbp, &
&              indt+i)
            temp466 = distp(0, 1)*cosphase(0)
            temp466b = -(temp466*temp467*hess4fb(1))
            dd1b = dd1b - temp464*4.d0*temp466b/temp465 - temp468*4.d0*&
&              temp470b/temp469
            rb(0) = rb(0) - 2*r(0)*temp466b - 2*r(0)*temp470b
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp471*sinphase(i, 0)*&
&              temp468b
            temp468b0 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp468b0 + &
&              temp471*distp(0, 1+ic)*temp468b
            distpb(0, 1) = distpb(0, 1) + temp467*cosphase(0)*temp464b +&
&              temp470*rphase(i)*temp468b
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp468b0 + temp466&
&              *distp(0, 1+ic)*2*rphase(i)*temp464b + temp470*distp(0, 1)&
&              *temp468b
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp466*rphase(i)**2*&
&              temp464b
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp463 = der4f(1)/cellscale(i)
            temp463b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp463*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp463b
            cellscaleb(i) = cellscaleb(i) - temp463*temp463b
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 8) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 2) THEN
                  IF (branch .LT. 1) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp451b0 = cost1d*2.d0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(1, 0)**&
&                      2-rmucos(1, 0)**2)*temp451b0
                    rmusinb(1, 0) = rmusinb(1, 0) + fun0*2*rmusin(1, 0)*&
&                      temp451b0
                    hess4fb(2) = 0.0_8
                    temp451b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp451b1 + fun0*der4fb(2)
                    temp451b2 = -(cost1d*2.d0*der4fb(2))
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp451b2 &
&                      - fun0*2*rmucos(1, 0)*temp451b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp451b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp451b2
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp451b3 = cost1d*2.d0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(2, 0)**&
&                      2-rmucos(2, 0)**2)*temp451b3
                    rmusinb(2, 0) = rmusinb(2, 0) + fun0*2*rmusin(2, 0)*&
&                      temp451b3
                    hess4fb(2) = 0.0_8
                    temp451b4 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp451b4 + fun0*der4fb(2)
                    temp451b5 = -(cost1d*2.d0*der4fb(2))
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp451b5 &
&                      - fun0*2*rmucos(2, 0)*temp451b3
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp451b4
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp451b5
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 3) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp451b6 = cost1d*4.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmucos(3, 0)**2-&
&                    rmusin(3, 0)**2)*temp451b6
                  hess4fb(2) = 0.0_8
                  temp451b7 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp451b7 + fun0*der4fb(2)
                  temp451b8 = cost1d*4.d0*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp451b8 + &
&                    fun0*2*rmucos(3, 0)*temp451b6
                  rmusinb(3, 0) = rmusinb(3, 0) - fun0*2*rmusin(3, 0)*&
&                    temp451b6
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp451b7
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp451b8
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp451b9 = cost2d*2.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmucos(1, 0)**2-&
&                    rmusin(1, 0)**2)*temp451b9
                  hess4fb(2) = 0.0_8
                  temp451b10 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp451b10 + fun0*der4fb(2)
                  temp451b11 = cost2d*2.d0*der4fb(2)
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp451b11 +&
&                    fun0*2*rmucos(1, 0)*temp451b9
                  rmusinb(1, 0) = rmusinb(1, 0) - fun0*2*rmusin(1, 0)*&
&                    temp451b9
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp451b10
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp451b11
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 6) THEN
                IF (branch .LT. 5) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp451b12 = cost2d*2.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(2, 0)**2-&
&                    rmucos(2, 0)**2)*temp451b12
                  rmusinb(2, 0) = rmusinb(2, 0) + fun0*2*rmusin(2, 0)*&
&                    temp451b12
                  hess4fb(2) = 0.0_8
                  temp451b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp451b13 + fun0*der4fb(2)
                  temp451b14 = -(cost2d*2.d0*der4fb(2))
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp451b14 -&
&                    fun0*2*rmucos(2, 0)*temp451b12
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp451b13
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp451b14
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 7) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp451 = fun0/cellscale(1)
                temp452 = rmu(2, 0)*rmucos(1, 0)
                temp452b = -(cost3d*4.d0*pi*hess4fb(2))
                temp452b0 = rmucos(2, 0)*rmusin(1, 0)*temp452b
                temp451b15 = temp452*temp452b0/cellscale(1)
                temp451b16 = temp452*temp451*temp452b
                rmub(2, 0) = rmub(2, 0) + temp451*rmucos(1, 0)*temp452b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp451*rmu(2, 0)*&
&                  temp452b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp451b15
                cellscaleb(1) = cellscaleb(1) - temp451*temp451b15
                hess4fb(2) = 0.0_8
                temp451b17 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp451b17 + fun0*der4fb(2)
                temp451b18 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                  der4fb(2)
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp451b18 + &
&                  rmusin(1, 0)*temp451b16
                temp451b19 = cost3d*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                rmusinb(1, 0) = rmusinb(1, 0) + rmucos(2, 0)*temp451b16 &
&                  - 2*rmusin(1, 0)*temp451b19
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp451b17
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp451b18
                rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*&
&                  temp451b19
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp453 = fun0/cellscale(2)
                temp454 = rmu(1, 0)*rmucos(1, 0)
                temp454b = -(cost3d*4.d0*pi*hess4fb(2))
                temp454b0 = rmucos(2, 0)*rmusin(2, 0)*temp454b
                temp453b = temp454*temp454b0/cellscale(2)
                temp453b0 = temp454*temp453*temp454b
                rmub(1, 0) = rmub(1, 0) + temp453*rmucos(1, 0)*temp454b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp453*rmu(1, 0)*&
&                  temp454b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp453b
                cellscaleb(2) = cellscaleb(2) - temp453*temp453b
                rmucosb(2, 0) = rmucosb(2, 0) + rmusin(2, 0)*temp453b0
                hess4fb(2) = 0.0_8
                temp453b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp453b1 + fun0*der4fb(2)
                temp453b2 = cost3d*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
                rmusinb(2, 0) = rmusinb(2, 0) + rmucos(2, 0)*temp453b0 -&
&                  2*rmusin(2, 0)*temp453b2
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp453b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp453b3 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                  der4fb(2)
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp453b3
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp453b3
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp453b2
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 11) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp455 = fun0/cellscale(2)
                temp456 = rmu(3, 0)*rmucos(2, 0)
                temp456b = -(cost3d*4.d0*pi*hess4fb(2))
                temp456b0 = rmucos(3, 0)*rmusin(2, 0)*temp456b
                temp455b = temp456*temp456b0/cellscale(2)
                temp455b0 = temp456*temp455*temp456b
                rmub(3, 0) = rmub(3, 0) + temp455*rmucos(2, 0)*temp456b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp455*rmu(3, 0)*&
&                  temp456b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp455b
                cellscaleb(2) = cellscaleb(2) - temp455*temp455b
                hess4fb(2) = 0.0_8
                temp455b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp455b1 + fun0*der4fb(2)
                temp455b2 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                  der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp455b2 + &
&                  rmusin(2, 0)*temp455b0
                temp455b3 = cost3d*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                rmusinb(2, 0) = rmusinb(2, 0) + rmucos(3, 0)*temp455b0 -&
&                  2*rmusin(2, 0)*temp455b3
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp455b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp455b2
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp455b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp457 = fun0/cellscale(3)
                temp458 = rmu(2, 0)*rmucos(2, 0)
                temp458b = -(cost3d*4.d0*pi*hess4fb(2))
                temp458b0 = rmucos(3, 0)*rmusin(3, 0)*temp458b
                temp457b = temp458*temp458b0/cellscale(3)
                temp457b0 = temp458*temp457*temp458b
                rmub(2, 0) = rmub(2, 0) + temp457*rmucos(2, 0)*temp458b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp457*rmu(2, 0)*&
&                  temp458b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp457b
                cellscaleb(3) = cellscaleb(3) - temp457*temp457b
                rmucosb(3, 0) = rmucosb(3, 0) + rmusin(3, 0)*temp457b0
                hess4fb(2) = 0.0_8
                temp457b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp457b1 + fun0*der4fb(2)
                temp457b2 = cost3d*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                rmusinb(3, 0) = rmusinb(3, 0) + rmucos(3, 0)*temp457b0 -&
&                  2*rmusin(3, 0)*temp457b2
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp457b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp457b3 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                  der4fb(2)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp457b3
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp457b3
                rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp457b2
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp459 = fun0/cellscale(1)
                temp460 = rmu(3, 0)*rmucos(1, 0)
                temp460b = -(cost3d*4.d0*pi*hess4fb(2))
                temp460b0 = rmucos(3, 0)*rmusin(1, 0)*temp460b
                temp459b = temp460*temp460b0/cellscale(1)
                temp459b0 = temp460*temp459*temp460b
                rmub(3, 0) = rmub(3, 0) + temp459*rmucos(1, 0)*temp460b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp459*rmu(3, 0)*&
&                  temp460b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp459b
                cellscaleb(1) = cellscaleb(1) - temp459*temp459b
                hess4fb(2) = 0.0_8
                temp459b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp459b1 + fun0*der4fb(2)
                temp459b2 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                  der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp459b2 + &
&                  rmusin(1, 0)*temp459b0
                temp459b3 = cost3d*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                rmusinb(1, 0) = rmusinb(1, 0) + rmucos(3, 0)*temp459b0 -&
&                  2*rmusin(1, 0)*temp459b3
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp459b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp459b2
                rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp459b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              temp461 = fun0/cellscale(3)
              temp462 = rmu(1, 0)*rmucos(1, 0)
              temp462b = -(cost3d*4.d0*pi*hess4fb(2))
              temp462b0 = rmucos(3, 0)*rmusin(3, 0)*temp462b
              temp461b = temp462*temp462b0/cellscale(3)
              temp461b0 = temp462*temp461*temp462b
              rmub(1, 0) = rmub(1, 0) + temp461*rmucos(1, 0)*temp462b0
              rmucosb(1, 0) = rmucosb(1, 0) + temp461*rmu(1, 0)*&
&                temp462b0
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              fun0b = fun0b + der4f(2)*der4fb(2) + temp461b
              cellscaleb(3) = cellscaleb(3) - temp461*temp461b
              rmucosb(3, 0) = rmucosb(3, 0) + rmusin(3, 0)*temp461b0
              hess4fb(2) = 0.0_8
              temp461b1 = 2.d0*rmu(i, 0)*hess4fb(3)
              der4fb(2) = fun*temp461b1 + fun0*der4fb(2)
              temp461b2 = cost3d*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
              rmusinb(3, 0) = rmusinb(3, 0) + rmucos(3, 0)*temp461b0 - 2&
&                *rmusin(3, 0)*temp461b2
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
              funb = funb + der4f(2)*temp461b1
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              temp461b3 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                der4fb(2)
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp461b3
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp461b3
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp461b2
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp451b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp451b
            funb = funb + rmu(i, 0)*temp451b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp450 = r(0)**2
        temp449 = fun2/temp450
        temp449b = rmu(i, 0)**2*radhess4fb(i)/temp450
        temp448 = r(0)**2
        temp447 = rmu(i, 0)**2/temp448
        temp447b = -(fun*radhess4fb(i)/temp448)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp447b + temp449*2*rmu(i&
&          , 0)*radhess4fb(i)
        fun2b = fun2b + temp449b
        rb(0) = rb(0) - temp447*2*r(0)*temp447b - temp449*2*r(0)*&
&          temp449b
        funb = funb + (1.d0-temp447)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      temp446 = r(0)**4
      temp446b = distp(0, 1)*fun2b
      temp445 = 4.d0*dd1
      temp444 = 7.d0/temp445
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-11.d0/2.d0)*funb&
&        + (temp444-r(0)**2)*fun0b + (17.d0*(dd1*r(0)**2)-11.d0/2.d0-4.d0&
&        *(dd1**2*temp446))*fun2b
      temp446b0 = distp(0, 1)*2.d0*funb
      dd1b = dd1b + r(0)**2*temp446b0 - distp(0, 1)*temp444*4.d0*fun0b/&
&        temp445 + (17.d0*r(0)**2-4.d0*temp446*2*dd1)*temp446b
      rb(0) = rb(0) + dd1*2*r(0)*temp446b0 - distp(0, 1)*2*r(0)*fun0b + &
&        (17.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp446b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp443 = 4.d0*dd1
          temp442 = 7.d0/temp443
          temp442b = (temp442-r(k)**2)*zb(indorbp, k)
          temp441 = distp(k, 1+ic)
          temp440 = distp(k, 1)*cosphase(k)
          temp440b5 = temp440*temp441*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + temp441*cosphase(k)*temp442b
          cosphaseb(k) = cosphaseb(k) + temp441*distp(k, 1)*temp442b
          distpb(k, 1+ic) = distpb(k, 1+ic) + temp440*temp442b
          dd1b = dd1b - temp442*4.d0*temp440b5/temp443
          rb(k) = rb(k) - 2*r(k)*temp440b5
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp440b = cost3d*rmucos(1, i)*rmucos(3, i)*distpb(i, 6)
      temp440b0 = cost3d*rmu(1, i)*rmu(3, i)*distpb(i, 6)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp440b
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp440b
      rmucosb(1, i) = rmucosb(1, i) + rmucos(3, i)*temp440b0
      rmucosb(3, i) = rmucosb(3, i) + rmucos(1, i)*temp440b0
      distpb(i, 6) = 0.0_8
      temp440b1 = cost3d*rmucos(2, i)*rmucos(3, i)*distpb(i, 5)
      temp440b2 = cost3d*rmu(2, i)*rmu(3, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp440b1
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp440b1
      rmucosb(2, i) = rmucosb(2, i) + rmucos(3, i)*temp440b2
      rmucosb(3, i) = rmucosb(3, i) + rmucos(2, i)*temp440b2
      distpb(i, 5) = 0.0_8
      temp440b3 = cost3d*rmucos(1, i)*rmucos(2, i)*distpb(i, 4)
      temp440b4 = cost3d*rmu(1, i)*rmu(2, i)*distpb(i, 4)
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp440b3
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp440b3
      rmucosb(1, i) = rmucosb(1, i) + rmucos(2, i)*temp440b4
      rmucosb(2, i) = rmucosb(2, i) + rmucos(1, i)*temp440b4
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rp0b = -(cost1d*distpb(i, 2))
      distpb(i, 2) = 0.0_8
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp439 = r(k)**2
      temp439b4 = c*DEXP(-(dd1*temp439))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp439))*distpb(k, 1)
      dd1b = dd1b - temp439*temp439b4
      rb(k) = rb(k) - dd1*2*r(k)*temp439b4
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.64592278064948967213d0*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indparp) = -ddb(indparp)
  CASE (30)
! d orbitals without cusp and one parmater
    indorbp = indorb
    indparp = indpar + 1
    IF (dd(indpar+1) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indpar+1) = dd(indpar+1)
    ELSE
      dd(indpar+1) = -dd(indpar+1)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization
!        c=1.d0/(2.d0**3*3.d0)*dsqrt(1.d0/pi)*(2.d0*dd1)**(7.d0/2.d0)
    c = dd1**3.5d0*0.26596152026762178d0
!        endif
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=0,0
      distp(i, 2) = (3.d0*(rmu(3, i)*rmucos(3, i))**2-r(i)**2)*cost1d
! lz=0
      distp(i, 3) = ((rmu(1, i)*rmucos(1, i))**2-(rmu(2, i)*rmucos(2, i)&
&        )**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*rmucos(1, i)*rmucos(2, i)*cost3d
! lz=+/-2
      distp(i, 5) = rmu(2, i)*rmu(3, i)*rmucos(2, i)*rmucos(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*rmucos(1, i)*rmucos(3, i)*cost3d
    END DO
! lz=+/-1
    DO ic=1,5
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(dd1*distp(0, 1)/r(0))
      fun2 = (dd1**2*distp(0, 1)+dd1*distp(0, 1)/r(0))/r(0)**2
      hess3d = 0.d0
      hess3d(:, 1) = -(2.d0*rmu(:, 0)*rmucos(:, 0)*cost1d)
      hess3d(3, 1) = hess3d(3, 1) + 6.d0*rmu(3, 0)*rmucos(3, 0)*(rmucos(&
&        3, 0)**2-rmusin(3, 0)**2)*cost1d
      hess3d(1, 2) = 2.d0*rmu(1, 0)*rmucos(1, 0)*(rmucos(1, 0)**2-rmusin&
&        (1, 0)**2)*cost2d
      hess3d(2, 2) = -(2.d0*rmu(2, 0)*rmucos(2, 0)*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)*cost2d)
! lz=+/-2
      hess3d(2, 3) = rmu(1, 0)*rmucos(1, 0)*cost3d*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)
! lz=+/-2
      hess3d(1, 3) = rmu(2, 0)*rmucos(2, 0)*cost3d*(rmucos(1, 0)**2-&
&        rmusin(1, 0)**2)
! lz=+/-1
      hess3d(2, 4) = rmu(3, 0)*rmucos(3, 0)*cost3d*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)
! lz=+/-1
      hess3d(3, 4) = rmu(2, 0)*rmucos(2, 0)*cost3d*(rmucos(3, 0)**2-&
&        rmusin(3, 0)**2)
! lz=+/-1
      hess3d(1, 5) = rmu(3, 0)*rmucos(3, 0)*cost3d*(rmucos(1, 0)**2-&
&        rmusin(1, 0)**2)
! lz=+/-1
      hess3d(3, 5) = rmu(1, 0)*rmucos(1, 0)*cost3d*(rmucos(3, 0)**2-&
&        rmusin(3, 0)**2)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,5
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          DO i=1,3
! 1)
! 2)
            hess(i) = ((fun2*(rmu(i, 0)*rmucos(i, 0))**2+fun*(rmucos(i, &
&              0)**2-rmusin(i, 0)**2))*distp(0, 1+ic)+hess3d(i, ic)*fun*&
&              rmu(i, 0)*rmucos(i, 0))*cosphase(0)
!enddo for i
! from 1
! from 2
! from 2
! from 2
            hess(i) = hess(i) - distp(0, 1+ic)*fun*rmu(i, 0)*rmucos(i, 0&
&              )*sinphase(i, 0)*rphase(i) - distp(0, 1+ic)*fun0*cosphase(&
&              0)*rphase(i)**2 - distp(0, 1+ic)*fun*sinphase(i, 0)*rphase&
&              (i)*rmu(i, 0)*rmucos(i, 0) - fun0*sinphase(i, 0)*rphase(i)&
&              *hess3d(i, ic)
          END DO
          IF (ic .EQ. 1) THEN
            DO i=1,3
! 3
! from  3
              hess(i) = hess(i) + 2.d0*rmu(i, 0)*rmucos(i, 0)*fun0*&
&                cost1d*sinphase(i, 0)*rphase(i)
              hess(i) = hess(i) + (-(2.d0*fun0*cost1d*(rmucos(i, 0)**2-&
&                rmusin(i, 0)**2))-2.d0*fun*rmu(i, 0)**2*rmucos(i, 0)**2*&
&                cost1d)*cosphase(0)
            END DO
! 4
! from 4
            hess(3) = hess(3) - 6.d0*rmu(3, 0)*rmucos(3, 0)*cost1d*fun0*&
&              (rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(3) = hess(3) + (6.d0*cost1d*fun0*(rmucos(3, 0)**2-&
&              rmusin(3, 0)**2)**2-6.d0*rmu(3, 0)*rmucos(3, 0)*cost1d*&
&              fun0*4.d0*pi/cellscale(3)*rmusin(3, 0)*rmucos(3, 0)+6.d0*&
&              rmu(3, 0)**2*rmucos(3, 0)**2*cost1d*fun*(rmucos(3, 0)**2-&
&              rmusin(3, 0)**2))*cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
          ELSE IF (ic .EQ. 2) THEN
            hess(1) = hess(1) - 2.d0*rmu(1, 0)*fun0*cost2d*rmucos(1, 0)*&
&              (rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(2) = hess(2) - (-(2.d0*rmu(2, 0)*fun0*cost2d*rmucos(2, &
&              0)*(rmucos(2, 0)**2-rmusin(2, 0)**2)))*sinphase(2, 0)*&
&              rphase(2)
            hess(1) = hess(1) + (2.d0*rmu(1, 0)**2*fun*cost2d*rmucos(1, &
&              0)**2*(rmucos(1, 0)**2-rmusin(1, 0)**2)+2.d0*fun0*cost2d*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*(rmucos(1, 0)**2-rmusin(1&
&              , 0)**2)-2.d0*rmu(1, 0)*fun0*cost2d*rmucos(1, 0)*4.d0*pi/&
&              cellscale(1)*rmusin(1, 0)*rmucos(1, 0))*cosphase(0)
            hess(2) = hess(2) + (-(2.d0*rmu(2, 0)**2*fun*cost2d*rmucos(2&
&              , 0)**2*(rmucos(2, 0)**2-rmusin(2, 0)**2))-2.d0*fun0*&
&              cost2d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*(rmucos(2, 0)**2-&
&              rmusin(2, 0)**2)+2.d0*rmu(2, 0)*fun0*cost2d*rmucos(2, 0)*&
&              4.d0*pi/cellscale(2)*rmusin(2, 0)*rmucos(2, 0))*cosphase(0&
&              )
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          ELSE IF (ic .EQ. 3) THEN
            hess(1) = hess(1) - rmu(2, 0)*fun0*cost3d*rmucos(2, 0)*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(2) = hess(2) - rmu(1, 0)*fun0*cost3d*rmucos(1, 0)*(&
&              rmucos(2, 0)**2-rmusin(2, 0)**2)*sinphase(2, 0)*rphase(2)
            hess(2) = hess(2) + (-(rmu(1, 0)*cost3d*rmucos(1, 0)*(4.d0*&
&              pi/cellscale(2)*fun0*rmusin(2, 0)*rmucos(2, 0)+fun*(rmusin&
&              (2, 0)**2-rmucos(2, 0)**2)*rmu(2, 0)*rmucos(2, 0))))*&
&              cosphase(0)
            hess(1) = hess(1) + (-(rmu(2, 0)*cost3d*rmucos(2, 0)*(4.d0*&
&              pi/cellscale(1)*fun0*rmusin(1, 0)*rmucos(1, 0)+fun*(rmusin&
&              (1, 0)**2-rmucos(1, 0)**2)*rmu(1, 0)*rmucos(1, 0))))*&
&              cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE IF (ic .EQ. 4) THEN
            hess(2) = hess(2) - rmu(3, 0)*fun0*cost3d*rmucos(3, 0)*(&
&              rmucos(2, 0)**2-rmusin(2, 0)**2)*sinphase(2, 0)*rphase(2)
            hess(3) = hess(3) - rmu(2, 0)*fun0*cost3d*rmucos(2, 0)*(&
&              rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(2) = hess(2) + (-(rmu(3, 0)*cost3d*rmucos(3, 0)*(4.d0*&
&              pi/cellscale(2)*fun0*rmusin(2, 0)*rmucos(2, 0)+fun*(rmusin&
&              (2, 0)**2-rmucos(2, 0)**2)*rmu(2, 0)*rmucos(2, 0))))*&
&              cosphase(0)
            hess(3) = hess(3) + (-(rmu(2, 0)*cost3d*rmucos(2, 0)*(4.d0*&
&              pi/cellscale(3)*fun0*rmusin(3, 0)*rmucos(3, 0)+fun*(rmusin&
&              (3, 0)**2-rmucos(3, 0)**2)*rmu(3, 0)*rmucos(3, 0))))*&
&              cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
          ELSE IF (ic .EQ. 5) THEN
            hess(1) = hess(1) - rmu(3, 0)*fun0*cost3d*rmucos(3, 0)*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(3) = hess(3) - rmu(1, 0)*fun0*cost3d*rmucos(1, 0)*(&
&              rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(1) = hess(1) + (-(rmu(3, 0)*cost3d*rmucos(3, 0)*(4.d0*&
&              pi/cellscale(1)*fun0*rmusin(1, 0)*rmucos(1, 0)+fun*(rmusin&
&              (1, 0)**2-rmucos(1, 0)**2)*rmu(1, 0)*rmucos(1, 0))))*&
&              cosphase(0)
            hess(3) = hess(3) + (-(rmu(1, 0)*cost3d*rmucos(1, 0)*(4.d0*&
&              pi/cellscale(3)*fun0*rmusin(3, 0)*rmucos(3, 0)+fun*(rmusin&
&              (3, 0)**2-rmucos(3, 0)**2)*rmu(3, 0)*rmucos(3, 0))))*&
&              cosphase(0)
!endif for ic
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
          END IF
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hessb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      hess3db = 0.0_8
      DO ic=5,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb(:) = hessb(:) + zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 3) THEN
            IF (branch .LT. 2) THEN
              IF (branch .LT. 1) THEN
                temp499b = cosphase(0)*hessb(3)
                temp498 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                temp499b0 = cost1d*6.d0*temp499b
                temp498b = fun0*2*temp498*temp499b0
                temp494 = fun0/cellscale(3)
                temp497 = rmucos(3, 0)**2*temp494
                temp496 = rmu(3, 0)*rmusin(3, 0)
                temp495 = 4.d0*cost1d*pi*6.d0
                temp495b = -(temp495*temp499b)
                temp494b = temp496*rmucos(3, 0)**2*temp495b/cellscale(3)
                temp493 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                temp492 = rmucos(3, 0)**2
                temp491 = rmu(3, 0)**2
                temp490 = temp491*fun*temp492
                temp491b = cost1d*6.d0*temp499b
                temp490b = temp493*temp491b
                temp489 = rmu(3, 0)*rmucos(3, 0)
                temp489b = -(cost1d*6.d0*hessb(3))
                temp489b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp489b
                temp488b = temp489*temp489b0
                temp486 = rmu(3, 0)*rmucos(3, 0)
                temp486b0 = cost1d*6.d0*zb(indorbp, indt+3)
                temp486b1 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp486b0
                fun0b = fun0b + sinphase(3, 0)*rphase(3)*temp488b + &
&                  temp486*cosphase(0)*temp486b1 + temp494b + temp498**2*&
&                  temp499b0
                temp488 = sinphase(3, 0)*fun0*rphase(3)
                temp489b1 = temp489*temp488*temp489b
                temp487 = fun0*cosphase(0)
                temp486b2 = temp486*temp487*temp486b0
                rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp489b1&
&                  + temp488*rmu(3, 0)*temp489b0 + 2*rmucos(3, 0)*&
&                  temp486b2 + temp487*rmu(3, 0)*temp486b1 + temp490*2*&
&                  rmucos(3, 0)*temp491b + temp491*fun*2*rmucos(3, 0)*&
&                  temp490b + temp496*temp494*2*rmucos(3, 0)*temp495b + 2&
&                  *rmucos(3, 0)*temp498b
                rmusinb(3, 0) = rmusinb(3, 0) + temp497*rmu(3, 0)*&
&                  temp495b - 2*rmusin(3, 0)*temp486b2 - temp490*2*rmusin&
&                  (3, 0)*temp491b - 2*rmusin(3, 0)*temp489b1 - 2*rmusin(&
&                  3, 0)*temp498b
                rmub(3, 0) = rmub(3, 0) + temp488*rmucos(3, 0)*temp489b0&
&                  + temp487*rmucos(3, 0)*temp486b1 + temp492*fun*2*rmu(3&
&                  , 0)*temp490b + temp497*rmusin(3, 0)*temp495b
                cellscaleb(3) = cellscaleb(3) - temp494*temp494b
                funb = funb + temp492*temp491*temp490b
                cosphaseb(0) = cosphaseb(0) + temp486*fun0*temp486b1 + (&
&                  cost1d*6.d0*(fun0*temp498**2)-temp495*(temp496*temp497&
&                  )+cost1d*6.d0*(temp490*temp493))*hessb(3)
                sinphaseb(3, 0) = sinphaseb(3, 0) + fun0*rphase(3)*&
&                  temp488b
                rphaseb(3) = rphaseb(3) + sinphase(3, 0)*fun0*temp488b
                DO i=3,1,-1
                  temp486b = cosphase(0)*hessb(i)
                  temp485 = rmucos(i, 0)**2 - rmusin(i, 0)**2
                  temp485b = -(cost1d*2.d0*temp486b)
                  temp484 = rmu(i, 0)**2
                  temp484b = -(cost1d*2.d0*temp486b)
                  temp484b0 = rmucos(i, 0)**2*temp484b
                  temp484b1 = cost1d*2.d0*hessb(i)
                  temp484b2 = rmu(i, 0)*rmucos(i, 0)*temp484b1
                  temp484b3 = sinphase(i, 0)*temp484b2
                  temp484b4 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  temp484b5 = rmu(i, 0)*rmucos(i, 0)*temp484b4
                  fun0b = fun0b + rphase(i)*temp484b3 + cosphase(0)*&
&                    temp484b5 + temp485*temp485b
                  temp484b6 = sinphase(i, 0)*fun0*rphase(i)*temp484b1
                  temp484b7 = fun0*cosphase(0)*temp484b4
                  rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp484b6 + &
&                    rmu(i, 0)*temp484b7 + fun*temp484*2*rmucos(i, 0)*&
&                    temp484b + fun0*2*rmucos(i, 0)*temp485b
                  rmusinb(i, 0) = rmusinb(i, 0) - fun0*2*rmusin(i, 0)*&
&                    temp485b
                  funb = funb + temp484*temp484b0
                  rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp484b6 + &
&                    rmucos(i, 0)*temp484b7 + fun*2*rmu(i, 0)*temp484b0
                  cosphaseb(0) = cosphaseb(0) + fun0*temp484b5 + (-(&
&                    cost1d*2.d0*(fun0*temp485))-cost1d*2.d0*(fun*temp484&
&                    *rmucos(i, 0)**2))*hessb(i)
                  sinphaseb(i, 0) = sinphaseb(i, 0) + fun0*rphase(i)*&
&                    temp484b2
                  rphaseb(i) = rphaseb(i) + fun0*temp484b3
                END DO
              ELSE
                temp525b = cosphase(0)*hessb(2)
                temp521 = fun0/cellscale(2)
                temp524 = rmucos(2, 0)**2*temp521
                temp523 = rmu(2, 0)*rmusin(2, 0)
                temp522 = 4.d0*cost2d*pi*2.d0
                temp522b = temp522*temp525b
                temp521b = temp523*rmucos(2, 0)**2*temp522b/cellscale(2)
                temp520 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp521b0 = -(cost2d*2.d0*temp525b)
                temp520b = fun0*2*temp520*temp521b0
                temp519 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp518 = rmucos(2, 0)**2
                temp517 = rmu(2, 0)**2
                temp516 = temp517*fun*temp518
                temp517b = -(cost2d*2.d0*temp525b)
                temp516b = temp519*temp517b
                rmub(2, 0) = rmub(2, 0) + temp518*fun*2*rmu(2, 0)*&
&                  temp516b + temp524*rmusin(2, 0)*temp522b
                rmusinb(2, 0) = rmusinb(2, 0) + temp524*rmu(2, 0)*&
&                  temp522b - 2*rmusin(2, 0)*temp520b - temp516*2*rmusin(&
&                  2, 0)*temp517b
                rmucosb(2, 0) = rmucosb(2, 0) + temp516*2*rmucos(2, 0)*&
&                  temp517b + temp517*fun*2*rmucos(2, 0)*temp516b + 2*&
&                  rmucos(2, 0)*temp520b + temp523*temp521*2*rmucos(2, 0)&
&                  *temp522b
                temp516b0 = cosphase(0)*hessb(1)
                temp511 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp512b = cost2d*2.d0*temp516b0
                temp509 = rmu(1, 0)*rmusin(1, 0)
                temp508 = 4.d0*cost2d*pi*2.d0
                temp508b = -(temp508*temp516b0)
                temp507b = temp509*rmucos(1, 0)**2*temp508b/cellscale(1)
                temp506 = rmu(2, 0)*rmucos(2, 0)
                temp506b = cost2d*2.d0*hessb(2)
                temp506b0 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp506b
                temp505b = temp506*temp506b0
                temp503 = rmu(2, 0)*rmucos(2, 0)
                temp503b = -(cost2d*2.d0*zb(indorbp, indt+2))
                temp503b0 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp503b
                temp502 = rmu(1, 0)*rmucos(1, 0)
                temp502b = -(cost2d*2.d0*hessb(1))
                temp502b0 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp502b
                temp501b = temp502*temp502b0
                temp499 = rmu(1, 0)*rmucos(1, 0)
                temp499b1 = cost2d*2.d0*zb(indorbp, indt+1)
                temp499b2 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp499b1
                fun0b = fun0b + temp511**2*temp512b + temp507b + temp503&
&                  *cosphase(0)*temp503b0 + temp499*cosphase(0)*temp499b2&
&                  + sinphase(1, 0)*rphase(1)*temp501b + sinphase(2, 0)*&
&                  rphase(2)*temp505b + temp520**2*temp521b0 + temp521b
                cellscaleb(2) = cellscaleb(2) - temp521*temp521b
                temp515 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp514 = rmucos(1, 0)**2
                temp513 = rmu(1, 0)**2
                temp513b = cost2d*2.d0*temp516b0
                temp512b0 = temp515*temp513b
                funb = funb + temp514*temp513*temp512b0 + temp518*&
&                  temp517*temp516b
                temp512 = temp513*fun*temp514
                temp507 = fun0/cellscale(1)
                temp510 = rmucos(1, 0)**2*temp507
                cosphaseb(0) = cosphaseb(0) + (cost2d*2.d0*(temp512*&
&                  temp515)+cost2d*2.d0*(fun0*temp511**2)-temp508*(&
&                  temp509*temp510))*hessb(1) + temp499*fun0*temp499b2 + &
&                  temp503*fun0*temp503b0 + (temp522*(temp523*temp524)-&
&                  cost2d*2.d0*(fun0*temp520**2)-cost2d*2.d0*(temp516*&
&                  temp519))*hessb(2)
                temp511b = fun0*2*temp511*temp512b
                rmub(1, 0) = rmub(1, 0) + temp510*rmusin(1, 0)*temp508b &
&                  + temp514*fun*2*rmu(1, 0)*temp512b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp509*temp507*2*rmucos&
&                  (1, 0)*temp508b + 2*rmucos(1, 0)*temp511b + temp512*2*&
&                  rmucos(1, 0)*temp513b + temp513*fun*2*rmucos(1, 0)*&
&                  temp512b0
                rmusinb(1, 0) = rmusinb(1, 0) + temp510*rmu(1, 0)*&
&                  temp508b - 2*rmusin(1, 0)*temp511b - temp512*2*rmusin(&
&                  1, 0)*temp513b
                cellscaleb(1) = cellscaleb(1) - temp507*temp507b
                temp505 = sinphase(2, 0)*fun0*rphase(2)
                temp506b1 = temp506*temp505*temp506b
                temp504 = fun0*cosphase(0)
                temp503b1 = temp503*temp504*temp503b
                rmucosb(2, 0) = rmucosb(2, 0) + temp504*rmu(2, 0)*&
&                  temp503b0 + 2*rmucos(2, 0)*temp503b1 + temp505*rmu(2, &
&                  0)*temp506b0 + 2*rmucos(2, 0)*temp506b1
                rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp503b1&
&                  - 2*rmusin(2, 0)*temp506b1
                rmub(2, 0) = rmub(2, 0) + temp504*rmucos(2, 0)*temp503b0&
&                  + temp505*rmucos(2, 0)*temp506b0
                sinphaseb(2, 0) = sinphaseb(2, 0) + fun0*rphase(2)*&
&                  temp505b
                rphaseb(2) = rphaseb(2) + sinphase(2, 0)*fun0*temp505b
                temp501 = sinphase(1, 0)*fun0*rphase(1)
                temp502b1 = temp502*temp501*temp502b
                temp500 = fun0*cosphase(0)
                temp499b3 = temp499*temp500*temp499b1
                rmucosb(1, 0) = rmucosb(1, 0) + temp500*rmu(1, 0)*&
&                  temp499b2 + 2*rmucos(1, 0)*temp499b3 + temp501*rmu(1, &
&                  0)*temp502b0 + 2*rmucos(1, 0)*temp502b1
                rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp499b3&
&                  - 2*rmusin(1, 0)*temp502b1
                rmub(1, 0) = rmub(1, 0) + temp500*rmucos(1, 0)*temp499b2&
&                  + temp501*rmucos(1, 0)*temp502b0
                sinphaseb(1, 0) = sinphaseb(1, 0) + fun0*rphase(1)*&
&                  temp501b
                rphaseb(1) = rphaseb(1) + sinphase(1, 0)*fun0*temp501b
              END IF
            ELSE
              temp542 = fun*rmu(1, 0)*rmucos(1, 0)
              temp541 = rmusin(1, 0)**2 - rmucos(1, 0)**2
              temp538 = fun0/cellscale(1)
              temp540 = rmusin(1, 0)*rmucos(1, 0)
              temp539 = rmu(2, 0)*cosphase(0)
              temp539b = -(cost3d*(pi*4.d0*(temp540*temp538)+temp541*&
&                temp542)*hessb(1))
              temp539b0 = -(cost3d*temp539*rmucos(2, 0)*hessb(1))
              temp539b1 = pi*4.d0*temp539b0
              temp538b = temp540*temp539b1/cellscale(1)
              temp538b0 = temp541*rmucos(1, 0)*temp539b0
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*cosphase(0)*&
&                temp539b
              temp537 = fun*rmu(2, 0)*rmucos(2, 0)
              temp536 = rmusin(2, 0)**2 - rmucos(2, 0)**2
              temp533 = fun0/cellscale(2)
              temp535 = rmusin(2, 0)*rmucos(2, 0)
              temp534b = -(cost3d*(pi*4.d0*(temp535*temp533)+temp536*&
&                temp537)*hessb(2))
              temp529 = rmu(1, 0)*rmucos(1, 0)
              temp529b = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*zb(&
&                indorbp, indt+2)
              temp525 = rmu(2, 0)*rmucos(2, 0)
              temp525b0 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*zb(&
&                indorbp, indt+1)
              cosphaseb(0) = cosphaseb(0) + rmucos(1, 0)*rmu(1, 0)*&
&                temp534b + temp525*fun0*temp525b0 + temp529*fun0*&
&                temp529b + rmucos(2, 0)*rmu(2, 0)*temp539b
              rmucosb(2, 0) = rmucosb(2, 0) + temp539*temp539b
              rmusinb(1, 0) = rmusinb(1, 0) + temp542*2*rmusin(1, 0)*&
&                temp539b0 + temp538*rmucos(1, 0)*temp539b1
              temp534 = rmu(1, 0)*cosphase(0)
              rmucosb(1, 0) = rmucosb(1, 0) + temp534*temp534b + (&
&                temp541*fun*rmu(1, 0)-temp542*2*rmucos(1, 0))*temp539b0 &
&                + temp538*rmusin(1, 0)*temp539b1
              temp534b0 = -(cost3d*temp534*rmucos(1, 0)*hessb(2))
              temp534b1 = pi*4.d0*temp534b0
              temp533b = temp535*temp534b1/cellscale(2)
              temp531 = rmu(1, 0)*rmucos(1, 0)
              temp531b = -(cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                hessb(2))
              temp531b0 = temp531*sinphase(2, 0)*temp531b
              temp527 = rmu(2, 0)*rmucos(2, 0)
              temp527b = -(cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                hessb(1))
              temp527b0 = temp527*sinphase(1, 0)*temp527b
              fun0b = fun0b + temp533b + temp529*cosphase(0)*temp529b + &
&                temp525*cosphase(0)*temp525b0 + rphase(1)*temp527b0 + &
&                rphase(2)*temp531b0 + temp538b
              cellscaleb(1) = cellscaleb(1) - temp538*temp538b
              temp533b0 = temp536*rmucos(2, 0)*temp534b0
              funb = funb + rmu(2, 0)*temp533b0 + rmu(1, 0)*temp538b0
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*cosphase(0)*&
&                temp534b + fun*temp538b0
              temp532 = sinphase(2, 0)*fun0*rphase(2)
              temp531b1 = -(cost3d*temp531*temp532*hessb(2))
              temp530 = fun0*cosphase(0)
              temp529b0 = cost3d*temp529*temp530*zb(indorbp, indt+2)
              rmusinb(2, 0) = rmusinb(2, 0) + temp537*2*rmusin(2, 0)*&
&                temp534b0 - 2*rmusin(2, 0)*temp529b0 - 2*rmusin(2, 0)*&
&                temp531b1 + temp533*rmucos(2, 0)*temp534b1
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp531b1 +&
&                (temp536*fun*rmu(2, 0)-temp537*2*rmucos(2, 0))*temp534b0&
&                + temp533*rmusin(2, 0)*temp534b1
              cellscaleb(2) = cellscaleb(2) - temp533*temp533b
              rmub(2, 0) = rmub(2, 0) + fun*temp533b0
              rmub(1, 0) = rmub(1, 0) + temp530*rmucos(1, 0)*temp529b + &
&                temp532*rmucos(1, 0)*temp531b
              rmucosb(1, 0) = rmucosb(1, 0) + temp530*rmu(1, 0)*temp529b&
&                + temp532*rmu(1, 0)*temp531b
              sinphaseb(2, 0) = sinphaseb(2, 0) + temp531*fun0*rphase(2)&
&                *temp531b
              rphaseb(2) = rphaseb(2) + fun0*temp531b0
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp529b0
              temp528 = sinphase(1, 0)*fun0*rphase(1)
              temp527b1 = -(cost3d*temp527*temp528*hessb(1))
              rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp527b1
              temp526 = fun0*cosphase(0)
              temp525b1 = cost3d*temp525*temp526*zb(indorbp, indt+1)
              rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp525b1 -&
&                2*rmusin(1, 0)*temp527b1
              rmub(2, 0) = rmub(2, 0) + temp526*rmucos(2, 0)*temp525b0 +&
&                temp528*rmucos(2, 0)*temp527b
              rmucosb(2, 0) = rmucosb(2, 0) + temp526*rmu(2, 0)*&
&                temp525b0 + temp528*rmu(2, 0)*temp527b
              sinphaseb(1, 0) = sinphaseb(1, 0) + temp527*fun0*rphase(1)&
&                *temp527b
              rphaseb(1) = rphaseb(1) + fun0*temp527b0
              rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp525b1
            END IF
          ELSE IF (branch .LT. 5) THEN
            IF (branch .LT. 4) THEN
              temp560 = fun*rmu(3, 0)*rmucos(3, 0)
              temp559 = rmusin(3, 0)**2 - rmucos(3, 0)**2
              temp556 = fun0/cellscale(3)
              temp558 = rmusin(3, 0)*rmucos(3, 0)
              temp557 = rmu(2, 0)*cosphase(0)
              temp557b = -(cost3d*(pi*4.d0*(temp558*temp556)+temp559*&
&                temp560)*hessb(3))
              temp557b0 = -(cost3d*temp557*rmucos(2, 0)*hessb(3))
              temp557b1 = pi*4.d0*temp557b0
              temp556b = temp558*temp557b1/cellscale(3)
              temp556b0 = temp559*rmucos(3, 0)*temp557b0
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*cosphase(0)*&
&                temp557b
              temp555 = fun*rmu(2, 0)*rmucos(2, 0)
              temp554 = rmusin(2, 0)**2 - rmucos(2, 0)**2
              temp551 = fun0/cellscale(2)
              temp553 = rmusin(2, 0)*rmucos(2, 0)
              temp552b = -(cost3d*(pi*4.d0*(temp553*temp551)+temp554*&
&                temp555)*hessb(2))
              temp547 = rmu(2, 0)*rmucos(2, 0)
              temp547b = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*zb(&
&                indorbp, indt+3)
              temp543 = rmu(3, 0)*rmucos(3, 0)
              temp543b = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*zb(&
&                indorbp, indt+2)
              cosphaseb(0) = cosphaseb(0) + rmucos(3, 0)*rmu(3, 0)*&
&                temp552b + temp543*fun0*temp543b + temp547*fun0*temp547b&
&                + rmucos(2, 0)*rmu(2, 0)*temp557b
              rmucosb(2, 0) = rmucosb(2, 0) + temp557*temp557b
              rmusinb(3, 0) = rmusinb(3, 0) + temp560*2*rmusin(3, 0)*&
&                temp557b0 + temp556*rmucos(3, 0)*temp557b1
              temp552 = rmu(3, 0)*cosphase(0)
              rmucosb(3, 0) = rmucosb(3, 0) + temp552*temp552b + (&
&                temp559*fun*rmu(3, 0)-temp560*2*rmucos(3, 0))*temp557b0 &
&                + temp556*rmusin(3, 0)*temp557b1
              temp552b0 = -(cost3d*temp552*rmucos(3, 0)*hessb(2))
              temp552b1 = pi*4.d0*temp552b0
              temp551b = temp553*temp552b1/cellscale(2)
              temp549 = rmu(2, 0)*rmucos(2, 0)
              temp549b = -(cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                hessb(3))
              temp549b0 = temp549*sinphase(3, 0)*temp549b
              temp545 = rmu(3, 0)*rmucos(3, 0)
              temp545b = -(cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                hessb(2))
              temp545b0 = temp545*sinphase(2, 0)*temp545b
              fun0b = fun0b + temp551b + temp547*cosphase(0)*temp547b + &
&                temp543*cosphase(0)*temp543b + rphase(2)*temp545b0 + &
&                rphase(3)*temp549b0 + temp556b
              cellscaleb(3) = cellscaleb(3) - temp556*temp556b
              temp551b0 = temp554*rmucos(2, 0)*temp552b0
              funb = funb + rmu(2, 0)*temp551b0 + rmu(3, 0)*temp556b0
              rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*cosphase(0)*&
&                temp552b + fun*temp556b0
              rmusinb(2, 0) = rmusinb(2, 0) + temp555*2*rmusin(2, 0)*&
&                temp552b0 + temp551*rmucos(2, 0)*temp552b1
              rmucosb(2, 0) = rmucosb(2, 0) + (temp554*fun*rmu(2, 0)-&
&                temp555*2*rmucos(2, 0))*temp552b0 + temp551*rmusin(2, 0)&
&                *temp552b1
              cellscaleb(2) = cellscaleb(2) - temp551*temp551b
              temp550 = sinphase(3, 0)*fun0*rphase(3)
              temp548 = fun0*cosphase(0)
              rmub(2, 0) = rmub(2, 0) + temp550*rmucos(2, 0)*temp549b + &
&                temp548*rmucos(2, 0)*temp547b + fun*temp551b0
              temp549b1 = -(cost3d*temp549*temp550*hessb(3))
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp549b1
              temp547b0 = cost3d*temp547*temp548*zb(indorbp, indt+3)
              rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp547b0 -&
&                2*rmusin(3, 0)*temp549b1
              rmucosb(2, 0) = rmucosb(2, 0) + temp548*rmu(2, 0)*temp547b&
&                + temp550*rmu(2, 0)*temp549b
              sinphaseb(3, 0) = sinphaseb(3, 0) + temp549*fun0*rphase(3)&
&                *temp549b
              rphaseb(3) = rphaseb(3) + fun0*temp549b0
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp547b0
              temp546 = sinphase(2, 0)*fun0*rphase(2)
              temp545b1 = -(cost3d*temp545*temp546*hessb(2))
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp545b1
              temp544 = fun0*cosphase(0)
              temp543b0 = cost3d*temp543*temp544*zb(indorbp, indt+2)
              rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp543b0 -&
&                2*rmusin(2, 0)*temp545b1
              rmub(3, 0) = rmub(3, 0) + temp544*rmucos(3, 0)*temp543b + &
&                temp546*rmucos(3, 0)*temp545b
              rmucosb(3, 0) = rmucosb(3, 0) + temp544*rmu(3, 0)*temp543b&
&                + temp546*rmu(3, 0)*temp545b
              sinphaseb(2, 0) = sinphaseb(2, 0) + temp545*fun0*rphase(2)&
&                *temp545b
              rphaseb(2) = rphaseb(2) + fun0*temp545b0
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp543b0
            END IF
          ELSE
            temp578 = fun*rmu(3, 0)*rmucos(3, 0)
            temp577 = rmusin(3, 0)**2 - rmucos(3, 0)**2
            temp574 = fun0/cellscale(3)
            temp576 = rmusin(3, 0)*rmucos(3, 0)
            temp575 = rmu(1, 0)*cosphase(0)
            temp575b = -(cost3d*(pi*4.d0*(temp576*temp574)+temp577*&
&              temp578)*hessb(3))
            temp575b0 = -(cost3d*temp575*rmucos(1, 0)*hessb(3))
            temp575b1 = pi*4.d0*temp575b0
            temp574b = temp576*temp575b1/cellscale(3)
            temp574b0 = temp577*rmucos(3, 0)*temp575b0
            rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*cosphase(0)*temp575b
            temp573 = fun*rmu(1, 0)*rmucos(1, 0)
            temp572 = rmusin(1, 0)**2 - rmucos(1, 0)**2
            temp569 = fun0/cellscale(1)
            temp571 = rmusin(1, 0)*rmucos(1, 0)
            temp570b = -(cost3d*(pi*4.d0*(temp571*temp569)+temp572*&
&              temp573)*hessb(1))
            temp565 = rmu(1, 0)*rmucos(1, 0)
            temp565b = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*zb(&
&              indorbp, indt+3)
            temp561 = rmu(3, 0)*rmucos(3, 0)
            temp561b = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*zb(&
&              indorbp, indt+1)
            cosphaseb(0) = cosphaseb(0) + rmucos(3, 0)*rmu(3, 0)*&
&              temp570b + temp561*fun0*temp561b + temp565*fun0*temp565b +&
&              rmucos(1, 0)*rmu(1, 0)*temp575b
            rmucosb(1, 0) = rmucosb(1, 0) + temp575*temp575b
            rmusinb(3, 0) = rmusinb(3, 0) + temp578*2*rmusin(3, 0)*&
&              temp575b0 + temp574*rmucos(3, 0)*temp575b1
            temp570 = rmu(3, 0)*cosphase(0)
            rmucosb(3, 0) = rmucosb(3, 0) + temp570*temp570b + (temp577*&
&              fun*rmu(3, 0)-temp578*2*rmucos(3, 0))*temp575b0 + temp574*&
&              rmusin(3, 0)*temp575b1
            temp570b0 = -(cost3d*temp570*rmucos(3, 0)*hessb(1))
            temp570b1 = pi*4.d0*temp570b0
            temp569b = temp571*temp570b1/cellscale(1)
            temp567 = rmu(1, 0)*rmucos(1, 0)
            temp567b = -(cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hessb(&
&              3))
            temp567b0 = temp567*sinphase(3, 0)*temp567b
            temp563 = rmu(3, 0)*rmucos(3, 0)
            temp563b = -(cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hessb(&
&              1))
            temp563b0 = temp563*sinphase(1, 0)*temp563b
            fun0b = fun0b + temp569b + temp565*cosphase(0)*temp565b + &
&              temp561*cosphase(0)*temp561b + rphase(1)*temp563b0 + &
&              rphase(3)*temp567b0 + temp574b
            cellscaleb(3) = cellscaleb(3) - temp574*temp574b
            temp569b0 = temp572*rmucos(1, 0)*temp570b0
            funb = funb + rmu(1, 0)*temp569b0 + rmu(3, 0)*temp574b0
            rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*cosphase(0)*temp570b &
&              + fun*temp574b0
            rmusinb(1, 0) = rmusinb(1, 0) + temp573*2*rmusin(1, 0)*&
&              temp570b0 + temp569*rmucos(1, 0)*temp570b1
            rmucosb(1, 0) = rmucosb(1, 0) + (temp572*fun*rmu(1, 0)-&
&              temp573*2*rmucos(1, 0))*temp570b0 + temp569*rmusin(1, 0)*&
&              temp570b1
            cellscaleb(1) = cellscaleb(1) - temp569*temp569b
            temp568 = sinphase(3, 0)*fun0*rphase(3)
            temp566 = fun0*cosphase(0)
            rmub(1, 0) = rmub(1, 0) + temp568*rmucos(1, 0)*temp567b + &
&              temp566*rmucos(1, 0)*temp565b + fun*temp569b0
            temp567b1 = -(cost3d*temp567*temp568*hessb(3))
            rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp567b1
            temp565b0 = cost3d*temp565*temp566*zb(indorbp, indt+3)
            rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp565b0 - 2&
&              *rmusin(3, 0)*temp567b1
            rmucosb(1, 0) = rmucosb(1, 0) + temp566*rmu(1, 0)*temp565b +&
&              temp568*rmu(1, 0)*temp567b
            sinphaseb(3, 0) = sinphaseb(3, 0) + temp567*fun0*rphase(3)*&
&              temp567b
            rphaseb(3) = rphaseb(3) + fun0*temp567b0
            rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp565b0
            temp564 = sinphase(1, 0)*fun0*rphase(1)
            temp563b1 = -(cost3d*temp563*temp564*hessb(1))
            rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp563b1
            temp562 = fun0*cosphase(0)
            temp561b0 = cost3d*temp561*temp562*zb(indorbp, indt+1)
            rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp561b0 - 2&
&              *rmusin(1, 0)*temp563b1
            rmub(3, 0) = rmub(3, 0) + temp562*rmucos(3, 0)*temp561b + &
&              temp564*rmucos(3, 0)*temp563b
            rmucosb(3, 0) = rmucosb(3, 0) + temp562*rmu(3, 0)*temp561b +&
&              temp564*rmu(3, 0)*temp563b
            sinphaseb(1, 0) = sinphaseb(1, 0) + temp563*fun0*rphase(1)*&
&              temp563b
            rphaseb(1) = rphaseb(1) + fun0*temp563b0
            rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp561b0
          END IF
          DO i=3,1,-1
            temp483 = fun*rphase(i)
            temp482 = rmu(i, 0)*rmucos(i, 0)
            temp482b = -(temp482*temp483*hessb(i))
            temp482b0 = -(distp(0, 1+ic)*sinphase(i, 0)*hessb(i))
            temp482b1 = -(rphase(i)**2*hessb(i))
            temp482b2 = distp(0, 1+ic)*temp482b1
            temp481 = sinphase(i, 0)*rmu(i, 0)
            temp480 = fun*rphase(i)
            temp480b = -(temp480*temp481*hessb(i))
            temp480b0 = -(distp(0, 1+ic)*rmucos(i, 0)*hessb(i))
            temp480b1 = -(sinphase(i, 0)*hess3d(i, ic)*hessb(i))
            temp480b2 = -(fun0*rphase(i)*hessb(i))
            temp480b3 = cosphase(0)*hessb(i)
            temp479 = rmucos(i, 0)**2
            temp478 = rmu(i, 0)**2
            temp477 = rmucos(i, 0)**2 - rmusin(i, 0)**2
            temp476 = fun2*temp478*temp479 + fun*temp477
            temp474b22 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
            temp474b23 = -(fun0*rphase(i)*zb(indorbp, indt+i))
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp476*temp480b3 + &
&              sinphase(i, 0)*temp474b23 + fun*cosphase(0)*temp474b22 + &
&              rmucos(i, 0)*temp480b + fun0*cosphase(0)*temp482b1 + &
&              sinphase(i, 0)*temp482b
            sinphaseb(i, 0) = sinphaseb(i, 0) + distp(0, 1+ic)*&
&              temp474b23 + hess3d(i, ic)*temp480b2 + temp480*rmu(i, 0)*&
&              temp480b0 + distp(0, 1+ic)*temp482b
            temp476b = distp(0, 1+ic)*temp480b3
            temp474 = hess3d(i, ic)*rmucos(i, 0)
            temp474b24 = distp(0, 1+ic)*fun*cosphase(0)*zb(indorbp, indt&
&              +i)
            rmub(i, 0) = rmub(i, 0) + temp479*fun2*2*rmu(i, 0)*temp476b &
&              + temp474*fun*temp480b3 + rmucos(i, 0)*temp474b24 + &
&              temp480*sinphase(i, 0)*temp480b0 + temp483*rmucos(i, 0)*&
&              temp482b0
            temp475 = fun*rmu(i, 0)
            rmucosb(i, 0) = rmucosb(i, 0) + (fun*2*rmucos(i, 0)+fun2*&
&              temp478*2*rmucos(i, 0))*temp476b + temp475*hess3d(i, ic)*&
&              temp480b3 + rmu(i, 0)*temp474b24 + distp(0, 1+ic)*temp480b&
&              + temp483*rmu(i, 0)*temp482b0
            temp474b25 = distp(0, 1+ic)*temp474b22
            funb = funb + temp477*temp476b + temp474*rmu(i, 0)*temp480b3&
&              + cosphase(0)*temp474b25 + temp481*rphase(i)*temp480b0 + &
&              temp482*rphase(i)*temp482b0
            temp474b26 = -(distp(0, 1+ic)*sinphase(i, 0)*zb(indorbp, &
&              indt+i))
            rphaseb(i) = rphaseb(i) + fun0*temp474b26 + fun0*temp480b1 +&
&              temp481*fun*temp480b0 - distp(0, 1+ic)*fun0*cosphase(0)*2*&
&              rphase(i)*hessb(i) + temp482*fun*temp482b0
            fun0b = fun0b + rphase(i)*temp474b26 + rphase(i)*temp480b1 +&
&              cosphase(0)*temp482b2
            cosphaseb(0) = cosphaseb(0) + (temp476*distp(0, 1+ic)+&
&              temp474*temp475)*hessb(i) + fun*temp474b25 + fun0*&
&              temp482b2
            hess3db(i, ic) = hess3db(i, ic) + temp475*rmucos(i, 0)*&
&              temp480b3 + sinphase(i, 0)*temp480b2
            fun2b = fun2b + temp479*temp478*temp476b
            rmusinb(i, 0) = rmusinb(i, 0) - fun*2*rmusin(i, 0)*temp476b
            hessb(i) = 0.0_8
            zb(indorbp, indt+i) = 0.D0
          END DO
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      temp474b = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hess3db(3, 5)
      temp474b0 = cost3d*rmu(1, 0)*rmucos(1, 0)*hess3db(3, 5)
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp474b
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp474b
      hess3db(3, 5) = 0.0_8
      temp474b1 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hess3db(1, 5)
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp474b1 + 2*rmucos(3, &
&        0)*temp474b0
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp474b0
      temp474b2 = cost3d*rmu(3, 0)*rmucos(3, 0)*hess3db(1, 5)
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp474b1
      rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp474b2
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp474b2
      hess3db(1, 5) = 0.0_8
      temp474b3 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hess3db(3, 4)
      temp474b4 = cost3d*rmu(2, 0)*rmucos(2, 0)*hess3db(3, 4)
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp474b3
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp474b3
      hess3db(3, 4) = 0.0_8
      temp474b5 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*hess3db(2, 4)
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp474b5 + 2*rmucos(3, &
&        0)*temp474b4
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp474b4
      temp474b6 = cost3d*rmu(3, 0)*rmucos(3, 0)*hess3db(2, 4)
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp474b5
      hess3db(2, 4) = 0.0_8
      temp474b7 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hess3db(1, 3)
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp474b7 + 2*rmucos(2, &
&        0)*temp474b6
      rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp474b6
      temp474b8 = cost3d*rmu(2, 0)*rmucos(2, 0)*hess3db(1, 3)
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp474b7
      hess3db(1, 3) = 0.0_8
      temp474b9 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*hess3db(2, 3)
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp474b9 + 2*rmucos(1, &
&        0)*temp474b8
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp474b8
      temp474b10 = cost3d*rmu(1, 0)*rmucos(1, 0)*hess3db(2, 3)
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp474b9
      hess3db(2, 3) = 0.0_8
      temp474b11 = -(cost2d*2.d0*hess3db(2, 2))
      temp474b12 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp474b11
      temp474b13 = rmu(2, 0)*rmucos(2, 0)*temp474b11
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp474b12 + 2*rmucos(2&
&        , 0)*temp474b13 + 2*rmucos(2, 0)*temp474b10
      rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp474b13 - 2*&
&        rmusin(2, 0)*temp474b10
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp474b12
      hess3db(2, 2) = 0.0_8
      temp474b14 = cost2d*2.d0*hess3db(1, 2)
      temp474b15 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp474b14
      temp474b16 = rmu(1, 0)*rmucos(1, 0)*temp474b14
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp474b15
      rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp474b16 + rmu(1&
&        , 0)*temp474b15
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp474b16
      hess3db(1, 2) = 0.0_8
      temp474b17 = cost1d*6.d0*hess3db(3, 1)
      temp474b18 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp474b17
      temp474b19 = rmu(3, 0)*rmucos(3, 0)*temp474b17
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp474b18
      rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp474b19 + rmu(3&
&        , 0)*temp474b18
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp474b19
      temp474b20 = -(cost1d*2.d0*hess3db(:, 1))
      rmub(:, 0) = rmub(:, 0) + rmucos(:, 0)*temp474b20
      rmucosb(:, 0) = rmucosb(:, 0) + rmu(:, 0)*temp474b20
      temp474b21 = fun2b/r(0)**2
      temp473 = dd1/r(0)
      temp473b = distp(0, 1)*temp474b21/r(0)
      temp472b10 = -(distp(0, 1)*funb/r(0))
      dd1b = temp472b10 + temp473b + distp(0, 1)*2*dd1*temp474b21
      temp472 = dd1/r(0)
      distpb(0, 1) = distpb(0, 1) + fun0b - temp472*funb + (temp473+dd1&
&        **2)*temp474b21
      rb(0) = rb(0) - temp472*temp472b10 - (dd1**2*distp(0, 1)+distp(0, &
&        1)*temp473)*2*temp474b21/r(0) - temp473*temp473b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=5,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp472b9 = distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + cosphase(k)*temp472b9
          cosphaseb(k) = cosphaseb(k) + distp(k, 1)*temp472b9
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*cosphase(k)*zb&
&            (indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp472b0 = cost3d*rmucos(1, i)*rmucos(3, i)*distpb(i, 6)
      temp472b1 = cost3d*rmu(1, i)*rmu(3, i)*distpb(i, 6)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp472b0
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp472b0
      rmucosb(1, i) = rmucosb(1, i) + rmucos(3, i)*temp472b1
      rmucosb(3, i) = rmucosb(3, i) + rmucos(1, i)*temp472b1
      distpb(i, 6) = 0.0_8
      temp472b2 = cost3d*rmucos(2, i)*rmucos(3, i)*distpb(i, 5)
      temp472b3 = cost3d*rmu(2, i)*rmu(3, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp472b2
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp472b2
      rmucosb(2, i) = rmucosb(2, i) + rmucos(3, i)*temp472b3
      rmucosb(3, i) = rmucosb(3, i) + rmucos(2, i)*temp472b3
      distpb(i, 5) = 0.0_8
      temp472b4 = cost3d*rmucos(1, i)*rmucos(2, i)*distpb(i, 4)
      temp472b5 = cost3d*rmu(1, i)*rmu(2, i)*distpb(i, 4)
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp472b4
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp472b4
      rmucosb(1, i) = rmucosb(1, i) + rmucos(2, i)*temp472b5
      rmucosb(2, i) = rmucosb(2, i) + rmucos(1, i)*temp472b5
      distpb(i, 4) = 0.0_8
      temp472b6 = cost2d*2*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      temp472b7 = -(cost2d*2*rmu(2, i)*rmucos(2, i)*distpb(i, 3))
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp472b6
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp472b6
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp472b7
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp472b7
      distpb(i, 3) = 0.0_8
      temp472b8 = cost1d*distpb(i, 2)
      rmub(3, i) = rmub(3, i) + 3.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp472b8
      rmucosb(3, i) = rmucosb(3, i) + 3.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp472b8
      rb(i) = rb(i) - 2*r(i)*temp472b8
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    dd1b = 0.0_8
    DO k=0,0,-1
      temp472b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp472b
      rb(k) = rb(k) - dd1*temp472b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.26596152026762178d0*3.5d0*dd1**2.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indpar+1) = -ddb(indpar+1)
  CASE (42)
! derivative of the orbital 30 d orbitals
! d R(r) /d z = d c*exp(-z*r) / dz = c*exp(-z r)*(-r+ d c / d z)
! each gaussian term is normalized
    indorbp = indorb
    indparp = indpar + 1
    IF (dd(indpar+1) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indpar+1) = dd(indpar+1)
    ELSE
      dd(indpar+1) = -dd(indpar+1)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
!         c=1.d0/(2.d0**3*3.d0)*dsqrt(1.d0/pi)*(2.d0*dd1)**(7.d0/2.d0)
    c = dd1**3.5d0*0.26596152026762178d0
!         endif
    c0 = -c
    c1 = 3.5d0*c/dd1
    DO k=0,0
      distp(k, 1) = DEXP(-(dd1*r(k)))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(k, 7))
      distp(k, 7) = distp(k, 1)*(c0*r(k)+c1)
    END DO
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 2))
      distp(i, 2) = (3.d0*(rmu(3, i)*rmucos(3, i))**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
! lz=0
      distp(i, 3) = ((rmu(1, i)*rmucos(1, i))**2-(rmu(2, i)*rmucos(2, i)&
&        )**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*rmucos(1, i)*rmucos(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
! lz=+/-2
      distp(i, 5) = rmu(2, i)*rmu(3, i)*rmucos(2, i)*rmucos(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*rmucos(1, i)*rmucos(3, i)*cost3d
    END DO
! lz=+/-1
    DO ic=1,5
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 7)
      fun = (-(dd1*distp(0, 1)*(c0*r(0)+c1))+distp(0, 1)*c0)/r(0)
      fun2 = (-fun+(dd1**2*distp(0, 1)*(c0*r(0)+c1)-dd1*distp(0, 1)*c0-&
&        dd1*distp(0, 1)*c0))/r(0)**2
      hess3d = 0.d0
      hess3d(:, 1) = -(2.d0*rmu(:, 0)*rmucos(:, 0)*cost1d)
      hess3d(3, 1) = hess3d(3, 1) + 6.d0*rmu(3, 0)*rmucos(3, 0)*(rmucos(&
&        3, 0)**2-rmusin(3, 0)**2)*cost1d
      hess3d(1, 2) = 2.d0*rmu(1, 0)*rmucos(1, 0)*(rmucos(1, 0)**2-rmusin&
&        (1, 0)**2)*cost2d
      hess3d(2, 2) = -(2.d0*rmu(2, 0)*rmucos(2, 0)*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)*cost2d)
! lz=+/-2
      hess3d(2, 3) = rmu(1, 0)*rmucos(1, 0)*cost3d*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)
! lz=+/-2
      hess3d(1, 3) = rmu(2, 0)*rmucos(2, 0)*cost3d*(rmucos(1, 0)**2-&
&        rmusin(1, 0)**2)
! lz=+/-1
      hess3d(2, 4) = rmu(3, 0)*rmucos(3, 0)*cost3d*(rmucos(2, 0)**2-&
&        rmusin(2, 0)**2)
! lz=+/-1
      hess3d(3, 4) = rmu(2, 0)*rmucos(2, 0)*cost3d*(rmucos(3, 0)**2-&
&        rmusin(3, 0)**2)
! lz=+/-1
      hess3d(1, 5) = rmu(3, 0)*rmucos(3, 0)*cost3d*(rmucos(1, 0)**2-&
&        rmusin(1, 0)**2)
! lz=+/-1
      hess3d(3, 5) = rmu(1, 0)*rmucos(1, 0)*cost3d*(rmucos(3, 0)**2-&
&        rmusin(3, 0)**2)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,5
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          DO i=1,3
! 1)
! 2)
            hess(i) = ((fun2*(rmu(i, 0)*rmucos(i, 0))**2+fun*(rmucos(i, &
&              0)**2-rmusin(i, 0)**2))*distp(0, 1+ic)+hess3d(i, ic)*fun*&
&              rmu(i, 0)*rmucos(i, 0))*cosphase(0)
!enddo for i
! from 1
! from 2
! from 2
! from 2
            hess(i) = hess(i) - distp(0, 1+ic)*fun*rmu(i, 0)*rmucos(i, 0&
&              )*sinphase(i, 0)*rphase(i) - distp(0, 1+ic)*fun0*cosphase(&
&              0)*rphase(i)**2 - distp(0, 1+ic)*fun*sinphase(i, 0)*rphase&
&              (i)*rmu(i, 0)*rmucos(i, 0) - fun0*sinphase(i, 0)*rphase(i)&
&              *hess3d(i, ic)
          END DO
          IF (ic .EQ. 1) THEN
            DO i=1,3
! 3
! from  3
              hess(i) = hess(i) + 2.d0*rmu(i, 0)*rmucos(i, 0)*fun0*&
&                cost1d*sinphase(i, 0)*rphase(i)
              hess(i) = hess(i) + (-(2.d0*fun0*cost1d*(rmucos(i, 0)**2-&
&                rmusin(i, 0)**2))-2.d0*fun*rmu(i, 0)**2*rmucos(i, 0)**2*&
&                cost1d)*cosphase(0)
            END DO
! 4
! from 4
            hess(3) = hess(3) - 6.d0*rmu(3, 0)*rmucos(3, 0)*cost1d*fun0*&
&              (rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(3) = hess(3) + (6.d0*cost1d*fun0*(rmucos(3, 0)**2-&
&              rmusin(3, 0)**2)**2-6.d0*rmu(3, 0)*rmucos(3, 0)*cost1d*&
&              fun0*4.d0*pi/cellscale(3)*rmusin(3, 0)*rmucos(3, 0)+6.d0*&
&              rmu(3, 0)**2*rmucos(3, 0)**2*cost1d*fun*(rmucos(3, 0)**2-&
&              rmusin(3, 0)**2))*cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
          ELSE IF (ic .EQ. 2) THEN
            hess(1) = hess(1) - 2.d0*rmu(1, 0)*fun0*cost2d*rmucos(1, 0)*&
&              (rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(2) = hess(2) - (-(2.d0*rmu(2, 0)*fun0*cost2d*rmucos(2, &
&              0)*(rmucos(2, 0)**2-rmusin(2, 0)**2)))*sinphase(2, 0)*&
&              rphase(2)
            hess(1) = hess(1) + (2.d0*rmu(1, 0)**2*fun*cost2d*rmucos(1, &
&              0)**2*(rmucos(1, 0)**2-rmusin(1, 0)**2)+2.d0*fun0*cost2d*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*(rmucos(1, 0)**2-rmusin(1&
&              , 0)**2)-2.d0*rmu(1, 0)*fun0*cost2d*rmucos(1, 0)*4.d0*pi/&
&              cellscale(1)*rmusin(1, 0)*rmucos(1, 0))*cosphase(0)
            hess(2) = hess(2) + (-(2.d0*rmu(2, 0)**2*fun*cost2d*rmucos(2&
&              , 0)**2*(rmucos(2, 0)**2-rmusin(2, 0)**2))-2.d0*fun0*&
&              cost2d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*(rmucos(2, 0)**2-&
&              rmusin(2, 0)**2)+2.d0*rmu(2, 0)*fun0*cost2d*rmucos(2, 0)*&
&              4.d0*pi/cellscale(2)*rmusin(2, 0)*rmucos(2, 0))*cosphase(0&
&              )
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          ELSE IF (ic .EQ. 3) THEN
            hess(1) = hess(1) - rmu(2, 0)*fun0*cost3d*rmucos(2, 0)*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(2) = hess(2) - rmu(1, 0)*fun0*cost3d*rmucos(1, 0)*(&
&              rmucos(2, 0)**2-rmusin(2, 0)**2)*sinphase(2, 0)*rphase(2)
            hess(2) = hess(2) + (-(rmu(1, 0)*cost3d*rmucos(1, 0)*(4.d0*&
&              pi/cellscale(2)*fun0*rmusin(2, 0)*rmucos(2, 0)+fun*(rmusin&
&              (2, 0)**2-rmucos(2, 0)**2)*rmu(2, 0)*rmucos(2, 0))))*&
&              cosphase(0)
            hess(1) = hess(1) + (-(rmu(2, 0)*cost3d*rmucos(2, 0)*(4.d0*&
&              pi/cellscale(1)*fun0*rmusin(1, 0)*rmucos(1, 0)+fun*(rmusin&
&              (1, 0)**2-rmucos(1, 0)**2)*rmu(1, 0)*rmucos(1, 0))))*&
&              cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE IF (ic .EQ. 4) THEN
            hess(2) = hess(2) - rmu(3, 0)*fun0*cost3d*rmucos(3, 0)*(&
&              rmucos(2, 0)**2-rmusin(2, 0)**2)*sinphase(2, 0)*rphase(2)
            hess(3) = hess(3) - rmu(2, 0)*fun0*cost3d*rmucos(2, 0)*(&
&              rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(2) = hess(2) + (-(rmu(3, 0)*cost3d*rmucos(3, 0)*(4.d0*&
&              pi/cellscale(2)*fun0*rmusin(2, 0)*rmucos(2, 0)+fun*(rmusin&
&              (2, 0)**2-rmucos(2, 0)**2)*rmu(2, 0)*rmucos(2, 0))))*&
&              cosphase(0)
            hess(3) = hess(3) + (-(rmu(2, 0)*cost3d*rmucos(2, 0)*(4.d0*&
&              pi/cellscale(3)*fun0*rmusin(3, 0)*rmucos(3, 0)+fun*(rmusin&
&              (3, 0)**2-rmucos(3, 0)**2)*rmu(3, 0)*rmucos(3, 0))))*&
&              cosphase(0)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
          ELSE IF (ic .EQ. 5) THEN
            hess(1) = hess(1) - rmu(3, 0)*fun0*cost3d*rmucos(3, 0)*(&
&              rmucos(1, 0)**2-rmusin(1, 0)**2)*sinphase(1, 0)*rphase(1)
            hess(3) = hess(3) - rmu(1, 0)*fun0*cost3d*rmucos(1, 0)*(&
&              rmucos(3, 0)**2-rmusin(3, 0)**2)*sinphase(3, 0)*rphase(3)
            hess(1) = hess(1) + (-(rmu(3, 0)*cost3d*rmucos(3, 0)*(4.d0*&
&              pi/cellscale(1)*fun0*rmusin(1, 0)*rmucos(1, 0)+fun*(rmusin&
&              (1, 0)**2-rmucos(1, 0)**2)*rmu(1, 0)*rmucos(1, 0))))*&
&              cosphase(0)
            hess(3) = hess(3) + (-(rmu(1, 0)*cost3d*rmucos(1, 0)*(4.d0*&
&              pi/cellscale(3)*fun0*rmusin(3, 0)*rmucos(3, 0)+fun*(rmusin&
&              (3, 0)**2-rmucos(3, 0)**2)*rmu(3, 0)*rmucos(3, 0))))*&
&              cosphase(0)
!endif for ic
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
          END IF
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hessb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      hess3db = 0.0_8
      DO ic=5,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb(:) = hessb(:) + zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 3) THEN
            IF (branch .LT. 2) THEN
              IF (branch .LT. 1) THEN
                temp607b = cosphase(0)*hessb(3)
                temp606 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                temp607b0 = cost1d*6.d0*temp607b
                temp606b = fun0*2*temp606*temp607b0
                temp602 = fun0/cellscale(3)
                temp605 = rmucos(3, 0)**2*temp602
                temp604 = rmu(3, 0)*rmusin(3, 0)
                temp603 = 4.d0*cost1d*pi*6.d0
                temp603b = -(temp603*temp607b)
                temp602b = temp604*rmucos(3, 0)**2*temp603b/cellscale(3)
                temp601 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                temp600 = rmucos(3, 0)**2
                temp599 = rmu(3, 0)**2
                temp598 = temp599*fun*temp600
                temp599b = cost1d*6.d0*temp607b
                temp598b = temp601*temp599b
                temp597 = rmu(3, 0)*rmucos(3, 0)
                temp597b = -(cost1d*6.d0*hessb(3))
                temp597b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp597b
                temp596b = temp597*temp597b0
                temp594 = rmu(3, 0)*rmucos(3, 0)
                temp594b0 = cost1d*6.d0*zb(indorbp, indt+3)
                temp594b1 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp594b0
                fun0b = fun0b + sinphase(3, 0)*rphase(3)*temp596b + &
&                  temp594*cosphase(0)*temp594b1 + temp602b + temp606**2*&
&                  temp607b0
                temp596 = sinphase(3, 0)*fun0*rphase(3)
                temp597b1 = temp597*temp596*temp597b
                temp595 = fun0*cosphase(0)
                temp594b2 = temp594*temp595*temp594b0
                rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp597b1&
&                  + temp596*rmu(3, 0)*temp597b0 + 2*rmucos(3, 0)*&
&                  temp594b2 + temp595*rmu(3, 0)*temp594b1 + temp598*2*&
&                  rmucos(3, 0)*temp599b + temp599*fun*2*rmucos(3, 0)*&
&                  temp598b + temp604*temp602*2*rmucos(3, 0)*temp603b + 2&
&                  *rmucos(3, 0)*temp606b
                rmusinb(3, 0) = rmusinb(3, 0) + temp605*rmu(3, 0)*&
&                  temp603b - 2*rmusin(3, 0)*temp594b2 - temp598*2*rmusin&
&                  (3, 0)*temp599b - 2*rmusin(3, 0)*temp597b1 - 2*rmusin(&
&                  3, 0)*temp606b
                rmub(3, 0) = rmub(3, 0) + temp596*rmucos(3, 0)*temp597b0&
&                  + temp595*rmucos(3, 0)*temp594b1 + temp600*fun*2*rmu(3&
&                  , 0)*temp598b + temp605*rmusin(3, 0)*temp603b
                cellscaleb(3) = cellscaleb(3) - temp602*temp602b
                funb = funb + temp600*temp599*temp598b
                cosphaseb(0) = cosphaseb(0) + temp594*fun0*temp594b1 + (&
&                  cost1d*6.d0*(fun0*temp606**2)-temp603*(temp604*temp605&
&                  )+cost1d*6.d0*(temp598*temp601))*hessb(3)
                sinphaseb(3, 0) = sinphaseb(3, 0) + fun0*rphase(3)*&
&                  temp596b
                rphaseb(3) = rphaseb(3) + sinphase(3, 0)*fun0*temp596b
                DO i=3,1,-1
                  temp594b = cosphase(0)*hessb(i)
                  temp593 = rmucos(i, 0)**2 - rmusin(i, 0)**2
                  temp593b = -(cost1d*2.d0*temp594b)
                  temp592 = rmu(i, 0)**2
                  temp592b = -(cost1d*2.d0*temp594b)
                  temp592b0 = rmucos(i, 0)**2*temp592b
                  temp592b1 = cost1d*2.d0*hessb(i)
                  temp592b2 = rmu(i, 0)*rmucos(i, 0)*temp592b1
                  temp592b3 = sinphase(i, 0)*temp592b2
                  temp592b4 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  temp592b5 = rmu(i, 0)*rmucos(i, 0)*temp592b4
                  fun0b = fun0b + rphase(i)*temp592b3 + cosphase(0)*&
&                    temp592b5 + temp593*temp593b
                  temp592b6 = sinphase(i, 0)*fun0*rphase(i)*temp592b1
                  temp592b7 = fun0*cosphase(0)*temp592b4
                  rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp592b6 + &
&                    rmu(i, 0)*temp592b7 + fun*temp592*2*rmucos(i, 0)*&
&                    temp592b + fun0*2*rmucos(i, 0)*temp593b
                  rmusinb(i, 0) = rmusinb(i, 0) - fun0*2*rmusin(i, 0)*&
&                    temp593b
                  funb = funb + temp592*temp592b0
                  rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp592b6 + &
&                    rmucos(i, 0)*temp592b7 + fun*2*rmu(i, 0)*temp592b0
                  cosphaseb(0) = cosphaseb(0) + fun0*temp592b5 + (-(&
&                    cost1d*2.d0*(fun0*temp593))-cost1d*2.d0*(fun*temp592&
&                    *rmucos(i, 0)**2))*hessb(i)
                  sinphaseb(i, 0) = sinphaseb(i, 0) + fun0*rphase(i)*&
&                    temp592b2
                  rphaseb(i) = rphaseb(i) + fun0*temp592b3
                END DO
              ELSE
                temp633b = cosphase(0)*hessb(2)
                temp629 = fun0/cellscale(2)
                temp632 = rmucos(2, 0)**2*temp629
                temp631 = rmu(2, 0)*rmusin(2, 0)
                temp630 = 4.d0*cost2d*pi*2.d0
                temp630b = temp630*temp633b
                temp629b = temp631*rmucos(2, 0)**2*temp630b/cellscale(2)
                temp628 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp629b0 = -(cost2d*2.d0*temp633b)
                temp628b = fun0*2*temp628*temp629b0
                temp627 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp626 = rmucos(2, 0)**2
                temp625 = rmu(2, 0)**2
                temp624 = temp625*fun*temp626
                temp625b = -(cost2d*2.d0*temp633b)
                temp624b = temp627*temp625b
                rmub(2, 0) = rmub(2, 0) + temp626*fun*2*rmu(2, 0)*&
&                  temp624b + temp632*rmusin(2, 0)*temp630b
                rmusinb(2, 0) = rmusinb(2, 0) + temp632*rmu(2, 0)*&
&                  temp630b - 2*rmusin(2, 0)*temp628b - temp624*2*rmusin(&
&                  2, 0)*temp625b
                rmucosb(2, 0) = rmucosb(2, 0) + temp624*2*rmucos(2, 0)*&
&                  temp625b + temp625*fun*2*rmucos(2, 0)*temp624b + 2*&
&                  rmucos(2, 0)*temp628b + temp631*temp629*2*rmucos(2, 0)&
&                  *temp630b
                temp624b0 = cosphase(0)*hessb(1)
                temp619 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp620b = cost2d*2.d0*temp624b0
                temp617 = rmu(1, 0)*rmusin(1, 0)
                temp616 = 4.d0*cost2d*pi*2.d0
                temp616b = -(temp616*temp624b0)
                temp615b = temp617*rmucos(1, 0)**2*temp616b/cellscale(1)
                temp614 = rmu(2, 0)*rmucos(2, 0)
                temp614b = cost2d*2.d0*hessb(2)
                temp614b0 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp614b
                temp613b = temp614*temp614b0
                temp611 = rmu(2, 0)*rmucos(2, 0)
                temp611b = -(cost2d*2.d0*zb(indorbp, indt+2))
                temp611b0 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp611b
                temp610 = rmu(1, 0)*rmucos(1, 0)
                temp610b = -(cost2d*2.d0*hessb(1))
                temp610b0 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp610b
                temp609b = temp610*temp610b0
                temp607 = rmu(1, 0)*rmucos(1, 0)
                temp607b1 = cost2d*2.d0*zb(indorbp, indt+1)
                temp607b2 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp607b1
                fun0b = fun0b + temp619**2*temp620b + temp615b + temp611&
&                  *cosphase(0)*temp611b0 + temp607*cosphase(0)*temp607b2&
&                  + sinphase(1, 0)*rphase(1)*temp609b + sinphase(2, 0)*&
&                  rphase(2)*temp613b + temp628**2*temp629b0 + temp629b
                cellscaleb(2) = cellscaleb(2) - temp629*temp629b
                temp623 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp622 = rmucos(1, 0)**2
                temp621 = rmu(1, 0)**2
                temp621b = cost2d*2.d0*temp624b0
                temp620b0 = temp623*temp621b
                funb = funb + temp622*temp621*temp620b0 + temp626*&
&                  temp625*temp624b
                temp620 = temp621*fun*temp622
                temp615 = fun0/cellscale(1)
                temp618 = rmucos(1, 0)**2*temp615
                cosphaseb(0) = cosphaseb(0) + (cost2d*2.d0*(temp620*&
&                  temp623)+cost2d*2.d0*(fun0*temp619**2)-temp616*(&
&                  temp617*temp618))*hessb(1) + temp607*fun0*temp607b2 + &
&                  temp611*fun0*temp611b0 + (temp630*(temp631*temp632)-&
&                  cost2d*2.d0*(fun0*temp628**2)-cost2d*2.d0*(temp624*&
&                  temp627))*hessb(2)
                temp619b = fun0*2*temp619*temp620b
                rmub(1, 0) = rmub(1, 0) + temp618*rmusin(1, 0)*temp616b &
&                  + temp622*fun*2*rmu(1, 0)*temp620b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp617*temp615*2*rmucos&
&                  (1, 0)*temp616b + 2*rmucos(1, 0)*temp619b + temp620*2*&
&                  rmucos(1, 0)*temp621b + temp621*fun*2*rmucos(1, 0)*&
&                  temp620b0
                rmusinb(1, 0) = rmusinb(1, 0) + temp618*rmu(1, 0)*&
&                  temp616b - 2*rmusin(1, 0)*temp619b - temp620*2*rmusin(&
&                  1, 0)*temp621b
                cellscaleb(1) = cellscaleb(1) - temp615*temp615b
                temp613 = sinphase(2, 0)*fun0*rphase(2)
                temp614b1 = temp614*temp613*temp614b
                temp612 = fun0*cosphase(0)
                temp611b1 = temp611*temp612*temp611b
                rmucosb(2, 0) = rmucosb(2, 0) + temp612*rmu(2, 0)*&
&                  temp611b0 + 2*rmucos(2, 0)*temp611b1 + temp613*rmu(2, &
&                  0)*temp614b0 + 2*rmucos(2, 0)*temp614b1
                rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp611b1&
&                  - 2*rmusin(2, 0)*temp614b1
                rmub(2, 0) = rmub(2, 0) + temp612*rmucos(2, 0)*temp611b0&
&                  + temp613*rmucos(2, 0)*temp614b0
                sinphaseb(2, 0) = sinphaseb(2, 0) + fun0*rphase(2)*&
&                  temp613b
                rphaseb(2) = rphaseb(2) + sinphase(2, 0)*fun0*temp613b
                temp609 = sinphase(1, 0)*fun0*rphase(1)
                temp610b1 = temp610*temp609*temp610b
                temp608 = fun0*cosphase(0)
                temp607b3 = temp607*temp608*temp607b1
                rmucosb(1, 0) = rmucosb(1, 0) + temp608*rmu(1, 0)*&
&                  temp607b2 + 2*rmucos(1, 0)*temp607b3 + temp609*rmu(1, &
&                  0)*temp610b0 + 2*rmucos(1, 0)*temp610b1
                rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp607b3&
&                  - 2*rmusin(1, 0)*temp610b1
                rmub(1, 0) = rmub(1, 0) + temp608*rmucos(1, 0)*temp607b2&
&                  + temp609*rmucos(1, 0)*temp610b0
                sinphaseb(1, 0) = sinphaseb(1, 0) + fun0*rphase(1)*&
&                  temp609b
                rphaseb(1) = rphaseb(1) + sinphase(1, 0)*fun0*temp609b
              END IF
            ELSE
              temp650 = fun*rmu(1, 0)*rmucos(1, 0)
              temp649 = rmusin(1, 0)**2 - rmucos(1, 0)**2
              temp646 = fun0/cellscale(1)
              temp648 = rmusin(1, 0)*rmucos(1, 0)
              temp647 = rmu(2, 0)*cosphase(0)
              temp647b = -(cost3d*(pi*4.d0*(temp648*temp646)+temp649*&
&                temp650)*hessb(1))
              temp647b0 = -(cost3d*temp647*rmucos(2, 0)*hessb(1))
              temp647b1 = pi*4.d0*temp647b0
              temp646b = temp648*temp647b1/cellscale(1)
              temp646b0 = temp649*rmucos(1, 0)*temp647b0
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*cosphase(0)*&
&                temp647b
              temp645 = fun*rmu(2, 0)*rmucos(2, 0)
              temp644 = rmusin(2, 0)**2 - rmucos(2, 0)**2
              temp641 = fun0/cellscale(2)
              temp643 = rmusin(2, 0)*rmucos(2, 0)
              temp642b = -(cost3d*(pi*4.d0*(temp643*temp641)+temp644*&
&                temp645)*hessb(2))
              temp637 = rmu(1, 0)*rmucos(1, 0)
              temp637b = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*zb(&
&                indorbp, indt+2)
              temp633 = rmu(2, 0)*rmucos(2, 0)
              temp633b0 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*zb(&
&                indorbp, indt+1)
              cosphaseb(0) = cosphaseb(0) + rmucos(1, 0)*rmu(1, 0)*&
&                temp642b + temp633*fun0*temp633b0 + temp637*fun0*&
&                temp637b + rmucos(2, 0)*rmu(2, 0)*temp647b
              rmucosb(2, 0) = rmucosb(2, 0) + temp647*temp647b
              rmusinb(1, 0) = rmusinb(1, 0) + temp650*2*rmusin(1, 0)*&
&                temp647b0 + temp646*rmucos(1, 0)*temp647b1
              temp642 = rmu(1, 0)*cosphase(0)
              rmucosb(1, 0) = rmucosb(1, 0) + temp642*temp642b + (&
&                temp649*fun*rmu(1, 0)-temp650*2*rmucos(1, 0))*temp647b0 &
&                + temp646*rmusin(1, 0)*temp647b1
              temp642b0 = -(cost3d*temp642*rmucos(1, 0)*hessb(2))
              temp642b1 = pi*4.d0*temp642b0
              temp641b = temp643*temp642b1/cellscale(2)
              temp639 = rmu(1, 0)*rmucos(1, 0)
              temp639b = -(cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                hessb(2))
              temp639b0 = temp639*sinphase(2, 0)*temp639b
              temp635 = rmu(2, 0)*rmucos(2, 0)
              temp635b = -(cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                hessb(1))
              temp635b0 = temp635*sinphase(1, 0)*temp635b
              fun0b = fun0b + temp641b + temp637*cosphase(0)*temp637b + &
&                temp633*cosphase(0)*temp633b0 + rphase(1)*temp635b0 + &
&                rphase(2)*temp639b0 + temp646b
              cellscaleb(1) = cellscaleb(1) - temp646*temp646b
              temp641b0 = temp644*rmucos(2, 0)*temp642b0
              funb = funb + rmu(2, 0)*temp641b0 + rmu(1, 0)*temp646b0
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*cosphase(0)*&
&                temp642b + fun*temp646b0
              temp640 = sinphase(2, 0)*fun0*rphase(2)
              temp639b1 = -(cost3d*temp639*temp640*hessb(2))
              temp638 = fun0*cosphase(0)
              temp637b0 = cost3d*temp637*temp638*zb(indorbp, indt+2)
              rmusinb(2, 0) = rmusinb(2, 0) + temp645*2*rmusin(2, 0)*&
&                temp642b0 - 2*rmusin(2, 0)*temp637b0 - 2*rmusin(2, 0)*&
&                temp639b1 + temp641*rmucos(2, 0)*temp642b1
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp639b1 +&
&                (temp644*fun*rmu(2, 0)-temp645*2*rmucos(2, 0))*temp642b0&
&                + temp641*rmusin(2, 0)*temp642b1
              cellscaleb(2) = cellscaleb(2) - temp641*temp641b
              rmub(2, 0) = rmub(2, 0) + fun*temp641b0
              rmub(1, 0) = rmub(1, 0) + temp638*rmucos(1, 0)*temp637b + &
&                temp640*rmucos(1, 0)*temp639b
              rmucosb(1, 0) = rmucosb(1, 0) + temp638*rmu(1, 0)*temp637b&
&                + temp640*rmu(1, 0)*temp639b
              sinphaseb(2, 0) = sinphaseb(2, 0) + temp639*fun0*rphase(2)&
&                *temp639b
              rphaseb(2) = rphaseb(2) + fun0*temp639b0
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp637b0
              temp636 = sinphase(1, 0)*fun0*rphase(1)
              temp635b1 = -(cost3d*temp635*temp636*hessb(1))
              rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp635b1
              temp634 = fun0*cosphase(0)
              temp633b1 = cost3d*temp633*temp634*zb(indorbp, indt+1)
              rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp633b1 -&
&                2*rmusin(1, 0)*temp635b1
              rmub(2, 0) = rmub(2, 0) + temp634*rmucos(2, 0)*temp633b0 +&
&                temp636*rmucos(2, 0)*temp635b
              rmucosb(2, 0) = rmucosb(2, 0) + temp634*rmu(2, 0)*&
&                temp633b0 + temp636*rmu(2, 0)*temp635b
              sinphaseb(1, 0) = sinphaseb(1, 0) + temp635*fun0*rphase(1)&
&                *temp635b
              rphaseb(1) = rphaseb(1) + fun0*temp635b0
              rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp633b1
            END IF
          ELSE IF (branch .LT. 5) THEN
            IF (branch .LT. 4) THEN
              temp668 = fun*rmu(3, 0)*rmucos(3, 0)
              temp667 = rmusin(3, 0)**2 - rmucos(3, 0)**2
              temp664 = fun0/cellscale(3)
              temp666 = rmusin(3, 0)*rmucos(3, 0)
              temp665 = rmu(2, 0)*cosphase(0)
              temp665b = -(cost3d*(pi*4.d0*(temp666*temp664)+temp667*&
&                temp668)*hessb(3))
              temp665b0 = -(cost3d*temp665*rmucos(2, 0)*hessb(3))
              temp665b1 = pi*4.d0*temp665b0
              temp664b = temp666*temp665b1/cellscale(3)
              temp664b0 = temp667*rmucos(3, 0)*temp665b0
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*cosphase(0)*&
&                temp665b
              temp663 = fun*rmu(2, 0)*rmucos(2, 0)
              temp662 = rmusin(2, 0)**2 - rmucos(2, 0)**2
              temp659 = fun0/cellscale(2)
              temp661 = rmusin(2, 0)*rmucos(2, 0)
              temp660b = -(cost3d*(pi*4.d0*(temp661*temp659)+temp662*&
&                temp663)*hessb(2))
              temp655 = rmu(2, 0)*rmucos(2, 0)
              temp655b = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*zb(&
&                indorbp, indt+3)
              temp651 = rmu(3, 0)*rmucos(3, 0)
              temp651b = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*zb(&
&                indorbp, indt+2)
              cosphaseb(0) = cosphaseb(0) + rmucos(3, 0)*rmu(3, 0)*&
&                temp660b + temp651*fun0*temp651b + temp655*fun0*temp655b&
&                + rmucos(2, 0)*rmu(2, 0)*temp665b
              rmucosb(2, 0) = rmucosb(2, 0) + temp665*temp665b
              rmusinb(3, 0) = rmusinb(3, 0) + temp668*2*rmusin(3, 0)*&
&                temp665b0 + temp664*rmucos(3, 0)*temp665b1
              temp660 = rmu(3, 0)*cosphase(0)
              rmucosb(3, 0) = rmucosb(3, 0) + temp660*temp660b + (&
&                temp667*fun*rmu(3, 0)-temp668*2*rmucos(3, 0))*temp665b0 &
&                + temp664*rmusin(3, 0)*temp665b1
              temp660b0 = -(cost3d*temp660*rmucos(3, 0)*hessb(2))
              temp660b1 = pi*4.d0*temp660b0
              temp659b = temp661*temp660b1/cellscale(2)
              temp657 = rmu(2, 0)*rmucos(2, 0)
              temp657b = -(cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                hessb(3))
              temp657b0 = temp657*sinphase(3, 0)*temp657b
              temp653 = rmu(3, 0)*rmucos(3, 0)
              temp653b = -(cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                hessb(2))
              temp653b0 = temp653*sinphase(2, 0)*temp653b
              fun0b = fun0b + temp659b + temp655*cosphase(0)*temp655b + &
&                temp651*cosphase(0)*temp651b + rphase(2)*temp653b0 + &
&                rphase(3)*temp657b0 + temp664b
              cellscaleb(3) = cellscaleb(3) - temp664*temp664b
              temp659b0 = temp662*rmucos(2, 0)*temp660b0
              funb = funb + rmu(2, 0)*temp659b0 + rmu(3, 0)*temp664b0
              rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*cosphase(0)*&
&                temp660b + fun*temp664b0
              rmusinb(2, 0) = rmusinb(2, 0) + temp663*2*rmusin(2, 0)*&
&                temp660b0 + temp659*rmucos(2, 0)*temp660b1
              rmucosb(2, 0) = rmucosb(2, 0) + (temp662*fun*rmu(2, 0)-&
&                temp663*2*rmucos(2, 0))*temp660b0 + temp659*rmusin(2, 0)&
&                *temp660b1
              cellscaleb(2) = cellscaleb(2) - temp659*temp659b
              temp658 = sinphase(3, 0)*fun0*rphase(3)
              temp656 = fun0*cosphase(0)
              rmub(2, 0) = rmub(2, 0) + temp658*rmucos(2, 0)*temp657b + &
&                temp656*rmucos(2, 0)*temp655b + fun*temp659b0
              temp657b1 = -(cost3d*temp657*temp658*hessb(3))
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp657b1
              temp655b0 = cost3d*temp655*temp656*zb(indorbp, indt+3)
              rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp655b0 -&
&                2*rmusin(3, 0)*temp657b1
              rmucosb(2, 0) = rmucosb(2, 0) + temp656*rmu(2, 0)*temp655b&
&                + temp658*rmu(2, 0)*temp657b
              sinphaseb(3, 0) = sinphaseb(3, 0) + temp657*fun0*rphase(3)&
&                *temp657b
              rphaseb(3) = rphaseb(3) + fun0*temp657b0
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp655b0
              temp654 = sinphase(2, 0)*fun0*rphase(2)
              temp653b1 = -(cost3d*temp653*temp654*hessb(2))
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp653b1
              temp652 = fun0*cosphase(0)
              temp651b0 = cost3d*temp651*temp652*zb(indorbp, indt+2)
              rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp651b0 -&
&                2*rmusin(2, 0)*temp653b1
              rmub(3, 0) = rmub(3, 0) + temp652*rmucos(3, 0)*temp651b + &
&                temp654*rmucos(3, 0)*temp653b
              rmucosb(3, 0) = rmucosb(3, 0) + temp652*rmu(3, 0)*temp651b&
&                + temp654*rmu(3, 0)*temp653b
              sinphaseb(2, 0) = sinphaseb(2, 0) + temp653*fun0*rphase(2)&
&                *temp653b
              rphaseb(2) = rphaseb(2) + fun0*temp653b0
              rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp651b0
            END IF
          ELSE
            temp686 = fun*rmu(3, 0)*rmucos(3, 0)
            temp685 = rmusin(3, 0)**2 - rmucos(3, 0)**2
            temp682 = fun0/cellscale(3)
            temp684 = rmusin(3, 0)*rmucos(3, 0)
            temp683 = rmu(1, 0)*cosphase(0)
            temp683b = -(cost3d*(pi*4.d0*(temp684*temp682)+temp685*&
&              temp686)*hessb(3))
            temp683b0 = -(cost3d*temp683*rmucos(1, 0)*hessb(3))
            temp683b1 = pi*4.d0*temp683b0
            temp682b = temp684*temp683b1/cellscale(3)
            temp682b0 = temp685*rmucos(3, 0)*temp683b0
            rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*cosphase(0)*temp683b
            temp681 = fun*rmu(1, 0)*rmucos(1, 0)
            temp680 = rmusin(1, 0)**2 - rmucos(1, 0)**2
            temp677 = fun0/cellscale(1)
            temp679 = rmusin(1, 0)*rmucos(1, 0)
            temp678b = -(cost3d*(pi*4.d0*(temp679*temp677)+temp680*&
&              temp681)*hessb(1))
            temp673 = rmu(1, 0)*rmucos(1, 0)
            temp673b = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*zb(&
&              indorbp, indt+3)
            temp669 = rmu(3, 0)*rmucos(3, 0)
            temp669b = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*zb(&
&              indorbp, indt+1)
            cosphaseb(0) = cosphaseb(0) + rmucos(3, 0)*rmu(3, 0)*&
&              temp678b + temp669*fun0*temp669b + temp673*fun0*temp673b +&
&              rmucos(1, 0)*rmu(1, 0)*temp683b
            rmucosb(1, 0) = rmucosb(1, 0) + temp683*temp683b
            rmusinb(3, 0) = rmusinb(3, 0) + temp686*2*rmusin(3, 0)*&
&              temp683b0 + temp682*rmucos(3, 0)*temp683b1
            temp678 = rmu(3, 0)*cosphase(0)
            rmucosb(3, 0) = rmucosb(3, 0) + temp678*temp678b + (temp685*&
&              fun*rmu(3, 0)-temp686*2*rmucos(3, 0))*temp683b0 + temp682*&
&              rmusin(3, 0)*temp683b1
            temp678b0 = -(cost3d*temp678*rmucos(3, 0)*hessb(1))
            temp678b1 = pi*4.d0*temp678b0
            temp677b = temp679*temp678b1/cellscale(1)
            temp675 = rmu(1, 0)*rmucos(1, 0)
            temp675b = -(cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hessb(&
&              3))
            temp675b0 = temp675*sinphase(3, 0)*temp675b
            temp671 = rmu(3, 0)*rmucos(3, 0)
            temp671b = -(cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hessb(&
&              1))
            temp671b0 = temp671*sinphase(1, 0)*temp671b
            fun0b = fun0b + temp677b + temp673*cosphase(0)*temp673b + &
&              temp669*cosphase(0)*temp669b + rphase(1)*temp671b0 + &
&              rphase(3)*temp675b0 + temp682b
            cellscaleb(3) = cellscaleb(3) - temp682*temp682b
            temp677b0 = temp680*rmucos(1, 0)*temp678b0
            funb = funb + rmu(1, 0)*temp677b0 + rmu(3, 0)*temp682b0
            rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*cosphase(0)*temp678b &
&              + fun*temp682b0
            rmusinb(1, 0) = rmusinb(1, 0) + temp681*2*rmusin(1, 0)*&
&              temp678b0 + temp677*rmucos(1, 0)*temp678b1
            rmucosb(1, 0) = rmucosb(1, 0) + (temp680*fun*rmu(1, 0)-&
&              temp681*2*rmucos(1, 0))*temp678b0 + temp677*rmusin(1, 0)*&
&              temp678b1
            cellscaleb(1) = cellscaleb(1) - temp677*temp677b
            temp676 = sinphase(3, 0)*fun0*rphase(3)
            temp674 = fun0*cosphase(0)
            rmub(1, 0) = rmub(1, 0) + temp676*rmucos(1, 0)*temp675b + &
&              temp674*rmucos(1, 0)*temp673b + fun*temp677b0
            temp675b1 = -(cost3d*temp675*temp676*hessb(3))
            rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp675b1
            temp673b0 = cost3d*temp673*temp674*zb(indorbp, indt+3)
            rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp673b0 - 2&
&              *rmusin(3, 0)*temp675b1
            rmucosb(1, 0) = rmucosb(1, 0) + temp674*rmu(1, 0)*temp673b +&
&              temp676*rmu(1, 0)*temp675b
            sinphaseb(3, 0) = sinphaseb(3, 0) + temp675*fun0*rphase(3)*&
&              temp675b
            rphaseb(3) = rphaseb(3) + fun0*temp675b0
            rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp673b0
            temp672 = sinphase(1, 0)*fun0*rphase(1)
            temp671b1 = -(cost3d*temp671*temp672*hessb(1))
            rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp671b1
            temp670 = fun0*cosphase(0)
            temp669b0 = cost3d*temp669*temp670*zb(indorbp, indt+1)
            rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp669b0 - 2&
&              *rmusin(1, 0)*temp671b1
            rmub(3, 0) = rmub(3, 0) + temp670*rmucos(3, 0)*temp669b + &
&              temp672*rmucos(3, 0)*temp671b
            rmucosb(3, 0) = rmucosb(3, 0) + temp670*rmu(3, 0)*temp669b +&
&              temp672*rmu(3, 0)*temp671b
            sinphaseb(1, 0) = sinphaseb(1, 0) + temp671*fun0*rphase(1)*&
&              temp671b
            rphaseb(1) = rphaseb(1) + fun0*temp671b0
            rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp669b0
          END IF
          DO i=3,1,-1
            temp591 = fun*rphase(i)
            temp590 = rmu(i, 0)*rmucos(i, 0)
            temp590b = -(temp590*temp591*hessb(i))
            temp590b0 = -(distp(0, 1+ic)*sinphase(i, 0)*hessb(i))
            temp590b1 = -(rphase(i)**2*hessb(i))
            temp590b2 = distp(0, 1+ic)*temp590b1
            temp589 = sinphase(i, 0)*rmu(i, 0)
            temp588 = fun*rphase(i)
            temp588b = -(temp588*temp589*hessb(i))
            temp588b0 = -(distp(0, 1+ic)*rmucos(i, 0)*hessb(i))
            temp588b1 = -(sinphase(i, 0)*hess3d(i, ic)*hessb(i))
            temp588b2 = -(fun0*rphase(i)*hessb(i))
            temp588b3 = cosphase(0)*hessb(i)
            temp587 = rmucos(i, 0)**2
            temp586 = rmu(i, 0)**2
            temp585 = rmucos(i, 0)**2 - rmusin(i, 0)**2
            temp584 = fun2*temp586*temp587 + fun*temp585
            temp582b22 = rmu(i, 0)*rmucos(i, 0)*zb(indorbp, indt+i)
            temp582b23 = -(fun0*rphase(i)*zb(indorbp, indt+i))
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp584*temp588b3 + &
&              sinphase(i, 0)*temp582b23 + fun*cosphase(0)*temp582b22 + &
&              rmucos(i, 0)*temp588b + fun0*cosphase(0)*temp590b1 + &
&              sinphase(i, 0)*temp590b
            sinphaseb(i, 0) = sinphaseb(i, 0) + distp(0, 1+ic)*&
&              temp582b23 + hess3d(i, ic)*temp588b2 + temp588*rmu(i, 0)*&
&              temp588b0 + distp(0, 1+ic)*temp590b
            temp584b = distp(0, 1+ic)*temp588b3
            temp582 = hess3d(i, ic)*rmucos(i, 0)
            temp582b24 = distp(0, 1+ic)*fun*cosphase(0)*zb(indorbp, indt&
&              +i)
            rmub(i, 0) = rmub(i, 0) + temp587*fun2*2*rmu(i, 0)*temp584b &
&              + temp582*fun*temp588b3 + rmucos(i, 0)*temp582b24 + &
&              temp588*sinphase(i, 0)*temp588b0 + temp591*rmucos(i, 0)*&
&              temp590b0
            temp583 = fun*rmu(i, 0)
            rmucosb(i, 0) = rmucosb(i, 0) + (fun*2*rmucos(i, 0)+fun2*&
&              temp586*2*rmucos(i, 0))*temp584b + temp583*hess3d(i, ic)*&
&              temp588b3 + rmu(i, 0)*temp582b24 + distp(0, 1+ic)*temp588b&
&              + temp591*rmu(i, 0)*temp590b0
            temp582b25 = distp(0, 1+ic)*temp582b22
            funb = funb + temp585*temp584b + temp582*rmu(i, 0)*temp588b3&
&              + cosphase(0)*temp582b25 + temp589*rphase(i)*temp588b0 + &
&              temp590*rphase(i)*temp590b0
            temp582b26 = -(distp(0, 1+ic)*sinphase(i, 0)*zb(indorbp, &
&              indt+i))
            rphaseb(i) = rphaseb(i) + fun0*temp582b26 + fun0*temp588b1 +&
&              temp589*fun*temp588b0 - distp(0, 1+ic)*fun0*cosphase(0)*2*&
&              rphase(i)*hessb(i) + temp590*fun*temp590b0
            fun0b = fun0b + rphase(i)*temp582b26 + rphase(i)*temp588b1 +&
&              cosphase(0)*temp590b2
            cosphaseb(0) = cosphaseb(0) + (temp584*distp(0, 1+ic)+&
&              temp582*temp583)*hessb(i) + fun*temp582b25 + fun0*&
&              temp590b2
            hess3db(i, ic) = hess3db(i, ic) + temp583*rmucos(i, 0)*&
&              temp588b3 + sinphase(i, 0)*temp588b2
            fun2b = fun2b + temp587*temp586*temp584b
            rmusinb(i, 0) = rmusinb(i, 0) - fun*2*rmusin(i, 0)*temp584b
            hessb(i) = 0.0_8
            zb(indorbp, indt+i) = 0.D0
          END DO
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      temp582b = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hess3db(3, 5)
      temp582b0 = cost3d*rmu(1, 0)*rmucos(1, 0)*hess3db(3, 5)
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp582b
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp582b
      hess3db(3, 5) = 0.0_8
      temp582b1 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hess3db(1, 5)
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp582b1 + 2*rmucos(3, &
&        0)*temp582b0
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp582b0
      temp582b2 = cost3d*rmu(3, 0)*rmucos(3, 0)*hess3db(1, 5)
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp582b1
      rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp582b2
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp582b2
      hess3db(1, 5) = 0.0_8
      temp582b3 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*hess3db(3, 4)
      temp582b4 = cost3d*rmu(2, 0)*rmucos(2, 0)*hess3db(3, 4)
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp582b3
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp582b3
      hess3db(3, 4) = 0.0_8
      temp582b5 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*hess3db(2, 4)
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp582b5 + 2*rmucos(3, &
&        0)*temp582b4
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp582b4
      temp582b6 = cost3d*rmu(3, 0)*rmucos(3, 0)*hess3db(2, 4)
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp582b5
      hess3db(2, 4) = 0.0_8
      temp582b7 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*hess3db(1, 3)
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp582b7 + 2*rmucos(2, &
&        0)*temp582b6
      rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp582b6
      temp582b8 = cost3d*rmu(2, 0)*rmucos(2, 0)*hess3db(1, 3)
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp582b7
      hess3db(1, 3) = 0.0_8
      temp582b9 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*hess3db(2, 3)
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp582b9 + 2*rmucos(1, &
&        0)*temp582b8
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp582b8
      temp582b10 = cost3d*rmu(1, 0)*rmucos(1, 0)*hess3db(2, 3)
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp582b9
      hess3db(2, 3) = 0.0_8
      temp582b11 = -(cost2d*2.d0*hess3db(2, 2))
      temp582b12 = (rmucos(2, 0)**2-rmusin(2, 0)**2)*temp582b11
      temp582b13 = rmu(2, 0)*rmucos(2, 0)*temp582b11
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp582b12 + 2*rmucos(2&
&        , 0)*temp582b13 + 2*rmucos(2, 0)*temp582b10
      rmusinb(2, 0) = rmusinb(2, 0) - 2*rmusin(2, 0)*temp582b13 - 2*&
&        rmusin(2, 0)*temp582b10
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp582b12
      hess3db(2, 2) = 0.0_8
      temp582b14 = cost2d*2.d0*hess3db(1, 2)
      temp582b15 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp582b14
      temp582b16 = rmu(1, 0)*rmucos(1, 0)*temp582b14
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp582b15
      rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*temp582b16 + rmu(1&
&        , 0)*temp582b15
      rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*temp582b16
      hess3db(1, 2) = 0.0_8
      temp582b17 = cost1d*6.d0*hess3db(3, 1)
      temp582b18 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp582b17
      temp582b19 = rmu(3, 0)*rmucos(3, 0)*temp582b17
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp582b18
      rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp582b19 + rmu(3&
&        , 0)*temp582b18
      rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*temp582b19
      temp582b20 = -(cost1d*2.d0*hess3db(:, 1))
      rmub(:, 0) = rmub(:, 0) + rmucos(:, 0)*temp582b20
      rmucosb(:, 0) = rmucosb(:, 0) + rmu(:, 0)*temp582b20
      temp582b21 = fun2b/r(0)**2
      temp580 = c0*r(0) + c1
      temp581 = dd1**2*distp(0, 1)
      temp580b = temp581*temp582b21
      temp580b0 = -(2*distp(0, 1)*temp582b21)
      funb = funb - temp582b21
      temp580b1 = funb/r(0)
      temp579 = c0*r(0) + c1
      dd1b = c0*temp580b0 - temp579*distp(0, 1)*temp580b1 + temp580*&
&        distp(0, 1)*2*dd1*temp582b21
      distpb(0, 1) = distpb(0, 1) + (c0-temp579*dd1)*temp580b1 + (&
&        temp580*dd1**2-2*dd1*c0)*temp582b21
      temp579b12 = -(dd1*distp(0, 1)*temp580b1)
      c0b = distp(0, 1)*temp580b1 + r(0)*temp579b12 + dd1*temp580b0 + r(&
&        0)*temp580b
      rb(0) = rb(0) + c0*temp579b12 - (distp(0, 1)*c0-dd1*distp(0, 1)*&
&        temp579)*temp580b1/r(0) - (temp581*temp580-fun-2*(distp(0, 1)*(&
&        dd1*c0)))*2*temp582b21/r(0) + c0*temp580b
      c1b = temp579b12 + temp580b
      distpb(0, 7) = distpb(0, 7) + fun0b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
    END IF
    DO ic=5,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp579b11 = distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 7) = distpb(k, 7) + cosphase(k)*temp579b11
          cosphaseb(k) = cosphaseb(k) + distp(k, 7)*temp579b11
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 7)*cosphase(k)*zb&
&            (indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      temp579b2 = cost3d*rmucos(1, i)*rmucos(3, i)*distpb(i, 6)
      temp579b3 = cost3d*rmu(1, i)*rmu(3, i)*distpb(i, 6)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp579b2
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp579b2
      rmucosb(1, i) = rmucosb(1, i) + rmucos(3, i)*temp579b3
      rmucosb(3, i) = rmucosb(3, i) + rmucos(1, i)*temp579b3
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      temp579b4 = cost3d*rmucos(2, i)*rmucos(3, i)*distpb(i, 5)
      temp579b5 = cost3d*rmu(2, i)*rmu(3, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp579b4
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp579b4
      rmucosb(2, i) = rmucosb(2, i) + rmucos(3, i)*temp579b5
      rmucosb(3, i) = rmucosb(3, i) + rmucos(2, i)*temp579b5
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      temp579b6 = cost3d*rmucos(1, i)*rmucos(2, i)*distpb(i, 4)
      temp579b7 = cost3d*rmu(1, i)*rmu(2, i)*distpb(i, 4)
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp579b6
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp579b6
      rmucosb(1, i) = rmucosb(1, i) + rmucos(2, i)*temp579b7
      rmucosb(2, i) = rmucosb(2, i) + rmucos(1, i)*temp579b7
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      temp579b8 = cost2d*2*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      temp579b9 = -(cost2d*2*rmu(2, i)*rmucos(2, i)*distpb(i, 3))
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp579b8
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp579b8
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp579b9
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp579b9
      distpb(i, 3) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 2))
      temp579b10 = cost1d*distpb(i, 2)
      rmub(3, i) = rmub(3, i) + 3.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp579b10
      rmucosb(3, i) = rmucosb(3, i) + 3.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp579b10
      rb(i) = rb(i) - 2*r(i)*temp579b10
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    DO k=0,0,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(k, 7))
      temp579b0 = distp(k, 1)*distpb(k, 7)
      distpb(k, 1) = distpb(k, 1) + (c0*r(k)+c1)*distpb(k, 7)
      c0b = c0b + r(k)*temp579b0
      distpb(k, 7) = 0.0_8
      temp579b1 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) + c0*temp579b0 - dd1*temp579b1
      c1b = c1b + temp579b0
      dd1b = dd1b - r(k)*temp579b1
      distpb(k, 1) = 0.0_8
    END DO
    temp579b = 3.5d0*c1b/dd1
    cb = temp579b - c0b
    dd1b = dd1b + 0.26596152026762178d0*3.5d0*dd1**2.5D0*cb - c*temp579b&
&      /dd1
    ddb(indparp) = ddb(indparp) + dd1b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indpar+1) = -ddb(indpar+1)
  CASE (48)
! f single gaussian orbital
! radial R(r)= exp(-alpha r^2)
! normalized
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! Y_i are the stretched coordinates for the angular part A
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(Y_i(x_i)) \phi(x_i)
! R depends on X_i, A depends on Y_i, the phase \phi depends on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! where  d^2/dx^2_k F(X_i(x_i)) = (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dY^2_k A)  ((d/dx_k Y_i) (x_i))^2
!                      + R  (d/dY_k A)  (d^2/dx^2_k Y_i) (x_i)
!                      + 2 (d/dX_k R)  (d/dY_k A)   (d/dx_k X_i) (x_i)  (d/dx_k Y_i) (x_i)
! X_i = rmu
! Y_i = rmu * rmucos
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
! d/dx_k Y_i  =  2 * rmucos**2  - 1
! d^2/dx^2_k Y_i = - 4*Pi/L * rmusin * rmucos
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
!         c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)
    c = dd1**2.25d0*1.47215808929909374563d0
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = (rmu(1, i)*rmucos(1, i))**2 + (rmu(2, i)*rmucos(2, i))**2 + &
&        (rmu(3, i)*rmucos(3, i))**2
!     proposal  SSS
!     rp0=r(k)**2
      distp(i, 2) = cost1f*rmu(3, i)*rmucos(3, i)*(5.d0*(rmu(3, i)*&
&        rmucos(3, i))**2-3.d0*rp0)
!     proposal SSS
!     distp(i,2)=cost1f*rmu(3,i)*rmucos(3,i)               &
!    &  *(5.d0*rmu(3,i)**2-3.d0*rp0)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*rmucos(1, i)*(5.d0*(rmu(3, i)*&
&        rmucos(3, i))**2-rp0)
!     proposal SSS
!     distp(i,3)=cost2f*rmu(1,i)*rmucos(1,i)               &
!    &  *(5.d0*rmu(3,i)**2-rp0)
! lz=+/-1
      distp(i, 4) = cost2f*rmu(2, i)*rmucos(2, i)*(5.d0*(rmu(3, i)*&
&        rmucos(3, i))**2-rp0)
!     proposal SSS
!     distp(i,4)=cost2f*rmu(2,i)*rmucos(2,i)               &
!    &  *(5.d0*rmu(3,i)**2-rp0)
! lz=+/-1
      distp(i, 5) = cost3f*rmu(3, i)*rmucos(3, i)*((rmu(1, i)*rmucos(1, &
&        i))**2-(rmu(2, i)*rmucos(2, i))**2)
!     proposal SSS
!     distp(i,5)=cost3f*rmu(3,i)*rmucos(3,i)               &
!    &  *(rmu(1,i)**2-rmu(2,i)**2)
! lz=+/-2
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmucos(3, i)*rmu(1, i)*rmucos(&
&        1, i)*rmu(2, i)*rmucos(2, i)
!     proposal SSS --> the same this is the most singular orbital with 3 rmucos.
! lz=+/-2
      distp(i, 7) = cost4f*rmu(1, i)*rmucos(1, i)*((rmu(1, i)*rmucos(1, &
&        i))**2-3.d0*(rmu(2, i)*rmucos(2, i))**2)
! lz=+/-3
!     proposal SSS
!     distp(i,7)=cost4f*rmu(1,i)*rmucos(1,i)                &
!    &  *(rmu(1,i)**2-3.d0*rmu(2,i)**2)
      distp(i, 8) = cost4f*rmu(2, i)*rmucos(2, i)*(3.d0*(rmu(1, i)*&
&        rmucos(1, i))**2-(rmu(2, i)*rmucos(2, i))**2)
    END DO
! lz=+/-3
!     proposal SSS
!     distp(i,8)=cost4f*rmu(2,i)*rmucos(2,i)                &
!    &  *(3.d0*rmu(1,i)**2-rmu(2,i)**2)
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,7
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*distp(k, 1+ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = (rmu(1, 0)*rmucos(1, 0))**2 + (rmu(2, 0)*rmucos(2, 0))**2 + &
&        (rmu(3, 0)*rmucos(3, 0))**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,7
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part
! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            der4f(2) = 0.d0
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
            hess4f(2) = 0.d0
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
            hess4f(3) = 0.d0
! contribution of the angular part
            IF (ic .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
! rp1 =   d/dx_k angular
! rp2 =   d^2/dx^2_k angular
              rp1 = -(6.d0*cost1f*rmu(i, 0)*rmucos(i, 0)*rmu(3, 0)*&
&                rmucos(3, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = -(6.d0*cost1f*rmu(3, 0)*rmucos(3, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
! der4f(2)  = der4f(2)  +  fun0 * d/dx_k angular
! hess4f(2) = hess4f(2) +  fun0 * d^2/dx^2_k angular
! hess4f(3) = hess4f(3) +  2 * fun * x_k * d/dx_k angular
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost1f*(15.d0*(rmu(i, 0)*rmucos(i, 0))**2-3.d0*rp0&
&                  )
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost1f*18.d0*rmu(i, 0)*rmucos(i, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = -(2.d0*cost2f*rmu(i, 0)*rmucos(i, 0)*rmu(1, 0)*&
&                rmucos(1, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2f*(5.d0*(rmu(3, 0)*rmucos(3, 0))**2-rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(cost2f*4.d0*rmu(i, 0)*rmucos(i, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 10.d0*cost2f*rmu(i, 0)*rmucos(i, 0)*rmu(1, 0)*&
&                  rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 10.d0*cost2f*rmu(1, 0)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = -(2.d0*cost2f*rmu(i, 0)*rmucos(i, 0)*rmu(2, 0)*&
&                rmucos(2, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = -(2.d0*cost2f*rmu(2, 0)*rmucos(2, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2f*(5.d0*(rmu(3, 0)*rmucos(3, 0))**2-rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(cost2f*4.d0*rmu(i, 0)*rmucos(i, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 10.d0*cost2f*rmu(i, 0)*rmucos(i, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 10.d0*cost2f*rmu(2, 0)*rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 2.d0*cost3f*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = -(2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(2.d0*cost3f*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3f*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, 0)*&
&                  rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 3.d0*cost4f*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, 0&
&                  )*rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = -(6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(6.d0*cost4f*rmu(1, 0)*rmucos(1, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = 6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*rmucos(&
&                2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = 6.d0*cost4f*rmu(2, 0)*rmucos(2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = 3.d0*cost4f*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, 0)*&
&                rmucos(2, 0))**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = -(6.d0*cost4f*rmu(2, 0)*rmucos(2, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
!enddo for i
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)*(2.d0*&
&              rmucos(i, 0)**2-1.d0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dY^2_k A)  ((d/dx_k Y_i) (x_i))^2
!                      + R  (d/dY_k A)  (d^2/dx^2_k Y_i) (x_i)
!                      + 2 (d/dX_k R)  (d/dY_k A)   (d/dx_k X_i) (x_i)  (d/dx_k Y_i) (x_i)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2)*(2.d0*rmucos(i, 0)**&
&              2-1.d0)**2 - der4f(2)*4.d0*pi/cellscale(i)*rmusin(i, 0)*&
&              rmucos(i, 0) + hess4f(3)*rmucos(i, 0)*(2.d0*rmucos(i, 0)**&
&              2-1.d0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*distp(0, 1+ic)*&
&              cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*distp(0, 1+ic)*sinphase(i, 0)*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=7,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp701b = -(distp(0, 1)*rphase(i)*zb(indorbp, indt+i))
            temp701b0 = -(distp(0, 1+ic)*sinphase(i, 0)*zb(indorbp, indt&
&              +i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp701b1 = -(distp(0, 1+ic)*rphase(i)**2*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + distp(0&
&              , 1)*temp701b1 + z(indorbp, indt+i)*zb(indorbp, indt+i)
            distpb(0, 1+ic) = distpb(0, 1+ic) + sinphase(i, 0)*temp701b
            temp701b2 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp701b2 + &
&              distp(0, 1+ic)*temp701b
            distpb(0, 1) = distpb(0, 1) + cosphase(0)*temp701b1 + rphase&
&              (i)*temp701b0
            temp701b3 = -(distp(0, 1)*cosphase(0)*hess4fb(1))
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp701b2 + distp(0&
&              , 1+ic)*2*rphase(i)*temp701b3 + distp(0, 1)*temp701b0
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + rphase(i)**2*temp701b3
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp700 = der4f(1)/cellscale(i)
            temp700b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            temp699 = 2.d0*rmucos(i, 0)**2 - 1.d0
            temp699b = (2.d0*rmucos(i, 0)**2-1.d0)*hess4fb(1)
            temp698 = der4f(2)/cellscale(i)
            temp699b0 = -(pi*4.d0*hess4fb(1))
            temp699b1 = temp698*temp699b0
            temp698b79 = rmusin(i, 0)*rmucos(i, 0)*temp699b0/cellscale(i&
&              )
            rmucosb(i, 0) = rmucosb(i, 0) + (der4f(2)*2.d0*2*rmucos(i, 0&
&              )+der4f(1))*zb(indorbp, indt+i) + rmusin(i, 0)*temp699b1 +&
&              hess4f(3)*temp699b + (2*(hess4f(3)*rmucos(i, 0)**2*2.d0)+&
&              hess4f(2)*2**2*temp699*2.d0*rmucos(i, 0)+hess4f(1)*2*&
&              rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) + rmucos(i, 0)*temp699b1 - pi*&
&              temp700*hess4fb(1)
            der4fb(1) = der4fb(1) + temp700b
            cellscaleb(i) = cellscaleb(i) - temp698*temp698b79 - temp700&
&              *temp700b
            hess4fb(2) = hess4fb(2) + temp699**2*hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*temp699b
            der4fb(2) = der4fb(2) + temp698b79
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i)
            der4fb(2) = der4fb(2) + (2.d0*rmucos(i, 0)**2-1.d0)*zb(&
&              indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 10) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    IF (.NOT.branch .LT. 1) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      temp698b5 = 2.d0*rmu(i, 0)*hess4fb(3)
                      funb = funb + rp1*temp698b5
                      rp1b = fun0*der4fb(2) + fun*temp698b5
                      rp2b = fun0*hess4fb(2)
                      temp698b6 = cost1f*18.d0*rp2b
                      temp698b7 = cost1f*rp1b
                      rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp698b6 +&
&                        15.d0*rmucos(i, 0)**2*2*rmu(i, 0)*temp698b7 + &
&                        2.d0*fun*rp1*hess4fb(3)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                      rmucosb(i, 0) = rmucosb(i, 0) + 15.d0*rmu(i, 0)**2&
&                        *2*rmucos(i, 0)*temp698b7 + rmu(i, 0)*temp698b6
                      CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                      rp0b = rp0b - 3.d0*temp698b7
                    END IF
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp698b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp698b0
                    rp1b = fun0*der4fb(2) + fun*temp698b0
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp698b1 = -(cost1f*6.d0*rp2b)
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp698b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp698b1
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp698b2 = -(cost1f*6.d0*rp1b)
                    temp698b3 = rmu(3, 0)*rmucos(3, 0)*temp698b2
                    temp698b4 = rmu(i, 0)*rmucos(i, 0)*temp698b2
                    rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp698b3
                    rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp698b3
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp698b4
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp698b4
                    GOTO 100
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp698b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp698b13
                    rp1b = fun0*der4fb(2) + fun*temp698b13
                    rp2b = fun0*hess4fb(2)
                    temp698b14 = -(cost2f*4.d0*rp2b)
                    rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp698b14 + &
&                      2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp698b14
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp698b15 = cost2f*rp1b
                    rmub(3, 0) = rmub(3, 0) + 5.d0*rmucos(3, 0)**2*2*rmu&
&                      (3, 0)*temp698b15
                    rmucosb(3, 0) = rmucosb(3, 0) + 5.d0*rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp698b15
                    rp0b = rp0b - temp698b15
                  END IF
                ELSE IF (.NOT.branch .LT. 4) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp698b16 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp698b16
                  rp1b = fun0*der4fb(2) + fun*temp698b16
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp698b17 = cost2f*10.d0*rp2b
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b17
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b17
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp698b18 = cost2f*10.d0*rp1b
                  temp698b19 = rmu(1, 0)*rmucos(1, 0)*temp698b18
                  temp698b20 = rmu(i, 0)*rmucos(i, 0)*temp698b18
                  rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp698b19
                  rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp698b19
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b20
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b20
                END IF
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp698b8 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp698b8
                rp1b = fun0*der4fb(2) + fun*temp698b8
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp698b9 = -(cost2f*2.d0*rp2b)
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b9
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b9
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp698b10 = -(cost2f*2.d0*rp1b)
                temp698b11 = rmu(1, 0)*rmucos(1, 0)*temp698b10
                temp698b12 = rmu(i, 0)*rmucos(i, 0)*temp698b10
                rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp698b11
                rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp698b11
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b12
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b12
              ELSE IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  IF (branch .LT. 6) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp698b26 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp698b26
                    rp1b = fun0*der4fb(2) + fun*temp698b26
                    rp2b = fun0*hess4fb(2)
                    temp698b27 = -(cost2f*4.d0*rp2b)
                    rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp698b27 + &
&                      2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp698b27
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp698b28 = cost2f*rp1b
                    rmub(3, 0) = rmub(3, 0) + 5.d0*rmucos(3, 0)**2*2*rmu&
&                      (3, 0)*temp698b28
                    rmucosb(3, 0) = rmucosb(3, 0) + 5.d0*rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp698b28
                    rp0b = rp0b - temp698b28
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp698b29 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp698b29
                  rp1b = fun0*der4fb(2) + fun*temp698b29
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp698b30 = cost2f*10.d0*rp2b
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b30
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b30
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp698b31 = cost2f*10.d0*rp1b
                  temp698b32 = rmu(2, 0)*rmucos(2, 0)*temp698b31
                  temp698b33 = rmu(i, 0)*rmucos(i, 0)*temp698b31
                  rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp698b32
                  rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp698b32
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b33
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b33
                END IF
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp698b21 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp698b21
                rp1b = fun0*der4fb(2) + fun*temp698b21
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp698b22 = -(cost2f*2.d0*rp2b)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b22
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b22
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp698b23 = -(cost2f*2.d0*rp1b)
                temp698b24 = rmu(2, 0)*rmucos(2, 0)*temp698b23
                temp698b25 = rmu(i, 0)*rmucos(i, 0)*temp698b23
                rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp698b24
                rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp698b24
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b25
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b25
              ELSE IF (branch .LT. 9) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp698b34 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp698b34
                rp1b = fun0*der4fb(2) + fun*temp698b34
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp698b35 = cost3f*2.d0*rp2b
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp698b35
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp698b35
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp698b36 = cost3f*2.d0*rp1b
                temp698b37 = rmu(3, 0)*rmucos(3, 0)*temp698b36
                temp698b38 = rmu(1, 0)*rmucos(1, 0)*temp698b36
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b37
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b37
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp698b38
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp698b38
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp698b39 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp698b39
                rp1b = fun0*der4fb(2) + fun*temp698b39
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp698b40 = -(cost3f*2.d0*rp2b)
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp698b40
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp698b40
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp698b41 = -(cost3f*2.d0*rp1b)
                temp698b42 = rmu(3, 0)*rmucos(3, 0)*temp698b41
                temp698b43 = rmu(2, 0)*rmucos(2, 0)*temp698b41
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b42
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b42
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp698b43
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp698b43
              END IF
            ELSE IF (branch .LT. 15) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  IF (branch .LT. 11) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp698b44 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp698b44
                    rp1b = fun0*der4fb(2) + fun*temp698b44
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp698b45 = cost3f*2*rmu(1, 0)*rmucos(1, 0)*rp1b
                    temp698b46 = -(cost3f*2*rmu(2, 0)*rmucos(2, 0)*rp1b)
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b45
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b45
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b46
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b46
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp698b47 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp698b47
                    rp1b = fun0*der4fb(2) + fun*temp698b47
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp698b48 = cost3f*2.d0*rp1b
                    temp698b49 = rmu(3, 0)*rmucos(3, 0)*temp698b48
                    temp698b50 = rmu(2, 0)*rmucos(2, 0)*temp698b48
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b49
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b49
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp698b50
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp698b50
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp698b51 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp698b51
                  rp1b = fun0*der4fb(2) + fun*temp698b51
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp698b52 = cost3f*2.d0*rp1b
                  temp698b53 = rmu(3, 0)*rmucos(3, 0)*temp698b52
                  temp698b54 = rmu(1, 0)*rmucos(1, 0)*temp698b52
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b53
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b53
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp698b54
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp698b54
                END IF
              ELSE IF (branch .LT. 14) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp698b55 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp698b55
                rp1b = fun0*der4fb(2) + fun*temp698b55
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp698b56 = cost3f*2.d0*rp1b
                temp698b57 = rmu(2, 0)*rmucos(2, 0)*temp698b56
                temp698b58 = rmu(1, 0)*rmucos(1, 0)*temp698b56
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b57
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b57
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b58
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b58
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp698b59 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp698b59
                rp1b = fun0*der4fb(2) + fun*temp698b59
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp698b60 = cost4f*6.d0*rp2b
                temp698b61 = cost4f*3.d0*rp1b
                temp698b62 = 2*rmu(1, 0)*rmucos(1, 0)*temp698b61
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b62 + &
&                  rmucos(1, 0)*temp698b60
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b62 + &
&                  rmu(1, 0)*temp698b60
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp698b63 = -(2*rmu(2, 0)*rmucos(2, 0)*temp698b61)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b63
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b63
              END IF
            ELSE IF (branch .LT. 18) THEN
              IF (branch .LT. 17) THEN
                IF (.NOT.branch .LT. 16) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp698b64 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp698b64
                  rp1b = fun0*der4fb(2) + fun*temp698b64
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp698b65 = -(cost4f*6.d0*rp2b)
                  temp698b66 = -(cost4f*6.d0*rp1b)
                  temp698b67 = rmu(2, 0)*rmucos(2, 0)*temp698b66
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b67 + &
&                    rmucos(1, 0)*temp698b65
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b67 +&
&                    rmu(1, 0)*temp698b65
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp698b68 = rmu(1, 0)*rmucos(1, 0)*temp698b66
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b68
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b68
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp698b69 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp698b69
                rp1b = fun0*der4fb(2) + fun*temp698b69
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp698b70 = cost4f*6.d0*rp2b
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b70
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b70
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp698b71 = cost4f*6.d0*rp1b
                temp698b72 = rmu(2, 0)*rmucos(2, 0)*temp698b71
                temp698b73 = rmu(1, 0)*rmucos(1, 0)*temp698b71
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b72
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b72
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b73
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b73
              END IF
            ELSE IF (.NOT.branch .LT. 19) THEN
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              temp698b74 = 2.d0*rmu(i, 0)*hess4fb(3)
              funb = funb + rp1*temp698b74
              rp1b = fun0*der4fb(2) + fun*temp698b74
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
              rp2b = fun0*hess4fb(2)
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              CALL POPREAL8(adr8ibuf,adr8buf,rp2)
              temp698b75 = -(cost4f*6.d0*rp2b)
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b75
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b75
              CALL POPREAL8(adr8ibuf,adr8buf,rp1)
              temp698b76 = cost4f*3.d0*rp1b
              temp698b77 = 2*rmu(1, 0)*rmucos(1, 0)*temp698b76
              temp698b78 = -(2*rmu(2, 0)*rmucos(2, 0)*temp698b76)
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp698b77
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp698b77
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp698b78
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp698b78
            END IF
 100        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
            hess4fb(3) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
            hess4fb(2) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
            der4fb(2) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp698b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp698b
            funb = funb + rmu(i, 0)*temp698b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp697 = r(0)**2
        temp696 = fun2/temp697
        temp696b = rmu(i, 0)**2*radhess4fb(i)/temp697
        temp695 = r(0)**2
        temp694 = rmu(i, 0)**2/temp695
        temp694b6 = -(fun*radhess4fb(i)/temp695)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp694b6 + temp696*2*rmu(&
&          i, 0)*radhess4fb(i)
        fun2b = fun2b + temp696b
        rb(0) = rb(0) - temp694*2*r(0)*temp694b6 - temp696*2*r(0)*&
&          temp696b
        funb = funb + (1.d0-temp694)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp694b2 = 2*rmu(1, 0)*rmucos(1, 0)*rp0b
      temp694b3 = 2*rmu(2, 0)*rmucos(2, 0)*rp0b
      temp694b4 = 2*rmu(3, 0)*rmucos(3, 0)*rp0b
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp694b2
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp694b2
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp694b3
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp694b3
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp694b4
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp694b4
      temp694b5 = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp694b5 - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp694b5
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp694b1 = distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + cosphase(k)*temp694b1
          cosphaseb(k) = cosphaseb(k) + distp(k, 1)*temp694b1
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*cosphase(k)*zb&
&            (indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp693 = rmu(2, i)*rmucos(2, i)
      temp694b = cost4f*(3.d0*(rmu(1, i)**2*rmucos(1, i)**2)-temp693**2)&
&        *distpb(i, 8)
      temp694b0 = cost4f*rmu(2, i)*rmucos(2, i)*distpb(i, 8)
      temp693b = -(2*temp693*temp694b0)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp693b + rmucos(2, i)*&
&        temp694b
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp693b + rmu(2, i)*&
&        temp694b
      distpb(i, 8) = 0.0_8
      temp692 = rmu(1, i)*rmucos(1, i)
      temp693b0 = cost4f*(temp692**2-3.d0*(rmu(2, i)**2*rmucos(2, i)**2)&
&        )*distpb(i, 7)
      temp693b1 = cost4f*rmu(1, i)*rmucos(1, i)*distpb(i, 7)
      temp692b = 2*temp692*temp693b1
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp693b0 + rmucos(1, i)*&
&        temp692b + 3.d0*rmucos(1, i)**2*2*rmu(1, i)*temp694b0
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp693b0 + rmu(1, i)*&
&        temp692b + 3.d0*rmu(1, i)**2*2*rmucos(1, i)*temp694b0
      rmub(2, i) = rmub(2, i) - 3.d0*rmucos(2, i)**2*2*rmu(2, i)*&
&        temp693b1
      rmucosb(2, i) = rmucosb(2, i) - 3.d0*rmu(2, i)**2*2*rmucos(2, i)*&
&        temp693b1
      distpb(i, 7) = 0.0_8
      temp691 = rmu(1, i)*rmucos(1, i)
      temp690 = rmu(3, i)*rmucos(3, i)
      temp690b = cost3f*2.d0*distpb(i, 6)
      temp690b0 = rmu(2, i)*rmucos(2, i)*temp690b
      temp690b1 = temp690*temp691*temp690b
      rmub(3, i) = rmub(3, i) + temp691*rmucos(3, i)*temp690b0
      rmucosb(3, i) = rmucosb(3, i) + temp691*rmu(3, i)*temp690b0
      rmub(1, i) = rmub(1, i) + temp690*rmucos(1, i)*temp690b0
      rmucosb(1, i) = rmucosb(1, i) + temp690*rmu(1, i)*temp690b0
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp690b1
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp690b1
      distpb(i, 6) = 0.0_8
      temp688 = rmu(2, i)*rmucos(2, i)
      temp689 = rmu(1, i)*rmucos(1, i)
      temp690b2 = cost3f*(temp689**2-temp688**2)*distpb(i, 5)
      temp690b3 = cost3f*rmu(3, i)*rmucos(3, i)*distpb(i, 5)
      temp689b = 2*temp689*temp690b3
      temp688b = -(2*temp688*temp690b3)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp690b2
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp690b2
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp689b
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp689b
      distpb(i, 5) = 0.0_8
      temp688b0 = cost2f*(5.d0*(rmu(3, i)**2*rmucos(3, i)**2)-rp0)*&
&        distpb(i, 4)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp688b0 + rmucos(2, i)*&
&        temp688b
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp688b0 + rmu(2, i)*&
&        temp688b
      temp688b1 = cost2f*rmu(2, i)*rmucos(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp688b1
      rmucosb(3, i) = rmucosb(3, i) + 5.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp688b1
      distpb(i, 4) = 0.0_8
      temp688b2 = cost2f*(5.d0*(rmu(3, i)**2*rmucos(3, i)**2)-rp0)*&
&        distpb(i, 3)
      temp688b3 = cost2f*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp688b4 = cost1f*rmu(3, i)*rmucos(3, i)*distpb(i, 2)
      rp0b = -temp688b3 - 3.d0*temp688b4 - temp688b1
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp688b2
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp688b2
      temp688b5 = cost1f*(5.d0*(rmu(3, i)**2*rmucos(3, i)**2)-3.d0*rp0)*&
&        distpb(i, 2)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp688b5 + 5.d0*rmucos(3, &
&        i)**2*2*rmu(3, i)*temp688b4 + 5.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp688b3
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp688b5 + 5.d0*rmu(3, &
&        i)**2*2*rmucos(3, i)*temp688b4 + 5.d0*rmu(3, i)**2*2*rmucos(3, i&
&        )*temp688b3
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp688b6 = 2*rmu(1, i)*rmucos(1, i)*rp0b
      temp688b7 = 2*rmu(2, i)*rmucos(2, i)*rp0b
      temp688b8 = 2*rmu(3, i)*rmucos(3, i)*rp0b
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp688b6
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp688b6
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp688b7
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp688b7
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp688b8
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp688b8
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp687 = r(k)**2
      temp687b = c*DEXP(-(dd1*temp687))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp687))*distpb(k, 1)
      dd1b = dd1b - temp687*temp687b
      rb(k) = rb(k) - dd1*2*r(k)*temp687b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.47215808929909374563d0*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (49)
! f single gaussian orbital derivative of 48
! R(r)= c*exp(-z r^2)*(9/4/z-r^2)
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! Y_i are the stretched coordinates for the angular part A
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(Y_i(x_i)) \phi(x_i)
! R depends on X_i, A depends on Y_i, the phase \phi depends on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! where  d^2/dx^2_k F(X_i(x_i)) = (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dY^2_k A)  ((d/dx_k Y_i) (x_i))^2
!                      + R  (d/dY_k A)  (d^2/dx^2_k Y_i) (x_i)
!                      + 2 (d/dX_k R)  (d/dY_k A)   (d/dx_k X_i) (x_i)  (d/dx_k Y_i) (x_i)
! X_i = rmu
! Y_i = rmu * rmucos
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
! d/dx_k Y_i  =  2 * rmucos**2  - 1
! d^2/dx^2_k Y_i = - 4*Pi/L * rmusin * rmucos
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
    c = dd1**2.25d0*1.47215808929909374563d0
!         c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = (rmu(1, i)*rmucos(1, i))**2 + (rmu(2, i)*rmucos(2, i))**2 + &
&        (rmu(3, i)*rmucos(3, i))**2
      distp(i, 2) = cost1f*rmu(3, i)*rmucos(3, i)*(5.d0*(rmu(3, i)*&
&        rmucos(3, i))**2-3.d0*rp0)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*rmucos(1, i)*(5.d0*(rmu(3, i)*&
&        rmucos(3, i))**2-rp0)
! lz=+/-1
      distp(i, 4) = cost2f*rmu(2, i)*rmucos(2, i)*(5.d0*(rmu(3, i)*&
&        rmucos(3, i))**2-rp0)
! lz=+/-1
      distp(i, 5) = cost3f*rmu(3, i)*rmucos(3, i)*((rmu(1, i)*rmucos(1, &
&        i))**2-(rmu(2, i)*rmucos(2, i))**2)
! lz=+/-2
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmucos(3, i)*rmu(1, i)*rmucos(&
&        1, i)*rmu(2, i)*rmucos(2, i)
! lz=+/-2
      distp(i, 7) = cost4f*rmu(1, i)*rmucos(1, i)*((rmu(1, i)*rmucos(1, &
&        i))**2-3.d0*(rmu(2, i)*rmucos(2, i))**2)
! lz=+/-3
      distp(i, 8) = cost4f*rmu(2, i)*rmucos(2, i)*(3.d0*(rmu(1, i)*&
&        rmucos(1, i))**2-(rmu(2, i)*rmucos(2, i))**2)
    END DO
! lz=+/-3
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,7
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*(9.d0/4.d0/dd1-r(k)**2)*distp(k, 1&
&            +ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)*(9.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-13.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+19.d0*dd1*r(0)**2-13.d0&
&        /2.d0)
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = (rmu(1, 0)*rmucos(1, 0))**2 + (rmu(2, 0)*rmucos(2, 0))**2 + &
&        (rmu(3, 0)*rmucos(3, 0))**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2)
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,7
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part
! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            der4f(2) = 0.d0
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
            hess4f(2) = 0.d0
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
            hess4f(3) = 0.d0
! contribution of the angular part
            IF (ic .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
! rp1 =   d/dx_k angular
! rp2 =   d^2/dx^2_k angular
              rp1 = -(6.d0*cost1f*rmu(i, 0)*rmucos(i, 0)*rmu(3, 0)*&
&                rmucos(3, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = -(6.d0*cost1f*rmu(3, 0)*rmucos(3, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
! der4f(2)  = der4f(2)  +  fun0 * d/dx_k angular
! hess4f(2) = hess4f(2) +  fun0 * d^2/dx^2_k angular
! hess4f(3) = hess4f(3) +  2 * fun * x_k * d/dx_k angular
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost1f*(15.d0*(rmu(i, 0)*rmucos(i, 0))**2-3.d0*rp0&
&                  )
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost1f*18.d0*rmu(i, 0)*rmucos(i, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = -(2.d0*cost2f*rmu(i, 0)*rmucos(i, 0)*rmu(1, 0)*&
&                rmucos(1, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2f*(5.d0*(rmu(3, 0)*rmucos(3, 0))**2-rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(cost2f*4.d0*rmu(i, 0)*rmucos(i, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 10.d0*cost2f*rmu(i, 0)*rmucos(i, 0)*rmu(1, 0)*&
&                  rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 10.d0*cost2f*rmu(1, 0)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = -(2.d0*cost2f*rmu(i, 0)*rmucos(i, 0)*rmu(2, 0)*&
&                rmucos(2, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = -(2.d0*cost2f*rmu(2, 0)*rmucos(2, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2f*(5.d0*(rmu(3, 0)*rmucos(3, 0))**2-rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(cost2f*4.d0*rmu(i, 0)*rmucos(i, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 10.d0*cost2f*rmu(i, 0)*rmucos(i, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 10.d0*cost2f*rmu(2, 0)*rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 2.d0*cost3f*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = -(2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(2.d0*cost3f*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3f*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, 0)*&
&                  rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = 3.d0*cost4f*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, 0&
&                  )*rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = -(6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(6.d0*cost4f*rmu(1, 0)*rmucos(1, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = 6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*rmucos(&
&                2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = 6.d0*cost4f*rmu(2, 0)*rmucos(2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = 3.d0*cost4f*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, 0)*&
&                rmucos(2, 0))**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = -(6.d0*cost4f*rmu(2, 0)*rmucos(2, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
!enddo for i
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)*(2.d0*&
&              rmucos(i, 0)**2-1.d0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dY^2_k A)  ((d/dx_k Y_i) (x_i))^2
!                      + R  (d/dY_k A)  (d^2/dx^2_k Y_i) (x_i)
!                      + 2 (d/dX_k R)  (d/dY_k A)   (d/dx_k X_i) (x_i)  (d/dx_k Y_i) (x_i)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2)*(2.d0*rmucos(i, 0)**&
&              2-1.d0)**2 - der4f(2)*4.d0*pi/cellscale(i)*rmusin(i, 0)*&
&              rmucos(i, 0) + hess4f(3)*rmucos(i, 0)*(2.d0*rmucos(i, 0)**&
&              2-1.d0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*(9.d0/4.d0/dd1-r(0)&
&              **2)*distp(0, 1+ic)*cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*(9.d0/4.d0/dd1-r(0)**2)*distp(0, 1+ic)*sinphase(i, 0&
&              )*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      dd1b = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=7,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp729 = distp(0, 1)*rphase(i)
            temp728 = distp(0, 1+ic)*sinphase(i, 0)
            temp728b = -(temp728*temp729*zb(indorbp, indt+i))
            temp727 = 4.d0*dd1
            temp726 = 9.d0/temp727
            temp726b = -((temp726-r(0)**2)*zb(indorbp, indt+i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp725 = distp(0, 1+ic)*rphase(i)**2
            temp723 = 4.d0*dd1
            temp722 = 9.d0/temp723
            temp722b = -((temp722-r(0)**2)*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + temp725&
&              *distp(0, 1)*temp722b + z(indorbp, indt+i)*zb(indorbp, &
&              indt+i)
            temp724 = distp(0, 1)*cosphase(0)
            temp724b = -(temp724*temp725*hess4fb(1))
            dd1b = dd1b - temp722*4.d0*temp724b/temp723 - temp726*4.d0*&
&              temp728b/temp727
            rb(0) = rb(0) - 2*r(0)*temp724b - 2*r(0)*temp728b
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp729*sinphase(i, 0)*&
&              temp726b
            temp726b0 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp726b0 + &
&              temp729*distp(0, 1+ic)*temp726b
            distpb(0, 1) = distpb(0, 1) + temp725*cosphase(0)*temp722b +&
&              temp728*rphase(i)*temp726b
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp726b0 + temp724&
&              *distp(0, 1+ic)*2*rphase(i)*temp722b + temp728*distp(0, 1)&
&              *temp726b
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp724*rphase(i)**2*&
&              temp722b
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp721 = der4f(1)/cellscale(i)
            temp721b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            temp720 = 2.d0*rmucos(i, 0)**2 - 1.d0
            temp720b = (2.d0*rmucos(i, 0)**2-1.d0)*hess4fb(1)
            temp719 = der4f(2)/cellscale(i)
            temp720b0 = -(pi*4.d0*hess4fb(1))
            temp720b1 = temp719*temp720b0
            temp719b79 = rmusin(i, 0)*rmucos(i, 0)*temp720b0/cellscale(i&
&              )
            rmucosb(i, 0) = rmucosb(i, 0) + (der4f(2)*2.d0*2*rmucos(i, 0&
&              )+der4f(1))*zb(indorbp, indt+i) + rmusin(i, 0)*temp720b1 +&
&              hess4f(3)*temp720b + (2*(hess4f(3)*rmucos(i, 0)**2*2.d0)+&
&              hess4f(2)*2**2*temp720*2.d0*rmucos(i, 0)+hess4f(1)*2*&
&              rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) + rmucos(i, 0)*temp720b1 - pi*&
&              temp721*hess4fb(1)
            der4fb(1) = der4fb(1) + temp721b
            cellscaleb(i) = cellscaleb(i) - temp719*temp719b79 - temp721&
&              *temp721b
            hess4fb(2) = hess4fb(2) + temp720**2*hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*temp720b
            der4fb(2) = der4fb(2) + temp719b79
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i)
            der4fb(2) = der4fb(2) + (2.d0*rmucos(i, 0)**2-1.d0)*zb(&
&              indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 10) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    IF (.NOT.branch .LT. 1) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      temp719b5 = 2.d0*rmu(i, 0)*hess4fb(3)
                      funb = funb + rp1*temp719b5
                      rp1b = fun0*der4fb(2) + fun*temp719b5
                      rp2b = fun0*hess4fb(2)
                      temp719b6 = cost1f*18.d0*rp2b
                      temp719b7 = cost1f*rp1b
                      rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp719b6 +&
&                        15.d0*rmucos(i, 0)**2*2*rmu(i, 0)*temp719b7 + &
&                        2.d0*fun*rp1*hess4fb(3)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                      rmucosb(i, 0) = rmucosb(i, 0) + 15.d0*rmu(i, 0)**2&
&                        *2*rmucos(i, 0)*temp719b7 + rmu(i, 0)*temp719b6
                      CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                      rp0b = rp0b - 3.d0*temp719b7
                    END IF
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp719b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp719b0
                    rp1b = fun0*der4fb(2) + fun*temp719b0
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp719b1 = -(cost1f*6.d0*rp2b)
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp719b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp719b1
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp719b2 = -(cost1f*6.d0*rp1b)
                    temp719b3 = rmu(3, 0)*rmucos(3, 0)*temp719b2
                    temp719b4 = rmu(i, 0)*rmucos(i, 0)*temp719b2
                    rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp719b3
                    rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp719b3
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp719b4
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp719b4
                    GOTO 110
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp719b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp719b13
                    rp1b = fun0*der4fb(2) + fun*temp719b13
                    rp2b = fun0*hess4fb(2)
                    temp719b14 = -(cost2f*4.d0*rp2b)
                    rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp719b14 + &
&                      2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp719b14
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp719b15 = cost2f*rp1b
                    rmub(3, 0) = rmub(3, 0) + 5.d0*rmucos(3, 0)**2*2*rmu&
&                      (3, 0)*temp719b15
                    rmucosb(3, 0) = rmucosb(3, 0) + 5.d0*rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp719b15
                    rp0b = rp0b - temp719b15
                  END IF
                ELSE IF (.NOT.branch .LT. 4) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp719b16 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp719b16
                  rp1b = fun0*der4fb(2) + fun*temp719b16
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp719b17 = cost2f*10.d0*rp2b
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b17
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b17
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp719b18 = cost2f*10.d0*rp1b
                  temp719b19 = rmu(1, 0)*rmucos(1, 0)*temp719b18
                  temp719b20 = rmu(i, 0)*rmucos(i, 0)*temp719b18
                  rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp719b19
                  rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp719b19
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b20
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b20
                END IF
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp719b8 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp719b8
                rp1b = fun0*der4fb(2) + fun*temp719b8
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp719b9 = -(cost2f*2.d0*rp2b)
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b9
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b9
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp719b10 = -(cost2f*2.d0*rp1b)
                temp719b11 = rmu(1, 0)*rmucos(1, 0)*temp719b10
                temp719b12 = rmu(i, 0)*rmucos(i, 0)*temp719b10
                rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp719b11
                rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp719b11
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b12
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b12
              ELSE IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  IF (branch .LT. 6) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp719b26 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp719b26
                    rp1b = fun0*der4fb(2) + fun*temp719b26
                    rp2b = fun0*hess4fb(2)
                    temp719b27 = -(cost2f*4.d0*rp2b)
                    rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp719b27 + &
&                      2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp719b27
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp719b28 = cost2f*rp1b
                    rmub(3, 0) = rmub(3, 0) + 5.d0*rmucos(3, 0)**2*2*rmu&
&                      (3, 0)*temp719b28
                    rmucosb(3, 0) = rmucosb(3, 0) + 5.d0*rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp719b28
                    rp0b = rp0b - temp719b28
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp719b29 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp719b29
                  rp1b = fun0*der4fb(2) + fun*temp719b29
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp719b30 = cost2f*10.d0*rp2b
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b30
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b30
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp719b31 = cost2f*10.d0*rp1b
                  temp719b32 = rmu(2, 0)*rmucos(2, 0)*temp719b31
                  temp719b33 = rmu(i, 0)*rmucos(i, 0)*temp719b31
                  rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp719b32
                  rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp719b32
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b33
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b33
                END IF
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp719b21 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp719b21
                rp1b = fun0*der4fb(2) + fun*temp719b21
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp719b22 = -(cost2f*2.d0*rp2b)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b22
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b22
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp719b23 = -(cost2f*2.d0*rp1b)
                temp719b24 = rmu(2, 0)*rmucos(2, 0)*temp719b23
                temp719b25 = rmu(i, 0)*rmucos(i, 0)*temp719b23
                rmub(i, 0) = rmub(i, 0) + rmucos(i, 0)*temp719b24
                rmucosb(i, 0) = rmucosb(i, 0) + rmu(i, 0)*temp719b24
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b25
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b25
              ELSE IF (branch .LT. 9) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp719b34 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp719b34
                rp1b = fun0*der4fb(2) + fun*temp719b34
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp719b35 = cost3f*2.d0*rp2b
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp719b35
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp719b35
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp719b36 = cost3f*2.d0*rp1b
                temp719b37 = rmu(3, 0)*rmucos(3, 0)*temp719b36
                temp719b38 = rmu(1, 0)*rmucos(1, 0)*temp719b36
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b37
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b37
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp719b38
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp719b38
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp719b39 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp719b39
                rp1b = fun0*der4fb(2) + fun*temp719b39
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp719b40 = -(cost3f*2.d0*rp2b)
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp719b40
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp719b40
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp719b41 = -(cost3f*2.d0*rp1b)
                temp719b42 = rmu(3, 0)*rmucos(3, 0)*temp719b41
                temp719b43 = rmu(2, 0)*rmucos(2, 0)*temp719b41
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b42
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b42
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp719b43
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp719b43
              END IF
            ELSE IF (branch .LT. 15) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  IF (branch .LT. 11) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp719b44 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp719b44
                    rp1b = fun0*der4fb(2) + fun*temp719b44
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp719b45 = cost3f*2*rmu(1, 0)*rmucos(1, 0)*rp1b
                    temp719b46 = -(cost3f*2*rmu(2, 0)*rmucos(2, 0)*rp1b)
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b45
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b45
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b46
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b46
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp719b47 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp719b47
                    rp1b = fun0*der4fb(2) + fun*temp719b47
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp719b48 = cost3f*2.d0*rp1b
                    temp719b49 = rmu(3, 0)*rmucos(3, 0)*temp719b48
                    temp719b50 = rmu(2, 0)*rmucos(2, 0)*temp719b48
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b49
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b49
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp719b50
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp719b50
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp719b51 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp719b51
                  rp1b = fun0*der4fb(2) + fun*temp719b51
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp719b52 = cost3f*2.d0*rp1b
                  temp719b53 = rmu(3, 0)*rmucos(3, 0)*temp719b52
                  temp719b54 = rmu(1, 0)*rmucos(1, 0)*temp719b52
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b53
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b53
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp719b54
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp719b54
                END IF
              ELSE IF (branch .LT. 14) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp719b55 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp719b55
                rp1b = fun0*der4fb(2) + fun*temp719b55
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp719b56 = cost3f*2.d0*rp1b
                temp719b57 = rmu(2, 0)*rmucos(2, 0)*temp719b56
                temp719b58 = rmu(1, 0)*rmucos(1, 0)*temp719b56
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b57
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b57
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b58
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b58
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp719b59 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp719b59
                rp1b = fun0*der4fb(2) + fun*temp719b59
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp719b60 = cost4f*6.d0*rp2b
                temp719b61 = cost4f*3.d0*rp1b
                temp719b62 = 2*rmu(1, 0)*rmucos(1, 0)*temp719b61
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b62 + &
&                  rmucos(1, 0)*temp719b60
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b62 + &
&                  rmu(1, 0)*temp719b60
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp719b63 = -(2*rmu(2, 0)*rmucos(2, 0)*temp719b61)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b63
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b63
              END IF
            ELSE IF (branch .LT. 18) THEN
              IF (branch .LT. 17) THEN
                IF (.NOT.branch .LT. 16) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp719b64 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp719b64
                  rp1b = fun0*der4fb(2) + fun*temp719b64
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp719b65 = -(cost4f*6.d0*rp2b)
                  temp719b66 = -(cost4f*6.d0*rp1b)
                  temp719b67 = rmu(2, 0)*rmucos(2, 0)*temp719b66
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b67 + &
&                    rmucos(1, 0)*temp719b65
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b67 +&
&                    rmu(1, 0)*temp719b65
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp719b68 = rmu(1, 0)*rmucos(1, 0)*temp719b66
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b68
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b68
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp719b69 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp719b69
                rp1b = fun0*der4fb(2) + fun*temp719b69
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp719b70 = cost4f*6.d0*rp2b
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b70
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b70
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp719b71 = cost4f*6.d0*rp1b
                temp719b72 = rmu(2, 0)*rmucos(2, 0)*temp719b71
                temp719b73 = rmu(1, 0)*rmucos(1, 0)*temp719b71
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b72
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b72
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b73
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b73
              END IF
            ELSE IF (.NOT.branch .LT. 19) THEN
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              temp719b74 = 2.d0*rmu(i, 0)*hess4fb(3)
              funb = funb + rp1*temp719b74
              rp1b = fun0*der4fb(2) + fun*temp719b74
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
              rp2b = fun0*hess4fb(2)
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              CALL POPREAL8(adr8ibuf,adr8buf,rp2)
              temp719b75 = -(cost4f*6.d0*rp2b)
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b75
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b75
              CALL POPREAL8(adr8ibuf,adr8buf,rp1)
              temp719b76 = cost4f*3.d0*rp1b
              temp719b77 = 2*rmu(1, 0)*rmucos(1, 0)*temp719b76
              temp719b78 = -(2*rmu(2, 0)*rmucos(2, 0)*temp719b76)
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp719b77
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp719b77
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp719b78
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp719b78
            END IF
 110        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
            hess4fb(3) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
            hess4fb(2) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
            der4fb(2) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp719b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp719b
            funb = funb + rmu(i, 0)*temp719b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp718 = r(0)**2
        temp717 = fun2/temp718
        temp717b = rmu(i, 0)**2*radhess4fb(i)/temp718
        temp716 = r(0)**2
        temp715 = rmu(i, 0)**2/temp716
        temp715b2 = -(fun*radhess4fb(i)/temp716)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp715b2 + temp717*2*rmu(&
&          i, 0)*radhess4fb(i)
        fun2b = fun2b + temp717b
        rb(0) = rb(0) - temp715*2*r(0)*temp715b2 - temp717*2*r(0)*&
&          temp717b
        funb = funb + (1.d0-temp715)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp715b = 2*rmu(1, 0)*rmucos(1, 0)*rp0b
      temp715b0 = 2*rmu(2, 0)*rmucos(2, 0)*rp0b
      temp715b1 = 2*rmu(3, 0)*rmucos(3, 0)*rp0b
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp715b
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp715b
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp715b0
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp715b0
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp715b1
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp715b1
      temp714 = r(0)**4
      temp714b = distp(0, 1)*fun2b
      temp713 = 4.d0*dd1
      temp712 = 9.d0/temp713
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-13.d0/2.d0)*funb&
&        + (temp712-r(0)**2)*fun0b + (19.d0*(dd1*r(0)**2)-13.d0/2.d0-4.d0&
&        *(dd1**2*temp714))*fun2b
      temp714b0 = distp(0, 1)*2.d0*funb
      dd1b = dd1b + r(0)**2*temp714b0 - distp(0, 1)*temp712*4.d0*fun0b/&
&        temp713 + (19.d0*r(0)**2-4.d0*temp714*2*dd1)*temp714b
      rb(0) = rb(0) + dd1*2*r(0)*temp714b0 - distp(0, 1)*2*r(0)*fun0b + &
&        (19.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp714b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp711 = 4.d0*dd1
          temp710 = 9.d0/temp711
          temp710b = (temp710-r(k)**2)*zb(indorbp, k)
          temp709 = distp(k, 1+ic)
          temp708 = distp(k, 1)*cosphase(k)
          temp708b1 = temp708*temp709*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + temp709*cosphase(k)*temp710b
          cosphaseb(k) = cosphaseb(k) + temp709*distp(k, 1)*temp710b
          distpb(k, 1+ic) = distpb(k, 1+ic) + temp708*temp710b
          dd1b = dd1b - temp710*4.d0*temp708b1/temp711
          rb(k) = rb(k) - 2*r(k)*temp708b1
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp707 = rmu(2, i)*rmucos(2, i)
      temp708b = cost4f*(3.d0*(rmu(1, i)**2*rmucos(1, i)**2)-temp707**2)&
&        *distpb(i, 8)
      temp708b0 = cost4f*rmu(2, i)*rmucos(2, i)*distpb(i, 8)
      temp707b = -(2*temp707*temp708b0)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp707b + rmucos(2, i)*&
&        temp708b
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp707b + rmu(2, i)*&
&        temp708b
      distpb(i, 8) = 0.0_8
      temp706 = rmu(1, i)*rmucos(1, i)
      temp707b0 = cost4f*(temp706**2-3.d0*(rmu(2, i)**2*rmucos(2, i)**2)&
&        )*distpb(i, 7)
      temp707b1 = cost4f*rmu(1, i)*rmucos(1, i)*distpb(i, 7)
      temp706b = 2*temp706*temp707b1
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp707b0 + rmucos(1, i)*&
&        temp706b + 3.d0*rmucos(1, i)**2*2*rmu(1, i)*temp708b0
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp707b0 + rmu(1, i)*&
&        temp706b + 3.d0*rmu(1, i)**2*2*rmucos(1, i)*temp708b0
      rmub(2, i) = rmub(2, i) - 3.d0*rmucos(2, i)**2*2*rmu(2, i)*&
&        temp707b1
      rmucosb(2, i) = rmucosb(2, i) - 3.d0*rmu(2, i)**2*2*rmucos(2, i)*&
&        temp707b1
      distpb(i, 7) = 0.0_8
      temp705 = rmu(1, i)*rmucos(1, i)
      temp704 = rmu(3, i)*rmucos(3, i)
      temp704b = cost3f*2.d0*distpb(i, 6)
      temp704b0 = rmu(2, i)*rmucos(2, i)*temp704b
      temp704b1 = temp704*temp705*temp704b
      rmub(3, i) = rmub(3, i) + temp705*rmucos(3, i)*temp704b0
      rmucosb(3, i) = rmucosb(3, i) + temp705*rmu(3, i)*temp704b0
      rmub(1, i) = rmub(1, i) + temp704*rmucos(1, i)*temp704b0
      rmucosb(1, i) = rmucosb(1, i) + temp704*rmu(1, i)*temp704b0
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp704b1
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp704b1
      distpb(i, 6) = 0.0_8
      temp702 = rmu(2, i)*rmucos(2, i)
      temp703 = rmu(1, i)*rmucos(1, i)
      temp704b2 = cost3f*(temp703**2-temp702**2)*distpb(i, 5)
      temp704b3 = cost3f*rmu(3, i)*rmucos(3, i)*distpb(i, 5)
      temp703b = 2*temp703*temp704b3
      temp702b = -(2*temp702*temp704b3)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp704b2
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp704b2
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp703b
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp703b
      distpb(i, 5) = 0.0_8
      temp702b0 = cost2f*(5.d0*(rmu(3, i)**2*rmucos(3, i)**2)-rp0)*&
&        distpb(i, 4)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp702b0 + rmucos(2, i)*&
&        temp702b
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp702b0 + rmu(2, i)*&
&        temp702b
      temp702b1 = cost2f*rmu(2, i)*rmucos(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp702b1
      rmucosb(3, i) = rmucosb(3, i) + 5.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp702b1
      distpb(i, 4) = 0.0_8
      temp702b2 = cost2f*(5.d0*(rmu(3, i)**2*rmucos(3, i)**2)-rp0)*&
&        distpb(i, 3)
      temp702b3 = cost2f*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp702b4 = cost1f*rmu(3, i)*rmucos(3, i)*distpb(i, 2)
      rp0b = -temp702b3 - 3.d0*temp702b4 - temp702b1
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp702b2
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp702b2
      temp702b5 = cost1f*(5.d0*(rmu(3, i)**2*rmucos(3, i)**2)-3.d0*rp0)*&
&        distpb(i, 2)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp702b5 + 5.d0*rmucos(3, &
&        i)**2*2*rmu(3, i)*temp702b4 + 5.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp702b3
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp702b5 + 5.d0*rmu(3, &
&        i)**2*2*rmucos(3, i)*temp702b4 + 5.d0*rmu(3, i)**2*2*rmucos(3, i&
&        )*temp702b3
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp702b6 = 2*rmu(1, i)*rmucos(1, i)*rp0b
      temp702b7 = 2*rmu(2, i)*rmucos(2, i)*rp0b
      temp702b8 = 2*rmu(3, i)*rmucos(3, i)*rp0b
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp702b6
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp702b6
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp702b7
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp702b7
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp702b8
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp702b8
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp701 = r(k)**2
      temp701b4 = c*DEXP(-(dd1*temp701))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp701))*distpb(k, 1)
      dd1b = dd1b - temp701*temp701b4
      rb(k) = rb(k) - dd1*2*r(k)*temp701b4
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.47215808929909374563d0*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (58)
! f single gaussian orbital
! radial R(r)= exp(-alpha r^2)
! normalized
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
!         c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)
    c = dd1**2.25d0*1.47215808929909374563d0
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(i)**2
      distp(i, 2) = cost1f*rmu(3, i)*rmucos(3, i)*(5.d0*rmu(3, i)**2-&
&        3.d0*rp0)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*rmucos(1, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 4) = cost2f*rmu(2, i)*rmucos(2, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 5) = cost3f*rmu(3, i)*rmucos(3, i)*(rmu(1, i)**2-rmu(2, i&
&        )**2)
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmucos(3, i)*rmu(1, i)*rmucos(&
&        1, i)*rmu(2, i)*rmucos(2, i)
      distp(i, 7) = cost4f*rmu(1, i)*rmucos(1, i)*(rmu(1, i)**2-3.d0*rmu&
&        (2, i)**2)
      distp(i, 8) = cost4f*rmu(2, i)*rmucos(2, i)*(3.d0*rmu(1, i)**2-rmu&
&        (2, i)**2)
    END DO
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,7
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*distp(k, 1+ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(0)**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,7
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part
! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(1, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(2, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 4.d0*cost1f*rmu(3, 0)**2*rmucos(3, 0)**2 + &
&                  cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  3.d0*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1f*fun0*(12.d0*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)-4.d0*pi**2/cellscale(3)**2*&
&                  rmu(3, 0)*rmucos(3, 0)*(5.d0*rmu(3, 0)**2-3.d0*rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)**2*rmucos(1, 0)**2) +&
&                  cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(1)&
&                  **2*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(2, 0)**2*rmucos(2, 0)**2) +&
&                  cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(2)&
&                  **2*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*(rmu(1, 0)&
&                  **2-rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4.d0*fun0*cost3f*pi/cellscale(3)*rmusin(3&
&                  , 0)*rmucos(3, 0)*(rmu(1, 0)**2-rmu(2, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(2, 0)&
&                  *rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(2, 0)*rmucos(2, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost4f*rmu(1, 0)**2*rmucos(1, 0)**2 + &
&                  cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*(rmu(1, 0)**2-3.d0*&
&                  rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0) - 4.d0*fun0*cost4f*pi**2/&
&                  cellscale(1)**2*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)**2-&
&                  3.d0*rmu(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                rmucos(2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(2.d0*&
&                rmucos(1, 0)**2-1.d0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = -(2.d0*cost4f*rmu(2, 0)**2*rmucos(2, 0)**2) + &
&                cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*(3.d0*rmu(1, 0)**2-&
&                rmu(2, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(&
&                2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*fun0*cost4f*pi**2/&
&                cellscale(2)**2*rmu(2, 0)*rmucos(2, 0)*(3.d0*rmu(1, 0)**&
&                2-rmu(2, 0)**2)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
!enddo for i
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*distp(0, 1+ic)*&
&              cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*distp(0, 1+ic)*sinphase(i, 0)*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=7,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp777b = -(distp(0, 1)*rphase(i)*zb(indorbp, indt+i))
            temp777b0 = -(distp(0, 1+ic)*sinphase(i, 0)*zb(indorbp, indt&
&              +i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp777b1 = -(distp(0, 1+ic)*rphase(i)**2*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + distp(0&
&              , 1)*temp777b1 + z(indorbp, indt+i)*zb(indorbp, indt+i)
            distpb(0, 1+ic) = distpb(0, 1+ic) + sinphase(i, 0)*temp777b
            temp777b2 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp777b2 + &
&              distp(0, 1+ic)*temp777b
            distpb(0, 1) = distpb(0, 1) + cosphase(0)*temp777b1 + rphase&
&              (i)*temp777b0
            temp777b3 = -(distp(0, 1)*cosphase(0)*hess4fb(1))
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp777b2 + distp(0&
&              , 1+ic)*2*rphase(i)*temp777b3 + distp(0, 1)*temp777b0
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + rphase(i)**2*temp777b3
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp776 = der4f(1)/cellscale(i)
            temp776b1 = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp776*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp776b1
            cellscaleb(i) = cellscaleb(i) - temp776*temp776b1
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 12) THEN
              IF (branch .LT. 6) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    IF (branch .LT. 1) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp737b0 = -(cost1f*6.d0*hess4fb(2))
                      temp737b1 = (2.d0*rmucos(1, 0)**2-1.d0)*temp737b0
                      rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(1, 0)*temp737b0
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp737b1
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp737b1
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp737b1
                      hess4fb(2) = 0.0_8
                      temp737b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp737b2 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp737b2
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp737b3 = -(cost1f*6.d0*der4fb(2))
                      temp737b4 = rmu(3, 0)*rmucos(3, 0)*temp737b3
                      temp737b5 = rmu(1, 0)*rmucos(1, 0)*temp737b3
                      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp737b4
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp737b4
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp737b5
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp737b5
                      der4fb(2) = 0.0_8
                    ELSE
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp737b6 = -(cost1f*6.d0*hess4fb(2))
                      temp737b7 = (2.d0*rmucos(2, 0)**2-1.d0)*temp737b6
                      rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(2, 0)*temp737b6
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp737b7
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp737b7
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp737b7
                      hess4fb(2) = 0.0_8
                      temp737b8 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp737b8 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp737b8
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp737b9 = -(cost1f*6.d0*der4fb(2))
                      temp737b10 = rmu(3, 0)*rmucos(3, 0)*temp737b9
                      temp737b11 = rmu(2, 0)*rmucos(2, 0)*temp737b9
                      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp737b10
                      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                        temp737b10
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp737b11
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp737b11
                      der4fb(2) = 0.0_8
                    END IF
                  END IF
                ELSE IF (branch .LT. 5) THEN
                  IF (branch .LT. 4) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp743 = 5.d0*rmu(3, 0)**2 - 3.d0*rp0
                    temp742 = cellscale(3)**2
                    temp741 = rmu(3, 0)*rmucos(3, 0)
                    temp737 = temp741/temp742
                    temp740 = 4.d0*pi**2
                    temp739 = 2.d0*rmucos(3, 0)**2 - 1.d0
                    temp738 = rmu(3, 0)*rmucos(3, 0)
                    temp739b = cost1f*fun0*hess4fb(2)
                    temp738b = 12.d0*temp739*temp739b
                    temp738b0 = -(temp740*temp739b)
                    temp737b12 = temp743*temp738b0/temp742
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + cost1f*(12.d0*(&
&                      temp738*temp739)-temp740*(temp737*temp743))*&
&                      hess4fb(2)
                    rmub(3, 0) = rmub(3, 0) + temp737*5.d0*2*rmu(3, 0)*&
&                      temp738b0 + rmucos(3, 0)*temp737b12 + rmucos(3, 0)&
&                      *temp738b
                    hess4fb(2) = 0.0_8
                    temp737b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp737b13 + fun0*der4fb(2)
                    temp737b14 = cost1f*4.d0*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp737b14 + cost1f*(5.d0*rmu(3, 0)**&
&                      2-3.d0*rp0)*2.d0*2*rmucos(3, 0)*der4fb(2) + rmu(3&
&                      , 0)*temp737b12 + 12.d0*temp738*2.d0*2*rmucos(3, 0&
&                      )*temp739b + rmu(3, 0)*temp738b
                    cellscaleb(3) = cellscaleb(3) - temp737*2*cellscale(&
&                      3)*temp737b12
                    temp737b15 = cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - 3.d0*temp737b15 - temp737*3.d0*&
&                      temp738b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp737b13
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*&
&                      temp737b15 + rmucos(3, 0)**2*2*rmu(3, 0)*&
&                      temp737b14
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp748b = -(cost2f*6.d0*hess4fb(2))
                    temp748b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp748b
                    temp747 = cellscale(1)**2
                    temp744 = rmucos(1, 0)/temp747
                    temp746 = 5.d0*rmu(3, 0)**2 - rp0
                    temp745 = fun0*rmu(1, 0)
                    temp745b = -(pi**2*cost2f*4.d0*hess4fb(2))
                    temp745b0 = temp744*temp745b
                    temp744b = temp745*temp746*temp745b/temp747
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp746*rmu(1, &
&                      0)*temp745b0 + rmucos(1, 0)*rmu(1, 0)*temp748b0
                    rmub(1, 0) = rmub(1, 0) + temp746*fun0*temp745b0 + &
&                      rmucos(1, 0)*fun0*temp748b0
                    hess4fb(2) = 0.0_8
                    temp744b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp744b0 + fun0*der4fb(2)
                    temp744b1 = -(cost2f*2.d0*der4fb(2))
                    rmucosb(1, 0) = rmucosb(1, 0) + cost2f*(5.d0*rmu(3, &
&                      0)**2-rp0)*2.d0*2*rmucos(1, 0)*der4fb(2) + rmu(1, &
&                      0)**2*2*rmucos(1, 0)*temp744b1 + temp744b + fun0*&
&                      rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp748b + fun0*&
&                      rmu(1, 0)*temp748b0
                    rmub(3, 0) = rmub(3, 0) + temp745*5.d0*2*rmu(3, 0)*&
&                      temp745b0
                    temp744b2 = cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - temp744b2 - temp745*temp745b0
                    cellscaleb(1) = cellscaleb(1) - temp744*2*cellscale(&
&                      1)*temp744b
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp744b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp744b2
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0&
&                      )*temp744b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp748b1 = -(cost2f*2.d0*hess4fb(2))
                  temp748b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp748b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp748b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp748b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp748b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp748b1
                  hess4fb(2) = 0.0_8
                  temp748b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp748b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp748b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp748b4 = -(cost2f*2.d0*der4fb(2))
                  temp748b5 = rmu(2, 0)*rmucos(2, 0)*temp748b4
                  temp748b6 = rmu(1, 0)*rmucos(1, 0)*temp748b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp748b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp748b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp748b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp748b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 9) THEN
                IF (branch .LT. 8) THEN
                  IF (.NOT.branch .LT. 7) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp748b7 = cost2f*8.d0*hess4fb(2)
                    temp748b8 = (2.d0*rmucos(3, 0)**2-1.d0)*temp748b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*&
&                      rmu(1, 0)*temp748b8
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*&
&                      temp748b8
                    rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                      temp748b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                      rmucos(1, 0)*2.d0*2*rmucos(3, 0)*temp748b7
                    hess4fb(2) = 0.0_8
                    temp748b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp748b9 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp748b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp748b10 = cost2f*8.d0*der4fb(2)
                    temp748b11 = rmu(3, 0)*rmucos(3, 0)*temp748b10
                    temp748b12 = rmu(1, 0)*rmucos(1, 0)*temp748b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp748b11
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp748b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp748b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp748b12
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp748b13 = -(cost2f*2.d0*hess4fb(2))
                  temp748b14 = (2.d0*rmucos(1, 0)**2-1.d0)*temp748b13
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(&
&                    2, 0)*temp748b14
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp748b14
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*&
&                    temp748b14
                  hess4fb(2) = 0.0_8
                  temp748b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp748b15 + fun0*der4fb(2)
                  temp748b16 = -(cost2f*2.d0*der4fb(2))
                  temp748b17 = rmu(2, 0)*rmucos(2, 0)*temp748b16
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp748b17 +&
&                    fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                    temp748b13
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp748b15
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp748b18 = rmu(1, 0)*rmucos(1, 0)*temp748b16
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp748b17
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp748b18
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp748b18
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 11) THEN
                IF (branch .LT. 10) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp752b = -(cost2f*6.d0*hess4fb(2))
                  temp752b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp752b
                  temp751 = cellscale(2)**2
                  temp748 = rmucos(2, 0)/temp751
                  temp750 = 5.d0*rmu(3, 0)**2 - rp0
                  temp749 = fun0*rmu(2, 0)
                  temp749b = -(pi**2*cost2f*4.d0*hess4fb(2))
                  temp749b0 = temp748*temp749b
                  temp748b19 = temp749*temp750*temp749b/temp751
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp750*rmu(2, 0)&
&                    *temp749b0 + rmucos(2, 0)*rmu(2, 0)*temp752b0
                  rmub(2, 0) = rmub(2, 0) + temp750*fun0*temp749b0 + &
&                    rmucos(2, 0)*fun0*temp752b0
                  hess4fb(2) = 0.0_8
                  temp748b20 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp748b20 + fun0*der4fb(2)
                  temp748b21 = -(cost2f*2.d0*der4fb(2))
                  rmucosb(2, 0) = rmucosb(2, 0) + cost2f*(5.d0*rmu(3, 0)&
&                    **2-rp0)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2, 0)**&
&                    2*2*rmucos(2, 0)*temp748b21 + temp748b19 + fun0*rmu(&
&                    2, 0)*rmucos(2, 0)**2*2.d0*2*temp752b + fun0*rmu(2, &
&                    0)*temp752b0
                  rmub(3, 0) = rmub(3, 0) + temp749*5.d0*2*rmu(3, 0)*&
&                    temp749b0
                  temp748b22 = cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*der4fb&
&                    (2)
                  rp0b = rp0b - temp748b22 - temp749*temp749b0
                  cellscaleb(2) = cellscaleb(2) - temp748*2*cellscale(2)&
&                    *temp748b19
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp748b20
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp748b22
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                    temp748b21
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp752b1 = cost2f*8.d0*hess4fb(2)
                temp752b2 = (2.d0*rmucos(3, 0)**2-1.d0)*temp752b1
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp752b2
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp752b2
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*temp752b2
                rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*rmucos(2&
&                  , 0)*2.d0*2*rmucos(3, 0)*temp752b1
                hess4fb(2) = 0.0_8
                temp752b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp752b3 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp752b3
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp752b4 = cost2f*8.d0*der4fb(2)
                temp752b5 = rmu(3, 0)*rmucos(3, 0)*temp752b4
                temp752b6 = rmu(2, 0)*rmucos(2, 0)*temp752b4
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp752b5
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp752b5
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp752b6
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp752b6
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 18) THEN
              IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  IF (branch .LT. 13) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp752b7 = cost3f*2.d0*hess4fb(2)
                    temp752b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp752b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp752b8
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp752b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp752b8
                    hess4fb(2) = 0.0_8
                    temp752b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp752b9 + fun0*der4fb(2)
                    temp752b10 = cost3f*2.d0*der4fb(2)
                    temp752b11 = rmu(3, 0)*rmucos(3, 0)*temp752b10
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp752b11&
&                      + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*rmucos(1, 0)*&
&                      temp752b7
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp752b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp752b12 = rmu(1, 0)*rmucos(1, 0)*temp752b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp752b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp752b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp752b12
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp752b13 = -(cost3f*2.d0*hess4fb(2))
                    temp752b14 = (2.d0*rmucos(2, 0)**2-1.d0)*temp752b13
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp752b14
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp752b14
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp752b14
                    hess4fb(2) = 0.0_8
                    temp752b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp752b15 + fun0*der4fb(2)
                    temp752b16 = -(cost3f*2.d0*der4fb(2))
                    temp752b17 = rmu(3, 0)*rmucos(3, 0)*temp752b16
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp752b17&
&                      + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*rmucos(2, 0)*&
&                      temp752b13
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp752b15
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp752b18 = rmu(2, 0)*rmucos(2, 0)*temp752b16
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp752b17
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp752b18
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp752b18
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp752 = fun0/cellscale(3)
                  temp753 = rmusin(3, 0)*rmucos(3, 0)
                  temp753b = -(cost3f*4.d0*pi*hess4fb(2))
                  temp753b0 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp753b
                  temp752b19 = temp753*temp753b0/cellscale(3)
                  temp752b20 = temp753*temp752*temp753b
                  rmusinb(3, 0) = rmusinb(3, 0) + temp752*rmucos(3, 0)*&
&                    temp753b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp752b19
                  hess4fb(2) = 0.0_8
                  temp752b21 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp752b21 + fun0*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + cost3f*(rmu(1, 0)**2-&
&                    rmu(2, 0)**2)*2.d0*2*rmucos(3, 0)*der4fb(2) + &
&                    temp752*rmusin(3, 0)*temp753b0
                  cellscaleb(3) = cellscaleb(3) - temp752*temp752b19
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp752b20
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp752b20
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp752b21
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp752b22 = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*der4fb&
&                    (2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp752b22
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp752b22
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp756 = rmucos(3, 0)/cellscale(i)
                  temp759 = rmusin(i, 0)*rmucos(i, 0)
                  temp758 = rmucos(2, 0)*rmu(3, 0)
                  temp757 = fun0*rmu(2, 0)
                  temp757b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp757b0 = temp759*temp756*temp757b
                  temp757b1 = temp757*temp758*temp757b
                  temp756b = temp759*temp757b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp758*rmu(2, 0)&
&                    *temp757b0
                  rmub(2, 0) = rmub(2, 0) + temp758*fun0*temp757b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp757*rmu(3, 0)*&
&                    temp757b0
                  rmub(3, 0) = rmub(3, 0) + temp757*rmucos(2, 0)*&
&                    temp757b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp756*rmucos(i, 0)*&
&                    temp757b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp756*rmusin(i, 0)*&
&                    temp757b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp756b
                  cellscaleb(i) = cellscaleb(i) - temp756*temp756b
                  hess4fb(2) = 0.0_8
                  temp756b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp756b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp756b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp755 = rmu(3, 0)*rmucos(3, 0)
                  temp754 = rmu(2, 0)*rmucos(2, 0)
                  temp754b = cost3f*2.d0*der4fb(2)
                  temp754b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp754b
                  rmub(2, 0) = rmub(2, 0) + temp755*rmucos(2, 0)*&
&                    temp754b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp755*rmu(2, 0)*&
&                    temp754b0
                  rmub(3, 0) = rmub(3, 0) + temp754*rmucos(3, 0)*&
&                    temp754b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp754*rmu(3, 0)*&
&                    temp754b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp754*temp755*2.d0*2&
&                    *rmucos(i, 0)*temp754b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp762 = rmucos(3, 0)/cellscale(i)
                  temp765 = rmusin(i, 0)*rmucos(i, 0)
                  temp764 = rmucos(1, 0)*rmu(3, 0)
                  temp763 = fun0*rmu(1, 0)
                  temp763b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp763b0 = temp765*temp762*temp763b
                  temp763b1 = temp763*temp764*temp763b
                  temp762b = temp765*temp763b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp764*rmu(1, 0)&
&                    *temp763b0
                  rmub(1, 0) = rmub(1, 0) + temp764*fun0*temp763b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp763*rmu(3, 0)*&
&                    temp763b0
                  rmub(3, 0) = rmub(3, 0) + temp763*rmucos(1, 0)*&
&                    temp763b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp762*rmucos(i, 0)*&
&                    temp763b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp762*rmusin(i, 0)*&
&                    temp763b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp762b
                  cellscaleb(i) = cellscaleb(i) - temp762*temp762b
                  hess4fb(2) = 0.0_8
                  temp762b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp762b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp762b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp761 = rmu(3, 0)*rmucos(3, 0)
                  temp760 = rmu(1, 0)*rmucos(1, 0)
                  temp760b = cost3f*2.d0*der4fb(2)
                  temp760b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp760b
                  rmub(1, 0) = rmub(1, 0) + temp761*rmucos(1, 0)*&
&                    temp760b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp761*rmu(1, 0)*&
&                    temp760b0
                  rmub(3, 0) = rmub(3, 0) + temp760*rmucos(3, 0)*&
&                    temp760b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp760*rmu(3, 0)*&
&                    temp760b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp760*temp761*2.d0*2&
&                    *rmucos(i, 0)*temp760b
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp768 = rmucos(2, 0)/cellscale(i)
                temp771 = rmusin(i, 0)*rmucos(i, 0)
                temp770 = rmucos(1, 0)*rmu(2, 0)
                temp769 = fun0*rmu(1, 0)
                temp769b = -(cost3f*8.d0*pi*hess4fb(2))
                temp769b0 = temp771*temp768*temp769b
                temp769b1 = temp769*temp770*temp769b
                temp768b = temp771*temp769b1/cellscale(i)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp770*rmu(1, 0)*&
&                  temp769b0
                rmub(1, 0) = rmub(1, 0) + temp770*fun0*temp769b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp769*rmu(2, 0)*&
&                  temp769b0
                rmub(2, 0) = rmub(2, 0) + temp769*rmucos(1, 0)*temp769b0
                rmusinb(i, 0) = rmusinb(i, 0) + temp768*rmucos(i, 0)*&
&                  temp769b1
                rmucosb(i, 0) = rmucosb(i, 0) + temp768*rmusin(i, 0)*&
&                  temp769b1
                rmucosb(2, 0) = rmucosb(2, 0) + temp768b
                cellscaleb(i) = cellscaleb(i) - temp768*temp768b
                hess4fb(2) = 0.0_8
                temp768b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp768b0 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp768b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp767 = rmu(2, 0)*rmucos(2, 0)
                temp766 = rmu(1, 0)*rmucos(1, 0)
                temp766b = cost3f*2.d0*der4fb(2)
                temp766b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp766b
                rmub(1, 0) = rmub(1, 0) + temp767*rmucos(1, 0)*temp766b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp767*rmu(1, 0)*&
&                  temp766b0
                rmub(2, 0) = rmub(2, 0) + temp766*rmucos(2, 0)*temp766b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp766*rmu(2, 0)*&
&                  temp766b0
                rmucosb(i, 0) = rmucosb(i, 0) + temp766*temp767*2.d0*2*&
&                  rmucos(i, 0)*temp766b
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                IF (branch .LT. 19) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp774b = cost4f*6.d0*hess4fb(2)
                  temp774b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp774b
                  temp773 = cellscale(1)**2
                  temp772 = rmucos(1, 0)/temp773
                  temp773b = -(cost4f*4.d0*pi**2*hess4fb(2))
                  temp773b0 = fun0*rmu(1, 0)*temp772*temp773b
                  temp773b1 = (rmu(1, 0)**2-3.d0*rmu(2, 0)**2)*temp773b
                  temp772b = fun0*rmu(1, 0)*temp773b1/temp773
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp772*rmu(1, 0)&
&                    *temp773b1 + rmucos(1, 0)*rmu(1, 0)*temp774b0
                  rmub(1, 0) = rmub(1, 0) + temp772*fun0*temp773b1 + 2*&
&                    rmu(1, 0)*temp773b0 + rmucos(1, 0)*fun0*temp774b0
                  hess4fb(2) = 0.0_8
                  temp772b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp772b0 + fun0*der4fb(2)
                  temp772b1 = cost4f*2.d0*der4fb(2)
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(&
&                    1, 0)*temp772b1 + cost4f*(rmu(1, 0)**2-3.d0*rmu(2, 0&
&                    )**2)*2.d0*2*rmucos(1, 0)*der4fb(2) + temp772b + &
&                    fun0*rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp774b + &
&                    fun0*rmu(1, 0)*temp774b0
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp773b0
                  cellscaleb(1) = cellscaleb(1) - temp772*2*cellscale(1)&
&                    *temp772b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp772b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp772b2 = cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*der4fb(&
&                    2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp772b2 + &
&                    rmucos(1, 0)**2*2*rmu(1, 0)*temp772b1
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp772b2
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp774b1 = -(cost4f*6.d0*hess4fb(2))
                  temp774b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp774b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp774b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp774b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp774b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp774b1
                  hess4fb(2) = 0.0_8
                  temp774b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp774b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp774b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp774b4 = -(cost4f*6.d0*der4fb(2))
                  temp774b5 = rmu(2, 0)*rmucos(2, 0)*temp774b4
                  temp774b6 = rmu(1, 0)*rmucos(1, 0)*temp774b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp774b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp774b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp774b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp774b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 23) THEN
              IF (branch .LT. 22) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp774b7 = cost4f*6.d0*hess4fb(2)
                temp774b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp774b7
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp774b8
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp774b8
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*temp774b8
                hess4fb(2) = 0.0_8
                temp774b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp774b9 + fun0*der4fb(2)
                temp774b10 = cost4f*6.d0*der4fb(2)
                temp774b11 = rmu(2, 0)*rmucos(2, 0)*temp774b10
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp774b11 + &
&                  fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                  temp774b7
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp774b9
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp774b12 = rmu(1, 0)*rmucos(1, 0)*temp774b10
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp774b11
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp774b12
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp774b12
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp776b = -(cost4f*6.d0*hess4fb(2))
                temp776b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp776b
                temp775 = cellscale(2)**2
                temp774 = rmucos(2, 0)/temp775
                temp775b = -(cost4f*4.d0*pi**2*hess4fb(2))
                temp775b0 = fun0*rmu(2, 0)*temp774*temp775b
                temp775b1 = (3.d0*rmu(1, 0)**2-rmu(2, 0)**2)*temp775b
                temp774b13 = fun0*rmu(2, 0)*temp775b1/temp775
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp774*rmu(2, 0)*&
&                  temp775b1 + rmucos(2, 0)*rmu(2, 0)*temp776b0
                rmub(2, 0) = rmub(2, 0) + temp774*fun0*temp775b1 - 2*rmu&
&                  (2, 0)*temp775b0 + rmucos(2, 0)*fun0*temp776b0
                hess4fb(2) = 0.0_8
                temp774b14 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp774b14 + fun0*der4fb(2)
                temp774b15 = -(cost4f*2.d0*der4fb(2))
                rmucosb(2, 0) = rmucosb(2, 0) + cost4f*(3.d0*rmu(1, 0)**&
&                  2-rmu(2, 0)**2)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2&
&                  , 0)**2*2*rmucos(2, 0)*temp774b15 + temp774b13 + fun0*&
&                  rmu(2, 0)*rmucos(2, 0)**2*2.d0*2*temp776b + fun0*rmu(2&
&                  , 0)*temp776b0
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp775b0
                cellscaleb(2) = cellscaleb(2) - temp774*2*cellscale(2)*&
&                  temp774b13
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp774b14
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp774b16 = cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*der4fb(2&
&                  )
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp774b16
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                  temp774b15 - 2*rmu(2, 0)*temp774b16
                der4fb(2) = 0.0_8
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4fb(2) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp737b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp737b
            funb = funb + rmu(i, 0)*temp737b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp736 = r(0)**2
        temp735 = fun2/temp736
        temp735b = rmu(i, 0)**2*radhess4fb(i)/temp736
        temp734 = r(0)**2
        temp733 = rmu(i, 0)**2/temp734
        temp733b5 = -(fun*radhess4fb(i)/temp734)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp733b5 + temp735*2*rmu(&
&          i, 0)*radhess4fb(i)
        fun2b = fun2b + temp735b
        rb(0) = rb(0) - temp733*2*r(0)*temp733b5 - temp735*2*r(0)*&
&          temp735b
        funb = funb + (1.d0-temp733)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp733b4 = -(fun*2.d0*fun2b)
      rb(0) = rb(0) + dd1*2*r(0)*temp733b4 + 2*r(0)*rp0b
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp733b4 - 2.d0*distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp733b3 = distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + cosphase(k)*temp733b3
          cosphaseb(k) = cosphaseb(k) + distp(k, 1)*temp733b3
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*cosphase(k)*zb&
&            (indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp733b = cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp733b0 = cost4f*rmu(2, i)*rmucos(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp733b - 2*rmu(2, i)*&
&        temp733b0
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp733b
      distpb(i, 8) = 0.0_8
      temp733b1 = cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*distpb(i, 7)
      temp733b2 = cost4f*rmu(1, i)*rmucos(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp733b1 + 2*rmu(1, i)*&
&        temp733b2 + 3.d0*2*rmu(1, i)*temp733b0
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp733b1
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp733b2
      distpb(i, 7) = 0.0_8
      temp732 = rmu(1, i)*rmucos(1, i)
      temp731 = rmu(3, i)*rmucos(3, i)
      temp731b = cost3f*2.d0*distpb(i, 6)
      temp731b0 = rmu(2, i)*rmucos(2, i)*temp731b
      temp731b1 = temp731*temp732*temp731b
      rmub(3, i) = rmub(3, i) + temp732*rmucos(3, i)*temp731b0
      rmucosb(3, i) = rmucosb(3, i) + temp732*rmu(3, i)*temp731b0
      rmub(1, i) = rmub(1, i) + temp731*rmucos(1, i)*temp731b0
      rmucosb(1, i) = rmucosb(1, i) + temp731*rmu(1, i)*temp731b0
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp731b1
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp731b1
      distpb(i, 6) = 0.0_8
      temp731b2 = cost3f*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      temp731b3 = cost3f*rmu(3, i)*rmucos(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp731b2
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp731b2
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp731b3
      distpb(i, 5) = 0.0_8
      temp731b4 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp731b4 - 2*rmu(2, i)*&
&        temp731b3
      temp731b5 = cost2f*rmu(2, i)*rmucos(2, i)*distpb(i, 4)
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp731b4
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp731b5
      distpb(i, 4) = 0.0_8
      temp731b6 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 3)
      temp731b7 = cost2f*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp731b8 = cost1f*rmu(3, i)*rmucos(3, i)*distpb(i, 2)
      rp0b = -temp731b7 - 3.d0*temp731b8 - temp731b5
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp731b6
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp731b6
      temp731b9 = cost1f*(5.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 2)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp731b9 + 5.d0*2*rmu(3, i&
&        )*temp731b8 + 5.d0*2*rmu(3, i)*temp731b7
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp731b9
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp730 = r(k)**2
      temp730b = c*DEXP(-(dd1*temp730))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp730))*distpb(k, 1)
      dd1b = dd1b - temp730*temp730b
      rb(k) = rb(k) - dd1*2*r(k)*temp730b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.47215808929909374563d0*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (59)
! f single gaussian orbital derivative of 58
! radial R(r)= c*exp(-z r^2)*(9/4/z-r^2)
! normalized
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
    c = dd1**2.25d0*1.47215808929909374563d0
!         c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(i)**2
      distp(i, 2) = cost1f*rmu(3, i)*rmucos(3, i)*(5.d0*rmu(3, i)**2-&
&        3.d0*rp0)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*rmucos(1, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 4) = cost2f*rmu(2, i)*rmucos(2, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 5) = cost3f*rmu(3, i)*rmucos(3, i)*(rmu(1, i)**2-rmu(2, i&
&        )**2)
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmucos(3, i)*rmu(1, i)*rmucos(&
&        1, i)*rmu(2, i)*rmucos(2, i)
      distp(i, 7) = cost4f*rmu(1, i)*rmucos(1, i)*(rmu(1, i)**2-3.d0*rmu&
&        (2, i)**2)
      distp(i, 8) = cost4f*rmu(2, i)*rmucos(2, i)*(3.d0*rmu(1, i)**2-rmu&
&        (2, i)**2)
    END DO
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,7
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*(9.d0/4.d0/dd1-r(k)**2)*distp(k, 1&
&            +ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)*(9.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-13.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+19.d0*dd1*r(0)**2-13.d0&
&        /2.d0)
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(0)**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,7
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part
! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(1, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(2, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 4.d0*cost1f*rmu(3, 0)**2*rmucos(3, 0)**2 + &
&                  cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  3.d0*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1f*fun0*(12.d0*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)-4.d0*pi**2/cellscale(3)**2*&
&                  rmu(3, 0)*rmucos(3, 0)*(5.d0*rmu(3, 0)**2-3.d0*rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)**2*rmucos(1, 0)**2) +&
&                  cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(1)&
&                  **2*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(2, 0)**2*rmucos(2, 0)**2) +&
&                  cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(2)&
&                  **2*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*(rmu(1, 0)&
&                  **2-rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4.d0*fun0*cost3f*pi/cellscale(3)*rmusin(3&
&                  , 0)*rmucos(3, 0)*(rmu(1, 0)**2-rmu(2, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(2, 0)&
&                  *rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(2, 0)*rmucos(2, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost4f*rmu(1, 0)**2*rmucos(1, 0)**2 + &
&                  cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*(rmu(1, 0)**2-3.d0*&
&                  rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0) - 4.d0*fun0*cost4f*pi**2/&
&                  cellscale(1)**2*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)**2-&
&                  3.d0*rmu(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                rmucos(2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(2.d0*&
&                rmucos(1, 0)**2-1.d0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = -(2.d0*cost4f*rmu(2, 0)**2*rmucos(2, 0)**2) + &
&                cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*(3.d0*rmu(1, 0)**2-&
&                rmu(2, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(&
&                2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*fun0*cost4f*pi**2/&
&                cellscale(2)**2*rmu(2, 0)*rmucos(2, 0)*(3.d0*rmu(1, 0)**&
&                2-rmu(2, 0)**2)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
!enddo for i
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*(9.d0/4.d0/dd1-r(0)&
&              **2)*distp(0, 1+ic)*cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*(9.d0/4.d0/dd1-r(0)**2)*distp(0, 1+ic)*sinphase(i, 0&
&              )*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      dd1b = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=7,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp838 = distp(0, 1)*rphase(i)
            temp837 = distp(0, 1+ic)*sinphase(i, 0)
            temp837b = -(temp837*temp838*zb(indorbp, indt+i))
            temp836 = 4.d0*dd1
            temp835 = 9.d0/temp836
            temp835b = -((temp835-r(0)**2)*zb(indorbp, indt+i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp834 = distp(0, 1+ic)*rphase(i)**2
            temp832 = 4.d0*dd1
            temp831 = 9.d0/temp832
            temp831b = -((temp831-r(0)**2)*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + temp834&
&              *distp(0, 1)*temp831b + z(indorbp, indt+i)*zb(indorbp, &
&              indt+i)
            temp833 = distp(0, 1)*cosphase(0)
            temp833b = -(temp833*temp834*hess4fb(1))
            dd1b = dd1b - temp831*4.d0*temp833b/temp832 - temp835*4.d0*&
&              temp837b/temp836
            rb(0) = rb(0) - 2*r(0)*temp833b - 2*r(0)*temp837b
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp838*sinphase(i, 0)*&
&              temp835b
            temp835b0 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp835b0 + &
&              temp838*distp(0, 1+ic)*temp835b
            distpb(0, 1) = distpb(0, 1) + temp834*cosphase(0)*temp831b +&
&              temp837*rphase(i)*temp835b
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp835b0 + temp833&
&              *distp(0, 1+ic)*2*rphase(i)*temp831b + temp837*distp(0, 1)&
&              *temp835b
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp833*rphase(i)**2*&
&              temp831b
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp830 = der4f(1)/cellscale(i)
            temp830b1 = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp830*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp830b1
            cellscaleb(i) = cellscaleb(i) - temp830*temp830b1
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 12) THEN
              IF (branch .LT. 6) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    IF (branch .LT. 1) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp791b0 = -(cost1f*6.d0*hess4fb(2))
                      temp791b1 = (2.d0*rmucos(1, 0)**2-1.d0)*temp791b0
                      rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(1, 0)*temp791b0
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp791b1
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp791b1
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp791b1
                      hess4fb(2) = 0.0_8
                      temp791b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp791b2 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp791b2
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp791b3 = -(cost1f*6.d0*der4fb(2))
                      temp791b4 = rmu(3, 0)*rmucos(3, 0)*temp791b3
                      temp791b5 = rmu(1, 0)*rmucos(1, 0)*temp791b3
                      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp791b4
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp791b4
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp791b5
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp791b5
                      der4fb(2) = 0.0_8
                    ELSE
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp791b6 = -(cost1f*6.d0*hess4fb(2))
                      temp791b7 = (2.d0*rmucos(2, 0)**2-1.d0)*temp791b6
                      rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(2, 0)*temp791b6
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp791b7
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp791b7
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp791b7
                      hess4fb(2) = 0.0_8
                      temp791b8 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp791b8 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp791b8
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp791b9 = -(cost1f*6.d0*der4fb(2))
                      temp791b10 = rmu(3, 0)*rmucos(3, 0)*temp791b9
                      temp791b11 = rmu(2, 0)*rmucos(2, 0)*temp791b9
                      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp791b10
                      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                        temp791b10
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp791b11
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp791b11
                      der4fb(2) = 0.0_8
                    END IF
                  END IF
                ELSE IF (branch .LT. 5) THEN
                  IF (branch .LT. 4) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp797 = 5.d0*rmu(3, 0)**2 - 3.d0*rp0
                    temp796 = cellscale(3)**2
                    temp795 = rmu(3, 0)*rmucos(3, 0)
                    temp791 = temp795/temp796
                    temp794 = 4.d0*pi**2
                    temp793 = 2.d0*rmucos(3, 0)**2 - 1.d0
                    temp792 = rmu(3, 0)*rmucos(3, 0)
                    temp793b = cost1f*fun0*hess4fb(2)
                    temp792b = 12.d0*temp793*temp793b
                    temp792b0 = -(temp794*temp793b)
                    temp791b12 = temp797*temp792b0/temp796
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + cost1f*(12.d0*(&
&                      temp792*temp793)-temp794*(temp791*temp797))*&
&                      hess4fb(2)
                    rmub(3, 0) = rmub(3, 0) + temp791*5.d0*2*rmu(3, 0)*&
&                      temp792b0 + rmucos(3, 0)*temp791b12 + rmucos(3, 0)&
&                      *temp792b
                    hess4fb(2) = 0.0_8
                    temp791b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp791b13 + fun0*der4fb(2)
                    temp791b14 = cost1f*4.d0*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp791b14 + cost1f*(5.d0*rmu(3, 0)**&
&                      2-3.d0*rp0)*2.d0*2*rmucos(3, 0)*der4fb(2) + rmu(3&
&                      , 0)*temp791b12 + 12.d0*temp792*2.d0*2*rmucos(3, 0&
&                      )*temp793b + rmu(3, 0)*temp792b
                    cellscaleb(3) = cellscaleb(3) - temp791*2*cellscale(&
&                      3)*temp791b12
                    temp791b15 = cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - 3.d0*temp791b15 - temp791*3.d0*&
&                      temp792b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp791b13
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*&
&                      temp791b15 + rmucos(3, 0)**2*2*rmu(3, 0)*&
&                      temp791b14
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp802b = -(cost2f*6.d0*hess4fb(2))
                    temp802b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp802b
                    temp801 = cellscale(1)**2
                    temp798 = rmucos(1, 0)/temp801
                    temp800 = 5.d0*rmu(3, 0)**2 - rp0
                    temp799 = fun0*rmu(1, 0)
                    temp799b = -(pi**2*cost2f*4.d0*hess4fb(2))
                    temp799b0 = temp798*temp799b
                    temp798b = temp799*temp800*temp799b/temp801
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp800*rmu(1, &
&                      0)*temp799b0 + rmucos(1, 0)*rmu(1, 0)*temp802b0
                    rmub(1, 0) = rmub(1, 0) + temp800*fun0*temp799b0 + &
&                      rmucos(1, 0)*fun0*temp802b0
                    hess4fb(2) = 0.0_8
                    temp798b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp798b0 + fun0*der4fb(2)
                    temp798b1 = -(cost2f*2.d0*der4fb(2))
                    rmucosb(1, 0) = rmucosb(1, 0) + cost2f*(5.d0*rmu(3, &
&                      0)**2-rp0)*2.d0*2*rmucos(1, 0)*der4fb(2) + rmu(1, &
&                      0)**2*2*rmucos(1, 0)*temp798b1 + temp798b + fun0*&
&                      rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp802b + fun0*&
&                      rmu(1, 0)*temp802b0
                    rmub(3, 0) = rmub(3, 0) + temp799*5.d0*2*rmu(3, 0)*&
&                      temp799b0
                    temp798b2 = cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - temp798b2 - temp799*temp799b0
                    cellscaleb(1) = cellscaleb(1) - temp798*2*cellscale(&
&                      1)*temp798b
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp798b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp798b2
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0&
&                      )*temp798b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp802b1 = -(cost2f*2.d0*hess4fb(2))
                  temp802b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp802b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp802b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp802b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp802b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp802b1
                  hess4fb(2) = 0.0_8
                  temp802b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp802b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp802b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp802b4 = -(cost2f*2.d0*der4fb(2))
                  temp802b5 = rmu(2, 0)*rmucos(2, 0)*temp802b4
                  temp802b6 = rmu(1, 0)*rmucos(1, 0)*temp802b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp802b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp802b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp802b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp802b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 9) THEN
                IF (branch .LT. 8) THEN
                  IF (.NOT.branch .LT. 7) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp802b7 = cost2f*8.d0*hess4fb(2)
                    temp802b8 = (2.d0*rmucos(3, 0)**2-1.d0)*temp802b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*&
&                      rmu(1, 0)*temp802b8
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*&
&                      temp802b8
                    rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                      temp802b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                      rmucos(1, 0)*2.d0*2*rmucos(3, 0)*temp802b7
                    hess4fb(2) = 0.0_8
                    temp802b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp802b9 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp802b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp802b10 = cost2f*8.d0*der4fb(2)
                    temp802b11 = rmu(3, 0)*rmucos(3, 0)*temp802b10
                    temp802b12 = rmu(1, 0)*rmucos(1, 0)*temp802b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp802b11
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp802b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp802b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp802b12
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp802b13 = -(cost2f*2.d0*hess4fb(2))
                  temp802b14 = (2.d0*rmucos(1, 0)**2-1.d0)*temp802b13
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(&
&                    2, 0)*temp802b14
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp802b14
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*&
&                    temp802b14
                  hess4fb(2) = 0.0_8
                  temp802b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp802b15 + fun0*der4fb(2)
                  temp802b16 = -(cost2f*2.d0*der4fb(2))
                  temp802b17 = rmu(2, 0)*rmucos(2, 0)*temp802b16
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp802b17 +&
&                    fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                    temp802b13
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp802b15
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp802b18 = rmu(1, 0)*rmucos(1, 0)*temp802b16
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp802b17
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp802b18
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp802b18
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 11) THEN
                IF (branch .LT. 10) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp806b = -(cost2f*6.d0*hess4fb(2))
                  temp806b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp806b
                  temp805 = cellscale(2)**2
                  temp802 = rmucos(2, 0)/temp805
                  temp804 = 5.d0*rmu(3, 0)**2 - rp0
                  temp803 = fun0*rmu(2, 0)
                  temp803b = -(pi**2*cost2f*4.d0*hess4fb(2))
                  temp803b0 = temp802*temp803b
                  temp802b19 = temp803*temp804*temp803b/temp805
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp804*rmu(2, 0)&
&                    *temp803b0 + rmucos(2, 0)*rmu(2, 0)*temp806b0
                  rmub(2, 0) = rmub(2, 0) + temp804*fun0*temp803b0 + &
&                    rmucos(2, 0)*fun0*temp806b0
                  hess4fb(2) = 0.0_8
                  temp802b20 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp802b20 + fun0*der4fb(2)
                  temp802b21 = -(cost2f*2.d0*der4fb(2))
                  rmucosb(2, 0) = rmucosb(2, 0) + cost2f*(5.d0*rmu(3, 0)&
&                    **2-rp0)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2, 0)**&
&                    2*2*rmucos(2, 0)*temp802b21 + temp802b19 + fun0*rmu(&
&                    2, 0)*rmucos(2, 0)**2*2.d0*2*temp806b + fun0*rmu(2, &
&                    0)*temp806b0
                  rmub(3, 0) = rmub(3, 0) + temp803*5.d0*2*rmu(3, 0)*&
&                    temp803b0
                  temp802b22 = cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*der4fb&
&                    (2)
                  rp0b = rp0b - temp802b22 - temp803*temp803b0
                  cellscaleb(2) = cellscaleb(2) - temp802*2*cellscale(2)&
&                    *temp802b19
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp802b20
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp802b22
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                    temp802b21
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp806b1 = cost2f*8.d0*hess4fb(2)
                temp806b2 = (2.d0*rmucos(3, 0)**2-1.d0)*temp806b1
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp806b2
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp806b2
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*temp806b2
                rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*rmucos(2&
&                  , 0)*2.d0*2*rmucos(3, 0)*temp806b1
                hess4fb(2) = 0.0_8
                temp806b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp806b3 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp806b3
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp806b4 = cost2f*8.d0*der4fb(2)
                temp806b5 = rmu(3, 0)*rmucos(3, 0)*temp806b4
                temp806b6 = rmu(2, 0)*rmucos(2, 0)*temp806b4
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp806b5
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp806b5
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp806b6
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp806b6
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 18) THEN
              IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  IF (branch .LT. 13) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp806b7 = cost3f*2.d0*hess4fb(2)
                    temp806b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp806b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp806b8
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp806b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp806b8
                    hess4fb(2) = 0.0_8
                    temp806b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp806b9 + fun0*der4fb(2)
                    temp806b10 = cost3f*2.d0*der4fb(2)
                    temp806b11 = rmu(3, 0)*rmucos(3, 0)*temp806b10
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp806b11&
&                      + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*rmucos(1, 0)*&
&                      temp806b7
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp806b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp806b12 = rmu(1, 0)*rmucos(1, 0)*temp806b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp806b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp806b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp806b12
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp806b13 = -(cost3f*2.d0*hess4fb(2))
                    temp806b14 = (2.d0*rmucos(2, 0)**2-1.d0)*temp806b13
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp806b14
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp806b14
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp806b14
                    hess4fb(2) = 0.0_8
                    temp806b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp806b15 + fun0*der4fb(2)
                    temp806b16 = -(cost3f*2.d0*der4fb(2))
                    temp806b17 = rmu(3, 0)*rmucos(3, 0)*temp806b16
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp806b17&
&                      + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*rmucos(2, 0)*&
&                      temp806b13
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp806b15
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp806b18 = rmu(2, 0)*rmucos(2, 0)*temp806b16
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp806b17
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp806b18
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp806b18
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp806 = fun0/cellscale(3)
                  temp807 = rmusin(3, 0)*rmucos(3, 0)
                  temp807b = -(cost3f*4.d0*pi*hess4fb(2))
                  temp807b0 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp807b
                  temp806b19 = temp807*temp807b0/cellscale(3)
                  temp806b20 = temp807*temp806*temp807b
                  rmusinb(3, 0) = rmusinb(3, 0) + temp806*rmucos(3, 0)*&
&                    temp807b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp806b19
                  hess4fb(2) = 0.0_8
                  temp806b21 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp806b21 + fun0*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + cost3f*(rmu(1, 0)**2-&
&                    rmu(2, 0)**2)*2.d0*2*rmucos(3, 0)*der4fb(2) + &
&                    temp806*rmusin(3, 0)*temp807b0
                  cellscaleb(3) = cellscaleb(3) - temp806*temp806b19
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp806b20
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp806b20
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp806b21
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp806b22 = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*der4fb&
&                    (2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp806b22
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp806b22
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp810 = rmucos(3, 0)/cellscale(i)
                  temp813 = rmusin(i, 0)*rmucos(i, 0)
                  temp812 = rmucos(2, 0)*rmu(3, 0)
                  temp811 = fun0*rmu(2, 0)
                  temp811b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp811b0 = temp813*temp810*temp811b
                  temp811b1 = temp811*temp812*temp811b
                  temp810b = temp813*temp811b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp812*rmu(2, 0)&
&                    *temp811b0
                  rmub(2, 0) = rmub(2, 0) + temp812*fun0*temp811b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp811*rmu(3, 0)*&
&                    temp811b0
                  rmub(3, 0) = rmub(3, 0) + temp811*rmucos(2, 0)*&
&                    temp811b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp810*rmucos(i, 0)*&
&                    temp811b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp810*rmusin(i, 0)*&
&                    temp811b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp810b
                  cellscaleb(i) = cellscaleb(i) - temp810*temp810b
                  hess4fb(2) = 0.0_8
                  temp810b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp810b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp810b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp809 = rmu(3, 0)*rmucos(3, 0)
                  temp808 = rmu(2, 0)*rmucos(2, 0)
                  temp808b = cost3f*2.d0*der4fb(2)
                  temp808b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp808b
                  rmub(2, 0) = rmub(2, 0) + temp809*rmucos(2, 0)*&
&                    temp808b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp809*rmu(2, 0)*&
&                    temp808b0
                  rmub(3, 0) = rmub(3, 0) + temp808*rmucos(3, 0)*&
&                    temp808b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp808*rmu(3, 0)*&
&                    temp808b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp808*temp809*2.d0*2&
&                    *rmucos(i, 0)*temp808b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp816 = rmucos(3, 0)/cellscale(i)
                  temp819 = rmusin(i, 0)*rmucos(i, 0)
                  temp818 = rmucos(1, 0)*rmu(3, 0)
                  temp817 = fun0*rmu(1, 0)
                  temp817b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp817b0 = temp819*temp816*temp817b
                  temp817b1 = temp817*temp818*temp817b
                  temp816b = temp819*temp817b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp818*rmu(1, 0)&
&                    *temp817b0
                  rmub(1, 0) = rmub(1, 0) + temp818*fun0*temp817b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp817*rmu(3, 0)*&
&                    temp817b0
                  rmub(3, 0) = rmub(3, 0) + temp817*rmucos(1, 0)*&
&                    temp817b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp816*rmucos(i, 0)*&
&                    temp817b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp816*rmusin(i, 0)*&
&                    temp817b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp816b
                  cellscaleb(i) = cellscaleb(i) - temp816*temp816b
                  hess4fb(2) = 0.0_8
                  temp816b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp816b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp816b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp815 = rmu(3, 0)*rmucos(3, 0)
                  temp814 = rmu(1, 0)*rmucos(1, 0)
                  temp814b = cost3f*2.d0*der4fb(2)
                  temp814b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp814b
                  rmub(1, 0) = rmub(1, 0) + temp815*rmucos(1, 0)*&
&                    temp814b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp815*rmu(1, 0)*&
&                    temp814b0
                  rmub(3, 0) = rmub(3, 0) + temp814*rmucos(3, 0)*&
&                    temp814b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp814*rmu(3, 0)*&
&                    temp814b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp814*temp815*2.d0*2&
&                    *rmucos(i, 0)*temp814b
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp822 = rmucos(2, 0)/cellscale(i)
                temp825 = rmusin(i, 0)*rmucos(i, 0)
                temp824 = rmucos(1, 0)*rmu(2, 0)
                temp823 = fun0*rmu(1, 0)
                temp823b = -(cost3f*8.d0*pi*hess4fb(2))
                temp823b0 = temp825*temp822*temp823b
                temp823b1 = temp823*temp824*temp823b
                temp822b = temp825*temp823b1/cellscale(i)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp824*rmu(1, 0)*&
&                  temp823b0
                rmub(1, 0) = rmub(1, 0) + temp824*fun0*temp823b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp823*rmu(2, 0)*&
&                  temp823b0
                rmub(2, 0) = rmub(2, 0) + temp823*rmucos(1, 0)*temp823b0
                rmusinb(i, 0) = rmusinb(i, 0) + temp822*rmucos(i, 0)*&
&                  temp823b1
                rmucosb(i, 0) = rmucosb(i, 0) + temp822*rmusin(i, 0)*&
&                  temp823b1
                rmucosb(2, 0) = rmucosb(2, 0) + temp822b
                cellscaleb(i) = cellscaleb(i) - temp822*temp822b
                hess4fb(2) = 0.0_8
                temp822b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp822b0 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp822b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp821 = rmu(2, 0)*rmucos(2, 0)
                temp820 = rmu(1, 0)*rmucos(1, 0)
                temp820b = cost3f*2.d0*der4fb(2)
                temp820b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp820b
                rmub(1, 0) = rmub(1, 0) + temp821*rmucos(1, 0)*temp820b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp821*rmu(1, 0)*&
&                  temp820b0
                rmub(2, 0) = rmub(2, 0) + temp820*rmucos(2, 0)*temp820b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp820*rmu(2, 0)*&
&                  temp820b0
                rmucosb(i, 0) = rmucosb(i, 0) + temp820*temp821*2.d0*2*&
&                  rmucos(i, 0)*temp820b
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                IF (branch .LT. 19) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp828b = cost4f*6.d0*hess4fb(2)
                  temp828b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp828b
                  temp827 = cellscale(1)**2
                  temp826 = rmucos(1, 0)/temp827
                  temp827b = -(cost4f*4.d0*pi**2*hess4fb(2))
                  temp827b0 = fun0*rmu(1, 0)*temp826*temp827b
                  temp827b1 = (rmu(1, 0)**2-3.d0*rmu(2, 0)**2)*temp827b
                  temp826b = fun0*rmu(1, 0)*temp827b1/temp827
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp826*rmu(1, 0)&
&                    *temp827b1 + rmucos(1, 0)*rmu(1, 0)*temp828b0
                  rmub(1, 0) = rmub(1, 0) + temp826*fun0*temp827b1 + 2*&
&                    rmu(1, 0)*temp827b0 + rmucos(1, 0)*fun0*temp828b0
                  hess4fb(2) = 0.0_8
                  temp826b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp826b0 + fun0*der4fb(2)
                  temp826b1 = cost4f*2.d0*der4fb(2)
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(&
&                    1, 0)*temp826b1 + cost4f*(rmu(1, 0)**2-3.d0*rmu(2, 0&
&                    )**2)*2.d0*2*rmucos(1, 0)*der4fb(2) + temp826b + &
&                    fun0*rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp828b + &
&                    fun0*rmu(1, 0)*temp828b0
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp827b0
                  cellscaleb(1) = cellscaleb(1) - temp826*2*cellscale(1)&
&                    *temp826b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp826b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp826b2 = cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*der4fb(&
&                    2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp826b2 + &
&                    rmucos(1, 0)**2*2*rmu(1, 0)*temp826b1
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp826b2
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp828b1 = -(cost4f*6.d0*hess4fb(2))
                  temp828b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp828b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp828b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp828b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp828b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp828b1
                  hess4fb(2) = 0.0_8
                  temp828b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp828b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp828b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp828b4 = -(cost4f*6.d0*der4fb(2))
                  temp828b5 = rmu(2, 0)*rmucos(2, 0)*temp828b4
                  temp828b6 = rmu(1, 0)*rmucos(1, 0)*temp828b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp828b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp828b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp828b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp828b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 23) THEN
              IF (branch .LT. 22) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp828b7 = cost4f*6.d0*hess4fb(2)
                temp828b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp828b7
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp828b8
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp828b8
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*temp828b8
                hess4fb(2) = 0.0_8
                temp828b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp828b9 + fun0*der4fb(2)
                temp828b10 = cost4f*6.d0*der4fb(2)
                temp828b11 = rmu(2, 0)*rmucos(2, 0)*temp828b10
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp828b11 + &
&                  fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                  temp828b7
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp828b9
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp828b12 = rmu(1, 0)*rmucos(1, 0)*temp828b10
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp828b11
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp828b12
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp828b12
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp830b = -(cost4f*6.d0*hess4fb(2))
                temp830b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp830b
                temp829 = cellscale(2)**2
                temp828 = rmucos(2, 0)/temp829
                temp829b = -(cost4f*4.d0*pi**2*hess4fb(2))
                temp829b0 = fun0*rmu(2, 0)*temp828*temp829b
                temp829b1 = (3.d0*rmu(1, 0)**2-rmu(2, 0)**2)*temp829b
                temp828b13 = fun0*rmu(2, 0)*temp829b1/temp829
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp828*rmu(2, 0)*&
&                  temp829b1 + rmucos(2, 0)*rmu(2, 0)*temp830b0
                rmub(2, 0) = rmub(2, 0) + temp828*fun0*temp829b1 - 2*rmu&
&                  (2, 0)*temp829b0 + rmucos(2, 0)*fun0*temp830b0
                hess4fb(2) = 0.0_8
                temp828b14 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp828b14 + fun0*der4fb(2)
                temp828b15 = -(cost4f*2.d0*der4fb(2))
                rmucosb(2, 0) = rmucosb(2, 0) + cost4f*(3.d0*rmu(1, 0)**&
&                  2-rmu(2, 0)**2)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2&
&                  , 0)**2*2*rmucos(2, 0)*temp828b15 + temp828b13 + fun0*&
&                  rmu(2, 0)*rmucos(2, 0)**2*2.d0*2*temp830b + fun0*rmu(2&
&                  , 0)*temp830b0
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp829b0
                cellscaleb(2) = cellscaleb(2) - temp828*2*cellscale(2)*&
&                  temp828b13
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp828b14
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp828b16 = cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*der4fb(2&
&                  )
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp828b16
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                  temp828b15 - 2*rmu(2, 0)*temp828b16
                der4fb(2) = 0.0_8
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4fb(2) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp791b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp791b
            funb = funb + rmu(i, 0)*temp791b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp790 = r(0)**2
        temp789 = fun2/temp790
        temp789b = rmu(i, 0)**2*radhess4fb(i)/temp790
        temp788 = r(0)**2
        temp787 = rmu(i, 0)**2/temp788
        temp787b = -(fun*radhess4fb(i)/temp788)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp787b + temp789*2*rmu(i&
&          , 0)*radhess4fb(i)
        fun2b = fun2b + temp789b
        rb(0) = rb(0) - temp787*2*r(0)*temp787b - temp789*2*r(0)*&
&          temp789b
        funb = funb + (1.d0-temp787)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp786b = distp(0, 1)*fun2b
      temp786b0 = distp(0, 1)*2.d0*funb
      rb(0) = rb(0) + (19.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp786b &
&        - distp(0, 1)*2*r(0)*fun0b + dd1*2*r(0)*temp786b0 + 2*r(0)*rp0b
      temp786 = r(0)**4
      temp785 = 4.d0*dd1
      temp784 = 9.d0/temp785
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-13.d0/2.d0)*funb&
&        + (temp784-r(0)**2)*fun0b + (19.d0*(dd1*r(0)**2)-13.d0/2.d0-4.d0&
&        *(dd1**2*temp786))*fun2b
      dd1b = dd1b + r(0)**2*temp786b0 - distp(0, 1)*temp784*4.d0*fun0b/&
&        temp785 + (19.d0*r(0)**2-4.d0*temp786*2*dd1)*temp786b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp783 = 4.d0*dd1
          temp782 = 9.d0/temp783
          temp782b = (temp782-r(k)**2)*zb(indorbp, k)
          temp781 = distp(k, 1+ic)
          temp780 = distp(k, 1)*cosphase(k)
          temp780b3 = temp780*temp781*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + temp781*cosphase(k)*temp782b
          cosphaseb(k) = cosphaseb(k) + temp781*distp(k, 1)*temp782b
          distpb(k, 1+ic) = distpb(k, 1+ic) + temp780*temp782b
          dd1b = dd1b - temp782*4.d0*temp780b3/temp783
          rb(k) = rb(k) - 2*r(k)*temp780b3
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp780b = cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp780b0 = cost4f*rmu(2, i)*rmucos(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp780b - 2*rmu(2, i)*&
&        temp780b0
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp780b
      distpb(i, 8) = 0.0_8
      temp780b1 = cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*distpb(i, 7)
      temp780b2 = cost4f*rmu(1, i)*rmucos(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp780b1 + 2*rmu(1, i)*&
&        temp780b2 + 3.d0*2*rmu(1, i)*temp780b0
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp780b1
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp780b2
      distpb(i, 7) = 0.0_8
      temp779 = rmu(1, i)*rmucos(1, i)
      temp778 = rmu(3, i)*rmucos(3, i)
      temp778b = cost3f*2.d0*distpb(i, 6)
      temp778b0 = rmu(2, i)*rmucos(2, i)*temp778b
      temp778b1 = temp778*temp779*temp778b
      rmub(3, i) = rmub(3, i) + temp779*rmucos(3, i)*temp778b0
      rmucosb(3, i) = rmucosb(3, i) + temp779*rmu(3, i)*temp778b0
      rmub(1, i) = rmub(1, i) + temp778*rmucos(1, i)*temp778b0
      rmucosb(1, i) = rmucosb(1, i) + temp778*rmu(1, i)*temp778b0
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp778b1
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp778b1
      distpb(i, 6) = 0.0_8
      temp778b2 = cost3f*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      temp778b3 = cost3f*rmu(3, i)*rmucos(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp778b2
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp778b2
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp778b3
      distpb(i, 5) = 0.0_8
      temp778b4 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp778b4 - 2*rmu(2, i)*&
&        temp778b3
      temp778b5 = cost2f*rmu(2, i)*rmucos(2, i)*distpb(i, 4)
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp778b4
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp778b5
      distpb(i, 4) = 0.0_8
      temp778b6 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 3)
      temp778b7 = cost2f*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp778b8 = cost1f*rmu(3, i)*rmucos(3, i)*distpb(i, 2)
      rp0b = -temp778b7 - 3.d0*temp778b8 - temp778b5
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp778b6
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp778b6
      temp778b9 = cost1f*(5.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 2)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp778b9 + 5.d0*2*rmu(3, i&
&        )*temp778b8 + 5.d0*2*rmu(3, i)*temp778b7
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp778b9
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp777 = r(k)**2
      temp777b4 = c*DEXP(-(dd1*temp777))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp777))*distpb(k, 1)
      dd1b = dd1b - temp777*temp777b4
      rb(k) = rb(k) - dd1*2*r(k)*temp777b4
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.47215808929909374563d0*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (70)
! f single exp  orbital
! radial R(r)= exp(-alpha r)
! normalized
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
    c = dd1**4.5d0*0.084104417400672d0
!         c=1.d0/dsqrt(10.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(9.d0/2.d0)/3.d0
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
! angular part
! rmu replaced by rmu*rmucos
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(i)**2
      distp(i, 2) = cost1f*rmu(3, i)*rmucos(3, i)*(5.d0*rmu(3, i)**2-&
&        3.d0*rp0)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*rmucos(1, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 4) = cost2f*rmu(2, i)*rmucos(2, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 5) = cost3f*rmu(3, i)*rmucos(3, i)*(rmu(1, i)**2-rmu(2, i&
&        )**2)
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmucos(3, i)*rmu(1, i)*rmucos(&
&        1, i)*rmu(2, i)*rmucos(2, i)
      distp(i, 7) = cost4f*rmu(1, i)*rmucos(1, i)*(rmu(1, i)**2-3.d0*rmu&
&        (2, i)**2)
      distp(i, 8) = cost4f*rmu(2, i)*rmucos(2, i)*(3.d0*rmu(1, i)**2-rmu&
&        (2, i)**2)
    END DO
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,7
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*distp(k, 1+ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)
      fun = -(dd1*distp(0, 1)/r(0))
      fun2 = distp(0, 1)*dd1**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(0)**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,7
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part
! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(1, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(2, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 4.d0*cost1f*rmu(3, 0)**2*rmucos(3, 0)**2 + &
&                  cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  3.d0*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1f*fun0*(12.d0*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)-4.d0*pi**2/cellscale(3)**2*&
&                  rmu(3, 0)*rmucos(3, 0)*(5.d0*rmu(3, 0)**2-3.d0*rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)**2*rmucos(1, 0)**2) +&
&                  cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(1)&
&                  **2*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(2, 0)**2*rmucos(2, 0)**2) +&
&                  cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(2)&
&                  **2*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*(rmu(1, 0)&
&                  **2-rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4.d0*fun0*cost3f*pi/cellscale(3)*rmusin(3&
&                  , 0)*rmucos(3, 0)*(rmu(1, 0)**2-rmu(2, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(2, 0)&
&                  *rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(2, 0)*rmucos(2, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost4f*rmu(1, 0)**2*rmucos(1, 0)**2 + &
&                  cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*(rmu(1, 0)**2-3.d0*&
&                  rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0) - 4.d0*fun0*cost4f*pi**2/&
&                  cellscale(1)**2*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)**2-&
&                  3.d0*rmu(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                rmucos(2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(2.d0*&
&                rmucos(1, 0)**2-1.d0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = -(2.d0*cost4f*rmu(2, 0)**2*rmucos(2, 0)**2) + &
&                cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*(3.d0*rmu(1, 0)**2-&
&                rmu(2, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(&
&                2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*fun0*cost4f*pi**2/&
&                cellscale(2)**2*rmu(2, 0)*rmucos(2, 0)*(3.d0*rmu(1, 0)**&
&                2-rmu(2, 0)**2)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
!enddo for i
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*distp(0, 1+ic)*&
&              cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*distp(0, 1+ic)*sinphase(i, 0)*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=7,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp886b = -(distp(0, 1)*rphase(i)*zb(indorbp, indt+i))
            temp886b0 = -(distp(0, 1+ic)*sinphase(i, 0)*zb(indorbp, indt&
&              +i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp886b1 = -(distp(0, 1+ic)*rphase(i)**2*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + distp(0&
&              , 1)*temp886b1 + z(indorbp, indt+i)*zb(indorbp, indt+i)
            distpb(0, 1+ic) = distpb(0, 1+ic) + sinphase(i, 0)*temp886b
            temp886b2 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp886b2 + &
&              distp(0, 1+ic)*temp886b
            distpb(0, 1) = distpb(0, 1) + cosphase(0)*temp886b1 + rphase&
&              (i)*temp886b0
            temp886b3 = -(distp(0, 1)*cosphase(0)*hess4fb(1))
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp886b2 + distp(0&
&              , 1+ic)*2*rphase(i)*temp886b3 + distp(0, 1)*temp886b0
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + rphase(i)**2*temp886b3
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp885 = der4f(1)/cellscale(i)
            temp885b1 = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp885*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp885b1
            cellscaleb(i) = cellscaleb(i) - temp885*temp885b1
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 12) THEN
              IF (branch .LT. 6) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    IF (branch .LT. 1) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp846b0 = -(cost1f*6.d0*hess4fb(2))
                      temp846b1 = (2.d0*rmucos(1, 0)**2-1.d0)*temp846b0
                      rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(1, 0)*temp846b0
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp846b1
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp846b1
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp846b1
                      hess4fb(2) = 0.0_8
                      temp846b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp846b2 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp846b2
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp846b3 = -(cost1f*6.d0*der4fb(2))
                      temp846b4 = rmu(3, 0)*rmucos(3, 0)*temp846b3
                      temp846b5 = rmu(1, 0)*rmucos(1, 0)*temp846b3
                      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp846b4
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp846b4
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp846b5
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp846b5
                      der4fb(2) = 0.0_8
                    ELSE
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp846b6 = -(cost1f*6.d0*hess4fb(2))
                      temp846b7 = (2.d0*rmucos(2, 0)**2-1.d0)*temp846b6
                      rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(2, 0)*temp846b6
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp846b7
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp846b7
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp846b7
                      hess4fb(2) = 0.0_8
                      temp846b8 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp846b8 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp846b8
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp846b9 = -(cost1f*6.d0*der4fb(2))
                      temp846b10 = rmu(3, 0)*rmucos(3, 0)*temp846b9
                      temp846b11 = rmu(2, 0)*rmucos(2, 0)*temp846b9
                      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp846b10
                      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                        temp846b10
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp846b11
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp846b11
                      der4fb(2) = 0.0_8
                    END IF
                  END IF
                ELSE IF (branch .LT. 5) THEN
                  IF (branch .LT. 4) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp852 = 5.d0*rmu(3, 0)**2 - 3.d0*rp0
                    temp851 = cellscale(3)**2
                    temp850 = rmu(3, 0)*rmucos(3, 0)
                    temp846 = temp850/temp851
                    temp849 = 4.d0*pi**2
                    temp848 = 2.d0*rmucos(3, 0)**2 - 1.d0
                    temp847 = rmu(3, 0)*rmucos(3, 0)
                    temp848b = cost1f*fun0*hess4fb(2)
                    temp847b = 12.d0*temp848*temp848b
                    temp847b0 = -(temp849*temp848b)
                    temp846b12 = temp852*temp847b0/temp851
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + cost1f*(12.d0*(&
&                      temp847*temp848)-temp849*(temp846*temp852))*&
&                      hess4fb(2)
                    rmub(3, 0) = rmub(3, 0) + temp846*5.d0*2*rmu(3, 0)*&
&                      temp847b0 + rmucos(3, 0)*temp846b12 + rmucos(3, 0)&
&                      *temp847b
                    hess4fb(2) = 0.0_8
                    temp846b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp846b13 + fun0*der4fb(2)
                    temp846b14 = cost1f*4.d0*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp846b14 + cost1f*(5.d0*rmu(3, 0)**&
&                      2-3.d0*rp0)*2.d0*2*rmucos(3, 0)*der4fb(2) + rmu(3&
&                      , 0)*temp846b12 + 12.d0*temp847*2.d0*2*rmucos(3, 0&
&                      )*temp848b + rmu(3, 0)*temp847b
                    cellscaleb(3) = cellscaleb(3) - temp846*2*cellscale(&
&                      3)*temp846b12
                    temp846b15 = cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - 3.d0*temp846b15 - temp846*3.d0*&
&                      temp847b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp846b13
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*&
&                      temp846b15 + rmucos(3, 0)**2*2*rmu(3, 0)*&
&                      temp846b14
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp857b = -(cost2f*6.d0*hess4fb(2))
                    temp857b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp857b
                    temp856 = cellscale(1)**2
                    temp853 = rmucos(1, 0)/temp856
                    temp855 = 5.d0*rmu(3, 0)**2 - rp0
                    temp854 = fun0*rmu(1, 0)
                    temp854b = -(pi**2*cost2f*4.d0*hess4fb(2))
                    temp854b0 = temp853*temp854b
                    temp853b = temp854*temp855*temp854b/temp856
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp855*rmu(1, &
&                      0)*temp854b0 + rmucos(1, 0)*rmu(1, 0)*temp857b0
                    rmub(1, 0) = rmub(1, 0) + temp855*fun0*temp854b0 + &
&                      rmucos(1, 0)*fun0*temp857b0
                    hess4fb(2) = 0.0_8
                    temp853b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp853b0 + fun0*der4fb(2)
                    temp853b1 = -(cost2f*2.d0*der4fb(2))
                    rmucosb(1, 0) = rmucosb(1, 0) + cost2f*(5.d0*rmu(3, &
&                      0)**2-rp0)*2.d0*2*rmucos(1, 0)*der4fb(2) + rmu(1, &
&                      0)**2*2*rmucos(1, 0)*temp853b1 + temp853b + fun0*&
&                      rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp857b + fun0*&
&                      rmu(1, 0)*temp857b0
                    rmub(3, 0) = rmub(3, 0) + temp854*5.d0*2*rmu(3, 0)*&
&                      temp854b0
                    temp853b2 = cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - temp853b2 - temp854*temp854b0
                    cellscaleb(1) = cellscaleb(1) - temp853*2*cellscale(&
&                      1)*temp853b
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp853b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp853b2
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0&
&                      )*temp853b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp857b1 = -(cost2f*2.d0*hess4fb(2))
                  temp857b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp857b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp857b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp857b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp857b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp857b1
                  hess4fb(2) = 0.0_8
                  temp857b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp857b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp857b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp857b4 = -(cost2f*2.d0*der4fb(2))
                  temp857b5 = rmu(2, 0)*rmucos(2, 0)*temp857b4
                  temp857b6 = rmu(1, 0)*rmucos(1, 0)*temp857b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp857b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp857b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp857b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp857b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 9) THEN
                IF (branch .LT. 8) THEN
                  IF (.NOT.branch .LT. 7) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp857b7 = cost2f*8.d0*hess4fb(2)
                    temp857b8 = (2.d0*rmucos(3, 0)**2-1.d0)*temp857b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*&
&                      rmu(1, 0)*temp857b8
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*&
&                      temp857b8
                    rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                      temp857b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                      rmucos(1, 0)*2.d0*2*rmucos(3, 0)*temp857b7
                    hess4fb(2) = 0.0_8
                    temp857b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp857b9 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp857b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp857b10 = cost2f*8.d0*der4fb(2)
                    temp857b11 = rmu(3, 0)*rmucos(3, 0)*temp857b10
                    temp857b12 = rmu(1, 0)*rmucos(1, 0)*temp857b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp857b11
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp857b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp857b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp857b12
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp857b13 = -(cost2f*2.d0*hess4fb(2))
                  temp857b14 = (2.d0*rmucos(1, 0)**2-1.d0)*temp857b13
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(&
&                    2, 0)*temp857b14
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp857b14
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*&
&                    temp857b14
                  hess4fb(2) = 0.0_8
                  temp857b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp857b15 + fun0*der4fb(2)
                  temp857b16 = -(cost2f*2.d0*der4fb(2))
                  temp857b17 = rmu(2, 0)*rmucos(2, 0)*temp857b16
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp857b17 +&
&                    fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                    temp857b13
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp857b15
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp857b18 = rmu(1, 0)*rmucos(1, 0)*temp857b16
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp857b17
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp857b18
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp857b18
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 11) THEN
                IF (branch .LT. 10) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp861b = -(cost2f*6.d0*hess4fb(2))
                  temp861b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp861b
                  temp860 = cellscale(2)**2
                  temp857 = rmucos(2, 0)/temp860
                  temp859 = 5.d0*rmu(3, 0)**2 - rp0
                  temp858 = fun0*rmu(2, 0)
                  temp858b = -(pi**2*cost2f*4.d0*hess4fb(2))
                  temp858b0 = temp857*temp858b
                  temp857b19 = temp858*temp859*temp858b/temp860
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp859*rmu(2, 0)&
&                    *temp858b0 + rmucos(2, 0)*rmu(2, 0)*temp861b0
                  rmub(2, 0) = rmub(2, 0) + temp859*fun0*temp858b0 + &
&                    rmucos(2, 0)*fun0*temp861b0
                  hess4fb(2) = 0.0_8
                  temp857b20 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp857b20 + fun0*der4fb(2)
                  temp857b21 = -(cost2f*2.d0*der4fb(2))
                  rmucosb(2, 0) = rmucosb(2, 0) + cost2f*(5.d0*rmu(3, 0)&
&                    **2-rp0)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2, 0)**&
&                    2*2*rmucos(2, 0)*temp857b21 + temp857b19 + fun0*rmu(&
&                    2, 0)*rmucos(2, 0)**2*2.d0*2*temp861b + fun0*rmu(2, &
&                    0)*temp861b0
                  rmub(3, 0) = rmub(3, 0) + temp858*5.d0*2*rmu(3, 0)*&
&                    temp858b0
                  temp857b22 = cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*der4fb&
&                    (2)
                  rp0b = rp0b - temp857b22 - temp858*temp858b0
                  cellscaleb(2) = cellscaleb(2) - temp857*2*cellscale(2)&
&                    *temp857b19
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp857b20
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp857b22
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                    temp857b21
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp861b1 = cost2f*8.d0*hess4fb(2)
                temp861b2 = (2.d0*rmucos(3, 0)**2-1.d0)*temp861b1
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp861b2
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp861b2
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*temp861b2
                rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*rmucos(2&
&                  , 0)*2.d0*2*rmucos(3, 0)*temp861b1
                hess4fb(2) = 0.0_8
                temp861b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp861b3 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp861b3
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp861b4 = cost2f*8.d0*der4fb(2)
                temp861b5 = rmu(3, 0)*rmucos(3, 0)*temp861b4
                temp861b6 = rmu(2, 0)*rmucos(2, 0)*temp861b4
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp861b5
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp861b5
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp861b6
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp861b6
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 18) THEN
              IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  IF (branch .LT. 13) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp861b7 = cost3f*2.d0*hess4fb(2)
                    temp861b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp861b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp861b8
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp861b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp861b8
                    hess4fb(2) = 0.0_8
                    temp861b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp861b9 + fun0*der4fb(2)
                    temp861b10 = cost3f*2.d0*der4fb(2)
                    temp861b11 = rmu(3, 0)*rmucos(3, 0)*temp861b10
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp861b11&
&                      + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*rmucos(1, 0)*&
&                      temp861b7
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp861b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp861b12 = rmu(1, 0)*rmucos(1, 0)*temp861b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp861b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp861b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp861b12
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp861b13 = -(cost3f*2.d0*hess4fb(2))
                    temp861b14 = (2.d0*rmucos(2, 0)**2-1.d0)*temp861b13
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp861b14
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp861b14
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp861b14
                    hess4fb(2) = 0.0_8
                    temp861b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp861b15 + fun0*der4fb(2)
                    temp861b16 = -(cost3f*2.d0*der4fb(2))
                    temp861b17 = rmu(3, 0)*rmucos(3, 0)*temp861b16
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp861b17&
&                      + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*rmucos(2, 0)*&
&                      temp861b13
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp861b15
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp861b18 = rmu(2, 0)*rmucos(2, 0)*temp861b16
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp861b17
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp861b18
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp861b18
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp861 = fun0/cellscale(3)
                  temp862 = rmusin(3, 0)*rmucos(3, 0)
                  temp862b = -(cost3f*4.d0*pi*hess4fb(2))
                  temp862b0 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp862b
                  temp861b19 = temp862*temp862b0/cellscale(3)
                  temp861b20 = temp862*temp861*temp862b
                  rmusinb(3, 0) = rmusinb(3, 0) + temp861*rmucos(3, 0)*&
&                    temp862b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp861b19
                  hess4fb(2) = 0.0_8
                  temp861b21 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp861b21 + fun0*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + cost3f*(rmu(1, 0)**2-&
&                    rmu(2, 0)**2)*2.d0*2*rmucos(3, 0)*der4fb(2) + &
&                    temp861*rmusin(3, 0)*temp862b0
                  cellscaleb(3) = cellscaleb(3) - temp861*temp861b19
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp861b20
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp861b20
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp861b21
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp861b22 = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*der4fb&
&                    (2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp861b22
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp861b22
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp865 = rmucos(3, 0)/cellscale(i)
                  temp868 = rmusin(i, 0)*rmucos(i, 0)
                  temp867 = rmucos(2, 0)*rmu(3, 0)
                  temp866 = fun0*rmu(2, 0)
                  temp866b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp866b0 = temp868*temp865*temp866b
                  temp866b1 = temp866*temp867*temp866b
                  temp865b = temp868*temp866b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp867*rmu(2, 0)&
&                    *temp866b0
                  rmub(2, 0) = rmub(2, 0) + temp867*fun0*temp866b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp866*rmu(3, 0)*&
&                    temp866b0
                  rmub(3, 0) = rmub(3, 0) + temp866*rmucos(2, 0)*&
&                    temp866b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp865*rmucos(i, 0)*&
&                    temp866b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp865*rmusin(i, 0)*&
&                    temp866b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp865b
                  cellscaleb(i) = cellscaleb(i) - temp865*temp865b
                  hess4fb(2) = 0.0_8
                  temp865b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp865b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp865b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp864 = rmu(3, 0)*rmucos(3, 0)
                  temp863 = rmu(2, 0)*rmucos(2, 0)
                  temp863b = cost3f*2.d0*der4fb(2)
                  temp863b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp863b
                  rmub(2, 0) = rmub(2, 0) + temp864*rmucos(2, 0)*&
&                    temp863b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp864*rmu(2, 0)*&
&                    temp863b0
                  rmub(3, 0) = rmub(3, 0) + temp863*rmucos(3, 0)*&
&                    temp863b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp863*rmu(3, 0)*&
&                    temp863b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp863*temp864*2.d0*2&
&                    *rmucos(i, 0)*temp863b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp871 = rmucos(3, 0)/cellscale(i)
                  temp874 = rmusin(i, 0)*rmucos(i, 0)
                  temp873 = rmucos(1, 0)*rmu(3, 0)
                  temp872 = fun0*rmu(1, 0)
                  temp872b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp872b0 = temp874*temp871*temp872b
                  temp872b1 = temp872*temp873*temp872b
                  temp871b = temp874*temp872b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp873*rmu(1, 0)&
&                    *temp872b0
                  rmub(1, 0) = rmub(1, 0) + temp873*fun0*temp872b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp872*rmu(3, 0)*&
&                    temp872b0
                  rmub(3, 0) = rmub(3, 0) + temp872*rmucos(1, 0)*&
&                    temp872b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp871*rmucos(i, 0)*&
&                    temp872b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp871*rmusin(i, 0)*&
&                    temp872b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp871b
                  cellscaleb(i) = cellscaleb(i) - temp871*temp871b
                  hess4fb(2) = 0.0_8
                  temp871b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp871b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp871b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp870 = rmu(3, 0)*rmucos(3, 0)
                  temp869 = rmu(1, 0)*rmucos(1, 0)
                  temp869b = cost3f*2.d0*der4fb(2)
                  temp869b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp869b
                  rmub(1, 0) = rmub(1, 0) + temp870*rmucos(1, 0)*&
&                    temp869b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp870*rmu(1, 0)*&
&                    temp869b0
                  rmub(3, 0) = rmub(3, 0) + temp869*rmucos(3, 0)*&
&                    temp869b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp869*rmu(3, 0)*&
&                    temp869b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp869*temp870*2.d0*2&
&                    *rmucos(i, 0)*temp869b
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp877 = rmucos(2, 0)/cellscale(i)
                temp880 = rmusin(i, 0)*rmucos(i, 0)
                temp879 = rmucos(1, 0)*rmu(2, 0)
                temp878 = fun0*rmu(1, 0)
                temp878b = -(cost3f*8.d0*pi*hess4fb(2))
                temp878b0 = temp880*temp877*temp878b
                temp878b1 = temp878*temp879*temp878b
                temp877b = temp880*temp878b1/cellscale(i)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp879*rmu(1, 0)*&
&                  temp878b0
                rmub(1, 0) = rmub(1, 0) + temp879*fun0*temp878b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp878*rmu(2, 0)*&
&                  temp878b0
                rmub(2, 0) = rmub(2, 0) + temp878*rmucos(1, 0)*temp878b0
                rmusinb(i, 0) = rmusinb(i, 0) + temp877*rmucos(i, 0)*&
&                  temp878b1
                rmucosb(i, 0) = rmucosb(i, 0) + temp877*rmusin(i, 0)*&
&                  temp878b1
                rmucosb(2, 0) = rmucosb(2, 0) + temp877b
                cellscaleb(i) = cellscaleb(i) - temp877*temp877b
                hess4fb(2) = 0.0_8
                temp877b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp877b0 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp877b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp876 = rmu(2, 0)*rmucos(2, 0)
                temp875 = rmu(1, 0)*rmucos(1, 0)
                temp875b = cost3f*2.d0*der4fb(2)
                temp875b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp875b
                rmub(1, 0) = rmub(1, 0) + temp876*rmucos(1, 0)*temp875b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp876*rmu(1, 0)*&
&                  temp875b0
                rmub(2, 0) = rmub(2, 0) + temp875*rmucos(2, 0)*temp875b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp875*rmu(2, 0)*&
&                  temp875b0
                rmucosb(i, 0) = rmucosb(i, 0) + temp875*temp876*2.d0*2*&
&                  rmucos(i, 0)*temp875b
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                IF (branch .LT. 19) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp883b = cost4f*6.d0*hess4fb(2)
                  temp883b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp883b
                  temp882 = cellscale(1)**2
                  temp881 = rmucos(1, 0)/temp882
                  temp882b = -(cost4f*4.d0*pi**2*hess4fb(2))
                  temp882b0 = fun0*rmu(1, 0)*temp881*temp882b
                  temp882b1 = (rmu(1, 0)**2-3.d0*rmu(2, 0)**2)*temp882b
                  temp881b = fun0*rmu(1, 0)*temp882b1/temp882
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp881*rmu(1, 0)&
&                    *temp882b1 + rmucos(1, 0)*rmu(1, 0)*temp883b0
                  rmub(1, 0) = rmub(1, 0) + temp881*fun0*temp882b1 + 2*&
&                    rmu(1, 0)*temp882b0 + rmucos(1, 0)*fun0*temp883b0
                  hess4fb(2) = 0.0_8
                  temp881b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp881b0 + fun0*der4fb(2)
                  temp881b1 = cost4f*2.d0*der4fb(2)
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(&
&                    1, 0)*temp881b1 + cost4f*(rmu(1, 0)**2-3.d0*rmu(2, 0&
&                    )**2)*2.d0*2*rmucos(1, 0)*der4fb(2) + temp881b + &
&                    fun0*rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp883b + &
&                    fun0*rmu(1, 0)*temp883b0
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp882b0
                  cellscaleb(1) = cellscaleb(1) - temp881*2*cellscale(1)&
&                    *temp881b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp881b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp881b2 = cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*der4fb(&
&                    2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp881b2 + &
&                    rmucos(1, 0)**2*2*rmu(1, 0)*temp881b1
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp881b2
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp883b1 = -(cost4f*6.d0*hess4fb(2))
                  temp883b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp883b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp883b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp883b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp883b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp883b1
                  hess4fb(2) = 0.0_8
                  temp883b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp883b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp883b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp883b4 = -(cost4f*6.d0*der4fb(2))
                  temp883b5 = rmu(2, 0)*rmucos(2, 0)*temp883b4
                  temp883b6 = rmu(1, 0)*rmucos(1, 0)*temp883b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp883b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp883b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp883b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp883b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 23) THEN
              IF (branch .LT. 22) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp883b7 = cost4f*6.d0*hess4fb(2)
                temp883b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp883b7
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp883b8
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp883b8
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*temp883b8
                hess4fb(2) = 0.0_8
                temp883b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp883b9 + fun0*der4fb(2)
                temp883b10 = cost4f*6.d0*der4fb(2)
                temp883b11 = rmu(2, 0)*rmucos(2, 0)*temp883b10
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp883b11 + &
&                  fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                  temp883b7
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp883b9
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp883b12 = rmu(1, 0)*rmucos(1, 0)*temp883b10
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp883b11
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp883b12
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp883b12
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp885b = -(cost4f*6.d0*hess4fb(2))
                temp885b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp885b
                temp884 = cellscale(2)**2
                temp883 = rmucos(2, 0)/temp884
                temp884b = -(cost4f*4.d0*pi**2*hess4fb(2))
                temp884b0 = fun0*rmu(2, 0)*temp883*temp884b
                temp884b1 = (3.d0*rmu(1, 0)**2-rmu(2, 0)**2)*temp884b
                temp883b13 = fun0*rmu(2, 0)*temp884b1/temp884
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp883*rmu(2, 0)*&
&                  temp884b1 + rmucos(2, 0)*rmu(2, 0)*temp885b0
                rmub(2, 0) = rmub(2, 0) + temp883*fun0*temp884b1 - 2*rmu&
&                  (2, 0)*temp884b0 + rmucos(2, 0)*fun0*temp885b0
                hess4fb(2) = 0.0_8
                temp883b14 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp883b14 + fun0*der4fb(2)
                temp883b15 = -(cost4f*2.d0*der4fb(2))
                rmucosb(2, 0) = rmucosb(2, 0) + cost4f*(3.d0*rmu(1, 0)**&
&                  2-rmu(2, 0)**2)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2&
&                  , 0)**2*2*rmucos(2, 0)*temp883b15 + temp883b13 + fun0*&
&                  rmu(2, 0)*rmucos(2, 0)**2*2.d0*2*temp885b + fun0*rmu(2&
&                  , 0)*temp885b0
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp884b0
                cellscaleb(2) = cellscaleb(2) - temp883*2*cellscale(2)*&
&                  temp883b13
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp883b14
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp883b16 = cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*der4fb(2&
&                  )
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp883b16
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                  temp883b15 - 2*rmu(2, 0)*temp883b16
                der4fb(2) = 0.0_8
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4fb(2) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp846b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp846b
            funb = funb + rmu(i, 0)*temp846b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp845 = r(0)**2
        temp844 = fun2/temp845
        temp844b = rmu(i, 0)**2*radhess4fb(i)/temp845
        temp843 = r(0)**2
        temp842 = rmu(i, 0)**2/temp843
        temp842b = -(fun*radhess4fb(i)/temp843)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp842b + temp844*2*rmu(i&
&          , 0)*radhess4fb(i)
        fun2b = fun2b + temp844b
        rb(0) = rb(0) - temp842*2*r(0)*temp842b - temp844*2*r(0)*&
&          temp844b
        funb = funb + (1.d0-temp842)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp841 = dd1/r(0)
      temp841b4 = -(distp(0, 1)*funb/r(0))
      rb(0) = rb(0) + 2*r(0)*rp0b - temp841*temp841b4
      distpb(0, 1) = distpb(0, 1) + fun0b - temp841*funb + dd1**2*fun2b
      dd1b = temp841b4 + distp(0, 1)*2*dd1*fun2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp841b3 = distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + cosphase(k)*temp841b3
          cosphaseb(k) = cosphaseb(k) + distp(k, 1)*temp841b3
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*cosphase(k)*zb&
&            (indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp841b = cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp841b0 = cost4f*rmu(2, i)*rmucos(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp841b - 2*rmu(2, i)*&
&        temp841b0
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp841b
      distpb(i, 8) = 0.0_8
      temp841b1 = cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*distpb(i, 7)
      temp841b2 = cost4f*rmu(1, i)*rmucos(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp841b1 + 2*rmu(1, i)*&
&        temp841b2 + 3.d0*2*rmu(1, i)*temp841b0
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp841b1
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp841b2
      distpb(i, 7) = 0.0_8
      temp840 = rmu(1, i)*rmucos(1, i)
      temp839 = rmu(3, i)*rmucos(3, i)
      temp839b0 = cost3f*2.d0*distpb(i, 6)
      temp839b1 = rmu(2, i)*rmucos(2, i)*temp839b0
      temp839b2 = temp839*temp840*temp839b0
      rmub(3, i) = rmub(3, i) + temp840*rmucos(3, i)*temp839b1
      rmucosb(3, i) = rmucosb(3, i) + temp840*rmu(3, i)*temp839b1
      rmub(1, i) = rmub(1, i) + temp839*rmucos(1, i)*temp839b1
      rmucosb(1, i) = rmucosb(1, i) + temp839*rmu(1, i)*temp839b1
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp839b2
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp839b2
      distpb(i, 6) = 0.0_8
      temp839b3 = cost3f*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      temp839b4 = cost3f*rmu(3, i)*rmucos(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp839b3
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp839b3
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp839b4
      distpb(i, 5) = 0.0_8
      temp839b5 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp839b5 - 2*rmu(2, i)*&
&        temp839b4
      temp839b6 = cost2f*rmu(2, i)*rmucos(2, i)*distpb(i, 4)
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp839b5
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp839b6
      distpb(i, 4) = 0.0_8
      temp839b7 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 3)
      temp839b8 = cost2f*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp839b9 = cost1f*rmu(3, i)*rmucos(3, i)*distpb(i, 2)
      rp0b = -temp839b8 - 3.d0*temp839b9 - temp839b6
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp839b7
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp839b7
      temp839b10 = cost1f*(5.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 2)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp839b10 + 5.d0*2*rmu(3, &
&        i)*temp839b9 + 5.d0*2*rmu(3, i)*temp839b8
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp839b10
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp839b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp839b
      rb(k) = rb(k) - dd1*temp839b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.084104417400672d0*4.5d0*dd1**3.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (71)
! f single gaussian orbital derivative of 70
! radial R(r)= c*exp(-z r)*(9/2/z-r)
! normalized
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
!         c=1.d0/dsqrt(10.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(9.d0/2.d0)/3.d0
    c = dd1**4.5d0*0.084104417400672d0
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
! angular part
! rmu replaced by rmu*rmucos
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(i)**2
      distp(i, 2) = cost1f*rmu(3, i)*rmucos(3, i)*(5.d0*rmu(3, i)**2-&
&        3.d0*rp0)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*rmucos(1, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 4) = cost2f*rmu(2, i)*rmucos(2, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 5) = cost3f*rmu(3, i)*rmucos(3, i)*(rmu(1, i)**2-rmu(2, i&
&        )**2)
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmucos(3, i)*rmu(1, i)*rmucos(&
&        1, i)*rmu(2, i)*rmucos(2, i)
      distp(i, 7) = cost4f*rmu(1, i)*rmucos(1, i)*(rmu(1, i)**2-3.d0*rmu&
&        (2, i)**2)
      distp(i, 8) = cost4f*rmu(2, i)*rmucos(2, i)*(3.d0*rmu(1, i)**2-rmu&
&        (2, i)**2)
    END DO
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,7
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*(4.5d0/dd1-r(k))*distp(k, 1+ic)*&
&            cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)*(4.5d0/dd1-r(0))
      fun = distp(0, 1)*(-(5.5d0/r(0))+dd1)
      fun2 = distp(0, 1)*(6.5d0*dd1-r(0)*dd1**2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(0)**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,7
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part
! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(1, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(2, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 4.d0*cost1f*rmu(3, 0)**2*rmucos(3, 0)**2 + &
&                  cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  3.d0*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1f*fun0*(12.d0*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)-4.d0*pi**2/cellscale(3)**2*&
&                  rmu(3, 0)*rmucos(3, 0)*(5.d0*rmu(3, 0)**2-3.d0*rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)**2*rmucos(1, 0)**2) +&
&                  cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(1)&
&                  **2*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(2, 0)**2*rmucos(2, 0)**2) +&
&                  cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(2)&
&                  **2*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*(rmu(1, 0)&
&                  **2-rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4.d0*fun0*cost3f*pi/cellscale(3)*rmusin(3&
&                  , 0)*rmucos(3, 0)*(rmu(1, 0)**2-rmu(2, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(2, 0)&
&                  *rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(2, 0)*rmucos(2, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost4f*rmu(1, 0)**2*rmucos(1, 0)**2 + &
&                  cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*(rmu(1, 0)**2-3.d0*&
&                  rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0) - 4.d0*fun0*cost4f*pi**2/&
&                  cellscale(1)**2*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)**2-&
&                  3.d0*rmu(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                rmucos(2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(2.d0*&
&                rmucos(1, 0)**2-1.d0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = -(2.d0*cost4f*rmu(2, 0)**2*rmucos(2, 0)**2) + &
&                cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*(3.d0*rmu(1, 0)**2-&
&                rmu(2, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(&
&                2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*fun0*cost4f*pi**2/&
&                cellscale(2)**2*rmu(2, 0)*rmucos(2, 0)*(3.d0*rmu(1, 0)**&
&                2-rmu(2, 0)**2)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
!enddo for i
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*(9.d0/4.d0/dd1-r(0)&
&              **2)*distp(0, 1+ic)*cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*(9.d0/4.d0/dd1-r(0)**2)*distp(0, 1+ic)*sinphase(i, 0&
&              )*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      dd1b = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=7,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp941 = distp(0, 1)*rphase(i)
            temp940 = distp(0, 1+ic)*sinphase(i, 0)
            temp940b = -(temp940*temp941*zb(indorbp, indt+i))
            temp939 = 4.d0*dd1
            temp938 = 9.d0/temp939
            temp938b = -((temp938-r(0)**2)*zb(indorbp, indt+i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp937 = distp(0, 1+ic)*rphase(i)**2
            temp935 = 4.d0*dd1
            temp934 = 9.d0/temp935
            temp934b = -((temp934-r(0)**2)*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + temp937&
&              *distp(0, 1)*temp934b + z(indorbp, indt+i)*zb(indorbp, &
&              indt+i)
            temp936 = distp(0, 1)*cosphase(0)
            temp936b = -(temp936*temp937*hess4fb(1))
            dd1b = dd1b - temp934*4.d0*temp936b/temp935 - temp938*4.d0*&
&              temp940b/temp939
            rb(0) = rb(0) - 2*r(0)*temp936b - 2*r(0)*temp940b
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp941*sinphase(i, 0)*&
&              temp938b
            temp938b0 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp938b0 + &
&              temp941*distp(0, 1+ic)*temp938b
            distpb(0, 1) = distpb(0, 1) + temp937*cosphase(0)*temp934b +&
&              temp940*rphase(i)*temp938b
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp938b0 + temp936&
&              *distp(0, 1+ic)*2*rphase(i)*temp934b + temp940*distp(0, 1)&
&              *temp938b
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp936*rphase(i)**2*&
&              temp934b
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp933 = der4f(1)/cellscale(i)
            temp933b1 = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp933*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp933b1
            cellscaleb(i) = cellscaleb(i) - temp933*temp933b1
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 12) THEN
              IF (branch .LT. 6) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    IF (branch .LT. 1) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp894b0 = -(cost1f*6.d0*hess4fb(2))
                      temp894b1 = (2.d0*rmucos(1, 0)**2-1.d0)*temp894b0
                      rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(1, 0)*temp894b0
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp894b1
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp894b1
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp894b1
                      hess4fb(2) = 0.0_8
                      temp894b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp894b2 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp894b2
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp894b3 = -(cost1f*6.d0*der4fb(2))
                      temp894b4 = rmu(3, 0)*rmucos(3, 0)*temp894b3
                      temp894b5 = rmu(1, 0)*rmucos(1, 0)*temp894b3
                      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp894b4
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp894b4
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp894b5
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp894b5
                      der4fb(2) = 0.0_8
                    ELSE
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp894b6 = -(cost1f*6.d0*hess4fb(2))
                      temp894b7 = (2.d0*rmucos(2, 0)**2-1.d0)*temp894b6
                      rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(2, 0)*temp894b6
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp894b7
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp894b7
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp894b7
                      hess4fb(2) = 0.0_8
                      temp894b8 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp894b8 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp894b8
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp894b9 = -(cost1f*6.d0*der4fb(2))
                      temp894b10 = rmu(3, 0)*rmucos(3, 0)*temp894b9
                      temp894b11 = rmu(2, 0)*rmucos(2, 0)*temp894b9
                      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp894b10
                      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                        temp894b10
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp894b11
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp894b11
                      der4fb(2) = 0.0_8
                    END IF
                  END IF
                ELSE IF (branch .LT. 5) THEN
                  IF (branch .LT. 4) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp900 = 5.d0*rmu(3, 0)**2 - 3.d0*rp0
                    temp899 = cellscale(3)**2
                    temp898 = rmu(3, 0)*rmucos(3, 0)
                    temp894 = temp898/temp899
                    temp897 = 4.d0*pi**2
                    temp896 = 2.d0*rmucos(3, 0)**2 - 1.d0
                    temp895 = rmu(3, 0)*rmucos(3, 0)
                    temp896b = cost1f*fun0*hess4fb(2)
                    temp895b = 12.d0*temp896*temp896b
                    temp895b0 = -(temp897*temp896b)
                    temp894b12 = temp900*temp895b0/temp899
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + cost1f*(12.d0*(&
&                      temp895*temp896)-temp897*(temp894*temp900))*&
&                      hess4fb(2)
                    rmub(3, 0) = rmub(3, 0) + temp894*5.d0*2*rmu(3, 0)*&
&                      temp895b0 + rmucos(3, 0)*temp894b12 + rmucos(3, 0)&
&                      *temp895b
                    hess4fb(2) = 0.0_8
                    temp894b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp894b13 + fun0*der4fb(2)
                    temp894b14 = cost1f*4.d0*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp894b14 + cost1f*(5.d0*rmu(3, 0)**&
&                      2-3.d0*rp0)*2.d0*2*rmucos(3, 0)*der4fb(2) + rmu(3&
&                      , 0)*temp894b12 + 12.d0*temp895*2.d0*2*rmucos(3, 0&
&                      )*temp896b + rmu(3, 0)*temp895b
                    cellscaleb(3) = cellscaleb(3) - temp894*2*cellscale(&
&                      3)*temp894b12
                    temp894b15 = cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - 3.d0*temp894b15 - temp894*3.d0*&
&                      temp895b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp894b13
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*&
&                      temp894b15 + rmucos(3, 0)**2*2*rmu(3, 0)*&
&                      temp894b14
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp905b = -(cost2f*6.d0*hess4fb(2))
                    temp905b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp905b
                    temp904 = cellscale(1)**2
                    temp901 = rmucos(1, 0)/temp904
                    temp903 = 5.d0*rmu(3, 0)**2 - rp0
                    temp902 = fun0*rmu(1, 0)
                    temp902b = -(pi**2*cost2f*4.d0*hess4fb(2))
                    temp902b0 = temp901*temp902b
                    temp901b = temp902*temp903*temp902b/temp904
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp903*rmu(1, &
&                      0)*temp902b0 + rmucos(1, 0)*rmu(1, 0)*temp905b0
                    rmub(1, 0) = rmub(1, 0) + temp903*fun0*temp902b0 + &
&                      rmucos(1, 0)*fun0*temp905b0
                    hess4fb(2) = 0.0_8
                    temp901b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp901b0 + fun0*der4fb(2)
                    temp901b1 = -(cost2f*2.d0*der4fb(2))
                    rmucosb(1, 0) = rmucosb(1, 0) + cost2f*(5.d0*rmu(3, &
&                      0)**2-rp0)*2.d0*2*rmucos(1, 0)*der4fb(2) + rmu(1, &
&                      0)**2*2*rmucos(1, 0)*temp901b1 + temp901b + fun0*&
&                      rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp905b + fun0*&
&                      rmu(1, 0)*temp905b0
                    rmub(3, 0) = rmub(3, 0) + temp902*5.d0*2*rmu(3, 0)*&
&                      temp902b0
                    temp901b2 = cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - temp901b2 - temp902*temp902b0
                    cellscaleb(1) = cellscaleb(1) - temp901*2*cellscale(&
&                      1)*temp901b
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp901b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp901b2
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0&
&                      )*temp901b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp905b1 = -(cost2f*2.d0*hess4fb(2))
                  temp905b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp905b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp905b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp905b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp905b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp905b1
                  hess4fb(2) = 0.0_8
                  temp905b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp905b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp905b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp905b4 = -(cost2f*2.d0*der4fb(2))
                  temp905b5 = rmu(2, 0)*rmucos(2, 0)*temp905b4
                  temp905b6 = rmu(1, 0)*rmucos(1, 0)*temp905b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp905b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp905b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp905b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp905b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 9) THEN
                IF (branch .LT. 8) THEN
                  IF (.NOT.branch .LT. 7) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp905b7 = cost2f*8.d0*hess4fb(2)
                    temp905b8 = (2.d0*rmucos(3, 0)**2-1.d0)*temp905b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*&
&                      rmu(1, 0)*temp905b8
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*&
&                      temp905b8
                    rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                      temp905b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                      rmucos(1, 0)*2.d0*2*rmucos(3, 0)*temp905b7
                    hess4fb(2) = 0.0_8
                    temp905b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp905b9 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp905b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp905b10 = cost2f*8.d0*der4fb(2)
                    temp905b11 = rmu(3, 0)*rmucos(3, 0)*temp905b10
                    temp905b12 = rmu(1, 0)*rmucos(1, 0)*temp905b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp905b11
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp905b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp905b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp905b12
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp905b13 = -(cost2f*2.d0*hess4fb(2))
                  temp905b14 = (2.d0*rmucos(1, 0)**2-1.d0)*temp905b13
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(&
&                    2, 0)*temp905b14
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp905b14
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*&
&                    temp905b14
                  hess4fb(2) = 0.0_8
                  temp905b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp905b15 + fun0*der4fb(2)
                  temp905b16 = -(cost2f*2.d0*der4fb(2))
                  temp905b17 = rmu(2, 0)*rmucos(2, 0)*temp905b16
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp905b17 +&
&                    fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                    temp905b13
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp905b15
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp905b18 = rmu(1, 0)*rmucos(1, 0)*temp905b16
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp905b17
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp905b18
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp905b18
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 11) THEN
                IF (branch .LT. 10) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp909b = -(cost2f*6.d0*hess4fb(2))
                  temp909b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp909b
                  temp908 = cellscale(2)**2
                  temp905 = rmucos(2, 0)/temp908
                  temp907 = 5.d0*rmu(3, 0)**2 - rp0
                  temp906 = fun0*rmu(2, 0)
                  temp906b = -(pi**2*cost2f*4.d0*hess4fb(2))
                  temp906b0 = temp905*temp906b
                  temp905b19 = temp906*temp907*temp906b/temp908
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp907*rmu(2, 0)&
&                    *temp906b0 + rmucos(2, 0)*rmu(2, 0)*temp909b0
                  rmub(2, 0) = rmub(2, 0) + temp907*fun0*temp906b0 + &
&                    rmucos(2, 0)*fun0*temp909b0
                  hess4fb(2) = 0.0_8
                  temp905b20 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp905b20 + fun0*der4fb(2)
                  temp905b21 = -(cost2f*2.d0*der4fb(2))
                  rmucosb(2, 0) = rmucosb(2, 0) + cost2f*(5.d0*rmu(3, 0)&
&                    **2-rp0)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2, 0)**&
&                    2*2*rmucos(2, 0)*temp905b21 + temp905b19 + fun0*rmu(&
&                    2, 0)*rmucos(2, 0)**2*2.d0*2*temp909b + fun0*rmu(2, &
&                    0)*temp909b0
                  rmub(3, 0) = rmub(3, 0) + temp906*5.d0*2*rmu(3, 0)*&
&                    temp906b0
                  temp905b22 = cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*der4fb&
&                    (2)
                  rp0b = rp0b - temp905b22 - temp906*temp906b0
                  cellscaleb(2) = cellscaleb(2) - temp905*2*cellscale(2)&
&                    *temp905b19
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp905b20
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp905b22
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                    temp905b21
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp909b1 = cost2f*8.d0*hess4fb(2)
                temp909b2 = (2.d0*rmucos(3, 0)**2-1.d0)*temp909b1
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp909b2
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp909b2
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*temp909b2
                rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*rmucos(2&
&                  , 0)*2.d0*2*rmucos(3, 0)*temp909b1
                hess4fb(2) = 0.0_8
                temp909b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp909b3 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp909b3
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp909b4 = cost2f*8.d0*der4fb(2)
                temp909b5 = rmu(3, 0)*rmucos(3, 0)*temp909b4
                temp909b6 = rmu(2, 0)*rmucos(2, 0)*temp909b4
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp909b5
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp909b5
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp909b6
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp909b6
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 18) THEN
              IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  IF (branch .LT. 13) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp909b7 = cost3f*2.d0*hess4fb(2)
                    temp909b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp909b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp909b8
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp909b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp909b8
                    hess4fb(2) = 0.0_8
                    temp909b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp909b9 + fun0*der4fb(2)
                    temp909b10 = cost3f*2.d0*der4fb(2)
                    temp909b11 = rmu(3, 0)*rmucos(3, 0)*temp909b10
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp909b11&
&                      + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*rmucos(1, 0)*&
&                      temp909b7
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp909b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp909b12 = rmu(1, 0)*rmucos(1, 0)*temp909b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp909b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp909b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp909b12
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp909b13 = -(cost3f*2.d0*hess4fb(2))
                    temp909b14 = (2.d0*rmucos(2, 0)**2-1.d0)*temp909b13
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp909b14
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp909b14
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp909b14
                    hess4fb(2) = 0.0_8
                    temp909b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp909b15 + fun0*der4fb(2)
                    temp909b16 = -(cost3f*2.d0*der4fb(2))
                    temp909b17 = rmu(3, 0)*rmucos(3, 0)*temp909b16
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp909b17&
&                      + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*rmucos(2, 0)*&
&                      temp909b13
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp909b15
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp909b18 = rmu(2, 0)*rmucos(2, 0)*temp909b16
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp909b17
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp909b18
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp909b18
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp909 = fun0/cellscale(3)
                  temp910 = rmusin(3, 0)*rmucos(3, 0)
                  temp910b = -(cost3f*4.d0*pi*hess4fb(2))
                  temp910b0 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp910b
                  temp909b19 = temp910*temp910b0/cellscale(3)
                  temp909b20 = temp910*temp909*temp910b
                  rmusinb(3, 0) = rmusinb(3, 0) + temp909*rmucos(3, 0)*&
&                    temp910b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp909b19
                  hess4fb(2) = 0.0_8
                  temp909b21 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp909b21 + fun0*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + cost3f*(rmu(1, 0)**2-&
&                    rmu(2, 0)**2)*2.d0*2*rmucos(3, 0)*der4fb(2) + &
&                    temp909*rmusin(3, 0)*temp910b0
                  cellscaleb(3) = cellscaleb(3) - temp909*temp909b19
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp909b20
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp909b20
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp909b21
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp909b22 = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*der4fb&
&                    (2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp909b22
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp909b22
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp913 = rmucos(3, 0)/cellscale(i)
                  temp916 = rmusin(i, 0)*rmucos(i, 0)
                  temp915 = rmucos(2, 0)*rmu(3, 0)
                  temp914 = fun0*rmu(2, 0)
                  temp914b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp914b0 = temp916*temp913*temp914b
                  temp914b1 = temp914*temp915*temp914b
                  temp913b = temp916*temp914b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp915*rmu(2, 0)&
&                    *temp914b0
                  rmub(2, 0) = rmub(2, 0) + temp915*fun0*temp914b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp914*rmu(3, 0)*&
&                    temp914b0
                  rmub(3, 0) = rmub(3, 0) + temp914*rmucos(2, 0)*&
&                    temp914b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp913*rmucos(i, 0)*&
&                    temp914b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp913*rmusin(i, 0)*&
&                    temp914b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp913b
                  cellscaleb(i) = cellscaleb(i) - temp913*temp913b
                  hess4fb(2) = 0.0_8
                  temp913b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp913b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp913b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp912 = rmu(3, 0)*rmucos(3, 0)
                  temp911 = rmu(2, 0)*rmucos(2, 0)
                  temp911b = cost3f*2.d0*der4fb(2)
                  temp911b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp911b
                  rmub(2, 0) = rmub(2, 0) + temp912*rmucos(2, 0)*&
&                    temp911b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp912*rmu(2, 0)*&
&                    temp911b0
                  rmub(3, 0) = rmub(3, 0) + temp911*rmucos(3, 0)*&
&                    temp911b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp911*rmu(3, 0)*&
&                    temp911b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp911*temp912*2.d0*2&
&                    *rmucos(i, 0)*temp911b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp919 = rmucos(3, 0)/cellscale(i)
                  temp922 = rmusin(i, 0)*rmucos(i, 0)
                  temp921 = rmucos(1, 0)*rmu(3, 0)
                  temp920 = fun0*rmu(1, 0)
                  temp920b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp920b0 = temp922*temp919*temp920b
                  temp920b1 = temp920*temp921*temp920b
                  temp919b = temp922*temp920b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp921*rmu(1, 0)&
&                    *temp920b0
                  rmub(1, 0) = rmub(1, 0) + temp921*fun0*temp920b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp920*rmu(3, 0)*&
&                    temp920b0
                  rmub(3, 0) = rmub(3, 0) + temp920*rmucos(1, 0)*&
&                    temp920b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp919*rmucos(i, 0)*&
&                    temp920b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp919*rmusin(i, 0)*&
&                    temp920b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp919b
                  cellscaleb(i) = cellscaleb(i) - temp919*temp919b
                  hess4fb(2) = 0.0_8
                  temp919b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp919b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp919b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp918 = rmu(3, 0)*rmucos(3, 0)
                  temp917 = rmu(1, 0)*rmucos(1, 0)
                  temp917b = cost3f*2.d0*der4fb(2)
                  temp917b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp917b
                  rmub(1, 0) = rmub(1, 0) + temp918*rmucos(1, 0)*&
&                    temp917b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp918*rmu(1, 0)*&
&                    temp917b0
                  rmub(3, 0) = rmub(3, 0) + temp917*rmucos(3, 0)*&
&                    temp917b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp917*rmu(3, 0)*&
&                    temp917b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp917*temp918*2.d0*2&
&                    *rmucos(i, 0)*temp917b
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp925 = rmucos(2, 0)/cellscale(i)
                temp928 = rmusin(i, 0)*rmucos(i, 0)
                temp927 = rmucos(1, 0)*rmu(2, 0)
                temp926 = fun0*rmu(1, 0)
                temp926b = -(cost3f*8.d0*pi*hess4fb(2))
                temp926b0 = temp928*temp925*temp926b
                temp926b1 = temp926*temp927*temp926b
                temp925b = temp928*temp926b1/cellscale(i)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp927*rmu(1, 0)*&
&                  temp926b0
                rmub(1, 0) = rmub(1, 0) + temp927*fun0*temp926b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp926*rmu(2, 0)*&
&                  temp926b0
                rmub(2, 0) = rmub(2, 0) + temp926*rmucos(1, 0)*temp926b0
                rmusinb(i, 0) = rmusinb(i, 0) + temp925*rmucos(i, 0)*&
&                  temp926b1
                rmucosb(i, 0) = rmucosb(i, 0) + temp925*rmusin(i, 0)*&
&                  temp926b1
                rmucosb(2, 0) = rmucosb(2, 0) + temp925b
                cellscaleb(i) = cellscaleb(i) - temp925*temp925b
                hess4fb(2) = 0.0_8
                temp925b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp925b0 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp925b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp924 = rmu(2, 0)*rmucos(2, 0)
                temp923 = rmu(1, 0)*rmucos(1, 0)
                temp923b = cost3f*2.d0*der4fb(2)
                temp923b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp923b
                rmub(1, 0) = rmub(1, 0) + temp924*rmucos(1, 0)*temp923b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp924*rmu(1, 0)*&
&                  temp923b0
                rmub(2, 0) = rmub(2, 0) + temp923*rmucos(2, 0)*temp923b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp923*rmu(2, 0)*&
&                  temp923b0
                rmucosb(i, 0) = rmucosb(i, 0) + temp923*temp924*2.d0*2*&
&                  rmucos(i, 0)*temp923b
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                IF (branch .LT. 19) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp931b = cost4f*6.d0*hess4fb(2)
                  temp931b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp931b
                  temp930 = cellscale(1)**2
                  temp929 = rmucos(1, 0)/temp930
                  temp930b = -(cost4f*4.d0*pi**2*hess4fb(2))
                  temp930b0 = fun0*rmu(1, 0)*temp929*temp930b
                  temp930b1 = (rmu(1, 0)**2-3.d0*rmu(2, 0)**2)*temp930b
                  temp929b = fun0*rmu(1, 0)*temp930b1/temp930
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp929*rmu(1, 0)&
&                    *temp930b1 + rmucos(1, 0)*rmu(1, 0)*temp931b0
                  rmub(1, 0) = rmub(1, 0) + temp929*fun0*temp930b1 + 2*&
&                    rmu(1, 0)*temp930b0 + rmucos(1, 0)*fun0*temp931b0
                  hess4fb(2) = 0.0_8
                  temp929b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp929b0 + fun0*der4fb(2)
                  temp929b1 = cost4f*2.d0*der4fb(2)
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(&
&                    1, 0)*temp929b1 + cost4f*(rmu(1, 0)**2-3.d0*rmu(2, 0&
&                    )**2)*2.d0*2*rmucos(1, 0)*der4fb(2) + temp929b + &
&                    fun0*rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp931b + &
&                    fun0*rmu(1, 0)*temp931b0
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp930b0
                  cellscaleb(1) = cellscaleb(1) - temp929*2*cellscale(1)&
&                    *temp929b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp929b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp929b2 = cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*der4fb(&
&                    2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp929b2 + &
&                    rmucos(1, 0)**2*2*rmu(1, 0)*temp929b1
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp929b2
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp931b1 = -(cost4f*6.d0*hess4fb(2))
                  temp931b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp931b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp931b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp931b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp931b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp931b1
                  hess4fb(2) = 0.0_8
                  temp931b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp931b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp931b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp931b4 = -(cost4f*6.d0*der4fb(2))
                  temp931b5 = rmu(2, 0)*rmucos(2, 0)*temp931b4
                  temp931b6 = rmu(1, 0)*rmucos(1, 0)*temp931b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp931b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp931b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp931b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp931b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 23) THEN
              IF (branch .LT. 22) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp931b7 = cost4f*6.d0*hess4fb(2)
                temp931b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp931b7
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp931b8
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp931b8
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*temp931b8
                hess4fb(2) = 0.0_8
                temp931b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp931b9 + fun0*der4fb(2)
                temp931b10 = cost4f*6.d0*der4fb(2)
                temp931b11 = rmu(2, 0)*rmucos(2, 0)*temp931b10
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp931b11 + &
&                  fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                  temp931b7
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp931b9
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp931b12 = rmu(1, 0)*rmucos(1, 0)*temp931b10
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp931b11
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp931b12
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp931b12
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp933b = -(cost4f*6.d0*hess4fb(2))
                temp933b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp933b
                temp932 = cellscale(2)**2
                temp931 = rmucos(2, 0)/temp932
                temp932b = -(cost4f*4.d0*pi**2*hess4fb(2))
                temp932b0 = fun0*rmu(2, 0)*temp931*temp932b
                temp932b1 = (3.d0*rmu(1, 0)**2-rmu(2, 0)**2)*temp932b
                temp931b13 = fun0*rmu(2, 0)*temp932b1/temp932
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp931*rmu(2, 0)*&
&                  temp932b1 + rmucos(2, 0)*rmu(2, 0)*temp933b0
                rmub(2, 0) = rmub(2, 0) + temp931*fun0*temp932b1 - 2*rmu&
&                  (2, 0)*temp932b0 + rmucos(2, 0)*fun0*temp933b0
                hess4fb(2) = 0.0_8
                temp931b14 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp931b14 + fun0*der4fb(2)
                temp931b15 = -(cost4f*2.d0*der4fb(2))
                rmucosb(2, 0) = rmucosb(2, 0) + cost4f*(3.d0*rmu(1, 0)**&
&                  2-rmu(2, 0)**2)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2&
&                  , 0)**2*2*rmucos(2, 0)*temp931b15 + temp931b13 + fun0*&
&                  rmu(2, 0)*rmucos(2, 0)**2*2.d0*2*temp933b + fun0*rmu(2&
&                  , 0)*temp933b0
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp932b0
                cellscaleb(2) = cellscaleb(2) - temp931*2*cellscale(2)*&
&                  temp931b13
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp931b14
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp931b16 = cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*der4fb(2&
&                  )
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp931b16
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                  temp931b15 - 2*rmu(2, 0)*temp931b16
                der4fb(2) = 0.0_8
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4fb(2) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp894b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp894b
            funb = funb + rmu(i, 0)*temp894b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp893 = r(0)**2
        temp892 = fun2/temp893
        temp892b = rmu(i, 0)**2*radhess4fb(i)/temp893
        temp891 = r(0)**2
        temp890 = rmu(i, 0)**2/temp891
        temp890b1 = -(fun*radhess4fb(i)/temp891)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp890b1 + temp892*2*rmu(&
&          i, 0)*radhess4fb(i)
        fun2b = fun2b + temp892b
        rb(0) = rb(0) - temp890*2*r(0)*temp890b1 - temp892*2*r(0)*&
&          temp892b
        funb = funb + (1.d0-temp890)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp890b0 = distp(0, 1)*fun2b
      rb(0) = rb(0) + distp(0, 1)*5.5d0*funb/r(0)**2 - distp(0, 1)*fun0b&
&        - dd1**2*temp890b0 + 2*r(0)*rp0b
      distpb(0, 1) = distpb(0, 1) + (dd1-5.5d0/r(0))*funb + (4.5d0/dd1-r&
&        (0))*fun0b + (6.5d0*dd1-r(0)*dd1**2)*fun2b
      dd1b = dd1b + distp(0, 1)*funb - distp(0, 1)*4.5d0*fun0b/dd1**2 + &
&        (6.5d0-r(0)*2*dd1)*temp890b0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp890b = (4.5d0/dd1-r(k))*zb(indorbp, k)
          temp889 = distp(k, 1+ic)
          temp888 = distp(k, 1)*cosphase(k)
          temp888b3 = temp888*temp889*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + temp889*cosphase(k)*temp890b
          cosphaseb(k) = cosphaseb(k) + temp889*distp(k, 1)*temp890b
          distpb(k, 1+ic) = distpb(k, 1+ic) + temp888*temp890b
          dd1b = dd1b - 4.5d0*temp888b3/dd1**2
          rb(k) = rb(k) - temp888b3
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp888b = cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp888b0 = cost4f*rmu(2, i)*rmucos(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp888b - 2*rmu(2, i)*&
&        temp888b0
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp888b
      distpb(i, 8) = 0.0_8
      temp888b1 = cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*distpb(i, 7)
      temp888b2 = cost4f*rmu(1, i)*rmucos(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp888b1 + 2*rmu(1, i)*&
&        temp888b2 + 3.d0*2*rmu(1, i)*temp888b0
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp888b1
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp888b2
      distpb(i, 7) = 0.0_8
      temp887 = rmu(1, i)*rmucos(1, i)
      temp886 = rmu(3, i)*rmucos(3, i)
      temp886b5 = cost3f*2.d0*distpb(i, 6)
      temp886b6 = rmu(2, i)*rmucos(2, i)*temp886b5
      temp886b7 = temp886*temp887*temp886b5
      rmub(3, i) = rmub(3, i) + temp887*rmucos(3, i)*temp886b6
      rmucosb(3, i) = rmucosb(3, i) + temp887*rmu(3, i)*temp886b6
      rmub(1, i) = rmub(1, i) + temp886*rmucos(1, i)*temp886b6
      rmucosb(1, i) = rmucosb(1, i) + temp886*rmu(1, i)*temp886b6
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp886b7
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp886b7
      distpb(i, 6) = 0.0_8
      temp886b8 = cost3f*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      temp886b9 = cost3f*rmu(3, i)*rmucos(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp886b8
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp886b8
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp886b9
      distpb(i, 5) = 0.0_8
      temp886b10 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp886b10 - 2*rmu(2, i)*&
&        temp886b9
      temp886b11 = cost2f*rmu(2, i)*rmucos(2, i)*distpb(i, 4)
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp886b10
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp886b11
      distpb(i, 4) = 0.0_8
      temp886b12 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 3)
      temp886b13 = cost2f*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp886b14 = cost1f*rmu(3, i)*rmucos(3, i)*distpb(i, 2)
      rp0b = -temp886b13 - 3.d0*temp886b14 - temp886b11
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp886b12
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp886b12
      temp886b15 = cost1f*(5.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 2)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp886b15 + 5.d0*2*rmu(3, &
&        i)*temp886b14 + 5.d0*2*rmu(3, i)*temp886b13
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp886b15
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp886b4 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp886b4
      rb(k) = rb(k) - dd1*temp886b4
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.084104417400672d0*4.5d0*dd1**3.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (51)
! g single gaussian orbital
! radial R(r)= exp(-alpha r^2)
! normalized
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! Y_i are the stretched coordinates for the angular part A
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(Y_i(x_i)) \phi(x_i)
! R depends on X_i, A depends on Y_i, the phase \phi depends on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! where  d^2/dx^2_k F(X_i(x_i)) = (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dY^2_k A)  ((d/dx_k Y_i) (x_i))^2
!                      + R  (d/dY_k A)  (d^2/dx^2_k Y_i) (x_i)
!                      + 2 (d/dX_k R)  (d/dY_k A)   (d/dx_k X_i) (x_i)  (d/dx_k Y_i) (x_i)
! X_i = rmu
! Y_i = rmu * rmucos
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
! d/dx_k Y_i  =  2 * rmucos**2  - 1
! d^2/dx^2_k Y_i = - 4*Pi/L * rmusin * rmucos
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!          if(iflagnorm.gt.2) then
! overall normalization
!          c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)
    c = dd1**2.75d0*1.11284691281640568826d0
!          endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = (rmu(1, i)*rmucos(1, i))**2 + (rmu(2, i)*rmucos(2, i))**2 + &
&        (rmu(3, i)*rmucos(3, i))**2
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4*rmucos(3, i)**4-30.d0*rmu&
&        (3, i)**2*rmucos(3, i)**2*rp0+3.d0*rp0**2)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2*rmucos(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2*rmucos(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2*rmucos(1, i)**2-rmu(2, i)**2*&
&        rmucos(2, i)**2)*(7.d0*rmu(3, i)**2*rmucos(3, i)**2-rp0)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos(&
&        2, i)*(7.d0*rmu(3, i)**2*rmucos(3, i)**2-rp0)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(rmu(1, i)**2*rmucos(1, i)**2-3.0*rmu(2, i)**2*rmucos(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(3.d0*rmu(1, i)**2*rmucos(1, i)**2-rmu(2, i)**2*rmucos(2, i)**2&
&        )
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4*rmucos(1, i)**4-6.d0*rmu(1, i)&
&        **2*rmucos(1, i)**2*rmu(2, i)**2*rmucos(2, i)**2+rmu(2, i)**4*&
&        rmucos(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos&
&        (2, i)*(rmu(1, i)**2*rmucos(1, i)**2-rmu(2, i)**2*rmucos(2, i)**&
&        2)
    END DO
! lz=+/-4
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,9
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*distp(k, 1+ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = (rmu(1, 0)*rmucos(1, 0))**2 + (rmu(2, 0)*rmucos(2, 0))**2 + &
&        (rmu(3, 0)*rmucos(3, 0))**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,9
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part
! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            der4f(2) = 0.d0
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
            hess4f(2) = 0.d0
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
            hess4f(3) = 0.d0
! contribution of the angular part
            IF (ic .EQ. 1) THEN
! rp1 =   d/dx_k angular
! rp2 =   d^2/dx^2_k angular
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost1g*(-(60.d0*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)**&
&                  2*rmucos(3, 0)**2)+12.d0*rmu(1, 0)*rmucos(1, 0)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost1g*12.d0*(3.d0*(rmu(1, 0)*rmucos(1, 0))**2+(&
&                  rmu(2, 0)*rmucos(2, 0))**2-4.d0*rmu(3, 0)**2*rmucos(3&
&                  , 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
! der4f(2)  = der4f(2)  +  fun0 * d/dx_k angular
! hess4f(2) = hess4f(2) +  fun0 * d^2/dx^2_k angular
! hess4f(3) = hess4f(3) +  2 * fun * x_k * d/dx_k angular
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost1g*(-(60.d0*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)**&
&                  2*rmucos(3, 0)**2)+12.d0*rmu(2, 0)*rmucos(2, 0)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost1g*12.d0*((rmu(1, 0)*rmucos(1, 0))**2+3.d0*(&
&                  rmu(2, 0)*rmucos(2, 0))**2-4.d0*rmu(3, 0)**2*rmucos(3&
&                  , 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost1g*(80.d0*rmu(3, 0)**3*rmucos(3, 0)**3-48.d0*&
&                  rmu(3, 0)*rmucos(3, 0)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(cost1g*48.d0*((rmu(1, 0)*rmucos(1, 0))**2+(rmu(2&
&                  , 0)*rmucos(2, 0))**2-2.d0*rmu(3, 0)**2*rmucos(3, 0)**&
&                  2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(9.d0*(rmu(1, 0)*rmucos(1, 0))**2*rmu(3, &
&                  0)*rmucos(3, 0))-3.d0*(rmu(2, 0)*rmucos(2, 0))**2*rmu(&
&                  3, 0)*rmucos(3, 0)+4.d0*rmu(3, 0)**3*rmucos(3, 0)**3)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(18.d0*cost2g*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(6.d0*cost2g*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(3.d0*rmu(1, 0)*rmucos(1, 0)*((rmu(1, 0)*&
&                  rmucos(1, 0))**2+(rmu(2, 0)*rmucos(2, 0))**2-4.d0*rmu(&
&                  3, 0)**2*rmucos(3, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 24.d0*cost2g*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(6.d0*cost2g*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(3.d0*(rmu(1, 0)*rmucos(1, 0))**2*rmu(3, &
&                  0)*rmucos(3, 0))-9.d0*(rmu(2, 0)*rmucos(2, 0))**2*rmu(&
&                  3, 0)*rmucos(3, 0)+4.d0*rmu(3, 0)**3*rmucos(3, 0)**3)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(18.d0*cost2g*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(3.d0*rmu(2, 0)*rmucos(2, 0)*((rmu(1, 0)*&
&                  rmucos(1, 0))**2+(rmu(2, 0)*rmucos(2, 0))**2-4.d0*rmu(&
&                  3, 0)**2*rmucos(3, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 24.d0*cost2g*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*(-(4.d0*((rmu(1, 0)*rmucos(1, 0))**3-3.d0*&
&                  rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)**2*rmucos(3, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(12.d0*cost3g*((rmu(1, 0)*rmucos(1, 0))**2-rmu(3&
&                  , 0)**2*rmucos(3, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*(4.d0*((rmu(2, 0)*rmucos(2, 0))**3-3.d0*rmu&
&                  (2, 0)*rmucos(2, 0)*rmu(3, 0)**2*rmucos(3, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 12.d0*cost3g*((rmu(2, 0)*rmucos(2, 0))**2-rmu(3, 0&
&                  )**2*rmucos(3, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*(12.d0*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2&
&                  , 0)*rmucos(2, 0))**2)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 12.d0*cost3g*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, &
&                  0)*rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*(-(2.d0*rmu(2, 0)*rmucos(2, 0)*(3.d0*(rmu(1&
&                  , 0)*rmucos(1, 0))**2+(rmu(2, 0)*rmucos(2, 0))**2-6.d0&
&                  *rmu(3, 0)**2*rmucos(3, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(12.d0*cost3g*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*(-(2.d0*rmu(1, 0)*rmucos(1, 0)*((rmu(1, 0)*&
&                  rmucos(1, 0))**2+3.d0*(rmu(2, 0)*rmucos(2, 0))**2-6.d0&
&                  *rmu(3, 0)**2*rmucos(3, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(12.d0*cost3g*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*24.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost3g*24.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost4g*3.d0*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, 0&
&                  )*rmucos(2, 0))**2)*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost4g*6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = -(cost4g*6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(cost4g*6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost4g*((rmu(1, 0)*rmucos(1, 0))**3-3.d0*rmu(1, 0)&
&                  *rmucos(1, 0)*(rmu(2, 0)*rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              END IF
            ELSE IF (ic .EQ. 7) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost4g*6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost4g*6.d0*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost4g*3.d0*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, 0&
&                  )*rmucos(2, 0))**2)*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(cost4g*6.d0*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost4g*(3.d0*(rmu(1, 0)*rmucos(1, 0))**2*rmu(2, 0)&
&                  *rmucos(2, 0)-(rmu(2, 0)*rmucos(2, 0))**3)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              END IF
            ELSE IF (ic .EQ. 8) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost5g*4.d0*((rmu(1, 0)*rmucos(1, 0))**3-3.d0*rmu(&
&                  1, 0)*rmucos(1, 0)*(rmu(2, 0)*rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost5g*12.d0*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, &
&                  0)*rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost5g*4.d0*((rmu(2, 0)*rmucos(2, 0))**3-3.d0*(rmu&
&                  (1, 0)*rmucos(1, 0))**2*rmu(2, 0)*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost5g*12.d0*((rmu(2, 0)*rmucos(2, 0))**2-(rmu(1, &
&                  0)*rmucos(1, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = cost5g*4.d0*(3.d0*(rmu(1, 0)*rmucos(1, 0))**2*rmu(2&
&                , 0)*rmucos(2, 0)-(rmu(2, 0)*rmucos(2, 0))**3)
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = 24.d0*cost5g*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*rmucos&
&                (2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = cost5g*4.d0*((rmu(1, 0)*rmucos(1, 0))**3-3.d0*rmu(1&
&                , 0)*rmucos(1, 0)*(rmu(2, 0)*rmucos(2, 0))**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = -(24.d0*cost5g*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                rmucos(2, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)*(2.d0*&
&              rmucos(i, 0)**2-1.d0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dY^2_k A)  ((d/dx_k Y_i) (x_i))^2
!                      + R  (d/dY_k A)  (d^2/dx^2_k Y_i) (x_i)
!                      + 2 (d/dX_k R)  (d/dY_k A)   (d/dx_k X_i) (x_i)  (d/dx_k Y_i) (x_i)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2)*(2.d0*rmucos(i, 0)**&
&              2-1.d0)**2 - der4f(2)*4.d0*pi/cellscale(i)*rmusin(i, 0)*&
&              rmucos(i, 0) + hess4f(3)*rmucos(i, 0)*(2.d0*rmucos(i, 0)**&
&              2-1.d0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*distp(0, 1+ic)*&
&              cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*distp(0, 1+ic)*sinphase(i, 0)*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=9,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp984b = -(distp(0, 1)*rphase(i)*zb(indorbp, indt+i))
            temp984b0 = -(distp(0, 1+ic)*sinphase(i, 0)*zb(indorbp, indt&
&              +i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp984b1 = -(distp(0, 1+ic)*rphase(i)**2*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + distp(0&
&              , 1)*temp984b1 + z(indorbp, indt+i)*zb(indorbp, indt+i)
            distpb(0, 1+ic) = distpb(0, 1+ic) + sinphase(i, 0)*temp984b
            temp984b2 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp984b2 + &
&              distp(0, 1+ic)*temp984b
            distpb(0, 1) = distpb(0, 1) + cosphase(0)*temp984b1 + rphase&
&              (i)*temp984b0
            temp984b3 = -(distp(0, 1)*cosphase(0)*hess4fb(1))
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp984b2 + distp(0&
&              , 1+ic)*2*rphase(i)*temp984b3 + distp(0, 1)*temp984b0
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + rphase(i)**2*temp984b3
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp983 = der4f(1)/cellscale(i)
            temp983b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            temp982 = 2.d0*rmucos(i, 0)**2 - 1.d0
            temp982b = (2.d0*rmucos(i, 0)**2-1.d0)*hess4fb(1)
            temp981 = der4f(2)/cellscale(i)
            temp982b0 = -(pi*4.d0*hess4fb(1))
            temp982b1 = temp981*temp982b0
            temp981b42 = rmusin(i, 0)*rmucos(i, 0)*temp982b0/cellscale(i&
&              )
            rmucosb(i, 0) = rmucosb(i, 0) + (der4f(2)*2.d0*2*rmucos(i, 0&
&              )+der4f(1))*zb(indorbp, indt+i) + rmusin(i, 0)*temp982b1 +&
&              hess4f(3)*temp982b + (2*(hess4f(3)*rmucos(i, 0)**2*2.d0)+&
&              hess4f(2)*2**2*temp982*2.d0*rmucos(i, 0)+hess4f(1)*2*&
&              rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) + rmucos(i, 0)*temp982b1 - pi*&
&              temp983*hess4fb(1)
            der4fb(1) = der4fb(1) + temp983b
            cellscaleb(i) = cellscaleb(i) - temp981*temp981b42 - temp983&
&              *temp983b
            hess4fb(2) = hess4fb(2) + temp982**2*hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*temp982b
            der4fb(2) = der4fb(2) + temp981b42
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i)
            der4fb(2) = der4fb(2) + (2.d0*rmucos(i, 0)**2-1.d0)*zb(&
&              indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 14) THEN
              IF (branch .LT. 7) THEN
                IF (branch .LT. 4) THEN
                  IF (branch .LT. 2) THEN
                    IF (branch .LT. 1) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      temp959b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                      funb = funb + rp1*temp959b0
                      rp1b = fun0*der4fb(2) + fun*temp959b0
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                      rp2b = fun0*hess4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                      temp959b1 = cost1g*12.d0*rp2b
                      temp959b2 = 2*rmu(2, 0)*rmucos(2, 0)*temp959b1
                      rmub(1, 0) = rmub(1, 0) + 3.d0*rmucos(1, 0)**2*2*&
&                        rmu(1, 0)*temp959b1
                      rmucosb(1, 0) = rmucosb(1, 0) + 3.d0*rmu(1, 0)**2*&
&                        2*rmucos(1, 0)*temp959b1
                      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp959b2
                      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                        temp959b2
                      rmub(3, 0) = rmub(3, 0) - 4.d0*rmucos(3, 0)**2*2*&
&                        rmu(3, 0)*temp959b1
                      rmucosb(3, 0) = rmucosb(3, 0) - 4.d0*rmu(3, 0)**2*&
&                        2*rmucos(3, 0)*temp959b1
                      CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                      temp959b3 = cost1g*rp1b
                      temp959b4 = 12.d0*rmucos(1, 0)*temp959b3
                      temp959b5 = -(60.d0*rmu(3, 0)**2*rmucos(3, 0)**2*&
&                        temp959b3)
                      temp959b6 = -(60.d0*rmu(1, 0)*rmucos(1, 0)*&
&                        temp959b3)
                      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp959b5 +&
&                        rp0*temp959b4
                      rp0b = rp0b + rmu(1, 0)*temp959b4
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp959b5 + 12.d0*rmu(1, 0)*rp0*temp959b3
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)**2*2*rmu(3&
&                        , 0)*temp959b6
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*&
&                        rmucos(3, 0)*temp959b6
                    ELSE
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      temp959b7 = 2.d0*rmu(i, 0)*hess4fb(3)
                      funb = funb + rp1*temp959b7
                      rp1b = fun0*der4fb(2) + fun*temp959b7
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                      rp2b = fun0*hess4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                      temp959b8 = cost1g*12.d0*rp2b
                      temp959b9 = 2*rmu(1, 0)*rmucos(1, 0)*temp959b8
                      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp959b9
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp959b9
                      rmub(2, 0) = rmub(2, 0) + 3.d0*rmucos(2, 0)**2*2*&
&                        rmu(2, 0)*temp959b8
                      rmucosb(2, 0) = rmucosb(2, 0) + 3.d0*rmu(2, 0)**2*&
&                        2*rmucos(2, 0)*temp959b8
                      rmub(3, 0) = rmub(3, 0) - 4.d0*rmucos(3, 0)**2*2*&
&                        rmu(3, 0)*temp959b8
                      rmucosb(3, 0) = rmucosb(3, 0) - 4.d0*rmu(3, 0)**2*&
&                        2*rmucos(3, 0)*temp959b8
                      CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                      temp959b10 = cost1g*rp1b
                      temp959b11 = 12.d0*rmucos(2, 0)*temp959b10
                      temp959b12 = -(60.d0*rmu(3, 0)**2*rmucos(3, 0)**2*&
&                        temp959b10)
                      temp959b13 = -(60.d0*rmu(2, 0)*rmucos(2, 0)*&
&                        temp959b10)
                      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp959b12 &
&                        + rp0*temp959b11
                      rp0b = rp0b + rmu(2, 0)*temp959b11
                      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                        temp959b12 + 12.d0*rmu(2, 0)*rp0*temp959b10
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)**2*2*rmu(3&
&                        , 0)*temp959b13
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*&
&                        rmucos(3, 0)*temp959b13
                    END IF
                  ELSE IF (branch .LT. 3) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp959b14 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp959b14
                    rp1b = fun0*der4fb(2) + fun*temp959b14
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp959b15 = -(cost1g*48.d0*rp2b)
                    temp959b16 = 2*rmu(1, 0)*rmucos(1, 0)*temp959b15
                    temp959b17 = 2*rmu(2, 0)*rmucos(2, 0)*temp959b15
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp959b16
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp959b16
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp959b17
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp959b17
                    temp959b18 = cost1g*rp1b
                    temp959b19 = -(48.d0*rmucos(3, 0)*temp959b18)
                    rmub(3, 0) = rmub(3, 0) + 80.d0*rmucos(3, 0)**3*3*&
&                      rmu(3, 0)**2*temp959b18 + rp0*temp959b19 - 2.d0*&
&                      rmucos(3, 0)**2*2*rmu(3, 0)*temp959b15
                    rmucosb(3, 0) = rmucosb(3, 0) + (80.d0*rmu(3, 0)**3*&
&                      3*rmucos(3, 0)**2-48.d0*rmu(3, 0)*rp0)*temp959b18 &
&                      - 2.d0*rmu(3, 0)**2*2*rmucos(3, 0)*temp959b15
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    rp0b = rp0b + rmu(3, 0)*temp959b19
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp959b20 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp959b20
                    rp1b = fun0*der4fb(2) + fun*temp959b20
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp959b21 = -(cost2g*18.d0*rp2b)
                    temp959b22 = rmu(3, 0)*rmucos(3, 0)*temp959b21
                    temp959b23 = rmu(1, 0)*rmucos(1, 0)*temp959b21
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp959b22
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp959b22
                    temp959b24 = cost2g*rp1b
                    temp959b25 = -(3.d0*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                      temp959b24)
                    temp959b26 = -(9.d0*rmu(1, 0)**2*rmucos(1, 0)**2*&
&                      temp959b24)
                    rmub(3, 0) = rmub(3, 0) + 4.d0*rmucos(3, 0)**3*3*rmu&
&                      (3, 0)**2*temp959b24 + rmucos(3, 0)*temp959b25 + &
&                      rmucos(3, 0)*temp959b26 + rmucos(3, 0)*temp959b23
                    rmucosb(3, 0) = rmucosb(3, 0) + 4.d0*rmu(3, 0)**3*3*&
&                      rmucos(3, 0)**2*temp959b24 + rmu(3, 0)*temp959b25 &
&                      + rmu(3, 0)*temp959b26 + rmu(3, 0)*temp959b23
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp959b27 = -(3.d0*rmu(3, 0)*rmucos(3, 0)*&
&                      temp959b24)
                    temp959b28 = -(9.d0*rmu(3, 0)*rmucos(3, 0)*&
&                      temp959b24)
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0&
&                      )*temp959b27
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)**2*2*&
&                      rmucos(2, 0)*temp959b27
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0&
&                      )*temp959b28
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*&
&                      rmucos(1, 0)*temp959b28
                  END IF
                ELSE IF (branch .LT. 6) THEN
                  IF (branch .LT. 5) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp961b = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp961b
                    rp1b = fun0*der4fb(2) + fun*temp961b
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp961b0 = -(cost2g*6.d0*rp2b)
                    temp961b1 = rmu(3, 0)*rmucos(3, 0)*temp961b0
                    temp961b2 = rmu(1, 0)*rmucos(1, 0)*temp961b0
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp961b1
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp961b1
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp961b2
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp961b2
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp960 = rmu(2, 0)*rmucos(2, 0)
                    temp959 = rmu(1, 0)*rmucos(1, 0)
                    temp959b29 = -(cost2g*6.d0*rp1b)
                    temp959b30 = rmu(3, 0)*rmucos(3, 0)*temp959b29
                    temp959b31 = temp959*temp960*temp959b29
                    rmub(1, 0) = rmub(1, 0) + temp960*rmucos(1, 0)*&
&                      temp959b30
                    rmucosb(1, 0) = rmucosb(1, 0) + temp960*rmu(1, 0)*&
&                      temp959b30
                    rmub(2, 0) = rmub(2, 0) + temp959*rmucos(2, 0)*&
&                      temp959b30
                    rmucosb(2, 0) = rmucosb(2, 0) + temp959*rmu(2, 0)*&
&                      temp959b30
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp959b31
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp959b31
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp963b = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp963b
                    rp1b = fun0*der4fb(2) + fun*temp963b
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp963b0 = cost2g*24.d0*rp2b
                    temp963b1 = rmu(3, 0)*rmucos(3, 0)*temp963b0
                    temp963b2 = rmu(1, 0)*rmucos(1, 0)*temp963b0
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp963b1
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp963b1
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp963b2
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp963b2
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp961 = rmu(2, 0)*rmucos(2, 0)
                    temp962 = rmu(1, 0)*rmucos(1, 0)
                    temp963b3 = -(cost2g*3.d0*rp1b)
                    temp963b4 = (temp962**2+temp961**2-4.d0*(rmu(3, 0)**&
&                      2*rmucos(3, 0)**2))*temp963b3
                    temp963b5 = rmu(1, 0)*rmucos(1, 0)*temp963b3
                    temp962b = 2*temp962*temp963b5
                    temp961b3 = 2*temp961*temp963b5
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp962b + &
&                      rmucos(1, 0)*temp963b4
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp962b +&
&                      rmu(1, 0)*temp963b4
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp961b3
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp961b3
                    rmub(3, 0) = rmub(3, 0) - 4.d0*rmucos(3, 0)**2*2*rmu&
&                      (3, 0)*temp963b5
                    rmucosb(3, 0) = rmucosb(3, 0) - 4.d0*rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp963b5
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp965b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp965b
                  rp1b = fun0*der4fb(2) + fun*temp965b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp965b0 = -(cost2g*6.d0*rp2b)
                  temp965b1 = rmu(3, 0)*rmucos(3, 0)*temp965b0
                  temp965b2 = rmu(2, 0)*rmucos(2, 0)*temp965b0
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp965b1
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp965b1
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp965b2
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp965b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp964 = rmu(2, 0)*rmucos(2, 0)
                  temp963 = rmu(1, 0)*rmucos(1, 0)
                  temp963b6 = -(cost2g*6.d0*rp1b)
                  temp963b7 = rmu(3, 0)*rmucos(3, 0)*temp963b6
                  temp963b8 = temp963*temp964*temp963b6
                  rmub(1, 0) = rmub(1, 0) + temp964*rmucos(1, 0)*&
&                    temp963b7
                  rmucosb(1, 0) = rmucosb(1, 0) + temp964*rmu(1, 0)*&
&                    temp963b7
                  rmub(2, 0) = rmub(2, 0) + temp963*rmucos(2, 0)*&
&                    temp963b7
                  rmucosb(2, 0) = rmucosb(2, 0) + temp963*rmu(2, 0)*&
&                    temp963b7
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp963b8
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp963b8
                END IF
              ELSE IF (branch .LT. 11) THEN
                IF (branch .LT. 9) THEN
                  IF (branch .LT. 8) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp965b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp965b3
                    rp1b = fun0*der4fb(2) + fun*temp965b3
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp965b4 = -(cost2g*18.d0*rp2b)
                    temp965b5 = rmu(3, 0)*rmucos(3, 0)*temp965b4
                    temp965b6 = rmu(2, 0)*rmucos(2, 0)*temp965b4
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp965b5
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp965b5
                    temp965b7 = cost2g*rp1b
                    temp965b8 = -(9.d0*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                      temp965b7)
                    temp965b9 = -(3.d0*rmu(1, 0)**2*rmucos(1, 0)**2*&
&                      temp965b7)
                    rmub(3, 0) = rmub(3, 0) + 4.d0*rmucos(3, 0)**3*3*rmu&
&                      (3, 0)**2*temp965b7 + rmucos(3, 0)*temp965b8 + &
&                      rmucos(3, 0)*temp965b9 + rmucos(3, 0)*temp965b6
                    rmucosb(3, 0) = rmucosb(3, 0) + 4.d0*rmu(3, 0)**3*3*&
&                      rmucos(3, 0)**2*temp965b7 + rmu(3, 0)*temp965b8 + &
&                      rmu(3, 0)*temp965b9 + rmu(3, 0)*temp965b6
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp965b10 = -(9.d0*rmu(3, 0)*rmucos(3, 0)*temp965b7&
&                      )
                    temp965b11 = -(3.d0*rmu(3, 0)*rmucos(3, 0)*temp965b7&
&                      )
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0&
&                      )*temp965b10
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)**2*2*&
&                      rmucos(2, 0)*temp965b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0&
&                      )*temp965b11
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*&
&                      rmucos(1, 0)*temp965b11
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp967b = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp967b
                    rp1b = fun0*der4fb(2) + fun*temp967b
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp967b0 = cost2g*24.d0*rp2b
                    temp967b1 = rmu(3, 0)*rmucos(3, 0)*temp967b0
                    temp967b2 = rmu(2, 0)*rmucos(2, 0)*temp967b0
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp967b1
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp967b1
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp967b2
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp967b2
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp965 = rmu(2, 0)*rmucos(2, 0)
                    temp966 = rmu(1, 0)*rmucos(1, 0)
                    temp967b3 = -(cost2g*3.d0*rp1b)
                    temp967b4 = (temp966**2+temp965**2-4.d0*(rmu(3, 0)**&
&                      2*rmucos(3, 0)**2))*temp967b3
                    temp967b5 = rmu(2, 0)*rmucos(2, 0)*temp967b3
                    temp966b = 2*temp966*temp967b5
                    temp965b12 = 2*temp965*temp967b5
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp965b12 + &
&                      rmucos(2, 0)*temp967b4
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp965b12&
&                      + rmu(2, 0)*temp967b4
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp966b
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp966b
                    rmub(3, 0) = rmub(3, 0) - 4.d0*rmucos(3, 0)**2*2*rmu&
&                      (3, 0)*temp967b5
                    rmucosb(3, 0) = rmucosb(3, 0) - 4.d0*rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp967b5
                  END IF
                ELSE IF (branch .LT. 10) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp967b6 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp967b6
                  rp1b = fun0*der4fb(2) + fun*temp967b6
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp967b7 = -(cost3g*12.d0*rp2b)
                  temp967b8 = 2*rmu(1, 0)*rmucos(1, 0)*temp967b7
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp967b8
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp967b8
                  rmub(3, 0) = rmub(3, 0) - rmucos(3, 0)**2*2*rmu(3, 0)*&
&                    temp967b7
                  rmucosb(3, 0) = rmucosb(3, 0) - rmu(3, 0)**2*2*rmucos(&
&                    3, 0)*temp967b7
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp967b9 = -(cost3g*4.d0*rp1b)
                  temp967b10 = 3*rmu(1, 0)**2*rmucos(1, 0)**2*temp967b9
                  temp967b11 = -(3.d0*rmu(3, 0)**2*rmucos(3, 0)**2*&
&                    temp967b9)
                  temp967b12 = -(3.d0*rmu(1, 0)*rmucos(1, 0)*temp967b9)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp967b11 + &
&                    rmucos(1, 0)*temp967b10
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp967b11 +&
&                    rmu(1, 0)*temp967b10
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)**2*2*rmu(3, 0)*&
&                    temp967b12
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*rmucos(&
&                    3, 0)*temp967b12
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp967b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp967b13
                  rp1b = fun0*der4fb(2) + fun*temp967b13
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp967b14 = cost3g*12.d0*rp2b
                  temp967b15 = 2*rmu(2, 0)*rmucos(2, 0)*temp967b14
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp967b15
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp967b15
                  rmub(3, 0) = rmub(3, 0) - rmucos(3, 0)**2*2*rmu(3, 0)*&
&                    temp967b14
                  rmucosb(3, 0) = rmucosb(3, 0) - rmu(3, 0)**2*2*rmucos(&
&                    3, 0)*temp967b14
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp967b16 = cost3g*4.d0*rp1b
                  temp967b17 = 3*rmu(2, 0)**2*rmucos(2, 0)**2*temp967b16
                  temp967b18 = -(3.d0*rmu(3, 0)**2*rmucos(3, 0)**2*&
&                    temp967b16)
                  temp967b19 = -(3.d0*rmu(2, 0)*rmucos(2, 0)*temp967b16)
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp967b18 + &
&                    rmucos(2, 0)*temp967b17
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp967b18 +&
&                    rmu(2, 0)*temp967b17
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)**2*2*rmu(3, 0)*&
&                    temp967b19
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*rmucos(&
&                    3, 0)*temp967b19
                END IF
              ELSE IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp969b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp969b
                  rp1b = fun0*der4fb(2) + fun*temp969b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp969b0 = cost3g*12.d0*rp2b
                  temp969b1 = 2*rmu(1, 0)*rmucos(1, 0)*temp969b0
                  temp969b2 = -(2*rmu(2, 0)*rmucos(2, 0)*temp969b0)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp969b1
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp969b1
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp969b2
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp969b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp967 = rmu(2, 0)*rmucos(2, 0)
                  temp968 = rmu(1, 0)*rmucos(1, 0)
                  temp969b3 = cost3g*12.d0*rp1b
                  temp969b4 = rmu(3, 0)*rmucos(3, 0)*temp969b3
                  temp968b = 2*temp968*temp969b4
                  temp967b20 = -(2*temp967*temp969b4)
                  temp967b21 = (temp968**2-temp967**2)*temp969b3
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp968b
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp968b
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp967b20
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp967b20
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp967b21
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp967b21
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp970b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp970b
                  rp1b = fun0*der4fb(2) + fun*temp970b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp970b0 = -(cost3g*12.d0*rp2b)
                  temp970b1 = rmu(2, 0)*rmucos(2, 0)*temp970b0
                  temp970b2 = rmu(1, 0)*rmucos(1, 0)*temp970b0
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp970b1
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp970b1
                  temp969 = rmu(2, 0)*rmucos(2, 0)
                  temp970b3 = -(cost3g*2.d0*rp1b)
                  temp970b4 = (3.d0*(rmu(1, 0)**2*rmucos(1, 0)**2)+&
&                    temp969**2-6.d0*(rmu(3, 0)**2*rmucos(3, 0)**2))*&
&                    temp970b3
                  temp970b5 = rmu(2, 0)*rmucos(2, 0)*temp970b3
                  temp969b5 = 2*temp969*temp970b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp970b4 + &
&                    rmucos(2, 0)*temp969b5 + rmucos(2, 0)*temp970b2
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp970b4 + &
&                    rmu(2, 0)*temp969b5 + rmu(2, 0)*temp970b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  rmub(1, 0) = rmub(1, 0) + 3.d0*rmucos(1, 0)**2*2*rmu(1&
&                    , 0)*temp970b5
                  rmucosb(1, 0) = rmucosb(1, 0) + 3.d0*rmu(1, 0)**2*2*&
&                    rmucos(1, 0)*temp970b5
                  rmub(3, 0) = rmub(3, 0) - 6.d0*rmucos(3, 0)**2*2*rmu(3&
&                    , 0)*temp970b5
                  rmucosb(3, 0) = rmucosb(3, 0) - 6.d0*rmu(3, 0)**2*2*&
&                    rmucos(3, 0)*temp970b5
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp971b = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp971b
                rp1b = fun0*der4fb(2) + fun*temp971b
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp971b0 = -(cost3g*12.d0*rp2b)
                temp971b1 = rmu(2, 0)*rmucos(2, 0)*temp971b0
                temp971b2 = rmu(1, 0)*rmucos(1, 0)*temp971b0
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp971b1
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp971b1
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp971b2
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp971b2
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp970 = rmu(1, 0)*rmucos(1, 0)
                temp971b3 = -(cost3g*2.d0*rp1b)
                temp971b4 = (temp970**2+3.d0*(rmu(2, 0)**2*rmucos(2, 0)&
&                  **2)-6.d0*(rmu(3, 0)**2*rmucos(3, 0)**2))*temp971b3
                temp971b5 = rmu(1, 0)*rmucos(1, 0)*temp971b3
                temp970b6 = 2*temp970*temp971b5
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp970b6 + &
&                  rmucos(1, 0)*temp971b4
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp970b6 + &
&                  rmu(1, 0)*temp971b4
                rmub(2, 0) = rmub(2, 0) + 3.d0*rmucos(2, 0)**2*2*rmu(2, &
&                  0)*temp971b5
                rmucosb(2, 0) = rmucosb(2, 0) + 3.d0*rmu(2, 0)**2*2*&
&                  rmucos(2, 0)*temp971b5
                rmub(3, 0) = rmub(3, 0) - 6.d0*rmucos(3, 0)**2*2*rmu(3, &
&                  0)*temp971b5
                rmucosb(3, 0) = rmucosb(3, 0) - 6.d0*rmu(3, 0)**2*2*&
&                  rmucos(3, 0)*temp971b5
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 18) THEN
                IF (branch .LT. 16) THEN
                  IF (branch .LT. 15) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp973b = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp973b
                    rp1b = fun0*der4fb(2) + fun*temp973b
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp973b0 = cost3g*24.d0*rp2b
                    temp973b1 = rmu(2, 0)*rmucos(2, 0)*temp973b0
                    temp973b2 = rmu(1, 0)*rmucos(1, 0)*temp973b0
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp973b1
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp973b1
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp973b2
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp973b2
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp972 = rmu(2, 0)*rmucos(2, 0)
                    temp971 = rmu(1, 0)*rmucos(1, 0)
                    temp971b6 = cost3g*24.d0*rp1b
                    temp971b7 = rmu(3, 0)*rmucos(3, 0)*temp971b6
                    temp971b8 = temp971*temp972*temp971b6
                    rmub(1, 0) = rmub(1, 0) + temp972*rmucos(1, 0)*&
&                      temp971b7
                    rmucosb(1, 0) = rmucosb(1, 0) + temp972*rmu(1, 0)*&
&                      temp971b7
                    rmub(2, 0) = rmub(2, 0) + temp971*rmucos(2, 0)*&
&                      temp971b7
                    rmucosb(2, 0) = rmucosb(2, 0) + temp971*rmu(2, 0)*&
&                      temp971b7
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp971b8
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp971b8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp975b = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp975b
                    rp1b = fun0*der4fb(2) + fun*temp975b
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp975b0 = cost4g*6.d0*rp2b
                    temp975b1 = rmu(3, 0)*rmucos(3, 0)*temp975b0
                    temp975b2 = rmu(1, 0)*rmucos(1, 0)*temp975b0
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp975b1
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp975b1
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp975b2
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp975b2
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp973 = rmu(2, 0)*rmucos(2, 0)
                    temp974 = rmu(1, 0)*rmucos(1, 0)
                    temp975b3 = cost4g*3.d0*rp1b
                    temp975b4 = rmu(3, 0)*rmucos(3, 0)*temp975b3
                    temp974b = 2*temp974*temp975b4
                    temp973b3 = -(2*temp973*temp975b4)
                    temp973b4 = (temp974**2-temp973**2)*temp975b3
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp974b
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp974b
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp973b3
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp973b3
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp973b4
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp973b4
                  END IF
                ELSE IF (branch .LT. 17) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp977b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp977b
                  rp1b = fun0*der4fb(2) + fun*temp977b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp977b0 = -(cost4g*6.d0*rp2b)
                  temp977b1 = rmu(3, 0)*rmucos(3, 0)*temp977b0
                  temp977b2 = rmu(1, 0)*rmucos(1, 0)*temp977b0
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp977b1
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp977b1
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp977b2
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp977b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp976 = rmu(2, 0)*rmucos(2, 0)
                  temp975 = rmu(1, 0)*rmucos(1, 0)
                  temp975b5 = -(cost4g*6.d0*rp1b)
                  temp975b6 = rmu(3, 0)*rmucos(3, 0)*temp975b5
                  temp975b7 = temp975*temp976*temp975b5
                  rmub(1, 0) = rmub(1, 0) + temp976*rmucos(1, 0)*&
&                    temp975b6
                  rmucosb(1, 0) = rmucosb(1, 0) + temp976*rmu(1, 0)*&
&                    temp975b6
                  rmub(2, 0) = rmub(2, 0) + temp975*rmucos(2, 0)*&
&                    temp975b6
                  rmucosb(2, 0) = rmucosb(2, 0) + temp975*rmu(2, 0)*&
&                    temp975b6
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp975b7
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp975b7
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp977b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp977b3
                  rp1b = fun0*der4fb(2) + fun*temp977b3
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp977b4 = cost4g*rp1b
                  temp977b5 = 3*rmu(1, 0)**2*rmucos(1, 0)**2*temp977b4
                  temp977b6 = -(3.d0*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                    temp977b4)
                  temp977b7 = -(3.d0*rmu(1, 0)*rmucos(1, 0)*temp977b4)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp977b6 + &
&                    rmucos(1, 0)*temp977b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp977b6 + &
&                    rmu(1, 0)*temp977b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                    temp977b7
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)**2*2*rmucos(&
&                    2, 0)*temp977b7
                END IF
              ELSE IF (branch .LT. 20) THEN
                IF (branch .LT. 19) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp979b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp979b
                  rp1b = fun0*der4fb(2) + fun*temp979b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp979b0 = cost4g*6.d0*rp2b
                  temp979b1 = rmu(3, 0)*rmucos(3, 0)*temp979b0
                  temp979b2 = rmu(2, 0)*rmucos(2, 0)*temp979b0
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp979b1
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp979b1
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp979b2
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp979b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp978 = rmu(2, 0)*rmucos(2, 0)
                  temp977 = rmu(1, 0)*rmucos(1, 0)
                  temp977b8 = cost4g*6.d0*rp1b
                  temp977b9 = rmu(3, 0)*rmucos(3, 0)*temp977b8
                  temp977b10 = temp977*temp978*temp977b8
                  rmub(1, 0) = rmub(1, 0) + temp978*rmucos(1, 0)*&
&                    temp977b9
                  rmucosb(1, 0) = rmucosb(1, 0) + temp978*rmu(1, 0)*&
&                    temp977b9
                  rmub(2, 0) = rmub(2, 0) + temp977*rmucos(2, 0)*&
&                    temp977b9
                  rmucosb(2, 0) = rmucosb(2, 0) + temp977*rmu(2, 0)*&
&                    temp977b9
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp977b10
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp977b10
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp981b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp981b
                  rp1b = fun0*der4fb(2) + fun*temp981b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp981b0 = -(cost4g*6.d0*rp2b)
                  temp981b1 = rmu(3, 0)*rmucos(3, 0)*temp981b0
                  temp981b2 = rmu(2, 0)*rmucos(2, 0)*temp981b0
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp981b1
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp981b1
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp981b2
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp981b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp979 = rmu(2, 0)*rmucos(2, 0)
                  temp980 = rmu(1, 0)*rmucos(1, 0)
                  temp981b3 = cost4g*3.d0*rp1b
                  temp981b4 = rmu(3, 0)*rmucos(3, 0)*temp981b3
                  temp980b = 2*temp980*temp981b4
                  temp979b3 = -(2*temp979*temp981b4)
                  temp979b4 = (temp980**2-temp979**2)*temp981b3
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp980b
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp980b
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp979b3
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp979b3
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp979b4
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp979b4
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp981b5 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp981b5
                rp1b = fun0*der4fb(2) + fun*temp981b5
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp981b6 = cost4g*rp1b
                temp981b7 = 3.d0*rmu(2, 0)*rmucos(2, 0)*temp981b6
                temp981b8 = 3.d0*rmu(1, 0)**2*rmucos(1, 0)**2*temp981b6
                temp981b9 = -(3*rmu(2, 0)**2*rmucos(2, 0)**2*temp981b6)
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0)*&
&                  temp981b7
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(1&
&                  , 0)*temp981b7
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp981b9 + &
&                  rmucos(2, 0)*temp981b8
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp981b9 + &
&                  rmu(2, 0)*temp981b8
              END IF
            ELSE IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                IF (branch .LT. 22) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp981b10 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp981b10
                  rp1b = fun0*der4fb(2) + fun*temp981b10
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp981b11 = cost5g*12.d0*rp2b
                  temp981b12 = 2*rmu(1, 0)*rmucos(1, 0)*temp981b11
                  temp981b13 = -(2*rmu(2, 0)*rmucos(2, 0)*temp981b11)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp981b12
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp981b12
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp981b13
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp981b13
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp981b14 = cost5g*4.d0*rp1b
                  temp981b15 = 3*rmu(1, 0)**2*rmucos(1, 0)**2*temp981b14
                  temp981b16 = -(3.d0*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                    temp981b14)
                  temp981b17 = -(3.d0*rmu(1, 0)*rmucos(1, 0)*temp981b14)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp981b16 + &
&                    rmucos(1, 0)*temp981b15
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp981b16 +&
&                    rmu(1, 0)*temp981b15
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                    temp981b17
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)**2*2*rmucos(&
&                    2, 0)*temp981b17
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp981b18 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp981b18
                rp1b = fun0*der4fb(2) + fun*temp981b18
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp981b19 = cost5g*12.d0*rp2b
                temp981b20 = 2*rmu(2, 0)*rmucos(2, 0)*temp981b19
                temp981b21 = -(2*rmu(1, 0)*rmucos(1, 0)*temp981b19)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp981b20
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp981b20
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp981b21
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp981b21
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp981b22 = cost5g*4.d0*rp1b
                temp981b23 = 3*rmu(2, 0)**2*rmucos(2, 0)**2*temp981b22
                temp981b24 = -(3.d0*rmu(2, 0)*rmucos(2, 0)*temp981b22)
                temp981b25 = -(3.d0*rmu(1, 0)**2*rmucos(1, 0)**2*&
&                  temp981b22)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp981b25 + &
&                  rmucos(2, 0)*temp981b23
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp981b25 + &
&                  rmu(2, 0)*temp981b23
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0)*&
&                  temp981b24
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(1&
&                  , 0)*temp981b24
              END IF
            ELSE IF (branch .LT. 26) THEN
              IF (branch .LT. 25) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp981b26 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp981b26
                rp1b = fun0*der4fb(2) + fun*temp981b26
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp981b27 = cost5g*24.d0*rp2b
                temp981b28 = rmu(2, 0)*rmucos(2, 0)*temp981b27
                temp981b29 = rmu(1, 0)*rmucos(1, 0)*temp981b27
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp981b28
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp981b28
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp981b29
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp981b29
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp981b30 = cost5g*4.d0*rp1b
                temp981b31 = 3.d0*rmu(2, 0)*rmucos(2, 0)*temp981b30
                temp981b32 = 3.d0*rmu(1, 0)**2*rmucos(1, 0)**2*&
&                  temp981b30
                temp981b33 = -(3*rmu(2, 0)**2*rmucos(2, 0)**2*temp981b30&
&                  )
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0)*&
&                  temp981b31
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(1&
&                  , 0)*temp981b31
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp981b33 + &
&                  rmucos(2, 0)*temp981b32
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp981b33 + &
&                  rmu(2, 0)*temp981b32
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              temp981b34 = 2.d0*rmu(i, 0)*hess4fb(3)
              funb = funb + rp1*temp981b34
              rp1b = fun0*der4fb(2) + fun*temp981b34
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
              rp2b = fun0*hess4fb(2)
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              CALL POPREAL8(adr8ibuf,adr8buf,rp2)
              temp981b35 = -(cost5g*24.d0*rp2b)
              temp981b36 = rmu(2, 0)*rmucos(2, 0)*temp981b35
              temp981b37 = rmu(1, 0)*rmucos(1, 0)*temp981b35
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp981b36
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp981b36
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp981b37
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp981b37
              CALL POPREAL8(adr8ibuf,adr8buf,rp1)
              temp981b38 = cost5g*4.d0*rp1b
              temp981b39 = 3*rmu(1, 0)**2*rmucos(1, 0)**2*temp981b38
              temp981b40 = -(3.d0*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                temp981b38)
              temp981b41 = -(3.d0*rmu(1, 0)*rmucos(1, 0)*temp981b38)
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp981b40 + rmucos&
&                (1, 0)*temp981b39
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp981b40 + rmu&
&                (1, 0)*temp981b39
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                temp981b41
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)**2*2*rmucos(2, 0&
&                )*temp981b41
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
            hess4fb(3) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
            hess4fb(2) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
            der4fb(2) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp959b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp959b
            funb = funb + rmu(i, 0)*temp959b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp958 = r(0)**2
        temp957 = fun2/temp958
        temp957b = rmu(i, 0)**2*radhess4fb(i)/temp958
        temp956 = r(0)**2
        temp955 = rmu(i, 0)**2/temp956
        temp955b4 = -(fun*radhess4fb(i)/temp956)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp955b4 + temp957*2*rmu(&
&          i, 0)*radhess4fb(i)
        fun2b = fun2b + temp957b
        rb(0) = rb(0) - temp955*2*r(0)*temp955b4 - temp957*2*r(0)*&
&          temp957b
        funb = funb + (1.d0-temp955)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp955b0 = 2*rmu(1, 0)*rmucos(1, 0)*rp0b
      temp955b1 = 2*rmu(2, 0)*rmucos(2, 0)*rp0b
      temp955b2 = 2*rmu(3, 0)*rmucos(3, 0)*rp0b
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp955b0
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp955b0
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp955b1
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp955b1
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp955b2
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp955b2
      temp955b3 = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp955b3 - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp955b3
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=9,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp955b = distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + cosphase(k)*temp955b
          cosphaseb(k) = cosphaseb(k) + distp(k, 1)*temp955b
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*cosphase(k)*zb&
&            (indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp954 = rmu(2, i)*rmucos(2, i)
      temp953 = rmu(1, i)*rmucos(1, i)
      temp953b = cost5g*4.d0*distpb(i, 10)
      temp953b0 = (rmu(1, i)**2*rmucos(1, i)**2-rmu(2, i)**2*rmucos(2, i&
&        )**2)*temp953b
      temp953b1 = temp953*temp954*temp953b
      rmub(1, i) = rmub(1, i) + rmucos(1, i)**2*2*rmu(1, i)*temp953b1 + &
&        temp954*rmucos(1, i)*temp953b0
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)**2*2*rmucos(1, i)*&
&        temp953b1 + temp954*rmu(1, i)*temp953b0
      rmub(2, i) = rmub(2, i) + temp953*rmucos(2, i)*temp953b0 - rmucos(&
&        2, i)**2*2*rmu(2, i)*temp953b1
      rmucosb(2, i) = rmucosb(2, i) + temp953*rmu(2, i)*temp953b0 - rmu(&
&        2, i)**2*2*rmucos(2, i)*temp953b1
      distpb(i, 10) = 0.0_8
      temp953b2 = cost5g*distpb(i, 9)
      temp953b3 = -(6.d0*rmu(2, i)**2*rmucos(2, i)**2*temp953b2)
      temp953b4 = -(6.d0*rmu(1, i)**2*rmucos(1, i)**2*temp953b2)
      rmub(1, i) = rmub(1, i) + rmucos(1, i)**2*2*rmu(1, i)*temp953b3 + &
&        rmucos(1, i)**4*4*rmu(1, i)**3*temp953b2
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)**2*2*rmucos(1, i)*&
&        temp953b3 + rmu(1, i)**4*4*rmucos(1, i)**3*temp953b2
      distpb(i, 9) = 0.0_8
      temp952 = rmu(3, i)*rmucos(3, i)
      temp951 = rmu(2, i)*rmucos(2, i)
      temp951b = cost4g*(3.d0*(rmu(1, i)**2*rmucos(1, i)**2)-rmu(2, i)**&
&        2*rmucos(2, i)**2)*distpb(i, 8)
      temp951b0 = cost4g*temp951*temp952*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + temp952*rmucos(2, i)*temp951b - rmucos(2&
&        , i)**2*2*rmu(2, i)*temp951b0 + rmucos(2, i)**4*4*rmu(2, i)**3*&
&        temp953b2 + rmucos(2, i)**2*2*rmu(2, i)*temp953b4
      rmucosb(2, i) = rmucosb(2, i) + temp952*rmu(2, i)*temp951b - rmu(2&
&        , i)**2*2*rmucos(2, i)*temp951b0 + rmu(2, i)**4*4*rmucos(2, i)**&
&        3*temp953b2 + rmu(2, i)**2*2*rmucos(2, i)*temp953b4
      rmub(3, i) = rmub(3, i) + temp951*rmucos(3, i)*temp951b
      rmucosb(3, i) = rmucosb(3, i) + temp951*rmu(3, i)*temp951b
      distpb(i, 8) = 0.0_8
      temp950 = rmu(3, i)*rmucos(3, i)
      temp949 = rmu(1, i)*rmucos(1, i)
      temp949b = cost4g*(rmu(1, i)**2*rmucos(1, i)**2-3.0*(rmu(2, i)**2*&
&        rmucos(2, i)**2))*distpb(i, 7)
      temp949b0 = cost4g*temp949*temp950*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + temp950*rmucos(1, i)*temp949b + rmucos(1&
&        , i)**2*2*rmu(1, i)*temp949b0 + 3.d0*rmucos(1, i)**2*2*rmu(1, i)&
&        *temp951b0
      rmucosb(1, i) = rmucosb(1, i) + temp950*rmu(1, i)*temp949b + rmu(1&
&        , i)**2*2*rmucos(1, i)*temp949b0 + 3.d0*rmu(1, i)**2*2*rmucos(1&
&        , i)*temp951b0
      rmub(3, i) = rmub(3, i) + temp949*rmucos(3, i)*temp949b
      rmucosb(3, i) = rmucosb(3, i) + temp949*rmu(3, i)*temp949b
      rmub(2, i) = rmub(2, i) - 3.0*rmucos(2, i)**2*2*rmu(2, i)*&
&        temp949b0
      rmucosb(2, i) = rmucosb(2, i) - 3.0*rmu(2, i)**2*2*rmucos(2, i)*&
&        temp949b0
      distpb(i, 7) = 0.0_8
      temp948 = rmu(2, i)*rmucos(2, i)
      temp947 = rmu(1, i)*rmucos(1, i)
      temp947b = cost3g*2.d0*distpb(i, 6)
      temp947b0 = (7.d0*(rmu(3, i)**2*rmucos(3, i)**2)-rp0)*temp947b
      temp947b1 = temp947*temp948*temp947b
      rmub(1, i) = rmub(1, i) + temp948*rmucos(1, i)*temp947b0
      rmucosb(1, i) = rmucosb(1, i) + temp948*rmu(1, i)*temp947b0
      rmub(2, i) = rmub(2, i) + temp947*rmucos(2, i)*temp947b0
      rmucosb(2, i) = rmucosb(2, i) + temp947*rmu(2, i)*temp947b0
      rmub(3, i) = rmub(3, i) + 7.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp947b1
      rmucosb(3, i) = rmucosb(3, i) + 7.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp947b1
      distpb(i, 6) = 0.0_8
      temp947b2 = cost3g*(7.d0*(rmu(3, i)**2*rmucos(3, i)**2)-rp0)*&
&        distpb(i, 5)
      temp947b3 = cost3g*(rmu(1, i)**2*rmucos(1, i)**2-rmu(2, i)**2*&
&        rmucos(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp946 = rmu(3, i)*rmucos(3, i)
      temp945 = rmu(2, i)*rmucos(2, i)
      temp945b = cost2g*(7.d0*(rmu(3, i)**2*rmucos(3, i)**2)-3.d0*rp0)*&
&        distpb(i, 4)
      temp945b0 = cost2g*temp945*temp946*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp944 = rmu(3, i)*rmucos(3, i)
      temp943 = rmu(1, i)*rmucos(1, i)
      temp943b = cost2g*(7.d0*(rmu(3, i)**2*rmucos(3, i)**2)-3.d0*rp0)*&
&        distpb(i, 3)
      temp943b0 = cost2g*temp943*temp944*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp943b1 = cost1g*distpb(i, 2)
      temp943b2 = -(30.d0*rmucos(3, i)**2*temp943b1)
      rp0b = 3.d0*2*rp0*temp943b1 - 3.d0*temp943b0 - temp947b3 + rmu(3, &
&        i)**2*temp943b2 - 3.d0*temp945b0 - temp947b1
      rmub(1, i) = rmub(1, i) + rmucos(1, i)**2*2*rmu(1, i)*temp947b2
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)**2*2*rmucos(1, i)*&
&        temp947b2
      rmub(2, i) = rmub(2, i) - rmucos(2, i)**2*2*rmu(2, i)*temp947b2
      rmucosb(2, i) = rmucosb(2, i) - rmu(2, i)**2*2*rmucos(2, i)*&
&        temp947b2
      rmub(3, i) = rmub(3, i) + 7.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp947b3
      rmucosb(3, i) = rmucosb(3, i) + 7.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp947b3
      rmub(2, i) = rmub(2, i) + temp946*rmucos(2, i)*temp945b
      rmucosb(2, i) = rmucosb(2, i) + temp946*rmu(2, i)*temp945b
      rmub(3, i) = rmub(3, i) + 7.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp945b0 + temp945*rmucos(3, i)*temp945b
      rmucosb(3, i) = rmucosb(3, i) + 7.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp945b0 + temp945*rmu(3, i)*temp945b
      rmub(1, i) = rmub(1, i) + temp944*rmucos(1, i)*temp943b
      rmucosb(1, i) = rmucosb(1, i) + temp944*rmu(1, i)*temp943b
      rmub(3, i) = rmub(3, i) + 35.d0*rmucos(3, i)**4*4*rmu(3, i)**3*&
&        temp943b1 + rp0*2*rmu(3, i)*temp943b2 + 7.d0*rmucos(3, i)**2*2*&
&        rmu(3, i)*temp943b0 + temp943*rmucos(3, i)*temp943b
      rmucosb(3, i) = rmucosb(3, i) + (35.d0*rmu(3, i)**4*4*rmucos(3, i)&
&        **3-30.d0*rmu(3, i)**2*rp0*2*rmucos(3, i))*temp943b1 + 7.d0*rmu(&
&        3, i)**2*2*rmucos(3, i)*temp943b0 + temp943*rmu(3, i)*temp943b
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp943b3 = 2*rmu(1, i)*rmucos(1, i)*rp0b
      temp943b4 = 2*rmu(2, i)*rmucos(2, i)*rp0b
      temp943b5 = 2*rmu(3, i)*rmucos(3, i)*rp0b
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp943b3
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp943b3
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp943b4
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp943b4
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp943b5
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp943b5
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp942 = r(k)**2
      temp942b = c*DEXP(-(dd1*temp942))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp942))*distpb(k, 1)
      dd1b = dd1b - temp942*temp942b
      rb(k) = rb(k) - dd1*2*r(k)*temp942b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.11284691281640568826d0*2.75d0*dd1**1.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (52)
! g single gaussian orbital
! derivative of 51
! normalized
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! Y_i are the stretched coordinates for the angular part A
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(Y_i(x_i)) \phi(x_i)
! R depends on X_i, A depends on Y_i, the phase \phi depends on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! where  d^2/dx^2_k F(X_i(x_i)) = (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dY^2_k A)  ((d/dx_k Y_i) (x_i))^2
!                      + R  (d/dY_k A)  (d^2/dx^2_k Y_i) (x_i)
!                      + 2 (d/dX_k R)  (d/dY_k A)   (d/dx_k X_i) (x_i)  (d/dx_k Y_i) (x_i)
! X_i = rmu
! Y_i = rmu * rmucos
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
! d/dx_k Y_i  =  2 * rmucos**2  - 1
! d^2/dx^2_k Y_i = - 4*Pi/L * rmusin * rmucos
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!          if(iflagnorm.gt.2) then
! overall normalization
    c = dd1**2.75d0*1.11284691281640568826d0
!          c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)
!          endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = (rmu(1, i)*rmucos(1, i))**2 + (rmu(2, i)*rmucos(2, i))**2 + &
&        (rmu(3, i)*rmucos(3, i))**2
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4*rmucos(3, i)**4-30.d0*rmu&
&        (3, i)**2*rmucos(3, i)**2*rp0+3.d0*rp0**2)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2*rmucos(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2*rmucos(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2*rmucos(1, i)**2-rmu(2, i)**2*&
&        rmucos(2, i)**2)*(7.d0*rmu(3, i)**2*rmucos(3, i)**2-rp0)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos(&
&        2, i)*(7.d0*rmu(3, i)**2*rmucos(3, i)**2-rp0)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(rmu(1, i)**2*rmucos(1, i)**2-3.0*rmu(2, i)**2*rmucos(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(3.d0*rmu(1, i)**2*rmucos(1, i)**2-rmu(2, i)**2*rmucos(2, i)**2&
&        )
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4*rmucos(1, i)**4-6.d0*rmu(1, i)&
&        **2*rmucos(1, i)**2*rmu(2, i)**2*rmucos(2, i)**2+rmu(2, i)**4*&
&        rmucos(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos&
&        (2, i)*(rmu(1, i)**2*rmucos(1, i)**2-rmu(2, i)**2*rmucos(2, i)**&
&        2)
    END DO
! lz=+/-4
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,9
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*(11.d0/4.d0/dd1-r(k)**2)*distp(k, &
&            1+ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)*(11.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-15.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+21.d0*dd1*r(0)**2-15.d0&
&        /2.d0)
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = (rmu(1, 0)*rmucos(1, 0))**2 + (rmu(2, 0)*rmucos(2, 0))**2 + &
&        (rmu(3, 0)*rmucos(3, 0))**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,9
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part
! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            der4f(2) = 0.d0
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
            hess4f(2) = 0.d0
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
            hess4f(3) = 0.d0
! contribution of the angular part
            IF (ic .EQ. 1) THEN
! rp1 =   d/dx_k angular
! rp2 =   d^2/dx^2_k angular
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost1g*(-(60.d0*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)**&
&                  2*rmucos(3, 0)**2)+12.d0*rmu(1, 0)*rmucos(1, 0)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost1g*12.d0*(3.d0*(rmu(1, 0)*rmucos(1, 0))**2+(&
&                  rmu(2, 0)*rmucos(2, 0))**2-4.d0*rmu(3, 0)**2*rmucos(3&
&                  , 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
! der4f(2)  = der4f(2)  +  fun0 * d/dx_k angular
! hess4f(2) = hess4f(2) +  fun0 * d^2/dx^2_k angular
! hess4f(3) = hess4f(3) +  2 * fun * x_k * d/dx_k angular
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost1g*(-(60.d0*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)**&
&                  2*rmucos(3, 0)**2)+12.d0*rmu(2, 0)*rmucos(2, 0)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost1g*12.d0*((rmu(1, 0)*rmucos(1, 0))**2+3.d0*(&
&                  rmu(2, 0)*rmucos(2, 0))**2-4.d0*rmu(3, 0)**2*rmucos(3&
&                  , 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost1g*(80.d0*rmu(3, 0)**3*rmucos(3, 0)**3-48.d0*&
&                  rmu(3, 0)*rmucos(3, 0)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(cost1g*48.d0*((rmu(1, 0)*rmucos(1, 0))**2+(rmu(2&
&                  , 0)*rmucos(2, 0))**2-2.d0*rmu(3, 0)**2*rmucos(3, 0)**&
&                  2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(9.d0*(rmu(1, 0)*rmucos(1, 0))**2*rmu(3, &
&                  0)*rmucos(3, 0))-3.d0*(rmu(2, 0)*rmucos(2, 0))**2*rmu(&
&                  3, 0)*rmucos(3, 0)+4.d0*rmu(3, 0)**3*rmucos(3, 0)**3)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(18.d0*cost2g*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(6.d0*cost2g*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(3.d0*rmu(1, 0)*rmucos(1, 0)*((rmu(1, 0)*&
&                  rmucos(1, 0))**2+(rmu(2, 0)*rmucos(2, 0))**2-4.d0*rmu(&
&                  3, 0)**2*rmucos(3, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 24.d0*cost2g*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(6.d0*cost2g*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(3.d0*(rmu(1, 0)*rmucos(1, 0))**2*rmu(3, &
&                  0)*rmucos(3, 0))-9.d0*(rmu(2, 0)*rmucos(2, 0))**2*rmu(&
&                  3, 0)*rmucos(3, 0)+4.d0*rmu(3, 0)**3*rmucos(3, 0)**3)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(18.d0*cost2g*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost2g*(-(3.d0*rmu(2, 0)*rmucos(2, 0)*((rmu(1, 0)*&
&                  rmucos(1, 0))**2+(rmu(2, 0)*rmucos(2, 0))**2-4.d0*rmu(&
&                  3, 0)**2*rmucos(3, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 24.d0*cost2g*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*(-(4.d0*((rmu(1, 0)*rmucos(1, 0))**3-3.d0*&
&                  rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)**2*rmucos(3, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(12.d0*cost3g*((rmu(1, 0)*rmucos(1, 0))**2-rmu(3&
&                  , 0)**2*rmucos(3, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*(4.d0*((rmu(2, 0)*rmucos(2, 0))**3-3.d0*rmu&
&                  (2, 0)*rmucos(2, 0)*rmu(3, 0)**2*rmucos(3, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 12.d0*cost3g*((rmu(2, 0)*rmucos(2, 0))**2-rmu(3, 0&
&                  )**2*rmucos(3, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*(12.d0*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2&
&                  , 0)*rmucos(2, 0))**2)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 12.d0*cost3g*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, &
&                  0)*rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*(-(2.d0*rmu(2, 0)*rmucos(2, 0)*(3.d0*(rmu(1&
&                  , 0)*rmucos(1, 0))**2+(rmu(2, 0)*rmucos(2, 0))**2-6.d0&
&                  *rmu(3, 0)**2*rmucos(3, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(12.d0*cost3g*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*(-(2.d0*rmu(1, 0)*rmucos(1, 0)*((rmu(1, 0)*&
&                  rmucos(1, 0))**2+3.d0*(rmu(2, 0)*rmucos(2, 0))**2-6.d0&
&                  *rmu(3, 0)**2*rmucos(3, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(12.d0*cost3g*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost3g*24.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost3g*24.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost4g*3.d0*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, 0&
&                  )*rmucos(2, 0))**2)*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost4g*6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = -(cost4g*6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(cost4g*6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost4g*((rmu(1, 0)*rmucos(1, 0))**3-3.d0*rmu(1, 0)&
&                  *rmucos(1, 0)*(rmu(2, 0)*rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              END IF
            ELSE IF (ic .EQ. 7) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost4g*6.d0*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost4g*6.d0*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost4g*3.d0*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, 0&
&                  )*rmucos(2, 0))**2)*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = -(cost4g*6.d0*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost4g*(3.d0*(rmu(1, 0)*rmucos(1, 0))**2*rmu(2, 0)&
&                  *rmucos(2, 0)-(rmu(2, 0)*rmucos(2, 0))**3)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              END IF
            ELSE IF (ic .EQ. 8) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost5g*4.d0*((rmu(1, 0)*rmucos(1, 0))**3-3.d0*rmu(&
&                  1, 0)*rmucos(1, 0)*(rmu(2, 0)*rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost5g*12.d0*((rmu(1, 0)*rmucos(1, 0))**2-(rmu(2, &
&                  0)*rmucos(2, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
                rp1 = cost5g*4.d0*((rmu(2, 0)*rmucos(2, 0))**3-3.d0*(rmu&
&                  (1, 0)*rmucos(1, 0))**2*rmu(2, 0)*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
                rp2 = cost5g*12.d0*((rmu(2, 0)*rmucos(2, 0))**2-(rmu(1, &
&                  0)*rmucos(1, 0))**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = der4f(2) + fun0*rp1
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = hess4f(2) + fun0*rp2
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = cost5g*4.d0*(3.d0*(rmu(1, 0)*rmucos(1, 0))**2*rmu(2&
&                , 0)*rmucos(2, 0)-(rmu(2, 0)*rmucos(2, 0))**3)
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = 24.d0*cost5g*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*rmucos&
&                (2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
              rp1 = cost5g*4.d0*((rmu(1, 0)*rmucos(1, 0))**3-3.d0*rmu(1&
&                , 0)*rmucos(1, 0)*(rmu(2, 0)*rmucos(2, 0))**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
              rp2 = -(24.d0*cost5g*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                rmucos(2, 0))
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = der4f(2) + fun0*rp1
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = hess4f(2) + fun0*rp2
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = hess4f(3) + 2.d0*fun*rp1*rmu(i, 0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)*(2.d0*&
&              rmucos(i, 0)**2-1.d0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dY^2_k A)  ((d/dx_k Y_i) (x_i))^2
!                      + R  (d/dY_k A)  (d^2/dx^2_k Y_i) (x_i)
!                      + 2 (d/dX_k R)  (d/dY_k A)   (d/dx_k X_i) (x_i)  (d/dx_k Y_i) (x_i)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2)*(2.d0*rmucos(i, 0)**&
&              2-1.d0)**2 - der4f(2)*4.d0*pi/cellscale(i)*rmusin(i, 0)*&
&              rmucos(i, 0) + hess4f(3)*rmucos(i, 0)*(2.d0*rmucos(i, 0)**&
&              2-1.d0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*(11.d0/4.d0/dd1-r(0&
&              )**2)*distp(0, 1+ic)*cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*(11.d0/4.d0/dd1-r(0)**2)*distp(0, 1+ic)*sinphase(i, &
&              0)*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      dd1b = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=9,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp1040 = distp(0, 1)*rphase(i)
            temp1039 = distp(0, 1+ic)*sinphase(i, 0)
            temp1039b = -(temp1039*temp1040*zb(indorbp, indt+i))
            temp1038 = 4.d0*dd1
            temp1037 = 11.d0/temp1038
            temp1037b = -((temp1037-r(0)**2)*zb(indorbp, indt+i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1036 = distp(0, 1+ic)*rphase(i)**2
            temp1034 = 4.d0*dd1
            temp1033 = 11.d0/temp1034
            temp1033b = -((temp1033-r(0)**2)*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + &
&              temp1036*distp(0, 1)*temp1033b + z(indorbp, indt+i)*zb(&
&              indorbp, indt+i)
            temp1035 = distp(0, 1)*cosphase(0)
            temp1035b = -(temp1035*temp1036*hess4fb(1))
            dd1b = dd1b - temp1033*4.d0*temp1035b/temp1034 - temp1037*&
&              4.d0*temp1039b/temp1038
            rb(0) = rb(0) - 2*r(0)*temp1035b - 2*r(0)*temp1039b
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp1040*sinphase(i, 0)*&
&              temp1037b
            temp1037b0 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp1037b0 + &
&              temp1040*distp(0, 1+ic)*temp1037b
            distpb(0, 1) = distpb(0, 1) + temp1036*cosphase(0)*temp1033b&
&              + temp1039*rphase(i)*temp1037b
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp1037b0 + &
&              temp1035*distp(0, 1+ic)*2*rphase(i)*temp1033b + temp1039*&
&              distp(0, 1)*temp1037b
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp1035*rphase(i)**2*&
&              temp1033b
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1032 = der4f(1)/cellscale(i)
            temp1032b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            temp1031 = 2.d0*rmucos(i, 0)**2 - 1.d0
            temp1031b = (2.d0*rmucos(i, 0)**2-1.d0)*hess4fb(1)
            temp1030 = der4f(2)/cellscale(i)
            temp1031b0 = -(pi*4.d0*hess4fb(1))
            temp1031b1 = temp1030*temp1031b0
            temp1030b42 = rmusin(i, 0)*rmucos(i, 0)*temp1031b0/cellscale&
&              (i)
            rmucosb(i, 0) = rmucosb(i, 0) + (der4f(2)*2.d0*2*rmucos(i, 0&
&              )+der4f(1))*zb(indorbp, indt+i) + rmusin(i, 0)*temp1031b1 &
&              + hess4f(3)*temp1031b + (2*(hess4f(3)*rmucos(i, 0)**2*2.d0&
&              )+hess4f(2)*2**2*temp1031*2.d0*rmucos(i, 0)+hess4f(1)*2*&
&              rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) + rmucos(i, 0)*temp1031b1 - pi&
&              *temp1032*hess4fb(1)
            der4fb(1) = der4fb(1) + temp1032b
            cellscaleb(i) = cellscaleb(i) - temp1030*temp1030b42 - &
&              temp1032*temp1032b
            hess4fb(2) = hess4fb(2) + temp1031**2*hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*temp1031b
            der4fb(2) = der4fb(2) + temp1030b42
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i)
            der4fb(2) = der4fb(2) + (2.d0*rmucos(i, 0)**2-1.d0)*zb(&
&              indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 14) THEN
              IF (branch .LT. 7) THEN
                IF (branch .LT. 4) THEN
                  IF (branch .LT. 2) THEN
                    IF (branch .LT. 1) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      temp1008b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                      funb = funb + rp1*temp1008b0
                      rp1b = fun0*der4fb(2) + fun*temp1008b0
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                      rp2b = fun0*hess4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                      temp1008b1 = cost1g*12.d0*rp2b
                      temp1008b2 = 2*rmu(2, 0)*rmucos(2, 0)*temp1008b1
                      rmub(1, 0) = rmub(1, 0) + 3.d0*rmucos(1, 0)**2*2*&
&                        rmu(1, 0)*temp1008b1
                      rmucosb(1, 0) = rmucosb(1, 0) + 3.d0*rmu(1, 0)**2*&
&                        2*rmucos(1, 0)*temp1008b1
                      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1008b2
                      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                        temp1008b2
                      rmub(3, 0) = rmub(3, 0) - 4.d0*rmucos(3, 0)**2*2*&
&                        rmu(3, 0)*temp1008b1
                      rmucosb(3, 0) = rmucosb(3, 0) - 4.d0*rmu(3, 0)**2*&
&                        2*rmucos(3, 0)*temp1008b1
                      CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                      temp1008b3 = cost1g*rp1b
                      temp1008b4 = 12.d0*rmucos(1, 0)*temp1008b3
                      temp1008b5 = -(60.d0*rmu(3, 0)**2*rmucos(3, 0)**2*&
&                        temp1008b3)
                      temp1008b6 = -(60.d0*rmu(1, 0)*rmucos(1, 0)*&
&                        temp1008b3)
                      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1008b5 &
&                        + rp0*temp1008b4
                      rp0b = rp0b + rmu(1, 0)*temp1008b4
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp1008b5 + 12.d0*rmu(1, 0)*rp0*temp1008b3
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)**2*2*rmu(3&
&                        , 0)*temp1008b6
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*&
&                        rmucos(3, 0)*temp1008b6
                    ELSE
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      temp1008b7 = 2.d0*rmu(i, 0)*hess4fb(3)
                      funb = funb + rp1*temp1008b7
                      rp1b = fun0*der4fb(2) + fun*temp1008b7
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                      rp2b = fun0*hess4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                      temp1008b8 = cost1g*12.d0*rp2b
                      temp1008b9 = 2*rmu(1, 0)*rmucos(1, 0)*temp1008b8
                      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1008b9
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp1008b9
                      rmub(2, 0) = rmub(2, 0) + 3.d0*rmucos(2, 0)**2*2*&
&                        rmu(2, 0)*temp1008b8
                      rmucosb(2, 0) = rmucosb(2, 0) + 3.d0*rmu(2, 0)**2*&
&                        2*rmucos(2, 0)*temp1008b8
                      rmub(3, 0) = rmub(3, 0) - 4.d0*rmucos(3, 0)**2*2*&
&                        rmu(3, 0)*temp1008b8
                      rmucosb(3, 0) = rmucosb(3, 0) - 4.d0*rmu(3, 0)**2*&
&                        2*rmucos(3, 0)*temp1008b8
                      CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                      temp1008b10 = cost1g*rp1b
                      temp1008b11 = 12.d0*rmucos(2, 0)*temp1008b10
                      temp1008b12 = -(60.d0*rmu(3, 0)**2*rmucos(3, 0)**2&
&                        *temp1008b10)
                      temp1008b13 = -(60.d0*rmu(2, 0)*rmucos(2, 0)*&
&                        temp1008b10)
                      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1008b12&
&                        + rp0*temp1008b11
                      rp0b = rp0b + rmu(2, 0)*temp1008b11
                      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                        temp1008b12 + 12.d0*rmu(2, 0)*rp0*temp1008b10
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)**2*2*rmu(3&
&                        , 0)*temp1008b13
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*&
&                        rmucos(3, 0)*temp1008b13
                    END IF
                  ELSE IF (branch .LT. 3) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp1008b14 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp1008b14
                    rp1b = fun0*der4fb(2) + fun*temp1008b14
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp1008b15 = -(cost1g*48.d0*rp2b)
                    temp1008b16 = 2*rmu(1, 0)*rmucos(1, 0)*temp1008b15
                    temp1008b17 = 2*rmu(2, 0)*rmucos(2, 0)*temp1008b15
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1008b16
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                      temp1008b16
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1008b17
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                      temp1008b17
                    temp1008b18 = cost1g*rp1b
                    temp1008b19 = -(48.d0*rmucos(3, 0)*temp1008b18)
                    rmub(3, 0) = rmub(3, 0) + 80.d0*rmucos(3, 0)**3*3*&
&                      rmu(3, 0)**2*temp1008b18 + rp0*temp1008b19 - 2.d0*&
&                      rmucos(3, 0)**2*2*rmu(3, 0)*temp1008b15
                    rmucosb(3, 0) = rmucosb(3, 0) + (80.d0*rmu(3, 0)**3*&
&                      3*rmucos(3, 0)**2-48.d0*rmu(3, 0)*rp0)*temp1008b18&
&                      - 2.d0*rmu(3, 0)**2*2*rmucos(3, 0)*temp1008b15
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    rp0b = rp0b + rmu(3, 0)*temp1008b19
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp1008b20 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp1008b20
                    rp1b = fun0*der4fb(2) + fun*temp1008b20
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp1008b21 = -(cost2g*18.d0*rp2b)
                    temp1008b22 = rmu(3, 0)*rmucos(3, 0)*temp1008b21
                    temp1008b23 = rmu(1, 0)*rmucos(1, 0)*temp1008b21
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1008b22
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                      temp1008b22
                    temp1008b24 = cost2g*rp1b
                    temp1008b25 = -(3.d0*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                      temp1008b24)
                    temp1008b26 = -(9.d0*rmu(1, 0)**2*rmucos(1, 0)**2*&
&                      temp1008b24)
                    rmub(3, 0) = rmub(3, 0) + 4.d0*rmucos(3, 0)**3*3*rmu&
&                      (3, 0)**2*temp1008b24 + rmucos(3, 0)*temp1008b25 +&
&                      rmucos(3, 0)*temp1008b26 + rmucos(3, 0)*&
&                      temp1008b23
                    rmucosb(3, 0) = rmucosb(3, 0) + 4.d0*rmu(3, 0)**3*3*&
&                      rmucos(3, 0)**2*temp1008b24 + rmu(3, 0)*&
&                      temp1008b25 + rmu(3, 0)*temp1008b26 + rmu(3, 0)*&
&                      temp1008b23
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp1008b27 = -(3.d0*rmu(3, 0)*rmucos(3, 0)*&
&                      temp1008b24)
                    temp1008b28 = -(9.d0*rmu(3, 0)*rmucos(3, 0)*&
&                      temp1008b24)
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0&
&                      )*temp1008b27
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)**2*2*&
&                      rmucos(2, 0)*temp1008b27
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0&
&                      )*temp1008b28
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*&
&                      rmucos(1, 0)*temp1008b28
                  END IF
                ELSE IF (branch .LT. 6) THEN
                  IF (branch .LT. 5) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp1010b = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp1010b
                    rp1b = fun0*der4fb(2) + fun*temp1010b
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp1010b0 = -(cost2g*6.d0*rp2b)
                    temp1010b1 = rmu(3, 0)*rmucos(3, 0)*temp1010b0
                    temp1010b2 = rmu(1, 0)*rmucos(1, 0)*temp1010b0
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1010b1
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1010b1
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1010b2
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1010b2
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp1009 = rmu(2, 0)*rmucos(2, 0)
                    temp1008 = rmu(1, 0)*rmucos(1, 0)
                    temp1008b29 = -(cost2g*6.d0*rp1b)
                    temp1008b30 = rmu(3, 0)*rmucos(3, 0)*temp1008b29
                    temp1008b31 = temp1008*temp1009*temp1008b29
                    rmub(1, 0) = rmub(1, 0) + temp1009*rmucos(1, 0)*&
&                      temp1008b30
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1009*rmu(1, 0)*&
&                      temp1008b30
                    rmub(2, 0) = rmub(2, 0) + temp1008*rmucos(2, 0)*&
&                      temp1008b30
                    rmucosb(2, 0) = rmucosb(2, 0) + temp1008*rmu(2, 0)*&
&                      temp1008b30
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1008b31
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                      temp1008b31
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp1012b = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp1012b
                    rp1b = fun0*der4fb(2) + fun*temp1012b
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp1012b0 = cost2g*24.d0*rp2b
                    temp1012b1 = rmu(3, 0)*rmucos(3, 0)*temp1012b0
                    temp1012b2 = rmu(1, 0)*rmucos(1, 0)*temp1012b0
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1012b1
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1012b1
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1012b2
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1012b2
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp1010 = rmu(2, 0)*rmucos(2, 0)
                    temp1011 = rmu(1, 0)*rmucos(1, 0)
                    temp1012b3 = -(cost2g*3.d0*rp1b)
                    temp1012b4 = (temp1011**2+temp1010**2-4.d0*(rmu(3, 0&
&                      )**2*rmucos(3, 0)**2))*temp1012b3
                    temp1012b5 = rmu(1, 0)*rmucos(1, 0)*temp1012b3
                    temp1011b = 2*temp1011*temp1012b5
                    temp1010b3 = 2*temp1010*temp1012b5
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1011b + &
&                      rmucos(1, 0)*temp1012b4
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1011b &
&                      + rmu(1, 0)*temp1012b4
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1010b3
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1010b3
                    rmub(3, 0) = rmub(3, 0) - 4.d0*rmucos(3, 0)**2*2*rmu&
&                      (3, 0)*temp1012b5
                    rmucosb(3, 0) = rmucosb(3, 0) - 4.d0*rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp1012b5
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp1014b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp1014b
                  rp1b = fun0*der4fb(2) + fun*temp1014b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp1014b0 = -(cost2g*6.d0*rp2b)
                  temp1014b1 = rmu(3, 0)*rmucos(3, 0)*temp1014b0
                  temp1014b2 = rmu(2, 0)*rmucos(2, 0)*temp1014b0
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1014b1
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1014b1
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1014b2
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1014b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp1013 = rmu(2, 0)*rmucos(2, 0)
                  temp1012 = rmu(1, 0)*rmucos(1, 0)
                  temp1012b6 = -(cost2g*6.d0*rp1b)
                  temp1012b7 = rmu(3, 0)*rmucos(3, 0)*temp1012b6
                  temp1012b8 = temp1012*temp1013*temp1012b6
                  rmub(1, 0) = rmub(1, 0) + temp1013*rmucos(1, 0)*&
&                    temp1012b7
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1013*rmu(1, 0)*&
&                    temp1012b7
                  rmub(2, 0) = rmub(2, 0) + temp1012*rmucos(2, 0)*&
&                    temp1012b7
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1012*rmu(2, 0)*&
&                    temp1012b7
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1012b8
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1012b8
                END IF
              ELSE IF (branch .LT. 11) THEN
                IF (branch .LT. 9) THEN
                  IF (branch .LT. 8) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp1014b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp1014b3
                    rp1b = fun0*der4fb(2) + fun*temp1014b3
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp1014b4 = -(cost2g*18.d0*rp2b)
                    temp1014b5 = rmu(3, 0)*rmucos(3, 0)*temp1014b4
                    temp1014b6 = rmu(2, 0)*rmucos(2, 0)*temp1014b4
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1014b5
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1014b5
                    temp1014b7 = cost2g*rp1b
                    temp1014b8 = -(9.d0*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                      temp1014b7)
                    temp1014b9 = -(3.d0*rmu(1, 0)**2*rmucos(1, 0)**2*&
&                      temp1014b7)
                    rmub(3, 0) = rmub(3, 0) + 4.d0*rmucos(3, 0)**3*3*rmu&
&                      (3, 0)**2*temp1014b7 + rmucos(3, 0)*temp1014b8 + &
&                      rmucos(3, 0)*temp1014b9 + rmucos(3, 0)*temp1014b6
                    rmucosb(3, 0) = rmucosb(3, 0) + 4.d0*rmu(3, 0)**3*3*&
&                      rmucos(3, 0)**2*temp1014b7 + rmu(3, 0)*temp1014b8 &
&                      + rmu(3, 0)*temp1014b9 + rmu(3, 0)*temp1014b6
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp1014b10 = -(9.d0*rmu(3, 0)*rmucos(3, 0)*&
&                      temp1014b7)
                    temp1014b11 = -(3.d0*rmu(3, 0)*rmucos(3, 0)*&
&                      temp1014b7)
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0&
&                      )*temp1014b10
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)**2*2*&
&                      rmucos(2, 0)*temp1014b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0&
&                      )*temp1014b11
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*&
&                      rmucos(1, 0)*temp1014b11
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp1016b = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp1016b
                    rp1b = fun0*der4fb(2) + fun*temp1016b
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp1016b0 = cost2g*24.d0*rp2b
                    temp1016b1 = rmu(3, 0)*rmucos(3, 0)*temp1016b0
                    temp1016b2 = rmu(2, 0)*rmucos(2, 0)*temp1016b0
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1016b1
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1016b1
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1016b2
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1016b2
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp1014 = rmu(2, 0)*rmucos(2, 0)
                    temp1015 = rmu(1, 0)*rmucos(1, 0)
                    temp1016b3 = -(cost2g*3.d0*rp1b)
                    temp1016b4 = (temp1015**2+temp1014**2-4.d0*(rmu(3, 0&
&                      )**2*rmucos(3, 0)**2))*temp1016b3
                    temp1016b5 = rmu(2, 0)*rmucos(2, 0)*temp1016b3
                    temp1015b = 2*temp1015*temp1016b5
                    temp1014b12 = 2*temp1014*temp1016b5
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1014b12 +&
&                      rmucos(2, 0)*temp1016b4
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                      temp1014b12 + rmu(2, 0)*temp1016b4
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1015b
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1015b
                    rmub(3, 0) = rmub(3, 0) - 4.d0*rmucos(3, 0)**2*2*rmu&
&                      (3, 0)*temp1016b5
                    rmucosb(3, 0) = rmucosb(3, 0) - 4.d0*rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp1016b5
                  END IF
                ELSE IF (branch .LT. 10) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp1016b6 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp1016b6
                  rp1b = fun0*der4fb(2) + fun*temp1016b6
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp1016b7 = -(cost3g*12.d0*rp2b)
                  temp1016b8 = 2*rmu(1, 0)*rmucos(1, 0)*temp1016b7
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1016b8
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1016b8
                  rmub(3, 0) = rmub(3, 0) - rmucos(3, 0)**2*2*rmu(3, 0)*&
&                    temp1016b7
                  rmucosb(3, 0) = rmucosb(3, 0) - rmu(3, 0)**2*2*rmucos(&
&                    3, 0)*temp1016b7
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp1016b9 = -(cost3g*4.d0*rp1b)
                  temp1016b10 = 3*rmu(1, 0)**2*rmucos(1, 0)**2*&
&                    temp1016b9
                  temp1016b11 = -(3.d0*rmu(3, 0)**2*rmucos(3, 0)**2*&
&                    temp1016b9)
                  temp1016b12 = -(3.d0*rmu(1, 0)*rmucos(1, 0)*temp1016b9&
&                    )
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1016b11 + &
&                    rmucos(1, 0)*temp1016b10
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1016b11 &
&                    + rmu(1, 0)*temp1016b10
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)**2*2*rmu(3, 0)*&
&                    temp1016b12
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*rmucos(&
&                    3, 0)*temp1016b12
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp1016b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp1016b13
                  rp1b = fun0*der4fb(2) + fun*temp1016b13
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp1016b14 = cost3g*12.d0*rp2b
                  temp1016b15 = 2*rmu(2, 0)*rmucos(2, 0)*temp1016b14
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1016b15
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1016b15
                  rmub(3, 0) = rmub(3, 0) - rmucos(3, 0)**2*2*rmu(3, 0)*&
&                    temp1016b14
                  rmucosb(3, 0) = rmucosb(3, 0) - rmu(3, 0)**2*2*rmucos(&
&                    3, 0)*temp1016b14
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp1016b16 = cost3g*4.d0*rp1b
                  temp1016b17 = 3*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                    temp1016b16
                  temp1016b18 = -(3.d0*rmu(3, 0)**2*rmucos(3, 0)**2*&
&                    temp1016b16)
                  temp1016b19 = -(3.d0*rmu(2, 0)*rmucos(2, 0)*&
&                    temp1016b16)
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1016b18 + &
&                    rmucos(2, 0)*temp1016b17
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1016b18 &
&                    + rmu(2, 0)*temp1016b17
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)**2*2*rmu(3, 0)*&
&                    temp1016b19
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*rmucos(&
&                    3, 0)*temp1016b19
                END IF
              ELSE IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp1018b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp1018b
                  rp1b = fun0*der4fb(2) + fun*temp1018b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp1018b0 = cost3g*12.d0*rp2b
                  temp1018b1 = 2*rmu(1, 0)*rmucos(1, 0)*temp1018b0
                  temp1018b2 = -(2*rmu(2, 0)*rmucos(2, 0)*temp1018b0)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1018b1
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1018b1
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1018b2
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1018b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp1016 = rmu(2, 0)*rmucos(2, 0)
                  temp1017 = rmu(1, 0)*rmucos(1, 0)
                  temp1018b3 = cost3g*12.d0*rp1b
                  temp1018b4 = rmu(3, 0)*rmucos(3, 0)*temp1018b3
                  temp1017b = 2*temp1017*temp1018b4
                  temp1016b20 = -(2*temp1016*temp1018b4)
                  temp1016b21 = (temp1017**2-temp1016**2)*temp1018b3
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1017b
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1017b
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1016b20
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1016b20
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1016b21
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1016b21
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp1019b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp1019b
                  rp1b = fun0*der4fb(2) + fun*temp1019b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp1019b0 = -(cost3g*12.d0*rp2b)
                  temp1019b1 = rmu(2, 0)*rmucos(2, 0)*temp1019b0
                  temp1019b2 = rmu(1, 0)*rmucos(1, 0)*temp1019b0
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1019b1
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1019b1
                  temp1018 = rmu(2, 0)*rmucos(2, 0)
                  temp1019b3 = -(cost3g*2.d0*rp1b)
                  temp1019b4 = (3.d0*(rmu(1, 0)**2*rmucos(1, 0)**2)+&
&                    temp1018**2-6.d0*(rmu(3, 0)**2*rmucos(3, 0)**2))*&
&                    temp1019b3
                  temp1019b5 = rmu(2, 0)*rmucos(2, 0)*temp1019b3
                  temp1018b5 = 2*temp1018*temp1019b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1019b4 + &
&                    rmucos(2, 0)*temp1018b5 + rmucos(2, 0)*temp1019b2
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1019b4 +&
&                    rmu(2, 0)*temp1018b5 + rmu(2, 0)*temp1019b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  rmub(1, 0) = rmub(1, 0) + 3.d0*rmucos(1, 0)**2*2*rmu(1&
&                    , 0)*temp1019b5
                  rmucosb(1, 0) = rmucosb(1, 0) + 3.d0*rmu(1, 0)**2*2*&
&                    rmucos(1, 0)*temp1019b5
                  rmub(3, 0) = rmub(3, 0) - 6.d0*rmucos(3, 0)**2*2*rmu(3&
&                    , 0)*temp1019b5
                  rmucosb(3, 0) = rmucosb(3, 0) - 6.d0*rmu(3, 0)**2*2*&
&                    rmucos(3, 0)*temp1019b5
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp1020b = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp1020b
                rp1b = fun0*der4fb(2) + fun*temp1020b
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp1020b0 = -(cost3g*12.d0*rp2b)
                temp1020b1 = rmu(2, 0)*rmucos(2, 0)*temp1020b0
                temp1020b2 = rmu(1, 0)*rmucos(1, 0)*temp1020b0
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1020b1
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1020b1
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1020b2
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1020b2
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp1019 = rmu(1, 0)*rmucos(1, 0)
                temp1020b3 = -(cost3g*2.d0*rp1b)
                temp1020b4 = (temp1019**2+3.d0*(rmu(2, 0)**2*rmucos(2, 0&
&                  )**2)-6.d0*(rmu(3, 0)**2*rmucos(3, 0)**2))*temp1020b3
                temp1020b5 = rmu(1, 0)*rmucos(1, 0)*temp1020b3
                temp1019b6 = 2*temp1019*temp1020b5
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1019b6 + &
&                  rmucos(1, 0)*temp1020b4
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1019b6 + &
&                  rmu(1, 0)*temp1020b4
                rmub(2, 0) = rmub(2, 0) + 3.d0*rmucos(2, 0)**2*2*rmu(2, &
&                  0)*temp1020b5
                rmucosb(2, 0) = rmucosb(2, 0) + 3.d0*rmu(2, 0)**2*2*&
&                  rmucos(2, 0)*temp1020b5
                rmub(3, 0) = rmub(3, 0) - 6.d0*rmucos(3, 0)**2*2*rmu(3, &
&                  0)*temp1020b5
                rmucosb(3, 0) = rmucosb(3, 0) - 6.d0*rmu(3, 0)**2*2*&
&                  rmucos(3, 0)*temp1020b5
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 18) THEN
                IF (branch .LT. 16) THEN
                  IF (branch .LT. 15) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp1022b = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp1022b
                    rp1b = fun0*der4fb(2) + fun*temp1022b
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp1022b0 = cost3g*24.d0*rp2b
                    temp1022b1 = rmu(2, 0)*rmucos(2, 0)*temp1022b0
                    temp1022b2 = rmu(1, 0)*rmucos(1, 0)*temp1022b0
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1022b1
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1022b1
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1022b2
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1022b2
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp1021 = rmu(2, 0)*rmucos(2, 0)
                    temp1020 = rmu(1, 0)*rmucos(1, 0)
                    temp1020b6 = cost3g*24.d0*rp1b
                    temp1020b7 = rmu(3, 0)*rmucos(3, 0)*temp1020b6
                    temp1020b8 = temp1020*temp1021*temp1020b6
                    rmub(1, 0) = rmub(1, 0) + temp1021*rmucos(1, 0)*&
&                      temp1020b7
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1021*rmu(1, 0)*&
&                      temp1020b7
                    rmub(2, 0) = rmub(2, 0) + temp1020*rmucos(2, 0)*&
&                      temp1020b7
                    rmucosb(2, 0) = rmucosb(2, 0) + temp1020*rmu(2, 0)*&
&                      temp1020b7
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1020b8
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1020b8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    temp1024b = 2.d0*rmu(i, 0)*hess4fb(3)
                    funb = funb + rp1*temp1024b
                    rp1b = fun0*der4fb(2) + fun*temp1024b
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                    rp2b = fun0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                    temp1024b0 = cost4g*6.d0*rp2b
                    temp1024b1 = rmu(3, 0)*rmucos(3, 0)*temp1024b0
                    temp1024b2 = rmu(1, 0)*rmucos(1, 0)*temp1024b0
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1024b1
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1024b1
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1024b2
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1024b2
                    CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                    temp1022 = rmu(2, 0)*rmucos(2, 0)
                    temp1023 = rmu(1, 0)*rmucos(1, 0)
                    temp1024b3 = cost4g*3.d0*rp1b
                    temp1024b4 = rmu(3, 0)*rmucos(3, 0)*temp1024b3
                    temp1023b = 2*temp1023*temp1024b4
                    temp1022b3 = -(2*temp1022*temp1024b4)
                    temp1022b4 = (temp1023**2-temp1022**2)*temp1024b3
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1023b
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1023b
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1022b3
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1022b3
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1022b4
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1022b4
                  END IF
                ELSE IF (branch .LT. 17) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp1026b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp1026b
                  rp1b = fun0*der4fb(2) + fun*temp1026b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp1026b0 = -(cost4g*6.d0*rp2b)
                  temp1026b1 = rmu(3, 0)*rmucos(3, 0)*temp1026b0
                  temp1026b2 = rmu(1, 0)*rmucos(1, 0)*temp1026b0
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1026b1
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1026b1
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1026b2
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1026b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp1025 = rmu(2, 0)*rmucos(2, 0)
                  temp1024 = rmu(1, 0)*rmucos(1, 0)
                  temp1024b5 = -(cost4g*6.d0*rp1b)
                  temp1024b6 = rmu(3, 0)*rmucos(3, 0)*temp1024b5
                  temp1024b7 = temp1024*temp1025*temp1024b5
                  rmub(1, 0) = rmub(1, 0) + temp1025*rmucos(1, 0)*&
&                    temp1024b6
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1025*rmu(1, 0)*&
&                    temp1024b6
                  rmub(2, 0) = rmub(2, 0) + temp1024*rmucos(2, 0)*&
&                    temp1024b6
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1024*rmu(2, 0)*&
&                    temp1024b6
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1024b7
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1024b7
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp1026b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp1026b3
                  rp1b = fun0*der4fb(2) + fun*temp1026b3
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp1026b4 = cost4g*rp1b
                  temp1026b5 = 3*rmu(1, 0)**2*rmucos(1, 0)**2*temp1026b4
                  temp1026b6 = -(3.d0*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                    temp1026b4)
                  temp1026b7 = -(3.d0*rmu(1, 0)*rmucos(1, 0)*temp1026b4)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1026b6 + &
&                    rmucos(1, 0)*temp1026b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1026b6 +&
&                    rmu(1, 0)*temp1026b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                    temp1026b7
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)**2*2*rmucos(&
&                    2, 0)*temp1026b7
                END IF
              ELSE IF (branch .LT. 20) THEN
                IF (branch .LT. 19) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp1028b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp1028b
                  rp1b = fun0*der4fb(2) + fun*temp1028b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp1028b0 = cost4g*6.d0*rp2b
                  temp1028b1 = rmu(3, 0)*rmucos(3, 0)*temp1028b0
                  temp1028b2 = rmu(2, 0)*rmucos(2, 0)*temp1028b0
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1028b1
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1028b1
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1028b2
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1028b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp1027 = rmu(2, 0)*rmucos(2, 0)
                  temp1026 = rmu(1, 0)*rmucos(1, 0)
                  temp1026b8 = cost4g*6.d0*rp1b
                  temp1026b9 = rmu(3, 0)*rmucos(3, 0)*temp1026b8
                  temp1026b10 = temp1026*temp1027*temp1026b8
                  rmub(1, 0) = rmub(1, 0) + temp1027*rmucos(1, 0)*&
&                    temp1026b9
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1027*rmu(1, 0)*&
&                    temp1026b9
                  rmub(2, 0) = rmub(2, 0) + temp1026*rmucos(2, 0)*&
&                    temp1026b9
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1026*rmu(2, 0)*&
&                    temp1026b9
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1026b10
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1026b10
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp1030b = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp1030b
                  rp1b = fun0*der4fb(2) + fun*temp1030b
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp1030b0 = -(cost4g*6.d0*rp2b)
                  temp1030b1 = rmu(3, 0)*rmucos(3, 0)*temp1030b0
                  temp1030b2 = rmu(2, 0)*rmucos(2, 0)*temp1030b0
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1030b1
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1030b1
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1030b2
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1030b2
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp1028 = rmu(2, 0)*rmucos(2, 0)
                  temp1029 = rmu(1, 0)*rmucos(1, 0)
                  temp1030b3 = cost4g*3.d0*rp1b
                  temp1030b4 = rmu(3, 0)*rmucos(3, 0)*temp1030b3
                  temp1029b = 2*temp1029*temp1030b4
                  temp1028b3 = -(2*temp1028*temp1030b4)
                  temp1028b4 = (temp1029**2-temp1028**2)*temp1030b3
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1029b
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1029b
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1028b3
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1028b3
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1028b4
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1028b4
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp1030b5 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp1030b5
                rp1b = fun0*der4fb(2) + fun*temp1030b5
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp1030b6 = cost4g*rp1b
                temp1030b7 = 3.d0*rmu(2, 0)*rmucos(2, 0)*temp1030b6
                temp1030b8 = 3.d0*rmu(1, 0)**2*rmucos(1, 0)**2*&
&                  temp1030b6
                temp1030b9 = -(3*rmu(2, 0)**2*rmucos(2, 0)**2*temp1030b6&
&                  )
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0)*&
&                  temp1030b7
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(1&
&                  , 0)*temp1030b7
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1030b9 + &
&                  rmucos(2, 0)*temp1030b8
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1030b9 + &
&                  rmu(2, 0)*temp1030b8
              END IF
            ELSE IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                IF (branch .LT. 22) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  temp1030b10 = 2.d0*rmu(i, 0)*hess4fb(3)
                  funb = funb + rp1*temp1030b10
                  rp1b = fun0*der4fb(2) + fun*temp1030b10
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                  rp2b = fun0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                  temp1030b11 = cost5g*12.d0*rp2b
                  temp1030b12 = 2*rmu(1, 0)*rmucos(1, 0)*temp1030b11
                  temp1030b13 = -(2*rmu(2, 0)*rmucos(2, 0)*temp1030b11)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1030b12
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1030b12
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1030b13
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1030b13
                  CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                  temp1030b14 = cost5g*4.d0*rp1b
                  temp1030b15 = 3*rmu(1, 0)**2*rmucos(1, 0)**2*&
&                    temp1030b14
                  temp1030b16 = -(3.d0*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                    temp1030b14)
                  temp1030b17 = -(3.d0*rmu(1, 0)*rmucos(1, 0)*&
&                    temp1030b14)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1030b16 + &
&                    rmucos(1, 0)*temp1030b15
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1030b16 &
&                    + rmu(1, 0)*temp1030b15
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                    temp1030b17
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)**2*2*rmucos(&
&                    2, 0)*temp1030b17
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp1030b18 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp1030b18
                rp1b = fun0*der4fb(2) + fun*temp1030b18
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp1030b19 = cost5g*12.d0*rp2b
                temp1030b20 = 2*rmu(2, 0)*rmucos(2, 0)*temp1030b19
                temp1030b21 = -(2*rmu(1, 0)*rmucos(1, 0)*temp1030b19)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1030b20
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1030b20
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1030b21
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1030b21
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp1030b22 = cost5g*4.d0*rp1b
                temp1030b23 = 3*rmu(2, 0)**2*rmucos(2, 0)**2*temp1030b22
                temp1030b24 = -(3.d0*rmu(2, 0)*rmucos(2, 0)*temp1030b22)
                temp1030b25 = -(3.d0*rmu(1, 0)**2*rmucos(1, 0)**2*&
&                  temp1030b22)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1030b25 + &
&                  rmucos(2, 0)*temp1030b23
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1030b25 + &
&                  rmu(2, 0)*temp1030b23
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0)*&
&                  temp1030b24
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(1&
&                  , 0)*temp1030b24
              END IF
            ELSE IF (branch .LT. 26) THEN
              IF (branch .LT. 25) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                temp1030b26 = 2.d0*rmu(i, 0)*hess4fb(3)
                funb = funb + rp1*temp1030b26
                rp1b = fun0*der4fb(2) + fun*temp1030b26
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
                rp2b = fun0*hess4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                CALL POPREAL8(adr8ibuf,adr8buf,rp2)
                temp1030b27 = cost5g*24.d0*rp2b
                temp1030b28 = rmu(2, 0)*rmucos(2, 0)*temp1030b27
                temp1030b29 = rmu(1, 0)*rmucos(1, 0)*temp1030b27
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1030b28
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1030b28
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1030b29
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1030b29
                CALL POPREAL8(adr8ibuf,adr8buf,rp1)
                temp1030b30 = cost5g*4.d0*rp1b
                temp1030b31 = 3.d0*rmu(2, 0)*rmucos(2, 0)*temp1030b30
                temp1030b32 = 3.d0*rmu(1, 0)**2*rmucos(1, 0)**2*&
&                  temp1030b30
                temp1030b33 = -(3*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                  temp1030b30)
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0)*&
&                  temp1030b31
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(1&
&                  , 0)*temp1030b31
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1030b33 + &
&                  rmucos(2, 0)*temp1030b32
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1030b33 + &
&                  rmu(2, 0)*temp1030b32
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              temp1030b34 = 2.d0*rmu(i, 0)*hess4fb(3)
              funb = funb + rp1*temp1030b34
              rp1b = fun0*der4fb(2) + fun*temp1030b34
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*rp1*hess4fb(3)
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              fun0b = fun0b + rp1*der4fb(2) + rp2*hess4fb(2)
              rp2b = fun0*hess4fb(2)
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              CALL POPREAL8(adr8ibuf,adr8buf,rp2)
              temp1030b35 = -(cost5g*24.d0*rp2b)
              temp1030b36 = rmu(2, 0)*rmucos(2, 0)*temp1030b35
              temp1030b37 = rmu(1, 0)*rmucos(1, 0)*temp1030b35
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1030b36
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1030b36
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1030b37
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1030b37
              CALL POPREAL8(adr8ibuf,adr8buf,rp1)
              temp1030b38 = cost5g*4.d0*rp1b
              temp1030b39 = 3*rmu(1, 0)**2*rmucos(1, 0)**2*temp1030b38
              temp1030b40 = -(3.d0*rmu(2, 0)**2*rmucos(2, 0)**2*&
&                temp1030b38)
              temp1030b41 = -(3.d0*rmu(1, 0)*rmucos(1, 0)*temp1030b38)
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1030b40 + &
&                rmucos(1, 0)*temp1030b39
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1030b40 + &
&                rmu(1, 0)*temp1030b39
              rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                temp1030b41
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)**2*2*rmucos(2, 0&
&                )*temp1030b41
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
            hess4fb(3) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
            hess4fb(2) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
            der4fb(2) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp1008b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp1008b
            funb = funb + rmu(i, 0)*temp1008b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp1007 = r(0)**2
        temp1006 = fun2/temp1007
        temp1006b = rmu(i, 0)**2*radhess4fb(i)/temp1007
        temp1005 = r(0)**2
        temp1004 = rmu(i, 0)**2/temp1005
        temp1004b2 = -(fun*radhess4fb(i)/temp1005)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp1004b2 + temp1006*2*&
&          rmu(i, 0)*radhess4fb(i)
        fun2b = fun2b + temp1006b
        rb(0) = rb(0) - temp1004*2*r(0)*temp1004b2 - temp1006*2*r(0)*&
&          temp1006b
        funb = funb + (1.d0-temp1004)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp1004b = 2*rmu(1, 0)*rmucos(1, 0)*rp0b
      temp1004b0 = 2*rmu(2, 0)*rmucos(2, 0)*rp0b
      temp1004b1 = 2*rmu(3, 0)*rmucos(3, 0)*rp0b
      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1004b
      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1004b
      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1004b0
      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1004b0
      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1004b1
      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1004b1
      temp1003 = r(0)**4
      temp1003b = distp(0, 1)*fun2b
      temp1002 = 4.d0*dd1
      temp1001 = 11.d0/temp1002
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-15.d0/2.d0)*funb&
&        + (temp1001-r(0)**2)*fun0b + (21.d0*(dd1*r(0)**2)-15.d0/2.d0-&
&        4.d0*(dd1**2*temp1003))*fun2b
      temp1003b0 = distp(0, 1)*2.d0*funb
      dd1b = dd1b + r(0)**2*temp1003b0 - distp(0, 1)*temp1001*4.d0*fun0b&
&        /temp1002 + (21.d0*r(0)**2-4.d0*temp1003*2*dd1)*temp1003b
      rb(0) = rb(0) + dd1*2*r(0)*temp1003b0 - distp(0, 1)*2*r(0)*fun0b +&
&        (21.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp1003b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=9,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp1000 = 4.d0*dd1
          temp999 = 11.d0/temp1000
          temp999b = (temp999-r(k)**2)*zb(indorbp, k)
          temp998 = distp(k, 1+ic)
          temp997 = distp(k, 1)*cosphase(k)
          temp997b = temp997*temp998*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + temp998*cosphase(k)*temp999b
          cosphaseb(k) = cosphaseb(k) + temp998*distp(k, 1)*temp999b
          distpb(k, 1+ic) = distpb(k, 1+ic) + temp997*temp999b
          dd1b = dd1b - temp999*4.d0*temp997b/temp1000
          rb(k) = rb(k) - 2*r(k)*temp997b
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp996 = rmu(2, i)*rmucos(2, i)
      temp995 = rmu(1, i)*rmucos(1, i)
      temp995b = cost5g*4.d0*distpb(i, 10)
      temp995b0 = (rmu(1, i)**2*rmucos(1, i)**2-rmu(2, i)**2*rmucos(2, i&
&        )**2)*temp995b
      temp995b1 = temp995*temp996*temp995b
      rmub(1, i) = rmub(1, i) + rmucos(1, i)**2*2*rmu(1, i)*temp995b1 + &
&        temp996*rmucos(1, i)*temp995b0
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)**2*2*rmucos(1, i)*&
&        temp995b1 + temp996*rmu(1, i)*temp995b0
      rmub(2, i) = rmub(2, i) + temp995*rmucos(2, i)*temp995b0 - rmucos(&
&        2, i)**2*2*rmu(2, i)*temp995b1
      rmucosb(2, i) = rmucosb(2, i) + temp995*rmu(2, i)*temp995b0 - rmu(&
&        2, i)**2*2*rmucos(2, i)*temp995b1
      distpb(i, 10) = 0.0_8
      temp995b2 = cost5g*distpb(i, 9)
      temp995b3 = -(6.d0*rmu(2, i)**2*rmucos(2, i)**2*temp995b2)
      temp995b4 = -(6.d0*rmu(1, i)**2*rmucos(1, i)**2*temp995b2)
      rmub(1, i) = rmub(1, i) + rmucos(1, i)**2*2*rmu(1, i)*temp995b3 + &
&        rmucos(1, i)**4*4*rmu(1, i)**3*temp995b2
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)**2*2*rmucos(1, i)*&
&        temp995b3 + rmu(1, i)**4*4*rmucos(1, i)**3*temp995b2
      distpb(i, 9) = 0.0_8
      temp994 = rmu(3, i)*rmucos(3, i)
      temp993 = rmu(2, i)*rmucos(2, i)
      temp993b = cost4g*(3.d0*(rmu(1, i)**2*rmucos(1, i)**2)-rmu(2, i)**&
&        2*rmucos(2, i)**2)*distpb(i, 8)
      temp993b0 = cost4g*temp993*temp994*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + temp994*rmucos(2, i)*temp993b - rmucos(2&
&        , i)**2*2*rmu(2, i)*temp993b0 + rmucos(2, i)**4*4*rmu(2, i)**3*&
&        temp995b2 + rmucos(2, i)**2*2*rmu(2, i)*temp995b4
      rmucosb(2, i) = rmucosb(2, i) + temp994*rmu(2, i)*temp993b - rmu(2&
&        , i)**2*2*rmucos(2, i)*temp993b0 + rmu(2, i)**4*4*rmucos(2, i)**&
&        3*temp995b2 + rmu(2, i)**2*2*rmucos(2, i)*temp995b4
      rmub(3, i) = rmub(3, i) + temp993*rmucos(3, i)*temp993b
      rmucosb(3, i) = rmucosb(3, i) + temp993*rmu(3, i)*temp993b
      distpb(i, 8) = 0.0_8
      temp992 = rmu(3, i)*rmucos(3, i)
      temp991 = rmu(1, i)*rmucos(1, i)
      temp991b = cost4g*(rmu(1, i)**2*rmucos(1, i)**2-3.0*(rmu(2, i)**2*&
&        rmucos(2, i)**2))*distpb(i, 7)
      temp991b0 = cost4g*temp991*temp992*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + temp992*rmucos(1, i)*temp991b + rmucos(1&
&        , i)**2*2*rmu(1, i)*temp991b0 + 3.d0*rmucos(1, i)**2*2*rmu(1, i)&
&        *temp993b0
      rmucosb(1, i) = rmucosb(1, i) + temp992*rmu(1, i)*temp991b + rmu(1&
&        , i)**2*2*rmucos(1, i)*temp991b0 + 3.d0*rmu(1, i)**2*2*rmucos(1&
&        , i)*temp993b0
      rmub(3, i) = rmub(3, i) + temp991*rmucos(3, i)*temp991b
      rmucosb(3, i) = rmucosb(3, i) + temp991*rmu(3, i)*temp991b
      rmub(2, i) = rmub(2, i) - 3.0*rmucos(2, i)**2*2*rmu(2, i)*&
&        temp991b0
      rmucosb(2, i) = rmucosb(2, i) - 3.0*rmu(2, i)**2*2*rmucos(2, i)*&
&        temp991b0
      distpb(i, 7) = 0.0_8
      temp990 = rmu(2, i)*rmucos(2, i)
      temp989 = rmu(1, i)*rmucos(1, i)
      temp989b = cost3g*2.d0*distpb(i, 6)
      temp989b0 = (7.d0*(rmu(3, i)**2*rmucos(3, i)**2)-rp0)*temp989b
      temp989b1 = temp989*temp990*temp989b
      rmub(1, i) = rmub(1, i) + temp990*rmucos(1, i)*temp989b0
      rmucosb(1, i) = rmucosb(1, i) + temp990*rmu(1, i)*temp989b0
      rmub(2, i) = rmub(2, i) + temp989*rmucos(2, i)*temp989b0
      rmucosb(2, i) = rmucosb(2, i) + temp989*rmu(2, i)*temp989b0
      rmub(3, i) = rmub(3, i) + 7.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp989b1
      rmucosb(3, i) = rmucosb(3, i) + 7.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp989b1
      distpb(i, 6) = 0.0_8
      temp989b2 = cost3g*(7.d0*(rmu(3, i)**2*rmucos(3, i)**2)-rp0)*&
&        distpb(i, 5)
      temp989b3 = cost3g*(rmu(1, i)**2*rmucos(1, i)**2-rmu(2, i)**2*&
&        rmucos(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp988 = rmu(3, i)*rmucos(3, i)
      temp987 = rmu(2, i)*rmucos(2, i)
      temp987b = cost2g*(7.d0*(rmu(3, i)**2*rmucos(3, i)**2)-3.d0*rp0)*&
&        distpb(i, 4)
      temp987b0 = cost2g*temp987*temp988*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp986 = rmu(3, i)*rmucos(3, i)
      temp985 = rmu(1, i)*rmucos(1, i)
      temp985b = cost2g*(7.d0*(rmu(3, i)**2*rmucos(3, i)**2)-3.d0*rp0)*&
&        distpb(i, 3)
      temp985b0 = cost2g*temp985*temp986*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp985b1 = cost1g*distpb(i, 2)
      temp985b2 = -(30.d0*rmucos(3, i)**2*temp985b1)
      rp0b = 3.d0*2*rp0*temp985b1 - 3.d0*temp985b0 - temp989b3 + rmu(3, &
&        i)**2*temp985b2 - 3.d0*temp987b0 - temp989b1
      rmub(1, i) = rmub(1, i) + rmucos(1, i)**2*2*rmu(1, i)*temp989b2
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)**2*2*rmucos(1, i)*&
&        temp989b2
      rmub(2, i) = rmub(2, i) - rmucos(2, i)**2*2*rmu(2, i)*temp989b2
      rmucosb(2, i) = rmucosb(2, i) - rmu(2, i)**2*2*rmucos(2, i)*&
&        temp989b2
      rmub(3, i) = rmub(3, i) + 7.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp989b3
      rmucosb(3, i) = rmucosb(3, i) + 7.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp989b3
      rmub(2, i) = rmub(2, i) + temp988*rmucos(2, i)*temp987b
      rmucosb(2, i) = rmucosb(2, i) + temp988*rmu(2, i)*temp987b
      rmub(3, i) = rmub(3, i) + 7.d0*rmucos(3, i)**2*2*rmu(3, i)*&
&        temp987b0 + temp987*rmucos(3, i)*temp987b
      rmucosb(3, i) = rmucosb(3, i) + 7.d0*rmu(3, i)**2*2*rmucos(3, i)*&
&        temp987b0 + temp987*rmu(3, i)*temp987b
      rmub(1, i) = rmub(1, i) + temp986*rmucos(1, i)*temp985b
      rmucosb(1, i) = rmucosb(1, i) + temp986*rmu(1, i)*temp985b
      rmub(3, i) = rmub(3, i) + 35.d0*rmucos(3, i)**4*4*rmu(3, i)**3*&
&        temp985b1 + rp0*2*rmu(3, i)*temp985b2 + 7.d0*rmucos(3, i)**2*2*&
&        rmu(3, i)*temp985b0 + temp985*rmucos(3, i)*temp985b
      rmucosb(3, i) = rmucosb(3, i) + (35.d0*rmu(3, i)**4*4*rmucos(3, i)&
&        **3-30.d0*rmu(3, i)**2*rp0*2*rmucos(3, i))*temp985b1 + 7.d0*rmu(&
&        3, i)**2*2*rmucos(3, i)*temp985b0 + temp985*rmu(3, i)*temp985b
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp985b3 = 2*rmu(1, i)*rmucos(1, i)*rp0b
      temp985b4 = 2*rmu(2, i)*rmucos(2, i)*rp0b
      temp985b5 = 2*rmu(3, i)*rmucos(3, i)*rp0b
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp985b3
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp985b3
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp985b4
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp985b4
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp985b5
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp985b5
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp984 = r(k)**2
      temp984b4 = c*DEXP(-(dd1*temp984))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp984))*distpb(k, 1)
      dd1b = dd1b - temp984*temp984b4
      rb(k) = rb(k) - dd1*2*r(k)*temp984b4
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.11284691281640568826d0*2.75d0*dd1**1.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (53)
! g single gaussian orbital
! radial R(r)= exp(-alpha r^2)
! normalized
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
!         c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)
    c = dd1**2.75d0*1.11284691281640568826d0
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos with the minimal rmucos strategy
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(i)**2
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*rp0+&
&        3.d0*rp0**2)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-rp0)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos(&
&        2, i)*(7.d0*rmu(3, i)**2-rp0)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(rmu(1, i)**2-3.0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(3.d0*rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos&
&        (2, i)*(rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-4
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,9
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*distp(k, 1+ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(0)**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,9
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part ! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*12*rmu(1, 0)*rmucos(1, 0)*(-(5*rmu(3, &
&                  0)**2)+rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*12*(2*rmu(1, 0)**2*rmucos(1, 0)&
&                  **2-(rmucos(1, 0)**2-rmusin(1, 0)**2)*(5*rmu(3, 0)**2-&
&                  rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*12*rmu(2, 0)*rmucos(2, 0)*(-(5*rmu(3, &
&                  0)**2)+rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*12*(2*rmu(2, 0)**2*rmucos(2, 0)&
&                  **2-(rmucos(2, 0)**2-rmusin(2, 0)**2)*(5*rmu(3, 0)**2-&
&                  rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*16*rmu(3, 0)*rmucos(3, 0)*(5*rmu(3, 0)&
&                  **2-3*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*16*(rmu(3, 0)**2*(9*rmucos(3, 0)&
&                  **2-5*rmusin(3, 0)**2)+3*(-(rmucos(3, 0)**2)+rmusin(3&
&                  , 0)**2)*rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(3, 0)*rmucos(3, 0)*(-(6*rmu(1, 0)&
&                  **2*rmucos(1, 0)**2)+(rmucos(1, 0)**2-rmusin(1, 0)**2)&
&                  *(7*rmu(3, 0)**2-3*rp0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*(-(2*rmu(3, 0)*rmucos(1, 0)*&
&                  rmucos(3, 0)*(9*rmu(1, 0)*(rmucos(1, 0)**2-rmusin(1, 0&
&                  )**2)+2*pi/cellscale(1)*rmusin(1, 0)*(7*rmu(3, 0)**2-3&
&                  *rp0))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost2g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*6*rmu(1, 0)*rmu(3, 0)*rmucos(1, &
&                  0)*rmucos(3, 0)*(-(rmucos(2, 0)**2)+rmusin(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(1, 0)*rmucos(1, 0)*(rmu(3, 0)**2*(&
&                  15*rmucos(3, 0)**2-7*rmusin(3, 0)**2)+3*(-(rmucos(3, 0&
&                  )**2)+rmusin(3, 0)**2)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*4*rmu(1, 0)*rmucos(1, 0)*rmucos(&
&                  3, 0)*(rmu(3, 0)*(6*rmucos(3, 0)**2-13*rmusin(3, 0)**2&
&                  )+3*pi/cellscale(3)*rmusin(3, 0)*rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost2g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*6*rmu(2, 0)*rmu(3, 0)*rmucos(2, &
&                  0)*rmucos(3, 0)*(-(rmucos(1, 0)**2)+rmusin(1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(3, 0)*rmucos(3, 0)*(-(6*rmu(2, 0)&
&                  **2*rmucos(2, 0)**2)+(rmucos(2, 0)**2-rmusin(2, 0)**2)&
&                  *(7*rmu(3, 0)**2-3*rp0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*(-(2*rmu(3, 0)*rmucos(2, 0)*&
&                  rmucos(3, 0)*(9*rmu(2, 0)*(rmucos(2, 0)**2-rmusin(2, 0&
&                  )**2)+2*pi/cellscale(2)*rmusin(2, 0)*(7*rmu(3, 0)**2-3&
&                  *rp0))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(2, 0)*rmucos(2, 0)*(rmu(3, 0)**2*(&
&                  15*rmucos(3, 0)**2-7*rmusin(3, 0)**2)+3*(-(rmucos(3, 0&
&                  )**2)+rmusin(3, 0)**2)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*(4*rmu(2, 0)*rmucos(2, 0)*rmucos&
&                  (3, 0)*(rmu(3, 0)*(6*rmucos(3, 0)**2-13*rmusin(3, 0)**&
&                  2)+3*pi/cellscale(3)*rmusin(3, 0)*rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost3g*4*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(3, 0&
&                  )**2)*rmucos(1, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4*fun0*cost3g*(rmu(1, 0)**2*(3*rmucos(1, 0&
&                  )**2-rmusin(1, 0)**2)+3*rmu(3, 0)**2*(-(rmucos(1, 0)**&
&                  2)+rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*4*rmu(2, 0)*(rmu(2, 0)**2-3*rmu(3, 0)&
&                  **2)*rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 4*fun0*cost3g*(rmu(2, 0)**2*(3*rmucos(2, 0)&
&                  **2-rmusin(2, 0)**2)+3*rmu(3, 0)**2*(-(rmucos(2, 0)**2&
&                  )+rmusin(2, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*12*(rmu(1, 0)**2-rmu(2, 0)**2)*rmu(3, &
&                  0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost3g*12*(rmu(1, 0)**2-rmu(2, 0)**2)*(&
&                  rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2*cost3g*rmu(2, 0)*rmucos(2, 0)*((rmu(2, 0)&
&                  **2-6*rmu(3, 0)**2)*(rmucos(1, 0)**2-rmusin(1, 0)**2)+&
&                  rmu(1, 0)**2*(3*rmucos(1, 0)**2-rmusin(1, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost3g*fun0*(4*rmu(2, 0)*rmucos(1, 0)*rmucos&
&                  (2, 0)*(2*(rmu(2, 0)**2-6*rmu(3, 0)**2)*rmusin(1, 0)*&
&                  pi/cellscale(1)+rmu(1, 0)*(-(3*rmucos(1, 0)**2)+5*&
&                  rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2*cost3g*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)&
&                  **2*(rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(3*&
&                  rmucos(2, 0)**2-rmusin(2, 0)**2)+6*rmu(3, 0)**2*(-(&
&                  rmucos(2, 0)**2)+rmusin(2, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost3g*fun0*(4*rmu(1, 0)*rmucos(1, 0)*rmucos&
&                  (2, 0)*(2*(rmu(1, 0)**2-6*rmu(3, 0)**2)*rmusin(2, 0)*&
&                  pi/cellscale(2)+rmu(2, 0)*(-(3*rmucos(2, 0)**2)+5*&
&                  rmusin(2, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*24*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost3g*24*rmu(1, 0)*rmu(2, 0)*rmucos(1&
&                  , 0)*rmucos(2, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(3, 0)*rmucos(3, 0)*(rmu(1, 0)**2*(&
&                  3*rmucos(1, 0)**2-rmusin(1, 0)**2)+3*rmu(2, 0)**2*(-(&
&                  rmucos(1, 0)**2)+rmusin(1, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*(2*rmu(3, 0)*rmucos(1, 0)*rmucos&
&                  (3, 0)*(6*rmu(2, 0)**2*rmusin(1, 0)*pi/cellscale(1)+&
&                  rmu(1, 0)*(3*rmucos(1, 0)**2-5*rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6*cost4g*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 6*cost4g*fun0*rmu(1, 0)*rmu(3, 0)*rmucos(1, &
&                  0)*rmucos(3, 0)*(-(rmucos(2, 0)**2)+rmusin(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(2, 0)**2&
&                  )*rmucos(1, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost4g*(-(4*rmu(1, 0)*(rmu(1, 0)**2-3*&
&                  rmu(2, 0)**2)*rmucos(1, 0)*rmucos(3, 0)*rmusin(3, 0)*&
&                  pi/cellscale(3)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
              END IF
            ELSE IF (ic .EQ. 7) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*rmucos&
&                  (1, 0)*rmucos(2, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*6*rmu(2, 0)*rmu(3, 0)*rmucos(2, &
&                  0)*rmucos(3, 0)*(rmucos(1, 0)**2-rmusin(1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(3, 0)*rmucos(3, 0)*(3*rmu(1, 0)**2&
&                  *(rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*&
&                  rmucos(2, 0)**2)+rmusin(2, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*(-(2*rmu(3, 0)*rmucos(2, 0)*&
&                  rmucos(3, 0)*(6*rmu(1, 0)**2*rmusin(2, 0)*pi/cellscale&
&                  (2)+rmu(2, 0)*(3*rmucos(2, 0)**2-5*rmusin(2, 0)**2))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost4g*(rmu(2, 0)*(-(3*rmu(1, 0)**2)+rmu(2&
&                  , 0)**2)*rmucos(2, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2&
&                  )))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost4g*(4*rmu(2, 0)*(-(3*rmu(1, 0)**2)+&
&                  rmu(2, 0)**2)*rmucos(2, 0)*rmucos(3, 0)*rmusin(3, 0)*&
&                  pi/cellscale(3))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
              END IF
            ELSE IF (ic .EQ. 8) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost5g*4*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(2, 0)&
&                  **2)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost5g*fun0*4*(rmu(1, 0)**2*(3*rmucos(1, 0)&
&                  **2-rmusin(1, 0)**2)+3*rmu(2, 0)**2*(-(rmucos(1, 0)**2&
&                  )+rmusin(1, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost5g*4*rmu(2, 0)*(-(3*rmu(1, 0)**2)+rmu(2, &
&                  0)**2)*rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4*cost5g*fun0*(3*rmu(1, 0)**2*(rmucos(2, 0&
&                  )**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*rmucos(2, 0)**&
&                  2)+rmusin(2, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,29)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,30)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost5g*4*rmu(2, 0)*rmucos(2, 0)*(rmu(1, 0)**2*(&
&                3*rmucos(1, 0)**2-rmusin(1, 0)**2)+rmu(2, 0)**2*(-(&
&                rmucos(1, 0)**2)+rmusin(1, 0)**2))
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = cost5g*fun0*(8*rmu(2, 0)*rmucos(1, 0)*rmucos(2&
&                , 0)*(2*rmu(2, 0)**2*rmusin(1, 0)*pi/cellscale(1)+rmu(1&
&                , 0)*(3*rmucos(1, 0)**2-5*rmusin(1, 0)**2)))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,31)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost5g*4*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)**2*(&
&                rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*&
&                rmucos(2, 0)**2)+rmusin(2, 0)**2))
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = cost5g*fun0*(-(8*rmu(1, 0)*rmucos(1, 0)*rmucos&
&                (2, 0)*(2*rmu(1, 0)**2*rmusin(2, 0)*pi/cellscale(2)+rmu(&
&                2, 0)*(3*rmucos(2, 0)**2-5*rmusin(2, 0)**2))))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,32)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,33)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*distp(0, 1+ic)*&
&              cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*distp(0, 1+ic)*sinphase(i, 0)*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=9,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp1188b = -(distp(0, 1)*rphase(i)*zb(indorbp, indt+i))
            temp1188b0 = -(distp(0, 1+ic)*sinphase(i, 0)*zb(indorbp, &
&              indt+i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1188b1 = -(distp(0, 1+ic)*rphase(i)**2*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + distp(0&
&              , 1)*temp1188b1 + z(indorbp, indt+i)*zb(indorbp, indt+i)
            distpb(0, 1+ic) = distpb(0, 1+ic) + sinphase(i, 0)*temp1188b
            temp1188b2 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp1188b2 + &
&              distp(0, 1+ic)*temp1188b
            distpb(0, 1) = distpb(0, 1) + cosphase(0)*temp1188b1 + &
&              rphase(i)*temp1188b0
            temp1188b3 = -(distp(0, 1)*cosphase(0)*hess4fb(1))
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp1188b2 + distp(&
&              0, 1+ic)*2*rphase(i)*temp1188b3 + distp(0, 1)*temp1188b0
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + rphase(i)**2*temp1188b3
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1187 = der4f(1)/cellscale(i)
            temp1187b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp1187*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp1187b
            cellscaleb(i) = cellscaleb(i) - temp1187*temp1187b
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 17) THEN
              IF (branch .LT. 9) THEN
                IF (branch .LT. 5) THEN
                  IF (branch .LT. 3) THEN
                    IF (branch .LT. 2) THEN
                      IF (branch .LT. 1) THEN
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                        temp1059 = 5*rmu(3, 0)**2 - rp0
                        temp1058 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                        temp1058b0 = cost1g*12*hess4fb(2)
                        temp1058b1 = fun0*temp1058b0
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        fun0b = fun0b + der4f(2)*der4fb(2) + (2*(rmu(1, &
&                          0)**2*rmucos(1, 0)**2)-temp1058*temp1059)*&
&                          temp1058b0
                        rmub(1, 0) = rmub(1, 0) + 2**2*rmucos(1, 0)**2*&
&                          rmu(1, 0)*temp1058b1
                        hess4fb(2) = 0.0_8
                        temp1058b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                        der4fb(2) = fun*temp1058b2 + fun0*der4fb(2)
                        temp1058b3 = cost1g*12*der4fb(2)
                        temp1058b4 = (rp0-5*rmu(3, 0)**2)*temp1058b3
                        rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                          temp1058b4 + (2**2*rmu(1, 0)**2*rmucos(1, 0)-&
&                          temp1059*2*rmucos(1, 0))*temp1058b1
                        rmusinb(1, 0) = rmusinb(1, 0) + temp1059*2*&
&                          rmusin(1, 0)*temp1058b1
                        rmub(3, 0) = rmub(3, 0) - temp1058*5*2*rmu(3, 0)&
&                          *temp1058b1
                        temp1058b5 = rmu(1, 0)*rmucos(1, 0)*temp1058b3
                        rp0b = rp0b + temp1058b5 + temp1058*temp1058b1
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                        rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                          hess4fb(3)
                        funb = funb + der4f(2)*temp1058b2
                        hess4fb(3) = 0.0_8
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*&
&                          temp1058b4
                        rmub(3, 0) = rmub(3, 0) - 5*2*rmu(3, 0)*&
&                          temp1058b5
                        der4fb(2) = 0.0_8
                      ELSE
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                        temp1061 = 5*rmu(3, 0)**2 - rp0
                        temp1060 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                        temp1060b = cost1g*12*hess4fb(2)
                        temp1060b0 = fun0*temp1060b
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        fun0b = fun0b + der4f(2)*der4fb(2) + (2*(rmu(2, &
&                          0)**2*rmucos(2, 0)**2)-temp1060*temp1061)*&
&                          temp1060b
                        rmub(2, 0) = rmub(2, 0) + 2**2*rmucos(2, 0)**2*&
&                          rmu(2, 0)*temp1060b0
                        hess4fb(2) = 0.0_8
                        temp1060b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                        der4fb(2) = fun*temp1060b1 + fun0*der4fb(2)
                        temp1060b2 = cost1g*12*der4fb(2)
                        temp1060b3 = (rp0-5*rmu(3, 0)**2)*temp1060b2
                        rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                          temp1060b3 + (2**2*rmu(2, 0)**2*rmucos(2, 0)-&
&                          temp1061*2*rmucos(2, 0))*temp1060b0
                        rmusinb(2, 0) = rmusinb(2, 0) + temp1061*2*&
&                          rmusin(2, 0)*temp1060b0
                        rmub(3, 0) = rmub(3, 0) - temp1060*5*2*rmu(3, 0)&
&                          *temp1060b0
                        temp1060b4 = rmu(2, 0)*rmucos(2, 0)*temp1060b2
                        rp0b = rp0b + temp1060b4 + temp1060*temp1060b0
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                        rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                          hess4fb(3)
                        funb = funb + der4f(2)*temp1060b1
                        hess4fb(3) = 0.0_8
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*&
&                          temp1060b3
                        rmub(3, 0) = rmub(3, 0) - 5*2*rmu(3, 0)*&
&                          temp1060b4
                        der4fb(2) = 0.0_8
                      END IF
                    END IF
                  ELSE IF (branch .LT. 4) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1062 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                    temp1064 = 9*rmucos(3, 0)**2 - 5*rmusin(3, 0)**2
                    temp1063 = rmu(3, 0)**2
                    temp1063b = cost1g*16*hess4fb(2)
                    temp1063b0 = fun0*temp1063b
                    temp1062b = 3*rp0*temp1063b0
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (temp1063*&
&                      temp1064+3*(temp1062*rp0))*temp1063b
                    rmub(3, 0) = rmub(3, 0) + temp1064*2*rmu(3, 0)*&
&                      temp1063b0
                    hess4fb(2) = 0.0_8
                    temp1062b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1062b0 + fun0*der4fb(2)
                    temp1062b1 = cost1g*16*der4fb(2)
                    temp1062b2 = (5*rmu(3, 0)**2-3*rp0)*temp1062b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1062b2&
&                      - 2*rmucos(3, 0)*temp1062b + temp1063*9*2*rmucos(3&
&                      , 0)*temp1063b0
                    rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                      temp1062b - temp1063*5*2*rmusin(3, 0)*temp1063b0
                    temp1062b3 = rmu(3, 0)*rmucos(3, 0)*temp1062b1
                    rp0b = rp0b + 3*temp1062*temp1063b0 - 3*temp1062b3
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1062b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5*2*rmu(3, 0)*temp1062b3 +&
&                      rmucos(3, 0)*temp1062b2
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1071 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1067 = rmusin(1, 0)/cellscale(1)
                    temp1068 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                    temp1070 = rmucos(1, 0)*rmucos(3, 0)
                    temp1069 = fun0*rmu(3, 0)
                    temp1069b = -(cost2g*2*hess4fb(2))
                    temp1069b0 = (9*(rmu(1, 0)*temp1068)+pi*2*(temp1067*&
&                      temp1071))*temp1069b
                    temp1069b1 = temp1069*temp1070*temp1069b
                    temp1068b = 9*rmu(1, 0)*temp1069b1
                    temp1068b0 = pi*2*temp1069b1
                    temp1067b = temp1071*temp1068b0/cellscale(1)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp1070*rmu(3&
&                      , 0)*temp1069b0
                    rmub(3, 0) = rmub(3, 0) + temp1067*7*2*rmu(3, 0)*&
&                      temp1068b0 + temp1070*fun0*temp1069b0
                    rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*&
&                      temp1068b + temp1069*rmucos(3, 0)*temp1069b0
                    hess4fb(2) = 0.0_8
                    temp1067b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1067b0 + fun0*der4fb(2)
                    temp1066 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1065 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                    temp1065b = cost2g*(temp1065*temp1066-6*(rmu(1, 0)**&
&                      2*rmucos(1, 0)**2))*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1065b &
&                      + temp1069*rmucos(1, 0)*temp1069b0
                    rmub(1, 0) = rmub(1, 0) + 9*temp1068*temp1069b1
                    temp1065b0 = cost2g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                    rmusinb(1, 0) = rmusinb(1, 0) + temp1067b - temp1066&
&                      *2*rmusin(1, 0)*temp1065b0 - 2*rmusin(1, 0)*&
&                      temp1068b
                    cellscaleb(1) = cellscaleb(1) - temp1067*temp1067b
                    rp0b = rp0b - temp1065*3*temp1065b0 - temp1067*3*&
&                      temp1068b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1067b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + temp1065*7*2*rmu(3, 0)*&
&                      temp1065b0 + rmucos(3, 0)*temp1065b
                    rmucosb(1, 0) = rmucosb(1, 0) + (temp1066*2*rmucos(1&
&                      , 0)-6*rmu(1, 0)**2*2*rmucos(1, 0))*temp1065b0
                    rmub(1, 0) = rmub(1, 0) - 6*rmucos(1, 0)**2*2*rmu(1&
&                      , 0)*temp1065b0
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 7) THEN
                  IF (branch .LT. 6) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1075 = rmu(3, 0)*rmucos(1, 0)
                    temp1074 = fun0*rmu(1, 0)*rmucos(3, 0)
                    temp1075b = cost2g*6*hess4fb(2)
                    temp1075b0 = (rmusin(2, 0)**2-rmucos(2, 0)**2)*&
&                      temp1075b
                    temp1074b = temp1075*temp1075b0
                    temp1074b0 = temp1074*temp1075*temp1075b
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(1, 0)*temp1074b
                    rmub(1, 0) = rmub(1, 0) + rmucos(3, 0)*fun0*&
&                      temp1074b
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                      temp1074b
                    rmub(3, 0) = rmub(3, 0) + temp1074*rmucos(1, 0)*&
&                      temp1075b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1074*rmu(3, 0)*&
&                      temp1075b0
                    rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                      temp1074b0
                    rmucosb(2, 0) = rmucosb(2, 0) - 2*rmucos(2, 0)*&
&                      temp1074b0
                    hess4fb(2) = 0.0_8
                    temp1074b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1074b1 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1074b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1073 = rmu(3, 0)*rmucos(1, 0)
                    temp1072 = rmu(1, 0)*rmu(2, 0)
                    temp1072b = -(cost2g*6*der4fb(2))
                    temp1072b0 = rmucos(2, 0)*rmucos(3, 0)*temp1072b
                    temp1072b1 = temp1072*temp1073*temp1072b
                    rmub(1, 0) = rmub(1, 0) + temp1073*rmu(2, 0)*&
&                      temp1072b0
                    rmub(2, 0) = rmub(2, 0) + temp1073*rmu(1, 0)*&
&                      temp1072b0
                    rmub(3, 0) = rmub(3, 0) + temp1072*rmucos(1, 0)*&
&                      temp1072b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1072*rmu(3, 0)*&
&                      temp1072b0
                    rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                      temp1072b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                      temp1072b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 8) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1079 = rp0/cellscale(3)
                  temp1082 = 6*rmucos(3, 0)**2 - 13*rmusin(3, 0)**2
                  temp1081 = rmucos(1, 0)*rmucos(3, 0)
                  temp1080 = fun0*rmu(1, 0)
                  temp1080b = cost2g*4*hess4fb(2)
                  temp1080b0 = (rmu(3, 0)*temp1082+pi*3*(rmusin(3, 0)*&
&                    temp1079))*temp1080b
                  temp1080b1 = temp1080*temp1081*temp1080b
                  temp1080b2 = pi*3*temp1080b1
                  temp1079b = rmusin(3, 0)*temp1080b2/cellscale(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1081*rmu(1, 0&
&                    )*temp1080b0
                  rmub(1, 0) = rmub(1, 0) + temp1081*fun0*temp1080b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1080*rmucos(3, 0)*&
&                    temp1080b0
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*6*2*rmucos(3&
&                    , 0)*temp1080b1 + temp1080*rmucos(1, 0)*temp1080b0
                  rmub(3, 0) = rmub(3, 0) + temp1082*temp1080b1
                  hess4fb(2) = 0.0_8
                  temp1079b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1079b0 + fun0*der4fb(2)
                  temp1077 = rmu(3, 0)**2
                  temp1077b = cost2g*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
                  temp1076b = 3*rp0*temp1077b
                  rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                    temp1076b - temp1077*7*2*rmusin(3, 0)*temp1077b + &
&                    temp1079*temp1080b2 - rmu(3, 0)*13*2*rmusin(3, 0)*&
&                    temp1080b1
                  temp1076 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                  rp0b = rp0b + 3*temp1076*temp1077b + temp1079b
                  cellscaleb(3) = cellscaleb(3) - temp1079*temp1079b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1079b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1078 = 15*rmucos(3, 0)**2 - 7*rmusin(3, 0)**2
                  temp1077b0 = cost2g*(temp1077*temp1078+3*(temp1076*rp0&
&                    ))*der4fb(2)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1077b0
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1077b0
                  rmub(3, 0) = rmub(3, 0) + temp1078*2*rmu(3, 0)*&
&                    temp1077b
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1077*15*2*rmucos(3&
&                    , 0)*temp1077b - 2*rmucos(3, 0)*temp1076b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1086 = rmu(3, 0)*rmucos(2, 0)
                  temp1085 = fun0*rmu(2, 0)*rmucos(3, 0)
                  temp1086b = cost2g*6*hess4fb(2)
                  temp1086b0 = (rmusin(1, 0)**2-rmucos(1, 0)**2)*&
&                    temp1086b
                  temp1085b = temp1086*temp1086b0
                  temp1085b0 = temp1085*temp1086*temp1086b
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(&
&                    2, 0)*temp1085b
                  rmub(2, 0) = rmub(2, 0) + rmucos(3, 0)*fun0*temp1085b
                  rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*&
&                    temp1085b
                  rmub(3, 0) = rmub(3, 0) + temp1085*rmucos(2, 0)*&
&                    temp1086b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1085*rmu(3, 0)*&
&                    temp1086b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1085b0
                  hess4fb(2) = 0.0_8
                  temp1085b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1085b1 + fun0*der4fb(2)
                  temp1083 = rmu(1, 0)*rmu(2, 0)
                  temp1083b = -(cost2g*6*der4fb(2))
                  temp1083b0 = rmucos(2, 0)*rmucos(3, 0)*temp1083b
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1083*rmu(3, 0)*&
&                    temp1083b0 - 2*rmucos(1, 0)*temp1085b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1085b1
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1084 = rmu(3, 0)*rmucos(1, 0)
                  temp1083b1 = temp1083*temp1084*temp1083b
                  rmub(1, 0) = rmub(1, 0) + temp1084*rmu(2, 0)*&
&                    temp1083b0
                  rmub(2, 0) = rmub(2, 0) + temp1084*rmu(1, 0)*&
&                    temp1083b0
                  rmub(3, 0) = rmub(3, 0) + temp1083*rmucos(1, 0)*&
&                    temp1083b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                    temp1083b1
                  rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                    temp1083b1
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 13) THEN
                IF (branch .LT. 11) THEN
                  IF (branch .LT. 10) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1093 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1089 = rmusin(2, 0)/cellscale(2)
                    temp1090 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                    temp1092 = rmucos(2, 0)*rmucos(3, 0)
                    temp1091 = fun0*rmu(3, 0)
                    temp1091b = -(cost2g*2*hess4fb(2))
                    temp1091b0 = (9*(rmu(2, 0)*temp1090)+pi*2*(temp1089*&
&                      temp1093))*temp1091b
                    temp1091b1 = temp1091*temp1092*temp1091b
                    temp1090b = 9*rmu(2, 0)*temp1091b1
                    temp1090b0 = pi*2*temp1091b1
                    temp1089b = temp1093*temp1090b0/cellscale(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp1092*rmu(3&
&                      , 0)*temp1091b0
                    rmub(3, 0) = rmub(3, 0) + temp1089*7*2*rmu(3, 0)*&
&                      temp1090b0 + temp1092*fun0*temp1091b0
                    rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*&
&                      temp1090b + temp1091*rmucos(3, 0)*temp1091b0
                    hess4fb(2) = 0.0_8
                    temp1089b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1089b0 + fun0*der4fb(2)
                    temp1088 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1087 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                    temp1087b = cost2g*(temp1087*temp1088-6*(rmu(2, 0)**&
&                      2*rmucos(2, 0)**2))*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1087b &
&                      + temp1091*rmucos(2, 0)*temp1091b0
                    rmub(2, 0) = rmub(2, 0) + 9*temp1090*temp1091b1
                    temp1087b0 = cost2g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                    rmusinb(2, 0) = rmusinb(2, 0) + temp1089b - temp1088&
&                      *2*rmusin(2, 0)*temp1087b0 - 2*rmusin(2, 0)*&
&                      temp1090b
                    cellscaleb(2) = cellscaleb(2) - temp1089*temp1089b
                    rp0b = rp0b - temp1087*3*temp1087b0 - temp1089*3*&
&                      temp1090b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1089b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + temp1087*7*2*rmu(3, 0)*&
&                      temp1087b0 + rmucos(3, 0)*temp1087b
                    rmucosb(2, 0) = rmucosb(2, 0) + (temp1088*2*rmucos(2&
&                      , 0)-6*rmu(2, 0)**2*2*rmucos(2, 0))*temp1087b0
                    rmub(2, 0) = rmub(2, 0) - 6*rmucos(2, 0)**2*2*rmu(2&
&                      , 0)*temp1087b0
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 12) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1097 = rp0/cellscale(3)
                  temp1100 = 6*rmucos(3, 0)**2 - 13*rmusin(3, 0)**2
                  temp1099 = rmucos(2, 0)*rmucos(3, 0)
                  temp1098 = fun0*rmu(2, 0)
                  temp1098b = cost2g*4*hess4fb(2)
                  temp1098b0 = (rmu(3, 0)*temp1100+pi*3*(rmusin(3, 0)*&
&                    temp1097))*temp1098b
                  temp1098b1 = temp1098*temp1099*temp1098b
                  temp1098b2 = pi*3*temp1098b1
                  temp1097b = rmusin(3, 0)*temp1098b2/cellscale(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1099*rmu(2, 0&
&                    )*temp1098b0
                  rmub(2, 0) = rmub(2, 0) + temp1099*fun0*temp1098b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1098*rmucos(3, 0)*&
&                    temp1098b0
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*6*2*rmucos(3&
&                    , 0)*temp1098b1 + temp1098*rmucos(2, 0)*temp1098b0
                  rmub(3, 0) = rmub(3, 0) + temp1100*temp1098b1
                  hess4fb(2) = 0.0_8
                  temp1097b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1097b0 + fun0*der4fb(2)
                  temp1095 = rmu(3, 0)**2
                  temp1095b = cost2g*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                  temp1094b = 3*rp0*temp1095b
                  rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                    temp1094b - temp1095*7*2*rmusin(3, 0)*temp1095b + &
&                    temp1097*temp1098b2 - rmu(3, 0)*13*2*rmusin(3, 0)*&
&                    temp1098b1
                  temp1094 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                  rp0b = rp0b + 3*temp1094*temp1095b + temp1097b
                  cellscaleb(3) = cellscaleb(3) - temp1097*temp1097b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1097b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1096 = 15*rmucos(3, 0)**2 - 7*rmusin(3, 0)**2
                  temp1095b0 = cost2g*(temp1095*temp1096+3*(temp1094*rp0&
&                    ))*der4fb(2)
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1095b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1095b0
                  rmub(3, 0) = rmub(3, 0) + temp1096*2*rmu(3, 0)*&
&                    temp1095b
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1095*15*2*rmucos(3&
&                    , 0)*temp1095b - 2*rmucos(3, 0)*temp1094b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1101 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                  temp1103 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                  temp1102 = rmu(1, 0)**2
                  temp1102b = -(cost3g*4*hess4fb(2))
                  temp1102b0 = fun0*temp1102b
                  temp1101b = 3*rmu(3, 0)**2*temp1102b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (temp1102*&
&                    temp1103+3*(rmu(3, 0)**2*temp1101))*temp1102b
                  rmub(1, 0) = rmub(1, 0) + temp1103*2*rmu(1, 0)*&
&                    temp1102b0
                  hess4fb(2) = 0.0_8
                  temp1101b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1101b0 + fun0*der4fb(2)
                  temp1101b1 = -(cost3g*4*der4fb(2))
                  temp1101b2 = (rmu(1, 0)**2-3*rmu(3, 0)**2)*temp1101b1
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1101b2 -&
&                    2*rmucos(1, 0)*temp1101b + temp1102*3*2*rmucos(1, 0)&
&                    *temp1102b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1101b - temp1102*2*rmusin(1, 0)*temp1102b0
                  rmub(3, 0) = rmub(3, 0) + 3*temp1101*2*rmu(3, 0)*&
&                    temp1102b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1101b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1101b3 = rmu(1, 0)*rmucos(1, 0)*temp1101b1
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1101b2 + 2*&
&                    rmu(1, 0)*temp1101b3
                  rmub(3, 0) = rmub(3, 0) - 3*2*rmu(3, 0)*temp1101b3
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1104 = rmusin(2, 0)**2 - rmucos(2, 0)**2
                  temp1106 = 3*rmucos(2, 0)**2 - rmusin(2, 0)**2
                  temp1105 = rmu(2, 0)**2
                  temp1105b = cost3g*4*hess4fb(2)
                  temp1105b0 = fun0*temp1105b
                  temp1104b = 3*rmu(3, 0)**2*temp1105b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (temp1105*&
&                    temp1106+3*(rmu(3, 0)**2*temp1104))*temp1105b
                  rmub(2, 0) = rmub(2, 0) + temp1106*2*rmu(2, 0)*&
&                    temp1105b0
                  hess4fb(2) = 0.0_8
                  temp1104b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1104b0 + fun0*der4fb(2)
                  temp1104b1 = cost3g*4*der4fb(2)
                  temp1104b2 = (rmu(2, 0)**2-3*rmu(3, 0)**2)*temp1104b1
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1104b2 -&
&                    2*rmucos(2, 0)*temp1104b + temp1105*3*2*rmucos(2, 0)&
&                    *temp1105b0
                  rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                    temp1104b - temp1105*2*rmusin(2, 0)*temp1105b0
                  rmub(3, 0) = rmub(3, 0) + 3*temp1104*2*rmu(3, 0)*&
&                    temp1105b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1104b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1104b3 = rmu(2, 0)*rmucos(2, 0)*temp1104b1
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1104b2 + 2*&
&                    rmu(2, 0)*temp1104b3
                  rmub(3, 0) = rmub(3, 0) - 3*2*rmu(3, 0)*temp1104b3
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 16) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1107 = rmu(1, 0)**2 - rmu(2, 0)**2
                temp1107b = cost3g*12*hess4fb(2)
                temp1107b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp1107b
                temp1107b1 = fun0*temp1107*temp1107b
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1107*temp1107b0
                rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp1107b0
                rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp1107b0
                hess4fb(2) = 0.0_8
                temp1107b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1107b2 + fun0*der4fb(2)
                temp1107b3 = cost3g*12*der4fb(2)
                temp1107b4 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp1107b3
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1107b4 + 2&
&                  *rmucos(3, 0)*temp1107b1
                rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*&
&                  temp1107b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1107b2
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1107b5 = rmu(3, 0)*rmucos(3, 0)*temp1107b3
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp1107b5
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp1107b5
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1107b4
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1116 = 5*rmusin(1, 0)**2 - 3*rmucos(1, 0)**2
                temp1112 = rmusin(1, 0)/cellscale(1)
                temp1115 = rmu(2, 0)**2 - 6*rmu(3, 0)**2
                temp1114 = rmucos(1, 0)*rmucos(2, 0)
                temp1113 = fun0*rmu(2, 0)
                temp1113b = cost3g*4*hess4fb(2)
                temp1113b0 = (pi*2*(temp1115*temp1112)+rmu(1, 0)*&
&                  temp1116)*temp1113b
                temp1113b1 = temp1113*temp1114*temp1113b
                temp1113b2 = pi*2*temp1113b1
                temp1112b = temp1115*temp1113b2/cellscale(1)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1114*rmu(2, 0)*&
&                  temp1113b0
                rmub(2, 0) = rmub(2, 0) + temp1112*2*rmu(2, 0)*&
&                  temp1113b2 + temp1114*fun0*temp1113b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1113*rmucos(2, 0)*&
&                  temp1113b0 - rmu(1, 0)*3*2*rmucos(1, 0)*temp1113b1
                hess4fb(2) = 0.0_8
                temp1112b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1112b0 + fun0*der4fb(2)
                temp1111 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1110 = rmu(1, 0)**2
                temp1109 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1108 = rmu(2, 0)**2 - 6*rmu(3, 0)**2
                temp1108b = -(cost3g*2*der4fb(2))
                temp1108b0 = (temp1108*temp1109+temp1110*temp1111)*&
&                  temp1108b
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1108b0 + &
&                  temp1113*rmucos(1, 0)*temp1113b0
                rmub(3, 0) = rmub(3, 0) - temp1112*6*2*rmu(3, 0)*&
&                  temp1113b2
                temp1108b1 = rmu(2, 0)*rmucos(2, 0)*temp1108b
                rmusinb(1, 0) = rmusinb(1, 0) + (-(temp1110*2*rmusin(1, &
&                  0))-temp1108*2*rmusin(1, 0))*temp1108b1 + rmu(1, 0)*5*&
&                  2*rmusin(1, 0)*temp1113b1 + temp1112b
                cellscaleb(1) = cellscaleb(1) - temp1112*temp1112b
                rmub(1, 0) = rmub(1, 0) + temp1116*temp1113b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1112b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + temp1109*2*rmu(2, 0)*&
&                  temp1108b1 + rmucos(2, 0)*temp1108b0
                rmub(3, 0) = rmub(3, 0) - temp1109*6*2*rmu(3, 0)*&
&                  temp1108b1
                rmucosb(1, 0) = rmucosb(1, 0) + (temp1110*3*2*rmucos(1, &
&                  0)+temp1108*2*rmucos(1, 0))*temp1108b1
                rmub(1, 0) = rmub(1, 0) + temp1111*2*rmu(1, 0)*&
&                  temp1108b1
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 26) THEN
              IF (branch .LT. 22) THEN
                IF (branch .LT. 20) THEN
                  IF (branch .LT. 19) THEN
                    IF (branch .LT. 18) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp1126 = 5*rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                      temp1122 = rmusin(2, 0)/cellscale(2)
                      temp1125 = rmu(1, 0)**2 - 6*rmu(3, 0)**2
                      temp1124 = rmucos(1, 0)*rmucos(2, 0)
                      temp1123 = fun0*rmu(1, 0)
                      temp1123b = cost3g*4*hess4fb(2)
                      temp1123b0 = (pi*2*(temp1125*temp1122)+rmu(2, 0)*&
&                        temp1126)*temp1123b
                      temp1123b1 = temp1123*temp1124*temp1123b
                      temp1123b2 = pi*2*temp1123b1
                      temp1122b = temp1125*temp1123b2/cellscale(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + temp1124*rmu(&
&                        1, 0)*temp1123b0
                      rmub(1, 0) = rmub(1, 0) + temp1122*2*rmu(1, 0)*&
&                        temp1123b2 + temp1124*fun0*temp1123b0
                      rmucosb(1, 0) = rmucosb(1, 0) + temp1123*rmucos(2&
&                        , 0)*temp1123b0
                      rmucosb(2, 0) = rmucosb(2, 0) + temp1123*rmucos(1&
&                        , 0)*temp1123b0 - rmu(2, 0)*3*2*rmucos(2, 0)*&
&                        temp1123b1
                      rmub(3, 0) = rmub(3, 0) - temp1122*6*2*rmu(3, 0)*&
&                        temp1123b2
                      hess4fb(2) = 0.0_8
                      temp1122b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp1122b0 + fun0*der4fb(2)
                      temp1120 = rmu(2, 0)**2
                      temp1118 = rmu(1, 0)**2
                      temp1118b = -(cost3g*2*der4fb(2))
                      temp1118b0 = rmu(1, 0)*rmucos(1, 0)*temp1118b
                      temp1117b = 6*rmu(3, 0)**2*temp1118b0
                      rmusinb(2, 0) = rmusinb(2, 0) + (-(temp1120*2*&
&                        rmusin(2, 0))-temp1118*2*rmusin(2, 0))*&
&                        temp1118b0 + 2*rmusin(2, 0)*temp1117b + rmu(2, 0&
&                        )*5*2*rmusin(2, 0)*temp1123b1 + temp1122b
                      cellscaleb(2) = cellscaleb(2) - temp1122*temp1122b
                      rmub(2, 0) = rmub(2, 0) + temp1126*temp1123b1
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp1122b0
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp1117 = rmusin(2, 0)**2 - rmucos(2, 0)**2
                      temp1121 = 3*rmucos(2, 0)**2 - rmusin(2, 0)**2
                      temp1119 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                      temp1118b1 = (temp1118*temp1119+temp1120*temp1121+&
&                        6*(rmu(3, 0)**2*temp1117))*temp1118b
                      rmub(1, 0) = rmub(1, 0) + temp1119*2*rmu(1, 0)*&
&                        temp1118b0 + rmucos(1, 0)*temp1118b1
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp1118b1
                      rmucosb(2, 0) = rmucosb(2, 0) + (temp1120*3*2*&
&                        rmucos(2, 0)+temp1118*2*rmucos(2, 0))*temp1118b0&
&                        - 2*rmucos(2, 0)*temp1117b
                      rmub(2, 0) = rmub(2, 0) + temp1121*2*rmu(2, 0)*&
&                        temp1118b0
                      rmub(3, 0) = rmub(3, 0) + 6*temp1117*2*rmu(3, 0)*&
&                        temp1118b0
                      der4fb(2) = 0.0_8
                    END IF
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1130 = rmu(2, 0)*rmucos(1, 0)
                    temp1129 = fun0*rmu(1, 0)*rmucos(2, 0)
                    temp1130b = cost3g*24*hess4fb(2)
                    temp1130b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                      temp1130b
                    temp1129b = temp1130*temp1130b0
                    temp1129b0 = temp1129*temp1130*temp1130b
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*&
&                      rmu(1, 0)*temp1129b
                    rmub(1, 0) = rmub(1, 0) + rmucos(2, 0)*fun0*&
&                      temp1129b
                    rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*&
&                      temp1129b
                    rmub(2, 0) = rmub(2, 0) + temp1129*rmucos(1, 0)*&
&                      temp1130b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1129*rmu(2, 0)*&
&                      temp1130b0
                    rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*&
&                      temp1129b0
                    rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*&
&                      temp1129b0
                    hess4fb(2) = 0.0_8
                    temp1129b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1129b1 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1129b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1128 = rmu(3, 0)*rmucos(1, 0)
                    temp1127 = rmu(1, 0)*rmu(2, 0)
                    temp1127b = cost3g*24*der4fb(2)
                    temp1127b0 = rmucos(2, 0)*rmucos(3, 0)*temp1127b
                    temp1127b1 = temp1127*temp1128*temp1127b
                    rmub(1, 0) = rmub(1, 0) + temp1128*rmu(2, 0)*&
&                      temp1127b0
                    rmub(2, 0) = rmub(2, 0) + temp1128*rmu(1, 0)*&
&                      temp1127b0
                    rmub(3, 0) = rmub(3, 0) + temp1127*rmucos(1, 0)*&
&                      temp1127b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1127*rmu(3, 0)*&
&                      temp1127b0
                    rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                      temp1127b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                      temp1127b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 21) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1137 = 3*rmucos(1, 0)**2 - 5*rmusin(1, 0)**2
                  temp1134 = rmusin(1, 0)/cellscale(1)
                  temp1136 = rmucos(1, 0)*rmucos(3, 0)
                  temp1135 = fun0*rmu(3, 0)
                  temp1135b = cost4g*2*hess4fb(2)
                  temp1135b0 = (pi*6*(rmu(2, 0)**2*temp1134)+rmu(1, 0)*&
&                    temp1137)*temp1135b
                  temp1135b1 = temp1135*temp1136*temp1135b
                  temp1135b2 = pi*6*temp1135b1
                  temp1134b = rmu(2, 0)**2*temp1135b2/cellscale(1)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1136*rmu(3, 0&
&                    )*temp1135b0
                  rmub(3, 0) = rmub(3, 0) + temp1136*fun0*temp1135b0
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*3*2*rmucos(1&
&                    , 0)*temp1135b1 + temp1135*rmucos(3, 0)*temp1135b0
                  hess4fb(2) = 0.0_8
                  temp1134b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1134b0 + fun0*der4fb(2)
                  temp1131 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                  temp1133 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                  temp1132 = rmu(1, 0)**2
                  temp1132b = cost4g*(temp1132*temp1133+3*(rmu(2, 0)**2*&
&                    temp1131))*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1132b + &
&                    temp1135*rmucos(1, 0)*temp1135b0
                  rmub(2, 0) = rmub(2, 0) + temp1134*2*rmu(2, 0)*&
&                    temp1135b2
                  temp1132b0 = cost4g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                  temp1131b = 3*rmu(2, 0)**2*temp1132b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1131b - temp1132*2*rmusin(1, 0)*temp1132b0 - rmu&
&                    (1, 0)*5*2*rmusin(1, 0)*temp1135b1 + temp1134b
                  cellscaleb(1) = cellscaleb(1) - temp1134*temp1134b
                  rmub(1, 0) = rmub(1, 0) + temp1137*temp1135b1
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1134b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1132b
                  rmub(1, 0) = rmub(1, 0) + temp1133*2*rmu(1, 0)*&
&                    temp1132b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1132*3*2*rmucos(1&
&                    , 0)*temp1132b0 - 2*rmucos(1, 0)*temp1131b
                  rmub(2, 0) = rmub(2, 0) + 3*temp1131*2*rmu(2, 0)*&
&                    temp1132b0
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1141 = rmu(3, 0)*rmucos(1, 0)
                  temp1140 = fun0*rmu(1, 0)*rmucos(3, 0)
                  temp1141b = cost4g*6*hess4fb(2)
                  temp1141b0 = (rmusin(2, 0)**2-rmucos(2, 0)**2)*&
&                    temp1141b
                  temp1140b = temp1141*temp1141b0
                  temp1140b0 = temp1140*temp1141*temp1141b
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(&
&                    1, 0)*temp1140b
                  rmub(1, 0) = rmub(1, 0) + rmucos(3, 0)*fun0*temp1140b
                  rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                    temp1140b
                  rmub(3, 0) = rmub(3, 0) + temp1140*rmucos(1, 0)*&
&                    temp1141b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1140*rmu(3, 0)*&
&                    temp1141b0
                  rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                    temp1140b0
                  rmucosb(2, 0) = rmucosb(2, 0) - 2*rmucos(2, 0)*&
&                    temp1140b0
                  hess4fb(2) = 0.0_8
                  temp1140b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1140b1 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1140b1
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1139 = rmu(3, 0)*rmucos(1, 0)
                  temp1138 = rmu(1, 0)*rmu(2, 0)
                  temp1138b = -(cost4g*6*der4fb(2))
                  temp1138b0 = rmucos(2, 0)*rmucos(3, 0)*temp1138b
                  temp1138b1 = temp1138*temp1139*temp1138b
                  rmub(1, 0) = rmub(1, 0) + temp1139*rmu(2, 0)*&
&                    temp1138b0
                  rmub(2, 0) = rmub(2, 0) + temp1139*rmu(1, 0)*&
&                    temp1138b0
                  rmub(3, 0) = rmub(3, 0) + temp1138*rmucos(1, 0)*&
&                    temp1138b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1138*rmu(3, 0)*&
&                    temp1138b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                    temp1138b1
                  rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                    temp1138b1
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 24) THEN
                IF (.NOT.branch .LT. 23) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1144 = fun0/cellscale(3)
                  temp1147 = rmu(1, 0)*rmucos(1, 0)
                  temp1146 = rmucos(3, 0)*rmusin(3, 0)
                  temp1145 = rmu(1, 0)**2 - 3*rmu(2, 0)**2
                  temp1145b = -(cost4g*4*pi*hess4fb(2))
                  temp1145b0 = temp1147*temp1144*temp1145b
                  temp1145b1 = temp1145*temp1146*temp1145b
                  temp1144b = temp1147*temp1145b1/cellscale(3)
                  rmub(1, 0) = rmub(1, 0) + temp1144*rmucos(1, 0)*&
&                    temp1145b1 + temp1146*2*rmu(1, 0)*temp1145b0
                  rmub(2, 0) = rmub(2, 0) - temp1146*3*2*rmu(2, 0)*&
&                    temp1145b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1145*rmusin(3, 0)*&
&                    temp1145b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1144b
                  hess4fb(2) = 0.0_8
                  temp1144b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1144b0 + fun0*der4fb(2)
                  temp1142 = rmu(1, 0)*rmucos(1, 0)
                  temp1142b = cost4g*(rmu(1, 0)**2-3*rmu(2, 0)**2)*&
&                    der4fb(2)
                  rmusinb(3, 0) = rmusinb(3, 0) + temp1145*rmucos(3, 0)*&
&                    temp1145b0 - temp1142*2*rmusin(3, 0)*temp1142b
                  temp1143 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1143*rmu(1, 0)*&
&                    temp1142b + temp1144*rmu(1, 0)*temp1145b1
                  cellscaleb(3) = cellscaleb(3) - temp1144*temp1144b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1144b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1142b0 = cost4g*temp1142*temp1143*der4fb(2)
                  rmub(1, 0) = rmub(1, 0) + temp1143*rmucos(1, 0)*&
&                    temp1142b + 2*rmu(1, 0)*temp1142b0
                  rmub(2, 0) = rmub(2, 0) - 3*2*rmu(2, 0)*temp1142b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1142*2*rmucos(3, 0&
&                    )*temp1142b
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 25) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1151 = rmu(3, 0)*rmucos(2, 0)
                temp1150 = fun0*rmu(2, 0)*rmucos(3, 0)
                temp1151b = cost4g*6*hess4fb(2)
                temp1151b0 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp1151b
                temp1150b = temp1151*temp1151b0
                temp1150b0 = temp1150*temp1151*temp1151b
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(2&
&                  , 0)*temp1150b
                rmub(2, 0) = rmub(2, 0) + rmucos(3, 0)*fun0*temp1150b
                rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*temp1150b
                rmub(3, 0) = rmub(3, 0) + temp1150*rmucos(2, 0)*&
&                  temp1151b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp1150*rmu(3, 0)*&
&                  temp1151b0
                hess4fb(2) = 0.0_8
                temp1150b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1150b1 + fun0*der4fb(2)
                temp1148 = rmu(1, 0)*rmu(2, 0)
                temp1148b = cost4g*6*der4fb(2)
                temp1148b0 = rmucos(2, 0)*rmucos(3, 0)*temp1148b
                rmucosb(1, 0) = rmucosb(1, 0) + temp1148*rmu(3, 0)*&
&                  temp1148b0 + 2*rmucos(1, 0)*temp1150b0
                rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*&
&                  temp1150b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1150b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1149 = rmu(3, 0)*rmucos(1, 0)
                temp1148b1 = temp1148*temp1149*temp1148b
                rmub(1, 0) = rmub(1, 0) + temp1149*rmu(2, 0)*temp1148b0
                rmub(2, 0) = rmub(2, 0) + temp1149*rmu(1, 0)*temp1148b0
                rmub(3, 0) = rmub(3, 0) + temp1148*rmucos(1, 0)*&
&                  temp1148b0
                rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*temp1148b1
                rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*temp1148b1
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1158 = 3*rmucos(2, 0)**2 - 5*rmusin(2, 0)**2
                temp1155 = rmusin(2, 0)/cellscale(2)
                temp1157 = rmucos(2, 0)*rmucos(3, 0)
                temp1156 = fun0*rmu(3, 0)
                temp1156b = -(cost4g*2*hess4fb(2))
                temp1156b0 = (pi*6*(rmu(1, 0)**2*temp1155)+rmu(2, 0)*&
&                  temp1158)*temp1156b
                temp1156b1 = temp1156*temp1157*temp1156b
                temp1156b2 = pi*6*temp1156b1
                temp1155b = rmu(1, 0)**2*temp1156b2/cellscale(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1157*rmu(3, 0)*&
&                  temp1156b0
                rmub(3, 0) = rmub(3, 0) + temp1157*fun0*temp1156b0
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*3*2*rmucos(2, &
&                  0)*temp1156b1 + temp1156*rmucos(3, 0)*temp1156b0
                hess4fb(2) = 0.0_8
                temp1155b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1155b0 + fun0*der4fb(2)
                temp1154 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                temp1153 = rmu(2, 0)**2
                temp1152 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp1153b = cost4g*(3*(rmu(1, 0)**2*temp1152)+temp1153*&
&                  temp1154)*der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1153b + &
&                  temp1156*rmucos(2, 0)*temp1156b0
                rmub(1, 0) = rmub(1, 0) + temp1155*2*rmu(1, 0)*&
&                  temp1156b2
                temp1153b0 = cost4g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                temp1152b = 3*rmu(1, 0)**2*temp1153b0
                rmusinb(2, 0) = rmusinb(2, 0) + temp1153*2*rmusin(2, 0)*&
&                  temp1153b0 - 2*rmusin(2, 0)*temp1152b - rmu(2, 0)*5*2*&
&                  rmusin(2, 0)*temp1156b1 + temp1155b
                cellscaleb(2) = cellscaleb(2) - temp1155*temp1155b
                rmub(2, 0) = rmub(2, 0) + temp1158*temp1156b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1155b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1153b
                rmub(1, 0) = rmub(1, 0) + 3*temp1152*2*rmu(1, 0)*&
&                  temp1153b0
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp1152b&
&                  - temp1153*3*2*rmucos(2, 0)*temp1153b0
                rmub(2, 0) = rmub(2, 0) + temp1154*2*rmu(2, 0)*&
&                  temp1153b0
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 30) THEN
              IF (branch .LT. 28) THEN
                IF (.NOT.branch .LT. 27) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1161 = fun0/cellscale(3)
                  temp1164 = rmu(2, 0)*rmucos(2, 0)
                  temp1163 = rmucos(3, 0)*rmusin(3, 0)
                  temp1162 = rmu(2, 0)**2 - 3*rmu(1, 0)**2
                  temp1162b = cost4g*4*pi*hess4fb(2)
                  temp1162b0 = temp1164*temp1161*temp1162b
                  temp1162b1 = temp1162*temp1163*temp1162b
                  temp1161b = temp1164*temp1162b1/cellscale(3)
                  rmub(2, 0) = rmub(2, 0) + temp1161*rmucos(2, 0)*&
&                    temp1162b1 + temp1163*2*rmu(2, 0)*temp1162b0
                  rmub(1, 0) = rmub(1, 0) - temp1163*3*2*rmu(1, 0)*&
&                    temp1162b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1162*rmusin(3, 0)*&
&                    temp1162b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1161b
                  hess4fb(2) = 0.0_8
                  temp1161b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1161b0 + fun0*der4fb(2)
                  temp1159 = rmu(2, 0)*rmucos(2, 0)
                  temp1159b = -(cost4g*(rmu(2, 0)**2-3*rmu(1, 0)**2)*&
&                    der4fb(2))
                  rmusinb(3, 0) = rmusinb(3, 0) + temp1162*rmucos(3, 0)*&
&                    temp1162b0 - temp1159*2*rmusin(3, 0)*temp1159b
                  temp1160 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1160*rmu(2, 0)*&
&                    temp1159b + temp1161*rmu(2, 0)*temp1162b1
                  cellscaleb(3) = cellscaleb(3) - temp1161*temp1161b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1161b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1159b0 = -(cost4g*temp1159*temp1160*der4fb(2))
                  rmub(2, 0) = rmub(2, 0) + temp1160*rmucos(2, 0)*&
&                    temp1159b + 2*rmu(2, 0)*temp1159b0
                  rmub(1, 0) = rmub(1, 0) - 3*2*rmu(1, 0)*temp1159b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1159*2*rmucos(3, 0&
&                    )*temp1159b
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 29) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1165 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                temp1167 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1166 = rmu(1, 0)**2
                temp1166b = cost5g*4*hess4fb(2)
                temp1166b0 = fun0*temp1166b
                temp1165b = 3*rmu(2, 0)**2*temp1166b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + (temp1166*temp1167+&
&                  3*(rmu(2, 0)**2*temp1165))*temp1166b
                rmub(1, 0) = rmub(1, 0) + temp1167*2*rmu(1, 0)*&
&                  temp1166b0
                hess4fb(2) = 0.0_8
                temp1165b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1165b0 + fun0*der4fb(2)
                temp1165b1 = cost5g*4*der4fb(2)
                temp1165b2 = (rmu(1, 0)**2-3*rmu(2, 0)**2)*temp1165b1
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1165b2 - 2&
&                  *rmucos(1, 0)*temp1165b + temp1166*3*2*rmucos(1, 0)*&
&                  temp1166b0
                rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*temp1165b&
&                  - temp1166*2*rmusin(1, 0)*temp1166b0
                rmub(2, 0) = rmub(2, 0) + 3*temp1165*2*rmu(2, 0)*&
&                  temp1166b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1165b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1165b3 = rmu(1, 0)*rmucos(1, 0)*temp1165b1
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1165b2 + 2*&
&                  rmu(1, 0)*temp1165b3
                rmub(2, 0) = rmub(2, 0) - 3*2*rmu(2, 0)*temp1165b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1170 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                temp1169 = rmu(2, 0)**2
                temp1168 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp1169b = -(cost5g*4*hess4fb(2))
                temp1169b0 = fun0*temp1169b
                temp1168b = 3*rmu(1, 0)**2*temp1169b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + (3*(rmu(1, 0)**2*&
&                  temp1168)+temp1169*temp1170)*temp1169b
                rmub(1, 0) = rmub(1, 0) + 3*temp1168*2*rmu(1, 0)*&
&                  temp1169b0
                hess4fb(2) = 0.0_8
                temp1168b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1168b0 + fun0*der4fb(2)
                temp1168b1 = cost5g*4*der4fb(2)
                temp1168b2 = (rmu(2, 0)**2-3*rmu(1, 0)**2)*temp1168b1
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1168b2 - &
&                  temp1169*3*2*rmucos(2, 0)*temp1169b0 + 2*rmucos(2, 0)*&
&                  temp1168b
                rmusinb(2, 0) = rmusinb(2, 0) + temp1169*2*rmusin(2, 0)*&
&                  temp1169b0 - 2*rmusin(2, 0)*temp1168b
                rmub(2, 0) = rmub(2, 0) + temp1170*2*rmu(2, 0)*&
&                  temp1169b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1168b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1168b3 = rmu(2, 0)*rmucos(2, 0)*temp1168b1
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1168b2 + 2*&
&                  rmu(2, 0)*temp1168b3
                rmub(1, 0) = rmub(1, 0) - 3*2*rmu(1, 0)*temp1168b3
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 32) THEN
              IF (branch .LT. 31) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1178 = 3*rmucos(1, 0)**2 - 5*rmusin(1, 0)**2
                temp1175 = rmusin(1, 0)/cellscale(1)
                temp1177 = rmucos(1, 0)*rmucos(2, 0)
                temp1176 = fun0*rmu(2, 0)
                temp1176b = cost5g*8*hess4fb(2)
                temp1176b0 = (pi*2*(rmu(2, 0)**2*temp1175)+rmu(1, 0)*&
&                  temp1178)*temp1176b
                temp1176b1 = temp1176*temp1177*temp1176b
                temp1176b2 = pi*2*temp1176b1
                temp1175b = rmu(2, 0)**2*temp1176b2/cellscale(1)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1177*rmu(2, 0)*&
&                  temp1176b0
                rmub(2, 0) = rmub(2, 0) + temp1175*2*rmu(2, 0)*&
&                  temp1176b2 + temp1177*fun0*temp1176b0
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*3*2*rmucos(1, &
&                  0)*temp1176b1 + temp1176*rmucos(2, 0)*temp1176b0
                hess4fb(2) = 0.0_8
                temp1175b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1175b0 + fun0*der4fb(2)
                temp1174 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                temp1173 = rmu(2, 0)**2
                temp1172 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1171 = rmu(1, 0)**2
                temp1171b = cost5g*4*der4fb(2)
                temp1171b0 = (temp1171*temp1172+temp1173*temp1174)*&
&                  temp1171b
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1171b0 + &
&                  temp1176*rmucos(1, 0)*temp1176b0
                temp1171b1 = rmu(2, 0)*rmucos(2, 0)*temp1171b
                rmusinb(1, 0) = rmusinb(1, 0) + (temp1173*2*rmusin(1, 0)&
&                  -temp1171*2*rmusin(1, 0))*temp1171b1 - rmu(1, 0)*5*2*&
&                  rmusin(1, 0)*temp1176b1 + temp1175b
                cellscaleb(1) = cellscaleb(1) - temp1175*temp1175b
                rmub(1, 0) = rmub(1, 0) + temp1178*temp1176b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1175b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + temp1174*2*rmu(2, 0)*&
&                  temp1171b1 + rmucos(2, 0)*temp1171b0
                rmub(1, 0) = rmub(1, 0) + temp1172*2*rmu(1, 0)*&
&                  temp1171b1
                rmucosb(1, 0) = rmucosb(1, 0) + (temp1171*3*2*rmucos(1, &
&                  0)-temp1173*2*rmucos(1, 0))*temp1171b1
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 33) THEN
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              temp1186 = 3*rmucos(2, 0)**2 - 5*rmusin(2, 0)**2
              temp1183 = rmusin(2, 0)/cellscale(2)
              temp1185 = rmucos(1, 0)*rmucos(2, 0)
              temp1184 = fun0*rmu(1, 0)
              temp1184b = -(cost5g*8*hess4fb(2))
              temp1184b0 = (pi*2*(rmu(1, 0)**2*temp1183)+rmu(2, 0)*&
&                temp1186)*temp1184b
              temp1184b1 = temp1184*temp1185*temp1184b
              temp1184b2 = pi*2*temp1184b1
              temp1183b = rmu(1, 0)**2*temp1184b2/cellscale(2)
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              fun0b = fun0b + der4f(2)*der4fb(2) + temp1185*rmu(1, 0)*&
&                temp1184b0
              rmub(1, 0) = rmub(1, 0) + temp1183*2*rmu(1, 0)*temp1184b2 &
&                + temp1185*fun0*temp1184b0
              rmucosb(1, 0) = rmucosb(1, 0) + temp1184*rmucos(2, 0)*&
&                temp1184b0
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*3*2*rmucos(2, 0)&
&                *temp1184b1 + temp1184*rmucos(1, 0)*temp1184b0
              hess4fb(2) = 0.0_8
              temp1183b0 = 2.d0*rmu(i, 0)*hess4fb(3)
              der4fb(2) = fun*temp1183b0 + fun0*der4fb(2)
              temp1181 = rmu(2, 0)**2
              temp1179 = rmu(1, 0)**2
              temp1179b = cost5g*4*der4fb(2)
              temp1179b0 = rmu(1, 0)*rmucos(1, 0)*temp1179b
              rmusinb(2, 0) = rmusinb(2, 0) + (temp1181*2*rmusin(2, 0)-&
&                temp1179*2*rmusin(2, 0))*temp1179b0 - rmu(2, 0)*5*2*&
&                rmusin(2, 0)*temp1184b1 + temp1183b
              cellscaleb(2) = cellscaleb(2) - temp1183*temp1183b
              rmub(2, 0) = rmub(2, 0) + temp1186*temp1184b1
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
              funb = funb + der4f(2)*temp1183b0
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              temp1182 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
              temp1180 = rmucos(2, 0)**2 - rmusin(2, 0)**2
              temp1179b1 = (temp1179*temp1180+temp1181*temp1182)*&
&                temp1179b
              rmub(1, 0) = rmub(1, 0) + temp1180*2*rmu(1, 0)*temp1179b0 &
&                + rmucos(1, 0)*temp1179b1
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1179b1
              rmucosb(2, 0) = rmucosb(2, 0) + (temp1179*2*rmucos(2, 0)-&
&                temp1181*3*2*rmucos(2, 0))*temp1179b0
              rmub(2, 0) = rmub(2, 0) + temp1182*2*rmu(2, 0)*temp1179b0
              der4fb(2) = 0.0_8
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4fb(2) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp1058b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp1058b
            funb = funb + rmu(i, 0)*temp1058b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp1057 = r(0)**2
        temp1056 = fun2/temp1057
        temp1056b = rmu(i, 0)**2*radhess4fb(i)/temp1057
        temp1055 = r(0)**2
        temp1054 = rmu(i, 0)**2/temp1055
        temp1054b1 = -(fun*radhess4fb(i)/temp1055)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp1054b1 + temp1056*2*&
&          rmu(i, 0)*radhess4fb(i)
        fun2b = fun2b + temp1056b
        rb(0) = rb(0) - temp1054*2*r(0)*temp1054b1 - temp1056*2*r(0)*&
&          temp1056b
        funb = funb + (1.d0-temp1054)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp1054b0 = -(fun*2.d0*fun2b)
      rb(0) = rb(0) + dd1*2*r(0)*temp1054b0 + 2*r(0)*rp0b
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp1054b0 - 2.d0*distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=9,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp1054b = distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + cosphase(k)*temp1054b
          cosphaseb(k) = cosphaseb(k) + distp(k, 1)*temp1054b
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*cosphase(k)*zb&
&            (indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp1053 = rmu(2, i)*rmucos(2, i)
      temp1052 = rmu(1, i)*rmucos(1, i)
      temp1052b = cost5g*4.d0*distpb(i, 10)
      temp1052b0 = (rmu(1, i)**2-rmu(2, i)**2)*temp1052b
      temp1052b1 = temp1052*temp1053*temp1052b
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp1052b1 + temp1053*rmucos&
&        (1, i)*temp1052b0
      rmucosb(1, i) = rmucosb(1, i) + temp1053*rmu(1, i)*temp1052b0
      rmub(2, i) = rmub(2, i) + temp1052*rmucos(2, i)*temp1052b0 - 2*rmu&
&        (2, i)*temp1052b1
      distpb(i, 10) = 0.0_8
      temp1052b2 = cost5g*distpb(i, 9)
      distpb(i, 9) = 0.0_8
      temp1051 = rmu(3, i)*rmucos(3, i)
      temp1050b = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      rmucosb(2, i) = rmucosb(2, i) + temp1051*rmu(2, i)*temp1050b + &
&        temp1052*rmu(2, i)*temp1052b0
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp1052b2
      temp1050 = rmu(2, i)*rmucos(2, i)
      temp1050b0 = cost4g*temp1050*temp1051*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + temp1051*rmucos(2, i)*temp1050b - 2*rmu(&
&        2, i)*temp1050b0 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i)&
&        )*temp1052b2
      rmub(3, i) = rmub(3, i) + temp1050*rmucos(3, i)*temp1050b
      rmucosb(3, i) = rmucosb(3, i) + temp1050*rmu(3, i)*temp1050b
      distpb(i, 8) = 0.0_8
      temp1049 = rmu(3, i)*rmucos(3, i)
      temp1048 = rmu(1, i)*rmucos(1, i)
      temp1048b = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp1048b0 = cost4g*temp1048*temp1049*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + temp1049*rmucos(1, i)*temp1048b + 2*rmu(&
&        1, i)*temp1048b0 + 3.d0*2*rmu(1, i)*temp1050b0
      rmucosb(1, i) = rmucosb(1, i) + temp1049*rmu(1, i)*temp1048b
      rmub(3, i) = rmub(3, i) + temp1048*rmucos(3, i)*temp1048b
      rmucosb(3, i) = rmucosb(3, i) + temp1048*rmu(3, i)*temp1048b
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp1048b0
      distpb(i, 7) = 0.0_8
      temp1047 = rmu(2, i)*rmucos(2, i)
      temp1046 = rmu(1, i)*rmucos(1, i)
      temp1046b = cost3g*2.d0*distpb(i, 6)
      temp1046b0 = (7.d0*rmu(3, i)**2-rp0)*temp1046b
      temp1046b1 = temp1046*temp1047*temp1046b
      rmub(1, i) = rmub(1, i) + temp1047*rmucos(1, i)*temp1046b0
      rmucosb(1, i) = rmucosb(1, i) + temp1047*rmu(1, i)*temp1046b0
      rmub(2, i) = rmub(2, i) + temp1046*rmucos(2, i)*temp1046b0
      distpb(i, 6) = 0.0_8
      temp1046b2 = cost3g*(7.d0*rmu(3, i)**2-rp0)*distpb(i, 5)
      temp1046b3 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp1045 = rmu(3, i)*rmucos(3, i)
      temp1044b = cost2g*(7.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 4)
      rmucosb(2, i) = rmucosb(2, i) + temp1045*rmu(2, i)*temp1044b + &
&        temp1046*rmu(2, i)*temp1046b0
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1046b1
      temp1044 = rmu(2, i)*rmucos(2, i)
      temp1044b0 = cost2g*temp1044*temp1045*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp1043 = rmu(3, i)*rmucos(3, i)
      temp1042 = rmu(1, i)*rmucos(1, i)
      temp1042b = cost2g*(7.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 3)
      temp1042b0 = cost2g*temp1042*temp1043*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp1042b1 = cost1g*distpb(i, 2)
      rp0b = (3.d0*2*rp0-30.d0*rmu(3, i)**2)*temp1042b1 - 3.d0*&
&        temp1042b0 - temp1046b3 - 3.d0*temp1044b0 - temp1046b1
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp1046b2
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp1046b2
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1046b3
      rmub(2, i) = rmub(2, i) + temp1045*rmucos(2, i)*temp1044b
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1044b0 + temp1044*&
&        rmucos(3, i)*temp1044b
      rmucosb(3, i) = rmucosb(3, i) + temp1044*rmu(3, i)*temp1044b
      rmub(1, i) = rmub(1, i) + temp1043*rmucos(1, i)*temp1042b
      rmucosb(1, i) = rmucosb(1, i) + temp1043*rmu(1, i)*temp1042b
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*rp0*2*rmu(3&
&        , i))*temp1042b1 + 7.d0*2*rmu(3, i)*temp1042b0 + temp1042*rmucos&
&        (3, i)*temp1042b
      rmucosb(3, i) = rmucosb(3, i) + temp1042*rmu(3, i)*temp1042b
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp1041 = r(k)**2
      temp1041b = c*DEXP(-(dd1*temp1041))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp1041))*distpb(k, 1)
      dd1b = dd1b - temp1041*temp1041b
      rb(k) = rb(k) - dd1*2*r(k)*temp1041b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.11284691281640568826d0*2.75d0*dd1**1.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (54)
! g single gaussian orbital
! derivative of 53
! normalized
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
!         c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)
    c = dd1**2.75d0*1.11284691281640568826d0
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos with the minimal rmucos strategy
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(i)**2
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*rp0+&
&        3.d0*rp0**2)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-rp0)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos(&
&        2, i)*(7.d0*rmu(3, i)**2-rp0)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(rmu(1, i)**2-3.0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(3.d0*rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos&
&        (2, i)*(rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-4
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,9
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*(11.d0/4.d0/dd1-r(k)**2)*distp(k, &
&            1+ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
! fun2 = radial''
      fun0 = distp(0, 1)*(11.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-15.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+21.d0*dd1*r(0)**2-15.d0&
&        /2.d0)
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(0)**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,9
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part ! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*12*rmu(1, 0)*rmucos(1, 0)*(-(5*rmu(3, &
&                  0)**2)+rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*12*(2*rmu(1, 0)**2*rmucos(1, 0)&
&                  **2-(rmucos(1, 0)**2-rmusin(1, 0)**2)*(5*rmu(3, 0)**2-&
&                  rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*12*rmu(2, 0)*rmucos(2, 0)*(-(5*rmu(3, &
&                  0)**2)+rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*12*(2*rmu(2, 0)**2*rmucos(2, 0)&
&                  **2-(rmucos(2, 0)**2-rmusin(2, 0)**2)*(5*rmu(3, 0)**2-&
&                  rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*16*rmu(3, 0)*rmucos(3, 0)*(5*rmu(3, 0)&
&                  **2-3*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*16*(rmu(3, 0)**2*(9*rmucos(3, 0)&
&                  **2-5*rmusin(3, 0)**2)+3*(-(rmucos(3, 0)**2)+rmusin(3&
&                  , 0)**2)*rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(3, 0)*rmucos(3, 0)*(-(6*rmu(1, 0)&
&                  **2*rmucos(1, 0)**2)+(rmucos(1, 0)**2-rmusin(1, 0)**2)&
&                  *(7*rmu(3, 0)**2-3*rp0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*(-(2*rmu(3, 0)*rmucos(1, 0)*&
&                  rmucos(3, 0)*(9*rmu(1, 0)*(rmucos(1, 0)**2-rmusin(1, 0&
&                  )**2)+2*pi/cellscale(1)*rmusin(1, 0)*(7*rmu(3, 0)**2-3&
&                  *rp0))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost2g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*6*rmu(1, 0)*rmu(3, 0)*rmucos(1, &
&                  0)*rmucos(3, 0)*(-(rmucos(2, 0)**2)+rmusin(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(1, 0)*rmucos(1, 0)*(rmu(3, 0)**2*(&
&                  15*rmucos(3, 0)**2-7*rmusin(3, 0)**2)+3*(-(rmucos(3, 0&
&                  )**2)+rmusin(3, 0)**2)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*4*rmu(1, 0)*rmucos(1, 0)*rmucos(&
&                  3, 0)*(rmu(3, 0)*(6*rmucos(3, 0)**2-13*rmusin(3, 0)**2&
&                  )+3*pi/cellscale(3)*rmusin(3, 0)*rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost2g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*6*rmu(2, 0)*rmu(3, 0)*rmucos(2, &
&                  0)*rmucos(3, 0)*(-(rmucos(1, 0)**2)+rmusin(1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(3, 0)*rmucos(3, 0)*(-(6*rmu(2, 0)&
&                  **2*rmucos(2, 0)**2)+(rmucos(2, 0)**2-rmusin(2, 0)**2)&
&                  *(7*rmu(3, 0)**2-3*rp0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*(-(2*rmu(3, 0)*rmucos(2, 0)*&
&                  rmucos(3, 0)*(9*rmu(2, 0)*(rmucos(2, 0)**2-rmusin(2, 0&
&                  )**2)+2*pi/cellscale(2)*rmusin(2, 0)*(7*rmu(3, 0)**2-3&
&                  *rp0))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(2, 0)*rmucos(2, 0)*(rmu(3, 0)**2*(&
&                  15*rmucos(3, 0)**2-7*rmusin(3, 0)**2)+3*(-(rmucos(3, 0&
&                  )**2)+rmusin(3, 0)**2)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*(4*rmu(2, 0)*rmucos(2, 0)*rmucos&
&                  (3, 0)*(rmu(3, 0)*(6*rmucos(3, 0)**2-13*rmusin(3, 0)**&
&                  2)+3*pi/cellscale(3)*rmusin(3, 0)*rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost3g*4*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(3, 0&
&                  )**2)*rmucos(1, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4*fun0*cost3g*(rmu(1, 0)**2*(3*rmucos(1, 0&
&                  )**2-rmusin(1, 0)**2)+3*rmu(3, 0)**2*(-(rmucos(1, 0)**&
&                  2)+rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*4*rmu(2, 0)*(rmu(2, 0)**2-3*rmu(3, 0)&
&                  **2)*rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 4*fun0*cost3g*(rmu(2, 0)**2*(3*rmucos(2, 0)&
&                  **2-rmusin(2, 0)**2)+3*rmu(3, 0)**2*(-(rmucos(2, 0)**2&
&                  )+rmusin(2, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*12*(rmu(1, 0)**2-rmu(2, 0)**2)*rmu(3, &
&                  0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost3g*12*(rmu(1, 0)**2-rmu(2, 0)**2)*(&
&                  rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2*cost3g*rmu(2, 0)*rmucos(2, 0)*((rmu(2, 0)&
&                  **2-6*rmu(3, 0)**2)*(rmucos(1, 0)**2-rmusin(1, 0)**2)+&
&                  rmu(1, 0)**2*(3*rmucos(1, 0)**2-rmusin(1, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost3g*fun0*(4*rmu(2, 0)*rmucos(1, 0)*rmucos&
&                  (2, 0)*(2*(rmu(2, 0)**2-6*rmu(3, 0)**2)*rmusin(1, 0)*&
&                  pi/cellscale(1)+rmu(1, 0)*(-(3*rmucos(1, 0)**2)+5*&
&                  rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2*cost3g*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)&
&                  **2*(rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(3*&
&                  rmucos(2, 0)**2-rmusin(2, 0)**2)+6*rmu(3, 0)**2*(-(&
&                  rmucos(2, 0)**2)+rmusin(2, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost3g*fun0*(4*rmu(1, 0)*rmucos(1, 0)*rmucos&
&                  (2, 0)*(2*(rmu(1, 0)**2-6*rmu(3, 0)**2)*rmusin(2, 0)*&
&                  pi/cellscale(2)+rmu(2, 0)*(-(3*rmucos(2, 0)**2)+5*&
&                  rmusin(2, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*24*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost3g*24*rmu(1, 0)*rmu(2, 0)*rmucos(1&
&                  , 0)*rmucos(2, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(3, 0)*rmucos(3, 0)*(rmu(1, 0)**2*(&
&                  3*rmucos(1, 0)**2-rmusin(1, 0)**2)+3*rmu(2, 0)**2*(-(&
&                  rmucos(1, 0)**2)+rmusin(1, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*(2*rmu(3, 0)*rmucos(1, 0)*rmucos&
&                  (3, 0)*(6*rmu(2, 0)**2*rmusin(1, 0)*pi/cellscale(1)+&
&                  rmu(1, 0)*(3*rmucos(1, 0)**2-5*rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6*cost4g*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 6*cost4g*fun0*rmu(1, 0)*rmu(3, 0)*rmucos(1, &
&                  0)*rmucos(3, 0)*(-(rmucos(2, 0)**2)+rmusin(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(2, 0)**2&
&                  )*rmucos(1, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost4g*(-(4*rmu(1, 0)*(rmu(1, 0)**2-3*&
&                  rmu(2, 0)**2)*rmucos(1, 0)*rmucos(3, 0)*rmusin(3, 0)*&
&                  pi/cellscale(3)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
              END IF
            ELSE IF (ic .EQ. 7) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*rmucos&
&                  (1, 0)*rmucos(2, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*6*rmu(2, 0)*rmu(3, 0)*rmucos(2, &
&                  0)*rmucos(3, 0)*(rmucos(1, 0)**2-rmusin(1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(3, 0)*rmucos(3, 0)*(3*rmu(1, 0)**2&
&                  *(rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*&
&                  rmucos(2, 0)**2)+rmusin(2, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*(-(2*rmu(3, 0)*rmucos(2, 0)*&
&                  rmucos(3, 0)*(6*rmu(1, 0)**2*rmusin(2, 0)*pi/cellscale&
&                  (2)+rmu(2, 0)*(3*rmucos(2, 0)**2-5*rmusin(2, 0)**2))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost4g*(rmu(2, 0)*(-(3*rmu(1, 0)**2)+rmu(2&
&                  , 0)**2)*rmucos(2, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2&
&                  )))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost4g*(4*rmu(2, 0)*(-(3*rmu(1, 0)**2)+&
&                  rmu(2, 0)**2)*rmucos(2, 0)*rmucos(3, 0)*rmusin(3, 0)*&
&                  pi/cellscale(3))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
              END IF
            ELSE IF (ic .EQ. 8) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost5g*4*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(2, 0)&
&                  **2)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost5g*fun0*4*(rmu(1, 0)**2*(3*rmucos(1, 0)&
&                  **2-rmusin(1, 0)**2)+3*rmu(2, 0)**2*(-(rmucos(1, 0)**2&
&                  )+rmusin(1, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost5g*4*rmu(2, 0)*(-(3*rmu(1, 0)**2)+rmu(2, &
&                  0)**2)*rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4*cost5g*fun0*(3*rmu(1, 0)**2*(rmucos(2, 0&
&                  )**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*rmucos(2, 0)**&
&                  2)+rmusin(2, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,29)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,30)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost5g*4*rmu(2, 0)*rmucos(2, 0)*(rmu(1, 0)**2*(&
&                3*rmucos(1, 0)**2-rmusin(1, 0)**2)+rmu(2, 0)**2*(-(&
&                rmucos(1, 0)**2)+rmusin(1, 0)**2))
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = cost5g*fun0*(8*rmu(2, 0)*rmucos(1, 0)*rmucos(2&
&                , 0)*(2*rmu(2, 0)**2*rmusin(1, 0)*pi/cellscale(1)+rmu(1&
&                , 0)*(3*rmucos(1, 0)**2-5*rmusin(1, 0)**2)))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,31)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost5g*4*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)**2*(&
&                rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*&
&                rmucos(2, 0)**2)+rmusin(2, 0)**2))
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = cost5g*fun0*(-(8*rmu(1, 0)*rmucos(1, 0)*rmucos&
&                (2, 0)*(2*rmu(1, 0)**2*rmusin(2, 0)*pi/cellscale(2)+rmu(&
&                2, 0)*(3*rmucos(2, 0)**2-5*rmusin(2, 0)**2))))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,32)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,33)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*(11.d0/4.d0/dd1-r(0&
&              )**2)*distp(0, 1+ic)*cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*(11.d0/4.d0/dd1-r(0)**2)*distp(0, 1+ic)*sinphase(i, &
&              0)*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      dd1b = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=9,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp1349 = distp(0, 1)*rphase(i)
            temp1348 = distp(0, 1+ic)*sinphase(i, 0)
            temp1348b = -(temp1348*temp1349*zb(indorbp, indt+i))
            temp1347 = 4.d0*dd1
            temp1346 = 11.d0/temp1347
            temp1346b = -((temp1346-r(0)**2)*zb(indorbp, indt+i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1345 = distp(0, 1+ic)*rphase(i)**2
            temp1343 = 4.d0*dd1
            temp1342 = 11.d0/temp1343
            temp1342b = -((temp1342-r(0)**2)*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + &
&              temp1345*distp(0, 1)*temp1342b + z(indorbp, indt+i)*zb(&
&              indorbp, indt+i)
            temp1344 = distp(0, 1)*cosphase(0)
            temp1344b = -(temp1344*temp1345*hess4fb(1))
            dd1b = dd1b - temp1342*4.d0*temp1344b/temp1343 - temp1346*&
&              4.d0*temp1348b/temp1347
            rb(0) = rb(0) - 2*r(0)*temp1344b - 2*r(0)*temp1348b
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp1349*sinphase(i, 0)*&
&              temp1346b
            temp1346b0 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp1346b0 + &
&              temp1349*distp(0, 1+ic)*temp1346b
            distpb(0, 1) = distpb(0, 1) + temp1345*cosphase(0)*temp1342b&
&              + temp1348*rphase(i)*temp1346b
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp1346b0 + &
&              temp1344*distp(0, 1+ic)*2*rphase(i)*temp1342b + temp1348*&
&              distp(0, 1)*temp1346b
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp1344*rphase(i)**2*&
&              temp1342b
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1341 = der4f(1)/cellscale(i)
            temp1341b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp1341*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp1341b
            cellscaleb(i) = cellscaleb(i) - temp1341*temp1341b
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 17) THEN
              IF (branch .LT. 9) THEN
                IF (branch .LT. 5) THEN
                  IF (branch .LT. 3) THEN
                    IF (branch .LT. 2) THEN
                      IF (branch .LT. 1) THEN
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                        temp1213 = 5*rmu(3, 0)**2 - rp0
                        temp1212 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                        temp1212b0 = cost1g*12*hess4fb(2)
                        temp1212b1 = fun0*temp1212b0
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        fun0b = fun0b + der4f(2)*der4fb(2) + (2*(rmu(1, &
&                          0)**2*rmucos(1, 0)**2)-temp1212*temp1213)*&
&                          temp1212b0
                        rmub(1, 0) = rmub(1, 0) + 2**2*rmucos(1, 0)**2*&
&                          rmu(1, 0)*temp1212b1
                        hess4fb(2) = 0.0_8
                        temp1212b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                        der4fb(2) = fun*temp1212b2 + fun0*der4fb(2)
                        temp1212b3 = cost1g*12*der4fb(2)
                        temp1212b4 = (rp0-5*rmu(3, 0)**2)*temp1212b3
                        rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                          temp1212b4 + (2**2*rmu(1, 0)**2*rmucos(1, 0)-&
&                          temp1213*2*rmucos(1, 0))*temp1212b1
                        rmusinb(1, 0) = rmusinb(1, 0) + temp1213*2*&
&                          rmusin(1, 0)*temp1212b1
                        rmub(3, 0) = rmub(3, 0) - temp1212*5*2*rmu(3, 0)&
&                          *temp1212b1
                        temp1212b5 = rmu(1, 0)*rmucos(1, 0)*temp1212b3
                        rp0b = rp0b + temp1212b5 + temp1212*temp1212b1
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                        rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                          hess4fb(3)
                        funb = funb + der4f(2)*temp1212b2
                        hess4fb(3) = 0.0_8
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*&
&                          temp1212b4
                        rmub(3, 0) = rmub(3, 0) - 5*2*rmu(3, 0)*&
&                          temp1212b5
                        der4fb(2) = 0.0_8
                      ELSE
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                        temp1215 = 5*rmu(3, 0)**2 - rp0
                        temp1214 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                        temp1214b = cost1g*12*hess4fb(2)
                        temp1214b0 = fun0*temp1214b
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        fun0b = fun0b + der4f(2)*der4fb(2) + (2*(rmu(2, &
&                          0)**2*rmucos(2, 0)**2)-temp1214*temp1215)*&
&                          temp1214b
                        rmub(2, 0) = rmub(2, 0) + 2**2*rmucos(2, 0)**2*&
&                          rmu(2, 0)*temp1214b0
                        hess4fb(2) = 0.0_8
                        temp1214b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                        der4fb(2) = fun*temp1214b1 + fun0*der4fb(2)
                        temp1214b2 = cost1g*12*der4fb(2)
                        temp1214b3 = (rp0-5*rmu(3, 0)**2)*temp1214b2
                        rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                          temp1214b3 + (2**2*rmu(2, 0)**2*rmucos(2, 0)-&
&                          temp1215*2*rmucos(2, 0))*temp1214b0
                        rmusinb(2, 0) = rmusinb(2, 0) + temp1215*2*&
&                          rmusin(2, 0)*temp1214b0
                        rmub(3, 0) = rmub(3, 0) - temp1214*5*2*rmu(3, 0)&
&                          *temp1214b0
                        temp1214b4 = rmu(2, 0)*rmucos(2, 0)*temp1214b2
                        rp0b = rp0b + temp1214b4 + temp1214*temp1214b0
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                        rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                          hess4fb(3)
                        funb = funb + der4f(2)*temp1214b1
                        hess4fb(3) = 0.0_8
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*&
&                          temp1214b3
                        rmub(3, 0) = rmub(3, 0) - 5*2*rmu(3, 0)*&
&                          temp1214b4
                        der4fb(2) = 0.0_8
                      END IF
                    END IF
                  ELSE IF (branch .LT. 4) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1216 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                    temp1218 = 9*rmucos(3, 0)**2 - 5*rmusin(3, 0)**2
                    temp1217 = rmu(3, 0)**2
                    temp1217b = cost1g*16*hess4fb(2)
                    temp1217b0 = fun0*temp1217b
                    temp1216b = 3*rp0*temp1217b0
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (temp1217*&
&                      temp1218+3*(temp1216*rp0))*temp1217b
                    rmub(3, 0) = rmub(3, 0) + temp1218*2*rmu(3, 0)*&
&                      temp1217b0
                    hess4fb(2) = 0.0_8
                    temp1216b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1216b0 + fun0*der4fb(2)
                    temp1216b1 = cost1g*16*der4fb(2)
                    temp1216b2 = (5*rmu(3, 0)**2-3*rp0)*temp1216b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1216b2&
&                      - 2*rmucos(3, 0)*temp1216b + temp1217*9*2*rmucos(3&
&                      , 0)*temp1217b0
                    rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                      temp1216b - temp1217*5*2*rmusin(3, 0)*temp1217b0
                    temp1216b3 = rmu(3, 0)*rmucos(3, 0)*temp1216b1
                    rp0b = rp0b + 3*temp1216*temp1217b0 - 3*temp1216b3
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1216b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5*2*rmu(3, 0)*temp1216b3 +&
&                      rmucos(3, 0)*temp1216b2
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1225 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1221 = rmusin(1, 0)/cellscale(1)
                    temp1222 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                    temp1224 = rmucos(1, 0)*rmucos(3, 0)
                    temp1223 = fun0*rmu(3, 0)
                    temp1223b = -(cost2g*2*hess4fb(2))
                    temp1223b0 = (9*(rmu(1, 0)*temp1222)+pi*2*(temp1221*&
&                      temp1225))*temp1223b
                    temp1223b1 = temp1223*temp1224*temp1223b
                    temp1222b = 9*rmu(1, 0)*temp1223b1
                    temp1222b0 = pi*2*temp1223b1
                    temp1221b = temp1225*temp1222b0/cellscale(1)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp1224*rmu(3&
&                      , 0)*temp1223b0
                    rmub(3, 0) = rmub(3, 0) + temp1221*7*2*rmu(3, 0)*&
&                      temp1222b0 + temp1224*fun0*temp1223b0
                    rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*&
&                      temp1222b + temp1223*rmucos(3, 0)*temp1223b0
                    hess4fb(2) = 0.0_8
                    temp1221b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1221b0 + fun0*der4fb(2)
                    temp1220 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1219 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                    temp1219b = cost2g*(temp1219*temp1220-6*(rmu(1, 0)**&
&                      2*rmucos(1, 0)**2))*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1219b &
&                      + temp1223*rmucos(1, 0)*temp1223b0
                    rmub(1, 0) = rmub(1, 0) + 9*temp1222*temp1223b1
                    temp1219b0 = cost2g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                    rmusinb(1, 0) = rmusinb(1, 0) + temp1221b - temp1220&
&                      *2*rmusin(1, 0)*temp1219b0 - 2*rmusin(1, 0)*&
&                      temp1222b
                    cellscaleb(1) = cellscaleb(1) - temp1221*temp1221b
                    rp0b = rp0b - temp1219*3*temp1219b0 - temp1221*3*&
&                      temp1222b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1221b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + temp1219*7*2*rmu(3, 0)*&
&                      temp1219b0 + rmucos(3, 0)*temp1219b
                    rmucosb(1, 0) = rmucosb(1, 0) + (temp1220*2*rmucos(1&
&                      , 0)-6*rmu(1, 0)**2*2*rmucos(1, 0))*temp1219b0
                    rmub(1, 0) = rmub(1, 0) - 6*rmucos(1, 0)**2*2*rmu(1&
&                      , 0)*temp1219b0
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 7) THEN
                  IF (branch .LT. 6) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1229 = rmu(3, 0)*rmucos(1, 0)
                    temp1228 = fun0*rmu(1, 0)*rmucos(3, 0)
                    temp1229b = cost2g*6*hess4fb(2)
                    temp1229b0 = (rmusin(2, 0)**2-rmucos(2, 0)**2)*&
&                      temp1229b
                    temp1228b = temp1229*temp1229b0
                    temp1228b0 = temp1228*temp1229*temp1229b
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(1, 0)*temp1228b
                    rmub(1, 0) = rmub(1, 0) + rmucos(3, 0)*fun0*&
&                      temp1228b
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                      temp1228b
                    rmub(3, 0) = rmub(3, 0) + temp1228*rmucos(1, 0)*&
&                      temp1229b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1228*rmu(3, 0)*&
&                      temp1229b0
                    rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                      temp1228b0
                    rmucosb(2, 0) = rmucosb(2, 0) - 2*rmucos(2, 0)*&
&                      temp1228b0
                    hess4fb(2) = 0.0_8
                    temp1228b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1228b1 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1228b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1227 = rmu(3, 0)*rmucos(1, 0)
                    temp1226 = rmu(1, 0)*rmu(2, 0)
                    temp1226b = -(cost2g*6*der4fb(2))
                    temp1226b0 = rmucos(2, 0)*rmucos(3, 0)*temp1226b
                    temp1226b1 = temp1226*temp1227*temp1226b
                    rmub(1, 0) = rmub(1, 0) + temp1227*rmu(2, 0)*&
&                      temp1226b0
                    rmub(2, 0) = rmub(2, 0) + temp1227*rmu(1, 0)*&
&                      temp1226b0
                    rmub(3, 0) = rmub(3, 0) + temp1226*rmucos(1, 0)*&
&                      temp1226b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1226*rmu(3, 0)*&
&                      temp1226b0
                    rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                      temp1226b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                      temp1226b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 8) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1233 = rp0/cellscale(3)
                  temp1236 = 6*rmucos(3, 0)**2 - 13*rmusin(3, 0)**2
                  temp1235 = rmucos(1, 0)*rmucos(3, 0)
                  temp1234 = fun0*rmu(1, 0)
                  temp1234b = cost2g*4*hess4fb(2)
                  temp1234b0 = (rmu(3, 0)*temp1236+pi*3*(rmusin(3, 0)*&
&                    temp1233))*temp1234b
                  temp1234b1 = temp1234*temp1235*temp1234b
                  temp1234b2 = pi*3*temp1234b1
                  temp1233b = rmusin(3, 0)*temp1234b2/cellscale(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1235*rmu(1, 0&
&                    )*temp1234b0
                  rmub(1, 0) = rmub(1, 0) + temp1235*fun0*temp1234b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1234*rmucos(3, 0)*&
&                    temp1234b0
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*6*2*rmucos(3&
&                    , 0)*temp1234b1 + temp1234*rmucos(1, 0)*temp1234b0
                  rmub(3, 0) = rmub(3, 0) + temp1236*temp1234b1
                  hess4fb(2) = 0.0_8
                  temp1233b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1233b0 + fun0*der4fb(2)
                  temp1231 = rmu(3, 0)**2
                  temp1231b = cost2g*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
                  temp1230b = 3*rp0*temp1231b
                  rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                    temp1230b - temp1231*7*2*rmusin(3, 0)*temp1231b + &
&                    temp1233*temp1234b2 - rmu(3, 0)*13*2*rmusin(3, 0)*&
&                    temp1234b1
                  temp1230 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                  rp0b = rp0b + 3*temp1230*temp1231b + temp1233b
                  cellscaleb(3) = cellscaleb(3) - temp1233*temp1233b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1233b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1232 = 15*rmucos(3, 0)**2 - 7*rmusin(3, 0)**2
                  temp1231b0 = cost2g*(temp1231*temp1232+3*(temp1230*rp0&
&                    ))*der4fb(2)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1231b0
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1231b0
                  rmub(3, 0) = rmub(3, 0) + temp1232*2*rmu(3, 0)*&
&                    temp1231b
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1231*15*2*rmucos(3&
&                    , 0)*temp1231b - 2*rmucos(3, 0)*temp1230b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1240 = rmu(3, 0)*rmucos(2, 0)
                  temp1239 = fun0*rmu(2, 0)*rmucos(3, 0)
                  temp1240b = cost2g*6*hess4fb(2)
                  temp1240b0 = (rmusin(1, 0)**2-rmucos(1, 0)**2)*&
&                    temp1240b
                  temp1239b = temp1240*temp1240b0
                  temp1239b0 = temp1239*temp1240*temp1240b
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(&
&                    2, 0)*temp1239b
                  rmub(2, 0) = rmub(2, 0) + rmucos(3, 0)*fun0*temp1239b
                  rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*&
&                    temp1239b
                  rmub(3, 0) = rmub(3, 0) + temp1239*rmucos(2, 0)*&
&                    temp1240b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1239*rmu(3, 0)*&
&                    temp1240b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1239b0
                  hess4fb(2) = 0.0_8
                  temp1239b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1239b1 + fun0*der4fb(2)
                  temp1237 = rmu(1, 0)*rmu(2, 0)
                  temp1237b = -(cost2g*6*der4fb(2))
                  temp1237b0 = rmucos(2, 0)*rmucos(3, 0)*temp1237b
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1237*rmu(3, 0)*&
&                    temp1237b0 - 2*rmucos(1, 0)*temp1239b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1239b1
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1238 = rmu(3, 0)*rmucos(1, 0)
                  temp1237b1 = temp1237*temp1238*temp1237b
                  rmub(1, 0) = rmub(1, 0) + temp1238*rmu(2, 0)*&
&                    temp1237b0
                  rmub(2, 0) = rmub(2, 0) + temp1238*rmu(1, 0)*&
&                    temp1237b0
                  rmub(3, 0) = rmub(3, 0) + temp1237*rmucos(1, 0)*&
&                    temp1237b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                    temp1237b1
                  rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                    temp1237b1
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 13) THEN
                IF (branch .LT. 11) THEN
                  IF (branch .LT. 10) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1247 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1243 = rmusin(2, 0)/cellscale(2)
                    temp1244 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                    temp1246 = rmucos(2, 0)*rmucos(3, 0)
                    temp1245 = fun0*rmu(3, 0)
                    temp1245b = -(cost2g*2*hess4fb(2))
                    temp1245b0 = (9*(rmu(2, 0)*temp1244)+pi*2*(temp1243*&
&                      temp1247))*temp1245b
                    temp1245b1 = temp1245*temp1246*temp1245b
                    temp1244b = 9*rmu(2, 0)*temp1245b1
                    temp1244b0 = pi*2*temp1245b1
                    temp1243b = temp1247*temp1244b0/cellscale(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp1246*rmu(3&
&                      , 0)*temp1245b0
                    rmub(3, 0) = rmub(3, 0) + temp1243*7*2*rmu(3, 0)*&
&                      temp1244b0 + temp1246*fun0*temp1245b0
                    rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*&
&                      temp1244b + temp1245*rmucos(3, 0)*temp1245b0
                    hess4fb(2) = 0.0_8
                    temp1243b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1243b0 + fun0*der4fb(2)
                    temp1242 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1241 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                    temp1241b = cost2g*(temp1241*temp1242-6*(rmu(2, 0)**&
&                      2*rmucos(2, 0)**2))*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1241b &
&                      + temp1245*rmucos(2, 0)*temp1245b0
                    rmub(2, 0) = rmub(2, 0) + 9*temp1244*temp1245b1
                    temp1241b0 = cost2g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                    rmusinb(2, 0) = rmusinb(2, 0) + temp1243b - temp1242&
&                      *2*rmusin(2, 0)*temp1241b0 - 2*rmusin(2, 0)*&
&                      temp1244b
                    cellscaleb(2) = cellscaleb(2) - temp1243*temp1243b
                    rp0b = rp0b - temp1241*3*temp1241b0 - temp1243*3*&
&                      temp1244b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1243b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + temp1241*7*2*rmu(3, 0)*&
&                      temp1241b0 + rmucos(3, 0)*temp1241b
                    rmucosb(2, 0) = rmucosb(2, 0) + (temp1242*2*rmucos(2&
&                      , 0)-6*rmu(2, 0)**2*2*rmucos(2, 0))*temp1241b0
                    rmub(2, 0) = rmub(2, 0) - 6*rmucos(2, 0)**2*2*rmu(2&
&                      , 0)*temp1241b0
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 12) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1251 = rp0/cellscale(3)
                  temp1254 = 6*rmucos(3, 0)**2 - 13*rmusin(3, 0)**2
                  temp1253 = rmucos(2, 0)*rmucos(3, 0)
                  temp1252 = fun0*rmu(2, 0)
                  temp1252b = cost2g*4*hess4fb(2)
                  temp1252b0 = (rmu(3, 0)*temp1254+pi*3*(rmusin(3, 0)*&
&                    temp1251))*temp1252b
                  temp1252b1 = temp1252*temp1253*temp1252b
                  temp1252b2 = pi*3*temp1252b1
                  temp1251b = rmusin(3, 0)*temp1252b2/cellscale(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1253*rmu(2, 0&
&                    )*temp1252b0
                  rmub(2, 0) = rmub(2, 0) + temp1253*fun0*temp1252b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1252*rmucos(3, 0)*&
&                    temp1252b0
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*6*2*rmucos(3&
&                    , 0)*temp1252b1 + temp1252*rmucos(2, 0)*temp1252b0
                  rmub(3, 0) = rmub(3, 0) + temp1254*temp1252b1
                  hess4fb(2) = 0.0_8
                  temp1251b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1251b0 + fun0*der4fb(2)
                  temp1249 = rmu(3, 0)**2
                  temp1249b = cost2g*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                  temp1248b = 3*rp0*temp1249b
                  rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                    temp1248b - temp1249*7*2*rmusin(3, 0)*temp1249b + &
&                    temp1251*temp1252b2 - rmu(3, 0)*13*2*rmusin(3, 0)*&
&                    temp1252b1
                  temp1248 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                  rp0b = rp0b + 3*temp1248*temp1249b + temp1251b
                  cellscaleb(3) = cellscaleb(3) - temp1251*temp1251b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1251b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1250 = 15*rmucos(3, 0)**2 - 7*rmusin(3, 0)**2
                  temp1249b0 = cost2g*(temp1249*temp1250+3*(temp1248*rp0&
&                    ))*der4fb(2)
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1249b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1249b0
                  rmub(3, 0) = rmub(3, 0) + temp1250*2*rmu(3, 0)*&
&                    temp1249b
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1249*15*2*rmucos(3&
&                    , 0)*temp1249b - 2*rmucos(3, 0)*temp1248b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1255 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                  temp1257 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                  temp1256 = rmu(1, 0)**2
                  temp1256b = -(cost3g*4*hess4fb(2))
                  temp1256b0 = fun0*temp1256b
                  temp1255b = 3*rmu(3, 0)**2*temp1256b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (temp1256*&
&                    temp1257+3*(rmu(3, 0)**2*temp1255))*temp1256b
                  rmub(1, 0) = rmub(1, 0) + temp1257*2*rmu(1, 0)*&
&                    temp1256b0
                  hess4fb(2) = 0.0_8
                  temp1255b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1255b0 + fun0*der4fb(2)
                  temp1255b1 = -(cost3g*4*der4fb(2))
                  temp1255b2 = (rmu(1, 0)**2-3*rmu(3, 0)**2)*temp1255b1
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1255b2 -&
&                    2*rmucos(1, 0)*temp1255b + temp1256*3*2*rmucos(1, 0)&
&                    *temp1256b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1255b - temp1256*2*rmusin(1, 0)*temp1256b0
                  rmub(3, 0) = rmub(3, 0) + 3*temp1255*2*rmu(3, 0)*&
&                    temp1256b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1255b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1255b3 = rmu(1, 0)*rmucos(1, 0)*temp1255b1
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1255b2 + 2*&
&                    rmu(1, 0)*temp1255b3
                  rmub(3, 0) = rmub(3, 0) - 3*2*rmu(3, 0)*temp1255b3
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1258 = rmusin(2, 0)**2 - rmucos(2, 0)**2
                  temp1260 = 3*rmucos(2, 0)**2 - rmusin(2, 0)**2
                  temp1259 = rmu(2, 0)**2
                  temp1259b = cost3g*4*hess4fb(2)
                  temp1259b0 = fun0*temp1259b
                  temp1258b = 3*rmu(3, 0)**2*temp1259b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (temp1259*&
&                    temp1260+3*(rmu(3, 0)**2*temp1258))*temp1259b
                  rmub(2, 0) = rmub(2, 0) + temp1260*2*rmu(2, 0)*&
&                    temp1259b0
                  hess4fb(2) = 0.0_8
                  temp1258b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1258b0 + fun0*der4fb(2)
                  temp1258b1 = cost3g*4*der4fb(2)
                  temp1258b2 = (rmu(2, 0)**2-3*rmu(3, 0)**2)*temp1258b1
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1258b2 -&
&                    2*rmucos(2, 0)*temp1258b + temp1259*3*2*rmucos(2, 0)&
&                    *temp1259b0
                  rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                    temp1258b - temp1259*2*rmusin(2, 0)*temp1259b0
                  rmub(3, 0) = rmub(3, 0) + 3*temp1258*2*rmu(3, 0)*&
&                    temp1259b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1258b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1258b3 = rmu(2, 0)*rmucos(2, 0)*temp1258b1
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1258b2 + 2*&
&                    rmu(2, 0)*temp1258b3
                  rmub(3, 0) = rmub(3, 0) - 3*2*rmu(3, 0)*temp1258b3
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 16) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1261 = rmu(1, 0)**2 - rmu(2, 0)**2
                temp1261b = cost3g*12*hess4fb(2)
                temp1261b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp1261b
                temp1261b1 = fun0*temp1261*temp1261b
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1261*temp1261b0
                rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp1261b0
                rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp1261b0
                hess4fb(2) = 0.0_8
                temp1261b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1261b2 + fun0*der4fb(2)
                temp1261b3 = cost3g*12*der4fb(2)
                temp1261b4 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp1261b3
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1261b4 + 2&
&                  *rmucos(3, 0)*temp1261b1
                rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*&
&                  temp1261b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1261b2
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1261b5 = rmu(3, 0)*rmucos(3, 0)*temp1261b3
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp1261b5
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp1261b5
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1261b4
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1270 = 5*rmusin(1, 0)**2 - 3*rmucos(1, 0)**2
                temp1266 = rmusin(1, 0)/cellscale(1)
                temp1269 = rmu(2, 0)**2 - 6*rmu(3, 0)**2
                temp1268 = rmucos(1, 0)*rmucos(2, 0)
                temp1267 = fun0*rmu(2, 0)
                temp1267b = cost3g*4*hess4fb(2)
                temp1267b0 = (pi*2*(temp1269*temp1266)+rmu(1, 0)*&
&                  temp1270)*temp1267b
                temp1267b1 = temp1267*temp1268*temp1267b
                temp1267b2 = pi*2*temp1267b1
                temp1266b = temp1269*temp1267b2/cellscale(1)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1268*rmu(2, 0)*&
&                  temp1267b0
                rmub(2, 0) = rmub(2, 0) + temp1266*2*rmu(2, 0)*&
&                  temp1267b2 + temp1268*fun0*temp1267b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1267*rmucos(2, 0)*&
&                  temp1267b0 - rmu(1, 0)*3*2*rmucos(1, 0)*temp1267b1
                hess4fb(2) = 0.0_8
                temp1266b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1266b0 + fun0*der4fb(2)
                temp1265 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1264 = rmu(1, 0)**2
                temp1263 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1262 = rmu(2, 0)**2 - 6*rmu(3, 0)**2
                temp1262b = -(cost3g*2*der4fb(2))
                temp1262b0 = (temp1262*temp1263+temp1264*temp1265)*&
&                  temp1262b
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1262b0 + &
&                  temp1267*rmucos(1, 0)*temp1267b0
                rmub(3, 0) = rmub(3, 0) - temp1266*6*2*rmu(3, 0)*&
&                  temp1267b2
                temp1262b1 = rmu(2, 0)*rmucos(2, 0)*temp1262b
                rmusinb(1, 0) = rmusinb(1, 0) + (-(temp1264*2*rmusin(1, &
&                  0))-temp1262*2*rmusin(1, 0))*temp1262b1 + rmu(1, 0)*5*&
&                  2*rmusin(1, 0)*temp1267b1 + temp1266b
                cellscaleb(1) = cellscaleb(1) - temp1266*temp1266b
                rmub(1, 0) = rmub(1, 0) + temp1270*temp1267b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1266b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + temp1263*2*rmu(2, 0)*&
&                  temp1262b1 + rmucos(2, 0)*temp1262b0
                rmub(3, 0) = rmub(3, 0) - temp1263*6*2*rmu(3, 0)*&
&                  temp1262b1
                rmucosb(1, 0) = rmucosb(1, 0) + (temp1264*3*2*rmucos(1, &
&                  0)+temp1262*2*rmucos(1, 0))*temp1262b1
                rmub(1, 0) = rmub(1, 0) + temp1265*2*rmu(1, 0)*&
&                  temp1262b1
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 26) THEN
              IF (branch .LT. 22) THEN
                IF (branch .LT. 20) THEN
                  IF (branch .LT. 19) THEN
                    IF (branch .LT. 18) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp1280 = 5*rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                      temp1276 = rmusin(2, 0)/cellscale(2)
                      temp1279 = rmu(1, 0)**2 - 6*rmu(3, 0)**2
                      temp1278 = rmucos(1, 0)*rmucos(2, 0)
                      temp1277 = fun0*rmu(1, 0)
                      temp1277b = cost3g*4*hess4fb(2)
                      temp1277b0 = (pi*2*(temp1279*temp1276)+rmu(2, 0)*&
&                        temp1280)*temp1277b
                      temp1277b1 = temp1277*temp1278*temp1277b
                      temp1277b2 = pi*2*temp1277b1
                      temp1276b = temp1279*temp1277b2/cellscale(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + temp1278*rmu(&
&                        1, 0)*temp1277b0
                      rmub(1, 0) = rmub(1, 0) + temp1276*2*rmu(1, 0)*&
&                        temp1277b2 + temp1278*fun0*temp1277b0
                      rmucosb(1, 0) = rmucosb(1, 0) + temp1277*rmucos(2&
&                        , 0)*temp1277b0
                      rmucosb(2, 0) = rmucosb(2, 0) + temp1277*rmucos(1&
&                        , 0)*temp1277b0 - rmu(2, 0)*3*2*rmucos(2, 0)*&
&                        temp1277b1
                      rmub(3, 0) = rmub(3, 0) - temp1276*6*2*rmu(3, 0)*&
&                        temp1277b2
                      hess4fb(2) = 0.0_8
                      temp1276b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp1276b0 + fun0*der4fb(2)
                      temp1274 = rmu(2, 0)**2
                      temp1272 = rmu(1, 0)**2
                      temp1272b = -(cost3g*2*der4fb(2))
                      temp1272b0 = rmu(1, 0)*rmucos(1, 0)*temp1272b
                      temp1271b = 6*rmu(3, 0)**2*temp1272b0
                      rmusinb(2, 0) = rmusinb(2, 0) + (-(temp1274*2*&
&                        rmusin(2, 0))-temp1272*2*rmusin(2, 0))*&
&                        temp1272b0 + 2*rmusin(2, 0)*temp1271b + rmu(2, 0&
&                        )*5*2*rmusin(2, 0)*temp1277b1 + temp1276b
                      cellscaleb(2) = cellscaleb(2) - temp1276*temp1276b
                      rmub(2, 0) = rmub(2, 0) + temp1280*temp1277b1
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp1276b0
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp1271 = rmusin(2, 0)**2 - rmucos(2, 0)**2
                      temp1275 = 3*rmucos(2, 0)**2 - rmusin(2, 0)**2
                      temp1273 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                      temp1272b1 = (temp1272*temp1273+temp1274*temp1275+&
&                        6*(rmu(3, 0)**2*temp1271))*temp1272b
                      rmub(1, 0) = rmub(1, 0) + temp1273*2*rmu(1, 0)*&
&                        temp1272b0 + rmucos(1, 0)*temp1272b1
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp1272b1
                      rmucosb(2, 0) = rmucosb(2, 0) + (temp1274*3*2*&
&                        rmucos(2, 0)+temp1272*2*rmucos(2, 0))*temp1272b0&
&                        - 2*rmucos(2, 0)*temp1271b
                      rmub(2, 0) = rmub(2, 0) + temp1275*2*rmu(2, 0)*&
&                        temp1272b0
                      rmub(3, 0) = rmub(3, 0) + 6*temp1271*2*rmu(3, 0)*&
&                        temp1272b0
                      der4fb(2) = 0.0_8
                    END IF
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1284 = rmu(2, 0)*rmucos(1, 0)
                    temp1283 = fun0*rmu(1, 0)*rmucos(2, 0)
                    temp1284b = cost3g*24*hess4fb(2)
                    temp1284b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                      temp1284b
                    temp1283b = temp1284*temp1284b0
                    temp1283b0 = temp1283*temp1284*temp1284b
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*&
&                      rmu(1, 0)*temp1283b
                    rmub(1, 0) = rmub(1, 0) + rmucos(2, 0)*fun0*&
&                      temp1283b
                    rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*&
&                      temp1283b
                    rmub(2, 0) = rmub(2, 0) + temp1283*rmucos(1, 0)*&
&                      temp1284b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1283*rmu(2, 0)*&
&                      temp1284b0
                    rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*&
&                      temp1283b0
                    rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*&
&                      temp1283b0
                    hess4fb(2) = 0.0_8
                    temp1283b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1283b1 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1283b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1282 = rmu(3, 0)*rmucos(1, 0)
                    temp1281 = rmu(1, 0)*rmu(2, 0)
                    temp1281b = cost3g*24*der4fb(2)
                    temp1281b0 = rmucos(2, 0)*rmucos(3, 0)*temp1281b
                    temp1281b1 = temp1281*temp1282*temp1281b
                    rmub(1, 0) = rmub(1, 0) + temp1282*rmu(2, 0)*&
&                      temp1281b0
                    rmub(2, 0) = rmub(2, 0) + temp1282*rmu(1, 0)*&
&                      temp1281b0
                    rmub(3, 0) = rmub(3, 0) + temp1281*rmucos(1, 0)*&
&                      temp1281b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1281*rmu(3, 0)*&
&                      temp1281b0
                    rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                      temp1281b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                      temp1281b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 21) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1291 = 3*rmucos(1, 0)**2 - 5*rmusin(1, 0)**2
                  temp1288 = rmusin(1, 0)/cellscale(1)
                  temp1290 = rmucos(1, 0)*rmucos(3, 0)
                  temp1289 = fun0*rmu(3, 0)
                  temp1289b = cost4g*2*hess4fb(2)
                  temp1289b0 = (pi*6*(rmu(2, 0)**2*temp1288)+rmu(1, 0)*&
&                    temp1291)*temp1289b
                  temp1289b1 = temp1289*temp1290*temp1289b
                  temp1289b2 = pi*6*temp1289b1
                  temp1288b = rmu(2, 0)**2*temp1289b2/cellscale(1)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1290*rmu(3, 0&
&                    )*temp1289b0
                  rmub(3, 0) = rmub(3, 0) + temp1290*fun0*temp1289b0
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*3*2*rmucos(1&
&                    , 0)*temp1289b1 + temp1289*rmucos(3, 0)*temp1289b0
                  hess4fb(2) = 0.0_8
                  temp1288b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1288b0 + fun0*der4fb(2)
                  temp1285 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                  temp1287 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                  temp1286 = rmu(1, 0)**2
                  temp1286b = cost4g*(temp1286*temp1287+3*(rmu(2, 0)**2*&
&                    temp1285))*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1286b + &
&                    temp1289*rmucos(1, 0)*temp1289b0
                  rmub(2, 0) = rmub(2, 0) + temp1288*2*rmu(2, 0)*&
&                    temp1289b2
                  temp1286b0 = cost4g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                  temp1285b = 3*rmu(2, 0)**2*temp1286b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1285b - temp1286*2*rmusin(1, 0)*temp1286b0 - rmu&
&                    (1, 0)*5*2*rmusin(1, 0)*temp1289b1 + temp1288b
                  cellscaleb(1) = cellscaleb(1) - temp1288*temp1288b
                  rmub(1, 0) = rmub(1, 0) + temp1291*temp1289b1
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1288b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1286b
                  rmub(1, 0) = rmub(1, 0) + temp1287*2*rmu(1, 0)*&
&                    temp1286b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1286*3*2*rmucos(1&
&                    , 0)*temp1286b0 - 2*rmucos(1, 0)*temp1285b
                  rmub(2, 0) = rmub(2, 0) + 3*temp1285*2*rmu(2, 0)*&
&                    temp1286b0
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1295 = rmu(3, 0)*rmucos(1, 0)
                  temp1294 = fun0*rmu(1, 0)*rmucos(3, 0)
                  temp1295b = cost4g*6*hess4fb(2)
                  temp1295b0 = (rmusin(2, 0)**2-rmucos(2, 0)**2)*&
&                    temp1295b
                  temp1294b = temp1295*temp1295b0
                  temp1294b0 = temp1294*temp1295*temp1295b
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(&
&                    1, 0)*temp1294b
                  rmub(1, 0) = rmub(1, 0) + rmucos(3, 0)*fun0*temp1294b
                  rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                    temp1294b
                  rmub(3, 0) = rmub(3, 0) + temp1294*rmucos(1, 0)*&
&                    temp1295b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1294*rmu(3, 0)*&
&                    temp1295b0
                  rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                    temp1294b0
                  rmucosb(2, 0) = rmucosb(2, 0) - 2*rmucos(2, 0)*&
&                    temp1294b0
                  hess4fb(2) = 0.0_8
                  temp1294b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1294b1 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1294b1
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1293 = rmu(3, 0)*rmucos(1, 0)
                  temp1292 = rmu(1, 0)*rmu(2, 0)
                  temp1292b = -(cost4g*6*der4fb(2))
                  temp1292b0 = rmucos(2, 0)*rmucos(3, 0)*temp1292b
                  temp1292b1 = temp1292*temp1293*temp1292b
                  rmub(1, 0) = rmub(1, 0) + temp1293*rmu(2, 0)*&
&                    temp1292b0
                  rmub(2, 0) = rmub(2, 0) + temp1293*rmu(1, 0)*&
&                    temp1292b0
                  rmub(3, 0) = rmub(3, 0) + temp1292*rmucos(1, 0)*&
&                    temp1292b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1292*rmu(3, 0)*&
&                    temp1292b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                    temp1292b1
                  rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                    temp1292b1
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 24) THEN
                IF (.NOT.branch .LT. 23) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1298 = fun0/cellscale(3)
                  temp1301 = rmu(1, 0)*rmucos(1, 0)
                  temp1300 = rmucos(3, 0)*rmusin(3, 0)
                  temp1299 = rmu(1, 0)**2 - 3*rmu(2, 0)**2
                  temp1299b = -(cost4g*4*pi*hess4fb(2))
                  temp1299b0 = temp1301*temp1298*temp1299b
                  temp1299b1 = temp1299*temp1300*temp1299b
                  temp1298b = temp1301*temp1299b1/cellscale(3)
                  rmub(1, 0) = rmub(1, 0) + temp1298*rmucos(1, 0)*&
&                    temp1299b1 + temp1300*2*rmu(1, 0)*temp1299b0
                  rmub(2, 0) = rmub(2, 0) - temp1300*3*2*rmu(2, 0)*&
&                    temp1299b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1299*rmusin(3, 0)*&
&                    temp1299b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1298b
                  hess4fb(2) = 0.0_8
                  temp1298b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1298b0 + fun0*der4fb(2)
                  temp1296 = rmu(1, 0)*rmucos(1, 0)
                  temp1296b = cost4g*(rmu(1, 0)**2-3*rmu(2, 0)**2)*&
&                    der4fb(2)
                  rmusinb(3, 0) = rmusinb(3, 0) + temp1299*rmucos(3, 0)*&
&                    temp1299b0 - temp1296*2*rmusin(3, 0)*temp1296b
                  temp1297 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1297*rmu(1, 0)*&
&                    temp1296b + temp1298*rmu(1, 0)*temp1299b1
                  cellscaleb(3) = cellscaleb(3) - temp1298*temp1298b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1298b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1296b0 = cost4g*temp1296*temp1297*der4fb(2)
                  rmub(1, 0) = rmub(1, 0) + temp1297*rmucos(1, 0)*&
&                    temp1296b + 2*rmu(1, 0)*temp1296b0
                  rmub(2, 0) = rmub(2, 0) - 3*2*rmu(2, 0)*temp1296b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1296*2*rmucos(3, 0&
&                    )*temp1296b
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 25) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1305 = rmu(3, 0)*rmucos(2, 0)
                temp1304 = fun0*rmu(2, 0)*rmucos(3, 0)
                temp1305b = cost4g*6*hess4fb(2)
                temp1305b0 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp1305b
                temp1304b = temp1305*temp1305b0
                temp1304b0 = temp1304*temp1305*temp1305b
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(2&
&                  , 0)*temp1304b
                rmub(2, 0) = rmub(2, 0) + rmucos(3, 0)*fun0*temp1304b
                rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*temp1304b
                rmub(3, 0) = rmub(3, 0) + temp1304*rmucos(2, 0)*&
&                  temp1305b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp1304*rmu(3, 0)*&
&                  temp1305b0
                hess4fb(2) = 0.0_8
                temp1304b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1304b1 + fun0*der4fb(2)
                temp1302 = rmu(1, 0)*rmu(2, 0)
                temp1302b = cost4g*6*der4fb(2)
                temp1302b0 = rmucos(2, 0)*rmucos(3, 0)*temp1302b
                rmucosb(1, 0) = rmucosb(1, 0) + temp1302*rmu(3, 0)*&
&                  temp1302b0 + 2*rmucos(1, 0)*temp1304b0
                rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*&
&                  temp1304b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1304b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1303 = rmu(3, 0)*rmucos(1, 0)
                temp1302b1 = temp1302*temp1303*temp1302b
                rmub(1, 0) = rmub(1, 0) + temp1303*rmu(2, 0)*temp1302b0
                rmub(2, 0) = rmub(2, 0) + temp1303*rmu(1, 0)*temp1302b0
                rmub(3, 0) = rmub(3, 0) + temp1302*rmucos(1, 0)*&
&                  temp1302b0
                rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*temp1302b1
                rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*temp1302b1
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1312 = 3*rmucos(2, 0)**2 - 5*rmusin(2, 0)**2
                temp1309 = rmusin(2, 0)/cellscale(2)
                temp1311 = rmucos(2, 0)*rmucos(3, 0)
                temp1310 = fun0*rmu(3, 0)
                temp1310b = -(cost4g*2*hess4fb(2))
                temp1310b0 = (pi*6*(rmu(1, 0)**2*temp1309)+rmu(2, 0)*&
&                  temp1312)*temp1310b
                temp1310b1 = temp1310*temp1311*temp1310b
                temp1310b2 = pi*6*temp1310b1
                temp1309b = rmu(1, 0)**2*temp1310b2/cellscale(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1311*rmu(3, 0)*&
&                  temp1310b0
                rmub(3, 0) = rmub(3, 0) + temp1311*fun0*temp1310b0
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*3*2*rmucos(2, &
&                  0)*temp1310b1 + temp1310*rmucos(3, 0)*temp1310b0
                hess4fb(2) = 0.0_8
                temp1309b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1309b0 + fun0*der4fb(2)
                temp1308 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                temp1307 = rmu(2, 0)**2
                temp1306 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp1307b = cost4g*(3*(rmu(1, 0)**2*temp1306)+temp1307*&
&                  temp1308)*der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1307b + &
&                  temp1310*rmucos(2, 0)*temp1310b0
                rmub(1, 0) = rmub(1, 0) + temp1309*2*rmu(1, 0)*&
&                  temp1310b2
                temp1307b0 = cost4g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                temp1306b = 3*rmu(1, 0)**2*temp1307b0
                rmusinb(2, 0) = rmusinb(2, 0) + temp1307*2*rmusin(2, 0)*&
&                  temp1307b0 - 2*rmusin(2, 0)*temp1306b - rmu(2, 0)*5*2*&
&                  rmusin(2, 0)*temp1310b1 + temp1309b
                cellscaleb(2) = cellscaleb(2) - temp1309*temp1309b
                rmub(2, 0) = rmub(2, 0) + temp1312*temp1310b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1309b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1307b
                rmub(1, 0) = rmub(1, 0) + 3*temp1306*2*rmu(1, 0)*&
&                  temp1307b0
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp1306b&
&                  - temp1307*3*2*rmucos(2, 0)*temp1307b0
                rmub(2, 0) = rmub(2, 0) + temp1308*2*rmu(2, 0)*&
&                  temp1307b0
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 30) THEN
              IF (branch .LT. 28) THEN
                IF (.NOT.branch .LT. 27) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1315 = fun0/cellscale(3)
                  temp1318 = rmu(2, 0)*rmucos(2, 0)
                  temp1317 = rmucos(3, 0)*rmusin(3, 0)
                  temp1316 = rmu(2, 0)**2 - 3*rmu(1, 0)**2
                  temp1316b = cost4g*4*pi*hess4fb(2)
                  temp1316b0 = temp1318*temp1315*temp1316b
                  temp1316b1 = temp1316*temp1317*temp1316b
                  temp1315b = temp1318*temp1316b1/cellscale(3)
                  rmub(2, 0) = rmub(2, 0) + temp1315*rmucos(2, 0)*&
&                    temp1316b1 + temp1317*2*rmu(2, 0)*temp1316b0
                  rmub(1, 0) = rmub(1, 0) - temp1317*3*2*rmu(1, 0)*&
&                    temp1316b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1316*rmusin(3, 0)*&
&                    temp1316b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1315b
                  hess4fb(2) = 0.0_8
                  temp1315b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1315b0 + fun0*der4fb(2)
                  temp1313 = rmu(2, 0)*rmucos(2, 0)
                  temp1313b = -(cost4g*(rmu(2, 0)**2-3*rmu(1, 0)**2)*&
&                    der4fb(2))
                  rmusinb(3, 0) = rmusinb(3, 0) + temp1316*rmucos(3, 0)*&
&                    temp1316b0 - temp1313*2*rmusin(3, 0)*temp1313b
                  temp1314 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1314*rmu(2, 0)*&
&                    temp1313b + temp1315*rmu(2, 0)*temp1316b1
                  cellscaleb(3) = cellscaleb(3) - temp1315*temp1315b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1315b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1313b0 = -(cost4g*temp1313*temp1314*der4fb(2))
                  rmub(2, 0) = rmub(2, 0) + temp1314*rmucos(2, 0)*&
&                    temp1313b + 2*rmu(2, 0)*temp1313b0
                  rmub(1, 0) = rmub(1, 0) - 3*2*rmu(1, 0)*temp1313b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1313*2*rmucos(3, 0&
&                    )*temp1313b
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 29) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1319 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                temp1321 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1320 = rmu(1, 0)**2
                temp1320b = cost5g*4*hess4fb(2)
                temp1320b0 = fun0*temp1320b
                temp1319b = 3*rmu(2, 0)**2*temp1320b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + (temp1320*temp1321+&
&                  3*(rmu(2, 0)**2*temp1319))*temp1320b
                rmub(1, 0) = rmub(1, 0) + temp1321*2*rmu(1, 0)*&
&                  temp1320b0
                hess4fb(2) = 0.0_8
                temp1319b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1319b0 + fun0*der4fb(2)
                temp1319b1 = cost5g*4*der4fb(2)
                temp1319b2 = (rmu(1, 0)**2-3*rmu(2, 0)**2)*temp1319b1
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1319b2 - 2&
&                  *rmucos(1, 0)*temp1319b + temp1320*3*2*rmucos(1, 0)*&
&                  temp1320b0
                rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*temp1319b&
&                  - temp1320*2*rmusin(1, 0)*temp1320b0
                rmub(2, 0) = rmub(2, 0) + 3*temp1319*2*rmu(2, 0)*&
&                  temp1320b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1319b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1319b3 = rmu(1, 0)*rmucos(1, 0)*temp1319b1
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1319b2 + 2*&
&                  rmu(1, 0)*temp1319b3
                rmub(2, 0) = rmub(2, 0) - 3*2*rmu(2, 0)*temp1319b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1324 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                temp1323 = rmu(2, 0)**2
                temp1322 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp1323b = -(cost5g*4*hess4fb(2))
                temp1323b0 = fun0*temp1323b
                temp1322b = 3*rmu(1, 0)**2*temp1323b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + (3*(rmu(1, 0)**2*&
&                  temp1322)+temp1323*temp1324)*temp1323b
                rmub(1, 0) = rmub(1, 0) + 3*temp1322*2*rmu(1, 0)*&
&                  temp1323b0
                hess4fb(2) = 0.0_8
                temp1322b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1322b0 + fun0*der4fb(2)
                temp1322b1 = cost5g*4*der4fb(2)
                temp1322b2 = (rmu(2, 0)**2-3*rmu(1, 0)**2)*temp1322b1
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1322b2 - &
&                  temp1323*3*2*rmucos(2, 0)*temp1323b0 + 2*rmucos(2, 0)*&
&                  temp1322b
                rmusinb(2, 0) = rmusinb(2, 0) + temp1323*2*rmusin(2, 0)*&
&                  temp1323b0 - 2*rmusin(2, 0)*temp1322b
                rmub(2, 0) = rmub(2, 0) + temp1324*2*rmu(2, 0)*&
&                  temp1323b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1322b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1322b3 = rmu(2, 0)*rmucos(2, 0)*temp1322b1
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1322b2 + 2*&
&                  rmu(2, 0)*temp1322b3
                rmub(1, 0) = rmub(1, 0) - 3*2*rmu(1, 0)*temp1322b3
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 32) THEN
              IF (branch .LT. 31) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1332 = 3*rmucos(1, 0)**2 - 5*rmusin(1, 0)**2
                temp1329 = rmusin(1, 0)/cellscale(1)
                temp1331 = rmucos(1, 0)*rmucos(2, 0)
                temp1330 = fun0*rmu(2, 0)
                temp1330b = cost5g*8*hess4fb(2)
                temp1330b0 = (pi*2*(rmu(2, 0)**2*temp1329)+rmu(1, 0)*&
&                  temp1332)*temp1330b
                temp1330b1 = temp1330*temp1331*temp1330b
                temp1330b2 = pi*2*temp1330b1
                temp1329b = rmu(2, 0)**2*temp1330b2/cellscale(1)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1331*rmu(2, 0)*&
&                  temp1330b0
                rmub(2, 0) = rmub(2, 0) + temp1329*2*rmu(2, 0)*&
&                  temp1330b2 + temp1331*fun0*temp1330b0
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*3*2*rmucos(1, &
&                  0)*temp1330b1 + temp1330*rmucos(2, 0)*temp1330b0
                hess4fb(2) = 0.0_8
                temp1329b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1329b0 + fun0*der4fb(2)
                temp1328 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                temp1327 = rmu(2, 0)**2
                temp1326 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1325 = rmu(1, 0)**2
                temp1325b = cost5g*4*der4fb(2)
                temp1325b0 = (temp1325*temp1326+temp1327*temp1328)*&
&                  temp1325b
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1325b0 + &
&                  temp1330*rmucos(1, 0)*temp1330b0
                temp1325b1 = rmu(2, 0)*rmucos(2, 0)*temp1325b
                rmusinb(1, 0) = rmusinb(1, 0) + (temp1327*2*rmusin(1, 0)&
&                  -temp1325*2*rmusin(1, 0))*temp1325b1 - rmu(1, 0)*5*2*&
&                  rmusin(1, 0)*temp1330b1 + temp1329b
                cellscaleb(1) = cellscaleb(1) - temp1329*temp1329b
                rmub(1, 0) = rmub(1, 0) + temp1332*temp1330b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1329b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + temp1328*2*rmu(2, 0)*&
&                  temp1325b1 + rmucos(2, 0)*temp1325b0
                rmub(1, 0) = rmub(1, 0) + temp1326*2*rmu(1, 0)*&
&                  temp1325b1
                rmucosb(1, 0) = rmucosb(1, 0) + (temp1325*3*2*rmucos(1, &
&                  0)-temp1327*2*rmucos(1, 0))*temp1325b1
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 33) THEN
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              temp1340 = 3*rmucos(2, 0)**2 - 5*rmusin(2, 0)**2
              temp1337 = rmusin(2, 0)/cellscale(2)
              temp1339 = rmucos(1, 0)*rmucos(2, 0)
              temp1338 = fun0*rmu(1, 0)
              temp1338b = -(cost5g*8*hess4fb(2))
              temp1338b0 = (pi*2*(rmu(1, 0)**2*temp1337)+rmu(2, 0)*&
&                temp1340)*temp1338b
              temp1338b1 = temp1338*temp1339*temp1338b
              temp1338b2 = pi*2*temp1338b1
              temp1337b = rmu(1, 0)**2*temp1338b2/cellscale(2)
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              fun0b = fun0b + der4f(2)*der4fb(2) + temp1339*rmu(1, 0)*&
&                temp1338b0
              rmub(1, 0) = rmub(1, 0) + temp1337*2*rmu(1, 0)*temp1338b2 &
&                + temp1339*fun0*temp1338b0
              rmucosb(1, 0) = rmucosb(1, 0) + temp1338*rmucos(2, 0)*&
&                temp1338b0
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*3*2*rmucos(2, 0)&
&                *temp1338b1 + temp1338*rmucos(1, 0)*temp1338b0
              hess4fb(2) = 0.0_8
              temp1337b0 = 2.d0*rmu(i, 0)*hess4fb(3)
              der4fb(2) = fun*temp1337b0 + fun0*der4fb(2)
              temp1335 = rmu(2, 0)**2
              temp1333 = rmu(1, 0)**2
              temp1333b = cost5g*4*der4fb(2)
              temp1333b0 = rmu(1, 0)*rmucos(1, 0)*temp1333b
              rmusinb(2, 0) = rmusinb(2, 0) + (temp1335*2*rmusin(2, 0)-&
&                temp1333*2*rmusin(2, 0))*temp1333b0 - rmu(2, 0)*5*2*&
&                rmusin(2, 0)*temp1338b1 + temp1337b
              cellscaleb(2) = cellscaleb(2) - temp1337*temp1337b
              rmub(2, 0) = rmub(2, 0) + temp1340*temp1338b1
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
              funb = funb + der4f(2)*temp1337b0
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              temp1336 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
              temp1334 = rmucos(2, 0)**2 - rmusin(2, 0)**2
              temp1333b1 = (temp1333*temp1334+temp1335*temp1336)*&
&                temp1333b
              rmub(1, 0) = rmub(1, 0) + temp1334*2*rmu(1, 0)*temp1333b0 &
&                + rmucos(1, 0)*temp1333b1
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1333b1
              rmucosb(2, 0) = rmucosb(2, 0) + (temp1333*2*rmucos(2, 0)-&
&                temp1335*3*2*rmucos(2, 0))*temp1333b0
              rmub(2, 0) = rmub(2, 0) + temp1336*2*rmu(2, 0)*temp1333b0
              der4fb(2) = 0.0_8
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4fb(2) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp1212b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp1212b
            funb = funb + rmu(i, 0)*temp1212b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp1211 = r(0)**2
        temp1210 = fun2/temp1211
        temp1210b = rmu(i, 0)**2*radhess4fb(i)/temp1211
        temp1209 = r(0)**2
        temp1208 = rmu(i, 0)**2/temp1209
        temp1208b = -(fun*radhess4fb(i)/temp1209)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp1208b + temp1210*2*rmu&
&          (i, 0)*radhess4fb(i)
        fun2b = fun2b + temp1210b
        rb(0) = rb(0) - temp1208*2*r(0)*temp1208b - temp1210*2*r(0)*&
&          temp1210b
        funb = funb + (1.d0-temp1208)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp1207b = distp(0, 1)*fun2b
      temp1207b0 = distp(0, 1)*2.d0*funb
      rb(0) = rb(0) + (21.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp1207b&
&        - distp(0, 1)*2*r(0)*fun0b + dd1*2*r(0)*temp1207b0 + 2*r(0)*rp0b
      temp1207 = r(0)**4
      temp1206 = 4.d0*dd1
      temp1205 = 11.d0/temp1206
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-15.d0/2.d0)*funb&
&        + (temp1205-r(0)**2)*fun0b + (21.d0*(dd1*r(0)**2)-15.d0/2.d0-&
&        4.d0*(dd1**2*temp1207))*fun2b
      dd1b = dd1b + r(0)**2*temp1207b0 - distp(0, 1)*temp1205*4.d0*fun0b&
&        /temp1206 + (21.d0*r(0)**2-4.d0*temp1207*2*dd1)*temp1207b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=9,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp1204 = 4.d0*dd1
          temp1203 = 11.d0/temp1204
          temp1203b = (temp1203-r(k)**2)*zb(indorbp, k)
          temp1202 = distp(k, 1+ic)
          temp1201 = distp(k, 1)*cosphase(k)
          temp1201b = temp1201*temp1202*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + temp1202*cosphase(k)*temp1203b
          cosphaseb(k) = cosphaseb(k) + temp1202*distp(k, 1)*temp1203b
          distpb(k, 1+ic) = distpb(k, 1+ic) + temp1201*temp1203b
          dd1b = dd1b - temp1203*4.d0*temp1201b/temp1204
          rb(k) = rb(k) - 2*r(k)*temp1201b
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp1200 = rmu(2, i)*rmucos(2, i)
      temp1199 = rmu(1, i)*rmucos(1, i)
      temp1199b = cost5g*4.d0*distpb(i, 10)
      temp1199b0 = (rmu(1, i)**2-rmu(2, i)**2)*temp1199b
      temp1199b1 = temp1199*temp1200*temp1199b
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp1199b1 + temp1200*rmucos&
&        (1, i)*temp1199b0
      rmucosb(1, i) = rmucosb(1, i) + temp1200*rmu(1, i)*temp1199b0
      rmub(2, i) = rmub(2, i) + temp1199*rmucos(2, i)*temp1199b0 - 2*rmu&
&        (2, i)*temp1199b1
      distpb(i, 10) = 0.0_8
      temp1199b2 = cost5g*distpb(i, 9)
      distpb(i, 9) = 0.0_8
      temp1198 = rmu(3, i)*rmucos(3, i)
      temp1197b = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      rmucosb(2, i) = rmucosb(2, i) + temp1198*rmu(2, i)*temp1197b + &
&        temp1199*rmu(2, i)*temp1199b0
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp1199b2
      temp1197 = rmu(2, i)*rmucos(2, i)
      temp1197b0 = cost4g*temp1197*temp1198*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + temp1198*rmucos(2, i)*temp1197b - 2*rmu(&
&        2, i)*temp1197b0 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i)&
&        )*temp1199b2
      rmub(3, i) = rmub(3, i) + temp1197*rmucos(3, i)*temp1197b
      rmucosb(3, i) = rmucosb(3, i) + temp1197*rmu(3, i)*temp1197b
      distpb(i, 8) = 0.0_8
      temp1196 = rmu(3, i)*rmucos(3, i)
      temp1195 = rmu(1, i)*rmucos(1, i)
      temp1195b = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp1195b0 = cost4g*temp1195*temp1196*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + temp1196*rmucos(1, i)*temp1195b + 2*rmu(&
&        1, i)*temp1195b0 + 3.d0*2*rmu(1, i)*temp1197b0
      rmucosb(1, i) = rmucosb(1, i) + temp1196*rmu(1, i)*temp1195b
      rmub(3, i) = rmub(3, i) + temp1195*rmucos(3, i)*temp1195b
      rmucosb(3, i) = rmucosb(3, i) + temp1195*rmu(3, i)*temp1195b
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp1195b0
      distpb(i, 7) = 0.0_8
      temp1194 = rmu(2, i)*rmucos(2, i)
      temp1193 = rmu(1, i)*rmucos(1, i)
      temp1193b = cost3g*2.d0*distpb(i, 6)
      temp1193b0 = (7.d0*rmu(3, i)**2-rp0)*temp1193b
      temp1193b1 = temp1193*temp1194*temp1193b
      rmub(1, i) = rmub(1, i) + temp1194*rmucos(1, i)*temp1193b0
      rmucosb(1, i) = rmucosb(1, i) + temp1194*rmu(1, i)*temp1193b0
      rmub(2, i) = rmub(2, i) + temp1193*rmucos(2, i)*temp1193b0
      distpb(i, 6) = 0.0_8
      temp1193b2 = cost3g*(7.d0*rmu(3, i)**2-rp0)*distpb(i, 5)
      temp1193b3 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp1192 = rmu(3, i)*rmucos(3, i)
      temp1191b = cost2g*(7.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 4)
      rmucosb(2, i) = rmucosb(2, i) + temp1192*rmu(2, i)*temp1191b + &
&        temp1193*rmu(2, i)*temp1193b0
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1193b1
      temp1191 = rmu(2, i)*rmucos(2, i)
      temp1191b0 = cost2g*temp1191*temp1192*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp1190 = rmu(3, i)*rmucos(3, i)
      temp1189 = rmu(1, i)*rmucos(1, i)
      temp1189b = cost2g*(7.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 3)
      temp1189b0 = cost2g*temp1189*temp1190*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp1189b1 = cost1g*distpb(i, 2)
      rp0b = (3.d0*2*rp0-30.d0*rmu(3, i)**2)*temp1189b1 - 3.d0*&
&        temp1189b0 - temp1193b3 - 3.d0*temp1191b0 - temp1193b1
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp1193b2
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp1193b2
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1193b3
      rmub(2, i) = rmub(2, i) + temp1192*rmucos(2, i)*temp1191b
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1191b0 + temp1191*&
&        rmucos(3, i)*temp1191b
      rmucosb(3, i) = rmucosb(3, i) + temp1191*rmu(3, i)*temp1191b
      rmub(1, i) = rmub(1, i) + temp1190*rmucos(1, i)*temp1189b
      rmucosb(1, i) = rmucosb(1, i) + temp1190*rmu(1, i)*temp1189b
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*rp0*2*rmu(3&
&        , i))*temp1189b1 + 7.d0*2*rmu(3, i)*temp1189b0 + temp1189*rmucos&
&        (3, i)*temp1189b
      rmucosb(3, i) = rmucosb(3, i) + temp1189*rmu(3, i)*temp1189b
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp1188 = r(k)**2
      temp1188b4 = c*DEXP(-(dd1*temp1188))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp1188))*distpb(k, 1)
      dd1b = dd1b - temp1188*temp1188b4
      rb(k) = rb(k) - dd1*2*r(k)*temp1188b4
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.11284691281640568826d0*2.75d0*dd1**1.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (55)
! g single Slater orbital
! radial R(r)= exp(-alpha r)
! normalized
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
!         c=1.d0/dsqrt(7.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(11.d0/2.d0)/3.d0/5.d0
    c = dd1**5.5d0*.020104801169736915d0
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
! angular part
! rmu replaced by rmu*rmucos with the minimal rmucos strategy
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(i)**2
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*rp0+&
&        3.d0*rp0**2)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-rp0)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos(&
&        2, i)*(7.d0*rmu(3, i)**2-rp0)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(rmu(1, i)**2-3.0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(3.d0*rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos&
&        (2, i)*(rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-4
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,9
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*distp(k, 1+ic)*cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)
      fun = -(dd1*distp(0, 1)/r(0))
      fun2 = distp(0, 1)*dd1**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(0)**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,9
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part ! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*12*rmu(1, 0)*rmucos(1, 0)*(-(5*rmu(3, &
&                  0)**2)+rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*12*(2*rmu(1, 0)**2*rmucos(1, 0)&
&                  **2-(rmucos(1, 0)**2-rmusin(1, 0)**2)*(5*rmu(3, 0)**2-&
&                  rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*12*rmu(2, 0)*rmucos(2, 0)*(-(5*rmu(3, &
&                  0)**2)+rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*12*(2*rmu(2, 0)**2*rmucos(2, 0)&
&                  **2-(rmucos(2, 0)**2-rmusin(2, 0)**2)*(5*rmu(3, 0)**2-&
&                  rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*16*rmu(3, 0)*rmucos(3, 0)*(5*rmu(3, 0)&
&                  **2-3*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*16*(rmu(3, 0)**2*(9*rmucos(3, 0)&
&                  **2-5*rmusin(3, 0)**2)+3*(-(rmucos(3, 0)**2)+rmusin(3&
&                  , 0)**2)*rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(3, 0)*rmucos(3, 0)*(-(6*rmu(1, 0)&
&                  **2*rmucos(1, 0)**2)+(rmucos(1, 0)**2-rmusin(1, 0)**2)&
&                  *(7*rmu(3, 0)**2-3*rp0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*(-(2*rmu(3, 0)*rmucos(1, 0)*&
&                  rmucos(3, 0)*(9*rmu(1, 0)*(rmucos(1, 0)**2-rmusin(1, 0&
&                  )**2)+2*pi/cellscale(1)*rmusin(1, 0)*(7*rmu(3, 0)**2-3&
&                  *rp0))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost2g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*6*rmu(1, 0)*rmu(3, 0)*rmucos(1, &
&                  0)*rmucos(3, 0)*(-(rmucos(2, 0)**2)+rmusin(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(1, 0)*rmucos(1, 0)*(rmu(3, 0)**2*(&
&                  15*rmucos(3, 0)**2-7*rmusin(3, 0)**2)+3*(-(rmucos(3, 0&
&                  )**2)+rmusin(3, 0)**2)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*4*rmu(1, 0)*rmucos(1, 0)*rmucos(&
&                  3, 0)*(rmu(3, 0)*(6*rmucos(3, 0)**2-13*rmusin(3, 0)**2&
&                  )+3*pi/cellscale(3)*rmusin(3, 0)*rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost2g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*6*rmu(2, 0)*rmu(3, 0)*rmucos(2, &
&                  0)*rmucos(3, 0)*(-(rmucos(1, 0)**2)+rmusin(1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(3, 0)*rmucos(3, 0)*(-(6*rmu(2, 0)&
&                  **2*rmucos(2, 0)**2)+(rmucos(2, 0)**2-rmusin(2, 0)**2)&
&                  *(7*rmu(3, 0)**2-3*rp0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*(-(2*rmu(3, 0)*rmucos(2, 0)*&
&                  rmucos(3, 0)*(9*rmu(2, 0)*(rmucos(2, 0)**2-rmusin(2, 0&
&                  )**2)+2*pi/cellscale(2)*rmusin(2, 0)*(7*rmu(3, 0)**2-3&
&                  *rp0))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(2, 0)*rmucos(2, 0)*(rmu(3, 0)**2*(&
&                  15*rmucos(3, 0)**2-7*rmusin(3, 0)**2)+3*(-(rmucos(3, 0&
&                  )**2)+rmusin(3, 0)**2)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*(4*rmu(2, 0)*rmucos(2, 0)*rmucos&
&                  (3, 0)*(rmu(3, 0)*(6*rmucos(3, 0)**2-13*rmusin(3, 0)**&
&                  2)+3*pi/cellscale(3)*rmusin(3, 0)*rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost3g*4*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(3, 0&
&                  )**2)*rmucos(1, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4*fun0*cost3g*(rmu(1, 0)**2*(3*rmucos(1, 0&
&                  )**2-rmusin(1, 0)**2)+3*rmu(3, 0)**2*(-(rmucos(1, 0)**&
&                  2)+rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*4*rmu(2, 0)*(rmu(2, 0)**2-3*rmu(3, 0)&
&                  **2)*rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 4*fun0*cost3g*(rmu(2, 0)**2*(3*rmucos(2, 0)&
&                  **2-rmusin(2, 0)**2)+3*rmu(3, 0)**2*(-(rmucos(2, 0)**2&
&                  )+rmusin(2, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*12*(rmu(1, 0)**2-rmu(2, 0)**2)*rmu(3, &
&                  0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost3g*12*(rmu(1, 0)**2-rmu(2, 0)**2)*(&
&                  rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2*cost3g*rmu(2, 0)*rmucos(2, 0)*((rmu(2, 0)&
&                  **2-6*rmu(3, 0)**2)*(rmucos(1, 0)**2-rmusin(1, 0)**2)+&
&                  rmu(1, 0)**2*(3*rmucos(1, 0)**2-rmusin(1, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost3g*fun0*(4*rmu(2, 0)*rmucos(1, 0)*rmucos&
&                  (2, 0)*(2*(rmu(2, 0)**2-6*rmu(3, 0)**2)*rmusin(1, 0)*&
&                  pi/cellscale(1)+rmu(1, 0)*(-(3*rmucos(1, 0)**2)+5*&
&                  rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2*cost3g*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)&
&                  **2*(rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(3*&
&                  rmucos(2, 0)**2-rmusin(2, 0)**2)+6*rmu(3, 0)**2*(-(&
&                  rmucos(2, 0)**2)+rmusin(2, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost3g*fun0*(4*rmu(1, 0)*rmucos(1, 0)*rmucos&
&                  (2, 0)*(2*(rmu(1, 0)**2-6*rmu(3, 0)**2)*rmusin(2, 0)*&
&                  pi/cellscale(2)+rmu(2, 0)*(-(3*rmucos(2, 0)**2)+5*&
&                  rmusin(2, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*24*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost3g*24*rmu(1, 0)*rmu(2, 0)*rmucos(1&
&                  , 0)*rmucos(2, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(3, 0)*rmucos(3, 0)*(rmu(1, 0)**2*(&
&                  3*rmucos(1, 0)**2-rmusin(1, 0)**2)+3*rmu(2, 0)**2*(-(&
&                  rmucos(1, 0)**2)+rmusin(1, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*(2*rmu(3, 0)*rmucos(1, 0)*rmucos&
&                  (3, 0)*(6*rmu(2, 0)**2*rmusin(1, 0)*pi/cellscale(1)+&
&                  rmu(1, 0)*(3*rmucos(1, 0)**2-5*rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6*cost4g*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 6*cost4g*fun0*rmu(1, 0)*rmu(3, 0)*rmucos(1, &
&                  0)*rmucos(3, 0)*(-(rmucos(2, 0)**2)+rmusin(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(2, 0)**2&
&                  )*rmucos(1, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost4g*(-(4*rmu(1, 0)*(rmu(1, 0)**2-3*&
&                  rmu(2, 0)**2)*rmucos(1, 0)*rmucos(3, 0)*rmusin(3, 0)*&
&                  pi/cellscale(3)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
              END IF
            ELSE IF (ic .EQ. 7) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*rmucos&
&                  (1, 0)*rmucos(2, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*6*rmu(2, 0)*rmu(3, 0)*rmucos(2, &
&                  0)*rmucos(3, 0)*(rmucos(1, 0)**2-rmusin(1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(3, 0)*rmucos(3, 0)*(3*rmu(1, 0)**2&
&                  *(rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*&
&                  rmucos(2, 0)**2)+rmusin(2, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*(-(2*rmu(3, 0)*rmucos(2, 0)*&
&                  rmucos(3, 0)*(6*rmu(1, 0)**2*rmusin(2, 0)*pi/cellscale&
&                  (2)+rmu(2, 0)*(3*rmucos(2, 0)**2-5*rmusin(2, 0)**2))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost4g*(rmu(2, 0)*(-(3*rmu(1, 0)**2)+rmu(2&
&                  , 0)**2)*rmucos(2, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2&
&                  )))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost4g*(4*rmu(2, 0)*(-(3*rmu(1, 0)**2)+&
&                  rmu(2, 0)**2)*rmucos(2, 0)*rmucos(3, 0)*rmusin(3, 0)*&
&                  pi/cellscale(3))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
              END IF
            ELSE IF (ic .EQ. 8) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost5g*4*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(2, 0)&
&                  **2)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost5g*fun0*4*(rmu(1, 0)**2*(3*rmucos(1, 0)&
&                  **2-rmusin(1, 0)**2)+3*rmu(2, 0)**2*(-(rmucos(1, 0)**2&
&                  )+rmusin(1, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost5g*4*rmu(2, 0)*(-(3*rmu(1, 0)**2)+rmu(2, &
&                  0)**2)*rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4*cost5g*fun0*(3*rmu(1, 0)**2*(rmucos(2, 0&
&                  )**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*rmucos(2, 0)**&
&                  2)+rmusin(2, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,29)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,30)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost5g*4*rmu(2, 0)*rmucos(2, 0)*(rmu(1, 0)**2*(&
&                3*rmucos(1, 0)**2-rmusin(1, 0)**2)+rmu(2, 0)**2*(-(&
&                rmucos(1, 0)**2)+rmusin(1, 0)**2))
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = cost5g*fun0*(8*rmu(2, 0)*rmucos(1, 0)*rmucos(2&
&                , 0)*(2*rmu(2, 0)**2*rmusin(1, 0)*pi/cellscale(1)+rmu(1&
&                , 0)*(3*rmucos(1, 0)**2-5*rmusin(1, 0)**2)))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,31)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost5g*4*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)**2*(&
&                rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*&
&                rmucos(2, 0)**2)+rmusin(2, 0)**2))
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = cost5g*fun0*(-(8*rmu(1, 0)*rmucos(1, 0)*rmucos&
&                (2, 0)*(2*rmu(1, 0)**2*rmusin(2, 0)*pi/cellscale(2)+rmu(&
&                2, 0)*(3*rmucos(2, 0)**2-5*rmusin(2, 0)**2))))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,32)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,33)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*distp(0, 1+ic)*&
&              cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*distp(0, 1+ic)*sinphase(i, 0)*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=9,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp1497b = -(distp(0, 1)*rphase(i)*zb(indorbp, indt+i))
            temp1497b0 = -(distp(0, 1+ic)*sinphase(i, 0)*zb(indorbp, &
&              indt+i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1497b1 = -(distp(0, 1+ic)*rphase(i)**2*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + distp(0&
&              , 1)*temp1497b1 + z(indorbp, indt+i)*zb(indorbp, indt+i)
            distpb(0, 1+ic) = distpb(0, 1+ic) + sinphase(i, 0)*temp1497b
            temp1497b2 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp1497b2 + &
&              distp(0, 1+ic)*temp1497b
            distpb(0, 1) = distpb(0, 1) + cosphase(0)*temp1497b1 + &
&              rphase(i)*temp1497b0
            temp1497b3 = -(distp(0, 1)*cosphase(0)*hess4fb(1))
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp1497b2 + distp(&
&              0, 1+ic)*2*rphase(i)*temp1497b3 + distp(0, 1)*temp1497b0
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + rphase(i)**2*temp1497b3
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1496 = der4f(1)/cellscale(i)
            temp1496b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp1496*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp1496b
            cellscaleb(i) = cellscaleb(i) - temp1496*temp1496b
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 17) THEN
              IF (branch .LT. 9) THEN
                IF (branch .LT. 5) THEN
                  IF (branch .LT. 3) THEN
                    IF (branch .LT. 2) THEN
                      IF (branch .LT. 1) THEN
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                        temp1368 = 5*rmu(3, 0)**2 - rp0
                        temp1367 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                        temp1367b0 = cost1g*12*hess4fb(2)
                        temp1367b1 = fun0*temp1367b0
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        fun0b = fun0b + der4f(2)*der4fb(2) + (2*(rmu(1, &
&                          0)**2*rmucos(1, 0)**2)-temp1367*temp1368)*&
&                          temp1367b0
                        rmub(1, 0) = rmub(1, 0) + 2**2*rmucos(1, 0)**2*&
&                          rmu(1, 0)*temp1367b1
                        hess4fb(2) = 0.0_8
                        temp1367b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                        der4fb(2) = fun*temp1367b2 + fun0*der4fb(2)
                        temp1367b3 = cost1g*12*der4fb(2)
                        temp1367b4 = (rp0-5*rmu(3, 0)**2)*temp1367b3
                        rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                          temp1367b4 + (2**2*rmu(1, 0)**2*rmucos(1, 0)-&
&                          temp1368*2*rmucos(1, 0))*temp1367b1
                        rmusinb(1, 0) = rmusinb(1, 0) + temp1368*2*&
&                          rmusin(1, 0)*temp1367b1
                        rmub(3, 0) = rmub(3, 0) - temp1367*5*2*rmu(3, 0)&
&                          *temp1367b1
                        temp1367b5 = rmu(1, 0)*rmucos(1, 0)*temp1367b3
                        rp0b = rp0b + temp1367b5 + temp1367*temp1367b1
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                        rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                          hess4fb(3)
                        funb = funb + der4f(2)*temp1367b2
                        hess4fb(3) = 0.0_8
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*&
&                          temp1367b4
                        rmub(3, 0) = rmub(3, 0) - 5*2*rmu(3, 0)*&
&                          temp1367b5
                        der4fb(2) = 0.0_8
                      ELSE
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                        temp1370 = 5*rmu(3, 0)**2 - rp0
                        temp1369 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                        temp1369b = cost1g*12*hess4fb(2)
                        temp1369b0 = fun0*temp1369b
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        fun0b = fun0b + der4f(2)*der4fb(2) + (2*(rmu(2, &
&                          0)**2*rmucos(2, 0)**2)-temp1369*temp1370)*&
&                          temp1369b
                        rmub(2, 0) = rmub(2, 0) + 2**2*rmucos(2, 0)**2*&
&                          rmu(2, 0)*temp1369b0
                        hess4fb(2) = 0.0_8
                        temp1369b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                        der4fb(2) = fun*temp1369b1 + fun0*der4fb(2)
                        temp1369b2 = cost1g*12*der4fb(2)
                        temp1369b3 = (rp0-5*rmu(3, 0)**2)*temp1369b2
                        rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                          temp1369b3 + (2**2*rmu(2, 0)**2*rmucos(2, 0)-&
&                          temp1370*2*rmucos(2, 0))*temp1369b0
                        rmusinb(2, 0) = rmusinb(2, 0) + temp1370*2*&
&                          rmusin(2, 0)*temp1369b0
                        rmub(3, 0) = rmub(3, 0) - temp1369*5*2*rmu(3, 0)&
&                          *temp1369b0
                        temp1369b4 = rmu(2, 0)*rmucos(2, 0)*temp1369b2
                        rp0b = rp0b + temp1369b4 + temp1369*temp1369b0
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                        rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                          hess4fb(3)
                        funb = funb + der4f(2)*temp1369b1
                        hess4fb(3) = 0.0_8
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*&
&                          temp1369b3
                        rmub(3, 0) = rmub(3, 0) - 5*2*rmu(3, 0)*&
&                          temp1369b4
                        der4fb(2) = 0.0_8
                      END IF
                    END IF
                  ELSE IF (branch .LT. 4) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1371 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                    temp1373 = 9*rmucos(3, 0)**2 - 5*rmusin(3, 0)**2
                    temp1372 = rmu(3, 0)**2
                    temp1372b = cost1g*16*hess4fb(2)
                    temp1372b0 = fun0*temp1372b
                    temp1371b = 3*rp0*temp1372b0
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (temp1372*&
&                      temp1373+3*(temp1371*rp0))*temp1372b
                    rmub(3, 0) = rmub(3, 0) + temp1373*2*rmu(3, 0)*&
&                      temp1372b0
                    hess4fb(2) = 0.0_8
                    temp1371b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1371b0 + fun0*der4fb(2)
                    temp1371b1 = cost1g*16*der4fb(2)
                    temp1371b2 = (5*rmu(3, 0)**2-3*rp0)*temp1371b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1371b2&
&                      - 2*rmucos(3, 0)*temp1371b + temp1372*9*2*rmucos(3&
&                      , 0)*temp1372b0
                    rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                      temp1371b - temp1372*5*2*rmusin(3, 0)*temp1372b0
                    temp1371b3 = rmu(3, 0)*rmucos(3, 0)*temp1371b1
                    rp0b = rp0b + 3*temp1371*temp1372b0 - 3*temp1371b3
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1371b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5*2*rmu(3, 0)*temp1371b3 +&
&                      rmucos(3, 0)*temp1371b2
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1380 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1376 = rmusin(1, 0)/cellscale(1)
                    temp1377 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                    temp1379 = rmucos(1, 0)*rmucos(3, 0)
                    temp1378 = fun0*rmu(3, 0)
                    temp1378b = -(cost2g*2*hess4fb(2))
                    temp1378b0 = (9*(rmu(1, 0)*temp1377)+pi*2*(temp1376*&
&                      temp1380))*temp1378b
                    temp1378b1 = temp1378*temp1379*temp1378b
                    temp1377b = 9*rmu(1, 0)*temp1378b1
                    temp1377b0 = pi*2*temp1378b1
                    temp1376b = temp1380*temp1377b0/cellscale(1)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp1379*rmu(3&
&                      , 0)*temp1378b0
                    rmub(3, 0) = rmub(3, 0) + temp1376*7*2*rmu(3, 0)*&
&                      temp1377b0 + temp1379*fun0*temp1378b0
                    rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*&
&                      temp1377b + temp1378*rmucos(3, 0)*temp1378b0
                    hess4fb(2) = 0.0_8
                    temp1376b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1376b0 + fun0*der4fb(2)
                    temp1375 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1374 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                    temp1374b = cost2g*(temp1374*temp1375-6*(rmu(1, 0)**&
&                      2*rmucos(1, 0)**2))*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1374b &
&                      + temp1378*rmucos(1, 0)*temp1378b0
                    rmub(1, 0) = rmub(1, 0) + 9*temp1377*temp1378b1
                    temp1374b0 = cost2g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                    rmusinb(1, 0) = rmusinb(1, 0) + temp1376b - temp1375&
&                      *2*rmusin(1, 0)*temp1374b0 - 2*rmusin(1, 0)*&
&                      temp1377b
                    cellscaleb(1) = cellscaleb(1) - temp1376*temp1376b
                    rp0b = rp0b - temp1374*3*temp1374b0 - temp1376*3*&
&                      temp1377b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1376b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + temp1374*7*2*rmu(3, 0)*&
&                      temp1374b0 + rmucos(3, 0)*temp1374b
                    rmucosb(1, 0) = rmucosb(1, 0) + (temp1375*2*rmucos(1&
&                      , 0)-6*rmu(1, 0)**2*2*rmucos(1, 0))*temp1374b0
                    rmub(1, 0) = rmub(1, 0) - 6*rmucos(1, 0)**2*2*rmu(1&
&                      , 0)*temp1374b0
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 7) THEN
                  IF (branch .LT. 6) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1384 = rmu(3, 0)*rmucos(1, 0)
                    temp1383 = fun0*rmu(1, 0)*rmucos(3, 0)
                    temp1384b = cost2g*6*hess4fb(2)
                    temp1384b0 = (rmusin(2, 0)**2-rmucos(2, 0)**2)*&
&                      temp1384b
                    temp1383b = temp1384*temp1384b0
                    temp1383b0 = temp1383*temp1384*temp1384b
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(1, 0)*temp1383b
                    rmub(1, 0) = rmub(1, 0) + rmucos(3, 0)*fun0*&
&                      temp1383b
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                      temp1383b
                    rmub(3, 0) = rmub(3, 0) + temp1383*rmucos(1, 0)*&
&                      temp1384b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1383*rmu(3, 0)*&
&                      temp1384b0
                    rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                      temp1383b0
                    rmucosb(2, 0) = rmucosb(2, 0) - 2*rmucos(2, 0)*&
&                      temp1383b0
                    hess4fb(2) = 0.0_8
                    temp1383b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1383b1 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1383b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1382 = rmu(3, 0)*rmucos(1, 0)
                    temp1381 = rmu(1, 0)*rmu(2, 0)
                    temp1381b = -(cost2g*6*der4fb(2))
                    temp1381b0 = rmucos(2, 0)*rmucos(3, 0)*temp1381b
                    temp1381b1 = temp1381*temp1382*temp1381b
                    rmub(1, 0) = rmub(1, 0) + temp1382*rmu(2, 0)*&
&                      temp1381b0
                    rmub(2, 0) = rmub(2, 0) + temp1382*rmu(1, 0)*&
&                      temp1381b0
                    rmub(3, 0) = rmub(3, 0) + temp1381*rmucos(1, 0)*&
&                      temp1381b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1381*rmu(3, 0)*&
&                      temp1381b0
                    rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                      temp1381b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                      temp1381b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 8) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1388 = rp0/cellscale(3)
                  temp1391 = 6*rmucos(3, 0)**2 - 13*rmusin(3, 0)**2
                  temp1390 = rmucos(1, 0)*rmucos(3, 0)
                  temp1389 = fun0*rmu(1, 0)
                  temp1389b = cost2g*4*hess4fb(2)
                  temp1389b0 = (rmu(3, 0)*temp1391+pi*3*(rmusin(3, 0)*&
&                    temp1388))*temp1389b
                  temp1389b1 = temp1389*temp1390*temp1389b
                  temp1389b2 = pi*3*temp1389b1
                  temp1388b = rmusin(3, 0)*temp1389b2/cellscale(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1390*rmu(1, 0&
&                    )*temp1389b0
                  rmub(1, 0) = rmub(1, 0) + temp1390*fun0*temp1389b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1389*rmucos(3, 0)*&
&                    temp1389b0
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*6*2*rmucos(3&
&                    , 0)*temp1389b1 + temp1389*rmucos(1, 0)*temp1389b0
                  rmub(3, 0) = rmub(3, 0) + temp1391*temp1389b1
                  hess4fb(2) = 0.0_8
                  temp1388b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1388b0 + fun0*der4fb(2)
                  temp1386 = rmu(3, 0)**2
                  temp1386b = cost2g*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
                  temp1385b = 3*rp0*temp1386b
                  rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                    temp1385b - temp1386*7*2*rmusin(3, 0)*temp1386b + &
&                    temp1388*temp1389b2 - rmu(3, 0)*13*2*rmusin(3, 0)*&
&                    temp1389b1
                  temp1385 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                  rp0b = rp0b + 3*temp1385*temp1386b + temp1388b
                  cellscaleb(3) = cellscaleb(3) - temp1388*temp1388b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1388b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1387 = 15*rmucos(3, 0)**2 - 7*rmusin(3, 0)**2
                  temp1386b0 = cost2g*(temp1386*temp1387+3*(temp1385*rp0&
&                    ))*der4fb(2)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1386b0
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1386b0
                  rmub(3, 0) = rmub(3, 0) + temp1387*2*rmu(3, 0)*&
&                    temp1386b
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1386*15*2*rmucos(3&
&                    , 0)*temp1386b - 2*rmucos(3, 0)*temp1385b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1395 = rmu(3, 0)*rmucos(2, 0)
                  temp1394 = fun0*rmu(2, 0)*rmucos(3, 0)
                  temp1395b = cost2g*6*hess4fb(2)
                  temp1395b0 = (rmusin(1, 0)**2-rmucos(1, 0)**2)*&
&                    temp1395b
                  temp1394b = temp1395*temp1395b0
                  temp1394b0 = temp1394*temp1395*temp1395b
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(&
&                    2, 0)*temp1394b
                  rmub(2, 0) = rmub(2, 0) + rmucos(3, 0)*fun0*temp1394b
                  rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*&
&                    temp1394b
                  rmub(3, 0) = rmub(3, 0) + temp1394*rmucos(2, 0)*&
&                    temp1395b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1394*rmu(3, 0)*&
&                    temp1395b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1394b0
                  hess4fb(2) = 0.0_8
                  temp1394b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1394b1 + fun0*der4fb(2)
                  temp1392 = rmu(1, 0)*rmu(2, 0)
                  temp1392b = -(cost2g*6*der4fb(2))
                  temp1392b0 = rmucos(2, 0)*rmucos(3, 0)*temp1392b
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1392*rmu(3, 0)*&
&                    temp1392b0 - 2*rmucos(1, 0)*temp1394b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1394b1
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1393 = rmu(3, 0)*rmucos(1, 0)
                  temp1392b1 = temp1392*temp1393*temp1392b
                  rmub(1, 0) = rmub(1, 0) + temp1393*rmu(2, 0)*&
&                    temp1392b0
                  rmub(2, 0) = rmub(2, 0) + temp1393*rmu(1, 0)*&
&                    temp1392b0
                  rmub(3, 0) = rmub(3, 0) + temp1392*rmucos(1, 0)*&
&                    temp1392b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                    temp1392b1
                  rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                    temp1392b1
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 13) THEN
                IF (branch .LT. 11) THEN
                  IF (branch .LT. 10) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1402 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1398 = rmusin(2, 0)/cellscale(2)
                    temp1399 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                    temp1401 = rmucos(2, 0)*rmucos(3, 0)
                    temp1400 = fun0*rmu(3, 0)
                    temp1400b = -(cost2g*2*hess4fb(2))
                    temp1400b0 = (9*(rmu(2, 0)*temp1399)+pi*2*(temp1398*&
&                      temp1402))*temp1400b
                    temp1400b1 = temp1400*temp1401*temp1400b
                    temp1399b = 9*rmu(2, 0)*temp1400b1
                    temp1399b0 = pi*2*temp1400b1
                    temp1398b = temp1402*temp1399b0/cellscale(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp1401*rmu(3&
&                      , 0)*temp1400b0
                    rmub(3, 0) = rmub(3, 0) + temp1398*7*2*rmu(3, 0)*&
&                      temp1399b0 + temp1401*fun0*temp1400b0
                    rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*&
&                      temp1399b + temp1400*rmucos(3, 0)*temp1400b0
                    hess4fb(2) = 0.0_8
                    temp1398b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1398b0 + fun0*der4fb(2)
                    temp1397 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1396 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                    temp1396b = cost2g*(temp1396*temp1397-6*(rmu(2, 0)**&
&                      2*rmucos(2, 0)**2))*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1396b &
&                      + temp1400*rmucos(2, 0)*temp1400b0
                    rmub(2, 0) = rmub(2, 0) + 9*temp1399*temp1400b1
                    temp1396b0 = cost2g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                    rmusinb(2, 0) = rmusinb(2, 0) + temp1398b - temp1397&
&                      *2*rmusin(2, 0)*temp1396b0 - 2*rmusin(2, 0)*&
&                      temp1399b
                    cellscaleb(2) = cellscaleb(2) - temp1398*temp1398b
                    rp0b = rp0b - temp1396*3*temp1396b0 - temp1398*3*&
&                      temp1399b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1398b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + temp1396*7*2*rmu(3, 0)*&
&                      temp1396b0 + rmucos(3, 0)*temp1396b
                    rmucosb(2, 0) = rmucosb(2, 0) + (temp1397*2*rmucos(2&
&                      , 0)-6*rmu(2, 0)**2*2*rmucos(2, 0))*temp1396b0
                    rmub(2, 0) = rmub(2, 0) - 6*rmucos(2, 0)**2*2*rmu(2&
&                      , 0)*temp1396b0
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 12) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1406 = rp0/cellscale(3)
                  temp1409 = 6*rmucos(3, 0)**2 - 13*rmusin(3, 0)**2
                  temp1408 = rmucos(2, 0)*rmucos(3, 0)
                  temp1407 = fun0*rmu(2, 0)
                  temp1407b = cost2g*4*hess4fb(2)
                  temp1407b0 = (rmu(3, 0)*temp1409+pi*3*(rmusin(3, 0)*&
&                    temp1406))*temp1407b
                  temp1407b1 = temp1407*temp1408*temp1407b
                  temp1407b2 = pi*3*temp1407b1
                  temp1406b = rmusin(3, 0)*temp1407b2/cellscale(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1408*rmu(2, 0&
&                    )*temp1407b0
                  rmub(2, 0) = rmub(2, 0) + temp1408*fun0*temp1407b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1407*rmucos(3, 0)*&
&                    temp1407b0
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*6*2*rmucos(3&
&                    , 0)*temp1407b1 + temp1407*rmucos(2, 0)*temp1407b0
                  rmub(3, 0) = rmub(3, 0) + temp1409*temp1407b1
                  hess4fb(2) = 0.0_8
                  temp1406b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1406b0 + fun0*der4fb(2)
                  temp1404 = rmu(3, 0)**2
                  temp1404b = cost2g*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                  temp1403b = 3*rp0*temp1404b
                  rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                    temp1403b - temp1404*7*2*rmusin(3, 0)*temp1404b + &
&                    temp1406*temp1407b2 - rmu(3, 0)*13*2*rmusin(3, 0)*&
&                    temp1407b1
                  temp1403 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                  rp0b = rp0b + 3*temp1403*temp1404b + temp1406b
                  cellscaleb(3) = cellscaleb(3) - temp1406*temp1406b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1406b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1405 = 15*rmucos(3, 0)**2 - 7*rmusin(3, 0)**2
                  temp1404b0 = cost2g*(temp1404*temp1405+3*(temp1403*rp0&
&                    ))*der4fb(2)
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1404b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1404b0
                  rmub(3, 0) = rmub(3, 0) + temp1405*2*rmu(3, 0)*&
&                    temp1404b
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1404*15*2*rmucos(3&
&                    , 0)*temp1404b - 2*rmucos(3, 0)*temp1403b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1410 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                  temp1412 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                  temp1411 = rmu(1, 0)**2
                  temp1411b = -(cost3g*4*hess4fb(2))
                  temp1411b0 = fun0*temp1411b
                  temp1410b = 3*rmu(3, 0)**2*temp1411b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (temp1411*&
&                    temp1412+3*(rmu(3, 0)**2*temp1410))*temp1411b
                  rmub(1, 0) = rmub(1, 0) + temp1412*2*rmu(1, 0)*&
&                    temp1411b0
                  hess4fb(2) = 0.0_8
                  temp1410b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1410b0 + fun0*der4fb(2)
                  temp1410b1 = -(cost3g*4*der4fb(2))
                  temp1410b2 = (rmu(1, 0)**2-3*rmu(3, 0)**2)*temp1410b1
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1410b2 -&
&                    2*rmucos(1, 0)*temp1410b + temp1411*3*2*rmucos(1, 0)&
&                    *temp1411b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1410b - temp1411*2*rmusin(1, 0)*temp1411b0
                  rmub(3, 0) = rmub(3, 0) + 3*temp1410*2*rmu(3, 0)*&
&                    temp1411b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1410b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1410b3 = rmu(1, 0)*rmucos(1, 0)*temp1410b1
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1410b2 + 2*&
&                    rmu(1, 0)*temp1410b3
                  rmub(3, 0) = rmub(3, 0) - 3*2*rmu(3, 0)*temp1410b3
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1413 = rmusin(2, 0)**2 - rmucos(2, 0)**2
                  temp1415 = 3*rmucos(2, 0)**2 - rmusin(2, 0)**2
                  temp1414 = rmu(2, 0)**2
                  temp1414b = cost3g*4*hess4fb(2)
                  temp1414b0 = fun0*temp1414b
                  temp1413b = 3*rmu(3, 0)**2*temp1414b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (temp1414*&
&                    temp1415+3*(rmu(3, 0)**2*temp1413))*temp1414b
                  rmub(2, 0) = rmub(2, 0) + temp1415*2*rmu(2, 0)*&
&                    temp1414b0
                  hess4fb(2) = 0.0_8
                  temp1413b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1413b0 + fun0*der4fb(2)
                  temp1413b1 = cost3g*4*der4fb(2)
                  temp1413b2 = (rmu(2, 0)**2-3*rmu(3, 0)**2)*temp1413b1
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1413b2 -&
&                    2*rmucos(2, 0)*temp1413b + temp1414*3*2*rmucos(2, 0)&
&                    *temp1414b0
                  rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                    temp1413b - temp1414*2*rmusin(2, 0)*temp1414b0
                  rmub(3, 0) = rmub(3, 0) + 3*temp1413*2*rmu(3, 0)*&
&                    temp1414b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1413b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1413b3 = rmu(2, 0)*rmucos(2, 0)*temp1413b1
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1413b2 + 2*&
&                    rmu(2, 0)*temp1413b3
                  rmub(3, 0) = rmub(3, 0) - 3*2*rmu(3, 0)*temp1413b3
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 16) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1416 = rmu(1, 0)**2 - rmu(2, 0)**2
                temp1416b = cost3g*12*hess4fb(2)
                temp1416b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp1416b
                temp1416b1 = fun0*temp1416*temp1416b
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1416*temp1416b0
                rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp1416b0
                rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp1416b0
                hess4fb(2) = 0.0_8
                temp1416b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1416b2 + fun0*der4fb(2)
                temp1416b3 = cost3g*12*der4fb(2)
                temp1416b4 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp1416b3
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1416b4 + 2&
&                  *rmucos(3, 0)*temp1416b1
                rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*&
&                  temp1416b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1416b2
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1416b5 = rmu(3, 0)*rmucos(3, 0)*temp1416b3
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp1416b5
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp1416b5
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1416b4
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1425 = 5*rmusin(1, 0)**2 - 3*rmucos(1, 0)**2
                temp1421 = rmusin(1, 0)/cellscale(1)
                temp1424 = rmu(2, 0)**2 - 6*rmu(3, 0)**2
                temp1423 = rmucos(1, 0)*rmucos(2, 0)
                temp1422 = fun0*rmu(2, 0)
                temp1422b = cost3g*4*hess4fb(2)
                temp1422b0 = (pi*2*(temp1424*temp1421)+rmu(1, 0)*&
&                  temp1425)*temp1422b
                temp1422b1 = temp1422*temp1423*temp1422b
                temp1422b2 = pi*2*temp1422b1
                temp1421b = temp1424*temp1422b2/cellscale(1)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1423*rmu(2, 0)*&
&                  temp1422b0
                rmub(2, 0) = rmub(2, 0) + temp1421*2*rmu(2, 0)*&
&                  temp1422b2 + temp1423*fun0*temp1422b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1422*rmucos(2, 0)*&
&                  temp1422b0 - rmu(1, 0)*3*2*rmucos(1, 0)*temp1422b1
                hess4fb(2) = 0.0_8
                temp1421b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1421b0 + fun0*der4fb(2)
                temp1420 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1419 = rmu(1, 0)**2
                temp1418 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1417 = rmu(2, 0)**2 - 6*rmu(3, 0)**2
                temp1417b = -(cost3g*2*der4fb(2))
                temp1417b0 = (temp1417*temp1418+temp1419*temp1420)*&
&                  temp1417b
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1417b0 + &
&                  temp1422*rmucos(1, 0)*temp1422b0
                rmub(3, 0) = rmub(3, 0) - temp1421*6*2*rmu(3, 0)*&
&                  temp1422b2
                temp1417b1 = rmu(2, 0)*rmucos(2, 0)*temp1417b
                rmusinb(1, 0) = rmusinb(1, 0) + (-(temp1419*2*rmusin(1, &
&                  0))-temp1417*2*rmusin(1, 0))*temp1417b1 + rmu(1, 0)*5*&
&                  2*rmusin(1, 0)*temp1422b1 + temp1421b
                cellscaleb(1) = cellscaleb(1) - temp1421*temp1421b
                rmub(1, 0) = rmub(1, 0) + temp1425*temp1422b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1421b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + temp1418*2*rmu(2, 0)*&
&                  temp1417b1 + rmucos(2, 0)*temp1417b0
                rmub(3, 0) = rmub(3, 0) - temp1418*6*2*rmu(3, 0)*&
&                  temp1417b1
                rmucosb(1, 0) = rmucosb(1, 0) + (temp1419*3*2*rmucos(1, &
&                  0)+temp1417*2*rmucos(1, 0))*temp1417b1
                rmub(1, 0) = rmub(1, 0) + temp1420*2*rmu(1, 0)*&
&                  temp1417b1
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 26) THEN
              IF (branch .LT. 22) THEN
                IF (branch .LT. 20) THEN
                  IF (branch .LT. 19) THEN
                    IF (branch .LT. 18) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp1435 = 5*rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                      temp1431 = rmusin(2, 0)/cellscale(2)
                      temp1434 = rmu(1, 0)**2 - 6*rmu(3, 0)**2
                      temp1433 = rmucos(1, 0)*rmucos(2, 0)
                      temp1432 = fun0*rmu(1, 0)
                      temp1432b = cost3g*4*hess4fb(2)
                      temp1432b0 = (pi*2*(temp1434*temp1431)+rmu(2, 0)*&
&                        temp1435)*temp1432b
                      temp1432b1 = temp1432*temp1433*temp1432b
                      temp1432b2 = pi*2*temp1432b1
                      temp1431b = temp1434*temp1432b2/cellscale(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + temp1433*rmu(&
&                        1, 0)*temp1432b0
                      rmub(1, 0) = rmub(1, 0) + temp1431*2*rmu(1, 0)*&
&                        temp1432b2 + temp1433*fun0*temp1432b0
                      rmucosb(1, 0) = rmucosb(1, 0) + temp1432*rmucos(2&
&                        , 0)*temp1432b0
                      rmucosb(2, 0) = rmucosb(2, 0) + temp1432*rmucos(1&
&                        , 0)*temp1432b0 - rmu(2, 0)*3*2*rmucos(2, 0)*&
&                        temp1432b1
                      rmub(3, 0) = rmub(3, 0) - temp1431*6*2*rmu(3, 0)*&
&                        temp1432b2
                      hess4fb(2) = 0.0_8
                      temp1431b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp1431b0 + fun0*der4fb(2)
                      temp1429 = rmu(2, 0)**2
                      temp1427 = rmu(1, 0)**2
                      temp1427b = -(cost3g*2*der4fb(2))
                      temp1427b0 = rmu(1, 0)*rmucos(1, 0)*temp1427b
                      temp1426b = 6*rmu(3, 0)**2*temp1427b0
                      rmusinb(2, 0) = rmusinb(2, 0) + (-(temp1429*2*&
&                        rmusin(2, 0))-temp1427*2*rmusin(2, 0))*&
&                        temp1427b0 + 2*rmusin(2, 0)*temp1426b + rmu(2, 0&
&                        )*5*2*rmusin(2, 0)*temp1432b1 + temp1431b
                      cellscaleb(2) = cellscaleb(2) - temp1431*temp1431b
                      rmub(2, 0) = rmub(2, 0) + temp1435*temp1432b1
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp1431b0
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp1426 = rmusin(2, 0)**2 - rmucos(2, 0)**2
                      temp1430 = 3*rmucos(2, 0)**2 - rmusin(2, 0)**2
                      temp1428 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                      temp1427b1 = (temp1427*temp1428+temp1429*temp1430+&
&                        6*(rmu(3, 0)**2*temp1426))*temp1427b
                      rmub(1, 0) = rmub(1, 0) + temp1428*2*rmu(1, 0)*&
&                        temp1427b0 + rmucos(1, 0)*temp1427b1
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp1427b1
                      rmucosb(2, 0) = rmucosb(2, 0) + (temp1429*3*2*&
&                        rmucos(2, 0)+temp1427*2*rmucos(2, 0))*temp1427b0&
&                        - 2*rmucos(2, 0)*temp1426b
                      rmub(2, 0) = rmub(2, 0) + temp1430*2*rmu(2, 0)*&
&                        temp1427b0
                      rmub(3, 0) = rmub(3, 0) + 6*temp1426*2*rmu(3, 0)*&
&                        temp1427b0
                      der4fb(2) = 0.0_8
                    END IF
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1439 = rmu(2, 0)*rmucos(1, 0)
                    temp1438 = fun0*rmu(1, 0)*rmucos(2, 0)
                    temp1439b = cost3g*24*hess4fb(2)
                    temp1439b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                      temp1439b
                    temp1438b = temp1439*temp1439b0
                    temp1438b0 = temp1438*temp1439*temp1439b
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*&
&                      rmu(1, 0)*temp1438b
                    rmub(1, 0) = rmub(1, 0) + rmucos(2, 0)*fun0*&
&                      temp1438b
                    rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*&
&                      temp1438b
                    rmub(2, 0) = rmub(2, 0) + temp1438*rmucos(1, 0)*&
&                      temp1439b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1438*rmu(2, 0)*&
&                      temp1439b0
                    rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*&
&                      temp1438b0
                    rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*&
&                      temp1438b0
                    hess4fb(2) = 0.0_8
                    temp1438b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1438b1 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1438b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1437 = rmu(3, 0)*rmucos(1, 0)
                    temp1436 = rmu(1, 0)*rmu(2, 0)
                    temp1436b = cost3g*24*der4fb(2)
                    temp1436b0 = rmucos(2, 0)*rmucos(3, 0)*temp1436b
                    temp1436b1 = temp1436*temp1437*temp1436b
                    rmub(1, 0) = rmub(1, 0) + temp1437*rmu(2, 0)*&
&                      temp1436b0
                    rmub(2, 0) = rmub(2, 0) + temp1437*rmu(1, 0)*&
&                      temp1436b0
                    rmub(3, 0) = rmub(3, 0) + temp1436*rmucos(1, 0)*&
&                      temp1436b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1436*rmu(3, 0)*&
&                      temp1436b0
                    rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                      temp1436b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                      temp1436b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 21) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1446 = 3*rmucos(1, 0)**2 - 5*rmusin(1, 0)**2
                  temp1443 = rmusin(1, 0)/cellscale(1)
                  temp1445 = rmucos(1, 0)*rmucos(3, 0)
                  temp1444 = fun0*rmu(3, 0)
                  temp1444b = cost4g*2*hess4fb(2)
                  temp1444b0 = (pi*6*(rmu(2, 0)**2*temp1443)+rmu(1, 0)*&
&                    temp1446)*temp1444b
                  temp1444b1 = temp1444*temp1445*temp1444b
                  temp1444b2 = pi*6*temp1444b1
                  temp1443b = rmu(2, 0)**2*temp1444b2/cellscale(1)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1445*rmu(3, 0&
&                    )*temp1444b0
                  rmub(3, 0) = rmub(3, 0) + temp1445*fun0*temp1444b0
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*3*2*rmucos(1&
&                    , 0)*temp1444b1 + temp1444*rmucos(3, 0)*temp1444b0
                  hess4fb(2) = 0.0_8
                  temp1443b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1443b0 + fun0*der4fb(2)
                  temp1440 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                  temp1442 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                  temp1441 = rmu(1, 0)**2
                  temp1441b = cost4g*(temp1441*temp1442+3*(rmu(2, 0)**2*&
&                    temp1440))*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1441b + &
&                    temp1444*rmucos(1, 0)*temp1444b0
                  rmub(2, 0) = rmub(2, 0) + temp1443*2*rmu(2, 0)*&
&                    temp1444b2
                  temp1441b0 = cost4g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                  temp1440b = 3*rmu(2, 0)**2*temp1441b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1440b - temp1441*2*rmusin(1, 0)*temp1441b0 - rmu&
&                    (1, 0)*5*2*rmusin(1, 0)*temp1444b1 + temp1443b
                  cellscaleb(1) = cellscaleb(1) - temp1443*temp1443b
                  rmub(1, 0) = rmub(1, 0) + temp1446*temp1444b1
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1443b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1441b
                  rmub(1, 0) = rmub(1, 0) + temp1442*2*rmu(1, 0)*&
&                    temp1441b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1441*3*2*rmucos(1&
&                    , 0)*temp1441b0 - 2*rmucos(1, 0)*temp1440b
                  rmub(2, 0) = rmub(2, 0) + 3*temp1440*2*rmu(2, 0)*&
&                    temp1441b0
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1450 = rmu(3, 0)*rmucos(1, 0)
                  temp1449 = fun0*rmu(1, 0)*rmucos(3, 0)
                  temp1450b = cost4g*6*hess4fb(2)
                  temp1450b0 = (rmusin(2, 0)**2-rmucos(2, 0)**2)*&
&                    temp1450b
                  temp1449b = temp1450*temp1450b0
                  temp1449b0 = temp1449*temp1450*temp1450b
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(&
&                    1, 0)*temp1449b
                  rmub(1, 0) = rmub(1, 0) + rmucos(3, 0)*fun0*temp1449b
                  rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                    temp1449b
                  rmub(3, 0) = rmub(3, 0) + temp1449*rmucos(1, 0)*&
&                    temp1450b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1449*rmu(3, 0)*&
&                    temp1450b0
                  rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                    temp1449b0
                  rmucosb(2, 0) = rmucosb(2, 0) - 2*rmucos(2, 0)*&
&                    temp1449b0
                  hess4fb(2) = 0.0_8
                  temp1449b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1449b1 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1449b1
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1448 = rmu(3, 0)*rmucos(1, 0)
                  temp1447 = rmu(1, 0)*rmu(2, 0)
                  temp1447b = -(cost4g*6*der4fb(2))
                  temp1447b0 = rmucos(2, 0)*rmucos(3, 0)*temp1447b
                  temp1447b1 = temp1447*temp1448*temp1447b
                  rmub(1, 0) = rmub(1, 0) + temp1448*rmu(2, 0)*&
&                    temp1447b0
                  rmub(2, 0) = rmub(2, 0) + temp1448*rmu(1, 0)*&
&                    temp1447b0
                  rmub(3, 0) = rmub(3, 0) + temp1447*rmucos(1, 0)*&
&                    temp1447b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1447*rmu(3, 0)*&
&                    temp1447b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                    temp1447b1
                  rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                    temp1447b1
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 24) THEN
                IF (.NOT.branch .LT. 23) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1453 = fun0/cellscale(3)
                  temp1456 = rmu(1, 0)*rmucos(1, 0)
                  temp1455 = rmucos(3, 0)*rmusin(3, 0)
                  temp1454 = rmu(1, 0)**2 - 3*rmu(2, 0)**2
                  temp1454b = -(cost4g*4*pi*hess4fb(2))
                  temp1454b0 = temp1456*temp1453*temp1454b
                  temp1454b1 = temp1454*temp1455*temp1454b
                  temp1453b = temp1456*temp1454b1/cellscale(3)
                  rmub(1, 0) = rmub(1, 0) + temp1453*rmucos(1, 0)*&
&                    temp1454b1 + temp1455*2*rmu(1, 0)*temp1454b0
                  rmub(2, 0) = rmub(2, 0) - temp1455*3*2*rmu(2, 0)*&
&                    temp1454b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1454*rmusin(3, 0)*&
&                    temp1454b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1453b
                  hess4fb(2) = 0.0_8
                  temp1453b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1453b0 + fun0*der4fb(2)
                  temp1451 = rmu(1, 0)*rmucos(1, 0)
                  temp1451b = cost4g*(rmu(1, 0)**2-3*rmu(2, 0)**2)*&
&                    der4fb(2)
                  rmusinb(3, 0) = rmusinb(3, 0) + temp1454*rmucos(3, 0)*&
&                    temp1454b0 - temp1451*2*rmusin(3, 0)*temp1451b
                  temp1452 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1452*rmu(1, 0)*&
&                    temp1451b + temp1453*rmu(1, 0)*temp1454b1
                  cellscaleb(3) = cellscaleb(3) - temp1453*temp1453b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1453b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1451b0 = cost4g*temp1451*temp1452*der4fb(2)
                  rmub(1, 0) = rmub(1, 0) + temp1452*rmucos(1, 0)*&
&                    temp1451b + 2*rmu(1, 0)*temp1451b0
                  rmub(2, 0) = rmub(2, 0) - 3*2*rmu(2, 0)*temp1451b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1451*2*rmucos(3, 0&
&                    )*temp1451b
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 25) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1460 = rmu(3, 0)*rmucos(2, 0)
                temp1459 = fun0*rmu(2, 0)*rmucos(3, 0)
                temp1460b = cost4g*6*hess4fb(2)
                temp1460b0 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp1460b
                temp1459b = temp1460*temp1460b0
                temp1459b0 = temp1459*temp1460*temp1460b
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(2&
&                  , 0)*temp1459b
                rmub(2, 0) = rmub(2, 0) + rmucos(3, 0)*fun0*temp1459b
                rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*temp1459b
                rmub(3, 0) = rmub(3, 0) + temp1459*rmucos(2, 0)*&
&                  temp1460b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp1459*rmu(3, 0)*&
&                  temp1460b0
                hess4fb(2) = 0.0_8
                temp1459b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1459b1 + fun0*der4fb(2)
                temp1457 = rmu(1, 0)*rmu(2, 0)
                temp1457b = cost4g*6*der4fb(2)
                temp1457b0 = rmucos(2, 0)*rmucos(3, 0)*temp1457b
                rmucosb(1, 0) = rmucosb(1, 0) + temp1457*rmu(3, 0)*&
&                  temp1457b0 + 2*rmucos(1, 0)*temp1459b0
                rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*&
&                  temp1459b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1459b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1458 = rmu(3, 0)*rmucos(1, 0)
                temp1457b1 = temp1457*temp1458*temp1457b
                rmub(1, 0) = rmub(1, 0) + temp1458*rmu(2, 0)*temp1457b0
                rmub(2, 0) = rmub(2, 0) + temp1458*rmu(1, 0)*temp1457b0
                rmub(3, 0) = rmub(3, 0) + temp1457*rmucos(1, 0)*&
&                  temp1457b0
                rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*temp1457b1
                rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*temp1457b1
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1467 = 3*rmucos(2, 0)**2 - 5*rmusin(2, 0)**2
                temp1464 = rmusin(2, 0)/cellscale(2)
                temp1466 = rmucos(2, 0)*rmucos(3, 0)
                temp1465 = fun0*rmu(3, 0)
                temp1465b = -(cost4g*2*hess4fb(2))
                temp1465b0 = (pi*6*(rmu(1, 0)**2*temp1464)+rmu(2, 0)*&
&                  temp1467)*temp1465b
                temp1465b1 = temp1465*temp1466*temp1465b
                temp1465b2 = pi*6*temp1465b1
                temp1464b = rmu(1, 0)**2*temp1465b2/cellscale(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1466*rmu(3, 0)*&
&                  temp1465b0
                rmub(3, 0) = rmub(3, 0) + temp1466*fun0*temp1465b0
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*3*2*rmucos(2, &
&                  0)*temp1465b1 + temp1465*rmucos(3, 0)*temp1465b0
                hess4fb(2) = 0.0_8
                temp1464b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1464b0 + fun0*der4fb(2)
                temp1463 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                temp1462 = rmu(2, 0)**2
                temp1461 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp1462b = cost4g*(3*(rmu(1, 0)**2*temp1461)+temp1462*&
&                  temp1463)*der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1462b + &
&                  temp1465*rmucos(2, 0)*temp1465b0
                rmub(1, 0) = rmub(1, 0) + temp1464*2*rmu(1, 0)*&
&                  temp1465b2
                temp1462b0 = cost4g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                temp1461b = 3*rmu(1, 0)**2*temp1462b0
                rmusinb(2, 0) = rmusinb(2, 0) + temp1462*2*rmusin(2, 0)*&
&                  temp1462b0 - 2*rmusin(2, 0)*temp1461b - rmu(2, 0)*5*2*&
&                  rmusin(2, 0)*temp1465b1 + temp1464b
                cellscaleb(2) = cellscaleb(2) - temp1464*temp1464b
                rmub(2, 0) = rmub(2, 0) + temp1467*temp1465b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1464b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1462b
                rmub(1, 0) = rmub(1, 0) + 3*temp1461*2*rmu(1, 0)*&
&                  temp1462b0
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp1461b&
&                  - temp1462*3*2*rmucos(2, 0)*temp1462b0
                rmub(2, 0) = rmub(2, 0) + temp1463*2*rmu(2, 0)*&
&                  temp1462b0
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 30) THEN
              IF (branch .LT. 28) THEN
                IF (.NOT.branch .LT. 27) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1470 = fun0/cellscale(3)
                  temp1473 = rmu(2, 0)*rmucos(2, 0)
                  temp1472 = rmucos(3, 0)*rmusin(3, 0)
                  temp1471 = rmu(2, 0)**2 - 3*rmu(1, 0)**2
                  temp1471b = cost4g*4*pi*hess4fb(2)
                  temp1471b0 = temp1473*temp1470*temp1471b
                  temp1471b1 = temp1471*temp1472*temp1471b
                  temp1470b = temp1473*temp1471b1/cellscale(3)
                  rmub(2, 0) = rmub(2, 0) + temp1470*rmucos(2, 0)*&
&                    temp1471b1 + temp1472*2*rmu(2, 0)*temp1471b0
                  rmub(1, 0) = rmub(1, 0) - temp1472*3*2*rmu(1, 0)*&
&                    temp1471b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1471*rmusin(3, 0)*&
&                    temp1471b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1470b
                  hess4fb(2) = 0.0_8
                  temp1470b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1470b0 + fun0*der4fb(2)
                  temp1468 = rmu(2, 0)*rmucos(2, 0)
                  temp1468b = -(cost4g*(rmu(2, 0)**2-3*rmu(1, 0)**2)*&
&                    der4fb(2))
                  rmusinb(3, 0) = rmusinb(3, 0) + temp1471*rmucos(3, 0)*&
&                    temp1471b0 - temp1468*2*rmusin(3, 0)*temp1468b
                  temp1469 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1469*rmu(2, 0)*&
&                    temp1468b + temp1470*rmu(2, 0)*temp1471b1
                  cellscaleb(3) = cellscaleb(3) - temp1470*temp1470b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1470b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1468b0 = -(cost4g*temp1468*temp1469*der4fb(2))
                  rmub(2, 0) = rmub(2, 0) + temp1469*rmucos(2, 0)*&
&                    temp1468b + 2*rmu(2, 0)*temp1468b0
                  rmub(1, 0) = rmub(1, 0) - 3*2*rmu(1, 0)*temp1468b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1468*2*rmucos(3, 0&
&                    )*temp1468b
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 29) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1474 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                temp1476 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1475 = rmu(1, 0)**2
                temp1475b = cost5g*4*hess4fb(2)
                temp1475b0 = fun0*temp1475b
                temp1474b = 3*rmu(2, 0)**2*temp1475b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + (temp1475*temp1476+&
&                  3*(rmu(2, 0)**2*temp1474))*temp1475b
                rmub(1, 0) = rmub(1, 0) + temp1476*2*rmu(1, 0)*&
&                  temp1475b0
                hess4fb(2) = 0.0_8
                temp1474b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1474b0 + fun0*der4fb(2)
                temp1474b1 = cost5g*4*der4fb(2)
                temp1474b2 = (rmu(1, 0)**2-3*rmu(2, 0)**2)*temp1474b1
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1474b2 - 2&
&                  *rmucos(1, 0)*temp1474b + temp1475*3*2*rmucos(1, 0)*&
&                  temp1475b0
                rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*temp1474b&
&                  - temp1475*2*rmusin(1, 0)*temp1475b0
                rmub(2, 0) = rmub(2, 0) + 3*temp1474*2*rmu(2, 0)*&
&                  temp1475b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1474b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1474b3 = rmu(1, 0)*rmucos(1, 0)*temp1474b1
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1474b2 + 2*&
&                  rmu(1, 0)*temp1474b3
                rmub(2, 0) = rmub(2, 0) - 3*2*rmu(2, 0)*temp1474b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1479 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                temp1478 = rmu(2, 0)**2
                temp1477 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp1478b = -(cost5g*4*hess4fb(2))
                temp1478b0 = fun0*temp1478b
                temp1477b = 3*rmu(1, 0)**2*temp1478b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + (3*(rmu(1, 0)**2*&
&                  temp1477)+temp1478*temp1479)*temp1478b
                rmub(1, 0) = rmub(1, 0) + 3*temp1477*2*rmu(1, 0)*&
&                  temp1478b0
                hess4fb(2) = 0.0_8
                temp1477b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1477b0 + fun0*der4fb(2)
                temp1477b1 = cost5g*4*der4fb(2)
                temp1477b2 = (rmu(2, 0)**2-3*rmu(1, 0)**2)*temp1477b1
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1477b2 - &
&                  temp1478*3*2*rmucos(2, 0)*temp1478b0 + 2*rmucos(2, 0)*&
&                  temp1477b
                rmusinb(2, 0) = rmusinb(2, 0) + temp1478*2*rmusin(2, 0)*&
&                  temp1478b0 - 2*rmusin(2, 0)*temp1477b
                rmub(2, 0) = rmub(2, 0) + temp1479*2*rmu(2, 0)*&
&                  temp1478b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1477b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1477b3 = rmu(2, 0)*rmucos(2, 0)*temp1477b1
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1477b2 + 2*&
&                  rmu(2, 0)*temp1477b3
                rmub(1, 0) = rmub(1, 0) - 3*2*rmu(1, 0)*temp1477b3
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 32) THEN
              IF (branch .LT. 31) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1487 = 3*rmucos(1, 0)**2 - 5*rmusin(1, 0)**2
                temp1484 = rmusin(1, 0)/cellscale(1)
                temp1486 = rmucos(1, 0)*rmucos(2, 0)
                temp1485 = fun0*rmu(2, 0)
                temp1485b = cost5g*8*hess4fb(2)
                temp1485b0 = (pi*2*(rmu(2, 0)**2*temp1484)+rmu(1, 0)*&
&                  temp1487)*temp1485b
                temp1485b1 = temp1485*temp1486*temp1485b
                temp1485b2 = pi*2*temp1485b1
                temp1484b = rmu(2, 0)**2*temp1485b2/cellscale(1)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1486*rmu(2, 0)*&
&                  temp1485b0
                rmub(2, 0) = rmub(2, 0) + temp1484*2*rmu(2, 0)*&
&                  temp1485b2 + temp1486*fun0*temp1485b0
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*3*2*rmucos(1, &
&                  0)*temp1485b1 + temp1485*rmucos(2, 0)*temp1485b0
                hess4fb(2) = 0.0_8
                temp1484b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1484b0 + fun0*der4fb(2)
                temp1483 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                temp1482 = rmu(2, 0)**2
                temp1481 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1480 = rmu(1, 0)**2
                temp1480b = cost5g*4*der4fb(2)
                temp1480b0 = (temp1480*temp1481+temp1482*temp1483)*&
&                  temp1480b
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1480b0 + &
&                  temp1485*rmucos(1, 0)*temp1485b0
                temp1480b1 = rmu(2, 0)*rmucos(2, 0)*temp1480b
                rmusinb(1, 0) = rmusinb(1, 0) + (temp1482*2*rmusin(1, 0)&
&                  -temp1480*2*rmusin(1, 0))*temp1480b1 - rmu(1, 0)*5*2*&
&                  rmusin(1, 0)*temp1485b1 + temp1484b
                cellscaleb(1) = cellscaleb(1) - temp1484*temp1484b
                rmub(1, 0) = rmub(1, 0) + temp1487*temp1485b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1484b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + temp1483*2*rmu(2, 0)*&
&                  temp1480b1 + rmucos(2, 0)*temp1480b0
                rmub(1, 0) = rmub(1, 0) + temp1481*2*rmu(1, 0)*&
&                  temp1480b1
                rmucosb(1, 0) = rmucosb(1, 0) + (temp1480*3*2*rmucos(1, &
&                  0)-temp1482*2*rmucos(1, 0))*temp1480b1
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 33) THEN
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              temp1495 = 3*rmucos(2, 0)**2 - 5*rmusin(2, 0)**2
              temp1492 = rmusin(2, 0)/cellscale(2)
              temp1494 = rmucos(1, 0)*rmucos(2, 0)
              temp1493 = fun0*rmu(1, 0)
              temp1493b = -(cost5g*8*hess4fb(2))
              temp1493b0 = (pi*2*(rmu(1, 0)**2*temp1492)+rmu(2, 0)*&
&                temp1495)*temp1493b
              temp1493b1 = temp1493*temp1494*temp1493b
              temp1493b2 = pi*2*temp1493b1
              temp1492b = rmu(1, 0)**2*temp1493b2/cellscale(2)
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              fun0b = fun0b + der4f(2)*der4fb(2) + temp1494*rmu(1, 0)*&
&                temp1493b0
              rmub(1, 0) = rmub(1, 0) + temp1492*2*rmu(1, 0)*temp1493b2 &
&                + temp1494*fun0*temp1493b0
              rmucosb(1, 0) = rmucosb(1, 0) + temp1493*rmucos(2, 0)*&
&                temp1493b0
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*3*2*rmucos(2, 0)&
&                *temp1493b1 + temp1493*rmucos(1, 0)*temp1493b0
              hess4fb(2) = 0.0_8
              temp1492b0 = 2.d0*rmu(i, 0)*hess4fb(3)
              der4fb(2) = fun*temp1492b0 + fun0*der4fb(2)
              temp1490 = rmu(2, 0)**2
              temp1488 = rmu(1, 0)**2
              temp1488b = cost5g*4*der4fb(2)
              temp1488b0 = rmu(1, 0)*rmucos(1, 0)*temp1488b
              rmusinb(2, 0) = rmusinb(2, 0) + (temp1490*2*rmusin(2, 0)-&
&                temp1488*2*rmusin(2, 0))*temp1488b0 - rmu(2, 0)*5*2*&
&                rmusin(2, 0)*temp1493b1 + temp1492b
              cellscaleb(2) = cellscaleb(2) - temp1492*temp1492b
              rmub(2, 0) = rmub(2, 0) + temp1495*temp1493b1
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
              funb = funb + der4f(2)*temp1492b0
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              temp1491 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
              temp1489 = rmucos(2, 0)**2 - rmusin(2, 0)**2
              temp1488b1 = (temp1488*temp1489+temp1490*temp1491)*&
&                temp1488b
              rmub(1, 0) = rmub(1, 0) + temp1489*2*rmu(1, 0)*temp1488b0 &
&                + rmucos(1, 0)*temp1488b1
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1488b1
              rmucosb(2, 0) = rmucosb(2, 0) + (temp1488*2*rmucos(2, 0)-&
&                temp1490*3*2*rmucos(2, 0))*temp1488b0
              rmub(2, 0) = rmub(2, 0) + temp1491*2*rmu(2, 0)*temp1488b0
              der4fb(2) = 0.0_8
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4fb(2) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp1367b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp1367b
            funb = funb + rmu(i, 0)*temp1367b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp1366 = r(0)**2
        temp1365 = fun2/temp1366
        temp1365b = rmu(i, 0)**2*radhess4fb(i)/temp1366
        temp1364 = r(0)**2
        temp1363 = rmu(i, 0)**2/temp1364
        temp1363b = -(fun*radhess4fb(i)/temp1364)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp1363b + temp1365*2*rmu&
&          (i, 0)*radhess4fb(i)
        fun2b = fun2b + temp1365b
        rb(0) = rb(0) - temp1363*2*r(0)*temp1363b - temp1365*2*r(0)*&
&          temp1365b
        funb = funb + (1.d0-temp1363)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp1362 = dd1/r(0)
      temp1362b0 = -(distp(0, 1)*funb/r(0))
      rb(0) = rb(0) + 2*r(0)*rp0b - temp1362*temp1362b0
      distpb(0, 1) = distpb(0, 1) + fun0b - temp1362*funb + dd1**2*fun2b
      dd1b = temp1362b0 + distp(0, 1)*2*dd1*fun2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=9,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp1362b = distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + cosphase(k)*temp1362b
          cosphaseb(k) = cosphaseb(k) + distp(k, 1)*temp1362b
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*cosphase(k)*zb&
&            (indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp1361 = rmu(2, i)*rmucos(2, i)
      temp1360 = rmu(1, i)*rmucos(1, i)
      temp1360b = cost5g*4.d0*distpb(i, 10)
      temp1360b0 = (rmu(1, i)**2-rmu(2, i)**2)*temp1360b
      temp1360b1 = temp1360*temp1361*temp1360b
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp1360b1 + temp1361*rmucos&
&        (1, i)*temp1360b0
      rmucosb(1, i) = rmucosb(1, i) + temp1361*rmu(1, i)*temp1360b0
      rmub(2, i) = rmub(2, i) + temp1360*rmucos(2, i)*temp1360b0 - 2*rmu&
&        (2, i)*temp1360b1
      distpb(i, 10) = 0.0_8
      temp1360b2 = cost5g*distpb(i, 9)
      distpb(i, 9) = 0.0_8
      temp1359 = rmu(3, i)*rmucos(3, i)
      temp1358b = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      rmucosb(2, i) = rmucosb(2, i) + temp1359*rmu(2, i)*temp1358b + &
&        temp1360*rmu(2, i)*temp1360b0
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp1360b2
      temp1358 = rmu(2, i)*rmucos(2, i)
      temp1358b0 = cost4g*temp1358*temp1359*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + temp1359*rmucos(2, i)*temp1358b - 2*rmu(&
&        2, i)*temp1358b0 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i)&
&        )*temp1360b2
      rmub(3, i) = rmub(3, i) + temp1358*rmucos(3, i)*temp1358b
      rmucosb(3, i) = rmucosb(3, i) + temp1358*rmu(3, i)*temp1358b
      distpb(i, 8) = 0.0_8
      temp1357 = rmu(3, i)*rmucos(3, i)
      temp1356 = rmu(1, i)*rmucos(1, i)
      temp1356b = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp1356b0 = cost4g*temp1356*temp1357*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + temp1357*rmucos(1, i)*temp1356b + 2*rmu(&
&        1, i)*temp1356b0 + 3.d0*2*rmu(1, i)*temp1358b0
      rmucosb(1, i) = rmucosb(1, i) + temp1357*rmu(1, i)*temp1356b
      rmub(3, i) = rmub(3, i) + temp1356*rmucos(3, i)*temp1356b
      rmucosb(3, i) = rmucosb(3, i) + temp1356*rmu(3, i)*temp1356b
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp1356b0
      distpb(i, 7) = 0.0_8
      temp1355 = rmu(2, i)*rmucos(2, i)
      temp1354 = rmu(1, i)*rmucos(1, i)
      temp1354b = cost3g*2.d0*distpb(i, 6)
      temp1354b0 = (7.d0*rmu(3, i)**2-rp0)*temp1354b
      temp1354b1 = temp1354*temp1355*temp1354b
      rmub(1, i) = rmub(1, i) + temp1355*rmucos(1, i)*temp1354b0
      rmucosb(1, i) = rmucosb(1, i) + temp1355*rmu(1, i)*temp1354b0
      rmub(2, i) = rmub(2, i) + temp1354*rmucos(2, i)*temp1354b0
      distpb(i, 6) = 0.0_8
      temp1354b2 = cost3g*(7.d0*rmu(3, i)**2-rp0)*distpb(i, 5)
      temp1354b3 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp1353 = rmu(3, i)*rmucos(3, i)
      temp1352b = cost2g*(7.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 4)
      rmucosb(2, i) = rmucosb(2, i) + temp1353*rmu(2, i)*temp1352b + &
&        temp1354*rmu(2, i)*temp1354b0
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1354b1
      temp1352 = rmu(2, i)*rmucos(2, i)
      temp1352b0 = cost2g*temp1352*temp1353*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp1351 = rmu(3, i)*rmucos(3, i)
      temp1350 = rmu(1, i)*rmucos(1, i)
      temp1350b0 = cost2g*(7.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 3)
      temp1350b1 = cost2g*temp1350*temp1351*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp1350b2 = cost1g*distpb(i, 2)
      rp0b = (3.d0*2*rp0-30.d0*rmu(3, i)**2)*temp1350b2 - 3.d0*&
&        temp1350b1 - temp1354b3 - 3.d0*temp1352b0 - temp1354b1
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp1354b2
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp1354b2
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1354b3
      rmub(2, i) = rmub(2, i) + temp1353*rmucos(2, i)*temp1352b
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1352b0 + temp1352*&
&        rmucos(3, i)*temp1352b
      rmucosb(3, i) = rmucosb(3, i) + temp1352*rmu(3, i)*temp1352b
      rmub(1, i) = rmub(1, i) + temp1351*rmucos(1, i)*temp1350b0
      rmucosb(1, i) = rmucosb(1, i) + temp1351*rmu(1, i)*temp1350b0
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*rp0*2*rmu(3&
&        , i))*temp1350b2 + 7.d0*2*rmu(3, i)*temp1350b1 + temp1350*rmucos&
&        (3, i)*temp1350b0
      rmucosb(3, i) = rmucosb(3, i) + temp1350*rmu(3, i)*temp1350b0
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp1350b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp1350b
      rb(k) = rb(k) - dd1*temp1350b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .020104801169736915d0*5.5d0*dd1**4.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (56)
! g single Slater orbital
! derivative of 55
! normalized
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then
! overall normalization
    c = dd1**5.5d0*.020104801169736915d0
!         c=1.d0/dsqrt(7.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(11.d0/2.d0)/3.d0/5.d0
!         endif
! radial part
    DO k=0,0
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
! angular part
! rmu replaced by rmu*rmucos with the minimal rmucos strategy
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(i)**2
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*rp0+&
&        3.d0*rp0**2)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(7.d0*rmu(3, i)**2-3.d0*rp0)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-rp0)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos(&
&        2, i)*(7.d0*rmu(3, i)**2-rp0)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmucos(1, i)*rmu(3, i)*rmucos(3, i)&
&        *(rmu(1, i)**2-3.0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmucos(2, i)*rmu(3, i)*rmucos(3, i)&
&        *(3.d0*rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmucos(1, i)*rmu(2, i)*rmucos&
&        (2, i)*(rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-4
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F * phase
    DO ic=1,9
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=0,0
          z(indorbp, k) = distp(k, 1)*(5.5d0/dd1-r(k))*distp(k, 1+ic)*&
&            cosphase(k)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
! fun2 = radial''
      fun0 = distp(0, 1)*(5.5d0/dd1-r(0))
      fun = distp(0, 1)*(dd1-6.5d0/r(0))
      fun2 = distp(0, 1)*(7.5d0*dd1-dd1**2*r(0))
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(0)**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,9
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          z(indorbp, indt+4) = 0.d0
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part ! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*12*rmu(1, 0)*rmucos(1, 0)*(-(5*rmu(3, &
&                  0)**2)+rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*12*(2*rmu(1, 0)**2*rmucos(1, 0)&
&                  **2-(rmucos(1, 0)**2-rmusin(1, 0)**2)*(5*rmu(3, 0)**2-&
&                  rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*12*rmu(2, 0)*rmucos(2, 0)*(-(5*rmu(3, &
&                  0)**2)+rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*12*(2*rmu(2, 0)**2*rmucos(2, 0)&
&                  **2-(rmucos(2, 0)**2-rmusin(2, 0)**2)*(5*rmu(3, 0)**2-&
&                  rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost1g*16*rmu(3, 0)*rmucos(3, 0)*(5*rmu(3, 0)&
&                  **2-3*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost1g*16*(rmu(3, 0)**2*(9*rmucos(3, 0)&
&                  **2-5*rmusin(3, 0)**2)+3*(-(rmucos(3, 0)**2)+rmusin(3&
&                  , 0)**2)*rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(3, 0)*rmucos(3, 0)*(-(6*rmu(1, 0)&
&                  **2*rmucos(1, 0)**2)+(rmucos(1, 0)**2-rmusin(1, 0)**2)&
&                  *(7*rmu(3, 0)**2-3*rp0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*(-(2*rmu(3, 0)*rmucos(1, 0)*&
&                  rmucos(3, 0)*(9*rmu(1, 0)*(rmucos(1, 0)**2-rmusin(1, 0&
&                  )**2)+2*pi/cellscale(1)*rmusin(1, 0)*(7*rmu(3, 0)**2-3&
&                  *rp0))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost2g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*6*rmu(1, 0)*rmu(3, 0)*rmucos(1, &
&                  0)*rmucos(3, 0)*(-(rmucos(2, 0)**2)+rmusin(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(1, 0)*rmucos(1, 0)*(rmu(3, 0)**2*(&
&                  15*rmucos(3, 0)**2-7*rmusin(3, 0)**2)+3*(-(rmucos(3, 0&
&                  )**2)+rmusin(3, 0)**2)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2g*fun0*4*rmu(1, 0)*rmucos(1, 0)*rmucos(&
&                  3, 0)*(rmu(3, 0)*(6*rmucos(3, 0)**2-13*rmusin(3, 0)**2&
&                  )+3*pi/cellscale(3)*rmusin(3, 0)*rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost2g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*6*rmu(2, 0)*rmu(3, 0)*rmucos(2, &
&                  0)*rmucos(3, 0)*(-(rmucos(1, 0)**2)+rmusin(1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(3, 0)*rmucos(3, 0)*(-(6*rmu(2, 0)&
&                  **2*rmucos(2, 0)**2)+(rmucos(2, 0)**2-rmusin(2, 0)**2)&
&                  *(7*rmu(3, 0)**2-3*rp0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*(-(2*rmu(3, 0)*rmucos(2, 0)*&
&                  rmucos(3, 0)*(9*rmu(2, 0)*(rmucos(2, 0)**2-rmusin(2, 0&
&                  )**2)+2*pi/cellscale(2)*rmusin(2, 0)*(7*rmu(3, 0)**2-3&
&                  *rp0))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost2g*rmu(2, 0)*rmucos(2, 0)*(rmu(3, 0)**2*(&
&                  15*rmucos(3, 0)**2-7*rmusin(3, 0)**2)+3*(-(rmucos(3, 0&
&                  )**2)+rmusin(3, 0)**2)*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost2g*(4*rmu(2, 0)*rmucos(2, 0)*rmucos&
&                  (3, 0)*(rmu(3, 0)*(6*rmucos(3, 0)**2-13*rmusin(3, 0)**&
&                  2)+3*pi/cellscale(3)*rmusin(3, 0)*rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost3g*4*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(3, 0&
&                  )**2)*rmucos(1, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4*fun0*cost3g*(rmu(1, 0)**2*(3*rmucos(1, 0&
&                  )**2-rmusin(1, 0)**2)+3*rmu(3, 0)**2*(-(rmucos(1, 0)**&
&                  2)+rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*4*rmu(2, 0)*(rmu(2, 0)**2-3*rmu(3, 0)&
&                  **2)*rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 4*fun0*cost3g*(rmu(2, 0)**2*(3*rmucos(2, 0)&
&                  **2-rmusin(2, 0)**2)+3*rmu(3, 0)**2*(-(rmucos(2, 0)**2&
&                  )+rmusin(2, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*12*(rmu(1, 0)**2-rmu(2, 0)**2)*rmu(3, &
&                  0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost3g*12*(rmu(1, 0)**2-rmu(2, 0)**2)*(&
&                  rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2*cost3g*rmu(2, 0)*rmucos(2, 0)*((rmu(2, 0)&
&                  **2-6*rmu(3, 0)**2)*(rmucos(1, 0)**2-rmusin(1, 0)**2)+&
&                  rmu(1, 0)**2*(3*rmucos(1, 0)**2-rmusin(1, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost3g*fun0*(4*rmu(2, 0)*rmucos(1, 0)*rmucos&
&                  (2, 0)*(2*(rmu(2, 0)**2-6*rmu(3, 0)**2)*rmusin(1, 0)*&
&                  pi/cellscale(1)+rmu(1, 0)*(-(3*rmucos(1, 0)**2)+5*&
&                  rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2*cost3g*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)&
&                  **2*(rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(3*&
&                  rmucos(2, 0)**2-rmusin(2, 0)**2)+6*rmu(3, 0)**2*(-(&
&                  rmucos(2, 0)**2)+rmusin(2, 0)**2)))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost3g*fun0*(4*rmu(1, 0)*rmucos(1, 0)*rmucos&
&                  (2, 0)*(2*(rmu(1, 0)**2-6*rmu(3, 0)**2)*rmusin(2, 0)*&
&                  pi/cellscale(2)+rmu(2, 0)*(-(3*rmucos(2, 0)**2)+5*&
&                  rmusin(2, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3g*24*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost3g*24*rmu(1, 0)*rmu(2, 0)*rmucos(1&
&                  , 0)*rmucos(2, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(3, 0)*rmucos(3, 0)*(rmu(1, 0)**2*(&
&                  3*rmucos(1, 0)**2-rmusin(1, 0)**2)+3*rmu(2, 0)**2*(-(&
&                  rmucos(1, 0)**2)+rmusin(1, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*(2*rmu(3, 0)*rmucos(1, 0)*rmucos&
&                  (3, 0)*(6*rmu(2, 0)**2*rmusin(1, 0)*pi/cellscale(1)+&
&                  rmu(1, 0)*(3*rmucos(1, 0)**2-5*rmusin(1, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6*cost4g*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*&
&                  rmucos(1, 0)*rmucos(2, 0)*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 6*cost4g*fun0*rmu(1, 0)*rmu(3, 0)*rmucos(1, &
&                  0)*rmucos(3, 0)*(-(rmucos(2, 0)**2)+rmusin(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(2, 0)**2&
&                  )*rmucos(1, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost4g*(-(4*rmu(1, 0)*(rmu(1, 0)**2-3*&
&                  rmu(2, 0)**2)*rmucos(1, 0)*rmucos(3, 0)*rmusin(3, 0)*&
&                  pi/cellscale(3)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
              END IF
            ELSE IF (ic .EQ. 7) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*6*rmu(1, 0)*rmu(2, 0)*rmu(3, 0)*rmucos&
&                  (1, 0)*rmucos(2, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*6*rmu(2, 0)*rmu(3, 0)*rmucos(2, &
&                  0)*rmucos(3, 0)*(rmucos(1, 0)**2-rmusin(1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost4g*rmu(3, 0)*rmucos(3, 0)*(3*rmu(1, 0)**2&
&                  *(rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*&
&                  rmucos(2, 0)**2)+rmusin(2, 0)**2))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost4g*fun0*(-(2*rmu(3, 0)*rmucos(2, 0)*&
&                  rmucos(3, 0)*(6*rmu(1, 0)**2*rmusin(2, 0)*pi/cellscale&
&                  (2)+rmu(2, 0)*(3*rmucos(2, 0)**2-5*rmusin(2, 0)**2))))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(cost4g*(rmu(2, 0)*(-(3*rmu(1, 0)**2)+rmu(2&
&                  , 0)**2)*rmucos(2, 0)*(rmucos(3, 0)**2-rmusin(3, 0)**2&
&                  )))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = fun0*cost4g*(4*rmu(2, 0)*(-(3*rmu(1, 0)**2)+&
&                  rmu(2, 0)**2)*rmucos(2, 0)*rmucos(3, 0)*rmusin(3, 0)*&
&                  pi/cellscale(3))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
              END IF
            ELSE IF (ic .EQ. 8) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost5g*4*rmu(1, 0)*(rmu(1, 0)**2-3*rmu(2, 0)&
&                  **2)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost5g*fun0*4*(rmu(1, 0)**2*(3*rmucos(1, 0)&
&                  **2-rmusin(1, 0)**2)+3*rmu(2, 0)**2*(-(rmucos(1, 0)**2&
&                  )+rmusin(1, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost5g*4*rmu(2, 0)*(-(3*rmu(1, 0)**2)+rmu(2, &
&                  0)**2)*rmucos(2, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4*cost5g*fun0*(3*rmu(1, 0)**2*(rmucos(2, 0&
&                  )**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*rmucos(2, 0)**&
&                  2)+rmusin(2, 0)**2)))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,29)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,30)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost5g*4*rmu(2, 0)*rmucos(2, 0)*(rmu(1, 0)**2*(&
&                3*rmucos(1, 0)**2-rmusin(1, 0)**2)+rmu(2, 0)**2*(-(&
&                rmucos(1, 0)**2)+rmusin(1, 0)**2))
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = cost5g*fun0*(8*rmu(2, 0)*rmucos(1, 0)*rmucos(2&
&                , 0)*(2*rmu(2, 0)**2*rmusin(1, 0)*pi/cellscale(1)+rmu(1&
&                , 0)*(3*rmucos(1, 0)**2-5*rmusin(1, 0)**2)))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,31)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost5g*4*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)**2*(&
&                rmucos(2, 0)**2-rmusin(2, 0)**2)+rmu(2, 0)**2*(-(3*&
&                rmucos(2, 0)**2)+rmusin(2, 0)**2))
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = cost5g*fun0*(-(8*rmu(1, 0)*rmucos(1, 0)*rmucos&
&                (2, 0)*(2*rmu(1, 0)**2*rmusin(2, 0)*pi/cellscale(2)+rmu(&
&                2, 0)*(3*rmucos(2, 0)**2-5*rmusin(2, 0)**2))))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,32)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,33)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
!endif for ic
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
            z(indorbp, indt+i) = der4f(1)*rmucos(i, 0) + der4f(2)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! rest of laplacian (with the phase)
! d^2/dx^2_k \Psi(X_i) = d^2/dx^2_k F(X_i) \phi(x_i) + 2 d/dx_k F(X_i)  d/dx_k \phi(x_i)
!                        + F(X_i) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) already computed and stored in hess4f(k)
! d/dx_k F(X_i) already computed and stored in z(indorbp,indt+k)
! F(X_i) = distp(0,1)*distp(0,1+ic)
            hess4f(1) = hess4f(1)*cosphase(0) - 2.d0*z(indorbp, indt+i)*&
&              sinphase(i, 0)*rphase(i) - distp(0, 1)*(11.d0/4.d0/dd1-r(0&
&              )**2)*distp(0, 1+ic)*cosphase(0)*rphase(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
! gradient (with the phase)
! compute d/dx_k \Psi(X_i)
!  (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
            z(indorbp, indt+i) = z(indorbp, indt+i)*cosphase(0) - distp(&
&              0, 1)*(11.d0/4.d0/dd1-r(0)**2)*distp(0, 1+ic)*sinphase(i, &
&              0)*rphase(i)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
!                     z_xyz(indorbp,i)=hess4f(1)
            z(indorbp, indt+4) = z(indorbp, indt+4) + hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      dd1b = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=9,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            temp1652 = distp(0, 1)*rphase(i)
            temp1651 = distp(0, 1+ic)*sinphase(i, 0)
            temp1651b = -(temp1651*temp1652*zb(indorbp, indt+i))
            temp1650 = 4.d0*dd1
            temp1649 = 11.d0/temp1650
            temp1649b = -((temp1649-r(0)**2)*zb(indorbp, indt+i))
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1648 = distp(0, 1+ic)*rphase(i)**2
            temp1646 = 4.d0*dd1
            temp1645 = 11.d0/temp1646
            temp1645b = -((temp1645-r(0)**2)*hess4fb(1))
            cosphaseb(0) = cosphaseb(0) + hess4f(1)*hess4fb(1) + &
&              temp1648*distp(0, 1)*temp1645b + z(indorbp, indt+i)*zb(&
&              indorbp, indt+i)
            temp1647 = distp(0, 1)*cosphase(0)
            temp1647b = -(temp1647*temp1648*hess4fb(1))
            dd1b = dd1b - temp1645*4.d0*temp1647b/temp1646 - temp1649*&
&              4.d0*temp1651b/temp1650
            rb(0) = rb(0) - 2*r(0)*temp1647b - 2*r(0)*temp1651b
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp1652*sinphase(i, 0)*&
&              temp1649b
            temp1649b0 = -(2.d0*z(indorbp, indt+i)*hess4fb(1))
            sinphaseb(i, 0) = sinphaseb(i, 0) + rphase(i)*temp1649b0 + &
&              temp1652*distp(0, 1+ic)*temp1649b
            distpb(0, 1) = distpb(0, 1) + temp1648*cosphase(0)*temp1645b&
&              + temp1651*rphase(i)*temp1649b
            rphaseb(i) = rphaseb(i) + sinphase(i, 0)*temp1649b0 + &
&              temp1647*distp(0, 1+ic)*2*rphase(i)*temp1645b + temp1651*&
&              distp(0, 1)*temp1649b
            zb(indorbp, indt+i) = cosphase(0)*zb(indorbp, indt+i) - 2.d0&
&              *sinphase(i, 0)*rphase(i)*hess4fb(1)
            distpb(0, 1+ic) = distpb(0, 1+ic) + temp1647*rphase(i)**2*&
&              temp1645b
            hess4fb(1) = cosphase(0)*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1644 = der4f(1)/cellscale(i)
            temp1644b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp1644*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp1644b
            cellscaleb(i) = cellscaleb(i) - temp1644*temp1644b
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+i))
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 17) THEN
              IF (branch .LT. 9) THEN
                IF (branch .LT. 5) THEN
                  IF (branch .LT. 3) THEN
                    IF (branch .LT. 2) THEN
                      IF (branch .LT. 1) THEN
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                        temp1516 = 5*rmu(3, 0)**2 - rp0
                        temp1515 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                        temp1515b0 = cost1g*12*hess4fb(2)
                        temp1515b1 = fun0*temp1515b0
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        fun0b = fun0b + der4f(2)*der4fb(2) + (2*(rmu(1, &
&                          0)**2*rmucos(1, 0)**2)-temp1515*temp1516)*&
&                          temp1515b0
                        rmub(1, 0) = rmub(1, 0) + 2**2*rmucos(1, 0)**2*&
&                          rmu(1, 0)*temp1515b1
                        hess4fb(2) = 0.0_8
                        temp1515b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                        der4fb(2) = fun*temp1515b2 + fun0*der4fb(2)
                        temp1515b3 = cost1g*12*der4fb(2)
                        temp1515b4 = (rp0-5*rmu(3, 0)**2)*temp1515b3
                        rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                          temp1515b4 + (2**2*rmu(1, 0)**2*rmucos(1, 0)-&
&                          temp1516*2*rmucos(1, 0))*temp1515b1
                        rmusinb(1, 0) = rmusinb(1, 0) + temp1516*2*&
&                          rmusin(1, 0)*temp1515b1
                        rmub(3, 0) = rmub(3, 0) - temp1515*5*2*rmu(3, 0)&
&                          *temp1515b1
                        temp1515b5 = rmu(1, 0)*rmucos(1, 0)*temp1515b3
                        rp0b = rp0b + temp1515b5 + temp1515*temp1515b1
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                        rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                          hess4fb(3)
                        funb = funb + der4f(2)*temp1515b2
                        hess4fb(3) = 0.0_8
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*&
&                          temp1515b4
                        rmub(3, 0) = rmub(3, 0) - 5*2*rmu(3, 0)*&
&                          temp1515b5
                        der4fb(2) = 0.0_8
                      ELSE
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                        temp1518 = 5*rmu(3, 0)**2 - rp0
                        temp1517 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                        temp1517b = cost1g*12*hess4fb(2)
                        temp1517b0 = fun0*temp1517b
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        fun0b = fun0b + der4f(2)*der4fb(2) + (2*(rmu(2, &
&                          0)**2*rmucos(2, 0)**2)-temp1517*temp1518)*&
&                          temp1517b
                        rmub(2, 0) = rmub(2, 0) + 2**2*rmucos(2, 0)**2*&
&                          rmu(2, 0)*temp1517b0
                        hess4fb(2) = 0.0_8
                        temp1517b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                        der4fb(2) = fun*temp1517b1 + fun0*der4fb(2)
                        temp1517b2 = cost1g*12*der4fb(2)
                        temp1517b3 = (rp0-5*rmu(3, 0)**2)*temp1517b2
                        rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                          temp1517b3 + (2**2*rmu(2, 0)**2*rmucos(2, 0)-&
&                          temp1518*2*rmucos(2, 0))*temp1517b0
                        rmusinb(2, 0) = rmusinb(2, 0) + temp1518*2*&
&                          rmusin(2, 0)*temp1517b0
                        rmub(3, 0) = rmub(3, 0) - temp1517*5*2*rmu(3, 0)&
&                          *temp1517b0
                        temp1517b4 = rmu(2, 0)*rmucos(2, 0)*temp1517b2
                        rp0b = rp0b + temp1517b4 + temp1517*temp1517b0
                        CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                        rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                          hess4fb(3)
                        funb = funb + der4f(2)*temp1517b1
                        hess4fb(3) = 0.0_8
                        CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                        rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*&
&                          temp1517b3
                        rmub(3, 0) = rmub(3, 0) - 5*2*rmu(3, 0)*&
&                          temp1517b4
                        der4fb(2) = 0.0_8
                      END IF
                    END IF
                  ELSE IF (branch .LT. 4) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1519 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                    temp1521 = 9*rmucos(3, 0)**2 - 5*rmusin(3, 0)**2
                    temp1520 = rmu(3, 0)**2
                    temp1520b = cost1g*16*hess4fb(2)
                    temp1520b0 = fun0*temp1520b
                    temp1519b = 3*rp0*temp1520b0
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (temp1520*&
&                      temp1521+3*(temp1519*rp0))*temp1520b
                    rmub(3, 0) = rmub(3, 0) + temp1521*2*rmu(3, 0)*&
&                      temp1520b0
                    hess4fb(2) = 0.0_8
                    temp1519b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1519b0 + fun0*der4fb(2)
                    temp1519b1 = cost1g*16*der4fb(2)
                    temp1519b2 = (5*rmu(3, 0)**2-3*rp0)*temp1519b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1519b2&
&                      - 2*rmucos(3, 0)*temp1519b + temp1520*9*2*rmucos(3&
&                      , 0)*temp1520b0
                    rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                      temp1519b - temp1520*5*2*rmusin(3, 0)*temp1520b0
                    temp1519b3 = rmu(3, 0)*rmucos(3, 0)*temp1519b1
                    rp0b = rp0b + 3*temp1519*temp1520b0 - 3*temp1519b3
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1519b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5*2*rmu(3, 0)*temp1519b3 +&
&                      rmucos(3, 0)*temp1519b2
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1528 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1524 = rmusin(1, 0)/cellscale(1)
                    temp1525 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                    temp1527 = rmucos(1, 0)*rmucos(3, 0)
                    temp1526 = fun0*rmu(3, 0)
                    temp1526b = -(cost2g*2*hess4fb(2))
                    temp1526b0 = (9*(rmu(1, 0)*temp1525)+pi*2*(temp1524*&
&                      temp1528))*temp1526b
                    temp1526b1 = temp1526*temp1527*temp1526b
                    temp1525b = 9*rmu(1, 0)*temp1526b1
                    temp1525b0 = pi*2*temp1526b1
                    temp1524b = temp1528*temp1525b0/cellscale(1)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp1527*rmu(3&
&                      , 0)*temp1526b0
                    rmub(3, 0) = rmub(3, 0) + temp1524*7*2*rmu(3, 0)*&
&                      temp1525b0 + temp1527*fun0*temp1526b0
                    rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*&
&                      temp1525b + temp1526*rmucos(3, 0)*temp1526b0
                    hess4fb(2) = 0.0_8
                    temp1524b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1524b0 + fun0*der4fb(2)
                    temp1523 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1522 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                    temp1522b = cost2g*(temp1522*temp1523-6*(rmu(1, 0)**&
&                      2*rmucos(1, 0)**2))*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1522b &
&                      + temp1526*rmucos(1, 0)*temp1526b0
                    rmub(1, 0) = rmub(1, 0) + 9*temp1525*temp1526b1
                    temp1522b0 = cost2g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                    rmusinb(1, 0) = rmusinb(1, 0) + temp1524b - temp1523&
&                      *2*rmusin(1, 0)*temp1522b0 - 2*rmusin(1, 0)*&
&                      temp1525b
                    cellscaleb(1) = cellscaleb(1) - temp1524*temp1524b
                    rp0b = rp0b - temp1522*3*temp1522b0 - temp1524*3*&
&                      temp1525b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1524b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + temp1522*7*2*rmu(3, 0)*&
&                      temp1522b0 + rmucos(3, 0)*temp1522b
                    rmucosb(1, 0) = rmucosb(1, 0) + (temp1523*2*rmucos(1&
&                      , 0)-6*rmu(1, 0)**2*2*rmucos(1, 0))*temp1522b0
                    rmub(1, 0) = rmub(1, 0) - 6*rmucos(1, 0)**2*2*rmu(1&
&                      , 0)*temp1522b0
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 7) THEN
                  IF (branch .LT. 6) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1532 = rmu(3, 0)*rmucos(1, 0)
                    temp1531 = fun0*rmu(1, 0)*rmucos(3, 0)
                    temp1532b = cost2g*6*hess4fb(2)
                    temp1532b0 = (rmusin(2, 0)**2-rmucos(2, 0)**2)*&
&                      temp1532b
                    temp1531b = temp1532*temp1532b0
                    temp1531b0 = temp1531*temp1532*temp1532b
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(1, 0)*temp1531b
                    rmub(1, 0) = rmub(1, 0) + rmucos(3, 0)*fun0*&
&                      temp1531b
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                      temp1531b
                    rmub(3, 0) = rmub(3, 0) + temp1531*rmucos(1, 0)*&
&                      temp1532b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1531*rmu(3, 0)*&
&                      temp1532b0
                    rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                      temp1531b0
                    rmucosb(2, 0) = rmucosb(2, 0) - 2*rmucos(2, 0)*&
&                      temp1531b0
                    hess4fb(2) = 0.0_8
                    temp1531b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1531b1 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1531b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1530 = rmu(3, 0)*rmucos(1, 0)
                    temp1529 = rmu(1, 0)*rmu(2, 0)
                    temp1529b = -(cost2g*6*der4fb(2))
                    temp1529b0 = rmucos(2, 0)*rmucos(3, 0)*temp1529b
                    temp1529b1 = temp1529*temp1530*temp1529b
                    rmub(1, 0) = rmub(1, 0) + temp1530*rmu(2, 0)*&
&                      temp1529b0
                    rmub(2, 0) = rmub(2, 0) + temp1530*rmu(1, 0)*&
&                      temp1529b0
                    rmub(3, 0) = rmub(3, 0) + temp1529*rmucos(1, 0)*&
&                      temp1529b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1529*rmu(3, 0)*&
&                      temp1529b0
                    rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                      temp1529b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                      temp1529b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 8) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1536 = rp0/cellscale(3)
                  temp1539 = 6*rmucos(3, 0)**2 - 13*rmusin(3, 0)**2
                  temp1538 = rmucos(1, 0)*rmucos(3, 0)
                  temp1537 = fun0*rmu(1, 0)
                  temp1537b = cost2g*4*hess4fb(2)
                  temp1537b0 = (rmu(3, 0)*temp1539+pi*3*(rmusin(3, 0)*&
&                    temp1536))*temp1537b
                  temp1537b1 = temp1537*temp1538*temp1537b
                  temp1537b2 = pi*3*temp1537b1
                  temp1536b = rmusin(3, 0)*temp1537b2/cellscale(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1538*rmu(1, 0&
&                    )*temp1537b0
                  rmub(1, 0) = rmub(1, 0) + temp1538*fun0*temp1537b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1537*rmucos(3, 0)*&
&                    temp1537b0
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*6*2*rmucos(3&
&                    , 0)*temp1537b1 + temp1537*rmucos(1, 0)*temp1537b0
                  rmub(3, 0) = rmub(3, 0) + temp1539*temp1537b1
                  hess4fb(2) = 0.0_8
                  temp1536b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1536b0 + fun0*der4fb(2)
                  temp1534 = rmu(3, 0)**2
                  temp1534b = cost2g*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
                  temp1533b = 3*rp0*temp1534b
                  rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                    temp1533b - temp1534*7*2*rmusin(3, 0)*temp1534b + &
&                    temp1536*temp1537b2 - rmu(3, 0)*13*2*rmusin(3, 0)*&
&                    temp1537b1
                  temp1533 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                  rp0b = rp0b + 3*temp1533*temp1534b + temp1536b
                  cellscaleb(3) = cellscaleb(3) - temp1536*temp1536b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1536b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1535 = 15*rmucos(3, 0)**2 - 7*rmusin(3, 0)**2
                  temp1534b0 = cost2g*(temp1534*temp1535+3*(temp1533*rp0&
&                    ))*der4fb(2)
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1534b0
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1534b0
                  rmub(3, 0) = rmub(3, 0) + temp1535*2*rmu(3, 0)*&
&                    temp1534b
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1534*15*2*rmucos(3&
&                    , 0)*temp1534b - 2*rmucos(3, 0)*temp1533b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1543 = rmu(3, 0)*rmucos(2, 0)
                  temp1542 = fun0*rmu(2, 0)*rmucos(3, 0)
                  temp1543b = cost2g*6*hess4fb(2)
                  temp1543b0 = (rmusin(1, 0)**2-rmucos(1, 0)**2)*&
&                    temp1543b
                  temp1542b = temp1543*temp1543b0
                  temp1542b0 = temp1542*temp1543*temp1543b
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(&
&                    2, 0)*temp1542b
                  rmub(2, 0) = rmub(2, 0) + rmucos(3, 0)*fun0*temp1542b
                  rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*&
&                    temp1542b
                  rmub(3, 0) = rmub(3, 0) + temp1542*rmucos(2, 0)*&
&                    temp1543b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1542*rmu(3, 0)*&
&                    temp1543b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1542b0
                  hess4fb(2) = 0.0_8
                  temp1542b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1542b1 + fun0*der4fb(2)
                  temp1540 = rmu(1, 0)*rmu(2, 0)
                  temp1540b = -(cost2g*6*der4fb(2))
                  temp1540b0 = rmucos(2, 0)*rmucos(3, 0)*temp1540b
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1540*rmu(3, 0)*&
&                    temp1540b0 - 2*rmucos(1, 0)*temp1542b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1542b1
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1541 = rmu(3, 0)*rmucos(1, 0)
                  temp1540b1 = temp1540*temp1541*temp1540b
                  rmub(1, 0) = rmub(1, 0) + temp1541*rmu(2, 0)*&
&                    temp1540b0
                  rmub(2, 0) = rmub(2, 0) + temp1541*rmu(1, 0)*&
&                    temp1540b0
                  rmub(3, 0) = rmub(3, 0) + temp1540*rmucos(1, 0)*&
&                    temp1540b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                    temp1540b1
                  rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                    temp1540b1
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 13) THEN
                IF (branch .LT. 11) THEN
                  IF (branch .LT. 10) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1550 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1546 = rmusin(2, 0)/cellscale(2)
                    temp1547 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                    temp1549 = rmucos(2, 0)*rmucos(3, 0)
                    temp1548 = fun0*rmu(3, 0)
                    temp1548b = -(cost2g*2*hess4fb(2))
                    temp1548b0 = (9*(rmu(2, 0)*temp1547)+pi*2*(temp1546*&
&                      temp1550))*temp1548b
                    temp1548b1 = temp1548*temp1549*temp1548b
                    temp1547b = 9*rmu(2, 0)*temp1548b1
                    temp1547b0 = pi*2*temp1548b1
                    temp1546b = temp1550*temp1547b0/cellscale(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp1549*rmu(3&
&                      , 0)*temp1548b0
                    rmub(3, 0) = rmub(3, 0) + temp1546*7*2*rmu(3, 0)*&
&                      temp1547b0 + temp1549*fun0*temp1548b0
                    rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*&
&                      temp1547b + temp1548*rmucos(3, 0)*temp1548b0
                    hess4fb(2) = 0.0_8
                    temp1546b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1546b0 + fun0*der4fb(2)
                    temp1545 = 7*rmu(3, 0)**2 - 3*rp0
                    temp1544 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                    temp1544b = cost2g*(temp1544*temp1545-6*(rmu(2, 0)**&
&                      2*rmucos(2, 0)**2))*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1544b &
&                      + temp1548*rmucos(2, 0)*temp1548b0
                    rmub(2, 0) = rmub(2, 0) + 9*temp1547*temp1548b1
                    temp1544b0 = cost2g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                    rmusinb(2, 0) = rmusinb(2, 0) + temp1546b - temp1545&
&                      *2*rmusin(2, 0)*temp1544b0 - 2*rmusin(2, 0)*&
&                      temp1547b
                    cellscaleb(2) = cellscaleb(2) - temp1546*temp1546b
                    rp0b = rp0b - temp1544*3*temp1544b0 - temp1546*3*&
&                      temp1547b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1546b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + temp1544*7*2*rmu(3, 0)*&
&                      temp1544b0 + rmucos(3, 0)*temp1544b
                    rmucosb(2, 0) = rmucosb(2, 0) + (temp1545*2*rmucos(2&
&                      , 0)-6*rmu(2, 0)**2*2*rmucos(2, 0))*temp1544b0
                    rmub(2, 0) = rmub(2, 0) - 6*rmucos(2, 0)**2*2*rmu(2&
&                      , 0)*temp1544b0
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 12) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1554 = rp0/cellscale(3)
                  temp1557 = 6*rmucos(3, 0)**2 - 13*rmusin(3, 0)**2
                  temp1556 = rmucos(2, 0)*rmucos(3, 0)
                  temp1555 = fun0*rmu(2, 0)
                  temp1555b = cost2g*4*hess4fb(2)
                  temp1555b0 = (rmu(3, 0)*temp1557+pi*3*(rmusin(3, 0)*&
&                    temp1554))*temp1555b
                  temp1555b1 = temp1555*temp1556*temp1555b
                  temp1555b2 = pi*3*temp1555b1
                  temp1554b = rmusin(3, 0)*temp1555b2/cellscale(3)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1556*rmu(2, 0&
&                    )*temp1555b0
                  rmub(2, 0) = rmub(2, 0) + temp1556*fun0*temp1555b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1555*rmucos(3, 0)*&
&                    temp1555b0
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*6*2*rmucos(3&
&                    , 0)*temp1555b1 + temp1555*rmucos(2, 0)*temp1555b0
                  rmub(3, 0) = rmub(3, 0) + temp1557*temp1555b1
                  hess4fb(2) = 0.0_8
                  temp1554b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1554b0 + fun0*der4fb(2)
                  temp1552 = rmu(3, 0)**2
                  temp1552b = cost2g*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                  temp1551b = 3*rp0*temp1552b
                  rmusinb(3, 0) = rmusinb(3, 0) + 2*rmusin(3, 0)*&
&                    temp1551b - temp1552*7*2*rmusin(3, 0)*temp1552b + &
&                    temp1554*temp1555b2 - rmu(3, 0)*13*2*rmusin(3, 0)*&
&                    temp1555b1
                  temp1551 = rmusin(3, 0)**2 - rmucos(3, 0)**2
                  rp0b = rp0b + 3*temp1551*temp1552b + temp1554b
                  cellscaleb(3) = cellscaleb(3) - temp1554*temp1554b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1554b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1553 = 15*rmucos(3, 0)**2 - 7*rmusin(3, 0)**2
                  temp1552b0 = cost2g*(temp1552*temp1553+3*(temp1551*rp0&
&                    ))*der4fb(2)
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1552b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1552b0
                  rmub(3, 0) = rmub(3, 0) + temp1553*2*rmu(3, 0)*&
&                    temp1552b
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1552*15*2*rmucos(3&
&                    , 0)*temp1552b - 2*rmucos(3, 0)*temp1551b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1558 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                  temp1560 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                  temp1559 = rmu(1, 0)**2
                  temp1559b = -(cost3g*4*hess4fb(2))
                  temp1559b0 = fun0*temp1559b
                  temp1558b = 3*rmu(3, 0)**2*temp1559b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (temp1559*&
&                    temp1560+3*(rmu(3, 0)**2*temp1558))*temp1559b
                  rmub(1, 0) = rmub(1, 0) + temp1560*2*rmu(1, 0)*&
&                    temp1559b0
                  hess4fb(2) = 0.0_8
                  temp1558b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1558b0 + fun0*der4fb(2)
                  temp1558b1 = -(cost3g*4*der4fb(2))
                  temp1558b2 = (rmu(1, 0)**2-3*rmu(3, 0)**2)*temp1558b1
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1558b2 -&
&                    2*rmucos(1, 0)*temp1558b + temp1559*3*2*rmucos(1, 0)&
&                    *temp1559b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1558b - temp1559*2*rmusin(1, 0)*temp1559b0
                  rmub(3, 0) = rmub(3, 0) + 3*temp1558*2*rmu(3, 0)*&
&                    temp1559b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1558b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1558b3 = rmu(1, 0)*rmucos(1, 0)*temp1558b1
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1558b2 + 2*&
&                    rmu(1, 0)*temp1558b3
                  rmub(3, 0) = rmub(3, 0) - 3*2*rmu(3, 0)*temp1558b3
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1561 = rmusin(2, 0)**2 - rmucos(2, 0)**2
                  temp1563 = 3*rmucos(2, 0)**2 - rmusin(2, 0)**2
                  temp1562 = rmu(2, 0)**2
                  temp1562b = cost3g*4*hess4fb(2)
                  temp1562b0 = fun0*temp1562b
                  temp1561b = 3*rmu(3, 0)**2*temp1562b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (temp1562*&
&                    temp1563+3*(rmu(3, 0)**2*temp1561))*temp1562b
                  rmub(2, 0) = rmub(2, 0) + temp1563*2*rmu(2, 0)*&
&                    temp1562b0
                  hess4fb(2) = 0.0_8
                  temp1561b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1561b0 + fun0*der4fb(2)
                  temp1561b1 = cost3g*4*der4fb(2)
                  temp1561b2 = (rmu(2, 0)**2-3*rmu(3, 0)**2)*temp1561b1
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1561b2 -&
&                    2*rmucos(2, 0)*temp1561b + temp1562*3*2*rmucos(2, 0)&
&                    *temp1562b0
                  rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                    temp1561b - temp1562*2*rmusin(2, 0)*temp1562b0
                  rmub(3, 0) = rmub(3, 0) + 3*temp1561*2*rmu(3, 0)*&
&                    temp1562b0
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1561b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1561b3 = rmu(2, 0)*rmucos(2, 0)*temp1561b1
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1561b2 + 2*&
&                    rmu(2, 0)*temp1561b3
                  rmub(3, 0) = rmub(3, 0) - 3*2*rmu(3, 0)*temp1561b3
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 16) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1564 = rmu(1, 0)**2 - rmu(2, 0)**2
                temp1564b = cost3g*12*hess4fb(2)
                temp1564b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*temp1564b
                temp1564b1 = fun0*temp1564*temp1564b
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1564*temp1564b0
                rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp1564b0
                rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp1564b0
                hess4fb(2) = 0.0_8
                temp1564b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1564b2 + fun0*der4fb(2)
                temp1564b3 = cost3g*12*der4fb(2)
                temp1564b4 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp1564b3
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1564b4 + 2&
&                  *rmucos(3, 0)*temp1564b1
                rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*&
&                  temp1564b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1564b2
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1564b5 = rmu(3, 0)*rmucos(3, 0)*temp1564b3
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp1564b5
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp1564b5
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1564b4
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1573 = 5*rmusin(1, 0)**2 - 3*rmucos(1, 0)**2
                temp1569 = rmusin(1, 0)/cellscale(1)
                temp1572 = rmu(2, 0)**2 - 6*rmu(3, 0)**2
                temp1571 = rmucos(1, 0)*rmucos(2, 0)
                temp1570 = fun0*rmu(2, 0)
                temp1570b = cost3g*4*hess4fb(2)
                temp1570b0 = (pi*2*(temp1572*temp1569)+rmu(1, 0)*&
&                  temp1573)*temp1570b
                temp1570b1 = temp1570*temp1571*temp1570b
                temp1570b2 = pi*2*temp1570b1
                temp1569b = temp1572*temp1570b2/cellscale(1)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1571*rmu(2, 0)*&
&                  temp1570b0
                rmub(2, 0) = rmub(2, 0) + temp1569*2*rmu(2, 0)*&
&                  temp1570b2 + temp1571*fun0*temp1570b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1570*rmucos(2, 0)*&
&                  temp1570b0 - rmu(1, 0)*3*2*rmucos(1, 0)*temp1570b1
                hess4fb(2) = 0.0_8
                temp1569b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1569b0 + fun0*der4fb(2)
                temp1568 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1567 = rmu(1, 0)**2
                temp1566 = rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1565 = rmu(2, 0)**2 - 6*rmu(3, 0)**2
                temp1565b = -(cost3g*2*der4fb(2))
                temp1565b0 = (temp1565*temp1566+temp1567*temp1568)*&
&                  temp1565b
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1565b0 + &
&                  temp1570*rmucos(1, 0)*temp1570b0
                rmub(3, 0) = rmub(3, 0) - temp1569*6*2*rmu(3, 0)*&
&                  temp1570b2
                temp1565b1 = rmu(2, 0)*rmucos(2, 0)*temp1565b
                rmusinb(1, 0) = rmusinb(1, 0) + (-(temp1567*2*rmusin(1, &
&                  0))-temp1565*2*rmusin(1, 0))*temp1565b1 + rmu(1, 0)*5*&
&                  2*rmusin(1, 0)*temp1570b1 + temp1569b
                cellscaleb(1) = cellscaleb(1) - temp1569*temp1569b
                rmub(1, 0) = rmub(1, 0) + temp1573*temp1570b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1569b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + temp1566*2*rmu(2, 0)*&
&                  temp1565b1 + rmucos(2, 0)*temp1565b0
                rmub(3, 0) = rmub(3, 0) - temp1566*6*2*rmu(3, 0)*&
&                  temp1565b1
                rmucosb(1, 0) = rmucosb(1, 0) + (temp1567*3*2*rmucos(1, &
&                  0)+temp1565*2*rmucos(1, 0))*temp1565b1
                rmub(1, 0) = rmub(1, 0) + temp1568*2*rmu(1, 0)*&
&                  temp1565b1
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 26) THEN
              IF (branch .LT. 22) THEN
                IF (branch .LT. 20) THEN
                  IF (branch .LT. 19) THEN
                    IF (branch .LT. 18) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp1583 = 5*rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                      temp1579 = rmusin(2, 0)/cellscale(2)
                      temp1582 = rmu(1, 0)**2 - 6*rmu(3, 0)**2
                      temp1581 = rmucos(1, 0)*rmucos(2, 0)
                      temp1580 = fun0*rmu(1, 0)
                      temp1580b = cost3g*4*hess4fb(2)
                      temp1580b0 = (pi*2*(temp1582*temp1579)+rmu(2, 0)*&
&                        temp1583)*temp1580b
                      temp1580b1 = temp1580*temp1581*temp1580b
                      temp1580b2 = pi*2*temp1580b1
                      temp1579b = temp1582*temp1580b2/cellscale(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + temp1581*rmu(&
&                        1, 0)*temp1580b0
                      rmub(1, 0) = rmub(1, 0) + temp1579*2*rmu(1, 0)*&
&                        temp1580b2 + temp1581*fun0*temp1580b0
                      rmucosb(1, 0) = rmucosb(1, 0) + temp1580*rmucos(2&
&                        , 0)*temp1580b0
                      rmucosb(2, 0) = rmucosb(2, 0) + temp1580*rmucos(1&
&                        , 0)*temp1580b0 - rmu(2, 0)*3*2*rmucos(2, 0)*&
&                        temp1580b1
                      rmub(3, 0) = rmub(3, 0) - temp1579*6*2*rmu(3, 0)*&
&                        temp1580b2
                      hess4fb(2) = 0.0_8
                      temp1579b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp1579b0 + fun0*der4fb(2)
                      temp1577 = rmu(2, 0)**2
                      temp1575 = rmu(1, 0)**2
                      temp1575b = -(cost3g*2*der4fb(2))
                      temp1575b0 = rmu(1, 0)*rmucos(1, 0)*temp1575b
                      temp1574b = 6*rmu(3, 0)**2*temp1575b0
                      rmusinb(2, 0) = rmusinb(2, 0) + (-(temp1577*2*&
&                        rmusin(2, 0))-temp1575*2*rmusin(2, 0))*&
&                        temp1575b0 + 2*rmusin(2, 0)*temp1574b + rmu(2, 0&
&                        )*5*2*rmusin(2, 0)*temp1580b1 + temp1579b
                      cellscaleb(2) = cellscaleb(2) - temp1579*temp1579b
                      rmub(2, 0) = rmub(2, 0) + temp1583*temp1580b1
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp1579b0
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp1574 = rmusin(2, 0)**2 - rmucos(2, 0)**2
                      temp1578 = 3*rmucos(2, 0)**2 - rmusin(2, 0)**2
                      temp1576 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                      temp1575b1 = (temp1575*temp1576+temp1577*temp1578+&
&                        6*(rmu(3, 0)**2*temp1574))*temp1575b
                      rmub(1, 0) = rmub(1, 0) + temp1576*2*rmu(1, 0)*&
&                        temp1575b0 + rmucos(1, 0)*temp1575b1
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp1575b1
                      rmucosb(2, 0) = rmucosb(2, 0) + (temp1577*3*2*&
&                        rmucos(2, 0)+temp1575*2*rmucos(2, 0))*temp1575b0&
&                        - 2*rmucos(2, 0)*temp1574b
                      rmub(2, 0) = rmub(2, 0) + temp1578*2*rmu(2, 0)*&
&                        temp1575b0
                      rmub(3, 0) = rmub(3, 0) + 6*temp1574*2*rmu(3, 0)*&
&                        temp1575b0
                      der4fb(2) = 0.0_8
                    END IF
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1587 = rmu(2, 0)*rmucos(1, 0)
                    temp1586 = fun0*rmu(1, 0)*rmucos(2, 0)
                    temp1587b = cost3g*24*hess4fb(2)
                    temp1587b0 = (rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                      temp1587b
                    temp1586b = temp1587*temp1587b0
                    temp1586b0 = temp1586*temp1587*temp1587b
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*&
&                      rmu(1, 0)*temp1586b
                    rmub(1, 0) = rmub(1, 0) + rmucos(2, 0)*fun0*&
&                      temp1586b
                    rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*&
&                      temp1586b
                    rmub(2, 0) = rmub(2, 0) + temp1586*rmucos(1, 0)*&
&                      temp1587b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1586*rmu(2, 0)*&
&                      temp1587b0
                    rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*&
&                      temp1586b0
                    rmusinb(3, 0) = rmusinb(3, 0) - 2*rmusin(3, 0)*&
&                      temp1586b0
                    hess4fb(2) = 0.0_8
                    temp1586b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1586b1 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1586b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1585 = rmu(3, 0)*rmucos(1, 0)
                    temp1584 = rmu(1, 0)*rmu(2, 0)
                    temp1584b = cost3g*24*der4fb(2)
                    temp1584b0 = rmucos(2, 0)*rmucos(3, 0)*temp1584b
                    temp1584b1 = temp1584*temp1585*temp1584b
                    rmub(1, 0) = rmub(1, 0) + temp1585*rmu(2, 0)*&
&                      temp1584b0
                    rmub(2, 0) = rmub(2, 0) + temp1585*rmu(1, 0)*&
&                      temp1584b0
                    rmub(3, 0) = rmub(3, 0) + temp1584*rmucos(1, 0)*&
&                      temp1584b0
                    rmucosb(1, 0) = rmucosb(1, 0) + temp1584*rmu(3, 0)*&
&                      temp1584b0
                    rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                      temp1584b1
                    rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                      temp1584b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 21) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1594 = 3*rmucos(1, 0)**2 - 5*rmusin(1, 0)**2
                  temp1591 = rmusin(1, 0)/cellscale(1)
                  temp1593 = rmucos(1, 0)*rmucos(3, 0)
                  temp1592 = fun0*rmu(3, 0)
                  temp1592b = cost4g*2*hess4fb(2)
                  temp1592b0 = (pi*6*(rmu(2, 0)**2*temp1591)+rmu(1, 0)*&
&                    temp1594)*temp1592b
                  temp1592b1 = temp1592*temp1593*temp1592b
                  temp1592b2 = pi*6*temp1592b1
                  temp1591b = rmu(2, 0)**2*temp1592b2/cellscale(1)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1593*rmu(3, 0&
&                    )*temp1592b0
                  rmub(3, 0) = rmub(3, 0) + temp1593*fun0*temp1592b0
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*3*2*rmucos(1&
&                    , 0)*temp1592b1 + temp1592*rmucos(3, 0)*temp1592b0
                  hess4fb(2) = 0.0_8
                  temp1591b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1591b0 + fun0*der4fb(2)
                  temp1588 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                  temp1590 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                  temp1589 = rmu(1, 0)**2
                  temp1589b = cost4g*(temp1589*temp1590+3*(rmu(2, 0)**2*&
&                    temp1588))*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1589b + &
&                    temp1592*rmucos(1, 0)*temp1592b0
                  rmub(2, 0) = rmub(2, 0) + temp1591*2*rmu(2, 0)*&
&                    temp1592b2
                  temp1589b0 = cost4g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                  temp1588b = 3*rmu(2, 0)**2*temp1589b0
                  rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*&
&                    temp1588b - temp1589*2*rmusin(1, 0)*temp1589b0 - rmu&
&                    (1, 0)*5*2*rmusin(1, 0)*temp1592b1 + temp1591b
                  cellscaleb(1) = cellscaleb(1) - temp1591*temp1591b
                  rmub(1, 0) = rmub(1, 0) + temp1594*temp1592b1
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1591b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1589b
                  rmub(1, 0) = rmub(1, 0) + temp1590*2*rmu(1, 0)*&
&                    temp1589b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1589*3*2*rmucos(1&
&                    , 0)*temp1589b0 - 2*rmucos(1, 0)*temp1588b
                  rmub(2, 0) = rmub(2, 0) + 3*temp1588*2*rmu(2, 0)*&
&                    temp1589b0
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1598 = rmu(3, 0)*rmucos(1, 0)
                  temp1597 = fun0*rmu(1, 0)*rmucos(3, 0)
                  temp1598b = cost4g*6*hess4fb(2)
                  temp1598b0 = (rmusin(2, 0)**2-rmucos(2, 0)**2)*&
&                    temp1598b
                  temp1597b = temp1598*temp1598b0
                  temp1597b0 = temp1597*temp1598*temp1598b
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(&
&                    1, 0)*temp1597b
                  rmub(1, 0) = rmub(1, 0) + rmucos(3, 0)*fun0*temp1597b
                  rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                    temp1597b
                  rmub(3, 0) = rmub(3, 0) + temp1597*rmucos(1, 0)*&
&                    temp1598b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1597*rmu(3, 0)*&
&                    temp1598b0
                  rmusinb(2, 0) = rmusinb(2, 0) + 2*rmusin(2, 0)*&
&                    temp1597b0
                  rmucosb(2, 0) = rmucosb(2, 0) - 2*rmucos(2, 0)*&
&                    temp1597b0
                  hess4fb(2) = 0.0_8
                  temp1597b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1597b1 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1597b1
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1596 = rmu(3, 0)*rmucos(1, 0)
                  temp1595 = rmu(1, 0)*rmu(2, 0)
                  temp1595b = -(cost4g*6*der4fb(2))
                  temp1595b0 = rmucos(2, 0)*rmucos(3, 0)*temp1595b
                  temp1595b1 = temp1595*temp1596*temp1595b
                  rmub(1, 0) = rmub(1, 0) + temp1596*rmu(2, 0)*&
&                    temp1595b0
                  rmub(2, 0) = rmub(2, 0) + temp1596*rmu(1, 0)*&
&                    temp1595b0
                  rmub(3, 0) = rmub(3, 0) + temp1595*rmucos(1, 0)*&
&                    temp1595b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1595*rmu(3, 0)*&
&                    temp1595b0
                  rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*&
&                    temp1595b1
                  rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*&
&                    temp1595b1
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 24) THEN
                IF (.NOT.branch .LT. 23) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1601 = fun0/cellscale(3)
                  temp1604 = rmu(1, 0)*rmucos(1, 0)
                  temp1603 = rmucos(3, 0)*rmusin(3, 0)
                  temp1602 = rmu(1, 0)**2 - 3*rmu(2, 0)**2
                  temp1602b = -(cost4g*4*pi*hess4fb(2))
                  temp1602b0 = temp1604*temp1601*temp1602b
                  temp1602b1 = temp1602*temp1603*temp1602b
                  temp1601b = temp1604*temp1602b1/cellscale(3)
                  rmub(1, 0) = rmub(1, 0) + temp1601*rmucos(1, 0)*&
&                    temp1602b1 + temp1603*2*rmu(1, 0)*temp1602b0
                  rmub(2, 0) = rmub(2, 0) - temp1603*3*2*rmu(2, 0)*&
&                    temp1602b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1602*rmusin(3, 0)*&
&                    temp1602b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1601b
                  hess4fb(2) = 0.0_8
                  temp1601b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1601b0 + fun0*der4fb(2)
                  temp1599 = rmu(1, 0)*rmucos(1, 0)
                  temp1599b = cost4g*(rmu(1, 0)**2-3*rmu(2, 0)**2)*&
&                    der4fb(2)
                  rmusinb(3, 0) = rmusinb(3, 0) + temp1602*rmucos(3, 0)*&
&                    temp1602b0 - temp1599*2*rmusin(3, 0)*temp1599b
                  temp1600 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1600*rmu(1, 0)*&
&                    temp1599b + temp1601*rmu(1, 0)*temp1602b1
                  cellscaleb(3) = cellscaleb(3) - temp1601*temp1601b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1601b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1599b0 = cost4g*temp1599*temp1600*der4fb(2)
                  rmub(1, 0) = rmub(1, 0) + temp1600*rmucos(1, 0)*&
&                    temp1599b + 2*rmu(1, 0)*temp1599b0
                  rmub(2, 0) = rmub(2, 0) - 3*2*rmu(2, 0)*temp1599b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1599*2*rmucos(3, 0&
&                    )*temp1599b
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 25) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1608 = rmu(3, 0)*rmucos(2, 0)
                temp1607 = fun0*rmu(2, 0)*rmucos(3, 0)
                temp1608b = cost4g*6*hess4fb(2)
                temp1608b0 = (rmucos(1, 0)**2-rmusin(1, 0)**2)*temp1608b
                temp1607b = temp1608*temp1608b0
                temp1607b0 = temp1607*temp1608*temp1608b
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*rmu(2&
&                  , 0)*temp1607b
                rmub(2, 0) = rmub(2, 0) + rmucos(3, 0)*fun0*temp1607b
                rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*temp1607b
                rmub(3, 0) = rmub(3, 0) + temp1607*rmucos(2, 0)*&
&                  temp1608b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp1607*rmu(3, 0)*&
&                  temp1608b0
                hess4fb(2) = 0.0_8
                temp1607b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1607b1 + fun0*der4fb(2)
                temp1605 = rmu(1, 0)*rmu(2, 0)
                temp1605b = cost4g*6*der4fb(2)
                temp1605b0 = rmucos(2, 0)*rmucos(3, 0)*temp1605b
                rmucosb(1, 0) = rmucosb(1, 0) + temp1605*rmu(3, 0)*&
&                  temp1605b0 + 2*rmucos(1, 0)*temp1607b0
                rmusinb(1, 0) = rmusinb(1, 0) - 2*rmusin(1, 0)*&
&                  temp1607b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1607b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1606 = rmu(3, 0)*rmucos(1, 0)
                temp1605b1 = temp1605*temp1606*temp1605b
                rmub(1, 0) = rmub(1, 0) + temp1606*rmu(2, 0)*temp1605b0
                rmub(2, 0) = rmub(2, 0) + temp1606*rmu(1, 0)*temp1605b0
                rmub(3, 0) = rmub(3, 0) + temp1605*rmucos(1, 0)*&
&                  temp1605b0
                rmucosb(2, 0) = rmucosb(2, 0) + rmucos(3, 0)*temp1605b1
                rmucosb(3, 0) = rmucosb(3, 0) + rmucos(2, 0)*temp1605b1
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1615 = 3*rmucos(2, 0)**2 - 5*rmusin(2, 0)**2
                temp1612 = rmusin(2, 0)/cellscale(2)
                temp1614 = rmucos(2, 0)*rmucos(3, 0)
                temp1613 = fun0*rmu(3, 0)
                temp1613b = -(cost4g*2*hess4fb(2))
                temp1613b0 = (pi*6*(rmu(1, 0)**2*temp1612)+rmu(2, 0)*&
&                  temp1615)*temp1613b
                temp1613b1 = temp1613*temp1614*temp1613b
                temp1613b2 = pi*6*temp1613b1
                temp1612b = rmu(1, 0)**2*temp1613b2/cellscale(2)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1614*rmu(3, 0)*&
&                  temp1613b0
                rmub(3, 0) = rmub(3, 0) + temp1614*fun0*temp1613b0
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*3*2*rmucos(2, &
&                  0)*temp1613b1 + temp1613*rmucos(3, 0)*temp1613b0
                hess4fb(2) = 0.0_8
                temp1612b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1612b0 + fun0*der4fb(2)
                temp1611 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                temp1610 = rmu(2, 0)**2
                temp1609 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp1610b = cost4g*(3*(rmu(1, 0)**2*temp1609)+temp1610*&
&                  temp1611)*der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1610b + &
&                  temp1613*rmucos(2, 0)*temp1613b0
                rmub(1, 0) = rmub(1, 0) + temp1612*2*rmu(1, 0)*&
&                  temp1613b2
                temp1610b0 = cost4g*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                temp1609b = 3*rmu(1, 0)**2*temp1610b0
                rmusinb(2, 0) = rmusinb(2, 0) + temp1610*2*rmusin(2, 0)*&
&                  temp1610b0 - 2*rmusin(2, 0)*temp1609b - rmu(2, 0)*5*2*&
&                  rmusin(2, 0)*temp1613b1 + temp1612b
                cellscaleb(2) = cellscaleb(2) - temp1612*temp1612b
                rmub(2, 0) = rmub(2, 0) + temp1615*temp1613b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1612b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1610b
                rmub(1, 0) = rmub(1, 0) + 3*temp1609*2*rmu(1, 0)*&
&                  temp1610b0
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*temp1609b&
&                  - temp1610*3*2*rmucos(2, 0)*temp1610b0
                rmub(2, 0) = rmub(2, 0) + temp1611*2*rmu(2, 0)*&
&                  temp1610b0
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 30) THEN
              IF (branch .LT. 28) THEN
                IF (.NOT.branch .LT. 27) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1618 = fun0/cellscale(3)
                  temp1621 = rmu(2, 0)*rmucos(2, 0)
                  temp1620 = rmucos(3, 0)*rmusin(3, 0)
                  temp1619 = rmu(2, 0)**2 - 3*rmu(1, 0)**2
                  temp1619b = cost4g*4*pi*hess4fb(2)
                  temp1619b0 = temp1621*temp1618*temp1619b
                  temp1619b1 = temp1619*temp1620*temp1619b
                  temp1618b = temp1621*temp1619b1/cellscale(3)
                  rmub(2, 0) = rmub(2, 0) + temp1618*rmucos(2, 0)*&
&                    temp1619b1 + temp1620*2*rmu(2, 0)*temp1619b0
                  rmub(1, 0) = rmub(1, 0) - temp1620*3*2*rmu(1, 0)*&
&                    temp1619b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1619*rmusin(3, 0)*&
&                    temp1619b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1618b
                  hess4fb(2) = 0.0_8
                  temp1618b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1618b0 + fun0*der4fb(2)
                  temp1616 = rmu(2, 0)*rmucos(2, 0)
                  temp1616b = -(cost4g*(rmu(2, 0)**2-3*rmu(1, 0)**2)*&
&                    der4fb(2))
                  rmusinb(3, 0) = rmusinb(3, 0) + temp1619*rmucos(3, 0)*&
&                    temp1619b0 - temp1616*2*rmusin(3, 0)*temp1616b
                  temp1617 = rmucos(3, 0)**2 - rmusin(3, 0)**2
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1617*rmu(2, 0)*&
&                    temp1616b + temp1618*rmu(2, 0)*temp1619b1
                  cellscaleb(3) = cellscaleb(3) - temp1618*temp1618b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1618b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1616b0 = -(cost4g*temp1616*temp1617*der4fb(2))
                  rmub(2, 0) = rmub(2, 0) + temp1617*rmucos(2, 0)*&
&                    temp1616b + 2*rmu(2, 0)*temp1616b0
                  rmub(1, 0) = rmub(1, 0) - 3*2*rmu(1, 0)*temp1616b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1616*2*rmucos(3, 0&
&                    )*temp1616b
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 29) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1622 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                temp1624 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1623 = rmu(1, 0)**2
                temp1623b = cost5g*4*hess4fb(2)
                temp1623b0 = fun0*temp1623b
                temp1622b = 3*rmu(2, 0)**2*temp1623b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + (temp1623*temp1624+&
&                  3*(rmu(2, 0)**2*temp1622))*temp1623b
                rmub(1, 0) = rmub(1, 0) + temp1624*2*rmu(1, 0)*&
&                  temp1623b0
                hess4fb(2) = 0.0_8
                temp1622b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1622b0 + fun0*der4fb(2)
                temp1622b1 = cost5g*4*der4fb(2)
                temp1622b2 = (rmu(1, 0)**2-3*rmu(2, 0)**2)*temp1622b1
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1622b2 - 2&
&                  *rmucos(1, 0)*temp1622b + temp1623*3*2*rmucos(1, 0)*&
&                  temp1623b0
                rmusinb(1, 0) = rmusinb(1, 0) + 2*rmusin(1, 0)*temp1622b&
&                  - temp1623*2*rmusin(1, 0)*temp1623b0
                rmub(2, 0) = rmub(2, 0) + 3*temp1622*2*rmu(2, 0)*&
&                  temp1623b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1622b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1622b3 = rmu(1, 0)*rmucos(1, 0)*temp1622b1
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1622b2 + 2*&
&                  rmu(1, 0)*temp1622b3
                rmub(2, 0) = rmub(2, 0) - 3*2*rmu(2, 0)*temp1622b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1627 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
                temp1626 = rmu(2, 0)**2
                temp1625 = rmucos(2, 0)**2 - rmusin(2, 0)**2
                temp1626b = -(cost5g*4*hess4fb(2))
                temp1626b0 = fun0*temp1626b
                temp1625b = 3*rmu(1, 0)**2*temp1626b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + (3*(rmu(1, 0)**2*&
&                  temp1625)+temp1626*temp1627)*temp1626b
                rmub(1, 0) = rmub(1, 0) + 3*temp1625*2*rmu(1, 0)*&
&                  temp1626b0
                hess4fb(2) = 0.0_8
                temp1625b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1625b0 + fun0*der4fb(2)
                temp1625b1 = cost5g*4*der4fb(2)
                temp1625b2 = (rmu(2, 0)**2-3*rmu(1, 0)**2)*temp1625b1
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1625b2 - &
&                  temp1626*3*2*rmucos(2, 0)*temp1626b0 + 2*rmucos(2, 0)*&
&                  temp1625b
                rmusinb(2, 0) = rmusinb(2, 0) + temp1626*2*rmusin(2, 0)*&
&                  temp1626b0 - 2*rmusin(2, 0)*temp1625b
                rmub(2, 0) = rmub(2, 0) + temp1627*2*rmu(2, 0)*&
&                  temp1626b0
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1625b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1625b3 = rmu(2, 0)*rmucos(2, 0)*temp1625b1
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1625b2 + 2*&
&                  rmu(2, 0)*temp1625b3
                rmub(1, 0) = rmub(1, 0) - 3*2*rmu(1, 0)*temp1625b3
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 32) THEN
              IF (branch .LT. 31) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1635 = 3*rmucos(1, 0)**2 - 5*rmusin(1, 0)**2
                temp1632 = rmusin(1, 0)/cellscale(1)
                temp1634 = rmucos(1, 0)*rmucos(2, 0)
                temp1633 = fun0*rmu(2, 0)
                temp1633b = cost5g*8*hess4fb(2)
                temp1633b0 = (pi*2*(rmu(2, 0)**2*temp1632)+rmu(1, 0)*&
&                  temp1635)*temp1633b
                temp1633b1 = temp1633*temp1634*temp1633b
                temp1633b2 = pi*2*temp1633b1
                temp1632b = rmu(2, 0)**2*temp1633b2/cellscale(1)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1634*rmu(2, 0)*&
&                  temp1633b0
                rmub(2, 0) = rmub(2, 0) + temp1632*2*rmu(2, 0)*&
&                  temp1633b2 + temp1634*fun0*temp1633b0
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*3*2*rmucos(1, &
&                  0)*temp1633b1 + temp1633*rmucos(2, 0)*temp1633b0
                hess4fb(2) = 0.0_8
                temp1632b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1632b0 + fun0*der4fb(2)
                temp1631 = rmusin(1, 0)**2 - rmucos(1, 0)**2
                temp1630 = rmu(2, 0)**2
                temp1629 = 3*rmucos(1, 0)**2 - rmusin(1, 0)**2
                temp1628 = rmu(1, 0)**2
                temp1628b = cost5g*4*der4fb(2)
                temp1628b0 = (temp1628*temp1629+temp1630*temp1631)*&
&                  temp1628b
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1628b0 + &
&                  temp1633*rmucos(1, 0)*temp1633b0
                temp1628b1 = rmu(2, 0)*rmucos(2, 0)*temp1628b
                rmusinb(1, 0) = rmusinb(1, 0) + (temp1630*2*rmusin(1, 0)&
&                  -temp1628*2*rmusin(1, 0))*temp1628b1 - rmu(1, 0)*5*2*&
&                  rmusin(1, 0)*temp1633b1 + temp1632b
                cellscaleb(1) = cellscaleb(1) - temp1632*temp1632b
                rmub(1, 0) = rmub(1, 0) + temp1635*temp1633b1
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1632b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + temp1631*2*rmu(2, 0)*&
&                  temp1628b1 + rmucos(2, 0)*temp1628b0
                rmub(1, 0) = rmub(1, 0) + temp1629*2*rmu(1, 0)*&
&                  temp1628b1
                rmucosb(1, 0) = rmucosb(1, 0) + (temp1628*3*2*rmucos(1, &
&                  0)-temp1630*2*rmucos(1, 0))*temp1628b1
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 33) THEN
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              temp1643 = 3*rmucos(2, 0)**2 - 5*rmusin(2, 0)**2
              temp1640 = rmusin(2, 0)/cellscale(2)
              temp1642 = rmucos(1, 0)*rmucos(2, 0)
              temp1641 = fun0*rmu(1, 0)
              temp1641b = -(cost5g*8*hess4fb(2))
              temp1641b0 = (pi*2*(rmu(1, 0)**2*temp1640)+rmu(2, 0)*&
&                temp1643)*temp1641b
              temp1641b1 = temp1641*temp1642*temp1641b
              temp1641b2 = pi*2*temp1641b1
              temp1640b = rmu(1, 0)**2*temp1641b2/cellscale(2)
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              fun0b = fun0b + der4f(2)*der4fb(2) + temp1642*rmu(1, 0)*&
&                temp1641b0
              rmub(1, 0) = rmub(1, 0) + temp1640*2*rmu(1, 0)*temp1641b2 &
&                + temp1642*fun0*temp1641b0
              rmucosb(1, 0) = rmucosb(1, 0) + temp1641*rmucos(2, 0)*&
&                temp1641b0
              rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*3*2*rmucos(2, 0)&
&                *temp1641b1 + temp1641*rmucos(1, 0)*temp1641b0
              hess4fb(2) = 0.0_8
              temp1640b0 = 2.d0*rmu(i, 0)*hess4fb(3)
              der4fb(2) = fun*temp1640b0 + fun0*der4fb(2)
              temp1638 = rmu(2, 0)**2
              temp1636 = rmu(1, 0)**2
              temp1636b = cost5g*4*der4fb(2)
              temp1636b0 = rmu(1, 0)*rmucos(1, 0)*temp1636b
              rmusinb(2, 0) = rmusinb(2, 0) + (temp1638*2*rmusin(2, 0)-&
&                temp1636*2*rmusin(2, 0))*temp1636b0 - rmu(2, 0)*5*2*&
&                rmusin(2, 0)*temp1641b1 + temp1640b
              cellscaleb(2) = cellscaleb(2) - temp1640*temp1640b
              rmub(2, 0) = rmub(2, 0) + temp1643*temp1641b1
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
              funb = funb + der4f(2)*temp1640b0
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              temp1639 = rmusin(2, 0)**2 - 3*rmucos(2, 0)**2
              temp1637 = rmucos(2, 0)**2 - rmusin(2, 0)**2
              temp1636b1 = (temp1636*temp1637+temp1638*temp1639)*&
&                temp1636b
              rmub(1, 0) = rmub(1, 0) + temp1637*2*rmu(1, 0)*temp1636b0 &
&                + rmucos(1, 0)*temp1636b1
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1636b1
              rmucosb(2, 0) = rmucosb(2, 0) + (temp1636*2*rmucos(2, 0)-&
&                temp1638*3*2*rmucos(2, 0))*temp1636b0
              rmub(2, 0) = rmub(2, 0) + temp1639*2*rmu(2, 0)*temp1636b0
              der4fb(2) = 0.0_8
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4fb(2) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp1515b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp1515b
            funb = funb + rmu(i, 0)*temp1515b
            der4fb(1) = 0.0_8
          END DO
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp1514 = r(0)**2
        temp1513 = fun2/temp1514
        temp1513b = rmu(i, 0)**2*radhess4fb(i)/temp1514
        temp1512 = r(0)**2
        temp1511 = rmu(i, 0)**2/temp1512
        temp1511b1 = -(fun*radhess4fb(i)/temp1512)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp1511b1 + temp1513*2*&
&          rmu(i, 0)*radhess4fb(i)
        fun2b = fun2b + temp1513b
        rb(0) = rb(0) - temp1511*2*r(0)*temp1511b1 - temp1513*2*r(0)*&
&          temp1513b
        funb = funb + (1.d0-temp1511)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp1511b0 = distp(0, 1)*fun2b
      rb(0) = rb(0) + distp(0, 1)*6.5d0*funb/r(0)**2 - distp(0, 1)*fun0b&
&        - dd1**2*temp1511b0 + 2*r(0)*rp0b
      distpb(0, 1) = distpb(0, 1) + (dd1-6.5d0/r(0))*funb + (5.5d0/dd1-r&
&        (0))*fun0b + (7.5d0*dd1-dd1**2*r(0))*fun2b
      dd1b = dd1b + distp(0, 1)*funb - distp(0, 1)*5.5d0*fun0b/dd1**2 + &
&        (7.5d0-r(0)*2*dd1)*temp1511b0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=9,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp1511b = (5.5d0/dd1-r(k))*zb(indorbp, k)
          temp1510 = distp(k, 1+ic)
          temp1509 = distp(k, 1)*cosphase(k)
          temp1509b = temp1509*temp1510*zb(indorbp, k)
          distpb(k, 1) = distpb(k, 1) + temp1510*cosphase(k)*temp1511b
          cosphaseb(k) = cosphaseb(k) + temp1510*distp(k, 1)*temp1511b
          distpb(k, 1+ic) = distpb(k, 1+ic) + temp1509*temp1511b
          dd1b = dd1b - 5.5d0*temp1509b/dd1**2
          rb(k) = rb(k) - temp1509b
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp1508 = rmu(2, i)*rmucos(2, i)
      temp1507 = rmu(1, i)*rmucos(1, i)
      temp1507b = cost5g*4.d0*distpb(i, 10)
      temp1507b0 = (rmu(1, i)**2-rmu(2, i)**2)*temp1507b
      temp1507b1 = temp1507*temp1508*temp1507b
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp1507b1 + temp1508*rmucos&
&        (1, i)*temp1507b0
      rmucosb(1, i) = rmucosb(1, i) + temp1508*rmu(1, i)*temp1507b0
      rmub(2, i) = rmub(2, i) + temp1507*rmucos(2, i)*temp1507b0 - 2*rmu&
&        (2, i)*temp1507b1
      distpb(i, 10) = 0.0_8
      temp1507b2 = cost5g*distpb(i, 9)
      distpb(i, 9) = 0.0_8
      temp1506 = rmu(3, i)*rmucos(3, i)
      temp1505b = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      rmucosb(2, i) = rmucosb(2, i) + temp1506*rmu(2, i)*temp1505b + &
&        temp1507*rmu(2, i)*temp1507b0
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp1507b2
      temp1505 = rmu(2, i)*rmucos(2, i)
      temp1505b0 = cost4g*temp1505*temp1506*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + temp1506*rmucos(2, i)*temp1505b - 2*rmu(&
&        2, i)*temp1505b0 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i)&
&        )*temp1507b2
      rmub(3, i) = rmub(3, i) + temp1505*rmucos(3, i)*temp1505b
      rmucosb(3, i) = rmucosb(3, i) + temp1505*rmu(3, i)*temp1505b
      distpb(i, 8) = 0.0_8
      temp1504 = rmu(3, i)*rmucos(3, i)
      temp1503 = rmu(1, i)*rmucos(1, i)
      temp1503b = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp1503b0 = cost4g*temp1503*temp1504*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + temp1504*rmucos(1, i)*temp1503b + 2*rmu(&
&        1, i)*temp1503b0 + 3.d0*2*rmu(1, i)*temp1505b0
      rmucosb(1, i) = rmucosb(1, i) + temp1504*rmu(1, i)*temp1503b
      rmub(3, i) = rmub(3, i) + temp1503*rmucos(3, i)*temp1503b
      rmucosb(3, i) = rmucosb(3, i) + temp1503*rmu(3, i)*temp1503b
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp1503b0
      distpb(i, 7) = 0.0_8
      temp1502 = rmu(2, i)*rmucos(2, i)
      temp1501 = rmu(1, i)*rmucos(1, i)
      temp1501b = cost3g*2.d0*distpb(i, 6)
      temp1501b0 = (7.d0*rmu(3, i)**2-rp0)*temp1501b
      temp1501b1 = temp1501*temp1502*temp1501b
      rmub(1, i) = rmub(1, i) + temp1502*rmucos(1, i)*temp1501b0
      rmucosb(1, i) = rmucosb(1, i) + temp1502*rmu(1, i)*temp1501b0
      rmub(2, i) = rmub(2, i) + temp1501*rmucos(2, i)*temp1501b0
      distpb(i, 6) = 0.0_8
      temp1501b2 = cost3g*(7.d0*rmu(3, i)**2-rp0)*distpb(i, 5)
      temp1501b3 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp1500 = rmu(3, i)*rmucos(3, i)
      temp1499b = cost2g*(7.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 4)
      rmucosb(2, i) = rmucosb(2, i) + temp1500*rmu(2, i)*temp1499b + &
&        temp1501*rmu(2, i)*temp1501b0
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1501b1
      temp1499 = rmu(2, i)*rmucos(2, i)
      temp1499b0 = cost2g*temp1499*temp1500*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp1498 = rmu(3, i)*rmucos(3, i)
      temp1497 = rmu(1, i)*rmucos(1, i)
      temp1497b5 = cost2g*(7.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 3)
      temp1497b6 = cost2g*temp1497*temp1498*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp1497b7 = cost1g*distpb(i, 2)
      rp0b = (3.d0*2*rp0-30.d0*rmu(3, i)**2)*temp1497b7 - 3.d0*&
&        temp1497b6 - temp1501b3 - 3.d0*temp1499b0 - temp1501b1
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp1501b2
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp1501b2
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1501b3
      rmub(2, i) = rmub(2, i) + temp1500*rmucos(2, i)*temp1499b
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp1499b0 + temp1499*&
&        rmucos(3, i)*temp1499b
      rmucosb(3, i) = rmucosb(3, i) + temp1499*rmu(3, i)*temp1499b
      rmub(1, i) = rmub(1, i) + temp1498*rmucos(1, i)*temp1497b5
      rmucosb(1, i) = rmucosb(1, i) + temp1498*rmu(1, i)*temp1497b5
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*rp0*2*rmu(3&
&        , i))*temp1497b7 + 7.d0*2*rmu(3, i)*temp1497b6 + temp1497*rmucos&
&        (3, i)*temp1497b5
      rmucosb(3, i) = rmucosb(3, i) + temp1497*rmu(3, i)*temp1497b5
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    cb = 0.0_8
    DO k=0,0,-1
      temp1497b4 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp1497b4
      rb(k) = rb(k) - dd1*temp1497b4
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .020104801169736915d0*5.5d0*dd1**4.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (100)
! ******************* END GAUSSIAN BASIS ************************
! ** ** ** ** ** ** **  JASTROW ORBITALS ** ** ** ** ** ** ** ** *
!     2s single gaussian
!     exp(-dd2*r^2)
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    indshellp = indshell + 1
    DO k=0,0
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)*2.d0)
      fun3 = dd2**2*4.d0*distp(0, 1)
!********** DIAGONAL PART HESSIAN ******************
!       hess(:)=fun3*rmu(:,0)**2*rmucos(:,0)**2
!    1+fun*(rmucos(:,0)**2-PI*rmu(:,0)*rmusin(:,0))
      hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(1.d0-2.d0*&
&        rmusin(:, 0)**2)
!                z_xyz(indorbp,:)=hess(:)
!endif for indt
      hessb = 0.0_8
      hessb(:) = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.D0
      temp1653b1 = rmucos(:, 0)**2*hessb(:)
      fun3b = SUM(rmu(:, 0)**2*temp1653b1)
      rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1653b1
      rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*rmu(:, 0)**2*&
&        hessb(:)
      funb = SUM((1.d0-2.d0*rmusin(:, 0)**2)*hessb(:))
      rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*hessb(:)
      DO i=3,1,-1
        temp1653b0 = rmucos(i, 0)*zb(indorbp, indt+i)
        funb = funb + rmu(i, 0)*temp1653b0
        rmub(i, 0) = rmub(i, 0) + fun*temp1653b0
        rmucosb(i, 0) = rmucosb(i, 0) + fun*rmu(i, 0)*zb(indorbp, indt+i&
&          )
        zb(indorbp, indt+i) = 0.D0
      END DO
      distpb = 0.0_8
      dd2b = 4.d0*distp(0, 1)*2*dd2*fun3b - 2.d0*distp(0, 1)*funb
      distpb(0, 1) = 4.d0*dd2**2*fun3b - 2.d0*dd2*funb
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    DO k=0,0,-1
      temp1653b = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp1653b
      rb(k) = rb(k) - dd2*2*r(k)*temp1653b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (145)
!     2s without cusp condition  !derivative 100
!     -(r^2*exp(-dd2*r^2))
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    indshellp = indshell + 1
    DO k=0,0
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) THEN
      fun0 = dd2*r(0)**2
      fun = -(2.d0*distp(0, 1)*(1.d0-fun0))
      fun3 = dd2*4.d0*distp(0, 1)*(1.d0-fun0) + 4.d0*distp(0, 1)*dd2
!********** DIAGONAL PART HESSIAN ******************
!       hess(:)=fun3*rmu(:,0)**2*rmucos(:,0)**2
!    1+fun*(rmucos(:,0)**2-PI*rmu(:,0)*rmusin(:,0))
      hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(rmucos(:, 0)**2&
&        -pi*rmu(:, 0)*rmusin(:, 0)/cellscale(1:3))
!                z_xyz(indorbp,:)=hess(:)
!endif for indt
      hessb = 0.0_8
      hessb(:) = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.D0
      temp1654b = rmucos(:, 0)**2*hessb(:)
      temp1653 = rmu(:, 0)/cellscale(1:3)
      temp1654b0 = fun*hessb(:)
      temp1653b5 = -(rmusin(:, 0)*pi*temp1654b0/cellscale(1:3))
      fun3b = SUM(rmu(:, 0)**2*temp1654b)
      rmub(:, 0) = rmub(:, 0) + temp1653b5 + 2*rmu(:, 0)*fun3*temp1654b
      rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*temp1654b0 + 2*&
&        rmucos(:, 0)*fun3*rmu(:, 0)**2*hessb(:)
      funb = SUM((rmucos(:, 0)**2-pi*(temp1653*rmusin(:, 0)))*hessb(:))
      cellscaleb(1:3) = cellscaleb(1:3) - temp1653*temp1653b5
      rmusinb(:, 0) = rmusinb(:, 0) - temp1653*pi*temp1654b0
      DO i=3,1,-1
        temp1653b4 = rmucos(i, 0)*zb(indorbp, indt+i)
        funb = funb + rmu(i, 0)*temp1653b4
        rmub(i, 0) = rmub(i, 0) + fun*temp1653b4
        rmucosb(i, 0) = rmucosb(i, 0) + fun*rmu(i, 0)*zb(indorbp, indt+i&
&          )
        zb(indorbp, indt+i) = 0.D0
      END DO
      distpb = 0.0_8
      temp1653b3 = 4.d0*distp(0, 1)*fun3b
      distpb(0, 1) = (4.d0*dd2+4.d0*dd2*(1.d0-fun0))*fun3b - 2.d0*(1.d0-&
&        fun0)*funb
      fun0b = 2.d0*distp(0, 1)*funb - dd2*temp1653b3
      dd2b = r(0)**2*fun0b + 4.d0*distp(0, 1)*fun3b + (1.d0-fun0)*&
&        temp1653b3
      rb(0) = rb(0) + dd2*2*r(0)*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) - r(i)**2*zb(indorbp, i)
        rb(i) = rb(i) - distp(i, 1)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    DO k=0,0,-1
      temp1653b2 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp1653b2
      rb(k) = rb(k) - dd2*2*r(k)*temp1653b2
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (10)
!     2s with cusp condition
!     ( r^2*exp(-dd2*r))  ! with no cusp condition
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    indshellp = indshell + 1
    DO k=0,0
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd2*r(0))*distp(0, 1)
      fun3 = -(dd2*distp(0, 1)/r(0)*(3.d0-dd2*r(0)))
!********** DIAGONAL PART HESSIAN ******************
      hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(1.d0-2.d0*&
&        rmusin(:, 0)**2)
!                z_xyz(indorbp,:)=hess(:)
!endif for indt
      hessb = 0.0_8
      hessb(:) = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.D0
      temp1655b2 = rmucos(:, 0)**2*hessb(:)
      fun3b = SUM(rmu(:, 0)**2*temp1655b2)
      rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1655b2
      rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*rmu(:, 0)**2*&
&        hessb(:)
      funb = SUM((1.d0-2.d0*rmusin(:, 0)**2)*hessb(:))
      rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*hessb(:)
      DO i=3,1,-1
        temp1655b1 = rmucos(i, 0)*zb(indorbp, indt+i)
        funb = funb + rmu(i, 0)*temp1655b1
        rmub(i, 0) = rmub(i, 0) + fun*temp1655b1
        rmucosb(i, 0) = rmucosb(i, 0) + fun*rmu(i, 0)*zb(indorbp, indt+i&
&          )
        zb(indorbp, indt+i) = 0.D0
      END DO
      distpb = 0.0_8
      temp1654 = dd2/r(0)
      temp1655b = -(distp(0, 1)*temp1654*fun3b)
      temp1655b0 = -((3.d0-dd2*r(0))*fun3b)
      temp1654b2 = distp(0, 1)*temp1655b0/r(0)
      dd2b = temp1654b2 - distp(0, 1)*r(0)*funb - r(0)*temp1655b
      rb(0) = rb(0) - distp(0, 1)*dd2*funb - temp1654*temp1654b2 - dd2*&
&        temp1655b
      distpb(0, 1) = (2.d0-dd2*r(0))*funb + temp1654*temp1655b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
        rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    DO k=0,0,-1
      temp1654b1 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp1654b1
      rb(k) = rb(k) - dd2*temp1654b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (131)
!     2s without cusp condition
!     dd1*(r^2*exp(-dd2*r^2))
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    indshellp = indshell + 1
    DO k=0,0
      distp(k, 1) = DEXP(-(dd2*r(k)**2))
    END DO
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) THEN
      fun = 2.d0*distp(0, 1)*(1.d0-dd2*r(0)**2)
      fun3 = -(dd2*distp(0, 1)*4.d0*(2.d0-dd2*r(0)**2))
!********** DIAGONAL PART HESSIAN ******************
      hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(1.d0-2.d0*&
&        rmusin(:, 0)**2)
!                z_xyz(indorbp,:)=hess(:)
!endif for indt
      hessb = 0.0_8
      hessb(:) = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.D0
      temp1655b8 = rmucos(:, 0)**2*hessb(:)
      fun3b = SUM(rmu(:, 0)**2*temp1655b8)
      rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1655b8
      rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*rmu(:, 0)**2*&
&        hessb(:)
      funb = SUM((1.d0-2.d0*rmusin(:, 0)**2)*hessb(:))
      rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*hessb(:)
      DO i=3,1,-1
        temp1655b7 = rmucos(i, 0)*zb(indorbp, indt+i)
        funb = funb + rmu(i, 0)*temp1655b7
        rmub(i, 0) = rmub(i, 0) + fun*temp1655b7
        rmucosb(i, 0) = rmucosb(i, 0) + fun*rmu(i, 0)*zb(indorbp, indt+i&
&          )
        zb(indorbp, indt+i) = 0.D0
      END DO
      distpb = 0.0_8
      temp1655b4 = -(4.d0*(2.d0-dd2*r(0)**2)*fun3b)
      temp1655b5 = -(4.d0*dd2*distp(0, 1)*fun3b)
      temp1655b6 = 2.d0*distp(0, 1)*funb
      dd2b = distp(0, 1)*temp1655b4 - r(0)**2*temp1655b5 - r(0)**2*&
&        temp1655b6
      distpb(0, 1) = 2.d0*(1.d0-dd2*r(0)**2)*funb + dd2*temp1655b4
      rb(0) = rb(0) - dd2*2*r(0)*temp1655b6 - dd2*2*r(0)*temp1655b5
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
        rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    DO k=0,0,-1
      temp1655b3 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp1655b3
      rb(k) = rb(k) - dd2*2*r(k)*temp1655b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (149)
! derivative of 131 with respect z_1
! - r^4 exp(-z_1 r^2)
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
      DO k=0,0
        distp(k, 1) = DEXP(-(dd1*r(k)**2))
      END DO
      IF (typec .NE. 1) THEN
        fun = -(2.d0*distp(0, 1)*r(0)**2*(2.d0-dd1*r(0)**2))
        fun3 = -(distp(0, 1)*4.d0*(2.d0-2.d0*dd1*r(0)**2-(2.d0-dd1*r(0)&
&          **2)*r(0)**2*dd1))
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2)
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp1657b0 = rmucos(:, 0)**2*hessb(:)
        fun3b = SUM(rmu(:, 0)**2*temp1657b0)
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1657b0
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*rmu(:, 0)**2&
&          *hessb(:)
        funb = SUM((1.d0-2.d0*rmusin(:, 0)**2)*hessb(:))
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*hessb(:)
        DO i=3,1,-1
          temp1657b = rmucos(i, 0)*zb(indorbp, indt+i)
          funb = funb + rmu(i, 0)*temp1657b
          rmub(i, 0) = rmub(i, 0) + fun*temp1657b
          rmucosb(i, 0) = rmucosb(i, 0) + fun*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          zb(indorbp, indt+i) = 0.D0
        END DO
        distpb = 0.0_8
        temp1656 = r(0)**2*dd1
        temp1655 = -(dd1*r(0)**2) + 2.d0
        temp1655b10 = -(4.d0*distp(0, 1)*fun3b)
        temp1655b11 = -(2.d0*(2.d0-dd1*r(0)**2)*funb)
        distpb(0, 1) = r(0)**2*temp1655b11 - 4.d0*(2.d0-temp1655*&
&          temp1656-2.d0*(dd1*r(0)**2))*fun3b
        temp1655b12 = -(2.d0*distp(0, 1)*r(0)**2*funb)
        dd1b = (temp1656*r(0)**2-temp1655*r(0)**2-2.d0*r(0)**2)*&
&          temp1655b10 - r(0)**2*temp1655b12
        rb(0) = rb(0) + distp(0, 1)*2*r(0)*temp1655b11 - dd1*2*r(0)*&
&          temp1655b12 + (temp1656*dd1*2*r(0)-temp1655*dd1*2*r(0)-2.d0*&
&          dd1*2*r(0))*temp1655b10
      ELSE
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=0,0,-1
        rb(i) = rb(i) - distp(i, 1)*4*r(i)**3*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) - r(i)**4*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
      DO k=0,0,-1
        temp1655b9 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
        dd1b = dd1b - r(k)**2*temp1655b9
        rb(k) = rb(k) - dd1*2*r(k)*temp1655b9
        distpb(k, 1) = 0.0_8
      END DO
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (137)
!     2s with cusp condition
!     dd1*(exp(-dd2*r)*(1+dd2*r))
    dd2 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!           c=1.d0/dsqrt(1/4.d0/dd2**3+12*dd2/(2.d0*dd2)**4+
!    &3*dd2**2/4/dd2**5)/dsqrt(4.0*pi)
!           endif
    indorbp = indorb + 1
    indshellp = indshell + 1
    DO k=0,0
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) THEN
      fun = -(dd2**2*distp(0, 1))
      fun3 = dd2**3*distp(0, 1)/r(0)
!********** DIAGONAL PART HESSIAN ******************
      hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(1.d0-2.d0*&
&        rmusin(:, 0)**2)
!                z_xyz(indorbp,:)=hess(:)
!endif for indt
      hessb = 0.0_8
      hessb(:) = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.D0
      temp1658b0 = rmucos(:, 0)**2*hessb(:)
      fun3b = SUM(rmu(:, 0)**2*temp1658b0)
      rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1658b0
      rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*rmu(:, 0)**2*&
&        hessb(:)
      funb = SUM((1.d0-2.d0*rmusin(:, 0)**2)*hessb(:))
      rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*hessb(:)
      DO i=3,1,-1
        temp1658b = rmucos(i, 0)*zb(indorbp, indt+i)
        funb = funb + rmu(i, 0)*temp1658b
        rmub(i, 0) = rmub(i, 0) + fun*temp1658b
        rmucosb(i, 0) = rmucosb(i, 0) + fun*rmu(i, 0)*zb(indorbp, indt+i&
&          )
        zb(indorbp, indt+i) = 0.D0
      END DO
      distpb = 0.0_8
      temp1657 = distp(0, 1)/r(0)
      temp1657b3 = dd2**3*fun3b/r(0)
      dd2b = temp1657*3*dd2**2*fun3b - distp(0, 1)*2*dd2*funb
      distpb(0, 1) = temp1657b3 - dd2**2*funb
      rb(0) = rb(0) - temp1657*temp1657b3
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        temp1657b2 = distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + (dd2*r(i)+1.d0)*zb(indorbp, i)
        dd2b = dd2b + r(i)*temp1657b2
        rb(i) = rb(i) + dd2*temp1657b2
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    DO k=0,0,-1
      temp1657b1 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp1657b1
      rb(k) = rb(k) - dd2*temp1657b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (138)
!     2s with cusp condition
!     ( -dd2*r^2*exp(-dd2*r))  ! with no cusp condition der of 137
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    indshellp = indshell + 1
    DO k=0,0
      distp(k, 1) = -(dd2*DEXP(-(dd2*r(k))))
    END DO
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd2*r(0))*distp(0, 1)
      fun3 = -(dd2*distp(0, 1)/r(0)) - dd2*(2.d0-dd2*r(0))*distp(0, 1)/r&
&        (0)
!********** DIAGONAL PART HESSIAN ******************
      hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(1.d0-2.d0*&
&        rmusin(:, 0)**2)
!                z_xyz(indorbp,:)=hess(:)
!endif for indt
      hessb = 0.0_8
      hessb(:) = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.D0
      temp1660b0 = rmucos(:, 0)**2*hessb(:)
      fun3b = SUM(rmu(:, 0)**2*temp1660b0)
      rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1660b0
      rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*rmu(:, 0)**2*&
&        hessb(:)
      funb = SUM((1.d0-2.d0*rmusin(:, 0)**2)*hessb(:))
      rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*hessb(:)
      DO i=3,1,-1
        temp1660b = rmucos(i, 0)*zb(indorbp, indt+i)
        funb = funb + rmu(i, 0)*temp1660b
        rmub(i, 0) = rmub(i, 0) + fun*temp1660b
        rmucosb(i, 0) = rmucosb(i, 0) + fun*rmu(i, 0)*zb(indorbp, indt+i&
&          )
        zb(indorbp, indt+i) = 0.D0
      END DO
      distpb = 0.0_8
      temp1659 = dd2/r(0)
      temp1659b = -(distp(0, 1)*fun3b/r(0))
      temp1658 = dd2/r(0)
      temp1659b0 = -(distp(0, 1)*temp1658*fun3b)
      temp1659b1 = -((2.d0-dd2*r(0))*fun3b)
      temp1658b2 = distp(0, 1)*temp1659b1/r(0)
      distpb(0, 1) = (2.d0-dd2*r(0))*funb + temp1658*temp1659b1 - &
&        temp1659*fun3b
      dd2b = temp1658b2 - distp(0, 1)*r(0)*funb - r(0)*temp1659b0 + &
&        temp1659b
      rb(0) = rb(0) - distp(0, 1)*dd2*funb - temp1658*temp1658b2 - dd2*&
&        temp1659b0 - temp1659*temp1659b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
        rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    DO k=0,0,-1
      temp1658b1 = -(dd2*DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp1658b1 - DEXP(-(dd2*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp1658b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (103)
! single gaussian p orbital periodic
    dd1 = dd(indpar+1)
    DO k=0,0
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    indorbp = indorb
!
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      fun = -(2.d0*dd1*distp(0, 1))
      fun3 = 4.d0*dd1**2*distp(0, 1)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(1.d0-2.d0*rmusin(:, 0)**2))
          hess(ic) = hess(ic) + fun*(1.d0-2.d0*rmusin(ic, 0)**2)*rmu(ic&
&            , 0)*rmucos(ic, 0) + fun*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic&
&            , 0)*rmucos(ic, 0) - distp(0, 1)*4.d0*rmusin(ic, 0)*rmucos(&
&            ic, 0)*pi/cellscale(ic)
!                z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp1665 = fun*rmu(ic, 0)
          temp1666b = (1.d0-2.d0*rmusin(ic, 0)**2)*hessb(ic)
          temp1665b = rmucos(ic, 0)*temp1666b
          temp1664 = fun*rmu(ic, 0)
          temp1665b0 = (2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic)
          temp1664b = rmucos(ic, 0)*temp1665b0
          temp1663 = distp(0, 1)/cellscale(ic)
          temp1664b0 = -(pi*4.d0*hessb(ic))
          temp1664b1 = temp1663*temp1664b0
          temp1663b = rmusin(ic, 0)*rmucos(ic, 0)*temp1664b0/cellscale(&
&            ic)
          rmusinb(ic, 0) = rmusinb(ic, 0) + rmucos(ic, 0)*temp1664b1 - &
&            temp1665*rmucos(ic, 0)*2.d0*2*rmusin(ic, 0)*hessb(ic)
          temp1662 = -(2.d0*rmusin(:, 0)**2) + 1.d0
          temp1661 = rmucos(:, 0)**2
          temp1660 = rmu(:, 0)**2
          temp1660b3 = (fun3*temp1660*temp1661+fun*temp1662)*hessb(:)
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(ic, 0)*SUM(temp1660b3) +&
&            rmusin(ic, 0)*temp1664b1 + temp1664*temp1665b0 + 2.d0*&
&            temp1664*rmucos(ic, 0)**2*2*hessb(ic) + temp1665*temp1666b
          distpb(0, 1) = distpb(0, 1) + (2.d0*rmucos(ic, 0)**2-1.d0)*zb(&
&            indorbp, indt+ic) + temp1663b
          temp1660b4 = rmu(ic, 0)*rmucos(ic, 0)*hessb(:)
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp1660*&
&            temp1660b4
          temp1660b5 = rmucos(3, 0)*rmu(ic, 0)*zb(indorbp, indt+3)
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(3, 0)*fun*temp1660b5 + &
&            distp(0, 1)*2.d0*2*rmucos(ic, 0)*zb(indorbp, indt+ic)
          temp1660b6 = rmucos(ic, 0)*temp1660b5
          temp1660b7 = rmu(3, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+3)
          zb(indorbp, indt+3) = 0.D0
          temp1660b8 = rmucos(2, 0)*rmu(ic, 0)*zb(indorbp, indt+2)
          temp1660b9 = rmucos(ic, 0)*temp1660b8
          temp1660b10 = rmu(2, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+2)
          zb(indorbp, indt+2) = 0.D0
          temp1660b11 = rmucos(1, 0)*rmu(ic, 0)*zb(indorbp, indt+1)
          temp1660b12 = rmucos(ic, 0)*temp1660b11
          funb = funb + SUM(temp1662*temp1660b4) + rmu(2, 0)*temp1660b9 &
&            + rmu(1, 0)*temp1660b12 + rmu(3, 0)*temp1660b6 + rmu(ic, 0)*&
&            temp1664b + rmu(ic, 0)*temp1665b
          rmub(ic, 0) = rmub(ic, 0) + rmucos(ic, 0)*SUM(temp1660b3) + &
&            fun*temp1664b + fun*temp1665b
          cellscaleb(ic) = cellscaleb(ic) - temp1663*temp1663b
          fun3b = fun3b + SUM(temp1660*temp1661*temp1660b4)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1661*temp1660b4
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&            temp1660b4
          rmub(3, 0) = rmub(3, 0) + fun*temp1660b6
          rmucosb(3, 0) = rmucosb(3, 0) + rmu(ic, 0)*temp1660b7
          rmub(ic, 0) = rmub(ic, 0) + rmucos(3, 0)*temp1660b7
          rmub(2, 0) = rmub(2, 0) + fun*temp1660b9
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(2, 0)*fun*temp1660b8
          rmucosb(2, 0) = rmucosb(2, 0) + rmu(ic, 0)*temp1660b10
          rmub(ic, 0) = rmub(ic, 0) + rmucos(2, 0)*temp1660b10
          temp1660b13 = rmu(1, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+1)
          rmub(1, 0) = rmub(1, 0) + fun*temp1660b12
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(1, 0)*fun*temp1660b11
          rmucosb(1, 0) = rmucosb(1, 0) + rmu(ic, 0)*temp1660b13
          rmub(ic, 0) = rmub(ic, 0) + rmucos(1, 0)*temp1660b13
          zb(indorbp, indt+1) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      dd1b = 4.d0*distp(0, 1)*2*dd1*fun3b - 2.d0*distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) + 4.d0*dd1**2*fun3b - 2.d0*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          temp1660b2 = rmucos(ic, i)*zb(indorbp, i)
          distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp1660b2
          rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp1660b2
          rmucosb(ic, i) = rmucosb(ic, i) + distp(i, 1)*rmu(ic, i)*zb(&
&            indorbp, i)
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO k=0,0,-1
      temp1660b1 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp1660b1
      rb(k) = rb(k) - dd1*2*r(k)*temp1660b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (146)
! derivative of 103 unnormalized
! R(r)=x*exp(-z*r**2)*(5/4/z-r**2)
    dd1 = dd(indpar+1)
    DO k=0,0
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    indorbp = indorb
!
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-2.d0)
      fun0 = -(distp(0, 1)*r(0)**2)
      fun3 = dd1*distp(0, 1)*(-(4.d0*r(0)**2*dd1)+8.d0)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(rmucos(:, 0)**2-rmusin(:, 0)**2))
          hess(ic) = hess(ic) + 2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic&
&            , 0)*rmucos(ic, 0)*fun - 4.d0*fun0*rmucos(ic, 0)*rmusin(ic, &
&            0)*pi/cellscale(ic)
!                z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp1670 = rmu(ic, 0)*fun
          temp1671b = 2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic)
          temp1670b = rmucos(ic, 0)*temp1671b
          temp1669 = fun0/cellscale(ic)
          temp1670b0 = -(pi*4.d0*hessb(ic))
          temp1670b1 = temp1669*temp1670b0
          temp1669b = rmucos(ic, 0)*rmusin(ic, 0)*temp1670b0/cellscale(&
&            ic)
          temp1668 = rmucos(:, 0)**2 - rmusin(:, 0)**2
          temp1667 = rmucos(:, 0)**2
          temp1666 = rmu(:, 0)**2
          temp1666b6 = (fun3*temp1666*temp1667+fun*temp1668)*hessb(:)
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(ic, 0)*SUM(temp1666b6) +&
&            rmusin(ic, 0)*temp1670b1 + temp1670*temp1671b + 2.d0**2*&
&            temp1670*rmucos(ic, 0)**2*2*hessb(ic)
          rmub(ic, 0) = rmub(ic, 0) + rmucos(ic, 0)*SUM(temp1666b6) + &
&            fun*temp1670b
          fun0b = fun0b + (2.d0*rmucos(ic, 0)**2-1.d0)*zb(indorbp, indt+&
&            ic) + temp1669b
          temp1666b7 = rmu(ic, 0)*rmucos(ic, 0)*hessb(:)
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun*temp1666b7 &
&            + 2*rmucos(:, 0)*fun3*temp1666*temp1666b7
          rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*2.d0*2*rmucos(ic, 0)*zb&
&            (indorbp, indt+ic)
          temp1666b8 = rmu(3, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+3)
          temp1666b9 = rmu(ic, 0)*rmucos(3, 0)*zb(indorbp, indt+3)
          temp1666b10 = rmucos(ic, 0)*temp1666b9
          zb(indorbp, indt+3) = 0.D0
          temp1666b11 = rmu(2, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+2)
          temp1666b12 = rmu(ic, 0)*rmucos(2, 0)*zb(indorbp, indt+2)
          temp1666b13 = rmucos(ic, 0)*temp1666b12
          zb(indorbp, indt+2) = 0.D0
          temp1666b14 = rmu(ic, 0)*rmucos(1, 0)*zb(indorbp, indt+1)
          temp1666b15 = rmucos(ic, 0)*temp1666b14
          funb = funb + SUM(temp1668*temp1666b7) + rmu(2, 0)*temp1666b13&
&            + rmu(1, 0)*temp1666b15 + rmu(3, 0)*temp1666b10 + rmu(ic, 0)&
&            *temp1670b
          rmusinb(ic, 0) = rmusinb(ic, 0) + rmucos(ic, 0)*temp1670b1
          cellscaleb(ic) = cellscaleb(ic) - temp1669*temp1669b
          fun3b = fun3b + SUM(temp1666*temp1667*temp1666b7)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1667*temp1666b7
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*fun*temp1666b7
          rmub(ic, 0) = rmub(ic, 0) + rmucos(3, 0)*temp1666b8
          rmucosb(3, 0) = rmucosb(3, 0) + rmu(ic, 0)*temp1666b8
          rmub(3, 0) = rmub(3, 0) + fun*temp1666b10
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(3, 0)*fun*temp1666b9
          rmub(ic, 0) = rmub(ic, 0) + rmucos(2, 0)*temp1666b11
          rmucosb(2, 0) = rmucosb(2, 0) + rmu(ic, 0)*temp1666b11
          rmub(2, 0) = rmub(2, 0) + fun*temp1666b13
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(2, 0)*fun*temp1666b12
          temp1666b16 = rmu(1, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+1)
          rmub(ic, 0) = rmub(ic, 0) + rmucos(1, 0)*temp1666b16
          rmucosb(1, 0) = rmucosb(1, 0) + rmu(ic, 0)*temp1666b16
          rmub(1, 0) = rmub(1, 0) + fun*temp1666b15
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(1, 0)*fun*temp1666b14
          zb(indorbp, indt+1) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      distpb = 0.0_8
      temp1666b3 = (8.d0-4.d0*(r(0)**2*dd1))*fun3b
      temp1666b4 = -(dd1*distp(0, 1)*4.d0*fun3b)
      temp1666b5 = distp(0, 1)*2.d0*funb
      dd1b = r(0)**2*temp1666b5 + r(0)**2*temp1666b4 + distp(0, 1)*&
&        temp1666b3
      distpb(0, 1) = (2.d0*(dd1*r(0)**2)-2.d0)*funb - r(0)**2*fun0b + &
&        dd1*temp1666b3
      rb(0) = rb(0) + dd1*2*r(0)*temp1666b5 - distp(0, 1)*2*r(0)*fun0b +&
&        dd1*2*r(0)*temp1666b4
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          temp1666b1 = -(r(i)**2*rmucos(ic, i)*zb(indorbp, i))
          temp1666b2 = -(rmu(ic, i)*distp(i, 1)*zb(indorbp, i))
          rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp1666b1
          distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp1666b1
          rb(i) = rb(i) + rmucos(ic, i)*2*r(i)*temp1666b2
          rmucosb(ic, i) = rmucosb(ic, i) + r(i)**2*temp1666b2
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO k=0,0,-1
      temp1666b0 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp1666b0
      rb(k) = rb(k) - dd1*2*r(k)*temp1666b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (150)
!  2p single exponential  r e^{-z r^2}
    dd1 = dd(indpar+1)
    DO k=0,0
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    indorbp = indorb
!
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 1)*r(0)
      fun = (1.d0/r(0)-2.d0*dd1*r(0))*distp(0, 1)
      rp1 = 2.d0*dd1*r(0)**2
      fun3 = (rp1**2-1.d0-2.d0*rp1)*distp(0, 1)/r(0)**3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(rmucos(:, 0)**2-rmusin(:, 0)**2))
          hess(ic) = hess(ic) + 2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic&
&            , 0)*rmucos(ic, 0)*fun - 4.d0*fun0*rmucos(ic, 0)*rmusin(ic, &
&            0)*pi/cellscale(ic)
!                z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp1677 = rmu(ic, 0)*fun
          temp1678b = 2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic)
          temp1677b = rmucos(ic, 0)*temp1678b
          temp1676 = fun0/cellscale(ic)
          temp1677b0 = -(pi*4.d0*hessb(ic))
          temp1677b1 = temp1676*temp1677b0
          temp1676b = rmucos(ic, 0)*rmusin(ic, 0)*temp1677b0/cellscale(&
&            ic)
          temp1675 = rmucos(:, 0)**2 - rmusin(:, 0)**2
          temp1674 = rmucos(:, 0)**2
          temp1673 = rmu(:, 0)**2
          temp1673b = (fun3*temp1673*temp1674+fun*temp1675)*hessb(:)
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(ic, 0)*SUM(temp1673b) + &
&            rmusin(ic, 0)*temp1677b1 + temp1677*temp1678b + 2.d0**2*&
&            temp1677*rmucos(ic, 0)**2*2*hessb(ic)
          rmub(ic, 0) = rmub(ic, 0) + rmucos(ic, 0)*SUM(temp1673b) + fun&
&            *temp1677b
          fun0b = fun0b + (2.d0*rmucos(ic, 0)**2-1.d0)*zb(indorbp, indt+&
&            ic) + temp1676b
          temp1673b0 = rmu(ic, 0)*rmucos(ic, 0)*hessb(:)
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun*temp1673b0 &
&            + 2*rmucos(:, 0)*fun3*temp1673*temp1673b0
          temp1673b1 = rmucos(3, 0)*rmu(ic, 0)*zb(indorbp, indt+3)
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(3, 0)*fun*temp1673b1 + &
&            fun0*2.d0*2*rmucos(ic, 0)*zb(indorbp, indt+ic)
          temp1673b2 = rmucos(ic, 0)*temp1673b1
          temp1673b3 = rmu(3, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+3)
          zb(indorbp, indt+3) = 0.D0
          temp1673b4 = rmucos(2, 0)*rmu(ic, 0)*zb(indorbp, indt+2)
          temp1673b5 = rmucos(ic, 0)*temp1673b4
          temp1673b6 = rmu(2, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+2)
          zb(indorbp, indt+2) = 0.D0
          temp1673b7 = rmucos(1, 0)*rmu(ic, 0)*zb(indorbp, indt+1)
          temp1673b8 = rmucos(ic, 0)*temp1673b7
          funb = funb + SUM(temp1675*temp1673b0) + rmu(2, 0)*temp1673b5 &
&            + rmu(1, 0)*temp1673b8 + rmu(3, 0)*temp1673b2 + rmu(ic, 0)*&
&            temp1677b
          rmusinb(ic, 0) = rmusinb(ic, 0) + rmucos(ic, 0)*temp1677b1
          cellscaleb(ic) = cellscaleb(ic) - temp1676*temp1676b
          fun3b = fun3b + SUM(temp1673*temp1674*temp1673b0)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1674*temp1673b0
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*fun*temp1673b0
          rmub(3, 0) = rmub(3, 0) + fun*temp1673b2
          rmucosb(3, 0) = rmucosb(3, 0) + rmu(ic, 0)*temp1673b3
          rmub(ic, 0) = rmub(ic, 0) + rmucos(3, 0)*temp1673b3
          rmub(2, 0) = rmub(2, 0) + fun*temp1673b5
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(2, 0)*fun*temp1673b4
          rmucosb(2, 0) = rmucosb(2, 0) + rmu(ic, 0)*temp1673b6
          rmub(ic, 0) = rmub(ic, 0) + rmucos(2, 0)*temp1673b6
          temp1673b9 = rmu(1, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+1)
          rmub(1, 0) = rmub(1, 0) + fun*temp1673b8
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(1, 0)*fun*temp1673b7
          rmucosb(1, 0) = rmucosb(1, 0) + rmu(ic, 0)*temp1673b9
          rmub(ic, 0) = rmub(ic, 0) + rmucos(1, 0)*temp1673b9
          zb(indorbp, indt+1) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      distpb = 0.0_8
      temp1672 = r(0)**3
      temp1671 = distp(0, 1)/temp1672
      temp1671b3 = (rp1**2-2.d0*rp1-1.d0)*fun3b/temp1672
      rp1b = (temp1671*2*rp1-temp1671*2.d0)*fun3b
      distpb(0, 1) = (1.0/r(0)-2.d0*(dd1*r(0)))*funb + r(0)*fun0b + &
&        temp1671b3
      temp1671b4 = distp(0, 1)*funb
      rb(0) = rb(0) + 2.d0*dd1*2*r(0)*rp1b + distp(0, 1)*fun0b + (-(2.d0&
&        *dd1)-1.0/r(0)**2)*temp1671b4 - temp1671*3*r(0)**2*temp1671b3
      dd1b = 2.d0*r(0)**2*rp1b - 2.d0*r(0)*temp1671b4
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          temp1671b1 = rmu(ic, i)*rmucos(ic, i)*zb(indorbp, i)
          temp1671b2 = distp(i, 1)*r(i)*zb(indorbp, i)
          distpb(i, 1) = distpb(i, 1) + r(i)*temp1671b1
          rb(i) = rb(i) + distp(i, 1)*temp1671b1
          rmub(ic, i) = rmub(ic, i) + rmucos(ic, i)*temp1671b2
          rmucosb(ic, i) = rmucosb(ic, i) + rmu(ic, i)*temp1671b2
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO k=0,0,-1
      temp1671b0 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp1671b0
      rb(k) = rb(k) - dd1*2*r(k)*temp1671b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (151)
! derivative of 150 unnormalized
! R(r)=exp(-z*r**2)*(-r**3)
    dd1 = dd(indpar+1)
    DO k=0,0
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    indorbp = indorb
!
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      rp1 = 2.d0*dd1*r(0)**2
      fun = distp(0, 1)*(rp1-3.d0)*r(0)
      fun0 = -(distp(0, 1)*r(0)**3)
      fun3 = distp(0, 1)/r(0)*(-3.d0+6.d0*rp1-rp1**2)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(rmucos(:, 0)**2-rmusin(:, 0)**2))
          hess(ic) = hess(ic) + 2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic&
&            , 0)*rmucos(ic, 0)*fun - 4.d0*fun0*rmucos(ic, 0)*rmusin(ic, &
&            0)*pi/cellscale(ic)
!                z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp1684 = rmu(ic, 0)*fun
          temp1685b = 2.d0*(2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic)
          temp1684b = rmucos(ic, 0)*temp1685b
          temp1683 = fun0/cellscale(ic)
          temp1684b0 = -(pi*4.d0*hessb(ic))
          temp1684b1 = temp1683*temp1684b0
          temp1683b = rmucos(ic, 0)*rmusin(ic, 0)*temp1684b0/cellscale(&
&            ic)
          temp1682 = rmucos(:, 0)**2 - rmusin(:, 0)**2
          temp1681 = rmucos(:, 0)**2
          temp1680 = rmu(:, 0)**2
          temp1680b = (fun3*temp1680*temp1681+fun*temp1682)*hessb(:)
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(ic, 0)*SUM(temp1680b) + &
&            rmusin(ic, 0)*temp1684b1 + temp1684*temp1685b + 2.d0**2*&
&            temp1684*rmucos(ic, 0)**2*2*hessb(ic)
          rmub(ic, 0) = rmub(ic, 0) + rmucos(ic, 0)*SUM(temp1680b) + fun&
&            *temp1684b
          fun0b = fun0b + (2.d0*rmucos(ic, 0)**2-1.d0)*zb(indorbp, indt+&
&            ic) + temp1683b
          temp1680b0 = rmu(ic, 0)*rmucos(ic, 0)*hessb(:)
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun*temp1680b0 &
&            + 2*rmucos(:, 0)*fun3*temp1680*temp1680b0
          rmucosb(ic, 0) = rmucosb(ic, 0) + fun0*2.d0*2*rmucos(ic, 0)*zb&
&            (indorbp, indt+ic)
          temp1680b1 = rmu(3, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+3)
          temp1680b2 = rmu(ic, 0)*rmucos(3, 0)*zb(indorbp, indt+3)
          temp1680b3 = rmucos(ic, 0)*temp1680b2
          zb(indorbp, indt+3) = 0.D0
          temp1680b4 = rmu(2, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+2)
          temp1680b5 = rmu(ic, 0)*rmucos(2, 0)*zb(indorbp, indt+2)
          temp1680b6 = rmucos(ic, 0)*temp1680b5
          zb(indorbp, indt+2) = 0.D0
          temp1680b7 = rmu(ic, 0)*rmucos(1, 0)*zb(indorbp, indt+1)
          temp1680b8 = rmucos(ic, 0)*temp1680b7
          funb = funb + SUM(temp1682*temp1680b0) + rmu(2, 0)*temp1680b6 &
&            + rmu(1, 0)*temp1680b8 + rmu(3, 0)*temp1680b3 + rmu(ic, 0)*&
&            temp1684b
          rmusinb(ic, 0) = rmusinb(ic, 0) + rmucos(ic, 0)*temp1684b1
          cellscaleb(ic) = cellscaleb(ic) - temp1683*temp1683b
          fun3b = fun3b + SUM(temp1680*temp1681*temp1680b0)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1681*temp1680b0
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*fun*temp1680b0
          rmub(ic, 0) = rmub(ic, 0) + rmucos(3, 0)*temp1680b1
          rmucosb(3, 0) = rmucosb(3, 0) + rmu(ic, 0)*temp1680b1
          rmub(3, 0) = rmub(3, 0) + fun*temp1680b3
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(3, 0)*fun*temp1680b2
          rmub(ic, 0) = rmub(ic, 0) + rmucos(2, 0)*temp1680b4
          rmucosb(2, 0) = rmucosb(2, 0) + rmu(ic, 0)*temp1680b4
          rmub(2, 0) = rmub(2, 0) + fun*temp1680b6
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(2, 0)*fun*temp1680b5
          temp1680b9 = rmu(1, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+1)
          rmub(ic, 0) = rmub(ic, 0) + rmucos(1, 0)*temp1680b9
          rmucosb(1, 0) = rmucosb(1, 0) + rmu(ic, 0)*temp1680b9
          rmub(1, 0) = rmub(1, 0) + fun*temp1680b8
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(1, 0)*fun*temp1680b7
          zb(indorbp, indt+1) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      distpb = 0.0_8
      temp1679b = (6.d0*rp1-rp1**2-3.d0)*fun3b/r(0)
      temp1679 = distp(0, 1)/r(0)
      distpb(0, 1) = (rp1-3.d0)*r(0)*funb - r(0)**3*fun0b + temp1679b
      rp1b = distp(0, 1)*r(0)*funb + (temp1679*6.d0-temp1679*2*rp1)*&
&        fun3b
      rb(0) = rb(0) + 2.d0*dd1*2*r(0)*rp1b - distp(0, 1)*3*r(0)**2*fun0b&
&        + distp(0, 1)*(rp1-3.d0)*funb - temp1679*temp1679b
      dd1b = 2.d0*r(0)**2*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          temp1678 = r(i)**3
          temp1678b1 = -(temp1678*rmucos(ic, i)*zb(indorbp, i))
          temp1678b2 = -(rmu(ic, i)*distp(i, 1)*zb(indorbp, i))
          rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp1678b1
          distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp1678b1
          rb(i) = rb(i) + rmucos(ic, i)*3*r(i)**2*temp1678b2
          rmucosb(ic, i) = rmucosb(ic, i) + temp1678*temp1678b2
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO k=0,0,-1
      temp1678b0 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp1678b0
      rb(k) = rb(k) - dd1*2*r(k)*temp1678b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (152)
!     2s single gaussian
!     r^3 exp(-dd2*r^2)
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    indshellp = indshell + 1
    DO k=0,0
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
!endif for indt
    IF (typec .NE. 1) THEN
      rp1 = 2.d0*dd2*r(0)**2
      fun = r(0)*(3.d0-rp1)*distp(0, 1)
      fun3 = (3.d0-6.d0*rp1+rp1**2)*distp(0, 1)/r(0)
!********** DIAGONAL PART HESSIAN ******************
      hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(1.d0-2.d0*&
&        rmusin(:, 0)**2)
!                z_xyz(indorbp,:)=hess(:)
      hessb = 0.0_8
      hessb(:) = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.D0
      temp1686b0 = rmucos(:, 0)**2*hessb(:)
      fun3b = SUM(rmu(:, 0)**2*temp1686b0)
      rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1686b0
      rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*rmu(:, 0)**2*&
&        hessb(:)
      funb = SUM((1.d0-2.d0*rmusin(:, 0)**2)*hessb(:))
      rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*hessb(:)
      DO i=3,1,-1
        temp1686b = rmucos(i, 0)*zb(indorbp, indt+i)
        funb = funb + rmu(i, 0)*temp1686b
        rmub(i, 0) = rmub(i, 0) + fun*temp1686b
        rmucosb(i, 0) = rmucosb(i, 0) + fun*rmu(i, 0)*zb(indorbp, indt+i&
&          )
        zb(indorbp, indt+i) = 0.D0
      END DO
      distpb = 0.0_8
      temp1685 = distp(0, 1)/r(0)
      temp1685b1 = (rp1**2-6.d0*rp1+3.d0)*fun3b/r(0)
      rp1b = (temp1685*2*rp1-temp1685*6.d0)*fun3b - distp(0, 1)*r(0)*&
&        funb
      distpb(0, 1) = r(0)*(3.d0-rp1)*funb + temp1685b1
      rb(0) = rb(0) + distp(0, 1)*(3.d0-rp1)*funb + 2.d0*dd2*2*r(0)*rp1b&
&        - temp1685*temp1685b1
      dd2b = 2.d0*r(0)**2*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) + r(i)**3*zb(indorbp, i)
        rb(i) = rb(i) + distp(i, 1)*3*r(i)**2*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    DO k=0,0,-1
      temp1685b0 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp1685b0
      rb(k) = rb(k) - dd2*2*r(k)*temp1685b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (153)
!     2s without cusp condition  !derivative 152
!     -(r^5*exp(-dd2*r^2))
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    indshellp = indshell + 1
    DO k=0,0
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) THEN
      rp1 = 2.d0*dd2*r(0)**2
      fun = r(0)**3*distp(0, 1)*(rp1-5.d0)
      fun3 = -(r(0)*(15.d0-10.d0*rp1+rp1**2)*distp(0, 1))
!********** DIAGONAL PART HESSIAN ******************
      hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(1.d0-2.d0*&
&        rmusin(:, 0)**2)
!                z_xyz(indorbp,:)=hess(:)
!endif for indt
      hessb = 0.0_8
      hessb(:) = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.D0
      temp1686b6 = rmucos(:, 0)**2*hessb(:)
      fun3b = SUM(rmu(:, 0)**2*temp1686b6)
      rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1686b6
      rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*rmu(:, 0)**2*&
&        hessb(:)
      funb = SUM((1.d0-2.d0*rmusin(:, 0)**2)*hessb(:))
      rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*hessb(:)
      DO i=3,1,-1
        temp1686b5 = rmucos(i, 0)*zb(indorbp, indt+i)
        funb = funb + rmu(i, 0)*temp1686b5
        rmub(i, 0) = rmub(i, 0) + fun*temp1686b5
        rmucosb(i, 0) = rmucosb(i, 0) + fun*rmu(i, 0)*zb(indorbp, indt+i&
&          )
        zb(indorbp, indt+i) = 0.D0
      END DO
      distpb = 0.0_8
      temp1686b2 = -(r(0)*distp(0, 1)*fun3b)
      temp1686b3 = -((rp1**2-10.d0*rp1+15.d0)*fun3b)
      temp1686b4 = r(0)**3*funb
      rp1b = distp(0, 1)*temp1686b4 + (2*rp1-10.d0)*temp1686b2
      rb(0) = rb(0) + distp(0, 1)*(rp1-5.d0)*3*r(0)**2*funb + 2.d0*dd2*2&
&        *r(0)*rp1b + distp(0, 1)*temp1686b3
      distpb(0, 1) = (rp1-5.d0)*temp1686b4 + r(0)*temp1686b3
      dd2b = 2.d0*r(0)**2*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) - r(i)**5*zb(indorbp, i)
        rb(i) = rb(i) - distp(i, 1)*5*r(i)**4*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    DO k=0,0,-1
      temp1686b1 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp1686b1
      rb(k) = rb(k) - dd2*2*r(k)*temp1686b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (39)
!     2s with cusp condition
!     ( r^3*exp(-dd2*r))  !  der of   10
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    indshellp = indshell + 1
    DO k=0,0
      distp(k, 1) = -(DEXP(-(dd2*r(k)))*r(k))
    END DO
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) THEN
      fun = (3.d0-dd2*r(0))*distp(0, 1)
      fun3 = -(dd2*distp(0, 1)/r(0)) + (3.d0-dd2*r(0))*(-(dd2*distp(0, 1&
&        ))+distp(0, 1)/r(0))/r(0)
!********** DIAGONAL PART HESSIAN ******************
      hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(1.d0-2.d0*&
&        rmusin(:, 0)**2)
!                z_xyz(indorbp,:)=hess(:)
!endif for indt
      hessb = 0.0_8
      hessb(:) = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.D0
      temp1689b0 = rmucos(:, 0)**2*hessb(:)
      fun3b = SUM(rmu(:, 0)**2*temp1689b0)
      rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1689b0
      rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*rmu(:, 0)**2*&
&        hessb(:)
      funb = SUM((1.d0-2.d0*rmusin(:, 0)**2)*hessb(:))
      rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*hessb(:)
      DO i=3,1,-1
        temp1689b = rmucos(i, 0)*zb(indorbp, indt+i)
        funb = funb + rmu(i, 0)*temp1689b
        rmub(i, 0) = rmub(i, 0) + fun*temp1689b
        rmucosb(i, 0) = rmucosb(i, 0) + fun*rmu(i, 0)*zb(indorbp, indt+i&
&          )
        zb(indorbp, indt+i) = 0.D0
      END DO
      distpb = 0.0_8
      temp1687 = distp(0, 1)/r(0)
      temp1688b = (temp1687-dd2*distp(0, 1))*fun3b/r(0)
      temp1688 = (-(dd2*r(0))+3.d0)/r(0)
      temp1688b0 = temp1688*fun3b
      temp1687b = temp1688b0/r(0)
      temp1686 = dd2/r(0)
      temp1686b8 = -(distp(0, 1)*fun3b/r(0))
      dd2b = temp1686b8 - distp(0, 1)*r(0)*funb - distp(0, 1)*temp1688b0&
&        - r(0)*temp1688b
      rb(0) = rb(0) + (-temp1688-dd2)*temp1688b - temp1686*temp1686b8 - &
&        temp1687*temp1687b - distp(0, 1)*dd2*funb
      distpb(0, 1) = (3.d0-dd2*r(0))*funb - temp1686*fun3b - dd2*&
&        temp1688b0 + temp1687b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
        rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    DO k=0,0,-1
      temp1686b7 = -(r(k)*DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp1686b7
      rb(k) = rb(k) - DEXP(-(dd2*r(k)))*distpb(k, 1) - dd2*temp1686b7
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (147)
! d single gaussian orbital
! radial R(r)= exp(-alpha r^2)
! normalized
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i)
! R depends on X_i, A depends on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    IF (dd(indparp) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indparp) = dd(indparp)
    ELSE
      dd(indparp) = -dd(indparp)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd1 = dd(indparp)
! radial part
    DO k=0,0
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos with the minimal rmucos strategy
    DO i=0,0
      rp0 = r(i)**2
! lz=0
      distp(i, 2) = (3.d0*rmu(3, i)**2-rp0)*cost1d
! lz=+/-2
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*rmucos(1, i)*rmucos(2, i)*cost3d
! lz=+/-1
      distp(i, 5) = rmu(2, i)*rmu(3, i)*rmucos(2, i)*rmucos(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*rmucos(1, i)*rmucos(3, i)*cost3d
    END DO
! lz=+/-4
! definition of the orbital \Psi
! radial * angular
! F = radial * angular
! compute \Psi = F
    DO ic=1,5
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,5
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part ! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost1d*rmu(1, 0)*rmucos(1, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*2.d0*(-(rmucos(1, 0)**2)+rmusin(&
&                  1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost1d*rmu(2, 0)*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*2.d0*(-(rmucos(2, 0)**2)+rmusin(&
&                  2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 4.d0*cost1d*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*4.d0*(rmucos(3, 0)**2-rmusin(3, &
&                  0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost2d*rmu(1, 0)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2d*fun0*2.d0*(rmucos(1, 0)**2-rmusin(1, &
&                  0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2d*rmu(2, 0)*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2d*fun0*2.d0*(-(rmucos(2, 0)**2)+rmusin(&
&                  2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(2, 0)*rmucos(2, 0)*(rmucos(1, 0)**&
&                  2-rmusin(1, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(1)*rmu(2, 0)&
&                  *rmucos(1, 0)*rmucos(2, 0)*rmusin(1, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(1, 0)*rmucos(1, 0)*(rmucos(2, 0)**&
&                  2-rmusin(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(2)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmucos(2, 0)*rmusin(2, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(3, 0)*rmucos(3, 0)*(rmucos(2, 0)**&
&                  2-rmusin(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(2)*rmu(3, 0)&
&                  *rmucos(2, 0)*rmucos(3, 0)*rmusin(2, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(2, 0)*rmucos(2, 0)*(rmucos(3, 0)**&
&                  2-rmusin(3, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(3)*rmu(2, 0)&
&                  *rmucos(2, 0)*rmucos(3, 0)*rmusin(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost3d*rmu(3, 0)*rmucos(3, 0)*(rmucos(1, 0)**2-&
&                rmusin(1, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(1)*rmu(3, 0)*&
&                rmucos(1, 0)*rmucos(3, 0)*rmusin(1, 0))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost3d*rmu(1, 0)*rmucos(1, 0)*(rmucos(3, 0)**2-&
&                rmusin(3, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(3)*rmu(1, 0)*&
&                rmucos(1, 0)*rmucos(3, 0)*rmusin(3, 0))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
!endif for ic
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
!                     z_xyz(indorbp,i)=hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=5,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1705 = der4f(1)/cellscale(i)
            temp1705b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp1705*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp1705b
            cellscaleb(i) = cellscaleb(i) - temp1705*temp1705b
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 8) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 2) THEN
                  IF (branch .LT. 1) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1693b0 = cost1d*2.d0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(1, 0)**&
&                      2-rmucos(1, 0)**2)*temp1693b0
                    rmusinb(1, 0) = rmusinb(1, 0) + fun0*2*rmusin(1, 0)*&
&                      temp1693b0
                    hess4fb(2) = 0.0_8
                    temp1693b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1693b1 + fun0*der4fb(2)
                    temp1693b2 = -(cost1d*2.d0*der4fb(2))
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1693b2&
&                      - fun0*2*rmucos(1, 0)*temp1693b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1693b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1693b2
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1693b3 = cost1d*2.d0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(2, 0)**&
&                      2-rmucos(2, 0)**2)*temp1693b3
                    rmusinb(2, 0) = rmusinb(2, 0) + fun0*2*rmusin(2, 0)*&
&                      temp1693b3
                    hess4fb(2) = 0.0_8
                    temp1693b4 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1693b4 + fun0*der4fb(2)
                    temp1693b5 = -(cost1d*2.d0*der4fb(2))
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1693b5&
&                      - fun0*2*rmucos(2, 0)*temp1693b3
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1693b4
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1693b5
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 3) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1693b6 = cost1d*4.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmucos(3, 0)**2-&
&                    rmusin(3, 0)**2)*temp1693b6
                  hess4fb(2) = 0.0_8
                  temp1693b7 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1693b7 + fun0*der4fb(2)
                  temp1693b8 = cost1d*4.d0*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1693b8 +&
&                    fun0*2*rmucos(3, 0)*temp1693b6
                  rmusinb(3, 0) = rmusinb(3, 0) - fun0*2*rmusin(3, 0)*&
&                    temp1693b6
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1693b7
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1693b8
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1693b9 = cost2d*2.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmucos(1, 0)**2-&
&                    rmusin(1, 0)**2)*temp1693b9
                  hess4fb(2) = 0.0_8
                  temp1693b10 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1693b10 + fun0*der4fb(2)
                  temp1693b11 = cost2d*2.d0*der4fb(2)
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1693b11 &
&                    + fun0*2*rmucos(1, 0)*temp1693b9
                  rmusinb(1, 0) = rmusinb(1, 0) - fun0*2*rmusin(1, 0)*&
&                    temp1693b9
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1693b10
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1693b11
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 6) THEN
                IF (branch .LT. 5) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1693b12 = cost2d*2.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(2, 0)**2-&
&                    rmucos(2, 0)**2)*temp1693b12
                  rmusinb(2, 0) = rmusinb(2, 0) + fun0*2*rmusin(2, 0)*&
&                    temp1693b12
                  hess4fb(2) = 0.0_8
                  temp1693b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1693b13 + fun0*der4fb(2)
                  temp1693b14 = -(cost2d*2.d0*der4fb(2))
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1693b14 &
&                    - fun0*2*rmucos(2, 0)*temp1693b12
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1693b13
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1693b14
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 7) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1693 = fun0/cellscale(1)
                temp1694 = rmu(2, 0)*rmucos(1, 0)
                temp1694b = -(cost3d*4.d0*pi*hess4fb(2))
                temp1694b0 = rmucos(2, 0)*rmusin(1, 0)*temp1694b
                temp1693b15 = temp1694*temp1694b0/cellscale(1)
                temp1693b16 = temp1694*temp1693*temp1694b
                rmub(2, 0) = rmub(2, 0) + temp1693*rmucos(1, 0)*&
&                  temp1694b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1693*rmu(2, 0)*&
&                  temp1694b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1693b15
                cellscaleb(1) = cellscaleb(1) - temp1693*temp1693b15
                hess4fb(2) = 0.0_8
                temp1693b17 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1693b17 + fun0*der4fb(2)
                temp1693b18 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                  der4fb(2)
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1693b18 + &
&                  rmusin(1, 0)*temp1693b16
                temp1693b19 = cost3d*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                rmusinb(1, 0) = rmusinb(1, 0) + rmucos(2, 0)*temp1693b16&
&                  - 2*rmusin(1, 0)*temp1693b19
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1693b17
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1693b18
                rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*&
&                  temp1693b19
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1695 = fun0/cellscale(2)
                temp1696 = rmu(1, 0)*rmucos(1, 0)
                temp1696b = -(cost3d*4.d0*pi*hess4fb(2))
                temp1696b0 = rmucos(2, 0)*rmusin(2, 0)*temp1696b
                temp1695b = temp1696*temp1696b0/cellscale(2)
                temp1695b0 = temp1696*temp1695*temp1696b
                rmub(1, 0) = rmub(1, 0) + temp1695*rmucos(1, 0)*&
&                  temp1696b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1695*rmu(1, 0)*&
&                  temp1696b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1695b
                cellscaleb(2) = cellscaleb(2) - temp1695*temp1695b
                rmucosb(2, 0) = rmucosb(2, 0) + rmusin(2, 0)*temp1695b0
                hess4fb(2) = 0.0_8
                temp1695b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1695b1 + fun0*der4fb(2)
                temp1695b2 = cost3d*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
                rmusinb(2, 0) = rmusinb(2, 0) + rmucos(2, 0)*temp1695b0 &
&                  - 2*rmusin(2, 0)*temp1695b2
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1695b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1695b3 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                  der4fb(2)
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1695b3
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1695b3
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*&
&                  temp1695b2
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 11) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1697 = fun0/cellscale(2)
                temp1698 = rmu(3, 0)*rmucos(2, 0)
                temp1698b = -(cost3d*4.d0*pi*hess4fb(2))
                temp1698b0 = rmucos(3, 0)*rmusin(2, 0)*temp1698b
                temp1697b = temp1698*temp1698b0/cellscale(2)
                temp1697b0 = temp1698*temp1697*temp1698b
                rmub(3, 0) = rmub(3, 0) + temp1697*rmucos(2, 0)*&
&                  temp1698b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp1697*rmu(3, 0)*&
&                  temp1698b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1697b
                cellscaleb(2) = cellscaleb(2) - temp1697*temp1697b
                hess4fb(2) = 0.0_8
                temp1697b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1697b1 + fun0*der4fb(2)
                temp1697b2 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                  der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1697b2 + &
&                  rmusin(2, 0)*temp1697b0
                temp1697b3 = cost3d*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                rmusinb(2, 0) = rmusinb(2, 0) + rmucos(3, 0)*temp1697b0 &
&                  - 2*rmusin(2, 0)*temp1697b3
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1697b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1697b2
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*&
&                  temp1697b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1699 = fun0/cellscale(3)
                temp1700 = rmu(2, 0)*rmucos(2, 0)
                temp1700b = -(cost3d*4.d0*pi*hess4fb(2))
                temp1700b0 = rmucos(3, 0)*rmusin(3, 0)*temp1700b
                temp1699b = temp1700*temp1700b0/cellscale(3)
                temp1699b0 = temp1700*temp1699*temp1700b
                rmub(2, 0) = rmub(2, 0) + temp1699*rmucos(2, 0)*&
&                  temp1700b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp1699*rmu(2, 0)*&
&                  temp1700b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1699b
                cellscaleb(3) = cellscaleb(3) - temp1699*temp1699b
                rmucosb(3, 0) = rmucosb(3, 0) + rmusin(3, 0)*temp1699b0
                hess4fb(2) = 0.0_8
                temp1699b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1699b1 + fun0*der4fb(2)
                temp1699b2 = cost3d*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                rmusinb(3, 0) = rmusinb(3, 0) + rmucos(3, 0)*temp1699b0 &
&                  - 2*rmusin(3, 0)*temp1699b2
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1699b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1699b3 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                  der4fb(2)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1699b3
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1699b3
                rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*&
&                  temp1699b2
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1701 = fun0/cellscale(1)
                temp1702 = rmu(3, 0)*rmucos(1, 0)
                temp1702b = -(cost3d*4.d0*pi*hess4fb(2))
                temp1702b0 = rmucos(3, 0)*rmusin(1, 0)*temp1702b
                temp1701b = temp1702*temp1702b0/cellscale(1)
                temp1701b0 = temp1702*temp1701*temp1702b
                rmub(3, 0) = rmub(3, 0) + temp1701*rmucos(1, 0)*&
&                  temp1702b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1701*rmu(3, 0)*&
&                  temp1702b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1701b
                cellscaleb(1) = cellscaleb(1) - temp1701*temp1701b
                hess4fb(2) = 0.0_8
                temp1701b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1701b1 + fun0*der4fb(2)
                temp1701b2 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                  der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1701b2 + &
&                  rmusin(1, 0)*temp1701b0
                temp1701b3 = cost3d*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                rmusinb(1, 0) = rmusinb(1, 0) + rmucos(3, 0)*temp1701b0 &
&                  - 2*rmusin(1, 0)*temp1701b3
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1701b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1701b2
                rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*&
&                  temp1701b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              temp1703 = fun0/cellscale(3)
              temp1704 = rmu(1, 0)*rmucos(1, 0)
              temp1704b = -(cost3d*4.d0*pi*hess4fb(2))
              temp1704b0 = rmucos(3, 0)*rmusin(3, 0)*temp1704b
              temp1703b = temp1704*temp1704b0/cellscale(3)
              temp1703b0 = temp1704*temp1703*temp1704b
              rmub(1, 0) = rmub(1, 0) + temp1703*rmucos(1, 0)*temp1704b0
              rmucosb(1, 0) = rmucosb(1, 0) + temp1703*rmu(1, 0)*&
&                temp1704b0
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              fun0b = fun0b + der4f(2)*der4fb(2) + temp1703b
              cellscaleb(3) = cellscaleb(3) - temp1703*temp1703b
              rmucosb(3, 0) = rmucosb(3, 0) + rmusin(3, 0)*temp1703b0
              hess4fb(2) = 0.0_8
              temp1703b1 = 2.d0*rmu(i, 0)*hess4fb(3)
              der4fb(2) = fun*temp1703b1 + fun0*der4fb(2)
              temp1703b2 = cost3d*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
              rmusinb(3, 0) = rmusinb(3, 0) + rmucos(3, 0)*temp1703b0 - &
&                2*rmusin(3, 0)*temp1703b2
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
              funb = funb + der4f(2)*temp1703b1
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              temp1703b3 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                der4fb(2)
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1703b3
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1703b3
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp1703b2
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp1693b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp1693b
            funb = funb + rmu(i, 0)*temp1693b
            der4fb(1) = 0.0_8
          END DO
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp1692 = r(0)**2
        temp1691 = fun2/temp1692
        temp1691b = rmu(i, 0)**2*radhess4fb(i)/temp1692
        temp1690 = r(0)**2
        temp1689 = rmu(i, 0)**2/temp1690
        temp1689b9 = -(fun*radhess4fb(i)/temp1690)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp1689b9 + temp1691*2*&
&          rmu(i, 0)*radhess4fb(i)
        fun2b = fun2b + temp1691b
        rb(0) = rb(0) - temp1689*2*r(0)*temp1689b9 - temp1691*2*r(0)*&
&          temp1691b
        funb = funb + (1.d0-temp1689)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      temp1689b8 = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp1689b8 - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp1689b8
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp1689b2 = cost3d*rmucos(1, i)*rmucos(3, i)*distpb(i, 6)
      temp1689b3 = cost3d*rmu(1, i)*rmu(3, i)*distpb(i, 6)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp1689b2
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp1689b2
      rmucosb(1, i) = rmucosb(1, i) + rmucos(3, i)*temp1689b3
      rmucosb(3, i) = rmucosb(3, i) + rmucos(1, i)*temp1689b3
      distpb(i, 6) = 0.0_8
      temp1689b4 = cost3d*rmucos(2, i)*rmucos(3, i)*distpb(i, 5)
      temp1689b5 = cost3d*rmu(2, i)*rmu(3, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp1689b4
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp1689b4
      rmucosb(2, i) = rmucosb(2, i) + rmucos(3, i)*temp1689b5
      rmucosb(3, i) = rmucosb(3, i) + rmucos(2, i)*temp1689b5
      distpb(i, 5) = 0.0_8
      temp1689b6 = cost3d*rmucos(1, i)*rmucos(2, i)*distpb(i, 4)
      temp1689b7 = cost3d*rmu(1, i)*rmu(2, i)*distpb(i, 4)
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp1689b6
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp1689b6
      rmucosb(1, i) = rmucosb(1, i) + rmucos(2, i)*temp1689b7
      rmucosb(2, i) = rmucosb(2, i) + rmucos(1, i)*temp1689b7
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rp0b = -(cost1d*distpb(i, 2))
      distpb(i, 2) = 0.0_8
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    DO k=0,0,-1
      temp1689b1 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp1689b1
      rb(k) = rb(k) - dd1*2*r(k)*temp1689b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indparp) = ddb(indparp) + dd1b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indparp) = -ddb(indparp)
  CASE (148)
! d single gaussian orbital
! radial R(r)= exp(-alpha r^2)
! normalized
! orbital with the minimal power of rmucos
! orbital derivative of 147
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i)
! R depends on X_i, A depends on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i)))
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    IF (dd(indparp) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indparp) = dd(indparp)
    ELSE
      dd(indparp) = -dd(indparp)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd1 = dd(indparp)
! radial part
    DO k=0,0
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos with the minimal rmucos strategy
    DO i=0,0
      rp0 = r(i)**2
! lz=0
      distp(i, 2) = (3.d0*rmu(3, i)**2-rp0)*cost1d
! lz=+/-2
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*rmucos(1, i)*rmucos(2, i)*cost3d
! lz=+/-1
      distp(i, 5) = rmu(2, i)*rmu(3, i)*rmucos(2, i)*rmucos(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*rmucos(1, i)*rmucos(3, i)*cost3d
    END DO
! lz=+/-4
! definition of the orbital \Psi
! radial * angular
! F = radial * angular
! compute \Psi = F
    DO ic=1,5
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = -(r(0)**2*distp(0, 1))
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+10.d0*dd1*r(0)**2-2.d0)
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,5
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part ! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost1d*rmu(1, 0)*rmucos(1, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*2.d0*(-(rmucos(1, 0)**2)+rmusin(&
&                  1, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost1d*rmu(2, 0)*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*2.d0*(-(rmucos(2, 0)**2)+rmusin(&
&                  2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 4.d0*cost1d*rmu(3, 0)*rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1d*fun0*4.d0*(rmucos(3, 0)**2-rmusin(3, &
&                  0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost2d*rmu(1, 0)*rmucos(1, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2d*fun0*2.d0*(rmucos(1, 0)**2-rmusin(1, &
&                  0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2d*rmu(2, 0)*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost2d*fun0*2.d0*(-(rmucos(2, 0)**2)+rmusin(&
&                  2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(2, 0)*rmucos(2, 0)*(rmucos(1, 0)**&
&                  2-rmusin(1, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(1)*rmu(2, 0)&
&                  *rmucos(1, 0)*rmucos(2, 0)*rmusin(1, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(1, 0)*rmucos(1, 0)*(rmucos(2, 0)**&
&                  2-rmusin(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(2)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmucos(2, 0)*rmusin(2, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(3, 0)*rmucos(3, 0)*(rmucos(2, 0)**&
&                  2-rmusin(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(2)*rmu(3, 0)&
&                  *rmucos(2, 0)*rmucos(3, 0)*rmusin(2, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3d*rmu(2, 0)*rmucos(2, 0)*(rmucos(3, 0)**&
&                  2-rmusin(3, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(3)*rmu(2, 0)&
&                  *rmucos(2, 0)*rmucos(3, 0)*rmusin(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost3d*rmu(3, 0)*rmucos(3, 0)*(rmucos(1, 0)**2-&
&                rmusin(1, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(1)*rmu(3, 0)*&
&                rmucos(1, 0)*rmucos(3, 0)*rmusin(1, 0))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = cost3d*rmu(1, 0)*rmucos(1, 0)*(rmucos(3, 0)**2-&
&                rmusin(3, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(cost3d*fun0*4.d0*pi/cellscale(3)*rmu(1, 0)*&
&                rmucos(1, 0)*rmucos(3, 0)*rmusin(3, 0))
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
!endif for ic
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
!                     z_xyz(indorbp,i)=hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=5,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1723 = der4f(1)/cellscale(i)
            temp1723b = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp1723*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp1723b
            cellscaleb(i) = cellscaleb(i) - temp1723*temp1723b
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 8) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 2) THEN
                  IF (branch .LT. 1) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1711b0 = cost1d*2.d0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(1, 0)**&
&                      2-rmucos(1, 0)**2)*temp1711b0
                    rmusinb(1, 0) = rmusinb(1, 0) + fun0*2*rmusin(1, 0)*&
&                      temp1711b0
                    hess4fb(2) = 0.0_8
                    temp1711b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1711b1 + fun0*der4fb(2)
                    temp1711b2 = -(cost1d*2.d0*der4fb(2))
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1711b2&
&                      - fun0*2*rmucos(1, 0)*temp1711b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1711b1
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1711b2
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1711b3 = cost1d*2.d0*hess4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(2, 0)**&
&                      2-rmucos(2, 0)**2)*temp1711b3
                    rmusinb(2, 0) = rmusinb(2, 0) + fun0*2*rmusin(2, 0)*&
&                      temp1711b3
                    hess4fb(2) = 0.0_8
                    temp1711b4 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1711b4 + fun0*der4fb(2)
                    temp1711b5 = -(cost1d*2.d0*der4fb(2))
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1711b5&
&                      - fun0*2*rmucos(2, 0)*temp1711b3
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1711b4
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1711b5
                    der4fb(2) = 0.0_8
                  END IF
                ELSE IF (branch .LT. 3) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1711b6 = cost1d*4.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmucos(3, 0)**2-&
&                    rmusin(3, 0)**2)*temp1711b6
                  hess4fb(2) = 0.0_8
                  temp1711b7 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1711b7 + fun0*der4fb(2)
                  temp1711b8 = cost1d*4.d0*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1711b8 +&
&                    fun0*2*rmucos(3, 0)*temp1711b6
                  rmusinb(3, 0) = rmusinb(3, 0) - fun0*2*rmusin(3, 0)*&
&                    temp1711b6
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1711b7
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1711b8
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1711b9 = cost2d*2.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmucos(1, 0)**2-&
&                    rmusin(1, 0)**2)*temp1711b9
                  hess4fb(2) = 0.0_8
                  temp1711b10 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1711b10 + fun0*der4fb(2)
                  temp1711b11 = cost2d*2.d0*der4fb(2)
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1711b11 &
&                    + fun0*2*rmucos(1, 0)*temp1711b9
                  rmusinb(1, 0) = rmusinb(1, 0) - fun0*2*rmusin(1, 0)*&
&                    temp1711b9
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1711b10
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1711b11
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 6) THEN
                IF (branch .LT. 5) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1711b12 = cost2d*2.d0*hess4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + (rmusin(2, 0)**2-&
&                    rmucos(2, 0)**2)*temp1711b12
                  rmusinb(2, 0) = rmusinb(2, 0) + fun0*2*rmusin(2, 0)*&
&                    temp1711b12
                  hess4fb(2) = 0.0_8
                  temp1711b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1711b13 + fun0*der4fb(2)
                  temp1711b14 = -(cost2d*2.d0*der4fb(2))
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1711b14 &
&                    - fun0*2*rmucos(2, 0)*temp1711b12
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1711b13
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1711b14
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 7) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1711 = fun0/cellscale(1)
                temp1712 = rmu(2, 0)*rmucos(1, 0)
                temp1712b = -(cost3d*4.d0*pi*hess4fb(2))
                temp1712b0 = rmucos(2, 0)*rmusin(1, 0)*temp1712b
                temp1711b15 = temp1712*temp1712b0/cellscale(1)
                temp1711b16 = temp1712*temp1711*temp1712b
                rmub(2, 0) = rmub(2, 0) + temp1711*rmucos(1, 0)*&
&                  temp1712b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1711*rmu(2, 0)*&
&                  temp1712b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1711b15
                cellscaleb(1) = cellscaleb(1) - temp1711*temp1711b15
                hess4fb(2) = 0.0_8
                temp1711b17 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1711b17 + fun0*der4fb(2)
                temp1711b18 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                  der4fb(2)
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1711b18 + &
&                  rmusin(1, 0)*temp1711b16
                temp1711b19 = cost3d*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                rmusinb(1, 0) = rmusinb(1, 0) + rmucos(2, 0)*temp1711b16&
&                  - 2*rmusin(1, 0)*temp1711b19
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1711b17
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1711b18
                rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*&
&                  temp1711b19
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1713 = fun0/cellscale(2)
                temp1714 = rmu(1, 0)*rmucos(1, 0)
                temp1714b = -(cost3d*4.d0*pi*hess4fb(2))
                temp1714b0 = rmucos(2, 0)*rmusin(2, 0)*temp1714b
                temp1713b = temp1714*temp1714b0/cellscale(2)
                temp1713b0 = temp1714*temp1713*temp1714b
                rmub(1, 0) = rmub(1, 0) + temp1713*rmucos(1, 0)*&
&                  temp1714b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1713*rmu(1, 0)*&
&                  temp1714b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1713b
                cellscaleb(2) = cellscaleb(2) - temp1713*temp1713b
                rmucosb(2, 0) = rmucosb(2, 0) + rmusin(2, 0)*temp1713b0
                hess4fb(2) = 0.0_8
                temp1713b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1713b1 + fun0*der4fb(2)
                temp1713b2 = cost3d*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
                rmusinb(2, 0) = rmusinb(2, 0) + rmucos(2, 0)*temp1713b0 &
&                  - 2*rmusin(2, 0)*temp1713b2
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1713b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1713b3 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                  der4fb(2)
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1713b3
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1713b3
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*&
&                  temp1713b2
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  hess4fb(2) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 11) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1715 = fun0/cellscale(2)
                temp1716 = rmu(3, 0)*rmucos(2, 0)
                temp1716b = -(cost3d*4.d0*pi*hess4fb(2))
                temp1716b0 = rmucos(3, 0)*rmusin(2, 0)*temp1716b
                temp1715b = temp1716*temp1716b0/cellscale(2)
                temp1715b0 = temp1716*temp1715*temp1716b
                rmub(3, 0) = rmub(3, 0) + temp1715*rmucos(2, 0)*&
&                  temp1716b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp1715*rmu(3, 0)*&
&                  temp1716b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1715b
                cellscaleb(2) = cellscaleb(2) - temp1715*temp1715b
                hess4fb(2) = 0.0_8
                temp1715b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1715b1 + fun0*der4fb(2)
                temp1715b2 = cost3d*(rmucos(2, 0)**2-rmusin(2, 0)**2)*&
&                  der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1715b2 + &
&                  rmusin(2, 0)*temp1715b0
                temp1715b3 = cost3d*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                rmusinb(2, 0) = rmusinb(2, 0) + rmucos(3, 0)*temp1715b0 &
&                  - 2*rmusin(2, 0)*temp1715b3
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1715b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1715b2
                rmucosb(2, 0) = rmucosb(2, 0) + 2*rmucos(2, 0)*&
&                  temp1715b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1717 = fun0/cellscale(3)
                temp1718 = rmu(2, 0)*rmucos(2, 0)
                temp1718b = -(cost3d*4.d0*pi*hess4fb(2))
                temp1718b0 = rmucos(3, 0)*rmusin(3, 0)*temp1718b
                temp1717b = temp1718*temp1718b0/cellscale(3)
                temp1717b0 = temp1718*temp1717*temp1718b
                rmub(2, 0) = rmub(2, 0) + temp1717*rmucos(2, 0)*&
&                  temp1718b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp1717*rmu(2, 0)*&
&                  temp1718b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1717b
                cellscaleb(3) = cellscaleb(3) - temp1717*temp1717b
                rmucosb(3, 0) = rmucosb(3, 0) + rmusin(3, 0)*temp1717b0
                hess4fb(2) = 0.0_8
                temp1717b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1717b1 + fun0*der4fb(2)
                temp1717b2 = cost3d*rmu(2, 0)*rmucos(2, 0)*der4fb(2)
                rmusinb(3, 0) = rmusinb(3, 0) + rmucos(3, 0)*temp1717b0 &
&                  - 2*rmusin(3, 0)*temp1717b2
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1717b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1717b3 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                  der4fb(2)
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1717b3
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1717b3
                rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*&
&                  temp1717b2
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1719 = fun0/cellscale(1)
                temp1720 = rmu(3, 0)*rmucos(1, 0)
                temp1720b = -(cost3d*4.d0*pi*hess4fb(2))
                temp1720b0 = rmucos(3, 0)*rmusin(1, 0)*temp1720b
                temp1719b = temp1720*temp1720b0/cellscale(1)
                temp1719b0 = temp1720*temp1719*temp1720b
                rmub(3, 0) = rmub(3, 0) + temp1719*rmucos(1, 0)*&
&                  temp1720b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1719*rmu(3, 0)*&
&                  temp1720b0
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1719b
                cellscaleb(1) = cellscaleb(1) - temp1719*temp1719b
                hess4fb(2) = 0.0_8
                temp1719b1 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1719b1 + fun0*der4fb(2)
                temp1719b2 = cost3d*(rmucos(1, 0)**2-rmusin(1, 0)**2)*&
&                  der4fb(2)
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1719b2 + &
&                  rmusin(1, 0)*temp1719b0
                temp1719b3 = cost3d*rmu(3, 0)*rmucos(3, 0)*der4fb(2)
                rmusinb(1, 0) = rmusinb(1, 0) + rmucos(3, 0)*temp1719b0 &
&                  - 2*rmusin(1, 0)*temp1719b3
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1719b1
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1719b2
                rmucosb(1, 0) = rmucosb(1, 0) + 2*rmucos(1, 0)*&
&                  temp1719b3
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              temp1721 = fun0/cellscale(3)
              temp1722 = rmu(1, 0)*rmucos(1, 0)
              temp1722b = -(cost3d*4.d0*pi*hess4fb(2))
              temp1722b0 = rmucos(3, 0)*rmusin(3, 0)*temp1722b
              temp1721b = temp1722*temp1722b0/cellscale(3)
              temp1721b0 = temp1722*temp1721*temp1722b
              rmub(1, 0) = rmub(1, 0) + temp1721*rmucos(1, 0)*temp1722b0
              rmucosb(1, 0) = rmucosb(1, 0) + temp1721*rmu(1, 0)*&
&                temp1722b0
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              fun0b = fun0b + der4f(2)*der4fb(2) + temp1721b
              cellscaleb(3) = cellscaleb(3) - temp1721*temp1721b
              rmucosb(3, 0) = rmucosb(3, 0) + rmusin(3, 0)*temp1721b0
              hess4fb(2) = 0.0_8
              temp1721b1 = 2.d0*rmu(i, 0)*hess4fb(3)
              der4fb(2) = fun*temp1721b1 + fun0*der4fb(2)
              temp1721b2 = cost3d*rmu(1, 0)*rmucos(1, 0)*der4fb(2)
              rmusinb(3, 0) = rmusinb(3, 0) + rmucos(3, 0)*temp1721b0 - &
&                2*rmusin(3, 0)*temp1721b2
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
              funb = funb + der4f(2)*temp1721b1
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              temp1721b3 = cost3d*(rmucos(3, 0)**2-rmusin(3, 0)**2)*&
&                der4fb(2)
              rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1721b3
              rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1721b3
              rmucosb(3, 0) = rmucosb(3, 0) + 2*rmucos(3, 0)*temp1721b2
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp1711b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp1711b
            funb = funb + rmu(i, 0)*temp1711b
            der4fb(1) = 0.0_8
          END DO
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp1710 = r(0)**2
        temp1709 = fun2/temp1710
        temp1709b = rmu(i, 0)**2*radhess4fb(i)/temp1710
        temp1708 = r(0)**2
        temp1707 = rmu(i, 0)**2/temp1708
        temp1707b = -(fun*radhess4fb(i)/temp1708)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp1707b + temp1709*2*rmu&
&          (i, 0)*radhess4fb(i)
        fun2b = fun2b + temp1709b
        rb(0) = rb(0) - temp1707*2*r(0)*temp1707b - temp1709*2*r(0)*&
&          temp1709b
        funb = funb + (1.d0-temp1707)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      temp1706 = r(0)**4
      temp1706b7 = distp(0, 1)*fun2b
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-2.d0)*funb - r(0&
&        )**2*fun0b + (10.d0*(dd1*r(0)**2)-4.d0*(dd1**2*temp1706)-2.d0)*&
&        fun2b
      temp1706b8 = distp(0, 1)*2.d0*funb
      dd1b = r(0)**2*temp1706b8 + (10.d0*r(0)**2-4.d0*temp1706*2*dd1)*&
&        temp1706b7
      rb(0) = rb(0) + dd1*2*r(0)*temp1706b8 - distp(0, 1)*2*r(0)*fun0b +&
&        (10.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp1706b7
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp1706b6 = -(r(k)**2*zb(indorbp, k))
          rb(k) = rb(k) - distp(k, 1)*distp(k, 1+ic)*2*r(k)*zb(indorbp, &
&            k)
          distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp1706b6
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp1706b6
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp1706b0 = cost3d*rmucos(1, i)*rmucos(3, i)*distpb(i, 6)
      temp1706b1 = cost3d*rmu(1, i)*rmu(3, i)*distpb(i, 6)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp1706b0
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp1706b0
      rmucosb(1, i) = rmucosb(1, i) + rmucos(3, i)*temp1706b1
      rmucosb(3, i) = rmucosb(3, i) + rmucos(1, i)*temp1706b1
      distpb(i, 6) = 0.0_8
      temp1706b2 = cost3d*rmucos(2, i)*rmucos(3, i)*distpb(i, 5)
      temp1706b3 = cost3d*rmu(2, i)*rmu(3, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp1706b2
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp1706b2
      rmucosb(2, i) = rmucosb(2, i) + rmucos(3, i)*temp1706b3
      rmucosb(3, i) = rmucosb(3, i) + rmucos(2, i)*temp1706b3
      distpb(i, 5) = 0.0_8
      temp1706b4 = cost3d*rmucos(1, i)*rmucos(2, i)*distpb(i, 4)
      temp1706b5 = cost3d*rmu(1, i)*rmu(2, i)*distpb(i, 4)
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp1706b4
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp1706b4
      rmucosb(1, i) = rmucosb(1, i) + rmucos(2, i)*temp1706b5
      rmucosb(2, i) = rmucosb(2, i) + rmucos(1, i)*temp1706b5
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rp0b = -(cost1d*distpb(i, 2))
      distpb(i, 2) = 0.0_8
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    DO k=0,0,-1
      temp1706b = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp1706b
      rb(k) = rb(k) - dd1*2*r(k)*temp1706b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indparp) = ddb(indparp) + dd1b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indparp) = -ddb(indparp)
  CASE (154)
! f single gaussian orbital
! radial R(r)= exp(-alpha r^2)
! unnormalized and NO PHASE (Jastrow orbital)
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
! radial part
    DO k=0,0
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(i)**2
      distp(i, 2) = cost1f*rmu(3, i)*rmucos(3, i)*(5.d0*rmu(3, i)**2-&
&        3.d0*rp0)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*rmucos(1, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 4) = cost2f*rmu(2, i)*rmucos(2, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 5) = cost3f*rmu(3, i)*rmucos(3, i)*(rmu(1, i)**2-rmu(2, i&
&        )**2)
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmucos(3, i)*rmu(1, i)*rmucos(&
&        1, i)*rmu(2, i)*rmucos(2, i)
      distp(i, 7) = cost4f*rmu(1, i)*rmucos(1, i)*(rmu(1, i)**2-3.d0*rmu&
&        (2, i)**2)
      distp(i, 8) = cost4f*rmu(2, i)*rmucos(2, i)*(3.d0*rmu(1, i)**2-rmu&
&        (2, i)**2)
    END DO
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F
    DO ic=1,7
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(0)**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,7
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part
! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(1, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(2, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 4.d0*cost1f*rmu(3, 0)**2*rmucos(3, 0)**2 + &
&                  cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  3.d0*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1f*fun0*(12.d0*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)-4.d0*pi**2/cellscale(3)**2*&
&                  rmu(3, 0)*rmucos(3, 0)*(5.d0*rmu(3, 0)**2-3.d0*rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)**2*rmucos(1, 0)**2) +&
&                  cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(1)&
&                  **2*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(2, 0)**2*rmucos(2, 0)**2) +&
&                  cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(2)&
&                  **2*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*(rmu(1, 0)&
&                  **2-rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4.d0*fun0*cost3f*pi/cellscale(3)*rmusin(3&
&                  , 0)*rmucos(3, 0)*(rmu(1, 0)**2-rmu(2, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(2, 0)&
&                  *rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(2, 0)*rmucos(2, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost4f*rmu(1, 0)**2*rmucos(1, 0)**2 + &
&                  cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*(rmu(1, 0)**2-3.d0*&
&                  rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0) - 4.d0*fun0*cost4f*pi**2/&
&                  cellscale(1)**2*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)**2-&
&                  3.d0*rmu(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                rmucos(2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(2.d0*&
&                rmucos(1, 0)**2-1.d0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = -(2.d0*cost4f*rmu(2, 0)**2*rmucos(2, 0)**2) + &
&                cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*(3.d0*rmu(1, 0)**2-&
&                rmu(2, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(&
&                2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*fun0*cost4f*pi**2/&
&                cellscale(2)**2*rmu(2, 0)*rmucos(2, 0)*(3.d0*rmu(1, 0)**&
&                2-rmu(2, 0)**2)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
!endif for ic
!enddo for i
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
!                     z_xyz(indorbp,i)=hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=7,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1769 = der4f(1)/cellscale(i)
            temp1769b1 = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp1769*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp1769b1
            cellscaleb(i) = cellscaleb(i) - temp1769*temp1769b1
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 12) THEN
              IF (branch .LT. 6) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    IF (branch .LT. 1) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp1730b0 = -(cost1f*6.d0*hess4fb(2))
                      temp1730b1 = (2.d0*rmucos(1, 0)**2-1.d0)*&
&                        temp1730b0
                      rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(1, 0)*temp1730b0
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp1730b1
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp1730b1
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp1730b1
                      hess4fb(2) = 0.0_8
                      temp1730b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp1730b2 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp1730b2
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp1730b3 = -(cost1f*6.d0*der4fb(2))
                      temp1730b4 = rmu(3, 0)*rmucos(3, 0)*temp1730b3
                      temp1730b5 = rmu(1, 0)*rmucos(1, 0)*temp1730b3
                      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1730b4
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp1730b4
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1730b5
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp1730b5
                      der4fb(2) = 0.0_8
                    ELSE
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp1730b6 = -(cost1f*6.d0*hess4fb(2))
                      temp1730b7 = (2.d0*rmucos(2, 0)**2-1.d0)*&
&                        temp1730b6
                      rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(2, 0)*temp1730b6
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp1730b7
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp1730b7
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp1730b7
                      hess4fb(2) = 0.0_8
                      temp1730b8 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp1730b8 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp1730b8
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp1730b9 = -(cost1f*6.d0*der4fb(2))
                      temp1730b10 = rmu(3, 0)*rmucos(3, 0)*temp1730b9
                      temp1730b11 = rmu(2, 0)*rmucos(2, 0)*temp1730b9
                      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1730b10
                      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                        temp1730b10
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1730b11
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp1730b11
                      der4fb(2) = 0.0_8
                    END IF
                  END IF
                ELSE IF (branch .LT. 5) THEN
                  IF (branch .LT. 4) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1736 = 5.d0*rmu(3, 0)**2 - 3.d0*rp0
                    temp1735 = cellscale(3)**2
                    temp1734 = rmu(3, 0)*rmucos(3, 0)
                    temp1730 = temp1734/temp1735
                    temp1733 = 4.d0*pi**2
                    temp1732 = 2.d0*rmucos(3, 0)**2 - 1.d0
                    temp1731 = rmu(3, 0)*rmucos(3, 0)
                    temp1732b = cost1f*fun0*hess4fb(2)
                    temp1731b = 12.d0*temp1732*temp1732b
                    temp1731b0 = -(temp1733*temp1732b)
                    temp1730b12 = temp1736*temp1731b0/temp1735
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + cost1f*(12.d0*(&
&                      temp1731*temp1732)-temp1733*(temp1730*temp1736))*&
&                      hess4fb(2)
                    rmub(3, 0) = rmub(3, 0) + temp1730*5.d0*2*rmu(3, 0)*&
&                      temp1731b0 + rmucos(3, 0)*temp1730b12 + rmucos(3, &
&                      0)*temp1731b
                    hess4fb(2) = 0.0_8
                    temp1730b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1730b13 + fun0*der4fb(2)
                    temp1730b14 = cost1f*4.d0*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp1730b14 + cost1f*(5.d0*rmu(3, 0)&
&                      **2-3.d0*rp0)*2.d0*2*rmucos(3, 0)*der4fb(2) + rmu(&
&                      3, 0)*temp1730b12 + 12.d0*temp1731*2.d0*2*rmucos(3&
&                      , 0)*temp1732b + rmu(3, 0)*temp1731b
                    cellscaleb(3) = cellscaleb(3) - temp1730*2*cellscale&
&                      (3)*temp1730b12
                    temp1730b15 = cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - 3.d0*temp1730b15 - temp1730*3.d0*&
&                      temp1731b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1730b13
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*&
&                      temp1730b15 + rmucos(3, 0)**2*2*rmu(3, 0)*&
&                      temp1730b14
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1741b = -(cost2f*6.d0*hess4fb(2))
                    temp1741b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp1741b
                    temp1740 = cellscale(1)**2
                    temp1737 = rmucos(1, 0)/temp1740
                    temp1739 = 5.d0*rmu(3, 0)**2 - rp0
                    temp1738 = fun0*rmu(1, 0)
                    temp1738b = -(pi**2*cost2f*4.d0*hess4fb(2))
                    temp1738b0 = temp1737*temp1738b
                    temp1737b = temp1738*temp1739*temp1738b/temp1740
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp1739*rmu(1&
&                      , 0)*temp1738b0 + rmucos(1, 0)*rmu(1, 0)*&
&                      temp1741b0
                    rmub(1, 0) = rmub(1, 0) + temp1739*fun0*temp1738b0 +&
&                      rmucos(1, 0)*fun0*temp1741b0
                    hess4fb(2) = 0.0_8
                    temp1737b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1737b0 + fun0*der4fb(2)
                    temp1737b1 = -(cost2f*2.d0*der4fb(2))
                    rmucosb(1, 0) = rmucosb(1, 0) + cost2f*(5.d0*rmu(3, &
&                      0)**2-rp0)*2.d0*2*rmucos(1, 0)*der4fb(2) + rmu(1, &
&                      0)**2*2*rmucos(1, 0)*temp1737b1 + temp1737b + fun0&
&                      *rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp1741b + fun0&
&                      *rmu(1, 0)*temp1741b0
                    rmub(3, 0) = rmub(3, 0) + temp1738*5.d0*2*rmu(3, 0)*&
&                      temp1738b0
                    temp1737b2 = cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - temp1737b2 - temp1738*temp1738b0
                    cellscaleb(1) = cellscaleb(1) - temp1737*2*cellscale&
&                      (1)*temp1737b
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1737b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*&
&                      temp1737b2
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0&
&                      )*temp1737b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1741b1 = -(cost2f*2.d0*hess4fb(2))
                  temp1741b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp1741b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp1741b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp1741b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp1741b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp1741b1
                  hess4fb(2) = 0.0_8
                  temp1741b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1741b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1741b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1741b4 = -(cost2f*2.d0*der4fb(2))
                  temp1741b5 = rmu(2, 0)*rmucos(2, 0)*temp1741b4
                  temp1741b6 = rmu(1, 0)*rmucos(1, 0)*temp1741b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1741b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1741b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1741b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1741b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 9) THEN
                IF (branch .LT. 8) THEN
                  IF (.NOT.branch .LT. 7) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1741b7 = cost2f*8.d0*hess4fb(2)
                    temp1741b8 = (2.d0*rmucos(3, 0)**2-1.d0)*temp1741b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*&
&                      rmu(1, 0)*temp1741b8
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*&
&                      temp1741b8
                    rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                      temp1741b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                      rmucos(1, 0)*2.d0*2*rmucos(3, 0)*temp1741b7
                    hess4fb(2) = 0.0_8
                    temp1741b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1741b9 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1741b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1741b10 = cost2f*8.d0*der4fb(2)
                    temp1741b11 = rmu(3, 0)*rmucos(3, 0)*temp1741b10
                    temp1741b12 = rmu(1, 0)*rmucos(1, 0)*temp1741b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1741b11
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                      temp1741b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1741b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                      temp1741b12
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1741b13 = -(cost2f*2.d0*hess4fb(2))
                  temp1741b14 = (2.d0*rmucos(1, 0)**2-1.d0)*temp1741b13
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(&
&                    2, 0)*temp1741b14
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*&
&                    temp1741b14
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*&
&                    temp1741b14
                  hess4fb(2) = 0.0_8
                  temp1741b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1741b15 + fun0*der4fb(2)
                  temp1741b16 = -(cost2f*2.d0*der4fb(2))
                  temp1741b17 = rmu(2, 0)*rmucos(2, 0)*temp1741b16
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1741b17 &
&                    + fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                    temp1741b13
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1741b15
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1741b18 = rmu(1, 0)*rmucos(1, 0)*temp1741b16
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1741b17
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1741b18
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1741b18
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 11) THEN
                IF (branch .LT. 10) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1745b = -(cost2f*6.d0*hess4fb(2))
                  temp1745b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp1745b
                  temp1744 = cellscale(2)**2
                  temp1741 = rmucos(2, 0)/temp1744
                  temp1743 = 5.d0*rmu(3, 0)**2 - rp0
                  temp1742 = fun0*rmu(2, 0)
                  temp1742b = -(pi**2*cost2f*4.d0*hess4fb(2))
                  temp1742b0 = temp1741*temp1742b
                  temp1741b19 = temp1742*temp1743*temp1742b/temp1744
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1743*rmu(2, 0&
&                    )*temp1742b0 + rmucos(2, 0)*rmu(2, 0)*temp1745b0
                  rmub(2, 0) = rmub(2, 0) + temp1743*fun0*temp1742b0 + &
&                    rmucos(2, 0)*fun0*temp1745b0
                  hess4fb(2) = 0.0_8
                  temp1741b20 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1741b20 + fun0*der4fb(2)
                  temp1741b21 = -(cost2f*2.d0*der4fb(2))
                  rmucosb(2, 0) = rmucosb(2, 0) + cost2f*(5.d0*rmu(3, 0)&
&                    **2-rp0)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2, 0)**&
&                    2*2*rmucos(2, 0)*temp1741b21 + temp1741b19 + fun0*&
&                    rmu(2, 0)*rmucos(2, 0)**2*2.d0*2*temp1745b + fun0*&
&                    rmu(2, 0)*temp1745b0
                  rmub(3, 0) = rmub(3, 0) + temp1742*5.d0*2*rmu(3, 0)*&
&                    temp1742b0
                  temp1741b22 = cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*&
&                    der4fb(2)
                  rp0b = rp0b - temp1741b22 - temp1742*temp1742b0
                  cellscaleb(2) = cellscaleb(2) - temp1741*2*cellscale(2&
&                    )*temp1741b19
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1741b20
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp1741b22
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                    temp1741b21
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1745b1 = cost2f*8.d0*hess4fb(2)
                temp1745b2 = (2.d0*rmucos(3, 0)**2-1.d0)*temp1745b1
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp1745b2
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp1745b2
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*&
&                  temp1745b2
                rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*rmucos(2&
&                  , 0)*2.d0*2*rmucos(3, 0)*temp1745b1
                hess4fb(2) = 0.0_8
                temp1745b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1745b3 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1745b3
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1745b4 = cost2f*8.d0*der4fb(2)
                temp1745b5 = rmu(3, 0)*rmucos(3, 0)*temp1745b4
                temp1745b6 = rmu(2, 0)*rmucos(2, 0)*temp1745b4
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1745b5
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1745b5
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1745b6
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1745b6
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 18) THEN
              IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  IF (branch .LT. 13) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1745b7 = cost3f*2.d0*hess4fb(2)
                    temp1745b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp1745b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp1745b8
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp1745b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp1745b8
                    hess4fb(2) = 0.0_8
                    temp1745b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1745b9 + fun0*der4fb(2)
                    temp1745b10 = cost3f*2.d0*der4fb(2)
                    temp1745b11 = rmu(3, 0)*rmucos(3, 0)*temp1745b10
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                      temp1745b11 + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*&
&                      rmucos(1, 0)*temp1745b7
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1745b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1745b12 = rmu(1, 0)*rmucos(1, 0)*temp1745b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1745b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1745b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                      temp1745b12
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1745b13 = -(cost3f*2.d0*hess4fb(2))
                    temp1745b14 = (2.d0*rmucos(2, 0)**2-1.d0)*&
&                      temp1745b13
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp1745b14
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp1745b14
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp1745b14
                    hess4fb(2) = 0.0_8
                    temp1745b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1745b15 + fun0*der4fb(2)
                    temp1745b16 = -(cost3f*2.d0*der4fb(2))
                    temp1745b17 = rmu(3, 0)*rmucos(3, 0)*temp1745b16
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                      temp1745b17 + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*&
&                      rmucos(2, 0)*temp1745b13
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1745b15
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1745b18 = rmu(2, 0)*rmucos(2, 0)*temp1745b16
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1745b17
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1745b18
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                      temp1745b18
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1745 = fun0/cellscale(3)
                  temp1746 = rmusin(3, 0)*rmucos(3, 0)
                  temp1746b = -(cost3f*4.d0*pi*hess4fb(2))
                  temp1746b0 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp1746b
                  temp1745b19 = temp1746*temp1746b0/cellscale(3)
                  temp1745b20 = temp1746*temp1745*temp1746b
                  rmusinb(3, 0) = rmusinb(3, 0) + temp1745*rmucos(3, 0)*&
&                    temp1746b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1745b19
                  hess4fb(2) = 0.0_8
                  temp1745b21 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1745b21 + fun0*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + cost3f*(rmu(1, 0)**2-&
&                    rmu(2, 0)**2)*2.d0*2*rmucos(3, 0)*der4fb(2) + &
&                    temp1745*rmusin(3, 0)*temp1746b0
                  cellscaleb(3) = cellscaleb(3) - temp1745*temp1745b19
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp1745b20
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp1745b20
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1745b21
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1745b22 = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*&
&                    der4fb(2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp1745b22
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp1745b22
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1749 = rmucos(3, 0)/cellscale(i)
                  temp1752 = rmusin(i, 0)*rmucos(i, 0)
                  temp1751 = rmucos(2, 0)*rmu(3, 0)
                  temp1750 = fun0*rmu(2, 0)
                  temp1750b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp1750b0 = temp1752*temp1749*temp1750b
                  temp1750b1 = temp1750*temp1751*temp1750b
                  temp1749b = temp1752*temp1750b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1751*rmu(2, 0&
&                    )*temp1750b0
                  rmub(2, 0) = rmub(2, 0) + temp1751*fun0*temp1750b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1750*rmu(3, 0)*&
&                    temp1750b0
                  rmub(3, 0) = rmub(3, 0) + temp1750*rmucos(2, 0)*&
&                    temp1750b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp1749*rmucos(i, 0)*&
&                    temp1750b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp1749*rmusin(i, 0)*&
&                    temp1750b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1749b
                  cellscaleb(i) = cellscaleb(i) - temp1749*temp1749b
                  hess4fb(2) = 0.0_8
                  temp1749b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1749b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1749b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1748 = rmu(3, 0)*rmucos(3, 0)
                  temp1747 = rmu(2, 0)*rmucos(2, 0)
                  temp1747b = cost3f*2.d0*der4fb(2)
                  temp1747b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp1747b
                  rmub(2, 0) = rmub(2, 0) + temp1748*rmucos(2, 0)*&
&                    temp1747b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1748*rmu(2, 0)*&
&                    temp1747b0
                  rmub(3, 0) = rmub(3, 0) + temp1747*rmucos(3, 0)*&
&                    temp1747b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1747*rmu(3, 0)*&
&                    temp1747b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp1747*temp1748*2.d0&
&                    *2*rmucos(i, 0)*temp1747b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1755 = rmucos(3, 0)/cellscale(i)
                  temp1758 = rmusin(i, 0)*rmucos(i, 0)
                  temp1757 = rmucos(1, 0)*rmu(3, 0)
                  temp1756 = fun0*rmu(1, 0)
                  temp1756b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp1756b0 = temp1758*temp1755*temp1756b
                  temp1756b1 = temp1756*temp1757*temp1756b
                  temp1755b = temp1758*temp1756b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1757*rmu(1, 0&
&                    )*temp1756b0
                  rmub(1, 0) = rmub(1, 0) + temp1757*fun0*temp1756b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1756*rmu(3, 0)*&
&                    temp1756b0
                  rmub(3, 0) = rmub(3, 0) + temp1756*rmucos(1, 0)*&
&                    temp1756b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp1755*rmucos(i, 0)*&
&                    temp1756b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp1755*rmusin(i, 0)*&
&                    temp1756b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1755b
                  cellscaleb(i) = cellscaleb(i) - temp1755*temp1755b
                  hess4fb(2) = 0.0_8
                  temp1755b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1755b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1755b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1754 = rmu(3, 0)*rmucos(3, 0)
                  temp1753 = rmu(1, 0)*rmucos(1, 0)
                  temp1753b = cost3f*2.d0*der4fb(2)
                  temp1753b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp1753b
                  rmub(1, 0) = rmub(1, 0) + temp1754*rmucos(1, 0)*&
&                    temp1753b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1754*rmu(1, 0)*&
&                    temp1753b0
                  rmub(3, 0) = rmub(3, 0) + temp1753*rmucos(3, 0)*&
&                    temp1753b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1753*rmu(3, 0)*&
&                    temp1753b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp1753*temp1754*2.d0&
&                    *2*rmucos(i, 0)*temp1753b
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1761 = rmucos(2, 0)/cellscale(i)
                temp1764 = rmusin(i, 0)*rmucos(i, 0)
                temp1763 = rmucos(1, 0)*rmu(2, 0)
                temp1762 = fun0*rmu(1, 0)
                temp1762b = -(cost3f*8.d0*pi*hess4fb(2))
                temp1762b0 = temp1764*temp1761*temp1762b
                temp1762b1 = temp1762*temp1763*temp1762b
                temp1761b = temp1764*temp1762b1/cellscale(i)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1763*rmu(1, 0)*&
&                  temp1762b0
                rmub(1, 0) = rmub(1, 0) + temp1763*fun0*temp1762b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1762*rmu(2, 0)*&
&                  temp1762b0
                rmub(2, 0) = rmub(2, 0) + temp1762*rmucos(1, 0)*&
&                  temp1762b0
                rmusinb(i, 0) = rmusinb(i, 0) + temp1761*rmucos(i, 0)*&
&                  temp1762b1
                rmucosb(i, 0) = rmucosb(i, 0) + temp1761*rmusin(i, 0)*&
&                  temp1762b1
                rmucosb(2, 0) = rmucosb(2, 0) + temp1761b
                cellscaleb(i) = cellscaleb(i) - temp1761*temp1761b
                hess4fb(2) = 0.0_8
                temp1761b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1761b0 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1761b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1760 = rmu(2, 0)*rmucos(2, 0)
                temp1759 = rmu(1, 0)*rmucos(1, 0)
                temp1759b = cost3f*2.d0*der4fb(2)
                temp1759b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp1759b
                rmub(1, 0) = rmub(1, 0) + temp1760*rmucos(1, 0)*&
&                  temp1759b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1760*rmu(1, 0)*&
&                  temp1759b0
                rmub(2, 0) = rmub(2, 0) + temp1759*rmucos(2, 0)*&
&                  temp1759b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp1759*rmu(2, 0)*&
&                  temp1759b0
                rmucosb(i, 0) = rmucosb(i, 0) + temp1759*temp1760*2.d0*2&
&                  *rmucos(i, 0)*temp1759b
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                IF (branch .LT. 19) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1767b = cost4f*6.d0*hess4fb(2)
                  temp1767b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp1767b
                  temp1766 = cellscale(1)**2
                  temp1765 = rmucos(1, 0)/temp1766
                  temp1766b = -(cost4f*4.d0*pi**2*hess4fb(2))
                  temp1766b0 = fun0*rmu(1, 0)*temp1765*temp1766b
                  temp1766b1 = (rmu(1, 0)**2-3.d0*rmu(2, 0)**2)*&
&                    temp1766b
                  temp1765b = fun0*rmu(1, 0)*temp1766b1/temp1766
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1765*rmu(1, 0&
&                    )*temp1766b1 + rmucos(1, 0)*rmu(1, 0)*temp1767b0
                  rmub(1, 0) = rmub(1, 0) + temp1765*fun0*temp1766b1 + 2&
&                    *rmu(1, 0)*temp1766b0 + rmucos(1, 0)*fun0*temp1767b0
                  hess4fb(2) = 0.0_8
                  temp1765b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1765b0 + fun0*der4fb(2)
                  temp1765b1 = cost4f*2.d0*der4fb(2)
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(&
&                    1, 0)*temp1765b1 + cost4f*(rmu(1, 0)**2-3.d0*rmu(2, &
&                    0)**2)*2.d0*2*rmucos(1, 0)*der4fb(2) + temp1765b + &
&                    fun0*rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp1767b + &
&                    fun0*rmu(1, 0)*temp1767b0
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp1766b0
                  cellscaleb(1) = cellscaleb(1) - temp1765*2*cellscale(1&
&                    )*temp1765b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1765b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1765b2 = cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*der4fb&
&                    (2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp1765b2 + &
&                    rmucos(1, 0)**2*2*rmu(1, 0)*temp1765b1
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp1765b2
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1767b1 = -(cost4f*6.d0*hess4fb(2))
                  temp1767b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp1767b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp1767b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp1767b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp1767b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp1767b1
                  hess4fb(2) = 0.0_8
                  temp1767b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1767b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1767b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1767b4 = -(cost4f*6.d0*der4fb(2))
                  temp1767b5 = rmu(2, 0)*rmucos(2, 0)*temp1767b4
                  temp1767b6 = rmu(1, 0)*rmucos(1, 0)*temp1767b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1767b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1767b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1767b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1767b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 23) THEN
              IF (branch .LT. 22) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1767b7 = cost4f*6.d0*hess4fb(2)
                temp1767b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp1767b7
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp1767b8
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp1767b8
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*&
&                  temp1767b8
                hess4fb(2) = 0.0_8
                temp1767b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1767b9 + fun0*der4fb(2)
                temp1767b10 = cost4f*6.d0*der4fb(2)
                temp1767b11 = rmu(2, 0)*rmucos(2, 0)*temp1767b10
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1767b11 + &
&                  fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                  temp1767b7
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1767b9
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1767b12 = rmu(1, 0)*rmucos(1, 0)*temp1767b10
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1767b11
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1767b12
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1767b12
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1769b = -(cost4f*6.d0*hess4fb(2))
                temp1769b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp1769b
                temp1768 = cellscale(2)**2
                temp1767 = rmucos(2, 0)/temp1768
                temp1768b = -(cost4f*4.d0*pi**2*hess4fb(2))
                temp1768b0 = fun0*rmu(2, 0)*temp1767*temp1768b
                temp1768b1 = (3.d0*rmu(1, 0)**2-rmu(2, 0)**2)*temp1768b
                temp1767b13 = fun0*rmu(2, 0)*temp1768b1/temp1768
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1767*rmu(2, 0)*&
&                  temp1768b1 + rmucos(2, 0)*rmu(2, 0)*temp1769b0
                rmub(2, 0) = rmub(2, 0) + temp1767*fun0*temp1768b1 - 2*&
&                  rmu(2, 0)*temp1768b0 + rmucos(2, 0)*fun0*temp1769b0
                hess4fb(2) = 0.0_8
                temp1767b14 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1767b14 + fun0*der4fb(2)
                temp1767b15 = -(cost4f*2.d0*der4fb(2))
                rmucosb(2, 0) = rmucosb(2, 0) + cost4f*(3.d0*rmu(1, 0)**&
&                  2-rmu(2, 0)**2)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2&
&                  , 0)**2*2*rmucos(2, 0)*temp1767b15 + temp1767b13 + &
&                  fun0*rmu(2, 0)*rmucos(2, 0)**2*2.d0*2*temp1769b + fun0&
&                  *rmu(2, 0)*temp1769b0
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp1768b0
                cellscaleb(2) = cellscaleb(2) - temp1767*2*cellscale(2)*&
&                  temp1767b13
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1767b14
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1767b16 = cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*der4fb(&
&                  2)
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp1767b16
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                  temp1767b15 - 2*rmu(2, 0)*temp1767b16
                der4fb(2) = 0.0_8
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4fb(2) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp1730b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp1730b
            funb = funb + rmu(i, 0)*temp1730b
            der4fb(1) = 0.0_8
          END DO
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp1729 = r(0)**2
        temp1728 = fun2/temp1729
        temp1728b = rmu(i, 0)**2*radhess4fb(i)/temp1729
        temp1727 = r(0)**2
        temp1726 = rmu(i, 0)**2/temp1727
        temp1726b4 = -(fun*radhess4fb(i)/temp1727)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp1726b4 + temp1728*2*&
&          rmu(i, 0)*radhess4fb(i)
        fun2b = fun2b + temp1728b
        rb(0) = rb(0) - temp1726*2*r(0)*temp1726b4 - temp1728*2*r(0)*&
&          temp1728b
        funb = funb + (1.d0-temp1726)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp1726b3 = -(fun*2.d0*fun2b)
      rb(0) = rb(0) + dd1*2*r(0)*temp1726b3 + 2*r(0)*rp0b
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp1726b3 - 2.d0*distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp1726b = cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp1726b0 = cost4f*rmu(2, i)*rmucos(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp1726b - 2*rmu(2, i)*&
&        temp1726b0
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp1726b
      distpb(i, 8) = 0.0_8
      temp1726b1 = cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*distpb(i, 7)
      temp1726b2 = cost4f*rmu(1, i)*rmucos(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp1726b1 + 2*rmu(1, i)*&
&        temp1726b2 + 3.d0*2*rmu(1, i)*temp1726b0
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp1726b1
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp1726b2
      distpb(i, 7) = 0.0_8
      temp1725 = rmu(1, i)*rmucos(1, i)
      temp1724 = rmu(3, i)*rmucos(3, i)
      temp1724b0 = cost3f*2.d0*distpb(i, 6)
      temp1724b1 = rmu(2, i)*rmucos(2, i)*temp1724b0
      temp1724b2 = temp1724*temp1725*temp1724b0
      rmub(3, i) = rmub(3, i) + temp1725*rmucos(3, i)*temp1724b1
      rmucosb(3, i) = rmucosb(3, i) + temp1725*rmu(3, i)*temp1724b1
      rmub(1, i) = rmub(1, i) + temp1724*rmucos(1, i)*temp1724b1
      rmucosb(1, i) = rmucosb(1, i) + temp1724*rmu(1, i)*temp1724b1
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp1724b2
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp1724b2
      distpb(i, 6) = 0.0_8
      temp1724b3 = cost3f*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      temp1724b4 = cost3f*rmu(3, i)*rmucos(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp1724b3
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp1724b3
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp1724b4
      distpb(i, 5) = 0.0_8
      temp1724b5 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp1724b5 - 2*rmu(2, i)*&
&        temp1724b4
      temp1724b6 = cost2f*rmu(2, i)*rmucos(2, i)*distpb(i, 4)
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp1724b5
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp1724b6
      distpb(i, 4) = 0.0_8
      temp1724b7 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 3)
      temp1724b8 = cost2f*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp1724b9 = cost1f*rmu(3, i)*rmucos(3, i)*distpb(i, 2)
      rp0b = -temp1724b8 - 3.d0*temp1724b9 - temp1724b6
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp1724b7
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp1724b7
      temp1724b10 = cost1f*(5.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 2)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp1724b10 + 5.d0*2*rmu(3&
&        , i)*temp1724b9 + 5.d0*2*rmu(3, i)*temp1724b8
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp1724b10
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    DO k=0,0,-1
      temp1724b = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp1724b
      rb(k) = rb(k) - dd1*2*r(k)*temp1724b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (155)
! f single gaussian orbital derivative of 154
! radial R(r)= -r^2*exp(-z r^2)
! unnormalized and NO PHASE (Jastrow orbital)
! orbital with the minimal power of rmucos
! metric set by boundary conditions
! general representation  X_i(x_i) where x_i are the plain cartesian coordinates
! X_i are the stretched coordinates for the radial part R
! general form of the orbital \Psi(x_i) = R(X_i(x_i)) A(x_i) \phi(x_i)
! R depends on X_i, A and the phase \phi depend on x_i
! gradient
! d/dx_k \Psi(x_i) = (d/dx_k F(X_i(x_i))) \phi(x_i) + F(X_i(x_i)) d/dx_k \phi(x_i)
! where  d/dx_k F(X_i(x_i)) = (d/dX_k R) A (d/dx_k X_i) (x_i) + R  (d/dY_k R) A (d/dx_k Y_i) (x_i)
! (d/dX_k R) (d/dY_k A)  are calculated as in makefun but evaluated at stretched coordinates X_k Y_k
!laplacian
! d^2/dx^2_k \Psi(x_i) = (d^2/dx^2_k F(X_i(x_i))) \phi(x_i)
!                      + 2.d0 (d/dx_k F(X_i(x_i)))  d/dx_k \phi(x_i)
!                      + F(X_i(x_i)) d^2/dx^2_k \phi(x_i)
! d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
! X_i = rmu
! d/dx_k X_i  =  rmucos
! d^2/dx^2_k X_i = - Pi/L * rmusin
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
! radial part
    DO k=0,0
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
! angular part
! rmu replaced by rmu*rmucos
    DO i=0,0
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(i)**2
      distp(i, 2) = cost1f*rmu(3, i)*rmucos(3, i)*(5.d0*rmu(3, i)**2-&
&        3.d0*rp0)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*rmucos(1, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 4) = cost2f*rmu(2, i)*rmucos(2, i)*(5.d0*rmu(3, i)**2-rp0&
&        )
      distp(i, 5) = cost3f*rmu(3, i)*rmucos(3, i)*(rmu(1, i)**2-rmu(2, i&
&        )**2)
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmucos(3, i)*rmu(1, i)*rmucos(&
&        1, i)*rmu(2, i)*rmucos(2, i)
      distp(i, 7) = cost4f*rmu(1, i)*rmucos(1, i)*(rmu(1, i)**2-3.d0*rmu&
&        (2, i)**2)
      distp(i, 8) = cost4f*rmu(2, i)*rmucos(2, i)*(3.d0*rmu(1, i)**2-rmu&
&        (2, i)**2)
    END DO
! definition of the orbital \Psi
! radial * angular * phase
! F = radial * angular
! compute \Psi = F
    DO ic=1,7
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
! calculate (d/dx_k F) and store them in z(indorbp,indt+k)
! calculate (d^2/dx^2_k F) and store them in hess4f(k,indorbp)
! d^2/dx^2_k R(x) = (fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2))
    IF (typec .NE. 1) THEN
! fun0 = radial
! fun = radial'/r
! fun2 = radial''
      fun0 = -(r(0)**2*distp(0, 1))
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+10.d0*dd1*r(0)**2-2.d0)
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp0)
      rp0 = r(0)**2
! compute:  fun2 * x^2_k/r^2 + fun * (1 - x^2_k/r^2) and store it in radhess4f
      DO i=1,3
        radhess4f(i) = fun2*rmu(i, 0)**2/r(0)**2 + fun*(1.d0-rmu(i, 0)**&
&          2/r(0)**2)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,7
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          DO i=1,3
            CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(1))
! derivatives of the radial part
! der4f(1) = (d/dx_k R) A
            der4f(1) = distp(0, 1+ic)*rmu(i, 0)*fun
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
! hess4f(1) = (d^2/dx^2_k R) A
            hess4f(1) = distp(0, 1+ic)*radhess4f(i)
! contribution of the angular part
! der4f(2) = R (d/dx_k A)
! hess4f(2) = R (d^2/dx^2_k A)
! hess4f(3) = (d/dx_k R) (d/dx_k A)
            IF (ic .EQ. 1) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(1, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost1f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost1f*(2.d0*rmucos(2, 0)**2-&
&                  1.d0)*rmu(3, 0)*rmucos(3, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 4.d0*cost1f*rmu(3, 0)**2*rmucos(3, 0)**2 + &
&                  cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  3.d0*rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = cost1f*fun0*(12.d0*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)-4.d0*pi**2/cellscale(3)**2*&
&                  rmu(3, 0)*rmucos(3, 0)*(5.d0*rmu(3, 0)**2-3.d0*rp0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              END IF
            ELSE IF (ic .EQ. 2) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)**2*rmucos(1, 0)**2) +&
&                  cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(1)&
&                  **2*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
              END IF
            ELSE IF (ic .EQ. 3) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost2f*rmu(2, 0)**2*rmucos(2, 0)**2) +&
&                  cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*(5.d0*rmu(3, 0)**2-&
&                  rp0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*pi**2/cellscale(2)&
&                  **2*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(5.d0*rmu(3, 0)&
&                  **2-rp0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
              ELSE IF (i .EQ. 3) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 8.d0*cost2f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 8.d0*fun0*cost2f*rmu(2, 0)*rmucos(2, 0)*(&
&                  2.d0*rmucos(3, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
              END IF
            ELSE IF (ic .EQ. 4) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0&
&                  )*rmucos(3, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(2.d0*fun0*cost3f*rmu(3, 0)*rmucos(3, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*(rmu(1, 0)&
&                  **2-rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(4.d0*fun0*cost3f*pi/cellscale(3)*rmusin(3&
&                  , 0)*rmucos(3, 0)*(rmu(1, 0)**2-rmu(2, 0)**2))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
              END IF
            ELSE IF (ic .EQ. 5) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(2, 0)*rmucos(2, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(2, 0)&
&                  *rmucos(2, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(3, 0)*&
&                  rmucos(3, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(3, 0)*rmucos(3, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost3f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                  rmucos(2, 0)*(2.d0*rmucos(i, 0)**2-1.d0)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(8.d0*cost3f*fun0*pi/cellscale(i)*rmu(1, 0)&
&                  *rmucos(1, 0)*rmu(2, 0)*rmucos(2, 0)*rmusin(i, 0)*&
&                  rmucos(i, 0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
              END IF
            ELSE IF (ic .EQ. 6) THEN
              IF (i .EQ. 1) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 2.d0*cost4f*rmu(1, 0)**2*rmucos(1, 0)**2 + &
&                  cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*(rmu(1, 0)**2-3.d0*&
&                  rmu(2, 0)**2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(1, 0)**2-1.d0) - 4.d0*fun0*cost4f*pi**2/&
&                  cellscale(1)**2*rmu(1, 0)*rmucos(1, 0)*(rmu(1, 0)**2-&
&                  3.d0*rmu(2, 0)**2)
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = -(6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0&
&                  )*rmucos(2, 0))
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = fun0*der4f(2)
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = -(6.d0*fun0*cost4f*rmu(1, 0)*rmucos(1, 0)*(&
&                  2.d0*rmucos(2, 0)**2-1.d0))
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              ELSE
                CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
                der4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4f(2) = 0.d0
                CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4f(3) = 0.d0
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              END IF
            ELSE IF (i .EQ. 1) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 6.d0*cost4f*rmu(1, 0)*rmucos(1, 0)*rmu(2, 0)*&
&                rmucos(2, 0)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(2.d0*&
&                rmucos(1, 0)**2-1.d0)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = -(2.d0*cost4f*rmu(2, 0)**2*rmucos(2, 0)**2) + &
&                cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*(3.d0*rmu(1, 0)**2-&
&                rmu(2, 0)**2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 2.d0*fun*rmu(i, 0)*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = fun0*der4f(2)
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = -(6.d0*fun0*cost4f*rmu(2, 0)*rmucos(2, 0)*(&
&                2.d0*rmucos(2, 0)**2-1.d0)) - 4.d0*fun0*cost4f*pi**2/&
&                cellscale(2)**2*rmu(2, 0)*rmucos(2, 0)*(3.d0*rmu(1, 0)**&
&                2-rmu(2, 0)**2)
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE
              CALL PUSHREAL8(adr8ibuf,adr8buf,der4f(2))
              der4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4f(2) = 0.d0
              CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4f(3) = 0.d0
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
            CALL PUSHREAL8(adr8ibuf,adr8buf,hess4f(1))
!endif for ic
!enddo for i
! gradient (without phase)
! compute (d/dX_k F) (X_i(x_i)) (d/dx_k X_i) (x_i)
!                      z(indorbp,indt+i)=der4f(1)*rmucos(i,0) &
!     &                                 +der4f(2)*(2.d0*rmucos(i,0)**2-1.d0)
! part of the laplacian (without phase)
! compute d^2/dx^2_k F(X_i) =  (d^2/dX^2_k R) A ((d/dx_k X_i) (x_i))^2
!                      + (d/dX_k R) (X_i(x_i)) A (d^2/dx^2_k X_i) (x_i)
!                      + R (d^2/dx^2_k A)
!                      + 2 (d/dX_k R)  (d/dx_k A) (d/dx_k X_i) (x_i)
!                      hess4f(1)=hess4f(1)*rmucos(i,0)**2  &
!     &                            -der4f(1)*PI/cellscale(i)*rmusin(i,0) &
!     &                            +hess4f(2)*(2.d0*rmucos(i,0)**2-1.d0)**2  &
!     &                            -der4f(2)*4.d0*PI/cellscale(i)*rmusin(i,0)*rmucos(i,0) &
!     &                            +hess4f(3)*rmucos(i,0)*(2.d0*rmucos(i,0)**2-1.d0)
            hess4f(1) = hess4f(1)*rmucos(i, 0)**2 - der4f(1)*pi/&
&              cellscale(i)*rmusin(i, 0) + hess4f(2) + hess4f(3)*rmucos(i&
&              , 0)
!                     z_xyz(indorbp,i)=hess4f(1)
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      hess4fb = 0.0_8
      der4fb = 0.0_8
      funb = 0.0_8
      rp0b = 0.0_8
      fun0b = 0.0_8
      radhess4fb = 0.0_8
      DO ic=7,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          DO i=3,1,-1
            hess4fb(1) = hess4fb(1) + zb(indorbp, indt+4)
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            temp1816 = der4f(1)/cellscale(i)
            temp1816b1 = -(pi*rmusin(i, 0)*hess4fb(1)/cellscale(i))
            rmucosb(i, 0) = rmucosb(i, 0) + der4f(1)*zb(indorbp, indt+i)&
&              + (hess4f(3)+hess4f(1)*2*rmucos(i, 0))*hess4fb(1)
            rmusinb(i, 0) = rmusinb(i, 0) - pi*temp1816*hess4fb(1)
            der4fb(1) = der4fb(1) + rmucos(i, 0)*zb(indorbp, indt+i) + &
&              temp1816b1
            cellscaleb(i) = cellscaleb(i) - temp1816*temp1816b1
            hess4fb(2) = hess4fb(2) + hess4fb(1)
            hess4fb(3) = hess4fb(3) + rmucos(i, 0)*hess4fb(1)
            hess4fb(1) = rmucos(i, 0)**2*hess4fb(1)
            der4fb(2) = der4fb(2) + zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.D0
            CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
            IF (branch .LT. 12) THEN
              IF (branch .LT. 6) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    IF (branch .LT. 1) THEN
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp1777b0 = -(cost1f*6.d0*hess4fb(2))
                      temp1777b1 = (2.d0*rmucos(1, 0)**2-1.d0)*&
&                        temp1777b0
                      rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(1, 0)*temp1777b0
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp1777b1
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp1777b1
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp1777b1
                      hess4fb(2) = 0.0_8
                      temp1777b2 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp1777b2 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp1777b2
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp1777b3 = -(cost1f*6.d0*der4fb(2))
                      temp1777b4 = rmu(3, 0)*rmucos(3, 0)*temp1777b3
                      temp1777b5 = rmu(1, 0)*rmucos(1, 0)*temp1777b3
                      rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1777b4
                      rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                        temp1777b4
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1777b5
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp1777b5
                      der4fb(2) = 0.0_8
                    ELSE
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                      temp1777b6 = -(cost1f*6.d0*hess4fb(2))
                      temp1777b7 = (2.d0*rmucos(2, 0)**2-1.d0)*&
&                        temp1777b6
                      rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(3, 0)*&
&                        rmucos(3, 0)*2.d0*2*rmucos(2, 0)*temp1777b6
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                        rmu(3, 0)*temp1777b7
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                        temp1777b7
                      rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                        temp1777b7
                      hess4fb(2) = 0.0_8
                      temp1777b8 = 2.d0*rmu(i, 0)*hess4fb(3)
                      der4fb(2) = fun*temp1777b8 + fun0*der4fb(2)
                      CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                      rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*&
&                        hess4fb(3)
                      funb = funb + der4f(2)*temp1777b8
                      hess4fb(3) = 0.0_8
                      CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                      temp1777b9 = -(cost1f*6.d0*der4fb(2))
                      temp1777b10 = rmu(3, 0)*rmucos(3, 0)*temp1777b9
                      temp1777b11 = rmu(2, 0)*rmucos(2, 0)*temp1777b9
                      rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1777b10
                      rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                        temp1777b10
                      rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1777b11
                      rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                        temp1777b11
                      der4fb(2) = 0.0_8
                    END IF
                  END IF
                ELSE IF (branch .LT. 5) THEN
                  IF (branch .LT. 4) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1783 = 5.d0*rmu(3, 0)**2 - 3.d0*rp0
                    temp1782 = cellscale(3)**2
                    temp1781 = rmu(3, 0)*rmucos(3, 0)
                    temp1777 = temp1781/temp1782
                    temp1780 = 4.d0*pi**2
                    temp1779 = 2.d0*rmucos(3, 0)**2 - 1.d0
                    temp1778 = rmu(3, 0)*rmucos(3, 0)
                    temp1779b = cost1f*fun0*hess4fb(2)
                    temp1778b = 12.d0*temp1779*temp1779b
                    temp1778b0 = -(temp1780*temp1779b)
                    temp1777b12 = temp1783*temp1778b0/temp1782
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + cost1f*(12.d0*(&
&                      temp1778*temp1779)-temp1780*(temp1777*temp1783))*&
&                      hess4fb(2)
                    rmub(3, 0) = rmub(3, 0) + temp1777*5.d0*2*rmu(3, 0)*&
&                      temp1778b0 + rmucos(3, 0)*temp1777b12 + rmucos(3, &
&                      0)*temp1778b
                    hess4fb(2) = 0.0_8
                    temp1777b13 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1777b13 + fun0*der4fb(2)
                    temp1777b14 = cost1f*4.d0*der4fb(2)
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)**2*2*&
&                      rmucos(3, 0)*temp1777b14 + cost1f*(5.d0*rmu(3, 0)&
&                      **2-3.d0*rp0)*2.d0*2*rmucos(3, 0)*der4fb(2) + rmu(&
&                      3, 0)*temp1777b12 + 12.d0*temp1778*2.d0*2*rmucos(3&
&                      , 0)*temp1779b + rmu(3, 0)*temp1778b
                    cellscaleb(3) = cellscaleb(3) - temp1777*2*cellscale&
&                      (3)*temp1777b12
                    temp1777b15 = cost1f*(2.d0*rmucos(3, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - 3.d0*temp1777b15 - temp1777*3.d0*&
&                      temp1778b0
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1777b13
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*&
&                      temp1777b15 + rmucos(3, 0)**2*2*rmu(3, 0)*&
&                      temp1777b14
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1788b = -(cost2f*6.d0*hess4fb(2))
                    temp1788b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp1788b
                    temp1787 = cellscale(1)**2
                    temp1784 = rmucos(1, 0)/temp1787
                    temp1786 = 5.d0*rmu(3, 0)**2 - rp0
                    temp1785 = fun0*rmu(1, 0)
                    temp1785b = -(pi**2*cost2f*4.d0*hess4fb(2))
                    temp1785b0 = temp1784*temp1785b
                    temp1784b = temp1785*temp1786*temp1785b/temp1787
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + temp1786*rmu(1&
&                      , 0)*temp1785b0 + rmucos(1, 0)*rmu(1, 0)*&
&                      temp1788b0
                    rmub(1, 0) = rmub(1, 0) + temp1786*fun0*temp1785b0 +&
&                      rmucos(1, 0)*fun0*temp1788b0
                    hess4fb(2) = 0.0_8
                    temp1784b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1784b0 + fun0*der4fb(2)
                    temp1784b1 = -(cost2f*2.d0*der4fb(2))
                    rmucosb(1, 0) = rmucosb(1, 0) + cost2f*(5.d0*rmu(3, &
&                      0)**2-rp0)*2.d0*2*rmucos(1, 0)*der4fb(2) + rmu(1, &
&                      0)**2*2*rmucos(1, 0)*temp1784b1 + temp1784b + fun0&
&                      *rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp1788b + fun0&
&                      *rmu(1, 0)*temp1788b0
                    rmub(3, 0) = rmub(3, 0) + temp1785*5.d0*2*rmu(3, 0)*&
&                      temp1785b0
                    temp1784b2 = cost2f*(2.d0*rmucos(1, 0)**2-1.d0)*&
&                      der4fb(2)
                    rp0b = rp0b - temp1784b2 - temp1785*temp1785b0
                    cellscaleb(1) = cellscaleb(1) - temp1784*2*cellscale&
&                      (1)*temp1784b
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1784b0
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*&
&                      temp1784b2
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)**2*2*rmu(1, 0&
&                      )*temp1784b1
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1788b1 = -(cost2f*2.d0*hess4fb(2))
                  temp1788b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp1788b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp1788b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp1788b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp1788b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp1788b1
                  hess4fb(2) = 0.0_8
                  temp1788b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1788b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1788b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1788b4 = -(cost2f*2.d0*der4fb(2))
                  temp1788b5 = rmu(2, 0)*rmucos(2, 0)*temp1788b4
                  temp1788b6 = rmu(1, 0)*rmucos(1, 0)*temp1788b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1788b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1788b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1788b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1788b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 9) THEN
                IF (branch .LT. 8) THEN
                  IF (.NOT.branch .LT. 7) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1788b7 = cost2f*8.d0*hess4fb(2)
                    temp1788b8 = (2.d0*rmucos(3, 0)**2-1.d0)*temp1788b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*&
&                      rmu(1, 0)*temp1788b8
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*&
&                      temp1788b8
                    rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                      temp1788b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(1, 0)*&
&                      rmucos(1, 0)*2.d0*2*rmucos(3, 0)*temp1788b7
                    hess4fb(2) = 0.0_8
                    temp1788b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1788b9 + fun0*der4fb(2)
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1788b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1788b10 = cost2f*8.d0*der4fb(2)
                    temp1788b11 = rmu(3, 0)*rmucos(3, 0)*temp1788b10
                    temp1788b12 = rmu(1, 0)*rmucos(1, 0)*temp1788b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1788b11
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                      temp1788b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1788b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                      temp1788b12
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1788b13 = -(cost2f*2.d0*hess4fb(2))
                  temp1788b14 = (2.d0*rmucos(1, 0)**2-1.d0)*temp1788b13
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(&
&                    2, 0)*temp1788b14
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*&
&                    temp1788b14
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*&
&                    temp1788b14
                  hess4fb(2) = 0.0_8
                  temp1788b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1788b15 + fun0*der4fb(2)
                  temp1788b16 = -(cost2f*2.d0*der4fb(2))
                  temp1788b17 = rmu(2, 0)*rmucos(2, 0)*temp1788b16
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1788b17 &
&                    + fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                    temp1788b13
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1788b15
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1788b18 = rmu(1, 0)*rmucos(1, 0)*temp1788b16
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1788b17
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1788b18
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1788b18
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 11) THEN
                IF (branch .LT. 10) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1792b = -(cost2f*6.d0*hess4fb(2))
                  temp1792b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp1792b
                  temp1791 = cellscale(2)**2
                  temp1788 = rmucos(2, 0)/temp1791
                  temp1790 = 5.d0*rmu(3, 0)**2 - rp0
                  temp1789 = fun0*rmu(2, 0)
                  temp1789b = -(pi**2*cost2f*4.d0*hess4fb(2))
                  temp1789b0 = temp1788*temp1789b
                  temp1788b19 = temp1789*temp1790*temp1789b/temp1791
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1790*rmu(2, 0&
&                    )*temp1789b0 + rmucos(2, 0)*rmu(2, 0)*temp1792b0
                  rmub(2, 0) = rmub(2, 0) + temp1790*fun0*temp1789b0 + &
&                    rmucos(2, 0)*fun0*temp1792b0
                  hess4fb(2) = 0.0_8
                  temp1788b20 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1788b20 + fun0*der4fb(2)
                  temp1788b21 = -(cost2f*2.d0*der4fb(2))
                  rmucosb(2, 0) = rmucosb(2, 0) + cost2f*(5.d0*rmu(3, 0)&
&                    **2-rp0)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2, 0)**&
&                    2*2*rmucos(2, 0)*temp1788b21 + temp1788b19 + fun0*&
&                    rmu(2, 0)*rmucos(2, 0)**2*2.d0*2*temp1792b + fun0*&
&                    rmu(2, 0)*temp1792b0
                  rmub(3, 0) = rmub(3, 0) + temp1789*5.d0*2*rmu(3, 0)*&
&                    temp1789b0
                  temp1788b22 = cost2f*(2.d0*rmucos(2, 0)**2-1.d0)*&
&                    der4fb(2)
                  rp0b = rp0b - temp1788b22 - temp1789*temp1789b0
                  cellscaleb(2) = cellscaleb(2) - temp1788*2*cellscale(2&
&                    )*temp1788b19
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1788b20
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp1788b22
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                    temp1788b21
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1792b1 = cost2f*8.d0*hess4fb(2)
                temp1792b2 = (2.d0*rmucos(3, 0)**2-1.d0)*temp1792b1
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp1792b2
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp1792b2
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*&
&                  temp1792b2
                rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(2, 0)*rmucos(2&
&                  , 0)*2.d0*2*rmucos(3, 0)*temp1792b1
                hess4fb(2) = 0.0_8
                temp1792b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1792b3 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1792b3
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1792b4 = cost2f*8.d0*der4fb(2)
                temp1792b5 = rmu(3, 0)*rmucos(3, 0)*temp1792b4
                temp1792b6 = rmu(2, 0)*rmucos(2, 0)*temp1792b4
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1792b5
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1792b5
                rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1792b6
                rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*temp1792b6
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 18) THEN
              IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  IF (branch .LT. 13) THEN
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1792b7 = cost3f*2.d0*hess4fb(2)
                    temp1792b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp1792b7
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp1792b8
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp1792b8
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp1792b8
                    hess4fb(2) = 0.0_8
                    temp1792b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1792b9 + fun0*der4fb(2)
                    temp1792b10 = cost3f*2.d0*der4fb(2)
                    temp1792b11 = rmu(3, 0)*rmucos(3, 0)*temp1792b10
                    rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*&
&                      temp1792b11 + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*&
&                      rmucos(1, 0)*temp1792b7
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1792b9
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1792b12 = rmu(1, 0)*rmucos(1, 0)*temp1792b10
                    rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1792b11
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1792b12
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                      temp1792b12
                    der4fb(2) = 0.0_8
                  ELSE
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                    temp1792b13 = -(cost3f*2.d0*hess4fb(2))
                    temp1792b14 = (2.d0*rmucos(2, 0)**2-1.d0)*&
&                      temp1792b13
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(3, 0)*&
&                      rmu(3, 0)*temp1792b14
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun0*&
&                      temp1792b14
                    rmucosb(3, 0) = rmucosb(3, 0) + fun0*rmu(3, 0)*&
&                      temp1792b14
                    hess4fb(2) = 0.0_8
                    temp1792b15 = 2.d0*rmu(i, 0)*hess4fb(3)
                    der4fb(2) = fun*temp1792b15 + fun0*der4fb(2)
                    temp1792b16 = -(cost3f*2.d0*der4fb(2))
                    temp1792b17 = rmu(3, 0)*rmucos(3, 0)*temp1792b16
                    rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*&
&                      temp1792b17 + fun0*rmu(3, 0)*rmucos(3, 0)*2.d0*2*&
&                      rmucos(2, 0)*temp1792b13
                    CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                    rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(&
&                      3)
                    funb = funb + der4f(2)*temp1792b15
                    hess4fb(3) = 0.0_8
                    CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                    temp1792b18 = rmu(2, 0)*rmucos(2, 0)*temp1792b16
                    rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1792b17
                    rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*temp1792b18
                    rmucosb(3, 0) = rmucosb(3, 0) + rmu(3, 0)*&
&                      temp1792b18
                    der4fb(2) = 0.0_8
                  END IF
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1792 = fun0/cellscale(3)
                  temp1793 = rmusin(3, 0)*rmucos(3, 0)
                  temp1793b = -(cost3f*4.d0*pi*hess4fb(2))
                  temp1793b0 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp1793b
                  temp1792b19 = temp1793*temp1793b0/cellscale(3)
                  temp1792b20 = temp1793*temp1792*temp1793b
                  rmusinb(3, 0) = rmusinb(3, 0) + temp1792*rmucos(3, 0)*&
&                    temp1793b0
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1792b19
                  hess4fb(2) = 0.0_8
                  temp1792b21 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1792b21 + fun0*der4fb(2)
                  rmucosb(3, 0) = rmucosb(3, 0) + cost3f*(rmu(1, 0)**2-&
&                    rmu(2, 0)**2)*2.d0*2*rmucos(3, 0)*der4fb(2) + &
&                    temp1792*rmusin(3, 0)*temp1793b0
                  cellscaleb(3) = cellscaleb(3) - temp1792*temp1792b19
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp1792b20
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp1792b20
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1792b21
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1792b22 = cost3f*(2.d0*rmucos(3, 0)**2-1.d0)*&
&                    der4fb(2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp1792b22
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp1792b22
                  der4fb(2) = 0.0_8
                END IF
              ELSE IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1796 = rmucos(3, 0)/cellscale(i)
                  temp1799 = rmusin(i, 0)*rmucos(i, 0)
                  temp1798 = rmucos(2, 0)*rmu(3, 0)
                  temp1797 = fun0*rmu(2, 0)
                  temp1797b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp1797b0 = temp1799*temp1796*temp1797b
                  temp1797b1 = temp1797*temp1798*temp1797b
                  temp1796b = temp1799*temp1797b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1798*rmu(2, 0&
&                    )*temp1797b0
                  rmub(2, 0) = rmub(2, 0) + temp1798*fun0*temp1797b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1797*rmu(3, 0)*&
&                    temp1797b0
                  rmub(3, 0) = rmub(3, 0) + temp1797*rmucos(2, 0)*&
&                    temp1797b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp1796*rmucos(i, 0)*&
&                    temp1797b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp1796*rmusin(i, 0)*&
&                    temp1797b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1796b
                  cellscaleb(i) = cellscaleb(i) - temp1796*temp1796b
                  hess4fb(2) = 0.0_8
                  temp1796b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1796b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1796b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1795 = rmu(3, 0)*rmucos(3, 0)
                  temp1794 = rmu(2, 0)*rmucos(2, 0)
                  temp1794b = cost3f*2.d0*der4fb(2)
                  temp1794b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp1794b
                  rmub(2, 0) = rmub(2, 0) + temp1795*rmucos(2, 0)*&
&                    temp1794b0
                  rmucosb(2, 0) = rmucosb(2, 0) + temp1795*rmu(2, 0)*&
&                    temp1794b0
                  rmub(3, 0) = rmub(3, 0) + temp1794*rmucos(3, 0)*&
&                    temp1794b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1794*rmu(3, 0)*&
&                    temp1794b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp1794*temp1795*2.d0&
&                    *2*rmucos(i, 0)*temp1794b
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1802 = rmucos(3, 0)/cellscale(i)
                  temp1805 = rmusin(i, 0)*rmucos(i, 0)
                  temp1804 = rmucos(1, 0)*rmu(3, 0)
                  temp1803 = fun0*rmu(1, 0)
                  temp1803b = -(cost3f*8.d0*pi*hess4fb(2))
                  temp1803b0 = temp1805*temp1802*temp1803b
                  temp1803b1 = temp1803*temp1804*temp1803b
                  temp1802b = temp1805*temp1803b1/cellscale(i)
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1804*rmu(1, 0&
&                    )*temp1803b0
                  rmub(1, 0) = rmub(1, 0) + temp1804*fun0*temp1803b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1803*rmu(3, 0)*&
&                    temp1803b0
                  rmub(3, 0) = rmub(3, 0) + temp1803*rmucos(1, 0)*&
&                    temp1803b0
                  rmusinb(i, 0) = rmusinb(i, 0) + temp1802*rmucos(i, 0)*&
&                    temp1803b1
                  rmucosb(i, 0) = rmucosb(i, 0) + temp1802*rmusin(i, 0)*&
&                    temp1803b1
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1802b
                  cellscaleb(i) = cellscaleb(i) - temp1802*temp1802b
                  hess4fb(2) = 0.0_8
                  temp1802b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1802b0 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1802b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1801 = rmu(3, 0)*rmucos(3, 0)
                  temp1800 = rmu(1, 0)*rmucos(1, 0)
                  temp1800b = cost3f*2.d0*der4fb(2)
                  temp1800b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp1800b
                  rmub(1, 0) = rmub(1, 0) + temp1801*rmucos(1, 0)*&
&                    temp1800b0
                  rmucosb(1, 0) = rmucosb(1, 0) + temp1801*rmu(1, 0)*&
&                    temp1800b0
                  rmub(3, 0) = rmub(3, 0) + temp1800*rmucos(3, 0)*&
&                    temp1800b0
                  rmucosb(3, 0) = rmucosb(3, 0) + temp1800*rmu(3, 0)*&
&                    temp1800b0
                  rmucosb(i, 0) = rmucosb(i, 0) + temp1800*temp1801*2.d0&
&                    *2*rmucos(i, 0)*temp1800b
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1808 = rmucos(2, 0)/cellscale(i)
                temp1811 = rmusin(i, 0)*rmucos(i, 0)
                temp1810 = rmucos(1, 0)*rmu(2, 0)
                temp1809 = fun0*rmu(1, 0)
                temp1809b = -(cost3f*8.d0*pi*hess4fb(2))
                temp1809b0 = temp1811*temp1808*temp1809b
                temp1809b1 = temp1809*temp1810*temp1809b
                temp1808b = temp1811*temp1809b1/cellscale(i)
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1810*rmu(1, 0)*&
&                  temp1809b0
                rmub(1, 0) = rmub(1, 0) + temp1810*fun0*temp1809b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1809*rmu(2, 0)*&
&                  temp1809b0
                rmub(2, 0) = rmub(2, 0) + temp1809*rmucos(1, 0)*&
&                  temp1809b0
                rmusinb(i, 0) = rmusinb(i, 0) + temp1808*rmucos(i, 0)*&
&                  temp1809b1
                rmucosb(i, 0) = rmucosb(i, 0) + temp1808*rmusin(i, 0)*&
&                  temp1809b1
                rmucosb(2, 0) = rmucosb(2, 0) + temp1808b
                cellscaleb(i) = cellscaleb(i) - temp1808*temp1808b
                hess4fb(2) = 0.0_8
                temp1808b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1808b0 + fun0*der4fb(2)
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1808b0
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1807 = rmu(2, 0)*rmucos(2, 0)
                temp1806 = rmu(1, 0)*rmucos(1, 0)
                temp1806b = cost3f*2.d0*der4fb(2)
                temp1806b0 = (2.d0*rmucos(i, 0)**2-1.d0)*temp1806b
                rmub(1, 0) = rmub(1, 0) + temp1807*rmucos(1, 0)*&
&                  temp1806b0
                rmucosb(1, 0) = rmucosb(1, 0) + temp1807*rmu(1, 0)*&
&                  temp1806b0
                rmub(2, 0) = rmub(2, 0) + temp1806*rmucos(2, 0)*&
&                  temp1806b0
                rmucosb(2, 0) = rmucosb(2, 0) + temp1806*rmu(2, 0)*&
&                  temp1806b0
                rmucosb(i, 0) = rmucosb(i, 0) + temp1806*temp1807*2.d0*2&
&                  *rmucos(i, 0)*temp1806b
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                IF (branch .LT. 19) THEN
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1814b = cost4f*6.d0*hess4fb(2)
                  temp1814b0 = (2.d0*rmucos(1, 0)**2-1.d0)*temp1814b
                  temp1813 = cellscale(1)**2
                  temp1812 = rmucos(1, 0)/temp1813
                  temp1813b = -(cost4f*4.d0*pi**2*hess4fb(2))
                  temp1813b0 = fun0*rmu(1, 0)*temp1812*temp1813b
                  temp1813b1 = (rmu(1, 0)**2-3.d0*rmu(2, 0)**2)*&
&                    temp1813b
                  temp1812b = fun0*rmu(1, 0)*temp1813b1/temp1813
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + temp1812*rmu(1, 0&
&                    )*temp1813b1 + rmucos(1, 0)*rmu(1, 0)*temp1814b0
                  rmub(1, 0) = rmub(1, 0) + temp1812*fun0*temp1813b1 + 2&
&                    *rmu(1, 0)*temp1813b0 + rmucos(1, 0)*fun0*temp1814b0
                  hess4fb(2) = 0.0_8
                  temp1812b0 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1812b0 + fun0*der4fb(2)
                  temp1812b1 = cost4f*2.d0*der4fb(2)
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)**2*2*rmucos(&
&                    1, 0)*temp1812b1 + cost4f*(rmu(1, 0)**2-3.d0*rmu(2, &
&                    0)**2)*2.d0*2*rmucos(1, 0)*der4fb(2) + temp1812b + &
&                    fun0*rmu(1, 0)*rmucos(1, 0)**2*2.d0*2*temp1814b + &
&                    fun0*rmu(1, 0)*temp1814b0
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp1813b0
                  cellscaleb(1) = cellscaleb(1) - temp1812*2*cellscale(1&
&                    )*temp1812b
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1812b0
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1812b2 = cost4f*(2.d0*rmucos(1, 0)**2-1.d0)*der4fb&
&                    (2)
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp1812b2 + &
&                    rmucos(1, 0)**2*2*rmu(1, 0)*temp1812b1
                  rmub(2, 0) = rmub(2, 0) - 3.d0*2*rmu(2, 0)*temp1812b2
                  der4fb(2) = 0.0_8
                ELSE
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                  temp1814b1 = -(cost4f*6.d0*hess4fb(2))
                  temp1814b2 = (2.d0*rmucos(2, 0)**2-1.d0)*temp1814b1
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(1, 0)*rmu(&
&                    1, 0)*temp1814b2
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun0*temp1814b2
                  rmucosb(1, 0) = rmucosb(1, 0) + fun0*rmu(1, 0)*&
&                    temp1814b2
                  rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(1, 0)*rmucos(&
&                    1, 0)*2.d0*2*rmucos(2, 0)*temp1814b1
                  hess4fb(2) = 0.0_8
                  temp1814b3 = 2.d0*rmu(i, 0)*hess4fb(3)
                  der4fb(2) = fun*temp1814b3 + fun0*der4fb(2)
                  CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                  funb = funb + der4f(2)*temp1814b3
                  hess4fb(3) = 0.0_8
                  CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                  temp1814b4 = -(cost4f*6.d0*der4fb(2))
                  temp1814b5 = rmu(2, 0)*rmucos(2, 0)*temp1814b4
                  temp1814b6 = rmu(1, 0)*rmucos(1, 0)*temp1814b4
                  rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1814b5
                  rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1814b5
                  rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1814b6
                  rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1814b6
                  der4fb(2) = 0.0_8
                END IF
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                hess4fb(2) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                der4fb(2) = 0.0_8
              END IF
            ELSE IF (branch .LT. 23) THEN
              IF (branch .LT. 22) THEN
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1814b7 = cost4f*6.d0*hess4fb(2)
                temp1814b8 = (2.d0*rmucos(1, 0)**2-1.d0)*temp1814b7
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + rmucos(2, 0)*rmu(2&
&                  , 0)*temp1814b8
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun0*temp1814b8
                rmucosb(2, 0) = rmucosb(2, 0) + fun0*rmu(2, 0)*&
&                  temp1814b8
                hess4fb(2) = 0.0_8
                temp1814b9 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1814b9 + fun0*der4fb(2)
                temp1814b10 = cost4f*6.d0*der4fb(2)
                temp1814b11 = rmu(2, 0)*rmucos(2, 0)*temp1814b10
                rmucosb(1, 0) = rmucosb(1, 0) + rmu(1, 0)*temp1814b11 + &
&                  fun0*rmu(2, 0)*rmucos(2, 0)*2.d0*2*rmucos(1, 0)*&
&                  temp1814b7
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1814b9
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1814b12 = rmu(1, 0)*rmucos(1, 0)*temp1814b10
                rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*temp1814b11
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*temp1814b12
                rmucosb(2, 0) = rmucosb(2, 0) + rmu(2, 0)*temp1814b12
                der4fb(2) = 0.0_8
              ELSE
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
                temp1816b = -(cost4f*6.d0*hess4fb(2))
                temp1816b0 = (2.d0*rmucos(2, 0)**2-1.d0)*temp1816b
                temp1815 = cellscale(2)**2
                temp1814 = rmucos(2, 0)/temp1815
                temp1815b = -(cost4f*4.d0*pi**2*hess4fb(2))
                temp1815b0 = fun0*rmu(2, 0)*temp1814*temp1815b
                temp1815b1 = (3.d0*rmu(1, 0)**2-rmu(2, 0)**2)*temp1815b
                temp1814b13 = fun0*rmu(2, 0)*temp1815b1/temp1815
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                fun0b = fun0b + der4f(2)*der4fb(2) + temp1814*rmu(2, 0)*&
&                  temp1815b1 + rmucos(2, 0)*rmu(2, 0)*temp1816b0
                rmub(2, 0) = rmub(2, 0) + temp1814*fun0*temp1815b1 - 2*&
&                  rmu(2, 0)*temp1815b0 + rmucos(2, 0)*fun0*temp1816b0
                hess4fb(2) = 0.0_8
                temp1814b14 = 2.d0*rmu(i, 0)*hess4fb(3)
                der4fb(2) = fun*temp1814b14 + fun0*der4fb(2)
                temp1814b15 = -(cost4f*2.d0*der4fb(2))
                rmucosb(2, 0) = rmucosb(2, 0) + cost4f*(3.d0*rmu(1, 0)**&
&                  2-rmu(2, 0)**2)*2.d0*2*rmucos(2, 0)*der4fb(2) + rmu(2&
&                  , 0)**2*2*rmucos(2, 0)*temp1814b15 + temp1814b13 + &
&                  fun0*rmu(2, 0)*rmucos(2, 0)**2*2.d0*2*temp1816b + fun0&
&                  *rmu(2, 0)*temp1816b0
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp1815b0
                cellscaleb(2) = cellscaleb(2) - temp1814*2*cellscale(2)*&
&                  temp1814b13
                CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
                rmub(i, 0) = rmub(i, 0) + 2.d0*fun*der4f(2)*hess4fb(3)
                funb = funb + der4f(2)*temp1814b14
                hess4fb(3) = 0.0_8
                CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
                temp1814b16 = cost4f*(2.d0*rmucos(2, 0)**2-1.d0)*der4fb(&
&                  2)
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp1814b16
                rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)**2*2*rmu(2, 0)*&
&                  temp1814b15 - 2*rmu(2, 0)*temp1814b16
                der4fb(2) = 0.0_8
              END IF
            ELSE
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(3))
              hess4fb(3) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,hess4f(2))
              hess4fb(2) = 0.0_8
              CALL POPREAL8(adr8ibuf,adr8buf,der4f(2))
              der4fb(2) = 0.0_8
            END IF
            CALL POPREAL8(adr8ibuf,adr8buf,hess4f(1))
            distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*der4fb(1) &
&              + radhess4f(i)*hess4fb(1)
            radhess4fb(i) = radhess4fb(i) + distp(0, 1+ic)*hess4fb(1)
            hess4fb(1) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,der4f(1))
            temp1777b = distp(0, 1+ic)*der4fb(1)
            rmub(i, 0) = rmub(i, 0) + fun*temp1777b
            funb = funb + rmu(i, 0)*temp1777b
            der4fb(1) = 0.0_8
          END DO
          zb(indorbp, indt+4) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      fun2b = 0.0_8
      DO i=3,1,-1
        temp1776 = r(0)**2
        temp1775 = fun2/temp1776
        temp1775b = rmu(i, 0)**2*radhess4fb(i)/temp1776
        temp1774 = r(0)**2
        temp1773 = rmu(i, 0)**2/temp1774
        temp1773b = -(fun*radhess4fb(i)/temp1774)
        rmub(i, 0) = rmub(i, 0) + 2*rmu(i, 0)*temp1773b + temp1775*2*rmu&
&          (i, 0)*radhess4fb(i)
        fun2b = fun2b + temp1775b
        rb(0) = rb(0) - temp1773*2*r(0)*temp1773b - temp1775*2*r(0)*&
&          temp1775b
        funb = funb + (1.d0-temp1773)*radhess4fb(i)
        radhess4fb(i) = 0.0_8
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      temp1772b4 = distp(0, 1)*fun2b
      temp1772b5 = distp(0, 1)*2.d0*funb
      rb(0) = rb(0) + (10.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*&
&        temp1772b4 - distp(0, 1)*2*r(0)*fun0b + dd1*2*r(0)*temp1772b5 + &
&        2*r(0)*rp0b
      temp1772 = r(0)**4
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-2.d0)*funb - r(0&
&        )**2*fun0b + (10.d0*(dd1*r(0)**2)-4.d0*(dd1**2*temp1772)-2.d0)*&
&        fun2b
      dd1b = r(0)**2*temp1772b5 + (10.d0*r(0)**2-4.d0*temp1772*2*dd1)*&
&        temp1772b4
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=0,0,-1
          temp1772b3 = -(r(k)**2*zb(indorbp, k))
          rb(k) = rb(k) - distp(k, 1)*distp(k, 1+ic)*2*r(k)*zb(indorbp, &
&            k)
          distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp1772b3
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp1772b3
          zb(indorbp, k) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=0,0,-1
      temp1772b = cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp1772b0 = cost4f*rmu(2, i)*rmucos(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp1772b - 2*rmu(2, i)*&
&        temp1772b0
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp1772b
      distpb(i, 8) = 0.0_8
      temp1772b1 = cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*distpb(i, 7)
      temp1772b2 = cost4f*rmu(1, i)*rmucos(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp1772b1 + 2*rmu(1, i)*&
&        temp1772b2 + 3.d0*2*rmu(1, i)*temp1772b0
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp1772b1
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp1772b2
      distpb(i, 7) = 0.0_8
      temp1771 = rmu(1, i)*rmucos(1, i)
      temp1770 = rmu(3, i)*rmucos(3, i)
      temp1770b0 = cost3f*2.d0*distpb(i, 6)
      temp1770b1 = rmu(2, i)*rmucos(2, i)*temp1770b0
      temp1770b2 = temp1770*temp1771*temp1770b0
      rmub(3, i) = rmub(3, i) + temp1771*rmucos(3, i)*temp1770b1
      rmucosb(3, i) = rmucosb(3, i) + temp1771*rmu(3, i)*temp1770b1
      rmub(1, i) = rmub(1, i) + temp1770*rmucos(1, i)*temp1770b1
      rmucosb(1, i) = rmucosb(1, i) + temp1770*rmu(1, i)*temp1770b1
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp1770b2
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp1770b2
      distpb(i, 6) = 0.0_8
      temp1770b3 = cost3f*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      temp1770b4 = cost3f*rmu(3, i)*rmucos(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp1770b3
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp1770b3
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp1770b4
      distpb(i, 5) = 0.0_8
      temp1770b5 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + rmucos(2, i)*temp1770b5 - 2*rmu(2, i)*&
&        temp1770b4
      temp1770b6 = cost2f*rmu(2, i)*rmucos(2, i)*distpb(i, 4)
      rmucosb(2, i) = rmucosb(2, i) + rmu(2, i)*temp1770b5
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp1770b6
      distpb(i, 4) = 0.0_8
      temp1770b7 = cost2f*(5.d0*rmu(3, i)**2-rp0)*distpb(i, 3)
      temp1770b8 = cost2f*rmu(1, i)*rmucos(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp1770b9 = cost1f*rmu(3, i)*rmucos(3, i)*distpb(i, 2)
      rp0b = -temp1770b8 - 3.d0*temp1770b9 - temp1770b6
      rmub(1, i) = rmub(1, i) + rmucos(1, i)*temp1770b7
      rmucosb(1, i) = rmucosb(1, i) + rmu(1, i)*temp1770b7
      temp1770b10 = cost1f*(5.d0*rmu(3, i)**2-3.d0*rp0)*distpb(i, 2)
      rmub(3, i) = rmub(3, i) + rmucos(3, i)*temp1770b10 + 5.d0*2*rmu(3&
&        , i)*temp1770b9 + 5.d0*2*rmu(3, i)*temp1770b8
      rmucosb(3, i) = rmucosb(3, i) + rmu(3, i)*temp1770b10
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp0)
      rb(i) = rb(i) + 2*r(i)*rp0b
    END DO
    DO k=0,0,-1
      temp1770b = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp1770b
      rb(k) = rb(k) - dd1*2*r(k)*temp1770b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (199)
!     LA COSTANTE
    indorbp = indorb + 1
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) zb(indorbp, indt+1:indt+4) = 0.D0
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    distpb = 0.0_8
  CASE (1000:1099)
!     s gaussian  r**(2*npower)*exp(-alpha*r**2)
    npower = iopt - 1000
    indorbp = indorb + 1
    indshellp = indshell + 1
    IF (dd(indpar+1) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indpar+1) = dd(indpar+1)
    ELSE
      dd(indpar+1) = -dd(indpar+1)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd2 = dd(indpar+1)
    DO k=0,0
      distp(k, 1) = r(k)**(2*npower)*DEXP(-(dd2*r(k)**2))
    END DO
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = -(dd2*distp(0, 1)*2.d0) + npower*distp(0, 1)*2.d0/rp1
      fun3 = -(dd2*fun*2.d0) + npower*fun*2.d0/rp1 - npower*distp(0, 1)*&
&        4.d0/rp1/rp1
      IF (iocc(indshellp) .EQ. 1) THEN
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2)
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp1819b2 = rmucos(:, 0)**2*hessb(:)
        fun3b = SUM(rmu(:, 0)**2*temp1819b2)
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1819b2
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*rmu(:, 0)**2&
&          *hessb(:)
        funb = rmucos(3, 0)*rmu(3, 0)*zb(indorbp, indt+3) + SUM((1.d0-&
&          2.d0*rmusin(:, 0)**2)*hessb(:))
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*hessb(:)
        rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun*zb(indorbp, indt+3)
        rmucosb(3, 0) = rmucosb(3, 0) + fun*rmu(3, 0)*zb(indorbp, indt+3&
&          )
        zb(indorbp, indt+3) = 0.D0
        funb = funb + rmucos(2, 0)*rmu(2, 0)*zb(indorbp, indt+2)
        rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun*zb(indorbp, indt+2)
        rmucosb(2, 0) = rmucosb(2, 0) + fun*rmu(2, 0)*zb(indorbp, indt+2&
&          )
        zb(indorbp, indt+2) = 0.D0
        funb = funb + rmucos(1, 0)*rmu(1, 0)*zb(indorbp, indt+1)
        rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun*zb(indorbp, indt+1)
        rmucosb(1, 0) = rmucosb(1, 0) + fun*rmu(1, 0)*zb(indorbp, indt+1&
&          )
        zb(indorbp, indt+1) = 0.D0
      ELSE
        funb = 0.0_8
        fun3b = 0.0_8
      END IF
      distpb = 0.0_8
      temp1819b = npower*2.d0*fun3b/rp1
      temp1819b0 = -(npower*4.d0*fun3b/rp1**2)
      funb = funb + temp1819b - 2.d0*dd2*fun3b
      temp1819b1 = npower*2.d0*funb/rp1
      rp1b = -(distp(0, 1)*temp1819b1/rp1) - distp(0, 1)*2*temp1819b0/&
&        rp1 - fun*temp1819b/rp1
      dd2b = -(2.d0*distp(0, 1)*funb) - 2.d0*fun*fun3b
      distpb(0, 1) = temp1819b1 - 2.d0*dd2*funb + temp1819b0
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    DO k=0,0,-1
      temp1818 = r(k)**2
      temp1817 = 2*npower
      temp1817b = r(k)**temp1817*DEXP(-(dd2*temp1818))*distpb(k, 1)
      IF (r(k) .LE. 0.0 .AND. (temp1817 .EQ. 0.0 .OR. temp1817 .NE. INT(&
&          temp1817))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp1817b
      ELSE
        rb(k) = rb(k) + DEXP(-(dd2*temp1818))*temp1817*r(k)**(temp1817-1&
&          )*distpb(k, 1) - dd2*2*r(k)*temp1817b
      END IF
      dd2b = dd2b - temp1818*temp1817b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indpar+1) = -ddb(indpar+1)
  CASE (2000:2099)
!     s gaussian  -r**(2*(npower+1))*exp(-alpha*r**2) derivative of 1000
    npower = iopt + 1 - 2000
    indorbp = indorb + 1
    indshellp = indshell + 1
    IF (dd(indpar+1) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indpar+1) = dd(indpar+1)
    ELSE
      dd(indpar+1) = -dd(indpar+1)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd2 = dd(indpar+1)
    DO k=0,0
      distp(k, 1) = -(r(k)**(2*npower)*DEXP(-(dd2*r(k)**2)))
    END DO
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      fun3 = fun*(npower-dd2*rp1)*2.d0/rp1 - 2.d0*dd2*distp(0, 1)*2.d0/&
&        rp1 - (npower-dd2*rp1)*distp(0, 1)*4.d0/rp1**2
      IF (iocc(indshellp) .EQ. 1) THEN
!********** DIAGONAL PART HESSIAN ******************
        hess(:) = fun3*rmu(:, 0)**2*rmucos(:, 0)**2 + fun*(1.d0-2.d0*&
&          rmusin(:, 0)**2)
!                z_xyz(indorbp,:)=hess(:)
        hessb = 0.0_8
        hessb(:) = zb(indorbp, indt+4)
        zb(indorbp, indt+4) = 0.D0
        temp1824b3 = rmucos(:, 0)**2*hessb(:)
        fun3b = SUM(rmu(:, 0)**2*temp1824b3)
        rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1824b3
        rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*rmu(:, 0)**2&
&          *hessb(:)
        funb = rmucos(3, 0)*rmu(3, 0)*zb(indorbp, indt+3) + SUM((1.d0-&
&          2.d0*rmusin(:, 0)**2)*hessb(:))
        rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*hessb(:)
        rmub(3, 0) = rmub(3, 0) + rmucos(3, 0)*fun*zb(indorbp, indt+3)
        rmucosb(3, 0) = rmucosb(3, 0) + fun*rmu(3, 0)*zb(indorbp, indt+3&
&          )
        zb(indorbp, indt+3) = 0.D0
        funb = funb + rmucos(2, 0)*rmu(2, 0)*zb(indorbp, indt+2)
        rmub(2, 0) = rmub(2, 0) + rmucos(2, 0)*fun*zb(indorbp, indt+2)
        rmucosb(2, 0) = rmucosb(2, 0) + fun*rmu(2, 0)*zb(indorbp, indt+2&
&          )
        zb(indorbp, indt+2) = 0.D0
        funb = funb + rmucos(1, 0)*rmu(1, 0)*zb(indorbp, indt+1)
        rmub(1, 0) = rmub(1, 0) + rmucos(1, 0)*fun*zb(indorbp, indt+1)
        rmucosb(1, 0) = rmucosb(1, 0) + fun*rmu(1, 0)*zb(indorbp, indt+1&
&          )
        zb(indorbp, indt+1) = 0.D0
      ELSE
        funb = 0.0_8
        fun3b = 0.0_8
      END IF
      distpb = 0.0_8
      temp1824b = 2.d0*fun*fun3b/rp1
      temp1824b0 = 2.d0*(npower-dd2*rp1)*fun3b/rp1
      temp1824b1 = -(2.d0**2*fun3b)
      temp1824b2 = distp(0, 1)*temp1824b1/rp1
      temp1823 = rp1**2
      temp1822 = distp(0, 1)/temp1823
      temp1823b = -(4.d0*temp1822*fun3b)
      temp1822b = -(4.d0*(npower-dd2*rp1)*fun3b/temp1823)
      funb = funb + temp1824b0
      temp1821 = distp(0, 1)/rp1
      temp1822b0 = 2.d0*temp1821*funb
      dd2b = temp1824b2 - rp1*temp1823b - rp1*temp1822b0 - rp1*temp1824b
      temp1821b = 2.d0*(npower-dd2*rp1)*funb/rp1
      rp1b = -(dd2*temp1822b0) - temp1821*temp1821b - temp1822*2*rp1*&
&        temp1822b - dd2*temp1823b - dd2*temp1824b2/rp1 - fun*temp1824b0/&
&        rp1 - dd2*temp1824b
      distpb(0, 1) = temp1821b + temp1822b + dd2*temp1824b1/rp1
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    DO k=0,0,-1
      temp1820 = r(k)**2
      temp1819 = 2*npower
      temp1819b3 = -(r(k)**temp1819*DEXP(-(dd2*temp1820))*distpb(k, 1))
      IF (r(k) .LE. 0.0 .AND. (temp1819 .EQ. 0.0 .OR. temp1819 .NE. INT(&
&          temp1819))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp1819b3
      ELSE
        rb(k) = rb(k) - dd2*2*r(k)*temp1819b3 - DEXP(-(dd2*temp1820))*&
&          temp1819*r(k)**(temp1819-1)*distpb(k, 1)
      END IF
      dd2b = dd2b - temp1820*temp1819b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indpar+1) = -ddb(indpar+1)
  CASE (1100:1199)
!     p gaussian  r**(2*npower)*exp(-alpha*r**2)
    npower = iopt - 1100
    indorbp = indorb
    IF (dd(indpar+1) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indpar+1) = dd(indpar+1)
    ELSE
      dd(indpar+1) = -dd(indpar+1)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd2 = dd(indpar+1)
    DO k=0,0
      distp(k, 1) = r(k)**(2*npower)*DEXP(-(dd2*r(k)**2))
    END DO
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      fun3 = fun*(npower-dd2*rp1)*2.d0/rp1 - 4.d0*(npower-dd2*rp1)*distp&
&        (0, 1)/rp1/rp1 - dd2*2.d0*distp(0, 1)*2.d0/rp1
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(1.d0-2.d0*rmusin(:, 0)**2))
          hess(ic) = hess(ic) + fun*(1.d0-2.d0*rmusin(ic, 0)**2)*rmu(ic&
&            , 0)*rmucos(ic, 0) + fun*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic&
&            , 0)*rmucos(ic, 0) - distp(0, 1)*4.d0*rmusin(ic, 0)*rmucos(&
&            ic, 0)*pi/cellscale(ic)
!                z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp1834 = fun*rmu(ic, 0)
          temp1835b = (1.d0-2.d0*rmusin(ic, 0)**2)*hessb(ic)
          temp1834b = rmucos(ic, 0)*temp1835b
          temp1833 = fun*rmu(ic, 0)
          temp1834b0 = (2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic)
          temp1833b = rmucos(ic, 0)*temp1834b0
          temp1832 = distp(0, 1)/cellscale(ic)
          temp1833b0 = -(pi*4.d0*hessb(ic))
          temp1833b1 = temp1832*temp1833b0
          temp1832b = rmusin(ic, 0)*rmucos(ic, 0)*temp1833b0/cellscale(&
&            ic)
          rmusinb(ic, 0) = rmusinb(ic, 0) + rmucos(ic, 0)*temp1833b1 - &
&            temp1834*rmucos(ic, 0)*2.d0*2*rmusin(ic, 0)*hessb(ic)
          temp1831 = -(2.d0*rmusin(:, 0)**2) + 1.d0
          temp1830 = rmucos(:, 0)**2
          temp1829 = rmu(:, 0)**2
          temp1829b1 = (fun3*temp1829*temp1830+fun*temp1831)*hessb(:)
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(ic, 0)*SUM(temp1829b1) +&
&            rmusin(ic, 0)*temp1833b1 + temp1833*temp1834b0 + 2.d0*&
&            temp1833*rmucos(ic, 0)**2*2*hessb(ic) + temp1834*temp1835b
          distpb(0, 1) = distpb(0, 1) + (2.d0*rmucos(ic, 0)**2-1.d0)*zb(&
&            indorbp, indt+ic) + temp1832b
          temp1829b2 = rmu(ic, 0)*rmucos(ic, 0)*hessb(:)
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp1829*&
&            temp1829b2
          temp1829b3 = rmucos(3, 0)*rmu(ic, 0)*zb(indorbp, indt+3)
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(3, 0)*fun*temp1829b3 + &
&            distp(0, 1)*2.d0*2*rmucos(ic, 0)*zb(indorbp, indt+ic)
          temp1829b4 = rmucos(ic, 0)*temp1829b3
          temp1829b5 = rmu(3, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+3)
          zb(indorbp, indt+3) = 0.D0
          temp1829b6 = rmucos(2, 0)*rmu(ic, 0)*zb(indorbp, indt+2)
          temp1829b7 = rmucos(ic, 0)*temp1829b6
          temp1829b8 = rmu(2, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+2)
          zb(indorbp, indt+2) = 0.D0
          temp1829b9 = rmucos(1, 0)*rmu(ic, 0)*zb(indorbp, indt+1)
          temp1829b10 = rmucos(ic, 0)*temp1829b9
          funb = funb + SUM(temp1831*temp1829b2) + rmu(2, 0)*temp1829b7 &
&            + rmu(1, 0)*temp1829b10 + rmu(3, 0)*temp1829b4 + rmu(ic, 0)*&
&            temp1833b + rmu(ic, 0)*temp1834b
          rmub(ic, 0) = rmub(ic, 0) + rmucos(ic, 0)*SUM(temp1829b1) + &
&            fun*temp1833b + fun*temp1834b
          cellscaleb(ic) = cellscaleb(ic) - temp1832*temp1832b
          fun3b = fun3b + SUM(temp1829*temp1830*temp1829b2)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1830*temp1829b2
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&            temp1829b2
          rmub(3, 0) = rmub(3, 0) + fun*temp1829b4
          rmucosb(3, 0) = rmucosb(3, 0) + rmu(ic, 0)*temp1829b5
          rmub(ic, 0) = rmub(ic, 0) + rmucos(3, 0)*temp1829b5
          rmub(2, 0) = rmub(2, 0) + fun*temp1829b7
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(2, 0)*fun*temp1829b6
          rmucosb(2, 0) = rmucosb(2, 0) + rmu(ic, 0)*temp1829b8
          rmub(ic, 0) = rmub(ic, 0) + rmucos(2, 0)*temp1829b8
          temp1829b11 = rmu(1, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+1)
          rmub(1, 0) = rmub(1, 0) + fun*temp1829b10
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(1, 0)*fun*temp1829b9
          rmucosb(1, 0) = rmucosb(1, 0) + rmu(ic, 0)*temp1829b11
          rmub(ic, 0) = rmub(ic, 0) + rmucos(1, 0)*temp1829b11
          zb(indorbp, indt+1) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      temp1829b = 2.d0*fun*fun3b/rp1
      temp1829b0 = 2.d0*(npower-dd2*rp1)*fun3b/rp1
      temp1828 = rp1**2
      temp1827 = distp(0, 1)/temp1828
      temp1828b = -(4.d0*temp1827*fun3b)
      temp1827b = -(4.d0*(npower-dd2*rp1)*fun3b/temp1828)
      temp1827b0 = -(2.d0**2*fun3b)
      temp1827b1 = distp(0, 1)*temp1827b0/rp1
      funb = funb + temp1829b0
      temp1826 = distp(0, 1)/rp1
      temp1827b2 = 2.d0*temp1826*funb
      dd2b = temp1827b1 - rp1*temp1827b2 - rp1*temp1828b - rp1*temp1829b
      temp1826b0 = 2.d0*(npower-dd2*rp1)*funb/rp1
      rp1b = -(dd2*temp1827b2) - temp1826*temp1826b0 - dd2*temp1827b1/&
&        rp1 - temp1827*2*rp1*temp1827b - dd2*temp1828b - fun*temp1829b0/&
&        rp1 - dd2*temp1829b
      distpb(0, 1) = distpb(0, 1) + temp1826b0 + dd2*temp1827b0/rp1 + &
&        temp1827b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          temp1826b = rmucos(ic, i)*zb(indorbp, i)
          rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp1826b
          distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp1826b
          rmucosb(ic, i) = rmucosb(ic, i) + rmu(ic, i)*distp(i, 1)*zb(&
&            indorbp, i)
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO k=0,0,-1
      temp1825 = r(k)**2
      temp1824 = 2*npower
      temp1824b4 = r(k)**temp1824*DEXP(-(dd2*temp1825))*distpb(k, 1)
      IF (r(k) .LE. 0.0 .AND. (temp1824 .EQ. 0.0 .OR. temp1824 .NE. INT(&
&          temp1824))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp1824b4
      ELSE
        rb(k) = rb(k) + DEXP(-(dd2*temp1825))*temp1824*r(k)**(temp1824-1&
&          )*distpb(k, 1) - dd2*2*r(k)*temp1824b4
      END IF
      dd2b = dd2b - temp1825*temp1824b4
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indpar+1) = -ddb(indpar+1)
  CASE (2100:2199)
!     p gaussian  -r**(2*(npower+1))*exp(-alpha*r**2) derivative 1100
    npower = iopt + 1 - 2100
    indorbp = indorb
    IF (dd(indpar+1) .GE. 0.) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      dd(indpar+1) = dd(indpar+1)
    ELSE
      dd(indpar+1) = -dd(indpar+1)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    END IF
    dd2 = dd(indpar+1)
    DO k=0,0
      distp(k, 1) = -(r(k)**(2*npower)*DEXP(-(dd2*r(k)**2)))
    END DO
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      fun3 = (npower-dd2*rp1)*fun*2.d0/rp1 - 2.d0*dd2*distp(0, 1)*2.d0/&
&        rp1 - 2.d0*(npower-dd2*rp1)*distp(0, 1)*2.d0/rp1/rp1
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb
      DO ic=1,3
        IF (iocc(indshell+ic) .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
          indorbp = indorbp + 1
          hess(:) = rmu(ic, 0)*rmucos(ic, 0)*(fun3*rmu(:, 0)**2*rmucos(:&
&            , 0)**2+fun*(1.d0-2.d0*rmusin(:, 0)**2))
          hess(ic) = hess(ic) + fun*(1.d0-2.d0*rmusin(ic, 0)**2)*rmu(ic&
&            , 0)*rmucos(ic, 0) + fun*(2.d0*rmucos(ic, 0)**2-1.d0)*rmu(ic&
&            , 0)*rmucos(ic, 0) - distp(0, 1)*4.d0*rmusin(ic, 0)*rmucos(&
&            ic, 0)*pi/cellscale(ic)
!                z_xyz(indorbp,:)=hess(:)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        END IF
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun3b = 0.0_8
      DO ic=3,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (.NOT.branch .LT. 2) THEN
          hessb = 0.0_8
          hessb(:) = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.D0
          temp1845 = fun*rmu(ic, 0)
          temp1846b = (1.d0-2.d0*rmusin(ic, 0)**2)*hessb(ic)
          temp1845b = rmucos(ic, 0)*temp1846b
          temp1844 = fun*rmu(ic, 0)
          temp1845b0 = (2.d0*rmucos(ic, 0)**2-1.d0)*hessb(ic)
          temp1844b = rmucos(ic, 0)*temp1845b0
          temp1843 = distp(0, 1)/cellscale(ic)
          temp1844b0 = -(pi*4.d0*hessb(ic))
          temp1844b1 = temp1843*temp1844b0
          temp1843b = rmusin(ic, 0)*rmucos(ic, 0)*temp1844b0/cellscale(&
&            ic)
          rmusinb(ic, 0) = rmusinb(ic, 0) + rmucos(ic, 0)*temp1844b1 - &
&            temp1845*rmucos(ic, 0)*2.d0*2*rmusin(ic, 0)*hessb(ic)
          temp1842 = -(2.d0*rmusin(:, 0)**2) + 1.d0
          temp1841 = rmucos(:, 0)**2
          temp1840 = rmu(:, 0)**2
          temp1840b3 = (fun3*temp1840*temp1841+fun*temp1842)*hessb(:)
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(ic, 0)*SUM(temp1840b3) +&
&            rmusin(ic, 0)*temp1844b1 + temp1844*temp1845b0 + 2.d0*&
&            temp1844*rmucos(ic, 0)**2*2*hessb(ic) + temp1845*temp1846b
          distpb(0, 1) = distpb(0, 1) + (2.d0*rmucos(ic, 0)**2-1.d0)*zb(&
&            indorbp, indt+ic) + temp1843b
          temp1840b4 = rmu(ic, 0)*rmucos(ic, 0)*hessb(:)
          rmucosb(:, 0) = rmucosb(:, 0) + 2*rmucos(:, 0)*fun3*temp1840*&
&            temp1840b4
          temp1840b5 = rmucos(3, 0)*rmu(ic, 0)*zb(indorbp, indt+3)
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(3, 0)*fun*temp1840b5 + &
&            distp(0, 1)*2.d0*2*rmucos(ic, 0)*zb(indorbp, indt+ic)
          temp1840b6 = rmucos(ic, 0)*temp1840b5
          temp1840b7 = rmu(3, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+3)
          zb(indorbp, indt+3) = 0.D0
          temp1840b8 = rmucos(2, 0)*rmu(ic, 0)*zb(indorbp, indt+2)
          temp1840b9 = rmucos(ic, 0)*temp1840b8
          temp1840b10 = rmu(2, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+2)
          zb(indorbp, indt+2) = 0.D0
          temp1840b11 = rmucos(1, 0)*rmu(ic, 0)*zb(indorbp, indt+1)
          temp1840b12 = rmucos(ic, 0)*temp1840b11
          funb = funb + SUM(temp1842*temp1840b4) + rmu(2, 0)*temp1840b9 &
&            + rmu(1, 0)*temp1840b12 + rmu(3, 0)*temp1840b6 + rmu(ic, 0)*&
&            temp1844b + rmu(ic, 0)*temp1845b
          rmub(ic, 0) = rmub(ic, 0) + rmucos(ic, 0)*SUM(temp1840b3) + &
&            fun*temp1844b + fun*temp1845b
          cellscaleb(ic) = cellscaleb(ic) - temp1843*temp1843b
          fun3b = fun3b + SUM(temp1840*temp1841*temp1840b4)
          rmub(:, 0) = rmub(:, 0) + 2*rmu(:, 0)*fun3*temp1841*temp1840b4
          rmusinb(:, 0) = rmusinb(:, 0) - 2*rmusin(:, 0)*2.d0*fun*&
&            temp1840b4
          rmub(3, 0) = rmub(3, 0) + fun*temp1840b6
          rmucosb(3, 0) = rmucosb(3, 0) + rmu(ic, 0)*temp1840b7
          rmub(ic, 0) = rmub(ic, 0) + rmucos(3, 0)*temp1840b7
          rmub(2, 0) = rmub(2, 0) + fun*temp1840b9
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(2, 0)*fun*temp1840b8
          rmucosb(2, 0) = rmucosb(2, 0) + rmu(ic, 0)*temp1840b10
          rmub(ic, 0) = rmub(ic, 0) + rmucos(2, 0)*temp1840b10
          temp1840b13 = rmu(1, 0)*fun*rmucos(ic, 0)*zb(indorbp, indt+1)
          rmub(1, 0) = rmub(1, 0) + fun*temp1840b12
          rmucosb(ic, 0) = rmucosb(ic, 0) + rmu(1, 0)*fun*temp1840b11
          rmucosb(1, 0) = rmucosb(1, 0) + rmu(ic, 0)*temp1840b13
          rmub(ic, 0) = rmub(ic, 0) + rmucos(1, 0)*temp1840b13
          zb(indorbp, indt+1) = 0.D0
          CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        END IF
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      temp1840b = 2.d0*fun*fun3b/rp1
      temp1840b0 = 2.d0*(npower-dd2*rp1)*fun3b/rp1
      temp1840b1 = -(2.d0**2*fun3b)
      temp1840b2 = distp(0, 1)*temp1840b1/rp1
      temp1839 = rp1**2
      temp1838 = distp(0, 1)/temp1839
      temp1839b = -(2.d0**2*fun3b)
      temp1838b = (npower-dd2*rp1)*temp1839b/temp1839
      funb = funb + temp1840b0
      temp1837 = distp(0, 1)/rp1
      temp1838b0 = 2.d0*temp1837*funb
      dd2b = temp1840b2 - temp1838*rp1*temp1839b - rp1*temp1838b0 - rp1*&
&        temp1840b
      temp1837b = 2.d0*(npower-dd2*rp1)*funb/rp1
      rp1b = -(dd2*temp1838b0) - temp1837*temp1837b - temp1838*2*rp1*&
&        temp1838b - temp1838*dd2*temp1839b - dd2*temp1840b2/rp1 - fun*&
&        temp1840b0/rp1 - dd2*temp1840b
      distpb(0, 1) = distpb(0, 1) + temp1837b + temp1838b + dd2*&
&        temp1840b1/rp1
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=0,0,-1
          rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
          distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
          zb(indorbp, i) = 0.D0
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO k=0,0,-1
      temp1836 = r(k)**2
      temp1835 = 2*npower
      temp1835b0 = -(r(k)**temp1835*DEXP(-(dd2*temp1836))*distpb(k, 1))
      IF (r(k) .LE. 0.0 .AND. (temp1835 .EQ. 0.0 .OR. temp1835 .NE. INT(&
&          temp1835))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp1835b0
      ELSE
        rb(k) = rb(k) - dd2*2*r(k)*temp1835b0 - DEXP(-(dd2*temp1836))*&
&          temp1835*r(k)**(temp1835-1)*distpb(k, 1)
      END IF
      dd2b = dd2b - temp1836*temp1835b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) ddb(indpar+1) = -ddb(indpar+1)
  CASE (200)
! derivative of 199 LA COSTANTE
    indorbp = indorb + 1
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) zb(indorbp, indt+1:indt+4) = 0.D0
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=0,0,-1
        zb(indorbp, i) = 0.D0
      END DO
    END IF
    distpb = 0.0_8
  CASE DEFAULT
    distpb = 0.0_8
  END SELECT
END SUBROUTINE makefun0_pbc_b