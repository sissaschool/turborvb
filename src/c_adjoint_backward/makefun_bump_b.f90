!TL off
!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.3 (r3163) - 09/25/2009 09:03
!
!  Differentiation of makefun_bump in reverse (adjoint) mode:
!   gradient, with respect to input variables: dd r z rmu distp
!   of linear combination of output variables: dd r z rmu
SUBROUTINE MAKEFUN_BUMP_B(iopt, iocc, indt, i0, indtmin, indtm, typec, &
&  indpar, indorb, indshell, nelskip, z, zb, dd, ddb, r, rb, rmu, rmub, &
&  distp, distpb, iflagnorm_fake, c)
  USE CONSTANTS
  IMPLICIT NONE
! TAPENADE adBuffer vars
  integer :: adi4ibuf,adr8ibuf,adi4buf(1024)
  real*8  :: adr8buf(1024)
! ---
! user-defined cutoff for bump orbitals (see file bump_orbitals_new.f90)
  INTEGER :: iopt, indt, i, k, nelskip, indpar, iocc(*), indorbp, indorb&
&  , indshell, indshellp, ic, indtmin, i0, iflagnorm_fake, indparp, indtm&
&  , npower, typec
  REAL*8 :: z(nelskip, i0:*), dd(*), rmu(3, 0:indtm), r(0:indtm), distp(&
&  0:indtm, 20), peff, fun, fun0, fun2, rp1, rp2, rp3, dd1, dd2, dd3, dd4&
&  , dd5, c, dsqrt, funp, fun2p, fun0z, funz, fun2z, peff2, arg, c0, c1, &
&  cost, cut, cost_fd
  REAL*8 :: zb(nelskip, i0:*), ddb(*), rmub(3, 0:indtm), rb(0:indtm), &
&  distpb(0:indtm, 20), funb, fun0b, fun2b, rp1b, rp2b, rp3b, dd1b, cb, &
&  fun0zb, funzb, fun2zb, costb, cost_fdb
  INTEGER :: branch
  REAL*8 :: temp3
  DOUBLE PRECISION :: temp29
  REAL*8 :: temp42b3
  REAL*8 :: temp2
  REAL*8 :: temp28
  REAL*8 :: temp42b2
  REAL*8 :: temp53b39
  REAL*8 :: temp74b7
  DOUBLE PRECISION :: temp1
  DOUBLE PRECISION :: temp27
  REAL*8 :: temp42b1
  REAL*8 :: temp53b38
  REAL*8 :: temp62b29
  REAL*8 :: temp74b6
  REAL*8 :: temp0
  REAL*8 :: temp13b
  REAL*8 :: temp26
  REAL*8 :: temp42b0
  REAL*8 :: temp52b9
  REAL*8 :: temp53b37
  REAL*8 :: temp62b28
  REAL*8 :: temp74b5
  REAL*8 :: temp7b
  REAL*8 :: temp21b
  REAL*8 :: temp25
  REAL*8 :: temp52b8
  REAL*8 :: temp53b36
  REAL*8 :: temp58b
  REAL*8 :: temp62b27
  REAL*8 :: temp74b4
  REAL*8 :: temp24
  REAL*8 :: temp52b7
  REAL*8 :: temp53b35
  REAL*8 :: temp62b26
  REAL*8 :: temp74b3
  INTRINSIC DEXP
  REAL*8 :: temp20b1
  REAL*8 :: temp23
  REAL*8 :: temp52b6
  REAL*8 :: temp53b34
  REAL*8 :: temp57b1
  REAL*8 :: temp62b25
  REAL*8 :: temp74b
  REAL*8 :: temp74b2
  REAL*8 :: temp20b0
  DOUBLE PRECISION :: temp22
  REAL*8 :: temp52b5
  REAL*8 :: temp53b33
  REAL*8 :: temp59
  REAL*8 :: temp57b0
  REAL*8 :: temp62b24
  REAL*8 :: temp74b1
  REAL*8 :: temp9b0
  REAL*8 :: temp21
  REAL*8 :: temp52b4
  REAL*8 :: temp53b32
  REAL*8 :: temp58
  REAL*8 :: temp62b23
  REAL*8 :: temp74b0
  DOUBLE PRECISION :: temp20
  REAL*8 :: temp52b3
  REAL*8 :: temp53b31
  REAL*8 :: temp57
  REAL*8 :: temp62b22
  REAL*8 :: temp16b
  REAL*8 :: temp35b1
  REAL*8 :: temp52b2
  REAL*8 :: temp53b30
  REAL*8 :: temp56
  REAL*8 :: temp62b21
  REAL*8 :: temp24b
  REAL*8 :: temp35b0
  REAL*8 :: temp52b1
  DOUBLE PRECISION :: temp55
  REAL*8 :: temp62b20
  REAL*8 :: temp32b
  REAL*8 :: temp52b0
  DOUBLE PRECISION :: temp54
  REAL*8 :: temp62b9
  REAL*8 :: temp62b56
  REAL*8 :: temp40b
  DOUBLE PRECISION :: temp53
  REAL*8 :: temp62b8
  REAL*8 :: temp62b55
  REAL*8 :: temp52
  REAL*8 :: temp62b7
  REAL*8 :: temp62b54
  DOUBLE PRECISION :: temp51
  REAL*8 :: temp62b6
  REAL*8 :: temp62b53
  REAL*8 :: temp50
  REAL*8 :: temp62b5
  REAL*8 :: temp62b52
  REAL*8 :: temp62b4
  REAL*8 :: temp62b51
  DOUBLE PRECISION :: temp27b
  REAL*8 :: temp51b25
  REAL*8 :: temp62b3
  REAL*8 :: temp62b50
  REAL*8 :: temp35b
  REAL*8 :: temp40b6
  REAL*8 :: temp51b24
  REAL*8 :: temp62b2
  REAL*8 :: temp40b5
  REAL*8 :: temp43b
  REAL*8 :: temp45b0
  REAL*8 :: temp51b23
  REAL*8 :: temp62b1
  REAL*8 :: temp0b
  REAL*8 :: temp40b4
  REAL*8 :: temp51b
  REAL*8 :: temp51b22
  REAL*8 :: temp62b0
  REAL*8 :: temp23b2
  REAL*8 :: temp40b3
  REAL*8 :: temp51b21
  REAL*8 :: temp23b1
  REAL*8 :: temp40b2
  REAL*8 :: temp51b20
  REAL*8 :: temp23b0
  REAL*8 :: temp40b1
  REAL*8 :: temp40b0
  DOUBLE PRECISION :: temp38b
  REAL*8 :: temp46b
  REAL*8 :: temp54b
  REAL*8 :: temp62b
  REAL*8 :: temp19
  REAL*8 :: temp18
  REAL*8 :: temp53b29
  DOUBLE PRECISION :: temp17
  REAL*8 :: temp53b28
  REAL*8 :: temp62b19
  REAL*8 :: temp16
  DOUBLE PRECISION :: temp12b
  REAL*8 :: temp43b8
  DOUBLE PRECISION :: temp49b
  REAL*8 :: temp53b27
  REAL*8 :: temp62b18
  REAL*8 :: temp2b0
  DOUBLE PRECISION :: temp15
  REAL*8 :: temp20b
  REAL*8 :: temp43b7
  REAL*8 :: temp53b26
  REAL*8 :: temp57b
  REAL*8 :: temp62b17
  REAL*8 :: temp14
  REAL*8 :: temp43b6
  REAL*8 :: temp53b25
  REAL*8 :: temp62b16
  REAL*8 :: temp65b
  REAL*8 :: temp13
  REAL*8 :: temp43b5
  REAL*8 :: temp53b24
  REAL*8 :: temp62b15
  DOUBLE PRECISION :: temp12
  REAL*8 :: temp43b4
  DOUBLE PRECISION :: temp49
  REAL*8 :: temp53b23
  REAL*8 :: temp62b14
  REAL*8 :: temp11
  REAL*8 :: temp43b3
  REAL*8 :: temp48
  REAL*8 :: temp53b22
  REAL*8 :: temp62b13
  REAL*8 :: temp10
  REAL*8 :: temp43b2
  REAL*8 :: temp47
  REAL*8 :: temp53b21
  REAL*8 :: temp62b12
  REAL*8 :: temp62b49
  DOUBLE PRECISION :: temp15b
  REAL*8 :: temp43b1
  REAL*8 :: temp46
  REAL*8 :: temp53b20
  REAL*8 :: temp53b57
  REAL*8 :: temp62b11
  REAL*8 :: temp62b48
  REAL*8 :: temp9b
  REAL*8 :: temp23b
  REAL*8 :: temp43b0
  REAL*8 :: temp45
  REAL*8 :: temp53b9
  REAL*8 :: temp53b56
  REAL*8 :: temp62b10
  REAL*8 :: temp62b47
  REAL*8 :: temp31b
  DOUBLE PRECISION :: temp44
  REAL*8 :: temp53b8
  REAL*8 :: temp53b55
  REAL*8 :: temp62b46
  REAL*8 :: temp68b
  DOUBLE PRECISION :: temp43
  REAL*8 :: temp53b7
  REAL*8 :: temp53b54
  REAL*8 :: temp62b45
  DOUBLE PRECISION :: temp42
  REAL*8 :: temp51b19
  REAL*8 :: temp53b6
  REAL*8 :: temp53b53
  REAL*8 :: temp62b44
  REAL*8 :: temp41
  REAL*8 :: temp51b18
  REAL*8 :: temp53b5
  REAL*8 :: temp53b52
  REAL*8 :: temp62b43
  DOUBLE PRECISION :: temp40
  REAL*8 :: temp51b17
  REAL*8 :: temp53b4
  REAL*8 :: temp53b51
  REAL*8 :: temp62b42
  REAL*8 :: temp18b
  REAL*8 :: temp42b25
  REAL*8 :: temp51b16
  REAL*8 :: temp53b3
  REAL*8 :: temp53b50
  REAL*8 :: temp62b41
  REAL*8 :: temp26b
  REAL*8 :: temp31b6
  REAL*8 :: temp42b24
  REAL*8 :: temp51b15
  REAL*8 :: temp53b2
  REAL*8 :: temp62b40
  REAL*8 :: temp31b5
  REAL*8 :: temp34b
  REAL*8 :: temp42b23
  REAL*8 :: temp51b14
  REAL*8 :: temp53b1
  REAL*8 :: temp31b4
  REAL*8 :: temp42b
  REAL*8 :: temp42b22
  REAL*8 :: temp51b13
  REAL*8 :: temp53b0
  REAL*8 :: temp73
  REAL*8 :: temp5b0
  REAL*8 :: temp31b3
  REAL*8 :: temp42b21
  REAL*8 :: temp50b
  REAL*8 :: temp51b12
  REAL*8 :: temp72
  REAL*8 :: tempb
  REAL*8 :: temp31b2
  REAL*8 :: temp42b20
  REAL*8 :: temp51b11
  DOUBLE PRECISION :: temp71
  REAL*8 :: temp31b1
  REAL*8 :: temp51b10
  REAL*8 :: temp70
  REAL*8 :: temp31b0
  REAL*8 :: temp29b
  REAL*8 :: temp29b2
  REAL*8 :: temp52b17
  REAL*8 :: temp29b1
  REAL*8 :: temp37b
  REAL*8 :: temp41b7
  REAL*8 :: temp52b16
  REAL*8 :: temp29b0
  REAL*8 :: temp41b6
  REAL*8 :: temp45b
  REAL*8 :: temp46b1
  REAL*8 :: temp52b15
  REAL*8 :: temp2b
  REAL*8 :: temp41b5
  REAL*8 :: temp46b0
  REAL*8 :: temp52b14
  REAL*8 :: temp53b
  REAL*8 :: temp41b4
  REAL*8 :: temp52b13
  REAL*8 :: temp61b
  REAL*8 :: temp41b3
  REAL*8 :: temp52b12
  REAL*8 :: temp24b1
  REAL*8 :: temp41b2
  REAL*8 :: temp52b11
  REAL*8 :: temp24b0
  REAL*8 :: temp41b1
  REAL*8 :: temp52b10
  REAL*8 :: temp53b19
  REAL*8 :: temp41b0
  REAL*8 :: temp51b9
  REAL*8 :: temp53b18
  REAL*8 :: temp11b
  REAL*8 :: temp48b
  REAL*8 :: temp51b8
  REAL*8 :: temp53b17
  REAL*8 :: temp5b
  REAL*8 :: temp51b7
  REAL*8 :: temp53b16
  REAL*8 :: temp56b
  INTRINSIC DLOG
  REAL*8 :: temp51b6
  REAL*8 :: temp53b15
  DOUBLE PRECISION :: temp8b1
  REAL*8 :: temp51b5
  REAL*8 :: temp53b14
  REAL*8 :: temp56b0
  REAL*8 :: temp8b0
  REAL*8 :: temp39
  REAL*8 :: temp51b4
  REAL*8 :: temp53b13
  DOUBLE PRECISION :: temp38
  REAL*8 :: temp51b3
  REAL*8 :: temp53b12
  REAL*8 :: temp53b49
  REAL*8 :: temp37
  REAL*8 :: temp51b2
  REAL*8 :: temp53b11
  REAL*8 :: temp53b48
  REAL*8 :: temp62b39
  REAL*8 :: temp14b
  REAL*8 :: temp36
  REAL*8 :: temp34b0
  REAL*8 :: temp51b1
  REAL*8 :: temp53b10
  REAL*8 :: temp53b47
  REAL*8 :: temp62b38
  REAL*8 :: temp8b
  REAL*8 :: temp22b
  REAL*8 :: temp35
  REAL*8 :: temp51b0
  REAL*8 :: temp53b46
  REAL*8 :: temp54b18
  REAL*8 :: temp59b
  REAL*8 :: temp62b37
  REAL*8 :: temp30b
  REAL*8 :: temp34
  REAL*8 :: temp53b45
  REAL*8 :: temp54b17
  REAL*8 :: temp62b36
  DOUBLE PRECISION :: temp33
  REAL*8 :: temp42b19
  REAL*8 :: temp53b44
  REAL*8 :: temp54b16
  REAL*8 :: temp62b35
  DOUBLE PRECISION :: temp32
  REAL*8 :: temp42b18
  REAL*8 :: temp53b43
  REAL*8 :: temp54b15
  REAL*8 :: temp62b34
  REAL*8 :: temp69
  DOUBLE PRECISION :: temp31
  REAL*8 :: temp42b17
  REAL*8 :: temp53b42
  REAL*8 :: temp54b14
  REAL*8 :: temp62b33
  DOUBLE PRECISION :: temp68
  REAL*8 :: temp30
  REAL*8 :: temp42b16
  REAL*8 :: temp53b41
  REAL*8 :: temp54b13
  REAL*8 :: temp62b32
  REAL*8 :: temp67
  DOUBLE PRECISION :: temp17b
  REAL*8 :: temp42b15
  REAL*8 :: temp53b40
  REAL*8 :: temp54b12
  REAL*8 :: temp62b31
  REAL*8 :: temp66
  REAL*8 :: temp25b
  REAL*8 :: temp42b14
  REAL*8 :: temp54b11
  REAL*8 :: temp62b30
  DOUBLE PRECISION :: temp65
  REAL*8 :: temp42b13
  REAL*8 :: temp54b9
  REAL*8 :: temp54b10
  REAL*8 :: temp64
  REAL*8 :: temp41b
  REAL*8 :: temp42b12
  REAL*8 :: temp54b8
  REAL*8 :: temp63
  REAL*8 :: temp22b2
  REAL*8 :: temp42b11
  REAL*8 :: temp54b7
  DOUBLE PRECISION :: temp62
  REAL*8 :: temp22b1
  REAL*8 :: temp42b10
  REAL*8 :: temp54b6
  REAL*8 :: temp61
  REAL*8 :: temp22b0
  REAL*8 :: temp54b5
  DOUBLE PRECISION :: temp60
  REAL*8 :: temp54b4
  REAL*8 :: temp28b
  REAL*8 :: temp54b3
  REAL*8 :: temp36b
  REAL*8 :: temp54b2
  REAL :: cutoff_p
  REAL*8 :: temp54b1
  DOUBLE PRECISION :: temp1b
  REAL*8 :: temp52b
  REAL*8 :: temp54b0
  DOUBLE PRECISION :: temp
  DOUBLE PRECISION :: temp60b
  REAL*8 :: temp9
  REAL*8 :: temp32b0
  REAL*8 :: temp42b9
  REAL*8 :: temp1b1
  DOUBLE PRECISION :: temp8
  REAL*8 :: temp39b
  REAL*8 :: temp42b8
  REAL*8 :: temp1b0
  REAL*8 :: temp7
  REAL*8 :: temp42b7
  REAL*8 :: temp47b
  REAL*8 :: temp4b
  DOUBLE PRECISION :: temp6
  REAL*8 :: temp42b6
  DOUBLE PRECISION :: temp5
  REAL*8 :: temp42b5
  DOUBLE PRECISION :: temp4
  REAL*8 :: temp42b4
  REAL*8 :: temp71b
!     Derivative with respect to Z not implemented
!                                                                       
!        indorb are the number of orbitals occupied before calling      
!        this subroutine                                                
!                                                                       
!        indpar is the number of variational parameters used            
!        before calling this subroutine                                 
!                                                                       
!        indshell is the index of the last  occupied orbital            
!        in the shell, characterized by occupation number iocc(indshell+
!                                                                       
!        z(i,indt+4)  contains the laplacian of the orbital i          
!        z(i,indt+mu) contains the gradient of the orbital i (mu=1,2,3) 
!        In the following given a radial part of the orbital f(r)       
!        fun=1/r  d f(r)/d r                                            
!        fun2= d^2 f(r)/dr^2                                            




  adi4ibuf=1
  adr8ibuf=1

  SELECT CASE  (iopt) 
  CASE (16, 161) 
! R(r)=exp(-z*r**2) single zeta                                         
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!            if(iflagnorm.gt.2) then 
!             c=(2.d0*dd1/pi)**(3.d0/4.d0)*ratios
      c = dd1**0.75d0*ratios
!            endif 
      DO k=indtmin,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
        cost = dd1*r(k)**2
        IF (cost .GE. 9.d0) THEN
          distp(k, 1) = 0.d0
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE
          distp(k, 1) = c*DEXP(-cost-DLOG(1.d0-cost/9.d0)**2)
          IF (r(k) .LT. 0.d0) THEN
            distp(k, 1) = -distp(k, 1)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          END IF
        END IF
      END DO
      IF (typec .NE. 1) THEN
        IF (distp(0, 1) .NE. 0.d0) THEN
!              the first derivative /r                                  
          rp1 = dd1*r(0)**2
          rp3 = -9.d0 + rp1
          rp2 = DLOG(-(rp3/9.d0))
          fun = -(2.d0*dd1*distp(0, 1)*(rp1-9.d0+2.d0*rp2)/rp3)
!              the second derivative                                    
          funb = 2.d0*zb(indorbp, indt+4)
          fun2b = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.0_8
          DO i=3,1,-1
            funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
            rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.0_8
          END DO
          distpb = 0.0_8
          temp1 = 4.d0*rp1**2 - 35.d0*rp1 + 9.d0
          temp3 = rp3**2
          temp2 = dd1*distp(0, 1)/temp3
          temp2b = 2.d0*(176.d0*rp1-37.d0*rp1**2+2.d0*rp1**3+2.d0*(rp2*&
&            temp1)+8.d0*(rp1*rp2**2)-81.d0)*fun2b/temp3
          temp2b0 = 2.d0*temp2*fun2b
          temp1b = 2.d0*rp2*temp2b0
          temp0 = dd1/rp3
          temp1b0 = -(2.d0*distp(0, 1)*temp0*funb)
          rp2b = 2.d0*temp1b0 + (8.d0*rp1*2*rp2+2.d0*temp1)*temp2b0
          temp1b1 = -(2.d0*(rp1+2.d0*rp2-9.d0)*funb)
          temp0b = distp(0, 1)*temp1b1/rp3
          rp3b = rp2b/rp3 - temp0*temp0b - temp2*2*rp3*temp2b
          rp1b = temp1b0 + rp3b + (4.d0*2*rp1-35.d0)*temp1b + (8.d0*rp2&
&            **2+2.d0*3*rp1**2-37.d0*2*rp1+176.d0)*temp2b0
          dd1b = temp0b + r(0)**2*rp1b + distp(0, 1)*temp2b
          distpb(0, 1) = temp0*temp1b1 + dd1*temp2b
          rb(0) = rb(0) + dd1*2*r(0)*rp1b
        ELSE
          zb(indorbp, indt+1:indt+4) = 0.0_8
          distpb = 0.0_8
          dd1b = 0.0_8
        END IF
      ELSE
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=indtm,i0,-1
        distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      cb = 0.0_8
      DO k=indtm,indtmin,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 3) THEN
          IF (branch .LT. 2) THEN
            distpb(k, 1) = 0.0_8
            costb = 0.0_8
            GOTO 100
          END IF
        ELSE
          distpb(k, 1) = -distpb(k, 1)
        END IF
        temp = DLOG(-(cost/9.d0) + 1.d0)
        tempb = c*DEXP(-cost-temp**2)*distpb(k, 1)
        cb = cb + DEXP(-cost-temp**2)*distpb(k, 1)
        costb = (2*temp/((1.d0-cost/9.d0)*9.d0)-1.0)*tempb
        distpb(k, 1) = 0.0_8
 100    CALL POPREAL8(adr8ibuf,adr8buf,cost)
        dd1b = dd1b + r(k)**2*costb
        rb(k) = rb(k) + dd1*2*r(k)*costb
      END DO
      dd1b = dd1b + ratios*0.75d0*dd1**(-0.25D0)*cb
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (19) 
!           indorb=indorbp 
!        indpar=indpar+1 
!        indshell=indshellp 
! derivative of bump gaussian
! R(r)=c*exp(-z*r**2)*(3/4/z-r**2)                                      
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then 
!         ratios--> ratios*(2/pi)^3/4
!         c=(2.d0*dd1/pi)**(3.d0/4.d0)*ratios
      c = ratios*dd1**0.75d0
!         endif 
      DO k=indtmin,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
        cost = dd1*r(k)**2
        IF (cost .GE. 9.d0) THEN
          distp(k, 1) = 0.d0
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE
          distp(k, 1) = c*DEXP(-cost-DLOG(1.d0-cost/9.d0)**2)
          IF (r(k) .LT. 0.d0) THEN
            distp(k, 1) = -distp(k, 1)
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          END IF
        END IF
      END DO
      DO i=i0,indtm
        IF (distp(i, 1) .NE. 0.d0) THEN
          rp1 = dd1*r(i)**2
          CALL PUSHREAL8(adr8ibuf,adr8buf,rp3)
          rp3 = -9.d0 + rp1
          CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
          rp2 = DLOG(-(rp3/9.d0))
          CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
          cost = (rp3+2.d0*rp2)/rp3
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END DO
      IF (typec .NE. 1) THEN
!              the first derivative /r                                  
        IF (distp(0, 1) .NE. 0.d0) THEN
!              the first derivative /r                                  
          rp1 = dd1*r(0)**2
          CALL PUSHREAL8(adr8ibuf,adr8buf,rp3)
          rp3 = -9.d0 + rp1
          CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
          rp2 = DLOG(-(rp3/9.d0))
          fun = -(2.d0*dd1*distp(0, 1)*(rp1-9.d0+2.d0*rp2)/rp3)
!              the second derivative                                    
          fun2 = 2.d0*dd1*distp(0, 1)*(-81.d0+176.d0*rp1-37.d0*rp1**2+&
&            2.d0*rp1**3+2.d0*rp2*(9.d0-35.d0*rp1+4.d0*rp1**2)+8.d0*rp1*&
&            rp2**2)/rp3**2
!          fun0z=-distp(0,1)*rp1/dd1*(rp3+2.d0*rp2)/rp3
          funz = 2.d0*distp(0, 1)*(-81.d0+97d0*rp1-19.d0*rp1**2+rp1**3+&
&            2.d0*rp2*(9.d0-18.d0*rp1+2.d0*rp1**2)+4.d0*rp1*rp2**2)/rp3**&
&            2
          CALL PUSHREAL8(adr8ibuf,adr8buf,fun)
!          fun0=0.75d0*fun0+fun0z
          fun = 0.75d0*fun/dd1 + funz
          funb = 2.d0*zb(indorbp, indt+4)
          fun2b = zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.0_8
          DO i=3,1,-1
            funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
            rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
            zb(indorbp, indt+i) = 0.0_8
          END DO
          temp20b = 0.75d0*fun2b/dd1
          fun2zb = fun2b
          fun2b = temp20b
          CALL POPREAL8(adr8ibuf,adr8buf,fun)
          temp20b0 = 0.75d0*funb/dd1
          funzb = funb
          funb = temp20b0
          temp19 = rp3**3
          temp14 = distp(0, 1)/temp19
          temp18 = rp2**3
          temp15 = 6.d0*rp1**2 - 53.d0*rp1 + 45.d0
          temp16 = rp1*rp2**2
          temp17 = 600.d0*rp1**2 - 783d0*rp1 + 6.d0*rp1**4 - 112.d0*rp1&
&            **3 + 81.d0
          temp18b = -(2.d0*temp14*fun2zb)
          temp17b = 2.d0*rp2*temp18b
          temp16b = 4.d0*temp15*temp18b
          temp15b = 4.d0*temp16*temp18b
          temp14b = -(2.d0*(3798d0*rp1-2594d0*rp1**2+610d0*rp1**3-59.d0*&
&            rp1**4+2.d0*rp1**5+2.d0*(rp2*temp17)+4.d0*(temp16*temp15)+&
&            16.d0*(rp1**2*temp18)-729.d0)*fun2zb/temp19)
          temp13 = rp3**2
          temp11 = distp(0, 1)/temp13
          temp12 = 2.d0*rp1**2 - 18.d0*rp1 + 9.d0
          temp13b = 2.d0*temp11*funzb
          temp8 = 4.d0*rp1**2 - 35.d0*rp1 + 9.d0
          temp10 = rp3**2
          temp9 = dd1*distp(0, 1)/temp10
          temp9b = 2.d0*temp9*fun2b
          temp7 = dd1/rp3
          temp8b = -(2.d0*distp(0, 1)*temp7*funb)
          rp2b = (4.d0*rp1*2*rp2+2.d0*temp12)*temp13b + 2.d0*temp8b + (&
&            8.d0*rp1*2*rp2+2.d0*temp8)*temp9b + rp1*2*rp2*temp16b + (&
&            16.d0*rp1**2*3*rp2**2+2.d0*temp17)*temp18b
          temp11b = 2.d0*(97d0*rp1-19.d0*rp1**2+rp1**3+2.d0*(rp2*temp12)&
&            +4.d0*(rp1*rp2**2)-81.d0)*funzb/temp13
          temp9b0 = 2.d0*(176.d0*rp1-37.d0*rp1**2+2.d0*rp1**3+2.d0*(rp2*&
&            temp8)+8.d0*(rp1*rp2**2)-81.d0)*fun2b/temp10
          temp8b0 = -(2.d0*(rp1+2.d0*rp2-9.d0)*funb)
          temp7b = distp(0, 1)*temp8b0/rp3
          rp3b = rp2b/rp3 - temp7*temp7b - temp11*2*rp3*temp11b - temp9*&
&            2*rp3*temp9b0 - temp14*3*rp3**2*temp14b
          temp12b = 2.d0*rp2*temp13b
          temp8b1 = 2.d0*rp2*temp9b
          rp1b = (4.d0*rp2**2+3*rp1**2-19.d0*2*rp1+97d0)*temp13b + (2.d0&
&            *2*rp1-18.d0)*temp12b + temp8b + rp3b + (4.d0*2*rp1-35.d0)*&
&            temp8b1 + (8.d0*rp2**2+2.d0*3*rp1**2-37.d0*2*rp1+176.d0)*&
&            temp9b + (6.d0*2*rp1-53.d0)*temp15b + rp2**2*temp16b + (6.d0&
&            *4*rp1**3-112.d0*3*rp1**2+600.d0*2*rp1-783d0)*temp17b + (&
&            16.d0*temp18*2*rp1+2.d0*5*rp1**4-59.d0*4*rp1**3+610d0*3*rp1&
&            **2-2594d0*2*rp1+3798d0)*temp18b
          dd1b = temp7b - fun*temp20b0/dd1 + r(0)**2*rp1b + distp(0, 1)*&
&            temp9b0 - fun2*temp20b/dd1
          distpb = 0.0_8
          distpb(0, 1) = temp11b + temp7*temp8b0 + dd1*temp9b0 + temp14b
          CALL POPREAL8(adr8ibuf,adr8buf,rp2)
          CALL POPREAL8(adr8ibuf,adr8buf,rp3)
          rb(0) = rb(0) + dd1*2*r(0)*rp1b
        ELSE
          zb(indorbp, indt+1:indt+4) = 0.0_8
          distpb = 0.0_8
          dd1b = 0.0_8
        END IF
      ELSE
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
      DO i=indtm,i0,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 2) THEN
          temp6 = 4.d0*dd1
          temp5 = 3.d0/temp6
          temp5b = distp(i, 1)*zb(indorbp, i)
          distpb(i, 1) = distpb(i, 1) + (temp5-r(i)**2*cost)*zb(indorbp&
&            , i)
          costb = -(r(i)**2*temp5b)
          temp5b0 = costb/rp3
          rp2b = 2.d0*temp5b0
          rp3b = rp2b/rp3 + (1.0_8-(rp3+2.d0*rp2)/rp3)*temp5b0
          rp1b = rp3b
          dd1b = dd1b + r(i)**2*rp1b - temp5*4.d0*temp5b/temp6
          rb(i) = rb(i) + dd1*2*r(i)*rp1b - cost*2*r(i)*temp5b
          zb(indorbp, i) = 0.0_8
          CALL POPREAL8(adr8ibuf,adr8buf,cost)
          CALL POPREAL8(adr8ibuf,adr8buf,rp2)
          CALL POPREAL8(adr8ibuf,adr8buf,rp3)
        ELSE
          zb(indorbp, i) = 0.0_8
        END IF
      END DO
      cb = 0.0_8
      DO k=indtm,indtmin,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 3) THEN
          IF (branch .LT. 2) THEN
            distpb(k, 1) = 0.0_8
            costb = 0.0_8
            GOTO 110
          END IF
        ELSE
          distpb(k, 1) = -distpb(k, 1)
        END IF
        temp4 = DLOG(-(cost/9.d0) + 1.d0)
        temp4b = c*DEXP(-cost-temp4**2)*distpb(k, 1)
        cb = cb + DEXP(-cost-temp4**2)*distpb(k, 1)
        costb = (2*temp4/((1.d0-cost/9.d0)*9.d0)-1.0)*temp4b
        distpb(k, 1) = 0.0_8
 110    CALL POPREAL8(adr8ibuf,adr8buf,cost)
        dd1b = dd1b + r(k)**2*costb
        rb(k) = rb(k) + dd1*2*r(k)*costb
      END DO
      dd1b = dd1b + ratios*0.75d0*dd1**(-0.25D0)*cb
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (36) 
!           indorb=indorbp 
!        indpar=indpar+1 
!        indshell=indshellp 
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then 
!         c=dsqrt(2.d0)*pi**(-0.75d0)*(2.d0*dd1)**1.25d0*ratiop
!        ratiop=ratiop*dsqrt(2.d0)*pi**(-0.75d0)*2^1.25
    c = dd1**1.25d0*ratiop
!        endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2
      IF (cost .GE. 9.d0) THEN
        distp(k, 1) = 0.d0
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        distp(k, 1) = c*DEXP(-cost-DLOG(1.d0-cost/9.d0)**2)
        IF (r(k) .LT. 0.d0) THEN
          distp(k, 1) = -distp(k, 1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END IF
    END DO
    indorbp = indorb
!                                                                       
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      IF (distp(0, 1) .NE. 0.d0) THEN
!              the first derivative /r                                  
        rp1 = dd1*r(0)**2
        rp3 = -9.d0 + rp1
        rp2 = DLOG(-(rp3/9.d0))
        fun = -(2.d0*dd1*distp(0, 1)*(rp1-9.d0+2.d0*rp2)/rp3)
!              the second derivative                                    
        fun2 = 2.d0*dd1*distp(0, 1)*(-81.d0+176.d0*rp1-37.d0*rp1**2+2.d0&
&          *rp1**3+2.d0*rp2*(9.d0-35.d0*rp1+4.d0*rp1**2)+8.d0*rp1*rp2**2)&
&          /rp3**2
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb
        DO ic=1,3
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            DO i=1,3
              IF (i .EQ. ic) THEN
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              END IF
            END DO
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        funb = 0.0_8
        fun0b = 0.0_8
        DO ic=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            rmub(ic, 0) = rmub(ic, 0) + (fun2+4.d0*fun)*zb(indorbp, indt&
&              +4)
            funb = funb + rmu(ic, 0)*4.d0*zb(indorbp, indt+4)
            zb(indorbp, indt+4) = 0.0_8
            DO i=3,1,-1
              CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
              IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i&
&                  )
              temp22b1 = rmu(i, 0)*zb(indorbp, indt+i)
              rmub(ic, 0) = rmub(ic, 0) + fun*temp22b1
              funb = funb + rmu(ic, 0)*temp22b1
              rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+&
&                i)
              zb(indorbp, indt+i) = 0.0_8
            END DO
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        distpb = 0.0_8
        temp21 = dd1/rp3
        temp22b = -(2.d0*distp(0, 1)*temp21*funb)
        temp22b0 = -(2.d0*(rp1+2.d0*rp2-9.d0)*funb)
        temp21b = distp(0, 1)*temp22b0/rp3
        rp2b = 2.d0*temp22b
        rp3b = rp2b/rp3 - temp21*temp21b
        rp1b = rp3b + temp22b
        distpb(0, 1) = fun0b + temp21*temp22b0
        dd1b = r(0)**2*rp1b + temp21b
        rb(0) = rb(0) + dd1*2*r(0)*rp1b
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb
        DO ic=1,3
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        DO ic=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            zb(indorbp, indt+1:indt+4) = 0.0_8
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=indtm,i0,-1
          rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
          distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
          zb(indorbp, i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 3) THEN
        IF (branch .LT. 2) THEN
          distpb(k, 1) = 0.0_8
          costb = 0.0_8
          GOTO 120
        END IF
      ELSE
        distpb(k, 1) = -distpb(k, 1)
      END IF
      temp20 = DLOG(-(cost/9.d0) + 1.d0)
      temp20b1 = c*DEXP(-cost-temp20**2)*distpb(k, 1)
      cb = cb + DEXP(-cost-temp20**2)*distpb(k, 1)
      costb = (2*temp20/((1.d0-cost/9.d0)*9.d0)-1.0)*temp20b1
      distpb(k, 1) = 0.0_8
 120  CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd1b = dd1b + r(k)**2*costb
      rb(k) = rb(k) + dd1*2*r(k)*costb
    END DO
    dd1b = dd1b + ratiop*1.25d0*dd1**0.25D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (44) 
!endif for indt                                         
!        indpar=indpar+1 
!        indshell=indshell+3 
!        indorb=indorbp 
! derivative of 36 
! R(r)=x*exp(-z*r**2)*(5/4/z-r**2)                                      
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then 
!        c=dsqrt(2.d0)*pi**(-0.75d0)*(2.d0*dd1)**1.25d0*ratiop
    c = dd1**1.25d0*ratiop
!        endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2
      IF (cost .GE. 9.d0) THEN
        distp(k, 1) = 0.d0
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        distp(k, 1) = c*DEXP(-cost-DLOG(1.d0-cost/9.d0)**2)
        IF (r(k) .LT. 0.d0) THEN
          distp(k, 1) = -distp(k, 1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END IF
    END DO
    indorbp = indorb
!                                                                       
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO i=i0,indtm
          IF (distp(i, 1) .NE. 0.d0) THEN
            rp1 = dd1*r(i)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,rp3)
            rp3 = -9.d0 + rp1
            CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
            rp2 = DLOG(-(rp3/9.d0))
            CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
            cost = (rp3+2.d0*rp2)/rp3
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          END IF
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      IF (distp(0, 1) .NE. 0.d0) THEN
        fun0 = distp(0, 1)
!           the first derivative /r                                  
        rp1 = dd1*r(0)**2
        CALL PUSHREAL8(adr8ibuf,adr8buf,rp3)
        rp3 = -9.d0 + rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
        rp2 = DLOG(-(rp3/9.d0))
        fun = -(2.d0*dd1*distp(0, 1)*(rp1-9.d0+2.d0*rp2)/rp3)
!              the second derivative                                    
        fun2 = 2.d0*dd1*distp(0, 1)*(-81.d0+176.d0*rp1-37.d0*rp1**2+2.d0&
&          *rp1**3+2.d0*rp2*(9.d0-35.d0*rp1+4.d0*rp1**2)+8.d0*rp1*rp2**2)&
&          /rp3**2
        funz = 2.d0*distp(0, 1)*(-81.d0+97d0*rp1-19.d0*rp1**2+rp1**3+&
&          2.d0*rp2*(9.d0-18.d0*rp1+2.d0*rp1**2)+4.d0*rp1*rp2**2)/rp3**2
        fun2z = -(2.d0*distp(0, 1)*(-729.d0+3798d0*rp1-2594d0*rp1**2+&
&          610d0*rp1**3-59.d0*rp1**4+2.d0*rp1**5+2.d0*rp2*(81.d0-783d0*&
&          rp1+600.d0*rp1**2-112.d0*rp1**3+6.d0*rp1**4)+4.d0*rp1*rp2**2*(&
&          45.d0-53.d0*rp1+6.d0*rp1**2)+16.d0*rp1**2*rp2**3)/rp3**3)
        CALL PUSHREAL8(adr8ibuf,adr8buf,fun)
        fun = 1.25d0*fun/dd1 + funz
        fun2 = 1.25d0*fun2/dd1 + fun2z
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb
        DO ic=1,3
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            DO i=1,3
              IF (i .EQ. ic) THEN
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
              END IF
            END DO
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        funb = 0.0_8
        fun0b = 0.0_8
        DO ic=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            rmub(ic, 0) = rmub(ic, 0) + (fun2+4.d0*fun)*zb(indorbp, indt&
&              +4)
            funb = funb + rmu(ic, 0)*4.d0*zb(indorbp, indt+4)
            zb(indorbp, indt+4) = 0.0_8
            DO i=3,1,-1
              CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
              IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i&
&                  )
              temp29b1 = rmu(i, 0)*zb(indorbp, indt+i)
              rmub(ic, 0) = rmub(ic, 0) + fun*temp29b1
              funb = funb + rmu(ic, 0)*temp29b1
              rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+&
&                i)
              zb(indorbp, indt+i) = 0.0_8
            END DO
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        CALL POPREAL8(adr8ibuf,adr8buf,fun)
        temp29b = 1.25d0*funb/dd1
        funzb = funb
        funb = temp29b
        temp29b0 = 1.25d0*fun0b/dd1
        fun0zb = fun0b
        temp28 = rp3**2
        temp26 = distp(0, 1)/temp28
        temp27 = 2.d0*rp1**2 - 18.d0*rp1 + 9.d0
        temp28b = 2.d0*temp26*funzb
        temp27b = 2.d0*rp2*temp28b
        temp26b = 2.d0*(97d0*rp1-19.d0*rp1**2+rp1**3+2.d0*(rp2*temp27)+&
&          4.d0*(rp1*rp2**2)-81.d0)*funzb/temp28
        temp24 = dd1*rp3
        temp25b = -(distp(0, 1)*rp1*fun0zb/temp24)
        temp23 = dd1/rp3
        temp24b = -(2.d0*distp(0, 1)*temp23*funb)
        rp2b = 2.d0*temp25b + 2.d0*temp24b + (4.d0*rp1*2*rp2+2.d0*temp27&
&          )*temp28b
        temp25 = (rp3+2.d0*rp2)/temp24
        temp24b0 = -(temp25*temp25b)
        temp24b1 = -(2.d0*(rp1+2.d0*rp2-9.d0)*funb)
        temp23b2 = distp(0, 1)*temp24b1/rp3
        rp3b = temp25b + dd1*temp24b0 + rp2b/rp3 - temp23*temp23b2 - &
&          temp26*2*rp3*temp26b
        rp1b = rp3b - temp25*distp(0, 1)*fun0zb + temp24b + (2.d0*2*rp1-&
&          18.d0)*temp27b + (4.d0*rp2**2+3*rp1**2-19.d0*2*rp1+97d0)*&
&          temp28b
        dd1b = temp23b2 - fun0*temp29b0/dd1 + r(0)**2*rp1b + rp3*&
&          temp24b0 - fun*temp29b/dd1
        fun0b = temp29b0
        distpb = 0.0_8
        distpb(0, 1) = fun0b - temp25*rp1*fun0zb + temp23*temp24b1 + &
&          temp26b
        CALL POPREAL8(adr8ibuf,adr8buf,rp2)
        CALL POPREAL8(adr8ibuf,adr8buf,rp3)
        rb(0) = rb(0) + dd1*2*r(0)*rp1b
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb
        DO ic=1,3
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        DO ic=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            zb(indorbp, indt+1:indt+4) = 0.0_8
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=indtm,i0,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 2) THEN
            temp23b = (1.25d0/dd1-r(i)**2*cost)*zb(indorbp, i)
            temp23b0 = rmu(ic, i)*distp(i, 1)*zb(indorbp, i)
            rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp23b
            distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp23b
            costb = -(r(i)**2*temp23b0)
            temp23b1 = costb/rp3
            rp2b = 2.d0*temp23b1
            rp3b = rp2b/rp3 + (1.0_8-(rp3+2.d0*rp2)/rp3)*temp23b1
            rp1b = rp3b
            dd1b = dd1b + r(i)**2*rp1b - 1.25d0*temp23b0/dd1**2
            rb(i) = rb(i) + dd1*2*r(i)*rp1b - cost*2*r(i)*temp23b0
            zb(indorbp, i) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,cost)
            CALL POPREAL8(adr8ibuf,adr8buf,rp2)
            CALL POPREAL8(adr8ibuf,adr8buf,rp3)
          ELSE
            zb(indorbp, i) = 0.0_8
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 3) THEN
        IF (branch .LT. 2) THEN
          distpb(k, 1) = 0.0_8
          costb = 0.0_8
          GOTO 130
        END IF
      ELSE
        distpb(k, 1) = -distpb(k, 1)
      END IF
      temp22 = DLOG(-(cost/9.d0) + 1.d0)
      temp22b2 = c*DEXP(-cost-temp22**2)*distpb(k, 1)
      cb = cb + DEXP(-cost-temp22**2)*distpb(k, 1)
      costb = (2*temp22/((1.d0-cost/9.d0)*9.d0)-1.0)*temp22b2
      distpb(k, 1) = 0.0_8
 130  CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd1b = dd1b + r(k)**2*costb
      rb(k) = rb(k) + dd1*2*r(k)*costb
    END DO
    dd1b = dd1b + ratiop*1.25d0*dd1**0.25D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (37) 
!endif for indt                                         
!        indpar=indpar+1 
!        indshell=indshell+3 
!        indorb=indorbp 
! d orbitals                                                            
! R(r)= exp(-alpha r^2)                                                 
! each gaussian term is normalized                                      
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then 
! overall normalization                                                 
!         c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)*ratiod
!         ratiod->ratiod*4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0
    c = dd1**1.75d0*ratiod
!         endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2
      IF (cost .GE. 9.d0) THEN
        distp(k, 1) = 0.d0
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        distp(k, 1) = c*DEXP(-cost-DLOG(1.d0-cost/9.d0)**2)
        IF (r(k) .LT. 0.d0) THEN
          distp(k, 1) = -distp(k, 1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END IF
    END DO
    DO i=indtmin,indtm
! lz=0       
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2     
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2            
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1            
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1            
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      IF (distp(0, 1) .NE. 0.d0) THEN
        fun0 = distp(0, 1)
!           the first derivative /r                                  
        rp1 = dd1*r(0)**2
        rp3 = -9.d0 + rp1
        rp2 = DLOG(-(rp3/9.d0))
        fun = -(2.d0*dd1*distp(0, 1)*(rp1-9.d0+2.d0*rp2)/rp3)
!              the second derivative                                    
        fun2 = 2.d0*dd1*distp(0, 1)*(-81.d0+176.d0*rp1-37.d0*rp1**2+2.d0&
&          *rp1**3+2.d0*rp2*(9.d0-35.d0*rp1+4.d0*rp1**2)+8.d0*rp1*rp2**2)&
&          /rp3**2
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb
        DO ic=1,5
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            DO i=1,3
              IF (ic .EQ. 1) THEN
                IF (i .NE. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
                END IF
              ELSE IF (ic .EQ. 2) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
                END IF
              ELSE IF (ic .EQ. 3) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
                END IF
              ELSE IF (ic .EQ. 4) THEN
                IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
                ELSE IF (i .EQ. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
                END IF
              ELSE IF (ic .EQ. 5) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
                ELSE IF (i .EQ. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
                END IF
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              END IF
            END DO
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        distpb = 0.0_8
        funb = 0.0_8
        fun0b = 0.0_8
        DO ic=5,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            distpb(0, 1+ic) = distpb(0, 1+ic) + (fun2+6.d0*fun)*zb(&
&              indorbp, indt+4)
            funb = funb + distp(0, 1+ic)*6.d0*zb(indorbp, indt+4)
            zb(indorbp, indt+4) = 0.0_8
            DO i=3,1,-1
              CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
              IF (branch .LT. 9) THEN
                IF (branch .LT. 5) THEN
                  IF (branch .LT. 3) THEN
                    IF (branch .LT. 2) THEN
                      temp31b2 = -(cost1d*2.d0*zb(indorbp, indt+i))
                      rmub(i, 0) = rmub(i, 0) + fun0*temp31b2
                      fun0b = fun0b + rmu(i, 0)*temp31b2
                    ELSE
                      temp31b3 = cost1d*4.d0*zb(indorbp, indt+i)
                      rmub(i, 0) = rmub(i, 0) + fun0*temp31b3
                      fun0b = fun0b + rmu(i, 0)*temp31b3
                    END IF
                  ELSE IF (branch .LT. 4) THEN
                    temp31b4 = cost2d*2.d0*zb(indorbp, indt+i)
                    rmub(i, 0) = rmub(i, 0) + fun0*temp31b4
                    fun0b = fun0b + rmu(i, 0)*temp31b4
                  END IF
                ELSE IF (branch .LT. 7) THEN
                  IF (branch .LT. 6) THEN
                    temp31b5 = -(cost2d*2.d0*zb(indorbp, indt+i))
                    rmub(i, 0) = rmub(i, 0) + fun0*temp31b5
                    fun0b = fun0b + rmu(i, 0)*temp31b5
                  ELSE
                    rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, &
&                      indt+i)
                    fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
                  END IF
                ELSE IF (.NOT.branch .LT. 8) THEN
                  rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt&
&                    +i)
                  fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
                END IF
              ELSE IF (branch .LT. 13) THEN
                IF (branch .LT. 11) THEN
                  IF (branch .LT. 10) THEN
                    rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, &
&                      indt+i)
                    fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
                  END IF
                ELSE IF (branch .LT. 12) THEN
                  rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt&
&                    +i)
                  fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
                END IF
              ELSE IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt&
&                    +i)
                  fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
                END IF
              ELSE
                rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
              END IF
              temp31b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
              distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(&
&                indorbp, indt+i)
              rmub(i, 0) = rmub(i, 0) + fun*temp31b1
              funb = funb + rmu(i, 0)*temp31b1
              zb(indorbp, indt+i) = 0.0_8
            END DO
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        temp30 = dd1/rp3
        temp31b = -(2.d0*distp(0, 1)*temp30*funb)
        temp31b0 = -(2.d0*(rp1+2.d0*rp2-9.d0)*funb)
        temp30b = distp(0, 1)*temp31b0/rp3
        rp2b = 2.d0*temp31b
        rp3b = rp2b/rp3 - temp30*temp30b
        rp1b = rp3b + temp31b
        distpb(0, 1) = distpb(0, 1) + fun0b + temp30*temp31b0
        dd1b = r(0)**2*rp1b + temp30b
        rb(0) = rb(0) + dd1*2*r(0)*rp1b
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
! enddo fot ic                                   
        indorbp = indorb
        DO ic=1,5
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        DO ic=5,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            zb(indorbp, indt+1:indt+4) = 0.0_8
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=indtm,i0,-1
          distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
          zb(indorbp, k) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 3) THEN
        IF (branch .LT. 2) THEN
          distpb(k, 1) = 0.0_8
          costb = 0.0_8
          GOTO 140
        END IF
      ELSE
        distpb(k, 1) = -distpb(k, 1)
      END IF
      temp29 = DLOG(-(cost/9.d0) + 1.d0)
      temp29b2 = c*DEXP(-cost-temp29**2)*distpb(k, 1)
      cb = cb + DEXP(-cost-temp29**2)*distpb(k, 1)
      costb = (2*temp29/((1.d0-cost/9.d0)*9.d0)-1.0)*temp29b2
      distpb(k, 1) = 0.0_8
 140  CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd1b = dd1b + r(k)**2*costb
      rb(k) = rb(k) + dd1*2*r(k)*costb
    END DO
    dd1b = dd1b + ratiod*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (45) 
!endif for indt                                         
!        indpar=indpar+1 
!        indshell=indshell+5 
!        indorb=indorbp 
! derivative of 37 with respect to z                    
! d orbitals                                                            
! R(r)= c*exp(-z r^2)*(7/4/z-r^2)                                       
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then 
! overall normalization                                                 
    c = dd1**1.75d0*ratiod
!        c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)*ratiod
!         endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2
      IF (cost .GE. 9.d0) THEN
        distp(k, 1) = 0.d0
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        distp(k, 1) = c*DEXP(-cost-DLOG(1.d0-cost/9.d0)**2)
        IF (r(k) .LT. 0.d0) THEN
          distp(k, 1) = -distp(k, 1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END IF
    END DO
    DO i=indtmin,indtm
! lz=0       
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2     
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2            
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1            
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1            
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=i0,indtm
          IF (distp(k, 1) .NE. 0.d0) THEN
            rp1 = dd1*r(k)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,rp3)
            rp3 = -9.d0 + rp1
            CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
            rp2 = DLOG(-(rp3/9.d0))
            CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
            cost = (rp3+2.d0*rp2)/rp3
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          END IF
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      IF (distp(0, 1) .NE. 0.d0) THEN
        fun0 = distp(0, 1)
!           the first derivative /r                                  
        rp1 = dd1*r(0)**2
        CALL PUSHREAL8(adr8ibuf,adr8buf,rp3)
        rp3 = -9.d0 + rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
        rp2 = DLOG(-(rp3/9.d0))
        fun = -(2.d0*dd1*distp(0, 1)*(rp1-9.d0+2.d0*rp2)/rp3)
!              the second derivative                                    
        fun2 = 2.d0*dd1*distp(0, 1)*(-81.d0+176.d0*rp1-37.d0*rp1**2+2.d0&
&          *rp1**3+2.d0*rp2*(9.d0-35.d0*rp1+4.d0*rp1**2)+8.d0*rp1*rp2**2)&
&          /rp3**2
        fun0z = -(distp(0, 1)*rp1/dd1*(rp3+2.d0*rp2)/rp3)
        funz = 2.d0*distp(0, 1)*(-81.d0+97d0*rp1-19.d0*rp1**2+rp1**3+&
&          2.d0*rp2*(9.d0-18.d0*rp1+2.d0*rp1**2)+4.d0*rp1*rp2**2)/rp3**2
        fun2z = -(2.d0*distp(0, 1)*(-729.d0+3798d0*rp1-2594d0*rp1**2+&
&          610d0*rp1**3-59.d0*rp1**4+2.d0*rp1**5+2.d0*rp2*(81.d0-783d0*&
&          rp1+600.d0*rp1**2-112.d0*rp1**3+6.d0*rp1**4)+4.d0*rp1*rp2**2*(&
&          45.d0-53.d0*rp1+6.d0*rp1**2)+16.d0*rp1**2*rp2**3)/rp3**3)
        CALL PUSHREAL8(adr8ibuf,adr8buf,fun0)
        fun0 = 1.75d0*fun0/dd1 + fun0z
        CALL PUSHREAL8(adr8ibuf,adr8buf,fun)
        fun = 1.75d0*fun/dd1 + funz
        fun2 = 1.75d0*fun2/dd1 + fun2z
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb
        DO ic=1,5
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            DO i=1,3
              IF (ic .EQ. 1) THEN
                IF (i .NE. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
                END IF
              ELSE IF (ic .EQ. 2) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
                END IF
              ELSE IF (ic .EQ. 3) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
                END IF
              ELSE IF (ic .EQ. 4) THEN
                IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
                ELSE IF (i .EQ. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
                END IF
              ELSE IF (ic .EQ. 5) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
                ELSE IF (i .EQ. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
                END IF
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
              END IF
            END DO
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        distpb = 0.0_8
        funb = 0.0_8
        fun0b = 0.0_8
        DO ic=5,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            distpb(0, 1+ic) = distpb(0, 1+ic) + (fun2+6.d0*fun)*zb(&
&              indorbp, indt+4)
            funb = funb + distp(0, 1+ic)*6.d0*zb(indorbp, indt+4)
            zb(indorbp, indt+4) = 0.0_8
            DO i=3,1,-1
              CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
              IF (branch .LT. 9) THEN
                IF (branch .LT. 5) THEN
                  IF (branch .LT. 3) THEN
                    IF (branch .LT. 2) THEN
                      temp40b2 = -(cost1d*2.d0*zb(indorbp, indt+i))
                      rmub(i, 0) = rmub(i, 0) + fun0*temp40b2
                      fun0b = fun0b + rmu(i, 0)*temp40b2
                    ELSE
                      temp40b3 = cost1d*4.d0*zb(indorbp, indt+i)
                      rmub(i, 0) = rmub(i, 0) + fun0*temp40b3
                      fun0b = fun0b + rmu(i, 0)*temp40b3
                    END IF
                  ELSE IF (branch .LT. 4) THEN
                    temp40b4 = cost2d*2.d0*zb(indorbp, indt+i)
                    rmub(i, 0) = rmub(i, 0) + fun0*temp40b4
                    fun0b = fun0b + rmu(i, 0)*temp40b4
                  END IF
                ELSE IF (branch .LT. 7) THEN
                  IF (branch .LT. 6) THEN
                    temp40b5 = -(cost2d*2.d0*zb(indorbp, indt+i))
                    rmub(i, 0) = rmub(i, 0) + fun0*temp40b5
                    fun0b = fun0b + rmu(i, 0)*temp40b5
                  ELSE
                    rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, &
&                      indt+i)
                    fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
                  END IF
                ELSE IF (.NOT.branch .LT. 8) THEN
                  rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt&
&                    +i)
                  fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
                END IF
              ELSE IF (branch .LT. 13) THEN
                IF (branch .LT. 11) THEN
                  IF (branch .LT. 10) THEN
                    rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, &
&                      indt+i)
                    fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
                  END IF
                ELSE IF (branch .LT. 12) THEN
                  rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt&
&                    +i)
                  fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
                END IF
              ELSE IF (branch .LT. 15) THEN
                IF (branch .LT. 14) THEN
                  rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt&
&                    +i)
                  fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
                END IF
              ELSE
                rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
              END IF
              temp40b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
              distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(&
&                indorbp, indt+i)
              rmub(i, 0) = rmub(i, 0) + fun*temp40b1
              funb = funb + rmu(i, 0)*temp40b1
              zb(indorbp, indt+i) = 0.0_8
            END DO
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        CALL POPREAL8(adr8ibuf,adr8buf,fun)
        temp40b = 1.75d0*funb/dd1
        funzb = funb
        funb = temp40b
        CALL POPREAL8(adr8ibuf,adr8buf,fun0)
        temp40b0 = 1.75d0*fun0b/dd1
        fun0zb = fun0b
        temp39 = rp3**2
        temp37 = distp(0, 1)/temp39
        temp38 = 2.d0*rp1**2 - 18.d0*rp1 + 9.d0
        temp39b = 2.d0*temp37*funzb
        temp38b = 2.d0*rp2*temp39b
        temp37b = 2.d0*(97d0*rp1-19.d0*rp1**2+rp1**3+2.d0*(rp2*temp38)+&
&          4.d0*(rp1*rp2**2)-81.d0)*funzb/temp39
        temp35 = dd1*rp3
        temp36b = -(distp(0, 1)*rp1*fun0zb/temp35)
        temp34 = dd1/rp3
        temp35b = -(2.d0*distp(0, 1)*temp34*funb)
        rp2b = 2.d0*temp36b + 2.d0*temp35b + (4.d0*rp1*2*rp2+2.d0*temp38&
&          )*temp39b
        temp36 = (rp3+2.d0*rp2)/temp35
        temp35b0 = -(temp36*temp36b)
        temp35b1 = -(2.d0*(rp1+2.d0*rp2-9.d0)*funb)
        temp34b0 = distp(0, 1)*temp35b1/rp3
        rp3b = temp36b + dd1*temp35b0 + rp2b/rp3 - temp34*temp34b0 - &
&          temp37*2*rp3*temp37b
        rp1b = rp3b - temp36*distp(0, 1)*fun0zb + temp35b + (2.d0*2*rp1-&
&          18.d0)*temp38b + (4.d0*rp2**2+3*rp1**2-19.d0*2*rp1+97d0)*&
&          temp39b
        dd1b = temp34b0 - fun0*temp40b0/dd1 + r(0)**2*rp1b + rp3*&
&          temp35b0 - fun*temp40b/dd1
        fun0b = temp40b0
        distpb(0, 1) = distpb(0, 1) + fun0b - temp36*rp1*fun0zb + temp34&
&          *temp35b1 + temp37b
        CALL POPREAL8(adr8ibuf,adr8buf,rp2)
        CALL POPREAL8(adr8ibuf,adr8buf,rp3)
        rb(0) = rb(0) + dd1*2*r(0)*rp1b
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
! enddo fot ic                                   
        indorbp = indorb
        DO ic=1,5
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        DO ic=5,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            zb(indorbp, indt+1:indt+4) = 0.0_8
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=indtm,i0,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 2) THEN
            temp34b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
            temp33 = 4.d0*dd1
            temp32 = 7.d0/temp33
            temp32b = (temp32-r(k)**2*cost)*zb(indorbp, k)
            costb = -(r(k)**2*temp34b)
            temp32b0 = costb/rp3
            rp2b = 2.d0*temp32b0
            rp3b = rp2b/rp3 + (1.0_8-(rp3+2.d0*rp2)/rp3)*temp32b0
            rp1b = rp3b
            dd1b = dd1b + r(k)**2*rp1b - temp32*4.d0*temp34b/temp33
            rb(k) = rb(k) + dd1*2*r(k)*rp1b - cost*2*r(k)*temp34b
            distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp32b
            distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp32b
            zb(indorbp, k) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,cost)
            CALL POPREAL8(adr8ibuf,adr8buf,rp2)
            CALL POPREAL8(adr8ibuf,adr8buf,rp3)
          ELSE
            zb(indorbp, k) = 0.0_8
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 3) THEN
        IF (branch .LT. 2) THEN
          distpb(k, 1) = 0.0_8
          costb = 0.0_8
          GOTO 150
        END IF
      ELSE
        distpb(k, 1) = -distpb(k, 1)
      END IF
      temp31 = DLOG(-(cost/9.d0) + 1.d0)
      temp31b6 = c*DEXP(-cost-temp31**2)*distpb(k, 1)
      cb = cb + DEXP(-cost-temp31**2)*distpb(k, 1)
      costb = (2*temp31/((1.d0-cost/9.d0)*9.d0)-1.0)*temp31b6
      distpb(k, 1) = 0.0_8
 150  CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd1b = dd1b + r(k)**2*costb
      rb(k) = rb(k) + dd1*2*r(k)*costb
    END DO
    dd1b = dd1b + ratiod*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (48) 
!endif for indt                                         
!        indpar=indpar+1 
!        indshell=indshell+5 
!        indorb=indorbp 
! f single gaussian orbital                                             
! R(r)= exp(-alpha r^2)                                                 
! normalized                                                            
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then 
! overall normalization                                                 
!        c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)*ratiof
!        ratiof-->ratiof*8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)
    c = dd1**2.25d0*ratiof
!         endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2
      IF (cost .GE. 9.d0) THEN
        distp(k, 1) = 0.d0
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        distp(k, 1) = c*DEXP(-cost-DLOG(1.d0-cost/9.d0)**2)
        IF (r(k) .LT. 0.d0) THEN
          distp(k, 1) = -distp(k, 1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END IF
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0        
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2           
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2                   
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3     
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3     
    DO ic=1,7
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      IF (distp(0, 1) .NE. 0.d0) THEN
        fun0 = distp(0, 1)
!           the first derivative /r                                  
        rp1 = dd1*r(0)**2
        rp3 = -9.d0 + rp1
        rp2 = DLOG(-(rp3/9.d0))
        fun = -(2.d0*dd1*distp(0, 1)*(rp1-9.d0+2.d0*rp2)/rp3)
!              the second derivative                                    
        fun2 = 2.d0*dd1*distp(0, 1)*(-81.d0+176.d0*rp1-37.d0*rp1**2+2.d0&
&          *rp1**3+2.d0*rp2*(9.d0-35.d0*rp1+4.d0*rp1**2)+8.d0*rp1*rp2**2)&
&          /rp3**2
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb
        DO ic=1,7
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            DO i=1,3
              IF (ic .EQ. 1) THEN
                IF (i .EQ. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
                END IF
              ELSE IF (ic .EQ. 2) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
                ELSE IF (i .EQ. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
                END IF
              ELSE IF (ic .EQ. 3) THEN
                IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
                ELSE IF (i .EQ. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
                END IF
              ELSE IF (ic .EQ. 4) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
                END IF
              ELSE IF (ic .EQ. 5) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
                END IF
              ELSE IF (ic .EQ. 6) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
                END IF
              ELSE IF (i .EQ. 1) THEN
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              END IF
            END DO
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        distpb = 0.0_8
        funb = 0.0_8
        fun0b = 0.0_8
        DO ic=7,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            distpb(0, 1+ic) = distpb(0, 1+ic) + (fun2+8.d0*fun)*zb(&
&              indorbp, indt+4)
            funb = funb + distp(0, 1+ic)*8.d0*zb(indorbp, indt+4)
            zb(indorbp, indt+4) = 0.0_8
            DO i=3,1,-1
              CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
              IF (branch .LT. 11) THEN
                IF (branch .LT. 6) THEN
                  IF (branch .LT. 4) THEN
                    IF (branch .LT. 3) THEN
                      IF (.NOT.branch .LT. 2) THEN
                        temp42b4 = cost1f*zb(indorbp, indt+i)
                        fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2&
&                          )*temp42b4
                        rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)&
&                          *temp42b4
                        rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp42b4
                      END IF
                      temp42b2 = -(cost1f*6.d0*zb(indorbp, indt+i))
                      temp42b3 = rmu(i, 0)*temp42b2
                      rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp42b2
                      fun0b = fun0b + rmu(3, 0)*temp42b3
                      rmub(3, 0) = rmub(3, 0) + fun0*temp42b3
                      GOTO 160
                    ELSE
                      temp42b7 = cost2f*zb(indorbp, indt+i)
                      fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*&
&                        temp42b7
                      rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                        temp42b7
                      rb(0) = rb(0) - fun0*2*r(0)*temp42b7
                    END IF
                  ELSE IF (.NOT.branch .LT. 5) THEN
                    temp42b8 = cost2f*10.d0*zb(indorbp, indt+i)
                    temp42b9 = rmu(i, 0)*temp42b8
                    rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp42b8
                    fun0b = fun0b + rmu(1, 0)*temp42b9
                    rmub(1, 0) = rmub(1, 0) + fun0*temp42b9
                  END IF
                  temp42b5 = -(cost2f*2.d0*zb(indorbp, indt+i))
                  temp42b6 = rmu(i, 0)*temp42b5
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp42b5
                  fun0b = fun0b + rmu(1, 0)*temp42b6
                  rmub(1, 0) = rmub(1, 0) + fun0*temp42b6
                ELSE IF (branch .LT. 9) THEN
                  IF (branch .LT. 8) THEN
                    IF (branch .LT. 7) THEN
                      temp42b12 = cost2f*zb(indorbp, indt+i)
                      fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*&
&                        temp42b12
                      rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                        temp42b12
                      rb(0) = rb(0) - fun0*2*r(0)*temp42b12
                    END IF
                  ELSE
                    temp42b13 = cost2f*10.d0*zb(indorbp, indt+i)
                    temp42b14 = rmu(i, 0)*temp42b13
                    rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp42b13
                    fun0b = fun0b + rmu(2, 0)*temp42b14
                    rmub(2, 0) = rmub(2, 0) + fun0*temp42b14
                  END IF
                  temp42b10 = -(cost2f*2.d0*zb(indorbp, indt+i))
                  temp42b11 = rmu(i, 0)*temp42b10
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp42b10
                  fun0b = fun0b + rmu(2, 0)*temp42b11
                  rmub(2, 0) = rmub(2, 0) + fun0*temp42b11
                ELSE IF (branch .LT. 10) THEN
                  temp42b15 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp42b15
                  rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp42b15
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp42b15
                ELSE
                  temp42b16 = -(cost3f*2.d0*zb(indorbp, indt+i))
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp42b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp42b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp42b16
                END IF
              ELSE IF (branch .LT. 16) THEN
                IF (branch .LT. 14) THEN
                  IF (branch .LT. 13) THEN
                    IF (branch .LT. 12) THEN
                      temp42b17 = cost3f*zb(indorbp, indt+i)
                      fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*&
&                        temp42b17
                      rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*&
&                        temp42b17
                      rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*&
&                        temp42b17
                    ELSE
                      temp42b18 = cost3f*2.d0*zb(indorbp, indt+i)
                      fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp42b18
                      rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp42b18
                      rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp42b18
                    END IF
                  ELSE
                    temp42b19 = cost3f*2.d0*zb(indorbp, indt+i)
                    fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp42b19
                    rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp42b19
                    rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp42b19
                  END IF
                ELSE IF (branch .LT. 15) THEN
                  temp42b20 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp42b20
                  rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp42b20
                  rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp42b20
                ELSE
                  temp42b21 = cost4f*3.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp42b21
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp42b21
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp42b21
                END IF
              ELSE IF (branch .LT. 19) THEN
                IF (branch .LT. 18) THEN
                  IF (.NOT.branch .LT. 17) THEN
                    temp42b22 = -(cost4f*6.d0*zb(indorbp, indt+i))
                    fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp42b22
                    rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp42b22
                    rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp42b22
                  END IF
                ELSE
                  temp42b23 = cost4f*6.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp42b23
                  rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp42b23
                  rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp42b23
                END IF
              ELSE IF (.NOT.branch .LT. 20) THEN
                temp42b24 = cost4f*3.d0*zb(indorbp, indt+i)
                fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp42b24
                rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp42b24
                rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp42b24
              END IF
 160          temp42b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
              distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(&
&                indorbp, indt+i)
              rmub(i, 0) = rmub(i, 0) + fun*temp42b1
              funb = funb + rmu(i, 0)*temp42b1
              zb(indorbp, indt+i) = 0.0_8
            END DO
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        temp41 = dd1/rp3
        temp42b = -(2.d0*distp(0, 1)*temp41*funb)
        temp42b0 = -(2.d0*(rp1+2.d0*rp2-9.d0)*funb)
        temp41b7 = distp(0, 1)*temp42b0/rp3
        rp2b = 2.d0*temp42b
        rp3b = rp2b/rp3 - temp41*temp41b7
        rp1b = rp3b + temp42b
        distpb(0, 1) = distpb(0, 1) + fun0b + temp41*temp42b0
        dd1b = r(0)**2*rp1b + temp41b7
        rb(0) = rb(0) + dd1*2*r(0)*rp1b
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
! enddo fot ic                                   
        indorbp = indorb
        DO ic=1,7
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        DO ic=7,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            zb(indorbp, indt+1:indt+4) = 0.0_8
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=indtm,i0,-1
          distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
          zb(indorbp, k) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=indtm,indtmin,-1
      temp41b = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp41b
      distpb(i, 8) = 0.0_8
      temp41b0 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp41b0 + 3.d0*2*rmu(1, i)*temp41b
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp41b0
      distpb(i, 7) = 0.0_8
      temp41b1 = cost3f*2.d0*distpb(i, 6)
      temp41b2 = rmu(2, i)*temp41b1
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp41b2
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp41b2
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp41b1
      distpb(i, 6) = 0.0_8
      temp41b3 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp41b3
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp41b3
      temp41b4 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp41b4
      distpb(i, 4) = 0.0_8
      temp41b5 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp41b6 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp41b5 - 3.d0*2*r(i)*temp41b6 - 2*r(i)*&
&        temp41b4
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp41b6 + 5.d0*2*rmu(3, i)*&
&        temp41b5
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 3) THEN
        IF (branch .LT. 2) THEN
          distpb(k, 1) = 0.0_8
          costb = 0.0_8
          GOTO 170
        END IF
      ELSE
        distpb(k, 1) = -distpb(k, 1)
      END IF
      temp40 = DLOG(-(cost/9.d0) + 1.d0)
      temp40b6 = c*DEXP(-cost-temp40**2)*distpb(k, 1)
      cb = cb + DEXP(-cost-temp40**2)*distpb(k, 1)
      costb = (2*temp40/((1.d0-cost/9.d0)*9.d0)-1.0)*temp40b6
      distpb(k, 1) = 0.0_8
 170  CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd1b = dd1b + r(k)**2*costb
      rb(k) = rb(k) + dd1*2*r(k)*costb
    END DO
    dd1b = dd1b + ratiof*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (49) 
!endif for indt                                         
!        indpar=indpar+1 
!        indshell=indshell+7 
!        indorb=indorbp 
! derivative of 48 with respect to z                    
! f orbitals                                                            
! R(r)= c*exp(-z r^2)*(9/4/z-r^2)                                       
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!         if(iflagnorm.gt.2) then 
! overall normalization                                                 
    c = dd1**2.25d0*ratiof
!         endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2
      IF (cost .GE. 9.d0) THEN
        distp(k, 1) = 0.d0
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        distp(k, 1) = c*DEXP(-cost-DLOG(1.d0-cost/9.d0)**2)
        IF (r(k) .LT. 0.d0) THEN
          distp(k, 1) = -distp(k, 1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END IF
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0        
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2           
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2                   
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3     
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3     
    DO ic=1,7
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=i0,indtm
          IF (distp(k, 1) .NE. 0.d0) THEN
            rp1 = dd1*r(k)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,rp3)
            rp3 = -9.d0 + rp1
            CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
            rp2 = DLOG(-(rp3/9.d0))
            CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
            cost = (rp3+2.d0*rp2)/rp3
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          END IF
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      IF (distp(0, 1) .NE. 0.d0) THEN
        fun0 = distp(0, 1)
!           the first derivative /r                                  
        rp1 = dd1*r(0)**2
        CALL PUSHREAL8(adr8ibuf,adr8buf,rp3)
        rp3 = -9.d0 + rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
        rp2 = DLOG(-(rp3/9.d0))
        fun = -(2.d0*dd1*distp(0, 1)*(rp1-9.d0+2.d0*rp2)/rp3)
!              the second derivative                                    
        fun2 = 2.d0*dd1*distp(0, 1)*(-81.d0+176.d0*rp1-37.d0*rp1**2+2.d0&
&          *rp1**3+2.d0*rp2*(9.d0-35.d0*rp1+4.d0*rp1**2)+8.d0*rp1*rp2**2)&
&          /rp3**2
        fun0z = -(distp(0, 1)*rp1/dd1*(rp3+2.d0*rp2)/rp3)
        funz = 2.d0*distp(0, 1)*(-81.d0+97d0*rp1-19.d0*rp1**2+rp1**3+&
&          2.d0*rp2*(9.d0-18.d0*rp1+2.d0*rp1**2)+4.d0*rp1*rp2**2)/rp3**2
        fun2z = -(2.d0*distp(0, 1)*(-729.d0+3798d0*rp1-2594d0*rp1**2+&
&          610d0*rp1**3-59.d0*rp1**4+2.d0*rp1**5+2.d0*rp2*(81.d0-783d0*&
&          rp1+600.d0*rp1**2-112.d0*rp1**3+6.d0*rp1**4)+4.d0*rp1*rp2**2*(&
&          45.d0-53.d0*rp1+6.d0*rp1**2)+16.d0*rp1**2*rp2**3)/rp3**3)
        CALL PUSHREAL8(adr8ibuf,adr8buf,fun0)
        fun0 = 2.25d0*fun0/dd1 + fun0z
        CALL PUSHREAL8(adr8ibuf,adr8buf,fun)
        fun = 2.25d0*fun/dd1 + funz
        fun2 = 2.25d0*fun2/dd1 + fun2z
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb
        DO ic=1,7
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            DO i=1,3
              IF (ic .EQ. 1) THEN
                IF (i .EQ. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
                END IF
              ELSE IF (ic .EQ. 2) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
                ELSE IF (i .EQ. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
                END IF
              ELSE IF (ic .EQ. 3) THEN
                IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
                ELSE IF (i .EQ. 3) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
                END IF
              ELSE IF (ic .EQ. 4) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
                END IF
              ELSE IF (ic .EQ. 5) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
                END IF
              ELSE IF (ic .EQ. 6) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
                END IF
              ELSE IF (i .EQ. 1) THEN
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
              ELSE IF (i .EQ. 2) THEN
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
              END IF
            END DO
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        distpb = 0.0_8
        funb = 0.0_8
        fun0b = 0.0_8
        DO ic=7,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            distpb(0, 1+ic) = distpb(0, 1+ic) + (fun2+8.d0*fun)*zb(&
&              indorbp, indt+4)
            funb = funb + distp(0, 1+ic)*8.d0*zb(indorbp, indt+4)
            zb(indorbp, indt+4) = 0.0_8
            DO i=3,1,-1
              CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
              IF (branch .LT. 11) THEN
                IF (branch .LT. 6) THEN
                  IF (branch .LT. 4) THEN
                    IF (branch .LT. 3) THEN
                      IF (.NOT.branch .LT. 2) THEN
                        temp51b4 = cost1f*zb(indorbp, indt+i)
                        fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2&
&                          )*temp51b4
                        rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)&
&                          *temp51b4
                        rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp51b4
                      END IF
                      temp51b2 = -(cost1f*6.d0*zb(indorbp, indt+i))
                      temp51b3 = rmu(i, 0)*temp51b2
                      rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp51b2
                      fun0b = fun0b + rmu(3, 0)*temp51b3
                      rmub(3, 0) = rmub(3, 0) + fun0*temp51b3
                      GOTO 180
                    ELSE
                      temp51b7 = cost2f*zb(indorbp, indt+i)
                      fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*&
&                        temp51b7
                      rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                        temp51b7
                      rb(0) = rb(0) - fun0*2*r(0)*temp51b7
                    END IF
                  ELSE IF (.NOT.branch .LT. 5) THEN
                    temp51b8 = cost2f*10.d0*zb(indorbp, indt+i)
                    temp51b9 = rmu(i, 0)*temp51b8
                    rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp51b8
                    fun0b = fun0b + rmu(1, 0)*temp51b9
                    rmub(1, 0) = rmub(1, 0) + fun0*temp51b9
                  END IF
                  temp51b5 = -(cost2f*2.d0*zb(indorbp, indt+i))
                  temp51b6 = rmu(i, 0)*temp51b5
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp51b5
                  fun0b = fun0b + rmu(1, 0)*temp51b6
                  rmub(1, 0) = rmub(1, 0) + fun0*temp51b6
                ELSE IF (branch .LT. 9) THEN
                  IF (branch .LT. 8) THEN
                    IF (branch .LT. 7) THEN
                      temp51b12 = cost2f*zb(indorbp, indt+i)
                      fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*&
&                        temp51b12
                      rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                        temp51b12
                      rb(0) = rb(0) - fun0*2*r(0)*temp51b12
                    END IF
                  ELSE
                    temp51b13 = cost2f*10.d0*zb(indorbp, indt+i)
                    temp51b14 = rmu(i, 0)*temp51b13
                    rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp51b13
                    fun0b = fun0b + rmu(2, 0)*temp51b14
                    rmub(2, 0) = rmub(2, 0) + fun0*temp51b14
                  END IF
                  temp51b10 = -(cost2f*2.d0*zb(indorbp, indt+i))
                  temp51b11 = rmu(i, 0)*temp51b10
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp51b10
                  fun0b = fun0b + rmu(2, 0)*temp51b11
                  rmub(2, 0) = rmub(2, 0) + fun0*temp51b11
                ELSE IF (branch .LT. 10) THEN
                  temp51b15 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp51b15
                  rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp51b15
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp51b15
                ELSE
                  temp51b16 = -(cost3f*2.d0*zb(indorbp, indt+i))
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp51b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp51b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp51b16
                END IF
              ELSE IF (branch .LT. 16) THEN
                IF (branch .LT. 14) THEN
                  IF (branch .LT. 13) THEN
                    IF (branch .LT. 12) THEN
                      temp51b17 = cost3f*zb(indorbp, indt+i)
                      fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*&
&                        temp51b17
                      rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*&
&                        temp51b17
                      rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*&
&                        temp51b17
                    ELSE
                      temp51b18 = cost3f*2.d0*zb(indorbp, indt+i)
                      fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp51b18
                      rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp51b18
                      rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp51b18
                    END IF
                  ELSE
                    temp51b19 = cost3f*2.d0*zb(indorbp, indt+i)
                    fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp51b19
                    rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp51b19
                    rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp51b19
                  END IF
                ELSE IF (branch .LT. 15) THEN
                  temp51b20 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp51b20
                  rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp51b20
                  rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp51b20
                ELSE
                  temp51b21 = cost4f*3.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp51b21
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp51b21
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp51b21
                END IF
              ELSE IF (branch .LT. 19) THEN
                IF (branch .LT. 18) THEN
                  IF (.NOT.branch .LT. 17) THEN
                    temp51b22 = -(cost4f*6.d0*zb(indorbp, indt+i))
                    fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp51b22
                    rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp51b22
                    rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp51b22
                  END IF
                ELSE
                  temp51b23 = cost4f*6.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp51b23
                  rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp51b23
                  rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp51b23
                END IF
              ELSE IF (.NOT.branch .LT. 20) THEN
                temp51b24 = cost4f*3.d0*zb(indorbp, indt+i)
                fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp51b24
                rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp51b24
                rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp51b24
              END IF
 180          temp51b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
              distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(&
&                indorbp, indt+i)
              rmub(i, 0) = rmub(i, 0) + fun*temp51b1
              funb = funb + rmu(i, 0)*temp51b1
              zb(indorbp, indt+i) = 0.0_8
            END DO
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        CALL POPREAL8(adr8ibuf,adr8buf,fun)
        temp51b = 2.25d0*funb/dd1
        funzb = funb
        funb = temp51b
        CALL POPREAL8(adr8ibuf,adr8buf,fun0)
        temp51b0 = 2.25d0*fun0b/dd1
        fun0zb = fun0b
        temp50 = rp3**2
        temp48 = distp(0, 1)/temp50
        temp49 = 2.d0*rp1**2 - 18.d0*rp1 + 9.d0
        temp50b = 2.d0*temp48*funzb
        temp49b = 2.d0*rp2*temp50b
        temp48b = 2.d0*(97d0*rp1-19.d0*rp1**2+rp1**3+2.d0*(rp2*temp49)+&
&          4.d0*(rp1*rp2**2)-81.d0)*funzb/temp50
        temp46 = dd1*rp3
        temp47b = -(distp(0, 1)*rp1*fun0zb/temp46)
        temp45 = dd1/rp3
        temp46b = -(2.d0*distp(0, 1)*temp45*funb)
        rp2b = 2.d0*temp47b + 2.d0*temp46b + (4.d0*rp1*2*rp2+2.d0*temp49&
&          )*temp50b
        temp47 = (rp3+2.d0*rp2)/temp46
        temp46b0 = -(temp47*temp47b)
        temp46b1 = -(2.d0*(rp1+2.d0*rp2-9.d0)*funb)
        temp45b0 = distp(0, 1)*temp46b1/rp3
        rp3b = temp47b + dd1*temp46b0 + rp2b/rp3 - temp45*temp45b0 - &
&          temp48*2*rp3*temp48b
        rp1b = rp3b - temp47*distp(0, 1)*fun0zb + temp46b + (2.d0*2*rp1-&
&          18.d0)*temp49b + (4.d0*rp2**2+3*rp1**2-19.d0*2*rp1+97d0)*&
&          temp50b
        dd1b = temp45b0 - fun0*temp51b0/dd1 + r(0)**2*rp1b + rp3*&
&          temp46b0 - fun*temp51b/dd1
        fun0b = temp51b0
        distpb(0, 1) = distpb(0, 1) + fun0b - temp47*rp1*fun0zb + temp45&
&          *temp46b1 + temp48b
        CALL POPREAL8(adr8ibuf,adr8buf,rp2)
        CALL POPREAL8(adr8ibuf,adr8buf,rp3)
        rb(0) = rb(0) + dd1*2*r(0)*rp1b
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
! enddo fot ic                                   
        indorbp = indorb
        DO ic=1,7
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        DO ic=7,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            zb(indorbp, indt+1:indt+4) = 0.0_8
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=indtm,i0,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 2) THEN
            temp45b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
            temp44 = 4.d0*dd1
            temp43 = 9.d0/temp44
            temp43b7 = (temp43-r(k)**2*cost)*zb(indorbp, k)
            costb = -(r(k)**2*temp45b)
            temp43b8 = costb/rp3
            rp2b = 2.d0*temp43b8
            rp3b = rp2b/rp3 + (1.0_8-(rp3+2.d0*rp2)/rp3)*temp43b8
            rp1b = rp3b
            dd1b = dd1b + r(k)**2*rp1b - temp43*4.d0*temp45b/temp44
            rb(k) = rb(k) + dd1*2*r(k)*rp1b - cost*2*r(k)*temp45b
            distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp43b7
            distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp43b7
            zb(indorbp, k) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,cost)
            CALL POPREAL8(adr8ibuf,adr8buf,rp2)
            CALL POPREAL8(adr8ibuf,adr8buf,rp3)
          ELSE
            zb(indorbp, k) = 0.0_8
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=indtm,indtmin,-1
      temp43b = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp43b
      distpb(i, 8) = 0.0_8
      temp43b0 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp43b0 + 3.d0*2*rmu(1, i)*temp43b
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp43b0
      distpb(i, 7) = 0.0_8
      temp43b1 = cost3f*2.d0*distpb(i, 6)
      temp43b2 = rmu(2, i)*temp43b1
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp43b2
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp43b2
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp43b1
      distpb(i, 6) = 0.0_8
      temp43b3 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp43b3
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp43b3
      temp43b4 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp43b4
      distpb(i, 4) = 0.0_8
      temp43b5 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp43b6 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp43b5 - 3.d0*2*r(i)*temp43b6 - 2*r(i)*&
&        temp43b4
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp43b6 + 5.d0*2*rmu(3, i)*&
&        temp43b5
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 3) THEN
        IF (branch .LT. 2) THEN
          distpb(k, 1) = 0.0_8
          costb = 0.0_8
          GOTO 190
        END IF
      ELSE
        distpb(k, 1) = -distpb(k, 1)
      END IF
      temp42 = DLOG(-(cost/9.d0) + 1.d0)
      temp42b25 = c*DEXP(-cost-temp42**2)*distpb(k, 1)
      cb = cb + DEXP(-cost-temp42**2)*distpb(k, 1)
      costb = (2*temp42/((1.d0-cost/9.d0)*9.d0)-1.0)*temp42b25
      distpb(k, 1) = 0.0_8
 190  CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd1b = dd1b + r(k)**2*costb
      rb(k) = rb(k) + dd1*2*r(k)*costb
    END DO
    dd1b = dd1b + ratiof*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (51) 
!endif for indt                                         
!        indpar=indpar+1 
!        indshell=indshell+7 
!        indorb=indorbp 
! g single gaussian orbital                                             
! R(r)= exp(-alpha r^2)                                                 
! normalized                                                            
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!      if(iflagnorm.gt.2) then 
! overall normalization                                                 
!      c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)*ratiog
!      ratiog-->ratiog*16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)
    c = dd1**2.75d0*ratiog
!      endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2
      IF (cost .GE. 9.d0) THEN
        distp(k, 1) = 0.d0
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        distp(k, 1) = c*DEXP(-cost-DLOG(1.d0-cost/9.d0)**2)
        IF (r(k) .LT. 0.d0) THEN
          distp(k, 1) = -distp(k, 1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END IF
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0        
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2           
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2                   
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      IF (distp(0, 1) .NE. 0.d0) THEN
        fun0 = distp(0, 1)
!           the first derivative /r                                  
        rp1 = dd1*r(0)**2
        rp3 = -9.d0 + rp1
        rp2 = DLOG(-(rp3/9.d0))
        fun = -(2.d0*dd1*distp(0, 1)*(rp1-9.d0+2.d0*rp2)/rp3)
!              the second derivative                                    
        fun2 = 2.d0*dd1*distp(0, 1)*(-81.d0+176.d0*rp1-37.d0*rp1**2+2.d0&
&          *rp1**3+2.d0*rp2*(9.d0-35.d0*rp1+4.d0*rp1**2)+8.d0*rp1*rp2**2)&
&          /rp3**2
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb
        DO ic=1,9
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            DO i=1,3
              IF (ic .EQ. 1) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
                END IF
              ELSE IF (ic .EQ. 2) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
                END IF
              ELSE IF (ic .EQ. 3) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
                END IF
              ELSE IF (ic .EQ. 4) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
                END IF
              ELSE IF (ic .EQ. 5) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
                END IF
              ELSE IF (ic .EQ. 6) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
                END IF
              ELSE IF (ic .EQ. 7) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
                END IF
              ELSE IF (ic .EQ. 8) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
                END IF
              ELSE IF (ic .EQ. 9) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
                END IF
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
              END IF
            END DO
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        distpb = 0.0_8
        funb = 0.0_8
        fun0b = 0.0_8
        DO ic=9,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            distpb(0, 1+ic) = distpb(0, 1+ic) + (fun2+10.d0*fun)*zb(&
&              indorbp, indt+4)
            funb = funb + distp(0, 1+ic)*10.d0*zb(indorbp, indt+4)
            zb(indorbp, indt+4) = 0.0_8
            DO i=3,1,-1
              CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
              IF (branch .LT. 15) THEN
                IF (branch .LT. 8) THEN
                  IF (branch .LT. 5) THEN
                    IF (branch .LT. 3) THEN
                      IF (branch .LT. 2) THEN
                        temp53b2 = cost1g*fun0*zb(indorbp, indt+i)
                        fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2&
&                          )-60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, &
&                          indt+i)
                        rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*&
&                          rmu(3, 0)**2)*temp53b2
                        rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp53b2
                        rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(&
&                          3, 0)*temp53b2
                      ELSE
                        temp53b3 = cost1g*fun0*zb(indorbp, indt+i)
                        fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2&
&                          )-60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, &
&                          indt+i)
                        rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*&
&                          rmu(3, 0)**2)*temp53b3
                        rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp53b3
                        rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(&
&                          3, 0)*temp53b3
                      END IF
                    ELSE IF (branch .LT. 4) THEN
                      temp53b4 = cost1g*fun0*zb(indorbp, indt+i)
                      fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(&
&                        rmu(3, 0)*r(0)**2))*zb(indorbp, indt+i)
                      rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-&
&                        48.d0*r(0)**2)*temp53b4
                      rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp53b4
                    ELSE
                      temp53b5 = cost2g*fun0*zb(indorbp, indt+i)
                      fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(&
&                        rmu(2, 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3&
&                        , 0)))*zb(indorbp, indt+i)
                      rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-&
&                        3.d0*rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp53b5
                      rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, &
&                        0)*temp53b5
                      rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, &
&                        0)*temp53b5
                    END IF
                  ELSE IF (branch .LT. 7) THEN
                    IF (branch .LT. 6) THEN
                      temp53b6 = -(cost2g*6.d0*zb(indorbp, indt+i))
                      temp53b7 = rmu(2, 0)*rmu(3, 0)*temp53b6
                      temp53b8 = fun0*rmu(1, 0)*temp53b6
                      fun0b = fun0b + rmu(1, 0)*temp53b7
                      rmub(1, 0) = rmub(1, 0) + fun0*temp53b7
                      rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp53b8
                      rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp53b8
                    ELSE
                      temp53b9 = -(cost2g*3.d0*zb(indorbp, indt+i))
                      temp53b10 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3&
&                        , 0)**2)*temp53b9
                      temp53b11 = fun0*rmu(1, 0)*temp53b9
                      fun0b = fun0b + rmu(1, 0)*temp53b10
                      rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp53b11 + &
&                        fun0*temp53b10
                      rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp53b11
                      rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*&
&                        temp53b11
                    END IF
                  ELSE
                    temp53b12 = -(cost2g*6.d0*zb(indorbp, indt+i))
                    temp53b13 = rmu(2, 0)*rmu(3, 0)*temp53b12
                    temp53b14 = fun0*rmu(1, 0)*temp53b12
                    fun0b = fun0b + rmu(1, 0)*temp53b13
                    rmub(1, 0) = rmub(1, 0) + fun0*temp53b13
                    rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp53b14
                    rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp53b14
                  END IF
                ELSE IF (branch .LT. 12) THEN
                  IF (branch .LT. 10) THEN
                    IF (branch .LT. 9) THEN
                      temp53b15 = cost2g*fun0*zb(indorbp, indt+i)
                      fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(&
&                        rmu(2, 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3&
&                        , 0)))*zb(indorbp, indt+i)
                      rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-&
&                        9.d0*rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp53b15
                      rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, &
&                        0)*temp53b15
                      rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, &
&                        0)*temp53b15
                    ELSE
                      temp53b16 = -(cost2g*3.d0*zb(indorbp, indt+i))
                      temp53b17 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3&
&                        , 0)**2)*temp53b16
                      temp53b18 = fun0*rmu(2, 0)*temp53b16
                      fun0b = fun0b + rmu(2, 0)*temp53b17
                      rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp53b18 + &
&                        fun0*temp53b17
                      rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp53b18
                      rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*&
&                        temp53b18
                    END IF
                  ELSE IF (branch .LT. 11) THEN
                    temp53b19 = -(cost3g*4.d0*zb(indorbp, indt+i))
                    temp53b20 = fun0*temp53b19
                    fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3&
&                      , 0)**2))*temp53b19
                    rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3&
&                      , 0)**2)*temp53b20
                    rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)&
&                      *temp53b20
                  ELSE
                    temp53b21 = cost3g*4.d0*zb(indorbp, indt+i)
                    temp53b22 = fun0*temp53b21
                    fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3&
&                      , 0)**2))*temp53b21
                    rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3&
&                      , 0)**2)*temp53b22
                    rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)&
&                      *temp53b22
                  END IF
                ELSE IF (branch .LT. 14) THEN
                  IF (branch .LT. 13) THEN
                    temp53b23 = cost3g*12.d0*zb(indorbp, indt+i)
                    temp53b24 = fun0*rmu(3, 0)*temp53b23
                    temp53b25 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp53b23
                    rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp53b24
                    rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp53b24
                    fun0b = fun0b + rmu(3, 0)*temp53b25
                    rmub(3, 0) = rmub(3, 0) + fun0*temp53b25
                  ELSE
                    temp53b26 = -(cost3g*2.d0*zb(indorbp, indt+i))
                    temp53b27 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu&
&                      (3, 0)**2)*temp53b26
                    temp53b28 = fun0*rmu(2, 0)*temp53b26
                    fun0b = fun0b + rmu(2, 0)*temp53b27
                    rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp53b28 + &
&                      fun0*temp53b27
                    rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp53b28
                    rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp53b28
                  END IF
                ELSE
                  temp53b29 = -(cost3g*2.d0*zb(indorbp, indt+i))
                  temp53b30 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3&
&                    , 0)**2)*temp53b29
                  temp53b31 = fun0*rmu(1, 0)*temp53b29
                  fun0b = fun0b + rmu(1, 0)*temp53b30
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp53b31 + fun0&
&                    *temp53b30
                  rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp53b31
                  rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp53b31
                END IF
              ELSE IF (branch .LT. 22) THEN
                IF (branch .LT. 19) THEN
                  IF (branch .LT. 17) THEN
                    IF (branch .LT. 16) THEN
                      temp53b32 = cost3g*24.d0*zb(indorbp, indt+i)
                      temp53b33 = rmu(2, 0)*rmu(3, 0)*temp53b32
                      temp53b34 = fun0*rmu(1, 0)*temp53b32
                      fun0b = fun0b + rmu(1, 0)*temp53b33
                      rmub(1, 0) = rmub(1, 0) + fun0*temp53b33
                      rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp53b34
                      rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp53b34
                    ELSE
                      temp53b35 = cost4g*3.d0*zb(indorbp, indt+i)
                      temp53b36 = fun0*rmu(3, 0)*temp53b35
                      temp53b37 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp53b35
                      rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp53b36
                      rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp53b36
                      fun0b = fun0b + rmu(3, 0)*temp53b37
                      rmub(3, 0) = rmub(3, 0) + fun0*temp53b37
                    END IF
                  ELSE IF (branch .LT. 18) THEN
                    temp53b38 = -(cost4g*6.d0*zb(indorbp, indt+i))
                    temp53b39 = rmu(2, 0)*rmu(3, 0)*temp53b38
                    temp53b40 = fun0*rmu(1, 0)*temp53b38
                    fun0b = fun0b + rmu(1, 0)*temp53b39
                    rmub(1, 0) = rmub(1, 0) + fun0*temp53b39
                    rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp53b40
                    rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp53b40
                  ELSE
                    temp53b41 = cost4g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)&
&                      *rmu(2, 0)**2))*zb(indorbp, indt+i)
                    rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2&
&                      , 0)**2)*temp53b41
                    rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)&
&                      *temp53b41
                  END IF
                ELSE IF (branch .LT. 21) THEN
                  IF (branch .LT. 20) THEN
                    temp53b42 = cost4g*6.d0*zb(indorbp, indt+i)
                    temp53b43 = rmu(2, 0)*rmu(3, 0)*temp53b42
                    temp53b44 = fun0*rmu(1, 0)*temp53b42
                    fun0b = fun0b + rmu(1, 0)*temp53b43
                    rmub(1, 0) = rmub(1, 0) + fun0*temp53b43
                    rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp53b44
                    rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp53b44
                  ELSE
                    temp53b45 = cost4g*3.d0*zb(indorbp, indt+i)
                    temp53b46 = fun0*rmu(3, 0)*temp53b45
                    temp53b47 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp53b45
                    rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp53b46
                    rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp53b46
                    fun0b = fun0b + rmu(3, 0)*temp53b47
                    rmub(3, 0) = rmub(3, 0) + fun0*temp53b47
                  END IF
                ELSE
                  temp53b48 = cost4g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-&
&                    rmu(2, 0)**3)*zb(indorbp, indt+i)
                  rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                    temp53b48
                  rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, &
&                    0)**2)*temp53b48
                END IF
              ELSE IF (branch .LT. 26) THEN
                IF (branch .LT. 24) THEN
                  IF (branch .LT. 23) THEN
                    temp53b49 = cost5g*4.d0*zb(indorbp, indt+i)
                    temp53b50 = fun0*temp53b49
                    fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2&
&                      , 0)**2))*temp53b49
                    rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2&
&                      , 0)**2)*temp53b50
                    rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)&
&                      *temp53b50
                  END IF
                ELSE IF (branch .LT. 25) THEN
                  temp53b51 = cost5g*4.d0*zb(indorbp, indt+i)
                  temp53b52 = fun0*temp53b51
                  fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2&
&                    , 0)))*temp53b51
                  rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, &
&                    0)**2)*temp53b52
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                    temp53b52
                END IF
              ELSE IF (branch .LT. 28) THEN
                IF (branch .LT. 27) THEN
                  temp53b53 = cost5g*4.d0*zb(indorbp, indt+i)
                  temp53b54 = fun0*temp53b53
                  fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, &
&                    0)**3)*temp53b53
                  rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                    temp53b54
                  rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, &
&                    0)**2)*temp53b54
                END IF
              ELSE
                temp53b55 = cost5g*4.d0*zb(indorbp, indt+i)
                temp53b56 = fun0*temp53b55
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp53b55
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp53b56
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp53b56
              END IF
              temp53b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
              distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(&
&                indorbp, indt+i)
              rmub(i, 0) = rmub(i, 0) + fun*temp53b1
              funb = funb + rmu(i, 0)*temp53b1
              zb(indorbp, indt+i) = 0.0_8
            END DO
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        temp52 = dd1/rp3
        temp53b = -(2.d0*distp(0, 1)*temp52*funb)
        temp53b0 = -(2.d0*(rp1+2.d0*rp2-9.d0)*funb)
        temp52b17 = distp(0, 1)*temp53b0/rp3
        rp2b = 2.d0*temp53b
        rp3b = rp2b/rp3 - temp52*temp52b17
        rp1b = rp3b + temp53b
        distpb(0, 1) = distpb(0, 1) + fun0b + temp52*temp53b0
        dd1b = r(0)**2*rp1b + temp52b17
        rb(0) = rb(0) + dd1*2*r(0)*rp1b
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
! enddo fot ic                                   
        indorbp = indorb
        DO ic=1,9
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        DO ic=9,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            zb(indorbp, indt+1:indt+4) = 0.0_8
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=9,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=indtm,i0,-1
          distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
          zb(indorbp, k) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=indtm,indtmin,-1
      temp52b = cost5g*4.d0*distpb(i, 10)
      temp52b0 = (rmu(1, i)**2-rmu(2, i)**2)*temp52b
      temp52b1 = rmu(1, i)*rmu(2, i)*temp52b
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp52b1 + rmu(2, i)*&
&        temp52b0
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp52b0 - 2*rmu(2, i)*&
&        temp52b1
      distpb(i, 10) = 0.0_8
      temp52b2 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp52b2
      distpb(i, 9) = 0.0_8
      temp52b3 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp52b4 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp52b3 - 2*rmu(2, i)*&
&        temp52b4 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp52b2
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp52b3
      distpb(i, 8) = 0.0_8
      temp52b5 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp52b6 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp52b5 + 2*rmu(1, i)*&
&        temp52b6 + 3.d0*2*rmu(1, i)*temp52b4
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp52b5
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp52b6
      distpb(i, 7) = 0.0_8
      temp52b7 = cost3g*2.d0*distpb(i, 6)
      temp52b8 = (7.d0*rmu(3, i)**2-r(i)**2)*temp52b7
      temp52b9 = rmu(1, i)*rmu(2, i)*temp52b7
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp52b8
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp52b8
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp52b9
      distpb(i, 6) = 0.0_8
      temp52b10 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp52b11 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp52b12 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp52b13 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp52b14 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp52b15 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp52b16 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp52b16 - 3.d0*2*r(i)*temp52b15 - 2*r(i)*temp52b11 - 3.d0*2*r(&
&        i)*temp52b13 - 2*r(i)*temp52b9
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp52b10
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp52b10
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp52b11
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp52b12
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp52b13 + rmu(2, i)*&
&        temp52b12
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp52b14
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp52b16 + 7.d0*2*rmu(3, i)*temp52b15 + rmu(1, i)*&
&        temp52b14
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 3) THEN
        IF (branch .LT. 2) THEN
          distpb(k, 1) = 0.0_8
          costb = 0.0_8
          GOTO 200
        END IF
      ELSE
        distpb(k, 1) = -distpb(k, 1)
      END IF
      temp51 = DLOG(-(cost/9.d0) + 1.d0)
      temp51b25 = c*DEXP(-cost-temp51**2)*distpb(k, 1)
      cb = cb + DEXP(-cost-temp51**2)*distpb(k, 1)
      costb = (2*temp51/((1.d0-cost/9.d0)*9.d0)-1.0)*temp51b25
      distpb(k, 1) = 0.0_8
 200  CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd1b = dd1b + r(k)**2*costb
      rb(k) = rb(k) + dd1*2*r(k)*costb
    END DO
    dd1b = dd1b + ratiog*2.75d0*dd1**1.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (52) 
!endif for indt                                         
!        indpar=indpar+1 
!        indshell=indshell+9
!        indorb=indorbp 
! g single gaussian orbital                                             
! derivative of 51
! R(r)= exp(-alpha r^2)                                                 
! normalized                                                            
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!      if(iflagnorm.gt.2) then 
! overall normalization                                                 
    c = dd1**2.75d0*ratiog
!      c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)*ratiog
!      endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2
      IF (cost .GE. 9.d0) THEN
        distp(k, 1) = 0.d0
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        distp(k, 1) = c*DEXP(-cost-DLOG(1.d0-cost/9.d0)**2)
        IF (r(k) .LT. 0.d0) THEN
          distp(k, 1) = -distp(k, 1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END IF
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0        
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2           
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2                   
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        DO k=i0,indtm
          IF (distp(k, 1) .NE. 0.d0) THEN
            rp1 = dd1*r(k)**2
            CALL PUSHREAL8(adr8ibuf,adr8buf,rp3)
            rp3 = -9.d0 + rp1
            CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
            rp2 = DLOG(-(rp3/9.d0))
            CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
            cost = (rp3+2.d0*rp2)/rp3
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          END IF
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    IF (typec .NE. 1) THEN
      IF (distp(0, 1) .NE. 0.d0) THEN
        fun0 = distp(0, 1)
!           the first derivative /r                                  
        rp1 = dd1*r(0)**2
        CALL PUSHREAL8(adr8ibuf,adr8buf,rp3)
        rp3 = -9.d0 + rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,rp2)
        rp2 = DLOG(-(rp3/9.d0))
        fun = -(2.d0*dd1*distp(0, 1)*(rp1-9.d0+2.d0*rp2)/rp3)
!              the second derivative                                    
        fun2 = 2.d0*dd1*distp(0, 1)*(-81.d0+176.d0*rp1-37.d0*rp1**2+2.d0&
&          *rp1**3+2.d0*rp2*(9.d0-35.d0*rp1+4.d0*rp1**2)+8.d0*rp1*rp2**2)&
&          /rp3**2
        fun0z = -(distp(0, 1)*rp1/dd1*(rp3+2.d0*rp2)/rp3)
        funz = 2.d0*distp(0, 1)*(-81.d0+97d0*rp1-19.d0*rp1**2+rp1**3+&
&          2.d0*rp2*(9.d0-18.d0*rp1+2.d0*rp1**2)+4.d0*rp1*rp2**2)/rp3**2
        fun2z = -(2.d0*distp(0, 1)*(-729.d0+3798d0*rp1-2594d0*rp1**2+&
&          610d0*rp1**3-59.d0*rp1**4+2.d0*rp1**5+2.d0*rp2*(81.d0-783d0*&
&          rp1+600.d0*rp1**2-112.d0*rp1**3+6.d0*rp1**4)+4.d0*rp1*rp2**2*(&
&          45.d0-53.d0*rp1+6.d0*rp1**2)+16.d0*rp1**2*rp2**3)/rp3**3)
        CALL PUSHREAL8(adr8ibuf,adr8buf,fun0)
        fun0 = 2.75d0*fun0/dd1 + fun0z
        CALL PUSHREAL8(adr8ibuf,adr8buf,fun)
        fun = 2.75d0*fun/dd1 + funz
        fun2 = 2.75d0*fun2/dd1 + fun2z
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb
        DO ic=1,9
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            DO i=1,3
              IF (ic .EQ. 1) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
                END IF
              ELSE IF (ic .EQ. 2) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
                END IF
              ELSE IF (ic .EQ. 3) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
                END IF
              ELSE IF (ic .EQ. 4) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
                END IF
              ELSE IF (ic .EQ. 5) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
                END IF
              ELSE IF (ic .EQ. 6) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
                END IF
              ELSE IF (ic .EQ. 7) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
                END IF
              ELSE IF (ic .EQ. 8) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
                END IF
              ELSE IF (ic .EQ. 9) THEN
                IF (i .EQ. 1) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
                ELSE IF (i .EQ. 2) THEN
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
                ELSE
                  CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
                END IF
              ELSE
                CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
              END IF
            END DO
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        distpb = 0.0_8
        funb = 0.0_8
        fun0b = 0.0_8
        DO ic=9,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            distpb(0, 1+ic) = distpb(0, 1+ic) + (fun2+10.d0*fun)*zb(&
&              indorbp, indt+4)
            funb = funb + distp(0, 1+ic)*10.d0*zb(indorbp, indt+4)
            zb(indorbp, indt+4) = 0.0_8
            DO i=3,1,-1
              CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
              IF (branch .LT. 15) THEN
                IF (branch .LT. 8) THEN
                  IF (branch .LT. 5) THEN
                    IF (branch .LT. 3) THEN
                      IF (branch .LT. 2) THEN
                        temp62b2 = cost1g*fun0*zb(indorbp, indt+i)
                        fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2&
&                          )-60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, &
&                          indt+i)
                        rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*&
&                          rmu(3, 0)**2)*temp62b2
                        rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp62b2
                        rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(&
&                          3, 0)*temp62b2
                      ELSE
                        temp62b3 = cost1g*fun0*zb(indorbp, indt+i)
                        fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2&
&                          )-60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, &
&                          indt+i)
                        rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*&
&                          rmu(3, 0)**2)*temp62b3
                        rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp62b3
                        rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(&
&                          3, 0)*temp62b3
                      END IF
                    ELSE IF (branch .LT. 4) THEN
                      temp62b4 = cost1g*fun0*zb(indorbp, indt+i)
                      fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(&
&                        rmu(3, 0)*r(0)**2))*zb(indorbp, indt+i)
                      rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-&
&                        48.d0*r(0)**2)*temp62b4
                      rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp62b4
                    ELSE
                      temp62b5 = cost2g*fun0*zb(indorbp, indt+i)
                      fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(&
&                        rmu(2, 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3&
&                        , 0)))*zb(indorbp, indt+i)
                      rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-&
&                        3.d0*rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp62b5
                      rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, &
&                        0)*temp62b5
                      rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, &
&                        0)*temp62b5
                    END IF
                  ELSE IF (branch .LT. 7) THEN
                    IF (branch .LT. 6) THEN
                      temp62b6 = -(cost2g*6.d0*zb(indorbp, indt+i))
                      temp62b7 = rmu(2, 0)*rmu(3, 0)*temp62b6
                      temp62b8 = fun0*rmu(1, 0)*temp62b6
                      fun0b = fun0b + rmu(1, 0)*temp62b7
                      rmub(1, 0) = rmub(1, 0) + fun0*temp62b7
                      rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp62b8
                      rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp62b8
                    ELSE
                      temp62b9 = -(cost2g*3.d0*zb(indorbp, indt+i))
                      temp62b10 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3&
&                        , 0)**2)*temp62b9
                      temp62b11 = fun0*rmu(1, 0)*temp62b9
                      fun0b = fun0b + rmu(1, 0)*temp62b10
                      rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp62b11 + &
&                        fun0*temp62b10
                      rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp62b11
                      rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*&
&                        temp62b11
                    END IF
                  ELSE
                    temp62b12 = -(cost2g*6.d0*zb(indorbp, indt+i))
                    temp62b13 = rmu(2, 0)*rmu(3, 0)*temp62b12
                    temp62b14 = fun0*rmu(1, 0)*temp62b12
                    fun0b = fun0b + rmu(1, 0)*temp62b13
                    rmub(1, 0) = rmub(1, 0) + fun0*temp62b13
                    rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp62b14
                    rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp62b14
                  END IF
                ELSE IF (branch .LT. 12) THEN
                  IF (branch .LT. 10) THEN
                    IF (branch .LT. 9) THEN
                      temp62b15 = cost2g*fun0*zb(indorbp, indt+i)
                      fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(&
&                        rmu(2, 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3&
&                        , 0)))*zb(indorbp, indt+i)
                      rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-&
&                        9.d0*rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp62b15
                      rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, &
&                        0)*temp62b15
                      rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, &
&                        0)*temp62b15
                    ELSE
                      temp62b16 = -(cost2g*3.d0*zb(indorbp, indt+i))
                      temp62b17 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3&
&                        , 0)**2)*temp62b16
                      temp62b18 = fun0*rmu(2, 0)*temp62b16
                      fun0b = fun0b + rmu(2, 0)*temp62b17
                      rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp62b18 + &
&                        fun0*temp62b17
                      rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp62b18
                      rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*&
&                        temp62b18
                    END IF
                  ELSE IF (branch .LT. 11) THEN
                    temp62b19 = -(cost3g*4.d0*zb(indorbp, indt+i))
                    temp62b20 = fun0*temp62b19
                    fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3&
&                      , 0)**2))*temp62b19
                    rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3&
&                      , 0)**2)*temp62b20
                    rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)&
&                      *temp62b20
                  ELSE
                    temp62b21 = cost3g*4.d0*zb(indorbp, indt+i)
                    temp62b22 = fun0*temp62b21
                    fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3&
&                      , 0)**2))*temp62b21
                    rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3&
&                      , 0)**2)*temp62b22
                    rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)&
&                      *temp62b22
                  END IF
                ELSE IF (branch .LT. 14) THEN
                  IF (branch .LT. 13) THEN
                    temp62b23 = cost3g*12.d0*zb(indorbp, indt+i)
                    temp62b24 = fun0*rmu(3, 0)*temp62b23
                    temp62b25 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp62b23
                    rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp62b24
                    rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp62b24
                    fun0b = fun0b + rmu(3, 0)*temp62b25
                    rmub(3, 0) = rmub(3, 0) + fun0*temp62b25
                  ELSE
                    temp62b26 = -(cost3g*2.d0*zb(indorbp, indt+i))
                    temp62b27 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu&
&                      (3, 0)**2)*temp62b26
                    temp62b28 = fun0*rmu(2, 0)*temp62b26
                    fun0b = fun0b + rmu(2, 0)*temp62b27
                    rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp62b28 + &
&                      fun0*temp62b27
                    rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp62b28
                    rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp62b28
                  END IF
                ELSE
                  temp62b29 = -(cost3g*2.d0*zb(indorbp, indt+i))
                  temp62b30 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3&
&                    , 0)**2)*temp62b29
                  temp62b31 = fun0*rmu(1, 0)*temp62b29
                  fun0b = fun0b + rmu(1, 0)*temp62b30
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp62b31 + fun0&
&                    *temp62b30
                  rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp62b31
                  rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp62b31
                END IF
              ELSE IF (branch .LT. 22) THEN
                IF (branch .LT. 19) THEN
                  IF (branch .LT. 17) THEN
                    IF (branch .LT. 16) THEN
                      temp62b32 = cost3g*24.d0*zb(indorbp, indt+i)
                      temp62b33 = rmu(2, 0)*rmu(3, 0)*temp62b32
                      temp62b34 = fun0*rmu(1, 0)*temp62b32
                      fun0b = fun0b + rmu(1, 0)*temp62b33
                      rmub(1, 0) = rmub(1, 0) + fun0*temp62b33
                      rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp62b34
                      rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp62b34
                    ELSE
                      temp62b35 = cost4g*3.d0*zb(indorbp, indt+i)
                      temp62b36 = fun0*rmu(3, 0)*temp62b35
                      temp62b37 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp62b35
                      rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp62b36
                      rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp62b36
                      fun0b = fun0b + rmu(3, 0)*temp62b37
                      rmub(3, 0) = rmub(3, 0) + fun0*temp62b37
                    END IF
                  ELSE IF (branch .LT. 18) THEN
                    temp62b38 = -(cost4g*6.d0*zb(indorbp, indt+i))
                    temp62b39 = rmu(2, 0)*rmu(3, 0)*temp62b38
                    temp62b40 = fun0*rmu(1, 0)*temp62b38
                    fun0b = fun0b + rmu(1, 0)*temp62b39
                    rmub(1, 0) = rmub(1, 0) + fun0*temp62b39
                    rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp62b40
                    rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp62b40
                  ELSE
                    temp62b41 = cost4g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)&
&                      *rmu(2, 0)**2))*zb(indorbp, indt+i)
                    rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2&
&                      , 0)**2)*temp62b41
                    rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)&
&                      *temp62b41
                  END IF
                ELSE IF (branch .LT. 21) THEN
                  IF (branch .LT. 20) THEN
                    temp62b42 = cost4g*6.d0*zb(indorbp, indt+i)
                    temp62b43 = rmu(2, 0)*rmu(3, 0)*temp62b42
                    temp62b44 = fun0*rmu(1, 0)*temp62b42
                    fun0b = fun0b + rmu(1, 0)*temp62b43
                    rmub(1, 0) = rmub(1, 0) + fun0*temp62b43
                    rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp62b44
                    rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp62b44
                  ELSE
                    temp62b45 = cost4g*3.d0*zb(indorbp, indt+i)
                    temp62b46 = fun0*rmu(3, 0)*temp62b45
                    temp62b47 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp62b45
                    rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp62b46
                    rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp62b46
                    fun0b = fun0b + rmu(3, 0)*temp62b47
                    rmub(3, 0) = rmub(3, 0) + fun0*temp62b47
                  END IF
                ELSE
                  temp62b48 = cost4g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-&
&                    rmu(2, 0)**3)*zb(indorbp, indt+i)
                  rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                    temp62b48
                  rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, &
&                    0)**2)*temp62b48
                END IF
              ELSE IF (branch .LT. 26) THEN
                IF (branch .LT. 24) THEN
                  IF (branch .LT. 23) THEN
                    temp62b49 = cost5g*4.d0*zb(indorbp, indt+i)
                    temp62b50 = fun0*temp62b49
                    fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2&
&                      , 0)**2))*temp62b49
                    rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2&
&                      , 0)**2)*temp62b50
                    rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)&
&                      *temp62b50
                  END IF
                ELSE IF (branch .LT. 25) THEN
                  temp62b51 = cost5g*4.d0*zb(indorbp, indt+i)
                  temp62b52 = fun0*temp62b51
                  fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2&
&                    , 0)))*temp62b51
                  rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, &
&                    0)**2)*temp62b52
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                    temp62b52
                END IF
              ELSE IF (branch .LT. 28) THEN
                IF (branch .LT. 27) THEN
                  temp62b53 = cost5g*4.d0*zb(indorbp, indt+i)
                  temp62b54 = fun0*temp62b53
                  fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, &
&                    0)**3)*temp62b53
                  rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                    temp62b54
                  rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, &
&                    0)**2)*temp62b54
                END IF
              ELSE
                temp62b55 = cost5g*4.d0*zb(indorbp, indt+i)
                temp62b56 = fun0*temp62b55
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp62b55
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp62b56
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp62b56
              END IF
              temp62b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
              distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(&
&                indorbp, indt+i)
              rmub(i, 0) = rmub(i, 0) + fun*temp62b1
              funb = funb + rmu(i, 0)*temp62b1
              zb(indorbp, indt+i) = 0.0_8
            END DO
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        CALL POPREAL8(adr8ibuf,adr8buf,fun)
        temp62b = 2.75d0*funb/dd1
        funzb = funb
        funb = temp62b
        CALL POPREAL8(adr8ibuf,adr8buf,fun0)
        temp62b0 = 2.75d0*fun0b/dd1
        fun0zb = fun0b
        temp61 = rp3**2
        temp59 = distp(0, 1)/temp61
        temp60 = 2.d0*rp1**2 - 18.d0*rp1 + 9.d0
        temp61b = 2.d0*temp59*funzb
        temp60b = 2.d0*rp2*temp61b
        temp59b = 2.d0*(97d0*rp1-19.d0*rp1**2+rp1**3+2.d0*(rp2*temp60)+&
&          4.d0*(rp1*rp2**2)-81.d0)*funzb/temp61
        temp57 = dd1*rp3
        temp58b = -(distp(0, 1)*rp1*fun0zb/temp57)
        temp56 = dd1/rp3
        temp57b = -(2.d0*distp(0, 1)*temp56*funb)
        rp2b = 2.d0*temp58b + 2.d0*temp57b + (4.d0*rp1*2*rp2+2.d0*temp60&
&          )*temp61b
        temp58 = (rp3+2.d0*rp2)/temp57
        temp57b0 = -(temp58*temp58b)
        temp57b1 = -(2.d0*(rp1+2.d0*rp2-9.d0)*funb)
        temp56b0 = distp(0, 1)*temp57b1/rp3
        rp3b = temp58b + dd1*temp57b0 + rp2b/rp3 - temp56*temp56b0 - &
&          temp59*2*rp3*temp59b
        rp1b = rp3b - temp58*distp(0, 1)*fun0zb + temp57b + (2.d0*2*rp1-&
&          18.d0)*temp60b + (4.d0*rp2**2+3*rp1**2-19.d0*2*rp1+97d0)*&
&          temp61b
        dd1b = temp56b0 - fun0*temp62b0/dd1 + r(0)**2*rp1b + rp3*&
&          temp57b0 - fun*temp62b/dd1
        fun0b = temp62b0
        distpb(0, 1) = distpb(0, 1) + fun0b - temp58*rp1*fun0zb + temp56&
&          *temp57b1 + temp59b
        CALL POPREAL8(adr8ibuf,adr8buf,rp2)
        CALL POPREAL8(adr8ibuf,adr8buf,rp3)
        rb(0) = rb(0) + dd1*2*r(0)*rp1b
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
! enddo fot ic                                   
        indorbp = indorb
        DO ic=1,9
          IF (iocc(indshell+ic) .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
            indorbp = indorbp + 1
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
        DO ic=9,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) THEN
            zb(indorbp, indt+1:indt+4) = 0.0_8
            CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
        distpb = 0.0_8
        dd1b = 0.0_8
      END IF
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=9,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=indtm,i0,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 2) THEN
            temp56b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
            temp55 = 4.d0*dd1
            temp54 = 11.d0/temp55
            temp54b17 = (temp54-r(k)**2*cost)*zb(indorbp, k)
            costb = -(r(k)**2*temp56b)
            temp54b18 = costb/rp3
            rp2b = 2.d0*temp54b18
            rp3b = rp2b/rp3 + (1.0_8-(rp3+2.d0*rp2)/rp3)*temp54b18
            rp1b = rp3b
            dd1b = dd1b + r(k)**2*rp1b - temp54*4.d0*temp56b/temp55
            rb(k) = rb(k) + dd1*2*r(k)*rp1b - cost*2*r(k)*temp56b
            distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp54b17
            distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp54b17
            zb(indorbp, k) = 0.0_8
            CALL POPREAL8(adr8ibuf,adr8buf,cost)
            CALL POPREAL8(adr8ibuf,adr8buf,rp2)
            CALL POPREAL8(adr8ibuf,adr8buf,rp3)
          ELSE
            zb(indorbp, k) = 0.0_8
          END IF
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=indtm,indtmin,-1
      temp54b = cost5g*4.d0*distpb(i, 10)
      temp54b0 = (rmu(1, i)**2-rmu(2, i)**2)*temp54b
      temp54b1 = rmu(1, i)*rmu(2, i)*temp54b
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp54b1 + rmu(2, i)*&
&        temp54b0
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp54b0 - 2*rmu(2, i)*&
&        temp54b1
      distpb(i, 10) = 0.0_8
      temp54b2 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp54b2
      distpb(i, 9) = 0.0_8
      temp54b3 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp54b4 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp54b3 - 2*rmu(2, i)*&
&        temp54b4 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp54b2
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp54b3
      distpb(i, 8) = 0.0_8
      temp54b5 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp54b6 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp54b5 + 2*rmu(1, i)*&
&        temp54b6 + 3.d0*2*rmu(1, i)*temp54b4
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp54b5
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp54b6
      distpb(i, 7) = 0.0_8
      temp54b7 = cost3g*2.d0*distpb(i, 6)
      temp54b8 = (7.d0*rmu(3, i)**2-r(i)**2)*temp54b7
      temp54b9 = rmu(1, i)*rmu(2, i)*temp54b7
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp54b8
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp54b8
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp54b9
      distpb(i, 6) = 0.0_8
      temp54b10 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp54b11 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp54b12 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp54b13 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp54b14 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp54b15 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp54b16 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp54b16 - 3.d0*2*r(i)*temp54b15 - 2*r(i)*temp54b11 - 3.d0*2*r(&
&        i)*temp54b13 - 2*r(i)*temp54b9
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp54b10
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp54b10
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp54b11
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp54b12
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp54b13 + rmu(2, i)*&
&        temp54b12
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp54b14
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp54b16 + 7.d0*2*rmu(3, i)*temp54b15 + rmu(1, i)*&
&        temp54b14
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 3) THEN
        IF (branch .LT. 2) THEN
          distpb(k, 1) = 0.0_8
          costb = 0.0_8
          GOTO 210
        END IF
      ELSE
        distpb(k, 1) = -distpb(k, 1)
      END IF
      temp53 = DLOG(-(cost/9.d0) + 1.d0)
      temp53b57 = c*DEXP(-cost-temp53**2)*distpb(k, 1)
      cb = cb + DEXP(-cost-temp53**2)*distpb(k, 1)
      costb = (2*temp53/((1.d0-cost/9.d0)*9.d0)-1.0)*temp53b57
      distpb(k, 1) = 0.0_8
 210  CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd1b = dd1b + r(k)**2*costb
      rb(k) = rb(k) + dd1*2*r(k)*costb
    END DO
    dd1b = dd1b + ratiog*2.75d0*dd1**1.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (199) 
!endif for indt                                         
!        indpar=indpar+1 
!        indshell=indshell+9
!        indorb=indorbp 
! derivative of 200 LA COSTANTE                                         
    indorbp = indorb + 1
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) zb(indorbp, indt+1:indt+4) = 0.0_8
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=indtm,i0,-1
        zb(indorbp, i) = 0.0_8
      END DO
    END IF
    distpb = 0.0_8
  CASE (200) 
!        indshell=indshellp 
!        indorb=indorbp 
!     THE  COSTANT                                                      
    indorbp = indorb + 1
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    IF (typec .NE. 1) THEN
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        zb(indorbp, indt+i) = 0.0_8
      END DO
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO i=indtm,i0,-1
        zb(indorbp, i) = 0.0_8
      END DO
    END IF
    distpb = 0.0_8
  CASE (801) 
!        indshell=indshellp 
!        indorb=indorbp 
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
! NEW SECTION: determinant bump orbitals with user-defined cutoff. 
! For these orbitals the convolution function is a Fermi function.
! These orbitals are useful when computing determinant occupations in order
! to evaluate occupations of localized orbitals such as d-orbitals.
! They are used for the tool: dm_occ.x
! cutoff_p = input parameter which determines the cutoff in (a.u.)^2
! steep_fd = steepness of the Fermi function in (a.u.)^2
! NB: only simple gaussian orbitals s/p/d/f are inmplemented so far.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
! s orbitals, simple gaussian 
    indshellp = indshell + 1
    IF (iocc(indshellp) .EQ. 1) THEN
      indorbp = indorb + 1
      dd1 = dd(indpar+1)
      c = dd1**0.75d0*ratios
      DO k=indtmin,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
        cost = dd1*r(k)**2
        IF (r(k)**2 .GT. cutoff_p + 4.d0*steep_fd) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE
          CALL PUSHREAL8(adr8ibuf,adr8buf,cost_fd)
          cost_fd = 1.d0/(1.d0+DEXP((r(k)**2-cutoff_p)/steep_fd))
          IF (r(k) .LT. 0.d0) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          END IF
        END IF
      END DO
      distpb = 0.0_8
      DO i=indtm,i0,-1
        distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      cb = 0.0_8
      dd1b = 0.0_8
      DO k=indtm,indtmin,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 3) THEN
          IF (branch .LT. 2) THEN
            distpb(k, 1) = 0.0_8
            costb = 0.0_8
            GOTO 220
          END IF
        ELSE
          distpb(k, 1) = -distpb(k, 1)
        END IF
        temp65b = DEXP(-cost)*distpb(k, 1)
        costb = -(c*cost_fd*DEXP(-cost)*distpb(k, 1))
        cb = cb + cost_fd*temp65b
        cost_fdb = c*temp65b
        distpb(k, 1) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,cost_fd)
        temp64 = r(k)**2 - cutoff_p
        temp63 = temp64/steep_fd
        temp62 = DEXP(temp63) + 1.d0
        rb(k) = rb(k) - DEXP(temp63)*2*r(k)*cost_fdb/(temp62**2*steep_fd&
&          )
 220    CALL POPREAL8(adr8ibuf,adr8buf,cost)
        dd1b = dd1b + r(k)**2*costb
        rb(k) = rb(k) + dd1*2*r(k)*costb
      END DO
      dd1b = dd1b + ratios*0.75d0*dd1**(-0.25D0)*cb
      ddb(indpar+1) = ddb(indpar+1) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
  CASE (811) 
!  p orbitals, simple gaussian
    dd1 = dd(indpar+1)
    c = dd1**1.25d0*ratiop
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2
      IF (r(k)**2 .GT. cutoff_p + 5.d0*steep_fd) THEN
! avoid underflow
        distp(k, 1) = 0.d0
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost_fd)
        cost_fd = 1.d0/(1.d0+DEXP((r(k)**2-cutoff_p)/steep_fd))
        distp(k, 1) = c*DEXP(-cost)*cost_fd
        IF (r(k) .LT. 0.d0) THEN
          distp(k, 1) = -distp(k, 1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END IF
    END DO
    indorbp = indorb
    DO ic=1,3
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    distpb = 0.0_8
    DO ic=3,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO i=indtm,i0,-1
          rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
          distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
          zb(indorbp, i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    cb = 0.0_8
    dd1b = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 3) THEN
        IF (branch .LT. 2) THEN
          distpb(k, 1) = 0.0_8
          costb = 0.0_8
          GOTO 230
        END IF
      ELSE
        distpb(k, 1) = -distpb(k, 1)
      END IF
      temp68b = DEXP(-cost)*distpb(k, 1)
      costb = -(c*cost_fd*DEXP(-cost)*distpb(k, 1))
      cb = cb + cost_fd*temp68b
      cost_fdb = c*temp68b
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost_fd)
      temp67 = r(k)**2 - cutoff_p
      temp66 = temp67/steep_fd
      temp65 = DEXP(temp66) + 1.d0
      rb(k) = rb(k) - DEXP(temp66)*2*r(k)*cost_fdb/(temp65**2*steep_fd)
 230  CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd1b = dd1b + r(k)**2*costb
      rb(k) = rb(k) + dd1*2*r(k)*costb
    END DO
    dd1b = dd1b + ratiop*1.25d0*dd1**0.25D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (821) 
! d orbitals, simple gaussian
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
    c = dd1**1.75d0*ratiod
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2
      IF (r(k)**2 .GT. cutoff_p + 5.d0*steep_fd) THEN
! avoid underflow
        distp(k, 1) = 0.d0
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost_fd)
        cost_fd = 1.d0/(1.d0+DEXP((r(k)**2-cutoff_p)/steep_fd))
        distp(k, 1) = c*DEXP(-cost)*cost_fd
        IF (r(k) .LT. 0.d0) THEN
          distp(k, 1) = -distp(k, 1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END IF
    END DO
    DO i=indtmin,indtm
! lz=0       
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2     
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2            
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1            
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1            
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    distpb = 0.0_8
    DO ic=5,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=indtm,i0,-1
          distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
          zb(indorbp, k) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    dd1b = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 3) THEN
        IF (branch .LT. 2) THEN
          distpb(k, 1) = 0.0_8
          costb = 0.0_8
          GOTO 240
        END IF
      ELSE
        distpb(k, 1) = -distpb(k, 1)
      END IF
      temp71b = DEXP(-cost)*distpb(k, 1)
      costb = -(c*cost_fd*DEXP(-cost)*distpb(k, 1))
      cb = cb + cost_fd*temp71b
      cost_fdb = c*temp71b
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost_fd)
      temp70 = r(k)**2 - cutoff_p
      temp69 = temp70/steep_fd
      temp68 = DEXP(temp69) + 1.d0
      rb(k) = rb(k) - DEXP(temp69)*2*r(k)*cost_fdb/(temp68**2*steep_fd)
 240  CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd1b = dd1b + r(k)**2*costb
      rb(k) = rb(k) + dd1*2*r(k)*costb
    END DO
    dd1b = dd1b + ratiod*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (831) 
! f orbitals, simple gaussian
    indorbp = indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
    c = dd1**2.25d0*ratiof
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2
      IF (r(k)**2 .GT. cutoff_p + 5.d0*steep_fd) THEN
! avoid underflow
        distp(k, 1) = 0.d0
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost_fd)
        cost_fd = 1.d0/(1.d0+DEXP((r(k)**2-cutoff_p)/steep_fd))
        distp(k, 1) = c*DEXP(-cost)*cost_fd
        IF (r(k) .LT. 0.d0) THEN
          distp(k, 1) = -distp(k, 1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END IF
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0        
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2           
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2                   
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3     
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3     
    DO ic=1,7
      IF (iocc(indshell+ic) .EQ. 1) THEN
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorbp + 1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      END IF
    END DO
    distpb = 0.0_8
    DO ic=7,1,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (.NOT.branch .LT. 2) THEN
        DO k=indtm,i0,-1
          distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
          distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
          zb(indorbp, k) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END IF
    END DO
    DO i=indtm,indtmin,-1
      temp74b0 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp74b0
      distpb(i, 8) = 0.0_8
      temp74b1 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp74b1 + 3.d0*2*rmu(1, i)*temp74b0
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp74b1
      distpb(i, 7) = 0.0_8
      temp74b2 = cost3f*2.d0*distpb(i, 6)
      temp74b3 = rmu(2, i)*temp74b2
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp74b3
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp74b3
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp74b2
      distpb(i, 6) = 0.0_8
      temp74b4 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp74b4
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp74b4
      temp74b5 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp74b5
      distpb(i, 4) = 0.0_8
      temp74b6 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp74b7 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp74b6 - 3.d0*2*r(i)*temp74b7 - 2*r(i)*&
&        temp74b5
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp74b7 + 5.d0*2*rmu(3, i)*&
&        temp74b6
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    dd1b = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 3) THEN
        IF (branch .LT. 2) THEN
          distpb(k, 1) = 0.0_8
          costb = 0.0_8
          GOTO 250
        END IF
      ELSE
        distpb(k, 1) = -distpb(k, 1)
      END IF
      temp74b = DEXP(-cost)*distpb(k, 1)
      costb = -(c*cost_fd*DEXP(-cost)*distpb(k, 1))
      cb = cb + cost_fd*temp74b
      cost_fdb = c*temp74b
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost_fd)
      temp73 = r(k)**2 - cutoff_p
      temp72 = temp73/steep_fd
      temp71 = DEXP(temp72) + 1.d0
      rb(k) = rb(k) - DEXP(temp72)*2*r(k)*cost_fdb/(temp71**2*steep_fd)
 250  CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd1b = dd1b + r(k)**2*costb
      rb(k) = rb(k) + dd1*2*r(k)*costb
    END DO
    dd1b = dd1b + ratiof*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE DEFAULT
    distpb = 0.0_8
  END SELECT
END SUBROUTINE MAKEFUN_BUMP_B
