!TL off
!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.3 (r3163) - 09/25/2009 09:03
!
!  Differentiation of makefun in reverse (adjoint) mode:
!   gradient, with respect to input variables: dd r z rmu distp
!   of linear combination of output variables: dd r z rmu
SUBROUTINE MAKEFUN_B(iopt, indt, i0, indtmin, indtm, typec, indpar, &
&  indorb, indshell, nelskip, z, zb, dd, ddb, zeta, r, rb, rmu, rmub, &
&  distp, distpb, iflagnorm_unused, cr)
  USE CONSTANTS
  IMPLICIT NONE
! TAPENADE adBuffer vars
  integer :: adi4ibuf,adr8ibuf,adi4buf(1024)
  real*8  :: adr8buf(1024)
! ---
  INTEGER :: iopt, indt, i, k, nelskip, indpar, indorbp, indorb, &
&  indshell, indshellp, ic, indtmin, i0, iflagnorm_unused, indparp, indtm&
&  , npower, typec
! up to i 
  REAL*8 :: z(nelskip, i0:*), dd(*), zeta(*), rmu(3, 0:indtm), r(0:indtm&
&  ), distp(0:indtm, 20), peff, fun, fun0, fun2, rp1, rp2, rp3, rp4, rp5&
&  , rp6, rp7, rp8, dd1, dd2, dd3, dd4, dd5, c, cr, funp, fun2p, peff2, &
&  arg, c0, c1, cost, zv(6), yv(6), xv(6), r2, r4, r6
  REAL*8 :: zb(nelskip, i0:*), ddb(*), rmub(3, 0:indtm), rb(0:indtm), &
&  distpb(0:indtm, 20), peffb, funb, fun0b, fun2b, rp1b, rp2b, rp3b, rp4b&
&  , rp5b, rp6b, rp8b, dd1b, dd2b, dd3b, dd4b, dd5b, cb, funpb, fun2pb, &
&  peff2b, argb, c0b, c1b, costb, zvb(6), yvb(6), xvb(6), r2b, r4b, r6b
  INTEGER :: branch
  INTEGER :: ad_from
  INTEGER :: ad_to
  REAL*8 :: temp3
  DOUBLE PRECISION :: temp29
  REAL*8 :: temp42b3
  REAL*8 :: temp57b7
  REAL*8 :: temp57b18
  REAL*8 :: temp68b43
  REAL*8 :: temp153b
  REAL*8 :: temp234b
  REAL*8 :: temp296
  REAL*8 :: temp315b
  REAL*8 :: temp340
  REAL*8 :: temp373b22
  REAL*8 :: temp373b59
  DOUBLE PRECISION :: temp377
  REAL*8 :: temp379b71
  REAL*8 :: temp386b28
  REAL*8 :: temp388b2
  REAL*8 :: temp388b62
  REAL*8 :: temp404b27
  REAL*8 :: temp415b1
  REAL*8 :: temp421
  REAL*8 :: temp458
  REAL*8 :: temp486b3
  REAL*8 :: temp496b35
  REAL*8 :: temp502
  REAL*8 :: temp513b2
  REAL*8 :: temp2
  REAL*8 :: temp28
  REAL*8 :: temp42b2
  REAL*8 :: temp57b6
  REAL*8 :: temp57b17
  REAL*8 :: temp68b42
  REAL*8 :: temp242b
  DOUBLE PRECISION :: temp295
  REAL*8 :: temp373b21
  REAL*8 :: temp373b58
  DOUBLE PRECISION :: temp376
  REAL*8 :: temp379b70
  REAL*8 :: temp386b27
  REAL*8 :: temp388b1
  REAL*8 :: temp388b61
  REAL*8 :: temp404b
  REAL*8 :: temp404b26
  REAL*8 :: temp415b0
  REAL*8 :: temp420
  DOUBLE PRECISION :: temp457
  REAL*8 :: temp469b1
  REAL*8 :: temp486b2
  REAL*8 :: temp496b34
  INTEGER :: temp501
  REAL*8 :: temp513b1
  REAL*8 :: temp1
  REAL*8 :: temp25b0
  REAL*8 :: temp27
  REAL*8 :: temp42b1
  REAL*8 :: temp57b5
  REAL*8 :: temp57b16
  REAL*8 :: temp68b41
  REAL*8 :: temp79b1
  REAL*8 :: temp150b3
  DOUBLE PRECISION :: temp250b
  DOUBLE PRECISION :: temp294
  REAL*8 :: temp331b
  REAL*8 :: temp373b20
  REAL*8 :: temp373b57
  DOUBLE PRECISION :: temp375
  REAL*8 :: temp386b26
  REAL*8 :: temp388b0
  REAL*8 :: temp388b60
  REAL*8 :: temp404b25
  REAL*8 :: temp412b
  DOUBLE PRECISION :: temp456
  REAL*8 :: temp469b0
  REAL*8 :: temp486b1
  REAL*8 :: temp496b33
  REAL*8 :: temp500
  REAL*8 :: temp513b0
  REAL*8 :: temp0
  REAL*8 :: temp13b
  REAL*8 :: temp26
  REAL*8 :: temp42b0
  REAL*8 :: temp57b4
  REAL*8 :: temp57b15
  REAL*8 :: temp68b40
  REAL*8 :: temp79b0
  REAL*8 :: temp91b6
  REAL*8 :: temp150b2
  REAL*8 :: temp293
  REAL*8 :: temp312b2
  REAL*8 :: temp373b56
  DOUBLE PRECISION :: temp374
  REAL*8 :: temp376b
  REAL*8 :: temp386b25
  REAL*8 :: temp404b24
  REAL*8 :: temp420b
  REAL*8 :: temp455
  REAL*8 :: temp481b5
  REAL*8 :: temp486b0
  REAL*8 :: temp488b13
  REAL*8 :: temp496b9
  REAL*8 :: temp496b32
  REAL*8 :: temp501b
  REAL*8 :: temp7b
  REAL*8 :: temp21b
  REAL*8 :: temp25
  REAL*8 :: temp57b3
  REAL*8 :: temp57b14
  REAL*8 :: temp58b
  REAL*8 :: temp91b5
  REAL*8 :: temp150b1
  REAL*8 :: temp292
  REAL*8 :: temp312b1
  REAL*8 :: temp373b55
  REAL*8 :: temp373
  REAL*8 :: temp386b24
  REAL*8 :: temp404b23
  REAL*8 :: temp454
  REAL*8 :: temp465b
  REAL*8 :: temp481b4
  REAL*8 :: temp488b12
  REAL*8 :: temp496b8
  REAL*8 :: temp496b31
  REAL*8 :: temp24
  REAL*8 :: temp57b2
  REAL*8 :: temp57b13
  REAL*8 :: temp66b
  REAL*8 :: temp91b4
  REAL*8 :: temp150b0
  DOUBLE PRECISION :: temp291
  REAL*8 :: temp312b0
  REAL*8 :: temp322b9
  REAL*8 :: temp349b0
  REAL*8 :: temp372
  REAL*8 :: temp373b54
  REAL*8 :: temp386b23
  REAL*8 :: temp392b
  REAL*8 :: temp404b22
  REAL*8 :: temp453
  REAL*8 :: temp473b
  REAL*8 :: temp481b3
  REAL*8 :: temp488b11
  REAL*8 :: temp496b7
  REAL*8 :: temp496b30
  INTRINSIC DEXP
  REAL*8 :: temp23
  REAL*8 :: temp57b1
  REAL*8 :: temp57b12
  REAL*8 :: temp57b49
  REAL*8 :: temp91b3
  REAL*8 :: temp109b5
  REAL*8 :: temp111b
  REAL*8 :: temp119
  REAL*8 :: temp148b
  REAL*8 :: temp229b
  REAL*8 :: temp280b5
  DOUBLE PRECISION :: temp290
  REAL*8 :: temp322b8
  REAL*8 :: temp344b4
  REAL*8 :: temp361b5
  REAL*8 :: temp371
  REAL*8 :: temp373b53
  REAL*8 :: temp386b22
  REAL*8 :: temp388b93
  REAL*8 :: temp404b21
  REAL*8 :: temp452
  REAL*8 :: temp481b
  REAL*8 :: temp481b2
  REAL*8 :: temp488b10
  DOUBLE PRECISION :: temp489
  REAL*8 :: temp496b6
  REAL*8 :: temp22
  REAL*8 :: temp18b3
  REAL*8 :: temp57b0
  REAL*8 :: temp57b11
  REAL*8 :: temp57b48
  DOUBLE PRECISION :: temp59
  REAL*8 :: temp91b2
  REAL*8 :: temp109b4
  REAL*8 :: temp111b1
  REAL*8 :: temp118
  REAL*8 :: temp156b
  REAL*8 :: temp237b
  REAL*8 :: temp280b4
  REAL*8 :: temp318b
  REAL*8 :: temp322b7
  REAL*8 :: temp344b3
  REAL*8 :: temp361b4
  REAL*8 :: temp370
  REAL*8 :: temp373b52
  REAL*8 :: temp386b21
  REAL*8 :: temp386b58
  REAL*8 :: temp388b92
  REAL*8 :: temp404b20
  REAL*8 :: temp408b2
  REAL*8 :: temp451
  REAL*8 :: temp474b9
  REAL*8 :: temp481b1
  REAL*8 :: temp488
  REAL*8 :: temp496b5
  REAL*8 :: temp21
  REAL*8 :: temp18b2
  REAL*8 :: temp57b10
  REAL*8 :: temp57b47
  REAL*8 :: temp58
  REAL*8 :: temp91b1
  REAL*8 :: temp109b3
  REAL*8 :: temp111b0
  REAL*8 :: temp117
  REAL*8 :: temp148b0
  REAL*8 :: temp164b
  REAL*8 :: temp245b
  REAL*8 :: temp280b3
  REAL*8 :: temp322b6
  REAL*8 :: temp344b2
  REAL*8 :: temp361b3
  REAL*8 :: temp373b51
  REAL*8 :: temp386b20
  REAL*8 :: temp386b57
  REAL*8 :: temp387b29
  REAL*8 :: temp388b91
  REAL*8 :: temp407b
  REAL*8 :: temp408b1
  REAL*8 :: temp450
  REAL*8 :: temp474b8
  REAL*8 :: temp479b3
  REAL*8 :: temp481b0
  REAL*8 :: temp487
  REAL*8 :: temp496b4
  REAL*8 :: temp18b1
  REAL*8 :: temp20
  REAL*8 :: temp57b46
  REAL*8 :: temp57
  REAL*8 :: temp58b18
  REAL*8 :: temp91b0
  REAL*8 :: temp109b2
  REAL*8 :: temp116
  REAL*8 :: temp202b8
  REAL*8 :: temp246b0
  REAL*8 :: temp280b2
  REAL*8 :: temp322b5
  DOUBLE PRECISION :: temp334b
  REAL*8 :: temp344b1
  REAL*8 :: temp361b2
  REAL*8 :: temp373b50
  REAL*8 :: temp386b56
  REAL*8 :: temp387b28
  REAL*8 :: temp388b90
  REAL*8 :: temp408b0
  REAL*8 :: temp415b
  REAL*8 :: temp474b7
  REAL*8 :: temp479b2
  REAL*8 :: temp486
  REAL*8 :: temp496b3
  REAL*8 :: temp16b
  REAL*8 :: temp18b0
  REAL*8 :: temp56
  REAL*8 :: temp57b45
  REAL*8 :: temp58b17
  REAL*8 :: temp109b1
  DOUBLE PRECISION :: temp115
  REAL*8 :: temp202b7
  REAL*8 :: temp280b1
  REAL*8 :: temp298b
  REAL*8 :: temp322b4
  REAL*8 :: temp342b
  REAL*8 :: temp344b0
  REAL*8 :: temp361b1
  REAL*8 :: temp379b
  REAL*8 :: temp386b55
  REAL*8 :: temp387b27
  REAL*8 :: temp425b0
  REAL*8 :: temp474b6
  REAL*8 :: temp479b1
  REAL*8 :: temp485
  REAL*8 :: temp496b2
  REAL*8 :: temp504b
  REAL*8 :: temp24b
  REAL*8 :: temp55
  REAL*8 :: temp57b44
  REAL*8 :: temp58b16
  REAL*8 :: temp109b0
  DOUBLE PRECISION :: temp114
  REAL*8 :: temp202b6
  REAL*8 :: temp280b0
  REAL*8 :: temp321b19
  REAL*8 :: temp322b3
  REAL*8 :: temp350b
  REAL*8 :: temp361b0
  REAL*8 :: temp386b54
  REAL*8 :: temp387b
  REAL*8 :: temp387b26
  REAL*8 :: temp474b5
  REAL*8 :: temp479b0
  REAL*8 :: temp484
  REAL*8 :: temp496b1
  REAL*8 :: temp512b
  REAL*8 :: temp54
  REAL*8 :: temp57b43
  REAL*8 :: temp58b15
  REAL*8 :: temp69b
  DOUBLE PRECISION :: temp113
  REAL*8 :: temp202b5
  REAL*8 :: temp321b18
  REAL*8 :: temp322b2
  REAL*8 :: temp386b53
  REAL*8 :: temp387b25
  REAL*8 :: temp395b
  REAL*8 :: temp474b4
  REAL*8 :: temp476b
  REAL*8 :: temp483
  REAL*8 :: temp489b8
  REAL*8 :: temp496b0
  REAL*8 :: temp520b
  REAL*8 :: temp4b0
  REAL*8 :: temp40b
  REAL*8 :: temp53
  REAL*8 :: temp57b42
  REAL*8 :: temp58b14
  REAL*8 :: temp77b
  DOUBLE PRECISION :: temp112
  REAL*8 :: temp149
  REAL*8 :: temp202b4
  REAL*8 :: temp315b9
  REAL*8 :: temp321b17
  REAL*8 :: temp322b1
  REAL*8 :: temp386b52
  REAL*8 :: temp387b24
  REAL*8 :: temp474b3
  REAL*8 :: temp482
  REAL*8 :: temp489b7
  REAL*8 :: temp52
  REAL*8 :: temp57b41
  REAL*8 :: temp58b13
  REAL*8 :: temp85b
  DOUBLE PRECISION :: temp89
  REAL*8 :: temp99b7
  REAL*8 :: temp111
  REAL*8 :: temp148
  REAL*8 :: temp202b3
  REAL*8 :: temp203b
  DOUBLE PRECISION :: temp229
  REAL*8 :: temp241b0
  REAL*8 :: temp315b8
  REAL*8 :: temp321b16
  REAL*8 :: temp322b0
  REAL*8 :: temp380b39
  REAL*8 :: temp386b51
  REAL*8 :: temp387b23
  REAL*8 :: temp474b2
  REAL*8 :: temp481
  REAL*8 :: temp489b6
  REAL*8 :: temp492b
  REAL*8 :: temp501b1
  REAL*8 :: temp13b0
  REAL*8 :: temp51
  REAL*8 :: temp57b40
  REAL*8 :: temp58b12
  REAL*8 :: temp88
  REAL*8 :: temp93b
  REAL*8 :: temp99b6
  REAL*8 :: temp110
  REAL*8 :: temp130b
  REAL*8 :: temp147
  REAL*8 :: temp202b2
  REAL*8 :: temp228
  REAL*8 :: temp300b3
  REAL*8 :: temp309
  REAL*8 :: temp315b7
  REAL*8 :: temp321b15
  REAL*8 :: temp329b
  REAL*8 :: temp380b38
  REAL*8 :: temp386b9
  REAL*8 :: temp386b50
  REAL*8 :: temp387b22
  REAL*8 :: temp387b59
  REAL*8 :: temp420b0
  REAL*8 :: temp474b1
  REAL*8 :: temp480
  REAL*8 :: temp489b5
  REAL*8 :: temp501b0
  REAL*8 :: temp50
  REAL*8 :: temp58b11
  REAL*8 :: temp87
  REAL*8 :: temp99b5
  REAL*8 :: temp146
  REAL*8 :: temp175b
  REAL*8 :: temp202b1
  REAL*8 :: temp227
  REAL*8 :: temp300b
  REAL*8 :: temp300b2
  REAL*8 :: temp308
  REAL*8 :: temp315b6
  REAL*8 :: temp321b14
  REAL*8 :: temp337b
  REAL*8 :: temp379b39
  REAL*8 :: temp380b37
  REAL*8 :: temp386b8
  REAL*8 :: temp387b21
  REAL*8 :: temp387b58
  REAL*8 :: temp418b
  REAL*8 :: temp474b0
  REAL*8 :: temp489b4
  REAL*8 :: temp19b
  REAL*8 :: temp58b10
  REAL*8 :: temp86
  REAL*8 :: temp99b4
  DOUBLE PRECISION :: temp145
  REAL*8 :: temp202b0
  REAL*8 :: temp226
  DOUBLE PRECISION :: temp264b
  DOUBLE PRECISION :: temp273b2
  REAL*8 :: temp300b1
  REAL*8 :: temp307
  REAL*8 :: temp315b5
  REAL*8 :: temp321b13
  REAL*8 :: temp345b
  REAL*8 :: temp379b38
  REAL*8 :: temp380b36
  REAL*8 :: temp386b7
  REAL*8 :: temp387b20
  REAL*8 :: temp387b57
  REAL*8 :: temp388b29
  REAL*8 :: temp418b1
  REAL*8 :: temp426b
  REAL*8 :: temp489b3
  REAL*8 :: temp507b
  REAL*8 :: temp27b
  REAL*8 :: temp85
  REAL*8 :: temp99b3
  REAL*8 :: temp144
  REAL*8 :: temp225
  REAL*8 :: temp272b
  DOUBLE PRECISION :: temp273b1
  REAL*8 :: temp300b0
  DOUBLE PRECISION :: temp306
  REAL*8 :: temp315b4
  REAL*8 :: temp321b12
  REAL*8 :: temp379b37
  REAL*8 :: temp380b35
  REAL*8 :: temp386b6
  REAL*8 :: temp387b56
  REAL*8 :: temp388b28
  REAL*8 :: temp418b0
  REAL*8 :: temp434b
  REAL*8 :: temp489b2
  REAL*8 :: temp515b
  REAL*8 :: temp28b0
  REAL*8 :: temp35b
  DOUBLE PRECISION :: temp84
  REAL*8 :: temp99b2
  REAL*8 :: temp109b
  REAL*8 :: temp143
  REAL*8 :: temp224
  DOUBLE PRECISION :: temp273b0
  REAL*8 :: temp280b
  DOUBLE PRECISION :: temp305
  REAL*8 :: temp315b3
  REAL*8 :: temp321b11
  REAL*8 :: temp354b0
  REAL*8 :: temp361b
  REAL*8 :: temp379b36
  REAL*8 :: temp380b34
  REAL*8 :: temp386b5
  REAL*8 :: temp387b55
  REAL*8 :: temp388b27
  REAL*8 :: temp398b
  REAL*8 :: temp479b
  REAL*8 :: temp489b1
  REAL*8 :: temp516b0
  REAL*8 :: temp43b
  REAL*8 :: temp83
  REAL*8 :: temp99b1
  DOUBLE PRECISION :: temp142
  DOUBLE PRECISION :: temp179
  REAL*8 :: temp223
  DOUBLE PRECISION :: temp304
  REAL*8 :: temp315b2
  REAL*8 :: temp321b10
  REAL*8 :: temp322b19
  REAL*8 :: temp379b35
  REAL*8 :: temp380b33
  REAL*8 :: temp386b4
  REAL*8 :: temp387b54
  REAL*8 :: temp388b26
  REAL*8 :: temp450b
  REAL*8 :: temp478b17
  REAL*8 :: temp487b
  REAL*8 :: temp489b0
  REAL*8 :: temp0b
  REAL*8 :: temp51b
  REAL*8 :: temp82
  REAL*8 :: temp88b
  REAL*8 :: temp99b0
  REAL*8 :: temp141
  DOUBLE PRECISION :: temp178
  REAL*8 :: temp222
  REAL*8 :: temp259
  DOUBLE PRECISION :: temp303
  REAL*8 :: temp315b1
  REAL*8 :: temp322b18
  REAL*8 :: temp379b34
  REAL*8 :: temp380b32
  REAL*8 :: temp380b69
  REAL*8 :: temp386b3
  REAL*8 :: temp387b53
  REAL*8 :: temp388b25
  REAL*8 :: temp478b16
  REAL*8 :: temp495b
  REAL*8 :: temp77b3
  DOUBLE PRECISION :: temp81
  REAL*8 :: temp140
  REAL*8 :: temp153b0
  REAL*8 :: temp177
  REAL*8 :: temp221
  DOUBLE PRECISION :: temp258
  REAL*8 :: temp302
  REAL*8 :: temp315b0
  REAL*8 :: temp322b17
  REAL*8 :: temp339
  REAL*8 :: temp379b33
  REAL*8 :: temp380b31
  REAL*8 :: temp380b68
  REAL*8 :: temp386b2
  REAL*8 :: temp387b52
  REAL*8 :: temp388b24
  REAL*8 :: temp478b15
  REAL*8 :: temp23b1
  REAL*8 :: temp38b5
  REAL*8 :: temp77b2
  DOUBLE PRECISION :: temp80
  REAL*8 :: temp176
  REAL*8 :: temp178b
  REAL*8 :: temp220
  REAL*8 :: temp222b
  DOUBLE PRECISION :: temp257
  REAL*8 :: temp259b
  DOUBLE PRECISION :: temp301
  DOUBLE PRECISION :: temp303b
  REAL*8 :: temp322b16
  DOUBLE PRECISION :: temp332b0
  DOUBLE PRECISION :: temp338
  REAL*8 :: temp369b0
  REAL*8 :: temp379b9
  REAL*8 :: temp379b32
  REAL*8 :: temp379b69
  REAL*8 :: temp380b30
  REAL*8 :: temp380b67
  REAL*8 :: temp386b1
  REAL*8 :: temp387b51
  REAL*8 :: temp388b23
  REAL*8 :: temp413b0
  REAL*8 :: temp419
  REAL*8 :: temp478b14
  REAL*8 :: temp23b0
  REAL*8 :: temp38b4
  REAL*8 :: temp77b1
  REAL*8 :: temp175
  REAL*8 :: temp186b
  REAL*8 :: temp230b
  REAL*8 :: temp256
  REAL*8 :: temp300
  REAL*8 :: temp311b
  REAL*8 :: temp322b15
  REAL*8 :: temp337
  REAL*8 :: temp348b
  REAL*8 :: temp373b19
  REAL*8 :: temp379b8
  REAL*8 :: temp379b31
  REAL*8 :: temp379b68
  REAL*8 :: temp380b66
  REAL*8 :: temp386b0
  REAL*8 :: temp387b50
  REAL*8 :: temp388b22
  REAL*8 :: temp388b59
  REAL*8 :: temp418
  REAL*8 :: temp429b
  REAL*8 :: temp478b13
  REAL*8 :: temp509b3
  REAL*8 :: temp38b3
  REAL*8 :: temp40b0
  REAL*8 :: temp68b39
  REAL*8 :: temp77b0
  REAL*8 :: temp174
  REAL*8 :: temp255
  DOUBLE PRECISION :: temp283b3
  REAL*8 :: temp322b14
  REAL*8 :: temp336
  REAL*8 :: temp356b
  REAL*8 :: temp373b18
  REAL*8 :: temp379b7
  REAL*8 :: temp379b30
  REAL*8 :: temp379b67
  REAL*8 :: temp380b65
  REAL*8 :: temp388b21
  REAL*8 :: temp388b58
  REAL*8 :: temp400b
  REAL*8 :: temp417
  REAL*8 :: temp437b
  REAL*8 :: temp478b12
  REAL*8 :: temp494b9
  REAL*8 :: temp509b2
  REAL*8 :: temp38b
  REAL*8 :: temp38b2
  REAL*8 :: temp68b38
  REAL*8 :: temp129b3
  DOUBLE PRECISION :: temp173
  REAL*8 :: temp254
  DOUBLE PRECISION :: temp249b0
  DOUBLE PRECISION :: temp283b
  DOUBLE PRECISION :: temp283b2
  REAL*8 :: temp322b13
  REAL*8 :: temp335
  REAL*8 :: temp364b
  REAL*8 :: temp373b17
  REAL*8 :: temp379b6
  REAL*8 :: temp379b66
  REAL*8 :: temp380b64
  REAL*8 :: temp388b20
  REAL*8 :: temp388b57
  REAL*8 :: temp416
  REAL*8 :: temp445b
  REAL*8 :: temp478b11
  REAL*8 :: temp494b8
  REAL*8 :: temp509b1
  REAL*8 :: temp38b1
  REAL*8 :: temp46b
  REAL*8 :: temp68b37
  REAL*8 :: temp129b2
  DOUBLE PRECISION :: temp172
  REAL*8 :: temp253
  DOUBLE PRECISION :: temp283b1
  REAL*8 :: temp322b12
  DOUBLE PRECISION :: temp334
  REAL*8 :: temp347b0
  REAL*8 :: temp372b
  REAL*8 :: temp373b16
  REAL*8 :: temp379b5
  REAL*8 :: temp379b65
  REAL*8 :: temp380b63
  REAL*8 :: temp388b56
  REAL*8 :: temp415
  REAL*8 :: temp428b0
  REAL*8 :: temp445b1
  REAL*8 :: temp453b
  REAL*8 :: temp478b10
  REAL*8 :: temp494b7
  REAL*8 :: temp496b29
  REAL*8 :: temp509b0
  REAL*8 :: temp521b6
  REAL*8 :: temp3b
  REAL*8 :: temp38b0
  REAL*8 :: temp54b
  REAL*8 :: temp68b36
  REAL*8 :: temp128b
  REAL*8 :: temp129b1
  REAL*8 :: temp171
  DOUBLE PRECISION :: temp252
  REAL*8 :: temp289
  DOUBLE PRECISION :: temp283b0
  REAL*8 :: temp322b11
  REAL*8 :: temp333
  REAL*8 :: temp373b15
  REAL*8 :: temp374b9
  REAL*8 :: temp379b4
  REAL*8 :: temp379b64
  REAL*8 :: temp380b
  REAL*8 :: temp380b62
  REAL*8 :: temp388b55
  REAL*8 :: temp406b3
  REAL*8 :: temp414
  REAL*8 :: temp445b0
  REAL*8 :: temp461b
  REAL*8 :: temp477b5
  REAL*8 :: temp494b6
  REAL*8 :: temp496b28
  REAL*8 :: temp521b5
  REAL*8 :: temp55b0
  REAL*8 :: temp68b35
  REAL*8 :: temp99b
  REAL*8 :: temp129b0
  REAL*8 :: temp170
  REAL*8 :: temp217b
  REAL*8 :: temp251
  REAL*8 :: temp288
  REAL*8 :: temp298b3
  REAL*8 :: temp322b10
  DOUBLE PRECISION :: temp332
  REAL*8 :: temp369
  REAL*8 :: temp373b14
  REAL*8 :: temp374b8
  REAL*8 :: temp379b3
  REAL*8 :: temp379b63
  REAL*8 :: temp380b61
  REAL*8 :: temp388b54
  REAL*8 :: temp404b19
  REAL*8 :: temp406b2
  REAL*8 :: temp413
  REAL*8 :: temp462b0
  REAL*8 :: temp477b4
  REAL*8 :: temp494b5
  REAL*8 :: temp496b27
  REAL*8 :: temp521b4
  REAL*8 :: temp68b34
  REAL*8 :: temp70b
  REAL*8 :: temp144b
  REAL*8 :: temp146b0
  REAL*8 :: temp225b
  REAL*8 :: temp227b0
  DOUBLE PRECISION :: temp250
  DOUBLE PRECISION :: temp287
  REAL*8 :: temp298b2
  REAL*8 :: temp331
  INTEGER :: temp368
  REAL*8 :: temp373b13
  REAL*8 :: temp374b7
  REAL*8 :: temp379b2
  REAL*8 :: temp379b62
  REAL*8 :: temp380b60
  REAL*8 :: temp386b19
  REAL*8 :: temp388b53
  REAL*8 :: temp404b18
  REAL*8 :: temp406b1
  REAL*8 :: temp412
  REAL*8 :: temp449
  REAL*8 :: temp477b3
  REAL*8 :: temp494b4
  REAL*8 :: temp496b26
  REAL*8 :: temp521b3
  REAL*8 :: temp16b1
  REAL*8 :: temp19
  REAL*8 :: temp68b33
  REAL*8 :: temp189b
  DOUBLE PRECISION :: temp286
  REAL*8 :: temp298b1
  REAL*8 :: temp314b
  REAL*8 :: temp330
  DOUBLE PRECISION :: temp367
  REAL*8 :: temp373b12
  REAL*8 :: temp373b49
  REAL*8 :: temp374b6
  REAL*8 :: temp379b1
  REAL*8 :: temp379b61
  REAL*8 :: temp386b18
  REAL*8 :: temp388b52
  REAL*8 :: temp388b89
  REAL*8 :: temp404b17
  REAL*8 :: temp406b0
  REAL*8 :: temp411
  DOUBLE PRECISION :: temp448
  REAL*8 :: temp477b2
  REAL*8 :: temp494b3
  REAL*8 :: temp496b25
  REAL*8 :: temp521b2
  REAL*8 :: temp16b0
  REAL*8 :: temp18
  REAL*8 :: temp68b32
  REAL*8 :: temp139b6
  REAL*8 :: temp241b
  DOUBLE PRECISION :: temp285
  REAL*8 :: temp298b0
  REAL*8 :: temp322b
  REAL*8 :: temp342b0
  REAL*8 :: temp366
  REAL*8 :: temp373b11
  REAL*8 :: temp373b48
  REAL*8 :: temp374b5
  REAL*8 :: temp379b0
  REAL*8 :: temp379b60
  REAL*8 :: temp386b17
  REAL*8 :: temp388b51
  REAL*8 :: temp388b88
  REAL*8 :: temp404b16
  REAL*8 :: temp410
  REAL*8 :: temp440b1
  DOUBLE PRECISION :: temp447
  REAL*8 :: temp477b1
  REAL*8 :: temp494b2
  REAL*8 :: temp496b24
  REAL*8 :: temp504b0
  REAL*8 :: temp521b1
  REAL*8 :: temp17
  REAL*8 :: temp68b31
  REAL*8 :: temp139b5
  REAL*8 :: temp178b2
  DOUBLE PRECISION :: temp284
  REAL*8 :: temp330b
  DOUBLE PRECISION :: temp365
  REAL*8 :: temp367b
  REAL*8 :: temp373b10
  REAL*8 :: temp373b47
  REAL*8 :: temp374b4
  REAL*8 :: temp386b16
  REAL*8 :: temp388b50
  REAL*8 :: temp388b87
  DOUBLE PRECISION :: temp396b0
  REAL*8 :: temp404b15
  REAL*8 :: temp411b
  REAL*8 :: temp440b0
  REAL*8 :: temp446
  REAL*8 :: temp448b
  REAL*8 :: temp477b0
  REAL*8 :: temp494b1
  REAL*8 :: temp496b23
  REAL*8 :: temp521b0
  REAL*8 :: temp12b
  REAL*8 :: temp16
  REAL*8 :: temp43b8
  REAL*8 :: temp49b
  REAL*8 :: temp68b30
  REAL*8 :: temp87b0
  REAL*8 :: temp139b4
  REAL*8 :: temp178b1
  REAL*8 :: temp216b13
  DOUBLE PRECISION :: temp283
  DOUBLE PRECISION :: temp303b1
  REAL*8 :: temp364
  REAL*8 :: temp373b46
  REAL*8 :: temp374b3
  REAL*8 :: temp386b15
  REAL*8 :: temp388b86
  REAL*8 :: temp404b14
  REAL*8 :: temp445
  REAL*8 :: temp456b
  REAL*8 :: temp494b0
  REAL*8 :: temp496b22
  REAL*8 :: temp500b
  REAL*8 :: temp15
  REAL*8 :: temp20b
  REAL*8 :: temp43b7
  REAL*8 :: temp57b
  REAL*8 :: temp139b3
  REAL*8 :: temp178b0
  REAL*8 :: temp216b12
  REAL*8 :: temp222b0
  REAL*8 :: temp282
  DOUBLE PRECISION :: temp303b0
  DOUBLE PRECISION :: temp363
  REAL*8 :: temp373b45
  REAL*8 :: temp374b2
  REAL*8 :: temp374b17
  REAL*8 :: temp386b14
  REAL*8 :: temp388b85
  REAL*8 :: temp404b13
  REAL*8 :: temp444
  REAL*8 :: temp496b21
  REAL*8 :: temp14
  REAL*8 :: temp43b6
  REAL*8 :: temp65b
  REAL*8 :: temp139b
  REAL*8 :: temp139b2
  REAL*8 :: temp216b11
  REAL*8 :: temp281
  REAL*8 :: temp320b0
  REAL*8 :: temp335b4
  REAL*8 :: temp362
  REAL*8 :: temp373b44
  REAL*8 :: temp374b1
  REAL*8 :: temp374b16
  REAL*8 :: temp386b13
  REAL*8 :: temp388b84
  REAL*8 :: temp391b
  REAL*8 :: temp399
  REAL*8 :: temp404b12
  REAL*8 :: temp438b0
  REAL*8 :: temp443
  REAL*8 :: temp472b
  REAL*8 :: temp496b20
  REAL*8 :: temp13
  REAL*8 :: temp43b5
  REAL*8 :: temp53b24
  REAL*8 :: temp57b39
  REAL*8 :: temp58b9
  REAL*8 :: temp109
  REAL*8 :: temp110b
  REAL*8 :: temp139b1
  REAL*8 :: temp147b
  REAL*8 :: temp156b2
  REAL*8 :: temp216b10
  REAL*8 :: temp228b
  REAL*8 :: temp280
  REAL*8 :: temp309b
  REAL*8 :: temp313b7
  REAL*8 :: temp315b29
  REAL*8 :: temp335b3
  REAL*8 :: temp361
  REAL*8 :: temp373b43
  REAL*8 :: temp374b0
  REAL*8 :: temp374b15
  REAL*8 :: temp386b12
  REAL*8 :: temp386b49
  REAL*8 :: temp388b83
  REAL*8 :: temp398
  REAL*8 :: temp404b11
  REAL*8 :: temp442
  REAL*8 :: temp455b0
  REAL*8 :: temp479
  REAL*8 :: temp480b
  REAL*8 :: temp12
  REAL*8 :: temp43b4
  REAL*8 :: temp49
  REAL*8 :: temp53b23
  REAL*8 :: temp57b38
  REAL*8 :: temp58b8
  REAL*8 :: temp108
  REAL*8 :: temp139b0
  REAL*8 :: temp155b
  REAL*8 :: temp156b1
  REAL*8 :: temp237b1
  REAL*8 :: temp313b6
  REAL*8 :: temp315b28
  REAL*8 :: temp335b2
  REAL*8 :: temp360
  REAL*8 :: temp373b42
  REAL*8 :: temp374b14
  REAL*8 :: temp386b11
  REAL*8 :: temp386b48
  REAL*8 :: temp388b82
  DOUBLE PRECISION :: temp391b0
  REAL*8 :: temp397
  REAL*8 :: temp404b10
  REAL*8 :: temp441
  REAL*8 :: temp472b0
  REAL*8 :: temp478
  REAL*8 :: temp11
  REAL*8 :: temp43b3
  REAL*8 :: temp48
  REAL*8 :: temp53b22
  REAL*8 :: temp57b37
  REAL*8 :: temp58b7
  REAL*8 :: temp107
  REAL*8 :: temp156b0
  REAL*8 :: temp237b0
  REAL*8 :: temp313b5
  REAL*8 :: temp315b27
  REAL*8 :: temp328b9
  REAL*8 :: temp335b1
  REAL*8 :: temp373b41
  REAL*8 :: temp374b13
  REAL*8 :: temp386b10
  REAL*8 :: temp386b47
  REAL*8 :: temp387b19
  REAL*8 :: temp388b81
  DOUBLE PRECISION :: temp396
  REAL*8 :: temp406b
  REAL*8 :: temp440
  REAL*8 :: temp477
  REAL*8 :: temp487b3
  REAL*8 :: temp10
  REAL*8 :: temp43b2
  DOUBLE PRECISION :: temp47
  REAL*8 :: temp53b21
  REAL*8 :: temp57b36
  REAL*8 :: temp58b6
  REAL*8 :: temp106
  REAL*8 :: temp252b
  REAL*8 :: temp313b4
  REAL*8 :: temp315b26
  REAL*8 :: temp328b8
  REAL*8 :: temp333b
  REAL*8 :: temp335b0
  REAL*8 :: temp373b40
  REAL*8 :: temp374b12
  REAL*8 :: temp386b46
  REAL*8 :: temp387b18
  REAL*8 :: temp388b80
  REAL*8 :: temp395
  REAL*8 :: temp414b
  REAL*8 :: temp476
  REAL*8 :: temp487b2
  REAL*8 :: temp520
  REAL*8 :: temp43b1
  DOUBLE PRECISION :: temp46
  REAL*8 :: temp53b20
  REAL*8 :: temp57b35
  REAL*8 :: temp58b5
  DOUBLE PRECISION :: temp105
  REAL*8 :: temp186b10
  REAL*8 :: temp260b
  REAL*8 :: temp271b0
  REAL*8 :: temp297b
  REAL*8 :: temp313b3
  REAL*8 :: temp315b25
  REAL*8 :: temp328b7
  REAL*8 :: temp341b
  REAL*8 :: temp374b11
  REAL*8 :: temp378b
  REAL*8 :: temp386b45
  REAL*8 :: temp387b17
  REAL*8 :: temp389b0
  REAL*8 :: temp394
  REAL*8 :: temp422b
  REAL*8 :: temp459b
  REAL*8 :: temp475
  REAL*8 :: temp487b1
  REAL*8 :: temp497b24
  REAL*8 :: temp503b
  REAL*8 :: temp9b
  REAL*8 :: temp23b
  REAL*8 :: temp43b0
  DOUBLE PRECISION :: temp45
  REAL*8 :: temp53b9
  REAL*8 :: temp57b34
  REAL*8 :: temp58b4
  DOUBLE PRECISION :: temp104
  REAL*8 :: temp313b2
  REAL*8 :: temp315b24
  REAL*8 :: temp328b6
  REAL*8 :: temp373b75
  REAL*8 :: temp374b10
  REAL*8 :: temp386b
  REAL*8 :: temp386b44
  REAL*8 :: temp387b16
  REAL*8 :: temp393
  REAL*8 :: temp404b43
  REAL*8 :: temp430b
  REAL*8 :: temp450b0
  REAL*8 :: temp467b
  REAL*8 :: temp474
  REAL*8 :: temp487b0
  REAL*8 :: temp497b9
  REAL*8 :: temp497b23
  REAL*8 :: temp511b
  REAL*8 :: temp31b
  DOUBLE PRECISION :: temp44
  REAL*8 :: temp53b8
  REAL*8 :: temp57b33
  REAL*8 :: temp58b3
  REAL*8 :: temp68b
  DOUBLE PRECISION :: temp103
  REAL*8 :: temp188b1
  REAL*8 :: temp313b1
  REAL*8 :: temp315b23
  REAL*8 :: temp328b5
  REAL*8 :: temp330b2
  REAL*8 :: temp373b74
  REAL*8 :: temp386b43
  REAL*8 :: temp387b15
  REAL*8 :: temp392
  REAL*8 :: temp394b
  REAL*8 :: temp404b42
  REAL*8 :: temp448b2
  REAL*8 :: temp473
  REAL*8 :: temp475b
  REAL*8 :: temp497b8
  REAL*8 :: temp497b22
  REAL*8 :: temp43
  REAL*8 :: temp53b7
  REAL*8 :: temp57b32
  REAL*8 :: temp58b2
  DOUBLE PRECISION :: temp102
  REAL*8 :: temp139
  REAL*8 :: temp188b0
  REAL*8 :: temp313b0
  REAL*8 :: temp315b22
  REAL*8 :: temp328b4
  REAL*8 :: temp330b1
  REAL*8 :: temp367b1
  REAL*8 :: temp373b73
  REAL*8 :: temp386b42
  REAL*8 :: temp387b14
  DOUBLE PRECISION :: temp391
  REAL*8 :: temp404b9
  REAL*8 :: temp404b41
  REAL*8 :: temp448b1
  REAL*8 :: temp472
  REAL*8 :: temp483b
  REAL*8 :: temp497b7
  REAL*8 :: temp497b21
  REAL*8 :: temp42
  REAL*8 :: temp53b6
  REAL*8 :: temp57b31
  REAL*8 :: temp58b1
  DOUBLE PRECISION :: temp79
  REAL*8 :: temp92b3
  DOUBLE PRECISION :: temp101
  REAL*8 :: temp138
  REAL*8 :: temp202b
  REAL*8 :: temp219
  REAL*8 :: temp239b
  REAL*8 :: temp315b21
  REAL*8 :: temp328b3
  REAL*8 :: temp330b0
  REAL*8 :: temp367b0
  REAL*8 :: temp373b72
  REAL*8 :: temp380b29
  REAL*8 :: temp386b41
  REAL*8 :: temp387b13
  REAL*8 :: temp390
  REAL*8 :: temp404b8
  REAL*8 :: temp404b40
  REAL*8 :: temp448b0
  REAL*8 :: temp465b1
  REAL*8 :: temp471
  REAL*8 :: temp491b
  REAL*8 :: temp497b6
  REAL*8 :: temp497b20
  REAL*8 :: temp41
  REAL*8 :: temp53b5
  REAL*8 :: temp57b30
  REAL*8 :: temp58b0
  REAL*8 :: temp68b9
  REAL*8 :: temp78
  REAL*8 :: temp92b
  REAL*8 :: temp92b2
  DOUBLE PRECISION :: temp100
  DOUBLE PRECISION :: temp112b1
  DOUBLE PRECISION :: temp137
  REAL*8 :: temp149b1
  REAL*8 :: temp166b
  REAL*8 :: temp166b2
  REAL*8 :: temp218
  REAL*8 :: temp247b
  REAL*8 :: temp315b20
  REAL*8 :: temp328b
  REAL*8 :: temp328b2
  REAL*8 :: temp345b3
  REAL*8 :: temp373b71
  REAL*8 :: temp380b28
  REAL*8 :: temp386b40
  REAL*8 :: temp387b12
  REAL*8 :: temp387b49
  REAL*8 :: temp404b7
  REAL*8 :: temp409b
  REAL*8 :: temp465b0
  REAL*8 :: temp470
  REAL*8 :: temp497b5
  REAL*8 :: temp40
  REAL*8 :: temp53b4
  REAL*8 :: temp68b8
  REAL*8 :: temp77
  REAL*8 :: temp92b1
  DOUBLE PRECISION :: temp112b0
  DOUBLE PRECISION :: temp136
  REAL*8 :: temp149b0
  REAL*8 :: temp166b1
  REAL*8 :: temp174b
  REAL*8 :: temp217
  REAL*8 :: temp255b
  REAL*8 :: temp281b3
  REAL*8 :: temp328b1
  REAL*8 :: temp328b25
  REAL*8 :: temp336b
  REAL*8 :: temp345b2
  REAL*8 :: temp373b70
  REAL*8 :: temp379b29
  REAL*8 :: temp380b27
  REAL*8 :: temp387b11
  REAL*8 :: temp387b48
  REAL*8 :: temp404b6
  REAL*8 :: temp417b
  REAL*8 :: temp497b4
  REAL*8 :: temp18b
  REAL*8 :: temp53b3
  REAL*8 :: temp68b7
  DOUBLE PRECISION :: temp76
  REAL*8 :: temp92b0
  REAL*8 :: temp135
  REAL*8 :: temp166b0
  REAL*8 :: temp216
  REAL*8 :: temp247b0
  REAL*8 :: temp264b1
  REAL*8 :: temp281b2
  REAL*8 :: temp328b0
  REAL*8 :: temp328b24
  REAL*8 :: temp344b
  REAL*8 :: temp345b1
  REAL*8 :: temp379b28
  REAL*8 :: temp380b26
  REAL*8 :: temp387b10
  REAL*8 :: temp387b47
  REAL*8 :: temp388b19
  REAL*8 :: temp404b5
  REAL*8 :: temp409b0
  REAL*8 :: temp425b
  REAL*8 :: temp497b3
  REAL*8 :: temp42b24
  REAL*8 :: temp53b2
  REAL*8 :: temp68b6
  REAL*8 :: temp75
  REAL*8 :: temp134
  REAL*8 :: temp215
  REAL*8 :: temp264b0
  REAL*8 :: temp271b
  REAL*8 :: temp281b1
  REAL*8 :: temp328b23
  REAL*8 :: temp345b0
  REAL*8 :: temp379b27
  REAL*8 :: temp380b25
  REAL*8 :: temp387b46
  REAL*8 :: temp388b18
  REAL*8 :: temp389b
  REAL*8 :: temp404b4
  REAL*8 :: temp497b2
  REAL*8 :: temp34b
  REAL*8 :: temp42b23
  REAL*8 :: temp53b1
  REAL*8 :: temp68b5
  REAL*8 :: temp74
  DOUBLE PRECISION :: temp133
  DOUBLE PRECISION :: temp214
  REAL*8 :: temp281b0
  REAL*8 :: temp328b22
  REAL*8 :: temp360b
  REAL*8 :: temp379b26
  REAL*8 :: temp380b24
  REAL*8 :: temp387b45
  REAL*8 :: temp388b17
  REAL*8 :: temp397b
  REAL*8 :: temp404b3
  REAL*8 :: temp441b
  REAL*8 :: temp478b
  REAL*8 :: temp497b1
  REAL*8 :: temp42b
  REAL*8 :: temp42b22
  REAL*8 :: temp53b0
  REAL*8 :: temp68b4
  DOUBLE PRECISION :: temp73
  REAL*8 :: temp79b
  DOUBLE PRECISION :: temp132
  DOUBLE PRECISION :: temp169
  DOUBLE PRECISION :: temp213
  REAL*8 :: temp328b21
  REAL*8 :: temp379b25
  REAL*8 :: temp380b23
  REAL*8 :: temp387b44
  REAL*8 :: temp388b16
  REAL*8 :: temp404b2
  REAL*8 :: temp475b4
  REAL*8 :: temp486b
  REAL*8 :: temp497b0
  REAL*8 :: temp517b7
  REAL*8 :: temp5b0
  REAL*8 :: temp42b21
  REAL*8 :: temp50b
  REAL*8 :: temp68b3
  DOUBLE PRECISION :: temp72
  REAL*8 :: temp87b
  DOUBLE PRECISION :: temp131
  DOUBLE PRECISION :: temp168
  REAL*8 :: temp212
  DOUBLE PRECISION :: temp249
  REAL*8 :: temp328b20
  REAL*8 :: temp379b24
  REAL*8 :: temp380b22
  REAL*8 :: temp380b59
  REAL*8 :: temp387b43
  REAL*8 :: temp388b15
  REAL*8 :: temp394b3
  REAL*8 :: temp404b1
  REAL*8 :: temp475b3
  REAL*8 :: temp494b
  REAL*8 :: temp517b6
  REAL*8 :: tempb
  REAL*8 :: temp42b20
  REAL*8 :: temp68b2
  DOUBLE PRECISION :: temp71
  DOUBLE PRECISION :: temp130
  DOUBLE PRECISION :: temp167
  REAL*8 :: temp176b4
  REAL*8 :: temp211
  REAL*8 :: temp203b3
  REAL*8 :: temp242b0
  DOUBLE PRECISION :: temp248
  REAL*8 :: temp329
  REAL*8 :: temp379b23
  REAL*8 :: temp380b21
  REAL*8 :: temp380b58
  REAL*8 :: temp387b42
  REAL*8 :: temp388b14
  REAL*8 :: temp394b2
  REAL*8 :: temp404b0
  REAL*8 :: temp475b2
  REAL*8 :: temp492b3
  REAL*8 :: temp517b5
  REAL*8 :: temp14b0
  REAL*8 :: temp68b1
  REAL*8 :: temp70
  REAL*8 :: temp140b
  DOUBLE PRECISION :: temp166
  REAL*8 :: temp176b3
  REAL*8 :: temp177b
  DOUBLE PRECISION :: temp210
  REAL*8 :: temp203b2
  REAL*8 :: temp221b
  REAL*8 :: temp247
  DOUBLE PRECISION :: temp258b
  REAL*8 :: temp302b
  REAL*8 :: temp316b7
  DOUBLE PRECISION :: temp328
  REAL*8 :: temp338b3
  REAL*8 :: temp340b0
  REAL*8 :: temp379b22
  REAL*8 :: temp379b59
  REAL*8 :: temp380b20
  REAL*8 :: temp380b57
  REAL*8 :: temp387b9
  REAL*8 :: temp387b41
  REAL*8 :: temp388b13
  REAL*8 :: temp394b1
  REAL*8 :: temp409
  REAL*8 :: temp421b0
  REAL*8 :: temp475b1
  REAL*8 :: temp492b2
  REAL*8 :: temp517b4
  REAL*8 :: temp31b0
  REAL*8 :: temp68b0
  REAL*8 :: temp165
  REAL*8 :: temp176b2
  REAL*8 :: temp203b1
  REAL*8 :: temp246
  REAL*8 :: temp310b
  REAL*8 :: temp316b6
  REAL*8 :: temp321b33
  DOUBLE PRECISION :: temp327
  REAL*8 :: temp338b2
  REAL*8 :: temp347b
  REAL*8 :: temp379b21
  REAL*8 :: temp379b58
  REAL*8 :: temp380b56
  REAL*8 :: temp387b8
  REAL*8 :: temp387b40
  REAL*8 :: temp388b12
  REAL*8 :: temp388b49
  REAL*8 :: temp394b0
  REAL*8 :: temp408
  REAL*8 :: temp428b
  REAL*8 :: temp475b0
  REAL*8 :: temp485b9
  REAL*8 :: temp492b1
  REAL*8 :: temp509b
  REAL*8 :: temp517b3
  REAL*8 :: temp29b
  REAL*8 :: temp68b29
  DOUBLE PRECISION :: temp100b4
  REAL*8 :: temp164
  REAL*8 :: temp176b1
  REAL*8 :: temp203b0
  REAL*8 :: temp245
  REAL*8 :: temp316b5
  REAL*8 :: temp321b32
  DOUBLE PRECISION :: temp326
  REAL*8 :: temp338b1
  REAL*8 :: temp355b
  REAL*8 :: temp379b20
  REAL*8 :: temp379b57
  REAL*8 :: temp380b55
  REAL*8 :: temp387b7
  REAL*8 :: temp388b11
  REAL*8 :: temp388b48
  REAL*8 :: temp407
  REAL*8 :: temp436b
  REAL*8 :: temp485b8
  REAL*8 :: temp492b0
  REAL*8 :: temp517b
  REAL*8 :: temp517b2
  REAL*8 :: temp0b0
  REAL*8 :: temp68b28
  DOUBLE PRECISION :: temp100b3
  DOUBLE PRECISION :: temp163
  REAL*8 :: temp176b0
  REAL*8 :: temp186b9
  REAL*8 :: temp244
  REAL*8 :: temp282b
  REAL*8 :: temp316b4
  REAL*8 :: temp321b31
  DOUBLE PRECISION :: temp325
  REAL*8 :: temp338b0
  REAL*8 :: temp355b1
  REAL*8 :: temp363b
  REAL*8 :: temp379b56
  REAL*8 :: temp380b54
  REAL*8 :: temp387b6
  REAL*8 :: temp388b10
  REAL*8 :: temp388b47
  REAL*8 :: temp406
  REAL*8 :: temp485b7
  REAL*8 :: temp517b1
  REAL*8 :: temp29b0
  REAL*8 :: temp68b27
  DOUBLE PRECISION :: temp100b2
  REAL*8 :: temp119b
  DOUBLE PRECISION :: temp162
  REAL*8 :: temp186b8
  DOUBLE PRECISION :: temp199
  REAL*8 :: temp218b2
  REAL*8 :: temp243
  REAL*8 :: temp316b3
  REAL*8 :: temp321b30
  DOUBLE PRECISION :: temp324
  REAL*8 :: temp355b0
  REAL*8 :: temp379b55
  REAL*8 :: temp380b53
  REAL*8 :: temp387b5
  REAL*8 :: temp388b46
  REAL*8 :: temp405
  REAL*8 :: temp485b6
  REAL*8 :: temp489b
  REAL*8 :: temp496b19
  REAL*8 :: temp517b0
  REAL*8 :: temp39b8
  REAL*8 :: temp46b0
  REAL*8 :: temp53b
  REAL*8 :: temp68b26
  REAL*8 :: temp100b1
  REAL*8 :: temp161
  REAL*8 :: temp186b7
  REAL*8 :: temp198
  REAL*8 :: temp218b1
  REAL*8 :: temp242
  DOUBLE PRECISION :: temp279
  REAL*8 :: temp316b2
  DOUBLE PRECISION :: temp323
  REAL*8 :: temp379b54
  REAL*8 :: temp380b52
  REAL*8 :: temp387b4
  REAL*8 :: temp388b45
  REAL*8 :: temp404
  REAL*8 :: temp453b0
  REAL*8 :: temp474b21
  REAL*8 :: temp485b5
  REAL*8 :: temp496b18
  REAL*8 :: temp497b
  REAL*8 :: temp39b7
  REAL*8 :: temp61b
  REAL*8 :: temp68b25
  REAL*8 :: temp100b0
  REAL*8 :: temp160
  REAL*8 :: temp186b6
  REAL*8 :: temp197
  REAL*8 :: temp216b
  REAL*8 :: temp218b0
  REAL*8 :: temp235b1
  REAL*8 :: temp241
  REAL*8 :: temp278
  REAL*8 :: temp316b1
  DOUBLE PRECISION :: temp322
  DOUBLE PRECISION :: temp359
  REAL*8 :: temp379b53
  REAL*8 :: temp380b51
  REAL*8 :: temp387b3
  REAL*8 :: temp388b44
  DOUBLE PRECISION :: temp403
  REAL*8 :: temp470b0
  REAL*8 :: temp474b20
  REAL*8 :: temp485b4
  REAL*8 :: temp496b17
  REAL*8 :: temp39b6
  REAL*8 :: temp68b24
  REAL*8 :: temp154b0
  REAL*8 :: temp186b5
  DOUBLE PRECISION :: temp196
  REAL*8 :: temp224b
  REAL*8 :: temp235b0
  REAL*8 :: temp240
  REAL*8 :: temp277
  REAL*8 :: temp316b0
  REAL*8 :: temp321
  REAL*8 :: temp333b1
  DOUBLE PRECISION :: temp358
  REAL*8 :: temp379b52
  REAL*8 :: temp380b50
  REAL*8 :: temp387b2
  REAL*8 :: temp388b43
  REAL*8 :: temp402
  REAL*8 :: temp414b1
  REAL*8 :: temp439
  REAL*8 :: temp485b3
  REAL*8 :: temp496b16
  REAL*8 :: temp39b5
  REAL*8 :: temp68b23
  REAL*8 :: temp151b
  REAL*8 :: temp164b8
  REAL*8 :: temp186b4
  REAL*8 :: temp188b
  DOUBLE PRECISION :: temp195
  REAL*8 :: temp232b
  REAL*8 :: temp269b
  DOUBLE PRECISION :: temp252b0
  DOUBLE PRECISION :: temp276
  REAL*8 :: temp313b
  REAL*8 :: temp320
  REAL*8 :: temp333b0
  DOUBLE PRECISION :: temp357
  REAL*8 :: temp373b39
  REAL*8 :: temp379b51
  REAL*8 :: temp387b1
  REAL*8 :: temp388b42
  REAL*8 :: temp388b79
  REAL*8 :: temp401
  REAL*8 :: temp414b0
  REAL*8 :: temp438
  REAL*8 :: temp485b2
  REAL*8 :: temp496b15
  REAL*8 :: temp519
  REAL*8 :: temp24b0
  REAL*8 :: temp39b4
  REAL*8 :: temp53b19
  REAL*8 :: temp68b22
  REAL*8 :: temp164b7
  REAL*8 :: temp186b3
  REAL*8 :: temp194
  REAL*8 :: temp240b
  DOUBLE PRECISION :: temp275
  REAL*8 :: temp321b
  REAL*8 :: temp322b34
  REAL*8 :: temp348b3
  REAL*8 :: temp350b0
  DOUBLE PRECISION :: temp356
  REAL*8 :: temp358b
  REAL*8 :: temp373b38
  REAL*8 :: temp379b50
  REAL*8 :: temp387b0
  REAL*8 :: temp388b41
  REAL*8 :: temp388b78
  REAL*8 :: temp400
  REAL*8 :: temp402b
  REAL*8 :: temp437
  REAL*8 :: temp439b
  REAL*8 :: temp478b9
  REAL*8 :: temp485b1
  REAL*8 :: temp496b14
  REAL*8 :: temp512b0
  REAL*8 :: temp518
  REAL*8 :: temp39b3
  REAL*8 :: temp53b18
  REAL*8 :: temp68b21
  REAL*8 :: temp78b0
  REAL*8 :: temp164b6
  REAL*8 :: temp186b2
  REAL*8 :: temp193
  DOUBLE PRECISION :: temp274
  REAL*8 :: temp309b5
  REAL*8 :: temp322b33
  REAL*8 :: temp348b2
  REAL*8 :: temp355
  REAL*8 :: temp366b
  REAL*8 :: temp373b37
  REAL*8 :: temp388b40
  REAL*8 :: temp388b77
  REAL*8 :: temp410b
  REAL*8 :: temp436
  REAL*8 :: temp447b
  REAL*8 :: temp478b8
  REAL*8 :: temp485b0
  REAL*8 :: temp496b13
  INTEGER :: temp517
  REAL*8 :: temp39b2
  REAL*8 :: temp48b
  REAL*8 :: temp53b17
  REAL*8 :: temp68b20
  REAL*8 :: temp164b5
  REAL*8 :: temp186b1
  DOUBLE PRECISION :: temp192
  DOUBLE PRECISION :: temp273
  REAL*8 :: temp309b4
  REAL*8 :: temp322b32
  REAL*8 :: temp348b1
  REAL*8 :: temp354
  REAL*8 :: temp373b36
  REAL*8 :: temp374b
  REAL*8 :: temp388b76
  REAL*8 :: temp429b1
  REAL*8 :: temp435
  REAL*8 :: temp455b
  REAL*8 :: temp478b7
  REAL*8 :: temp480b4
  REAL*8 :: temp496b12
  REAL*8 :: temp516
  REAL*8 :: temp5b
  REAL*8 :: temp39b1
  REAL*8 :: temp53b16
  REAL*8 :: temp164b4
  REAL*8 :: temp186b0
  DOUBLE PRECISION :: temp191
  REAL*8 :: temp272
  REAL*8 :: temp309b3
  REAL*8 :: temp321b9
  REAL*8 :: temp322b31
  REAL*8 :: temp348b0
  DOUBLE PRECISION :: temp353
  REAL*8 :: temp373b35
  REAL*8 :: temp388b75
  REAL*8 :: temp397b6
  REAL*8 :: temp429b0
  REAL*8 :: temp434
  REAL*8 :: temp463b
  REAL*8 :: temp478b6
  REAL*8 :: temp480b3
  REAL*8 :: temp496b11
  REAL*8 :: temp515
  REAL*8 :: temp39b0
  REAL*8 :: temp53b15
  REAL*8 :: temp64b
  REAL*8 :: temp68b55
  REAL*8 :: temp138b
  REAL*8 :: temp164b3
  DOUBLE PRECISION :: temp190
  REAL*8 :: temp219b
  REAL*8 :: temp271
  REAL*8 :: temp309b2
  REAL*8 :: temp321b8
  REAL*8 :: temp322b30
  DOUBLE PRECISION :: temp352
  REAL*8 :: temp373b34
  REAL*8 :: temp388b74
  REAL*8 :: temp389
  REAL*8 :: temp390b
  REAL*8 :: temp397b5
  REAL*8 :: temp404b39
  REAL*8 :: temp433
  REAL*8 :: temp446b0
  REAL*8 :: temp471b
  REAL*8 :: temp478b5
  REAL*8 :: temp480b2
  REAL*8 :: temp496b10
  REAL*8 :: temp497b19
  REAL*8 :: temp514
  REAL*8 :: temp53b14
  REAL*8 :: temp57b29
  REAL*8 :: temp68b54
  REAL*8 :: temp146b
  REAL*8 :: temp164b2
  REAL*8 :: temp227b
  REAL*8 :: temp270
  REAL*8 :: temp309b1
  REAL*8 :: temp315b19
  REAL*8 :: temp321b7
  DOUBLE PRECISION :: temp351
  REAL*8 :: temp373b33
  REAL*8 :: temp386b39
  REAL*8 :: temp388b73
  REAL*8 :: temp388
  REAL*8 :: temp397b4
  REAL*8 :: temp404b38
  REAL*8 :: temp432
  REAL*8 :: temp463b0
  REAL*8 :: temp469
  REAL*8 :: temp478b4
  REAL*8 :: temp480b1
  REAL*8 :: temp497b18
  INTEGER :: temp513
  REAL*8 :: temp39
  REAL*8 :: temp53b13
  REAL*8 :: temp57b28
  REAL*8 :: temp68b53
  REAL*8 :: temp147b0
  REAL*8 :: temp154b
  REAL*8 :: temp164b1
  REAL*8 :: temp235b
  REAL*8 :: temp309b0
  REAL*8 :: temp315b18
  REAL*8 :: temp316b
  REAL*8 :: temp321b6
  DOUBLE PRECISION :: temp350
  REAL*8 :: temp373b32
  REAL*8 :: temp373b69
  REAL*8 :: temp386b38
  REAL*8 :: temp387
  REAL*8 :: temp388b72
  REAL*8 :: temp397b3
  REAL*8 :: temp404b37
  REAL*8 :: temp431
  REAL*8 :: temp468
  REAL*8 :: temp478b3
  REAL*8 :: temp480b0
  REAL*8 :: temp490b9
  REAL*8 :: temp497b17
  REAL*8 :: temp512
  REAL*8 :: temp38
  REAL*8 :: temp53b12
  REAL*8 :: temp57b27
  REAL*8 :: temp68b52
  REAL*8 :: temp164b0
  REAL*8 :: temp243b
  REAL*8 :: temp299b1
  REAL*8 :: temp315b17
  REAL*8 :: temp321b5
  REAL*8 :: temp373b31
  REAL*8 :: temp373b68
  REAL*8 :: temp386b37
  REAL*8 :: temp386
  REAL*8 :: temp388b71
  REAL*8 :: temp397b2
  REAL*8 :: temp404b36
  REAL*8 :: temp405b
  REAL*8 :: temp430
  REAL*8 :: temp467
  REAL*8 :: temp478b2
  REAL*8 :: temp490b8
  REAL*8 :: temp497b16
  REAL*8 :: temp505b1
  REAL*8 :: temp511
  REAL*8 :: temp17b0
  REAL*8 :: temp37
  REAL*8 :: temp53b11
  REAL*8 :: temp57b26
  REAL*8 :: temp68b51
  REAL*8 :: temp174b8
  REAL*8 :: temp251b
  REAL*8 :: temp299b0
  REAL*8 :: temp315b16
  REAL*8 :: temp321b4
  REAL*8 :: temp332b
  REAL*8 :: temp369b
  REAL*8 :: temp373b30
  REAL*8 :: temp373b67
  DOUBLE PRECISION :: temp385
  REAL*8 :: temp386b36
  REAL*8 :: temp388b70
  REAL*8 :: temp397b1
  REAL*8 :: temp404b35
  REAL*8 :: temp413b
  REAL*8 :: temp424b0
  REAL*8 :: temp466
  REAL*8 :: temp478b1
  REAL*8 :: temp490b7
  REAL*8 :: temp497b15
  REAL*8 :: temp505b0
  REAL*8 :: temp510
  REAL*8 :: temp14b
  REAL*8 :: temp36
  REAL*8 :: temp53b10
  REAL*8 :: temp57b25
  REAL*8 :: temp68b50
  REAL*8 :: temp174b7
  REAL*8 :: temp315b15
  REAL*8 :: temp321b3
  REAL*8 :: temp340b
  REAL*8 :: temp360b0
  REAL*8 :: temp373b66
  DOUBLE PRECISION :: temp384
  REAL*8 :: temp386b35
  REAL*8 :: temp397b0
  REAL*8 :: temp404b34
  REAL*8 :: temp421b
  REAL*8 :: temp465
  REAL*8 :: temp478b0
  REAL*8 :: temp488b9
  REAL*8 :: temp490b6
  REAL*8 :: temp497b14
  REAL*8 :: temp8b
  REAL*8 :: temp35
  REAL*8 :: temp54b18
  REAL*8 :: temp57b24
  REAL*8 :: temp59b
  REAL*8 :: temp88b0
  REAL*8 :: temp174b6
  REAL*8 :: temp216b9
  REAL*8 :: temp223b1
  REAL*8 :: temp315b14
  REAL*8 :: temp321b2
  REAL*8 :: temp373b65
  DOUBLE PRECISION :: temp383
  REAL*8 :: temp386b34
  REAL*8 :: temp404b33
  REAL*8 :: temp456b3
  REAL*8 :: temp464
  REAL*8 :: temp488b8
  REAL*8 :: temp490b5
  REAL*8 :: temp496b41
  REAL*8 :: temp497b13
  REAL*8 :: temp34
  REAL*8 :: temp54b17
  REAL*8 :: temp57b23
  REAL*8 :: temp120b4
  REAL*8 :: temp174b5
  REAL*8 :: temp216b8
  REAL*8 :: temp223b0
  REAL*8 :: temp315b13
  REAL*8 :: temp321b1
  REAL*8 :: temp328b19
  REAL*8 :: temp373b64
  DOUBLE PRECISION :: temp382
  REAL*8 :: temp386b33
  REAL*8 :: temp393b
  REAL*8 :: temp402b1
  REAL*8 :: temp404b32
  REAL*8 :: temp456b2
  DOUBLE PRECISION :: temp463
  REAL*8 :: temp474b
  REAL*8 :: temp488b7
  REAL*8 :: temp490b4
  REAL*8 :: temp496b40
  REAL*8 :: temp497b12
  REAL*8 :: temp27b5
  REAL*8 :: temp33
  REAL*8 :: temp42b19
  REAL*8 :: temp54b16
  REAL*8 :: temp57b22
  DOUBLE PRECISION :: temp112b
  REAL*8 :: temp120b3
  REAL*8 :: temp129
  REAL*8 :: temp149b
  REAL*8 :: temp174b4
  REAL*8 :: temp216b7
  REAL*8 :: temp315b12
  REAL*8 :: temp321b0
  REAL*8 :: temp328b18
  REAL*8 :: temp373b63
  DOUBLE PRECISION :: temp381
  REAL*8 :: temp386b32
  REAL*8 :: temp392b2
  REAL*8 :: temp402b0
  REAL*8 :: temp404b31
  REAL*8 :: temp439b0
  REAL*8 :: temp456b1
  REAL*8 :: temp462
  REAL*8 :: temp473b2
  REAL*8 :: temp488b6
  REAL*8 :: temp490b3
  REAL*8 :: temp497b11
  REAL*8 :: temp499
  REAL*8 :: temp27b4
  DOUBLE PRECISION :: temp32
  REAL*8 :: temp42b18
  REAL*8 :: temp54b15
  REAL*8 :: temp57b21
  REAL*8 :: temp69
  REAL*8 :: temp118b5
  REAL*8 :: temp120b
  REAL*8 :: temp120b2
  REAL*8 :: temp128
  REAL*8 :: temp174b3
  DOUBLE PRECISION :: temp209
  REAL*8 :: temp216b6
  REAL*8 :: temp238b
  REAL*8 :: temp315b11
  REAL*8 :: temp328b17
  REAL*8 :: temp373b62
  REAL*8 :: temp380b19
  DOUBLE PRECISION :: temp380
  REAL*8 :: temp386b31
  REAL*8 :: temp392b1
  REAL*8 :: temp404b30
  REAL*8 :: temp456b0
  REAL*8 :: temp461
  REAL*8 :: temp473b1
  REAL*8 :: temp488b5
  REAL*8 :: temp490b
  REAL*8 :: temp490b2
  REAL*8 :: temp497b10
  REAL*8 :: temp498
  REAL*8 :: temp500b0
  REAL*8 :: temp27b3
  DOUBLE PRECISION :: temp31
  REAL*8 :: temp42b17
  REAL*8 :: temp54b14
  REAL*8 :: temp57b20
  DOUBLE PRECISION :: temp68
  REAL*8 :: temp91b
  REAL*8 :: temp118b4
  REAL*8 :: temp120b1
  DOUBLE PRECISION :: temp127
  REAL*8 :: temp165b
  REAL*8 :: temp174b2
  REAL*8 :: temp208
  REAL*8 :: temp216b5
  REAL*8 :: temp246b
  REAL*8 :: temp272b3
  REAL*8 :: temp315b10
  REAL*8 :: temp328b16
  REAL*8 :: temp373b61
  REAL*8 :: temp380b18
  REAL*8 :: temp386b30
  REAL*8 :: temp387b39
  REAL*8 :: temp392b0
  REAL*8 :: temp408b
  REAL*8 :: temp460
  REAL*8 :: temp473b0
  REAL*8 :: temp488b4
  REAL*8 :: temp490b1
  INTEGER :: temp497
  REAL*8 :: temp27b2
  DOUBLE PRECISION :: temp30
  REAL*8 :: temp42b16
  REAL*8 :: temp54b13
  REAL*8 :: temp57b56
  REAL*8 :: temp67
  REAL*8 :: temp118b3
  REAL*8 :: temp120b0
  DOUBLE PRECISION :: temp126
  REAL*8 :: temp174b1
  REAL*8 :: temp207
  REAL*8 :: temp216b4
  REAL*8 :: temp272b2
  REAL*8 :: temp328b15
  REAL*8 :: temp335b
  REAL*8 :: temp373b60
  REAL*8 :: temp379b19
  REAL*8 :: temp380b17
  REAL*8 :: temp387b38
  REAL*8 :: temp416b
  REAL*8 :: temp417b1
  REAL*8 :: temp485b11
  REAL*8 :: temp488b3
  REAL*8 :: temp490b0
  REAL*8 :: temp496
  REAL*8 :: temp17b
  REAL*8 :: temp27b1
  REAL*8 :: temp42b15
  REAL*8 :: temp54b12
  REAL*8 :: temp57b55
  REAL*8 :: temp66
  REAL*8 :: temp118b2
  REAL*8 :: temp125
  REAL*8 :: temp174b0
  DOUBLE PRECISION :: temp206
  REAL*8 :: temp216b3
  REAL*8 :: temp272b1
  REAL*8 :: temp299b
  REAL*8 :: temp328b14
  REAL*8 :: temp336b0
  REAL*8 :: temp343b
  REAL*8 :: temp379b18
  REAL*8 :: temp380b16
  REAL*8 :: temp387b37
  REAL*8 :: temp417b0
  REAL*8 :: temp424b
  REAL*8 :: temp485b10
  REAL*8 :: temp488b2
  REAL*8 :: temp495
  REAL*8 :: temp505b
  REAL*8 :: temp25b
  REAL*8 :: temp27b0
  REAL*8 :: temp42b14
  REAL*8 :: temp54b11
  REAL*8 :: temp57b54
  REAL*8 :: temp65
  REAL*8 :: temp118b1
  REAL*8 :: temp124
  REAL*8 :: temp189b3
  DOUBLE PRECISION :: temp205
  REAL*8 :: temp216b2
  REAL*8 :: temp272b0
  REAL*8 :: temp314b3
  REAL*8 :: temp321b29
  REAL*8 :: temp328b13
  REAL*8 :: temp370b1
  REAL*8 :: temp379b17
  REAL*8 :: temp380b15
  REAL*8 :: temp387b36
  REAL*8 :: temp388b
  REAL*8 :: temp432b
  REAL*8 :: temp451b1
  REAL*8 :: temp469b
  REAL*8 :: temp488b1
  REAL*8 :: temp494
  REAL*8 :: temp513b
  REAL*8 :: temp33b
  REAL*8 :: temp42b13
  REAL*8 :: temp44b0
  REAL*8 :: temp54b9
  REAL*8 :: temp54b10
  REAL*8 :: temp57b53
  REAL*8 :: temp64
  REAL*8 :: temp118b0
  DOUBLE PRECISION :: temp123
  REAL*8 :: temp189b2
  DOUBLE PRECISION :: temp204
  REAL*8 :: temp216b1
  REAL*8 :: temp314b2
  REAL*8 :: temp321b28
  REAL*8 :: temp328b12
  REAL*8 :: temp370b0
  REAL*8 :: temp379b16
  REAL*8 :: temp380b9
  REAL*8 :: temp380b14
  REAL*8 :: temp387b35
  REAL*8 :: temp396b
  REAL*8 :: temp412b3
  REAL*8 :: temp440b
  REAL*8 :: temp451b0
  REAL*8 :: temp477b
  REAL*8 :: temp488b0
  DOUBLE PRECISION :: temp493
  REAL*8 :: temp521b
  REAL*8 :: temp42b12
  REAL*8 :: temp54b8
  REAL*8 :: temp57b52
  REAL*8 :: temp63
  REAL*8 :: temp61b0
  REAL*8 :: temp78b
  DOUBLE PRECISION :: temp122
  REAL*8 :: temp128b8
  DOUBLE PRECISION :: temp159
  REAL*8 :: temp189b1
  DOUBLE PRECISION :: temp203
  REAL*8 :: temp216b0
  REAL*8 :: temp314b1
  REAL*8 :: temp321b27
  REAL*8 :: temp328b11
  REAL*8 :: temp379b15
  REAL*8 :: temp380b8
  REAL*8 :: temp380b13
  REAL*8 :: temp387b34
  REAL*8 :: temp412b2
  REAL*8 :: temp474b19
  REAL*8 :: temp483b4
  REAL*8 :: temp485b
  REAL*8 :: temp492
  REAL*8 :: temp42b11
  REAL*8 :: temp54b7
  REAL*8 :: temp57b51
  DOUBLE PRECISION :: temp62
  REAL*8 :: temp86b
  REAL*8 :: temp99
  DOUBLE PRECISION :: temp121
  REAL*8 :: temp128b7
  DOUBLE PRECISION :: temp158
  REAL*8 :: temp189b0
  REAL*8 :: temp202
  REAL*8 :: temp239
  REAL*8 :: temp314b0
  REAL*8 :: temp321b26
  REAL*8 :: temp328b10
  REAL*8 :: temp331b1
  REAL*8 :: temp379b14
  REAL*8 :: temp380b7
  REAL*8 :: temp380b12
  REAL*8 :: temp380b49
  REAL*8 :: temp387b33
  REAL*8 :: temp412b1
  REAL*8 :: temp474b18
  REAL*8 :: temp483b3
  REAL*8 :: temp491
  REAL*8 :: temp493b
  REAL*8 :: temp42b10
  REAL*8 :: temp54b6
  REAL*8 :: temp57b50
  DOUBLE PRECISION :: temp61
  REAL*8 :: temp98
  DOUBLE PRECISION :: temp120
  REAL*8 :: temp128b6
  DOUBLE PRECISION :: temp157
  REAL*8 :: temp201
  REAL*8 :: temp238
  REAL*8 :: temp249b
  DOUBLE PRECISION :: temp319
  REAL*8 :: temp321b25
  REAL*8 :: temp331b0
  REAL*8 :: temp346b4
  REAL*8 :: temp379b13
  REAL*8 :: temp380b6
  REAL*8 :: temp380b11
  REAL*8 :: temp380b48
  REAL*8 :: temp387b32
  REAL*8 :: temp412b0
  REAL*8 :: temp474b17
  REAL*8 :: temp483b2
  REAL*8 :: temp490
  REAL*8 :: temp54b5
  DOUBLE PRECISION :: temp60
  REAL*8 :: temp59b0
  REAL*8 :: temp97
  REAL*8 :: temp93b2
  REAL*8 :: temp128b5
  REAL*8 :: temp130b2
  DOUBLE PRECISION :: temp156
  REAL*8 :: temp176b
  DOUBLE PRECISION :: temp200
  REAL*8 :: temp237
  DOUBLE PRECISION :: temp257b
  REAL*8 :: temp301b
  DOUBLE PRECISION :: temp318
  REAL*8 :: temp321b24
  REAL*8 :: temp338b
  DOUBLE PRECISION :: temp346b3
  REAL*8 :: temp379b12
  REAL*8 :: temp379b49
  REAL*8 :: temp380b5
  REAL*8 :: temp380b10
  REAL*8 :: temp380b47
  REAL*8 :: temp387b31
  REAL*8 :: temp474b16
  REAL*8 :: temp483b1
  REAL*8 :: temp54b4
  REAL*8 :: temp96
  REAL*8 :: temp93b1
  REAL*8 :: temp128b4
  REAL*8 :: temp130b1
  REAL*8 :: temp155
  DOUBLE PRECISION :: temp236
  REAL*8 :: temp265b
  REAL*8 :: temp297b7
  DOUBLE PRECISION :: temp317
  REAL*8 :: temp321b23
  REAL*8 :: temp346b
  REAL*8 :: temp346b2
  REAL*8 :: temp379b11
  REAL*8 :: temp379b48
  REAL*8 :: temp380b4
  REAL*8 :: temp380b46
  REAL*8 :: temp387b30
  REAL*8 :: temp388b39
  REAL*8 :: temp474b15
  REAL*8 :: temp483b0
  REAL*8 :: temp486b12
  REAL*8 :: temp508b
  REAL*8 :: temp28b
  REAL*8 :: temp54b3
  REAL*8 :: temp68b19
  REAL*8 :: temp95
  REAL*8 :: temp93b0
  REAL*8 :: temp128b3
  REAL*8 :: temp130b0
  REAL*8 :: temp154
  REAL*8 :: temp235
  REAL*8 :: temp273b
  REAL*8 :: temp297b6
  DOUBLE PRECISION :: temp316
  REAL*8 :: temp321b22
  REAL*8 :: temp329b0
  REAL*8 :: temp346b1
  REAL*8 :: temp354b
  REAL*8 :: temp379b10
  REAL*8 :: temp379b47
  REAL*8 :: temp380b3
  REAL*8 :: temp380b45
  REAL*8 :: temp388b38
  REAL*8 :: temp474b14
  REAL*8 :: temp486b11
  REAL*8 :: temp516b
  REAL*8 :: temp36b
  REAL*8 :: temp54b2
  REAL*8 :: temp68b18
  DOUBLE PRECISION :: temp94
  REAL*8 :: temp128b2
  REAL*8 :: temp153
  DOUBLE PRECISION :: temp234
  REAL*8 :: temp281b
  REAL*8 :: temp282b1
  REAL*8 :: temp297b5
  REAL*8 :: temp315
  REAL*8 :: temp321b21
  REAL*8 :: temp346b0
  REAL*8 :: temp362b
  REAL*8 :: temp379b46
  REAL*8 :: temp380b2
  REAL*8 :: temp380b44
  REAL*8 :: temp388b37
  REAL*8 :: temp443b
  REAL*8 :: temp474b13
  REAL*8 :: temp486b10
  REAL*8 :: temp508b0
  REAL*8 :: temp44b
  REAL*8 :: temp54b1
  REAL*8 :: temp68b17
  REAL*8 :: temp71b2
  DOUBLE PRECISION :: temp93
  REAL*8 :: temp118b
  REAL*8 :: temp128b1
  REAL*8 :: temp145b2
  DOUBLE PRECISION :: temp152
  DOUBLE PRECISION :: temp189
  DOUBLE PRECISION :: temp233
  REAL*8 :: temp282b0
  REAL*8 :: temp297b4
  REAL*8 :: temp314
  REAL*8 :: temp321b20
  REAL*8 :: temp322b29
  REAL*8 :: temp370b
  REAL*8 :: temp373b9
  REAL*8 :: temp379b45
  REAL*8 :: temp380b1
  REAL*8 :: temp380b43
  REAL*8 :: temp388b36
  REAL*8 :: temp451b
  REAL*8 :: temp474b12
  REAL*8 :: temp488b
  DOUBLE PRECISION :: temp493b6
  REAL*8 :: temp1b
  REAL*8 :: temp54b0
  REAL*8 :: temp68b16
  REAL*8 :: temp71b1
  REAL*8 :: temp92
  REAL*8 :: temp128b0
  REAL*8 :: temp145b1
  DOUBLE PRECISION :: temp151
  REAL*8 :: temp188
  REAL*8 :: temp232
  REAL*8 :: temp269
  REAL*8 :: temp297b3
  REAL*8 :: temp313
  REAL*8 :: temp322b28
  REAL*8 :: temp373b8
  REAL*8 :: temp379b44
  REAL*8 :: temp380b0
  REAL*8 :: temp380b42
  REAL*8 :: temp388b35
  REAL*8 :: temp395b4
  REAL*8 :: temp474b11
  REAL*8 :: temp493b5
  REAL*8 :: temp496b
  INTRINSIC DSQRT
  REAL*8 :: temp
  REAL*8 :: temp68b15
  REAL*8 :: temp71b0
  REAL*8 :: temp91
  REAL*8 :: temp138b8
  DOUBLE PRECISION :: temp145b0
  REAL*8 :: temp150
  REAL*8 :: temp187
  REAL*8 :: temp231
  DOUBLE PRECISION :: temp268
  REAL*8 :: temp297b2
  REAL*8 :: temp312
  REAL*8 :: temp322b27
  REAL*8 :: temp349
  REAL*8 :: temp373b7
  REAL*8 :: temp379b43
  REAL*8 :: temp380b41
  REAL*8 :: temp387b62
  REAL*8 :: temp388b34
  REAL*8 :: temp395b3
  REAL*8 :: temp405b1
  REAL*8 :: temp474b10
  REAL*8 :: temp476b3
  REAL*8 :: temp493b4
  REAL*8 :: temp68b14
  DOUBLE PRECISION :: temp90
  REAL*8 :: temp138b7
  REAL*8 :: temp186
  REAL*8 :: temp223b
  REAL*8 :: temp230
  REAL*8 :: temp267
  REAL*8 :: temp297b1
  REAL*8 :: temp311
  REAL*8 :: temp322b26
  REAL*8 :: temp348
  REAL*8 :: temp373b6
  REAL*8 :: temp379b42
  REAL*8 :: temp380b40
  REAL*8 :: temp387b61
  REAL*8 :: temp388b33
  REAL*8 :: temp395b2
  REAL*8 :: temp405b0
  REAL*8 :: temp422b1
  REAL*8 :: temp429
  REAL*8 :: temp476b2
  REAL*8 :: temp493b3
  REAL*8 :: temp68b13
  REAL*8 :: temp138b6
  REAL*8 :: temp150b
  DOUBLE PRECISION :: temp185
  REAL*8 :: temp187b
  REAL*8 :: temp266
  REAL*8 :: temp260b0
  REAL*8 :: temp297b0
  REAL*8 :: temp302b3
  REAL*8 :: temp310
  REAL*8 :: temp312b
  REAL*8 :: temp322b25
  REAL*8 :: temp341b0
  REAL*8 :: temp347
  REAL*8 :: temp349b
  REAL*8 :: temp373b5
  REAL*8 :: temp373b29
  REAL*8 :: temp378b0
  REAL*8 :: temp379b41
  REAL*8 :: temp380b76
  REAL*8 :: temp387b60
  REAL*8 :: temp388b9
  REAL*8 :: temp388b32
  REAL*8 :: temp388b69
  REAL*8 :: temp390b6
  REAL*8 :: temp395b1
  REAL*8 :: temp422b0
  REAL*8 :: temp428
  REAL*8 :: temp476b1
  REAL*8 :: temp493b2
  INTEGER :: temp509
  REAL*8 :: temp9
  REAL*8 :: temp42b9
  REAL*8 :: temp68b12
  REAL*8 :: temp68b49
  REAL*8 :: temp69b0
  REAL*8 :: temp138b5
  DOUBLE PRECISION :: temp184
  REAL*8 :: temp265
  REAL*8 :: temp302b2
  REAL*8 :: temp320b
  REAL*8 :: temp322b24
  DOUBLE PRECISION :: temp346
  REAL*8 :: temp373b4
  REAL*8 :: temp373b28
  REAL*8 :: temp379b40
  REAL*8 :: temp380b75
  REAL*8 :: temp388b8
  REAL*8 :: temp388b31
  REAL*8 :: temp388b68
  REAL*8 :: temp390b5
  REAL*8 :: temp395b0
  REAL*8 :: temp401b
  REAL*8 :: temp427
  REAL*8 :: temp438b
  REAL*8 :: temp476b0
  REAL*8 :: temp486b9
  REAL*8 :: temp493b1
  REAL*8 :: temp508
  REAL*8 :: temp520b0
  REAL*8 :: temp519b
  REAL*8 :: temp8
  REAL*8 :: temp39b
  REAL*8 :: temp42b8
  REAL*8 :: temp68b11
  REAL*8 :: temp68b48
  REAL*8 :: temp138b4
  REAL*8 :: temp140b1
  REAL*8 :: temp183
  DOUBLE PRECISION :: temp264
  REAL*8 :: temp302b1
  REAL*8 :: temp322b23
  REAL*8 :: temp345
  REAL*8 :: temp365b
  REAL*8 :: temp373b3
  REAL*8 :: temp373b27
  REAL*8 :: temp380b74
  REAL*8 :: temp388b7
  REAL*8 :: temp388b30
  REAL*8 :: temp388b67
  REAL*8 :: temp390b4
  REAL*8 :: temp426
  REAL*8 :: temp446b
  REAL*8 :: temp486b8
  REAL*8 :: temp493b0
  REAL*8 :: temp507
  REAL*8 :: temp1b0
  REAL*8 :: temp7
  REAL*8 :: temp10b
  REAL*8 :: temp42b7
  REAL*8 :: temp68b10
  REAL*8 :: temp68b47
  REAL*8 :: temp138b3
  REAL*8 :: temp140b0
  REAL*8 :: temp182
  DOUBLE PRECISION :: temp263
  REAL*8 :: temp302b0
  REAL*8 :: temp322b22
  REAL*8 :: temp344
  REAL*8 :: temp373b
  REAL*8 :: temp373b2
  REAL*8 :: temp373b26
  REAL*8 :: temp379b75
  REAL*8 :: temp380b73
  REAL*8 :: temp388b6
  REAL*8 :: temp388b66
  REAL*8 :: temp390b3
  REAL*8 :: temp425
  REAL*8 :: temp454b
  REAL*8 :: temp486b7
  REAL*8 :: temp496b39
  REAL*8 :: temp506
  REAL*8 :: temp4b
  DOUBLE PRECISION :: temp6
  REAL*8 :: temp42b6
  REAL*8 :: temp55b
  REAL*8 :: temp68b46
  REAL*8 :: temp129b
  REAL*8 :: temp138b2
  DOUBLE PRECISION :: temp181
  DOUBLE PRECISION :: temp262
  REAL*8 :: temp299
  REAL*8 :: temp322b21
  REAL*8 :: temp343
  REAL*8 :: temp373b1
  REAL*8 :: temp373b25
  REAL*8 :: temp379b74
  REAL*8 :: temp380b72
  REAL*8 :: temp388b5
  REAL*8 :: temp388b65
  REAL*8 :: temp390b2
  REAL*8 :: temp424
  REAL*8 :: temp437b0
  REAL*8 :: temp462b
  REAL*8 :: temp486b6
  REAL*8 :: temp496b38
  REAL*8 :: temp499b
  INTEGER :: temp505
  DOUBLE PRECISION :: temp5
  REAL*8 :: temp42b5
  REAL*8 :: temp57b9
  REAL*8 :: temp63b
  REAL*8 :: temp68b45
  REAL*8 :: temp100b
  REAL*8 :: temp138b1
  DOUBLE PRECISION :: temp180
  REAL*8 :: temp218b
  REAL*8 :: temp219b1
  REAL*8 :: temp261
  REAL*8 :: temp298
  REAL*8 :: temp322b20
  REAL*8 :: temp342
  REAL*8 :: temp373b0
  REAL*8 :: temp373b24
  REAL*8 :: temp379b73
  REAL*8 :: temp379
  REAL*8 :: temp380b71
  REAL*8 :: temp388b4
  REAL*8 :: temp388b64
  REAL*8 :: temp390b1
  REAL*8 :: temp404b29
  REAL*8 :: temp423
  REAL*8 :: temp454b0
  REAL*8 :: temp470b
  REAL*8 :: temp486b5
  REAL*8 :: temp496b37
  REAL*8 :: temp504
  REAL*8 :: temp4
  REAL*8 :: temp42b4
  REAL*8 :: temp57b8
  REAL*8 :: temp57b19
  REAL*8 :: temp68b44
  REAL*8 :: temp71b
  REAL*8 :: temp138b0
  REAL*8 :: temp145b
  REAL*8 :: temp219b0
  DOUBLE PRECISION :: temp260
  REAL*8 :: temp297
  REAL*8 :: temp341
  REAL*8 :: temp373b23
  REAL*8 :: temp378
  REAL*8 :: temp379b72
  REAL*8 :: temp380b70
  REAL*8 :: temp386b29
  REAL*8 :: temp388b3
  REAL*8 :: temp388b63
  REAL*8 :: temp390b0
  REAL*8 :: temp404b28
  REAL*8 :: temp422
  REAL*8 :: temp459
  REAL*8 :: temp471b0
  REAL*8 :: temp486b4
  REAL*8 :: temp496b36
  REAL*8 :: temp503
  REAL*8 :: temp513b3
!                                                                       
!        indorb are the number of orbitals occupied before calling      
!        this subroutine                                                
!                                                                       
!        indpar is the number of variational parameters used            
!        before calling this subroutine                                 
!                                                                       
!        indshell is the index of the last  occupied orbital            
!        in the shell, characterized by occupation number iocc(indshell)
!                                                                       
!        z(i,indt+4)   contains the laplacian of the orbital i          
!        z(i,indt+mu) contains the gradient of the orbital i (mu=1,2,3) 
!        In the following given a radial part of the orbital f(r)       
!        fun=1/r  d f(r)/d r                                            
!        fun2= d^2 f(r)/dr^2                                            




  adi4ibuf=1
  adr8ibuf=1

  SELECT CASE  (iopt) 
  CASE (80) 
!  Cyrus basis 
! R(r)=exp(-z*r**2) single zeta                                         
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = DSQRT(dd1)
!           if(iflagnorm.gt.2) then 
!           c=(2.d0*dd1/pi)**(3.d0/4.d0)*ratiocs
!           ratiocs--> ratiocs*(2/pi)**3/4
    c = dd1**0.75d0*ratiocs
!           endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    IF (typec .NE. 1) THEN
!              the first derivative /r                                  
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = -(dd1*distp(0, 1)*(2.d0+rp2)/rp3)
!              the second derivative                                    
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp2 = rp3**2
      temp1b = (4.d0*rp1-2.d0*rp2+4.d0*(rp1*rp2)+rp1**2-2.d0)*fun2b/&
&        temp2
      temp1 = dd1*distp(0, 1)/temp2
      temp1b0 = temp1*fun2b
      rp1b = (2*rp1+4.d0*rp2+4.d0)*temp1b0
      temp0b0 = -(distp(0, 1)*(rp2+2.d0)*funb/rp3)
      dd1b = temp0b0 + r(0)**2*rp1b + distp(0, 1)*temp1b
      temp0 = dd1/rp3
      distpb(0, 1) = dd1*temp1b - temp0*(rp2+2.d0)*funb
      rp3b = -(temp0*temp0b0) - temp1*2*rp3*temp1b
      rp2b = 2*(rp2+1.d0)*rp3b - temp0*distp(0, 1)*funb + (4.d0*rp1-2.d0&
&        )*temp1b0
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp = dd2*r(k) + 1.d0
      temp0b = costb/temp
      tempb = -(dd1*r(k)**2*temp0b/temp)
      dd1b = dd1b + r(k)**2*temp0b
      rb(k) = rb(k) + dd2*tempb + dd1*2*r(k)*temp0b
      dd2b = dd2b + r(k)*tempb
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocs*0.75d0*dd1**(-0.25D0)*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocs*0.75d0*dd1**(&
&        -0.25D0)*cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (81) 
! derivative of bump gaussian
! R(r)=c*exp(-z*r**2)*(3/4/z-r**2)                                      
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = DSQRT(dd1)
!         c=(2.d0*dd1/pi)**(3.d0/4.d0)*ratiocs
    c = dd1**0.75d0*ratiocs
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=i0,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = (1.d0+0.5d0*dd2*r(i))/(1.d0+dd2*r(i))**2
    END DO
    IF (typec .NE. 1) THEN
!              the first derivative /r                                  
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = 0.25d0*distp(0, 1)*(-14.d0-29.d0*rp2-12.d0*rp1+3.d0*rp1*rp2+&
&        2.d0*rp1**2)/rp3**2
!              the second derivative                                    
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp11 = rp3**3
      temp9 = distp(0, 1)/temp11
      temp10 = rp1**3
      temp10b = 0.25d0*temp9*fun2b
      temp9b = 0.25d0*(34.d0*rp1-30.d0*rp2+118.d0*(rp1*rp2)+87.d0*rp1**2&
&        +18.d0*(rp1**2*rp2)-5.d0*rp1**3-2.d0*(temp10*rp2)-14.d0)*fun2b/&
&        temp11
      temp8 = rp3**2
      temp7 = distp(0, 1)/temp8
      temp8b = 0.25d0*temp7*funb
      rp1b = (2.d0*2*rp1+3.d0*rp2-12.d0)*temp8b + (18.d0*rp2*2*rp1-5.d0*&
&        3*rp1**2-2.d0*rp2*3*rp1**2+87.d0*2*rp1+118.d0*rp2+34.d0)*temp10b
      temp7b = 0.25d0*(3.d0*(rp1*rp2)-12.d0*rp1-29.d0*rp2+2.d0*rp1**2-&
&        14.d0)*funb/temp8
      rp3b = -(temp7*2*rp3*temp7b) - temp9*3*rp3**2*temp9b
      rp2b = (3.d0*rp1-29.d0)*temp8b + 2*(rp2+1.d0)*rp3b + (18.d0*rp1**2&
&        -2.d0*temp10+118.d0*rp1-30.d0)*temp10b
      distpb(0, 1) = temp7b + temp9b
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
      dd1b = r(0)**2*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp6 = 4.d0*dd1
      temp5 = 3.d0/temp6
      temp5b = distp(i, 1)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + (temp5-r(i)**2*cost)*zb(indorbp, i)
      dd1b = dd1b - temp5*4.d0*temp5b/temp6
      costb = -(r(i)**2*temp5b)
      temp4 = dd2*r(i) + 1.d0
      temp5b0 = costb/temp4**2
      temp4b0 = -((0.5d0*(dd2*r(i))+1.d0)*2*temp5b0/temp4)
      rb(i) = rb(i) + 0.5d0*dd2*temp5b0 + dd2*temp4b0 - cost*2*r(i)*&
&        temp5b
      zb(indorbp, i) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd2b = dd2b + r(i)*temp4b0 + 0.5d0*r(i)*temp5b0
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp3 = dd2*r(k) + 1.d0
      temp4b = costb/temp3
      temp3b = -(dd1*r(k)**2*temp4b/temp3)
      dd1b = dd1b + r(k)**2*temp4b
      rb(k) = rb(k) + dd2*temp3b + dd1*2*r(k)*temp4b
      dd2b = dd2b + r(k)*temp3b
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocs*0.75d0*dd1**(-0.25D0)*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocs*0.75d0*dd1**(&
&        -0.25D0)*cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (82) 
    dd1 = dd(indpar+1)
    dd2 = DSQRT(dd1)
!        if(iflagnorm.gt.2) then 
!        ratiocp--> ratiocp*dsqrt(2.d0)*pi**(-0.75d0)*2**1.25
!        c=dsqrt(2.d0)*pi**(-0.75d0)*(2.d0*dd1)**1.25d0*ratiocp
    c = dd1**1.25d0*ratiocp
!        endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
!        indorbp=indorb 
!                                                                       
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
!           fun=-2.d0*dd1*distp(0,1) 
!           fun2=fun*(1.d0-2.d0*dd1*r(0)**2) 
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = -(dd1*distp(0, 1)*(2.d0+rp2)/rp3)
!              the second derivative                                    
      fun2 = dd1*distp(0, 1)*(-2.d0-2.d0*rp2+4.d0*rp1+4.d0*rp1*rp2+rp1**&
&        2)/rp3**2
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp16b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp16b0
        fun2b = fun2b + temp16b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp16b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp16b
          funb = funb + rmu(ic, 0)*temp16b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp15 = rp3**2
      temp14b = (4.d0*rp1-2.d0*rp2+4.d0*(rp1*rp2)+rp1**2-2.d0)*fun2b/&
&        temp15
      temp14 = dd1*distp(0, 1)/temp15
      temp14b0 = temp14*fun2b
      rp1b = (2*rp1+4.d0*rp2+4.d0)*temp14b0
      temp13b0 = -(distp(0, 1)*(rp2+2.d0)*funb/rp3)
      dd1b = temp13b0 + r(0)**2*rp1b + distp(0, 1)*temp14b
      temp13 = dd1/rp3
      distpb(0, 1) = fun0b - temp13*(rp2+2.d0)*funb + dd1*temp14b
      rp3b = -(temp13*temp13b0) - temp14*2*rp3*temp14b
      rp2b = 2*(rp2+1.d0)*rp3b - temp13*distp(0, 1)*funb + (4.d0*rp1-&
&        2.d0)*temp14b0
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp12 = dd2*r(k) + 1.d0
      temp13b = costb/temp12
      temp12b = -(dd1*r(k)**2*temp13b/temp12)
      dd1b = dd1b + r(k)**2*temp13b
      rb(k) = rb(k) + dd2*temp12b + dd1*2*r(k)*temp13b
      dd2b = dd2b + r(k)*temp12b
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocp*1.25d0*dd1**0.25D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocp*1.25d0*dd1**0.25D0*&
&        cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (83) 
! derivative of 36 
! R(r)=x*exp(-z*r**2)*(5/4/z-r**2)                                      
    dd1 = dd(indpar+1)
    dd2 = DSQRT(dd1)
!        if(iflagnorm.gt.2) then 
!        c=dsqrt(2.d0)*pi**(-0.75d0)*(2.d0*dd1)**1.25d0*ratiocp
    c = dd1**1.25d0*ratiocp
!        endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
!        indorbp=indorb 
!                                                                       
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
      DO i=i0,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
        cost = (1.d0+0.5d0*dd2*r(i))/(1.d0+dd2*r(i))**2
      END DO
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = (1.d0+0.5d0*rp2)/rp3
      fun = 0.25d0*distp(0, 1)*(-18.d0-39.d0*rp2-20.d0*rp1+rp1*rp2+2.d0*&
&        rp1**2)/rp3**2
      fun2 = 0.25d0*distp(0, 1)*(-18.d0-42.d0*rp2+30.d0*rp1+138.d0*rp1*&
&        rp2+113.d0*rp1**2+30.d0*rp1**2*rp2-3.d0*rp1**3-2.d0*rp1**3*rp2)/&
&        rp3**3
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp23b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp23b0
        fun2b = fun2b + temp23b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp23b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp23b
          funb = funb + rmu(ic, 0)*temp23b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp22 = rp3**3
      temp20 = distp(0, 1)/temp22
      temp21 = rp1**3
      temp21b = 0.25d0*temp20*fun2b
      temp20b = 0.25d0*(30.d0*rp1-42.d0*rp2+138.d0*(rp1*rp2)+113.d0*rp1&
&        **2+30.d0*(rp1**2*rp2)-3.d0*rp1**3-2.d0*(temp21*rp2)-18.d0)*&
&        fun2b/temp22
      temp19 = rp3**2
      temp18 = distp(0, 1)/temp19
      temp19b = 0.25d0*temp18*funb
      rp1b = (2.d0*2*rp1+rp2-20.d0)*temp19b + (30.d0*rp2*2*rp1-3.d0*3*&
&        rp1**2-2.d0*rp2*3*rp1**2+113.d0*2*rp1+138.d0*rp2+30.d0)*temp21b
      temp18b2 = 0.25d0*(rp1*rp2-20.d0*rp1-39.d0*rp2+2.d0*rp1**2-18.d0)*&
&        funb/temp19
      temp18b3 = distp(0, 1)*fun0b
      costb = -(r(0)**2*temp18b3)
      rp3b = -(temp18*2*rp3*temp18b2) - (0.5d0*rp2+1.d0)*costb/rp3**2 - &
&        temp20*3*rp3**2*temp20b
      rp2b = (rp1-39.d0)*temp19b + 2*(rp2+1.d0)*rp3b + 0.5d0*costb/rp3 +&
&        (30.d0*rp1**2-2.d0*temp21+138.d0*rp1-42.d0)*temp21b
      distpb(0, 1) = temp18b2 + (1.25d0/dd1-r(0)**2*cost)*fun0b + &
&        temp20b
      dd1b = r(0)**2*rp1b - 1.25d0*temp18b3/dd1**2
      rb(0) = rb(0) + dd2*rp2b + dd1*2*r(0)*rp1b - cost*2*r(0)*temp18b3
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd2b = r(0)*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp18b = (1.25d0/dd1-r(i)**2*cost)*zb(indorbp, i)
        temp18b0 = rmu(ic, i)*distp(i, 1)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp18b
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp18b
        dd1b = dd1b - 1.25d0*temp18b0/dd1**2
        costb = -(r(i)**2*temp18b0)
        temp17 = dd2*r(i) + 1.d0
        temp18b1 = costb/temp17**2
        temp17b0 = -((0.5d0*(dd2*r(i))+1.d0)*2*temp18b1/temp17)
        rb(i) = rb(i) + 0.5d0*dd2*temp18b1 + dd2*temp17b0 - cost*2*r(i)*&
&          temp18b0
        zb(indorbp, i) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,cost)
        dd2b = dd2b + r(i)*temp17b0 + 0.5d0*r(i)*temp18b1
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp16 = dd2*r(k) + 1.d0
      temp17b = costb/temp16
      temp16b1 = -(dd1*r(k)**2*temp17b/temp16)
      dd1b = dd1b + r(k)**2*temp17b
      rb(k) = rb(k) + dd2*temp16b1 + dd1*2*r(k)*temp17b
      dd2b = dd2b + r(k)*temp16b1
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocp*1.25d0*dd1**0.25D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocp*1.25d0*dd1**0.25D0*&
&        cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (84) 
! d orbitals                                                            
! R(r)= exp(-alpha r^2)                                                 
! each gaussian term is normalized                                      
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
!        c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)*ratiocd
    c = ratiocd*dd1**1.75d0
!        endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
! lz=0       
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2     
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2            
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1            
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1            
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 1)
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = -(dd1*distp(0, 1)*(2.d0+rp2)/rp3)
!              the second derivative                                    
      fun2 = dd1*distp(0, 1)*(-2.d0-2.d0*rp2+4.d0*rp1+4.d0*rp1*rp2+rp1**&
&        2)/rp3**2
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp27b4 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 6.d0*temp27b4
        fun2b = fun2b + temp27b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp27b0 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp27b0
                  fun0b = fun0b + rmu(i, 0)*temp27b0
                ELSE
                  temp27b1 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp27b1
                  fun0b = fun0b + rmu(i, 0)*temp27b1
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp27b2 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp27b2
                fun0b = fun0b + rmu(i, 0)*temp27b2
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp27b3 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp27b3
                fun0b = fun0b + rmu(i, 0)*temp27b3
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp27b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp27b
          funb = funb + rmu(i, 0)*temp27b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp26 = rp3**2
      temp25b = (4.d0*rp1-2.d0*rp2+4.d0*(rp1*rp2)+rp1**2-2.d0)*fun2b/&
&        temp26
      temp25 = dd1*distp(0, 1)/temp26
      temp25b0 = temp25*fun2b
      rp1b = (2*rp1+4.d0*rp2+4.d0)*temp25b0
      temp24b0 = -(distp(0, 1)*(rp2+2.d0)*funb/rp3)
      dd1b = temp24b0 + r(0)**2*rp1b + distp(0, 1)*temp25b
      temp24 = dd1/rp3
      distpb(0, 1) = distpb(0, 1) + fun0b - temp24*(rp2+2.d0)*funb + dd1&
&        *temp25b
      rp3b = -(temp24*temp24b0) - temp25*2*rp3*temp25b
      rp2b = 2*(rp2+1.d0)*rp3b - temp24*distp(0, 1)*funb + (4.d0*rp1-&
&        2.d0)*temp25b0
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp23 = dd2*r(k) + 1.d0
      temp24b = costb/temp23
      temp23b1 = -(dd1*r(k)**2*temp24b/temp23)
      dd1b = dd1b + r(k)**2*temp24b
      rb(k) = rb(k) + dd2*temp23b1 + dd1*2*r(k)*temp24b
      dd2b = dd2b + r(k)*temp23b1
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocd*1.75d0*dd1**0.75D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocd*1.75d0*dd1**0.75D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (85) 
! derivative of 37 with respect to z                    
! d orbitals                                                            
! R(r)= c*exp(-z r^2)*(7/4/z-r^2)                                       
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
!        c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)*ratiocd
    c = dd1**1.75d0*ratiocd
!        endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
! lz=0       
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2     
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2            
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1            
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1            
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
      DO k=i0,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
        cost = (1.d0+0.5d0*dd2*r(k))/(1.d0+dd2*r(k))**2
      END DO
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = (1.d0+0.5d0*rp2)/rp3
      fun0 = distp(0, 1)*(7.d0/4.d0/dd1-r(0)**2*cost)
      fun = 0.25d0*distp(0, 1)*(-22.d0-49.d0*rp2-28.d0*rp1-rp1*rp2+2.d0*&
&        rp1**2)/rp3**2
      fun2 = -(0.25d0*distp(0, 1)*(22.d0+54.d0*rp2-26.d0*rp1-158.d0*rp1*&
&        rp2-139.d0*rp1**2-42.d0*rp1**2*rp2+rp1**3+2.d0*rp1**3*rp2)/rp3**&
&        3)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp38b4 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 6.d0*temp38b4
        fun2b = fun2b + temp38b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp38b0 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp38b0
                  fun0b = fun0b + rmu(i, 0)*temp38b0
                ELSE
                  temp38b1 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp38b1
                  fun0b = fun0b + rmu(i, 0)*temp38b1
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp38b2 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp38b2
                fun0b = fun0b + rmu(i, 0)*temp38b2
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp38b3 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp38b3
                fun0b = fun0b + rmu(i, 0)*temp38b3
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp38b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp38b
          funb = funb + rmu(i, 0)*temp38b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp37 = rp3**3
      temp35 = distp(0, 1)/temp37
      temp36 = rp1**3
      temp36b = -(0.25d0*temp35*fun2b)
      temp35b = -(0.25d0*(54.d0*rp2-26.d0*rp1-158.d0*(rp1*rp2)-139.d0*&
&        rp1**2+rp1**3-42.d0*(rp1**2*rp2)+2.d0*(temp36*rp2)+22.d0)*fun2b/&
&        temp37)
      temp34 = rp3**2
      temp33 = distp(0, 1)/temp34
      temp33b = 0.25d0*(2.d0*rp1**2-28.d0*rp1-49.d0*rp2-rp1*rp2-22.d0)*&
&        funb/temp34
      temp31b0 = distp(0, 1)*fun0b
      costb = -(r(0)**2*temp31b0)
      rp3b = -(temp33*2*rp3*temp33b) - (0.5d0*rp2+1.d0)*costb/rp3**2 - &
&        temp35*3*rp3**2*temp35b
      temp34b = 0.25d0*temp33*funb
      rp2b = ((-49.d0)-rp1)*temp34b + 2*(rp2+1.d0)*rp3b + 0.5d0*costb/&
&        rp3 + (2.d0*temp36-42.d0*rp1**2-158.d0*rp1+54.d0)*temp36b
      rp1b = (2.d0*2*rp1-rp2-28.d0)*temp34b + (2.d0*rp2*3*rp1**2-42.d0*&
&        rp2*2*rp1+3*rp1**2-139.d0*2*rp1-158.d0*rp2-26.d0)*temp36b
      temp32 = 4.d0*dd1
      temp31 = 7.d0/temp32
      distpb(0, 1) = distpb(0, 1) + temp33b + (temp31-r(0)**2*cost)*&
&        fun0b + temp35b
      dd1b = r(0)**2*rp1b - temp31*4.d0*temp31b0/temp32
      rb(0) = rb(0) + dd2*rp2b + dd1*2*r(0)*rp1b - cost*2*r(0)*temp31b0
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd2b = r(0)*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        temp31b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp30 = 4.d0*dd1
        temp29 = 7.d0/temp30
        temp29b = (temp29-r(k)**2*cost)*zb(indorbp, k)
        dd1b = dd1b - temp29*4.d0*temp31b/temp30
        costb = -(r(k)**2*temp31b)
        temp28 = dd2*r(k) + 1.d0
        temp29b0 = costb/temp28**2
        temp28b0 = -((0.5d0*(dd2*r(k))+1.d0)*2*temp29b0/temp28)
        rb(k) = rb(k) + 0.5d0*dd2*temp29b0 + dd2*temp28b0 - cost*2*r(k)*&
&          temp31b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp29b
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp29b
        zb(indorbp, k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,cost)
        dd2b = dd2b + r(k)*temp28b0 + 0.5d0*r(k)*temp29b0
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp27 = dd2*r(k) + 1.d0
      temp28b = costb/temp27
      temp27b5 = -(dd1*r(k)**2*temp28b/temp27)
      dd1b = dd1b + r(k)**2*temp28b
      rb(k) = rb(k) + dd2*temp27b5 + dd1*2*r(k)*temp28b
      dd2b = dd2b + r(k)*temp27b5
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocd*1.75d0*dd1**0.75D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocd*1.75d0*dd1**0.75D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (86) 
! f single gaussian orbital                                             
! R(r)= exp(-alpha r^2)                                                 
! normalized                                                            
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
!        c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)*ratiocf
    c = dd1**2.25d0*ratiocf
!        endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0        
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2           
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2                   
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3     
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3     
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 1)
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = -(dd1*distp(0, 1)*(2.d0+rp2)/rp3)
!              the second derivative                                    
      fun2 = dd1*distp(0, 1)*(-2.d0-2.d0*rp2+4.d0*rp1+4.d0*rp1*rp2+rp1**&
&        2)/rp3**2
!              indorbp=indorb 
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp42b23 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 8.d0*temp42b23
        fun2b = fun2b + temp42b23
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp42b2 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp42b2
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp42b2
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp42b2
                  END IF
                  temp42b0 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp42b1 = rmu(i, 0)*temp42b0
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp42b0
                  fun0b = fun0b + rmu(3, 0)*temp42b1
                  rmub(3, 0) = rmub(3, 0) + fun0*temp42b1
                  GOTO 100
                ELSE
                  temp42b5 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp42b5
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp42b5
                  rb(0) = rb(0) - fun0*2*r(0)*temp42b5
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp42b6 = cost2f*10.d0*zb(indorbp, indt+i)
                temp42b7 = rmu(i, 0)*temp42b6
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp42b6
                fun0b = fun0b + rmu(1, 0)*temp42b7
                rmub(1, 0) = rmub(1, 0) + fun0*temp42b7
              END IF
              temp42b3 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp42b4 = rmu(i, 0)*temp42b3
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp42b3
              fun0b = fun0b + rmu(1, 0)*temp42b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp42b4
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp42b10 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp42b10
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp42b10
                  rb(0) = rb(0) - fun0*2*r(0)*temp42b10
                END IF
              ELSE
                temp42b11 = cost2f*10.d0*zb(indorbp, indt+i)
                temp42b12 = rmu(i, 0)*temp42b11
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp42b11
                fun0b = fun0b + rmu(2, 0)*temp42b12
                rmub(2, 0) = rmub(2, 0) + fun0*temp42b12
              END IF
              temp42b8 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp42b9 = rmu(i, 0)*temp42b8
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp42b8
              fun0b = fun0b + rmu(2, 0)*temp42b9
              rmub(2, 0) = rmub(2, 0) + fun0*temp42b9
            ELSE IF (branch .LT. 10) THEN
              temp42b13 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp42b13
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp42b13
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp42b13
            ELSE
              temp42b14 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp42b14
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp42b14
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp42b14
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp42b15 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp42b15
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp42b15
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp42b15
                ELSE
                  temp42b16 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp42b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp42b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp42b16
                END IF
              ELSE
                temp42b17 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp42b17
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp42b17
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp42b17
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp42b18 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp42b18
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp42b18
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp42b18
            ELSE
              temp42b19 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp42b19
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp42b19
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp42b19
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp42b20 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp42b20
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp42b20
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp42b20
              END IF
            ELSE
              temp42b21 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp42b21
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp42b21
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp42b21
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp42b22 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp42b22
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp42b22
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp42b22
          END IF
 100      temp42b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp42b
          funb = funb + rmu(i, 0)*temp42b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp41 = rp3**2
      temp40b = (4.d0*rp1-2.d0*rp2+4.d0*(rp1*rp2)+rp1**2-2.d0)*fun2b/&
&        temp41
      temp40 = dd1*distp(0, 1)/temp41
      temp40b0 = temp40*fun2b
      rp1b = (2*rp1+4.d0*rp2+4.d0)*temp40b0
      temp39b8 = -(distp(0, 1)*(rp2+2.d0)*funb/rp3)
      dd1b = temp39b8 + r(0)**2*rp1b + distp(0, 1)*temp40b
      temp39 = dd1/rp3
      distpb(0, 1) = distpb(0, 1) + fun0b - temp39*(rp2+2.d0)*funb + dd1&
&        *temp40b
      rp3b = -(temp39*temp39b8) - temp40*2*rp3*temp40b
      rp2b = 2*(rp2+1.d0)*rp3b - temp39*distp(0, 1)*funb + (4.d0*rp1-&
&        2.d0)*temp40b0
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp39b0 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp39b0
      distpb(i, 8) = 0.0_8
      temp39b1 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp39b1 + 3.d0*2*rmu(1, i)*temp39b0
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp39b1
      distpb(i, 7) = 0.0_8
      temp39b2 = cost3f*2.d0*distpb(i, 6)
      temp39b3 = rmu(2, i)*temp39b2
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp39b3
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp39b3
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp39b2
      distpb(i, 6) = 0.0_8
      temp39b4 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp39b4
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp39b4
      temp39b5 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp39b5
      distpb(i, 4) = 0.0_8
      temp39b6 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp39b7 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp39b6 - 3.d0*2*r(i)*temp39b7 - 2*r(i)*&
&        temp39b5
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp39b7 + 5.d0*2*rmu(3, i)*&
&        temp39b6
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp38 = dd2*r(k) + 1.d0
      temp39b = costb/temp38
      temp38b5 = -(dd1*r(k)**2*temp39b/temp38)
      dd1b = dd1b + r(k)**2*temp39b
      rb(k) = rb(k) + dd2*temp38b5 + dd1*2*r(k)*temp39b
      dd2b = dd2b + r(k)*temp38b5
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocf*2.25d0*dd1**1.25D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocf*2.25d0*dd1**1.25D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (87) 
! derivative of 48 with respect to z                    
! f orbitals                                                            
! R(r)= c*exp(-z r^2)*(9/4/z-r^2)                                       
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
!        c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)*ratiocf
    c = dd1**2.25d0*ratiocf
!        endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0        
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2           
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2                   
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3     
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3     
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
      DO k=i0,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
        cost = (1.d0+0.5d0*dd2*r(k))/(1.d0+dd2*r(k))**2
      END DO
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = (1.d0+0.5d0*rp2)/rp3
      fun0 = distp(0, 1)*(9.d0/4.d0/dd1-r(0)**2*cost)
      fun = 0.25d0*distp(0, 1)*(-26.d0-59.d0*rp2-36.d0*rp1-3.d0*rp1*rp2+&
&        2.d0*rp1**2)/rp3**2
      fun2 = 0.25d0*distp(0, 1)*(-26.d0-66.d0*rp2+22.d0*rp1+178.d0*rp1*&
&        rp2+165.d0*rp1**2+54.d0*rp1**2*rp2+rp1**3-2.d0*rp1**3*rp2)/rp3**&
&        3
!              indorbp=indorb 
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp53b23 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 8.d0*temp53b23
        fun2b = fun2b + temp53b23
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp53b2 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp53b2
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp53b2
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp53b2
                  END IF
                  temp53b0 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp53b1 = rmu(i, 0)*temp53b0
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp53b0
                  fun0b = fun0b + rmu(3, 0)*temp53b1
                  rmub(3, 0) = rmub(3, 0) + fun0*temp53b1
                  GOTO 110
                ELSE
                  temp53b5 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp53b5
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp53b5
                  rb(0) = rb(0) - fun0*2*r(0)*temp53b5
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp53b6 = cost2f*10.d0*zb(indorbp, indt+i)
                temp53b7 = rmu(i, 0)*temp53b6
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp53b6
                fun0b = fun0b + rmu(1, 0)*temp53b7
                rmub(1, 0) = rmub(1, 0) + fun0*temp53b7
              END IF
              temp53b3 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp53b4 = rmu(i, 0)*temp53b3
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp53b3
              fun0b = fun0b + rmu(1, 0)*temp53b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp53b4
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp53b10 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp53b10
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp53b10
                  rb(0) = rb(0) - fun0*2*r(0)*temp53b10
                END IF
              ELSE
                temp53b11 = cost2f*10.d0*zb(indorbp, indt+i)
                temp53b12 = rmu(i, 0)*temp53b11
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp53b11
                fun0b = fun0b + rmu(2, 0)*temp53b12
                rmub(2, 0) = rmub(2, 0) + fun0*temp53b12
              END IF
              temp53b8 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp53b9 = rmu(i, 0)*temp53b8
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp53b8
              fun0b = fun0b + rmu(2, 0)*temp53b9
              rmub(2, 0) = rmub(2, 0) + fun0*temp53b9
            ELSE IF (branch .LT. 10) THEN
              temp53b13 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp53b13
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp53b13
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp53b13
            ELSE
              temp53b14 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp53b14
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp53b14
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp53b14
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp53b15 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp53b15
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp53b15
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp53b15
                ELSE
                  temp53b16 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp53b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp53b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp53b16
                END IF
              ELSE
                temp53b17 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp53b17
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp53b17
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp53b17
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp53b18 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp53b18
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp53b18
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp53b18
            ELSE
              temp53b19 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp53b19
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp53b19
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp53b19
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp53b20 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp53b20
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp53b20
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp53b20
              END IF
            ELSE
              temp53b21 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp53b21
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp53b21
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp53b21
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp53b22 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp53b22
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp53b22
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp53b22
          END IF
 110      temp53b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp53b
          funb = funb + rmu(i, 0)*temp53b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp52 = rp3**3
      temp50 = distp(0, 1)/temp52
      temp51 = rp1**3
      temp51b = 0.25d0*temp50*fun2b
      temp50b = 0.25d0*(22.d0*rp1-66.d0*rp2+178.d0*(rp1*rp2)+165.d0*rp1&
&        **2+54.d0*(rp1**2*rp2)+rp1**3-2.d0*(temp51*rp2)-26.d0)*fun2b/&
&        temp52
      temp49 = rp3**2
      temp48 = distp(0, 1)/temp49
      temp49b = 0.25d0*temp48*funb
      rp1b = (2.d0*2*rp1-3.d0*rp2-36.d0)*temp49b + (3*rp1**2-2.d0*rp2*3*&
&        rp1**2+54.d0*rp2*2*rp1+165.d0*2*rp1+178.d0*rp2+22.d0)*temp51b
      temp48b = 0.25d0*(2.d0*rp1**2-36.d0*rp1-59.d0*rp2-3.d0*(rp1*rp2)-&
&        26.d0)*funb/temp49
      temp46b0 = distp(0, 1)*fun0b
      costb = -(r(0)**2*temp46b0)
      rp3b = -(temp48*2*rp3*temp48b) - (0.5d0*rp2+1.d0)*costb/rp3**2 - &
&        temp50*3*rp3**2*temp50b
      rp2b = ((-59.d0)-3.d0*rp1)*temp49b + 2*(rp2+1.d0)*rp3b + 0.5d0*&
&        costb/rp3 + (54.d0*rp1**2-2.d0*temp51+178.d0*rp1-66.d0)*temp51b
      temp47 = 4.d0*dd1
      temp46 = 9.d0/temp47
      distpb(0, 1) = distpb(0, 1) + temp48b + (temp46-r(0)**2*cost)*&
&        fun0b + temp50b
      dd1b = r(0)**2*rp1b - temp46*4.d0*temp46b0/temp47
      rb(0) = rb(0) + dd2*rp2b + dd1*2*r(0)*rp1b - cost*2*r(0)*temp46b0
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd2b = r(0)*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        temp46b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp45 = 4.d0*dd1
        temp44 = 9.d0/temp45
        temp44b = (temp44-r(k)**2*cost)*zb(indorbp, k)
        dd1b = dd1b - temp44*4.d0*temp46b/temp45
        costb = -(r(k)**2*temp46b)
        temp43 = dd2*r(k) + 1.d0
        temp44b0 = costb/temp43**2
        temp43b8 = -((0.5d0*(dd2*r(k))+1.d0)*2*temp44b0/temp43)
        rb(k) = rb(k) + 0.5d0*dd2*temp44b0 + dd2*temp43b8 - cost*2*r(k)*&
&          temp46b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp44b
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp44b
        zb(indorbp, k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,cost)
        dd2b = dd2b + r(k)*temp43b8 + 0.5d0*r(k)*temp44b0
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp43b0 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp43b0
      distpb(i, 8) = 0.0_8
      temp43b1 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp43b1 + 3.d0*2*rmu(1, i)*temp43b0
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp43b1
      distpb(i, 7) = 0.0_8
      temp43b2 = cost3f*2.d0*distpb(i, 6)
      temp43b3 = rmu(2, i)*temp43b2
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp43b3
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp43b3
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp43b2
      distpb(i, 6) = 0.0_8
      temp43b4 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp43b4
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp43b4
      temp43b5 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp43b5
      distpb(i, 4) = 0.0_8
      temp43b6 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp43b7 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp43b6 - 3.d0*2*r(i)*temp43b7 - 2*r(i)*&
&        temp43b5
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp43b7 + 5.d0*2*rmu(3, i)*&
&        temp43b6
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp42 = dd2*r(k) + 1.d0
      temp43b = costb/temp42
      temp42b24 = -(dd1*r(k)**2*temp43b/temp42)
      dd1b = dd1b + r(k)**2*temp43b
      rb(k) = rb(k) + dd2*temp42b24 + dd1*2*r(k)*temp43b
      dd2b = dd2b + r(k)*temp42b24
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocf*2.25d0*dd1**1.25D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocf*2.25d0*dd1**1.25D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (88) 
! g single gaussian orbital                                             
! R(r)= exp(-alpha r^2)                                                 
! normalized                                                            
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!     if(iflagnorm.gt.2) then 
! overall normalization                                                 
!     c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)*ratiocg
    c = dd1**2.75d0*ratiocg
!     endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0        
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2           
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2                   
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 1)
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = -(dd1*distp(0, 1)*(2.d0+rp2)/rp3)
!              the second derivative                                    
      fun2 = dd1*distp(0, 1)*(-2.d0-2.d0*rp2+4.d0*rp1+4.d0*rp1*rp2+rp1**&
&        2)/rp3**2
!              indorbp=indorb 
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
          ELSE IF (ic .EQ. 7) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            END IF
          ELSE IF (ic .EQ. 8) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
          ELSE IF (ic .EQ. 9) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp57b55 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb = funb + 10.d0*temp57b55
        fun2b = fun2b + temp57b55
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 15) THEN
            IF (branch .LT. 8) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    temp57b0 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2)-&
&                      60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp57b0
                    rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp57b0
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0&
&                      )*temp57b0
                  ELSE
                    temp57b1 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-&
&                      60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp57b1
                    rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp57b1
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0&
&                      )*temp57b1
                  END IF
                ELSE IF (branch .LT. 4) THEN
                  temp57b2 = cost1g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(rmu(&
&                    3, 0)*r(0)**2))*zb(indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*&
&                    r(0)**2)*temp57b2
                  rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp57b2
                ELSE
                  temp57b3 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*&
&                    rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp57b3
                  rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp57b3
                  rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp57b3
                END IF
              ELSE IF (branch .LT. 7) THEN
                IF (branch .LT. 6) THEN
                  temp57b4 = -(cost2g*6.d0*zb(indorbp, indt+i))
                  temp57b5 = rmu(2, 0)*rmu(3, 0)*temp57b4
                  temp57b6 = fun0*rmu(1, 0)*temp57b4
                  fun0b = fun0b + rmu(1, 0)*temp57b5
                  rmub(1, 0) = rmub(1, 0) + fun0*temp57b5
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp57b6
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp57b6
                ELSE
                  temp57b7 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp57b8 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)**&
&                    2)*temp57b7
                  temp57b9 = fun0*rmu(1, 0)*temp57b7
                  fun0b = fun0b + rmu(1, 0)*temp57b8
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp57b9 + fun0*&
&                    temp57b8
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp57b9
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp57b9
                END IF
              ELSE
                temp57b10 = -(cost2g*6.d0*zb(indorbp, indt+i))
                temp57b11 = rmu(2, 0)*rmu(3, 0)*temp57b10
                temp57b12 = fun0*rmu(1, 0)*temp57b10
                fun0b = fun0b + rmu(1, 0)*temp57b11
                rmub(1, 0) = rmub(1, 0) + fun0*temp57b11
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp57b12
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp57b12
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  temp57b13 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*&
&                    rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp57b13
                  rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp57b13
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp57b13
                ELSE
                  temp57b14 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp57b15 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp57b14
                  temp57b16 = fun0*rmu(2, 0)*temp57b14
                  fun0b = fun0b + rmu(2, 0)*temp57b15
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp57b16 + fun0&
&                    *temp57b15
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp57b16
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp57b16
                END IF
              ELSE IF (branch .LT. 11) THEN
                temp57b17 = -(cost3g*4.d0*zb(indorbp, indt+i))
                temp57b18 = fun0*temp57b17
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*temp57b17
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp57b18
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp57b18
              ELSE
                temp57b19 = cost3g*4.d0*zb(indorbp, indt+i)
                temp57b20 = fun0*temp57b19
                fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)&
&                  **2))*temp57b19
                rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp57b20
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp57b20
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                temp57b21 = cost3g*12.d0*zb(indorbp, indt+i)
                temp57b22 = fun0*rmu(3, 0)*temp57b21
                temp57b23 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp57b21
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp57b22
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp57b22
                fun0b = fun0b + rmu(3, 0)*temp57b23
                rmub(3, 0) = rmub(3, 0) + fun0*temp57b23
              ELSE
                temp57b24 = -(cost3g*2.d0*zb(indorbp, indt+i))
                temp57b25 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3, &
&                  0)**2)*temp57b24
                temp57b26 = fun0*rmu(2, 0)*temp57b24
                fun0b = fun0b + rmu(2, 0)*temp57b25
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp57b26 + fun0*&
&                  temp57b25
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp57b26
                rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp57b26
              END IF
            ELSE
              temp57b27 = -(cost3g*2.d0*zb(indorbp, indt+i))
              temp57b28 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0)&
&                **2)*temp57b27
              temp57b29 = fun0*rmu(1, 0)*temp57b27
              fun0b = fun0b + rmu(1, 0)*temp57b28
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp57b29 + fun0*&
&                temp57b28
              rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp57b29
              rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp57b29
            END IF
          ELSE IF (branch .LT. 22) THEN
            IF (branch .LT. 19) THEN
              IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  temp57b30 = cost3g*24.d0*zb(indorbp, indt+i)
                  temp57b31 = rmu(2, 0)*rmu(3, 0)*temp57b30
                  temp57b32 = fun0*rmu(1, 0)*temp57b30
                  fun0b = fun0b + rmu(1, 0)*temp57b31
                  rmub(1, 0) = rmub(1, 0) + fun0*temp57b31
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp57b32
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp57b32
                ELSE
                  temp57b33 = cost4g*3.d0*zb(indorbp, indt+i)
                  temp57b34 = fun0*rmu(3, 0)*temp57b33
                  temp57b35 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp57b33
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp57b34
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp57b34
                  fun0b = fun0b + rmu(3, 0)*temp57b35
                  rmub(3, 0) = rmub(3, 0) + fun0*temp57b35
                END IF
              ELSE IF (branch .LT. 18) THEN
                temp57b36 = -(cost4g*6.d0*zb(indorbp, indt+i))
                temp57b37 = rmu(2, 0)*rmu(3, 0)*temp57b36
                temp57b38 = fun0*rmu(1, 0)*temp57b36
                fun0b = fun0b + rmu(1, 0)*temp57b37
                rmub(1, 0) = rmub(1, 0) + fun0*temp57b37
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp57b38
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp57b38
              ELSE
                temp57b39 = cost4g*fun0*zb(indorbp, indt+i)
                fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu&
&                  (2, 0)**2))*zb(indorbp, indt+i)
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp57b39
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp57b39
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                temp57b40 = cost4g*6.d0*zb(indorbp, indt+i)
                temp57b41 = rmu(2, 0)*rmu(3, 0)*temp57b40
                temp57b42 = fun0*rmu(1, 0)*temp57b40
                fun0b = fun0b + rmu(1, 0)*temp57b41
                rmub(1, 0) = rmub(1, 0) + fun0*temp57b41
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp57b42
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp57b42
              ELSE
                temp57b43 = cost4g*3.d0*zb(indorbp, indt+i)
                temp57b44 = fun0*rmu(3, 0)*temp57b43
                temp57b45 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp57b43
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp57b44
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp57b44
                fun0b = fun0b + rmu(3, 0)*temp57b45
                rmub(3, 0) = rmub(3, 0) + fun0*temp57b45
              END IF
            ELSE
              temp57b46 = cost4g*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(&
&                2, 0)**3)*zb(indorbp, indt+i)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp57b46
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp57b46
            END IF
          ELSE IF (branch .LT. 26) THEN
            IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                temp57b47 = cost5g*4.d0*zb(indorbp, indt+i)
                temp57b48 = fun0*temp57b47
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp57b47
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp57b48
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp57b48
              END IF
            ELSE IF (branch .LT. 25) THEN
              temp57b49 = cost5g*4.d0*zb(indorbp, indt+i)
              temp57b50 = fun0*temp57b49
              fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)&
&                ))*temp57b49
              rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**&
&                2)*temp57b50
              rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp57b50
            END IF
          ELSE IF (branch .LT. 28) THEN
            IF (branch .LT. 27) THEN
              temp57b51 = cost5g*4.d0*zb(indorbp, indt+i)
              temp57b52 = fun0*temp57b51
              fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**&
&                3)*temp57b51
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp57b52
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp57b52
            END IF
          ELSE
            temp57b53 = cost5g*4.d0*zb(indorbp, indt+i)
            temp57b54 = fun0*temp57b53
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp57b53
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp57b54
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp57b54
          END IF
          temp57b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp57b
          funb = funb + rmu(i, 0)*temp57b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp56 = rp3**2
      temp55b = (4.d0*rp1-2.d0*rp2+4.d0*(rp1*rp2)+rp1**2-2.d0)*fun2b/&
&        temp56
      temp55 = dd1*distp(0, 1)/temp56
      temp55b0 = temp55*fun2b
      rp1b = (2*rp1+4.d0*rp2+4.d0)*temp55b0
      temp54b18 = -(distp(0, 1)*(rp2+2.d0)*funb/rp3)
      dd1b = temp54b18 + r(0)**2*rp1b + distp(0, 1)*temp55b
      temp54 = dd1/rp3
      distpb(0, 1) = distpb(0, 1) + fun0b - temp54*(rp2+2.d0)*funb + dd1&
&        *temp55b
      rp3b = -(temp54*temp54b18) - temp55*2*rp3*temp55b
      rp2b = 2*(rp2+1.d0)*rp3b - temp54*distp(0, 1)*funb + (4.d0*rp1-&
&        2.d0)*temp55b0
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp54b0 = cost5g*4.d0*distpb(i, 10)
      temp54b1 = (rmu(1, i)**2-rmu(2, i)**2)*temp54b0
      temp54b2 = rmu(1, i)*rmu(2, i)*temp54b0
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp54b2 + rmu(2, i)*&
&        temp54b1
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp54b1 - 2*rmu(2, i)*&
&        temp54b2
      distpb(i, 10) = 0.0_8
      temp54b3 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp54b3
      distpb(i, 9) = 0.0_8
      temp54b4 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp54b5 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp54b4 - 2*rmu(2, i)*&
&        temp54b5 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp54b3
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp54b4
      distpb(i, 8) = 0.0_8
      temp54b6 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp54b7 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp54b6 + 2*rmu(1, i)*&
&        temp54b7 + 3.d0*2*rmu(1, i)*temp54b5
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp54b6
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp54b7
      distpb(i, 7) = 0.0_8
      temp54b8 = cost3g*2.d0*distpb(i, 6)
      temp54b9 = (7.d0*rmu(3, i)**2-r(i)**2)*temp54b8
      temp54b10 = rmu(1, i)*rmu(2, i)*temp54b8
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp54b9
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp54b9
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp54b10
      distpb(i, 6) = 0.0_8
      temp54b11 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp54b12 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp54b13 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp54b14 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp54b15 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp54b16 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp54b17 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp54b17 - 3.d0*2*r(i)*temp54b16 - 2*r(i)*temp54b12 - 3.d0*2*r(&
&        i)*temp54b14 - 2*r(i)*temp54b10
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp54b11
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp54b11
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp54b12
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp54b13
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp54b14 + rmu(2, i)*&
&        temp54b13
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp54b15
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp54b17 + 7.d0*2*rmu(3, i)*temp54b16 + rmu(1, i)*&
&        temp54b15
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp53 = dd2*r(k) + 1.d0
      temp54b = costb/temp53
      temp53b24 = -(dd1*r(k)**2*temp54b/temp53)
      dd1b = dd1b + r(k)**2*temp54b
      rb(k) = rb(k) + dd2*temp53b24 + dd1*2*r(k)*temp54b
      dd2b = dd2b + r(k)*temp53b24
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocg*2.75d0*dd1**1.75D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocg*2.75d0*dd1**1.75D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (89) 
! g single gaussian orbital                                             
! derivative of 51
! R(r)= exp(-alpha r^2)                                                 
! normalized                                                            
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!     if(iflagnorm.gt.2) then 
! overall normalization                                                 
!     c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)*ratiocg
    c = dd1**2.75d0*ratiocg
!     endif 
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0        
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2           
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2                   
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
      DO k=i0,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
        cost = (1.d0+0.5d0*dd2*r(k))/(1.d0+dd2*r(k))**2
      END DO
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = (1.d0+0.5d0*rp2)/rp3
      fun0 = distp(0, 1)*(11.d0/4.d0/dd1-r(0)**2*cost)
      fun = 0.25d0*distp(0, 1)*(-30.d0-69.d0*rp2-44.d0*rp1-5.d0*rp1*rp2+&
&        2.d0*rp1**2)/rp3**2
      fun2 = 0.25d0*distp(0, 1)*(-30.d0-78.d0*rp2+18.d0*rp1+198.d0*rp1*&
&        rp2+191.d0*rp1**2+66.d0*rp1**2*rp2+3.d0*rp1**3-2.d0*rp1**3*rp2)/&
&        rp3**3
!              indorbp=indorb 
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
          ELSE IF (ic .EQ. 7) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            END IF
          ELSE IF (ic .EQ. 8) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
          ELSE IF (ic .EQ. 9) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp68b55 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb = funb + 10.d0*temp68b55
        fun2b = fun2b + temp68b55
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 15) THEN
            IF (branch .LT. 8) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    temp68b0 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2)-&
&                      60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp68b0
                    rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp68b0
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0&
&                      )*temp68b0
                  ELSE
                    temp68b1 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-&
&                      60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp68b1
                    rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp68b1
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0&
&                      )*temp68b1
                  END IF
                ELSE IF (branch .LT. 4) THEN
                  temp68b2 = cost1g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(rmu(&
&                    3, 0)*r(0)**2))*zb(indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*&
&                    r(0)**2)*temp68b2
                  rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp68b2
                ELSE
                  temp68b3 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*&
&                    rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp68b3
                  rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp68b3
                  rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp68b3
                END IF
              ELSE IF (branch .LT. 7) THEN
                IF (branch .LT. 6) THEN
                  temp68b4 = -(cost2g*6.d0*zb(indorbp, indt+i))
                  temp68b5 = rmu(2, 0)*rmu(3, 0)*temp68b4
                  temp68b6 = fun0*rmu(1, 0)*temp68b4
                  fun0b = fun0b + rmu(1, 0)*temp68b5
                  rmub(1, 0) = rmub(1, 0) + fun0*temp68b5
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp68b6
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp68b6
                ELSE
                  temp68b7 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp68b8 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)**&
&                    2)*temp68b7
                  temp68b9 = fun0*rmu(1, 0)*temp68b7
                  fun0b = fun0b + rmu(1, 0)*temp68b8
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp68b9 + fun0*&
&                    temp68b8
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp68b9
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp68b9
                END IF
              ELSE
                temp68b10 = -(cost2g*6.d0*zb(indorbp, indt+i))
                temp68b11 = rmu(2, 0)*rmu(3, 0)*temp68b10
                temp68b12 = fun0*rmu(1, 0)*temp68b10
                fun0b = fun0b + rmu(1, 0)*temp68b11
                rmub(1, 0) = rmub(1, 0) + fun0*temp68b11
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp68b12
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp68b12
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  temp68b13 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*&
&                    rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp68b13
                  rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp68b13
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp68b13
                ELSE
                  temp68b14 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp68b15 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp68b14
                  temp68b16 = fun0*rmu(2, 0)*temp68b14
                  fun0b = fun0b + rmu(2, 0)*temp68b15
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp68b16 + fun0&
&                    *temp68b15
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp68b16
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp68b16
                END IF
              ELSE IF (branch .LT. 11) THEN
                temp68b17 = -(cost3g*4.d0*zb(indorbp, indt+i))
                temp68b18 = fun0*temp68b17
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*temp68b17
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp68b18
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp68b18
              ELSE
                temp68b19 = cost3g*4.d0*zb(indorbp, indt+i)
                temp68b20 = fun0*temp68b19
                fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)&
&                  **2))*temp68b19
                rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp68b20
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp68b20
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                temp68b21 = cost3g*12.d0*zb(indorbp, indt+i)
                temp68b22 = fun0*rmu(3, 0)*temp68b21
                temp68b23 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp68b21
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp68b22
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp68b22
                fun0b = fun0b + rmu(3, 0)*temp68b23
                rmub(3, 0) = rmub(3, 0) + fun0*temp68b23
              ELSE
                temp68b24 = -(cost3g*2.d0*zb(indorbp, indt+i))
                temp68b25 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3, &
&                  0)**2)*temp68b24
                temp68b26 = fun0*rmu(2, 0)*temp68b24
                fun0b = fun0b + rmu(2, 0)*temp68b25
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp68b26 + fun0*&
&                  temp68b25
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp68b26
                rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp68b26
              END IF
            ELSE
              temp68b27 = -(cost3g*2.d0*zb(indorbp, indt+i))
              temp68b28 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0)&
&                **2)*temp68b27
              temp68b29 = fun0*rmu(1, 0)*temp68b27
              fun0b = fun0b + rmu(1, 0)*temp68b28
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp68b29 + fun0*&
&                temp68b28
              rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp68b29
              rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp68b29
            END IF
          ELSE IF (branch .LT. 22) THEN
            IF (branch .LT. 19) THEN
              IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  temp68b30 = cost3g*24.d0*zb(indorbp, indt+i)
                  temp68b31 = rmu(2, 0)*rmu(3, 0)*temp68b30
                  temp68b32 = fun0*rmu(1, 0)*temp68b30
                  fun0b = fun0b + rmu(1, 0)*temp68b31
                  rmub(1, 0) = rmub(1, 0) + fun0*temp68b31
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp68b32
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp68b32
                ELSE
                  temp68b33 = cost4g*3.d0*zb(indorbp, indt+i)
                  temp68b34 = fun0*rmu(3, 0)*temp68b33
                  temp68b35 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp68b33
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp68b34
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp68b34
                  fun0b = fun0b + rmu(3, 0)*temp68b35
                  rmub(3, 0) = rmub(3, 0) + fun0*temp68b35
                END IF
              ELSE IF (branch .LT. 18) THEN
                temp68b36 = -(cost4g*6.d0*zb(indorbp, indt+i))
                temp68b37 = rmu(2, 0)*rmu(3, 0)*temp68b36
                temp68b38 = fun0*rmu(1, 0)*temp68b36
                fun0b = fun0b + rmu(1, 0)*temp68b37
                rmub(1, 0) = rmub(1, 0) + fun0*temp68b37
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp68b38
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp68b38
              ELSE
                temp68b39 = cost4g*fun0*zb(indorbp, indt+i)
                fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu&
&                  (2, 0)**2))*zb(indorbp, indt+i)
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp68b39
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp68b39
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                temp68b40 = cost4g*6.d0*zb(indorbp, indt+i)
                temp68b41 = rmu(2, 0)*rmu(3, 0)*temp68b40
                temp68b42 = fun0*rmu(1, 0)*temp68b40
                fun0b = fun0b + rmu(1, 0)*temp68b41
                rmub(1, 0) = rmub(1, 0) + fun0*temp68b41
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp68b42
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp68b42
              ELSE
                temp68b43 = cost4g*3.d0*zb(indorbp, indt+i)
                temp68b44 = fun0*rmu(3, 0)*temp68b43
                temp68b45 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp68b43
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp68b44
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp68b44
                fun0b = fun0b + rmu(3, 0)*temp68b45
                rmub(3, 0) = rmub(3, 0) + fun0*temp68b45
              END IF
            ELSE
              temp68b46 = cost4g*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(&
&                2, 0)**3)*zb(indorbp, indt+i)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp68b46
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp68b46
            END IF
          ELSE IF (branch .LT. 26) THEN
            IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                temp68b47 = cost5g*4.d0*zb(indorbp, indt+i)
                temp68b48 = fun0*temp68b47
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp68b47
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp68b48
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp68b48
              END IF
            ELSE IF (branch .LT. 25) THEN
              temp68b49 = cost5g*4.d0*zb(indorbp, indt+i)
              temp68b50 = fun0*temp68b49
              fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)&
&                ))*temp68b49
              rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**&
&                2)*temp68b50
              rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp68b50
            END IF
          ELSE IF (branch .LT. 28) THEN
            IF (branch .LT. 27) THEN
              temp68b51 = cost5g*4.d0*zb(indorbp, indt+i)
              temp68b52 = fun0*temp68b51
              fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**&
&                3)*temp68b51
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp68b52
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp68b52
            END IF
          ELSE
            temp68b53 = cost5g*4.d0*zb(indorbp, indt+i)
            temp68b54 = fun0*temp68b53
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp68b53
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp68b54
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp68b54
          END IF
          temp68b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp68b
          funb = funb + rmu(i, 0)*temp68b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp67 = rp3**3
      temp65 = distp(0, 1)/temp67
      temp66 = rp1**3
      temp66b = 0.25d0*temp65*fun2b
      temp65b = 0.25d0*(18.d0*rp1-78.d0*rp2+198.d0*(rp1*rp2)+191.d0*rp1&
&        **2+66.d0*(rp1**2*rp2)+3.d0*rp1**3-2.d0*(temp66*rp2)-30.d0)*&
&        fun2b/temp67
      temp64 = rp3**2
      temp63 = distp(0, 1)/temp64
      temp64b = 0.25d0*temp63*funb
      rp1b = (2.d0*2*rp1-5.d0*rp2-44.d0)*temp64b + (3.d0*3*rp1**2-2.d0*&
&        rp2*3*rp1**2+66.d0*rp2*2*rp1+191.d0*2*rp1+198.d0*rp2+18.d0)*&
&        temp66b
      temp63b = 0.25d0*(2.d0*rp1**2-44.d0*rp1-69.d0*rp2-5.d0*(rp1*rp2)-&
&        30.d0)*funb/temp64
      temp61b0 = distp(0, 1)*fun0b
      costb = -(r(0)**2*temp61b0)
      rp3b = -(temp63*2*rp3*temp63b) - (0.5d0*rp2+1.d0)*costb/rp3**2 - &
&        temp65*3*rp3**2*temp65b
      rp2b = ((-69.d0)-5.d0*rp1)*temp64b + 2*(rp2+1.d0)*rp3b + 0.5d0*&
&        costb/rp3 + (66.d0*rp1**2-2.d0*temp66+198.d0*rp1-78.d0)*temp66b
      temp62 = 4.d0*dd1
      temp61 = 11.d0/temp62
      distpb(0, 1) = distpb(0, 1) + temp63b + (temp61-r(0)**2*cost)*&
&        fun0b + temp65b
      dd1b = r(0)**2*rp1b - temp61*4.d0*temp61b0/temp62
      rb(0) = rb(0) + dd2*rp2b + dd1*2*r(0)*rp1b - cost*2*r(0)*temp61b0
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd2b = r(0)*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        temp61b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp60 = 4.d0*dd1
        temp59 = 11.d0/temp60
        temp59b = (temp59-r(k)**2*cost)*zb(indorbp, k)
        dd1b = dd1b - temp59*4.d0*temp61b/temp60
        costb = -(r(k)**2*temp61b)
        temp58 = dd2*r(k) + 1.d0
        temp59b0 = costb/temp58**2
        temp58b18 = -((0.5d0*(dd2*r(k))+1.d0)*2*temp59b0/temp58)
        rb(k) = rb(k) + 0.5d0*dd2*temp59b0 + dd2*temp58b18 - cost*2*r(k)&
&          *temp61b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp59b
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp59b
        zb(indorbp, k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,cost)
        dd2b = dd2b + r(k)*temp58b18 + 0.5d0*r(k)*temp59b0
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp58b0 = cost5g*4.d0*distpb(i, 10)
      temp58b1 = (rmu(1, i)**2-rmu(2, i)**2)*temp58b0
      temp58b2 = rmu(1, i)*rmu(2, i)*temp58b0
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp58b2 + rmu(2, i)*&
&        temp58b1
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp58b1 - 2*rmu(2, i)*&
&        temp58b2
      distpb(i, 10) = 0.0_8
      temp58b3 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp58b3
      distpb(i, 9) = 0.0_8
      temp58b4 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp58b5 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp58b4 - 2*rmu(2, i)*&
&        temp58b5 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp58b3
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp58b4
      distpb(i, 8) = 0.0_8
      temp58b6 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp58b7 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp58b6 + 2*rmu(1, i)*&
&        temp58b7 + 3.d0*2*rmu(1, i)*temp58b5
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp58b6
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp58b7
      distpb(i, 7) = 0.0_8
      temp58b8 = cost3g*2.d0*distpb(i, 6)
      temp58b9 = (7.d0*rmu(3, i)**2-r(i)**2)*temp58b8
      temp58b10 = rmu(1, i)*rmu(2, i)*temp58b8
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp58b9
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp58b9
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp58b10
      distpb(i, 6) = 0.0_8
      temp58b11 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp58b12 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp58b13 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp58b14 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp58b15 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp58b16 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp58b17 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp58b17 - 3.d0*2*r(i)*temp58b16 - 2*r(i)*temp58b12 - 3.d0*2*r(&
&        i)*temp58b14 - 2*r(i)*temp58b10
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp58b11
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp58b11
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp58b12
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp58b13
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp58b14 + rmu(2, i)*&
&        temp58b13
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp58b15
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp58b17 + 7.d0*2*rmu(3, i)*temp58b16 + rmu(1, i)*&
&        temp58b15
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp57 = dd2*r(k) + 1.d0
      temp58b = costb/temp57
      temp57b56 = -(dd1*r(k)**2*temp58b/temp57)
      dd1b = dd1b + r(k)**2*temp58b
      rb(k) = rb(k) + dd2*temp57b56 + dd1*2*r(k)*temp58b
      dd2b = dd2b + r(k)*temp57b56
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocg*2.75d0*dd1**1.75D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocg*2.75d0*dd1**1.75D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (1) 
! WARNING IN DFT it is assumed that UMRIGAR orbitals could be extended
! up to number 99, so i,h,... are possible extensions.                
! 1s single Z NO CUSP!                             
!        if(iocc(indshellp).eq.1) then 
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!           c=dd1*dsqrt(dd1)/dsqrt(pi) 
    c = dd1*DSQRT(dd1)*0.56418958354775628695d0
!           endif 
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1))
      distpb = 0.0_8
      temp70 = dd1/r(0)
      temp70b = -(distp(0, 1)*2.d0*zb(indorbp, indt+4)/r(0))
      dd1b = temp70b + distp(0, 1)*2*dd1*zb(indorbp, indt+4)
      rb(0) = rb(0) - temp70*temp70b
      distpb(0, 1) = (dd1**2-2.d0*temp70)*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      funb = 0.0_8
      DO i=3,1,-1
        temp69 = fun/r(0)
        temp69b0 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp69*zb(indorbp, indt+i)
        funb = funb + temp69b0
        rb(0) = rb(0) - temp69*temp69b0
        zb(indorbp, indt+i) = 0.0_8
      END DO
      dd1b = dd1b - distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) - dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp69b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp69b
      rb(k) = rb(k) - dd1*temp69b
      distpb(k, 1) = 0.0_8
    END DO
    temp68 = DSQRT(dd1)
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + 0.56418958354775628695d0*temp68*cb
    ELSE
      dd1b = dd1b + (0.56418958354775628695d0*dd1/(2.D0*DSQRT(dd1))+&
&        0.56418958354775628695d0*temp68)*cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (2) 
! 1s double Z with cusp cond                       
!                                                                       
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = (zeta(1)-dd1)/(dd2-zeta(1))
!           if(iflagnorm.gt.2) then 
    c = 1.d0/2.d0/DSQRT(2.d0*pi*(1.d0/(2.d0*dd1)**3+2.d0*peff/(dd1+dd2)&
&      **3+peff**2/(2.d0*dd2)**3))
!           endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = (-(dd1*distp(0, 1))-dd2*distp(0, 2)*peff)/r(0)
      distpb = 0.0_8
      temp78 = dd1/r(0)
      temp78b = -(distp(0, 1)*2.d0*zb(indorbp, indt+4)/r(0))
      temp78b0 = peff*distp(0, 2)*zb(indorbp, indt+4)
      temp77 = dd2/r(0)
      temp77b2 = -(2.d0*temp78b0/r(0))
      temp77b3 = (dd2**2-2.d0*temp77)*zb(indorbp, indt+4)
      dd1b = temp78b + distp(0, 1)*2*dd1*zb(indorbp, indt+4)
      rb(0) = rb(0) - temp77*temp77b2 - temp78*temp78b
      distpb(0, 1) = (dd1**2-2.d0*temp78)*zb(indorbp, indt+4)
      dd2b = temp77b2 + 2*dd2*temp78b0
      peffb = distp(0, 2)*temp77b3
      distpb(0, 2) = peff*temp77b3
      zb(indorbp, indt+4) = 0.0_8
      funb = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp77b1 = funb/r(0)
      dd1b = dd1b - distp(0, 1)*temp77b1
      distpb(0, 1) = distpb(0, 1) - dd1*temp77b1
      distpb(0, 2) = distpb(0, 2) - dd2*peff*temp77b1
      dd2b = dd2b - distp(0, 2)*peff*temp77b1
      peffb = peffb - distp(0, 2)*dd2*temp77b1
      rb(0) = rb(0) - (-(dd1*distp(0, 1))-distp(0, 2)*(dd2*peff))*&
&        temp77b1/r(0)
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      peffb = peffb + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + peff*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp77b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp77b
      distpb(k, 2) = 0.0_8
      temp77b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp77b0 - dd2*temp77b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp77b0
      distpb(k, 1) = 0.0_8
    END DO
    temp76 = 2.d0**3*dd2**3
    temp75 = peff**2/temp76
    temp74 = (dd1+dd2)**3
    temp73 = 2.d0**3*dd1**3
    temp72 = 2.d0*pi*(1.0/temp73+2.d0*peff/temp74+temp75)
    temp71 = DSQRT(temp72)
    IF (temp72 .EQ. 0.0) THEN
      temp71b = 0.0
    ELSE
      temp71b = -(pi*cb/(temp71**2*2.D0*DSQRT(temp72)))
    END IF
    temp71b0 = 2.d0*temp71b/temp74
    temp71b1 = -(peff*3*(dd1+dd2)**2*temp71b0/temp74)
    peffb = peffb + 2*peff*temp71b/temp76 + temp71b0
    temp71b2 = peffb/(dd2-zeta(1))
    dd1b = dd1b + temp71b1 - temp71b2 - 2.d0**3*3*dd1**2*temp71b/temp73&
&      **2
    dd2b = dd2b + temp71b1 - temp75*2.d0**3*3*dd2**2*temp71b/temp76 - (&
&      zeta(1)-dd1)*temp71b2/(dd2-zeta(1))
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (3) 
! 1s double Z NO CUSP                             
!                                                                       
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
!           if(iflagnorm.gt.2) then 
    c = 1.d0/2.d0/DSQRT(2.d0*pi*(1.d0/(2.d0*dd1)**3+2.d0*peff/(dd1+dd2)&
&      **3+peff**2/(2.d0*dd2)**3))
    ad_from = indpar + 1
!           endif 
    DO i=ad_from,indpar+2
      DO k=indtmin,indtm
        distp(k, i-indpar) = c*DEXP(-(dd(i)*r(k)))
      END DO
    END DO
    CALL PUSHINTEGER4(adi4ibuf,adi4buf,i - 1)
    CALL PUSHINTEGER4(adi4ibuf,adi4buf,ad_from)
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1)) - peff*dd2*distp(0, 2)
      distpb = 0.0_8
      temp88 = dd1/r(0)
      temp88b = -(distp(0, 1)*2.d0*zb(indorbp, indt+4)/r(0))
      temp88b0 = peff*distp(0, 2)*zb(indorbp, indt+4)
      temp87 = dd2/r(0)
      temp87b = -(2.d0*temp88b0/r(0))
      temp87b0 = (dd2**2-2.d0*temp87)*zb(indorbp, indt+4)
      dd1b = temp88b + distp(0, 1)*2*dd1*zb(indorbp, indt+4)
      rb(0) = rb(0) - temp87*temp87b - temp88*temp88b
      distpb(0, 1) = (dd1**2-2.d0*temp88)*zb(indorbp, indt+4)
      dd2b = temp87b + 2*dd2*temp88b0
      peffb = distp(0, 2)*temp87b0
      distpb(0, 2) = peff*temp87b0
      zb(indorbp, indt+4) = 0.0_8
      funb = 0.0_8
      DO i=3,1,-1
        temp86 = fun/r(0)
        temp86b = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp86*zb(indorbp, indt+i)
        funb = funb + temp86b
        rb(0) = rb(0) - temp86*temp86b
        zb(indorbp, indt+i) = 0.0_8
      END DO
      dd1b = dd1b - distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) - dd1*funb
      peffb = peffb - distp(0, 2)*dd2*funb
      dd2b = dd2b - distp(0, 2)*peff*funb
      distpb(0, 2) = distpb(0, 2) - peff*dd2*funb
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      peffb = peffb + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + peff*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    CALL POPINTEGER4(adi4ibuf,adi4buf,ad_from)
    CALL POPINTEGER4(adi4ibuf,adi4buf,ad_to)
    DO i=ad_to,ad_from,-1
      DO k=indtm,indtmin,-1
        temp85 = -(dd(i)*r(k))
        temp85b = c*DEXP(temp85)*distpb(k, i-indpar)
        cb = cb + DEXP(temp85)*distpb(k, i-indpar)
        ddb(i) = ddb(i) - r(k)*temp85b
        rb(k) = rb(k) - dd(i)*temp85b
        distpb(k, i-indpar) = 0.0_8
      END DO
    END DO
    temp84 = 2.d0**3*dd2**3
    temp83 = peff**2/temp84
    temp82 = (dd1+dd2)**3
    temp81 = 2.d0**3*dd1**3
    temp80 = 2.d0*pi*(1.0/temp81+2.d0*peff/temp82+temp83)
    temp79 = DSQRT(temp80)
    IF (temp80 .EQ. 0.0) THEN
      temp79b = 0.0
    ELSE
      temp79b = -(pi*cb/(temp79**2*2.D0*DSQRT(temp80)))
    END IF
    temp79b0 = 2.d0*temp79b/temp82
    temp79b1 = -(peff*3*(dd1+dd2)**2*temp79b0/temp82)
    dd1b = dd1b + temp79b1 - 2.d0**3*3*dd1**2*temp79b/temp81**2
    peffb = peffb + 2*peff*temp79b/temp84 + temp79b0
    dd2b = dd2b + temp79b1 - temp83*2.d0**3*3*dd2**2*temp79b/temp84
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (4) 
! 2s 2pz Hybryd single Z                          
! normalized                            
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
!           if(iflagnorm.gt.2) then 
    c = dd1**2.5d0/DSQRT(3.d0*pi*(1.d0+dd2**2/3.d0))
!           endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(1.d0-dd1*r(0))
      funp = -(dd2*dd1*distp(0, 1)*rmu(3, 0))
      temp92b = zb(indorbp, indt+4)/r(0)
      funb = 2.d0*temp92b
      funpb = 4.d0*temp92b
      rb(0) = rb(0) - (2.d0*fun+4.d0*funp)*temp92b/r(0)
      fun2b = zb(indorbp, indt+4)
      fun2pb = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      distpb = 0.0_8
      dd2b = distp(0, 1)*zb(indorbp, indt+3)
      distpb(0, 1) = dd2*zb(indorbp, indt+3)
      DO i=3,1,-1
        temp91b6 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        temp91 = (fun+funp)/r(0)
        funb = funb + temp91b6
        funpb = funpb + temp91b6
        rb(0) = rb(0) - temp91*temp91b6
        rmub(i, 0) = rmub(i, 0) + temp91*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp91b1 = dd2*distp(0, 1)*fun2pb
      temp91b2 = dd1**2*rmu(3, 0)*fun2pb
      temp91b3 = distp(0, 1)*fun2b
      temp91b4 = -(distp(0, 1)*rmu(3, 0)*funpb)
      dd1b = (r(0)*2*dd1-2.d0)*temp91b3 - distp(0, 1)*r(0)*funb + dd2*&
&        temp91b4 + rmu(3, 0)*2*dd1*temp91b1
      temp91b5 = -(dd2*dd1*funpb)
      rmub(3, 0) = rmub(3, 0) + distp(0, 1)*temp91b5 + dd1**2*temp91b1
      dd2b = dd2b + dd1*temp91b4 + distp(0, 1)*temp91b2
      distpb(0, 1) = distpb(0, 1) + (dd1**2*r(0)-2.d0*dd1)*fun2b + (1.d0&
&        -dd1*r(0))*funb + rmu(3, 0)*temp91b5 + dd2*temp91b2
      rb(0) = rb(0) + dd1**2*temp91b3 - distp(0, 1)*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp91b0 = distp(i, 1)*zb(indorbp, i)
      rb(i) = rb(i) + temp91b0
      dd2b = dd2b + rmu(3, i)*temp91b0
      rmub(3, i) = rmub(3, i) + dd2*temp91b0
      distpb(i, 1) = distpb(i, 1) + (r(i)+dd2*rmu(3, i))*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp91b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp91b
      rb(k) = rb(k) - dd1*temp91b
      distpb(k, 1) = 0.0_8
    END DO
    temp90 = 3.d0*pi*(dd2**2/3.d0+1.d0)
    temp89 = DSQRT(temp90)
    dd1b = dd1b + 2.5d0*dd1**1.5D0*cb/temp89
    IF (.NOT.temp90 .EQ. 0.0) dd2b = dd2b - dd1**2.5d0*pi*2*dd2*cb/(&
&        temp89**2*2.D0*DSQRT(temp90))
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (5) 
! 2s single Z NO CUSP                             
! normalized                            
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
!           if(iflagnorm.gt.2) then 
!           c=dd1**2.5d0/dsqrt(3.d0*pi) 
    c = dd1**2.5d0*0.32573500793527994772d0
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(1.d0-dd1*r(0))
      fun2 = distp(0, 1)*(dd1**2*r(0)-2.d0*dd1)
      temp93b = 2.d0*zb(indorbp, indt+4)/r(0)
      cb = fun2*zb(indorbp, indt+4) + fun*temp93b
      funb = c*temp93b
      rb(0) = rb(0) - c*fun*temp93b/r(0)
      fun2b = c*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp92 = rmu(i, 0)/r(0)
        temp92b3 = c*fun*zb(indorbp, indt+i)/r(0)
        cb = cb + temp92*fun*zb(indorbp, indt+i)
        funb = funb + temp92*c*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + temp92b3
        rb(0) = rb(0) - temp92*temp92b3
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp92b2 = distp(0, 1)*fun2b
      distpb(0, 1) = (1.d0-dd1*r(0))*funb + (dd1**2*r(0)-2.d0*dd1)*fun2b
      dd1b = (r(0)*2*dd1-2.d0)*temp92b2 - distp(0, 1)*r(0)*funb
      rb(0) = rb(0) + dd1**2*temp92b2 - distp(0, 1)*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      cb = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp92b1 = distp(i, 1)*zb(indorbp, i)
      cb = cb + r(i)*temp92b1
      rb(i) = rb(i) + c*temp92b1
      distpb(i, 1) = distpb(i, 1) + c*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    dd1b = dd1b + 0.32573500793527994772d0*2.5d0*dd1**1.5D0*cb
    DO k=indtm,indtmin,-1
      temp92b0 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp92b0
      rb(k) = rb(k) - dd1*temp92b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (6) 
! 2s double  Z NO CUSP                               
! normalized                            
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
!           if(iflagnorm.gt.2) then 
!            c=                                              WRONG      
!    &0.5*dsqrt((1.d0/dd1**5/32.d0+2.d0*peff/(dd1+dd2)**5               
!    &+peff**2/dd2**5/32.d0)/(24.d0*pi))                                
    c = 1.d0/DSQRT(3.d0*pi*(1.d0/dd1**5+64.d0*peff/(dd1+dd2)**5+peff**2/&
&      dd2**5))
!           endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(1.d0-dd1*r(0)) + peff*distp(0, 2)*(1.d0-dd2*r(0&
&        ))
      temp100b = 2.d0*zb(indorbp, indt+4)/r(0)
      funb = temp100b
      rb(0) = rb(0) - fun*temp100b/r(0)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp99 = fun/r(0)
        temp99b7 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp99*zb(indorbp, indt+i)
        funb = funb + temp99b7
        rb(0) = rb(0) - temp99*temp99b7
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp99b2 = distp(0, 1)*fun2b
      temp99b3 = (dd2**2*r(0)-2.d0*dd2)*fun2b
      temp99b4 = peff*distp(0, 2)*fun2b
      distpb(0, 1) = (dd1**2*r(0)-2.d0*dd1)*fun2b
      dd1b = (r(0)*2*dd1-2.d0)*temp99b2 - distp(0, 1)*r(0)*funb
      temp99b5 = peff*distp(0, 2)*funb
      rb(0) = rb(0) + dd2**2*temp99b4 - dd2*temp99b5 - distp(0, 1)*dd1*&
&        funb + dd1**2*temp99b2
      temp99b6 = (1.d0-dd2*r(0))*funb
      peffb = distp(0, 2)*temp99b6 + distp(0, 2)*temp99b3
      distpb(0, 2) = peff*temp99b3
      dd2b = (r(0)*2*dd2-2.d0)*temp99b4 - r(0)*temp99b5
      distpb(0, 1) = distpb(0, 1) + (1.d0-dd1*r(0))*funb
      distpb(0, 2) = distpb(0, 2) + peff*temp99b6
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp99b1 = r(i)*zb(indorbp, i)
      rb(i) = rb(i) + (distp(i, 1)+distp(i, 2)*peff)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp99b1
      distpb(i, 2) = distpb(i, 2) + peff*temp99b1
      peffb = peffb + distp(i, 2)*temp99b1
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp99b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp99b
      distpb(k, 2) = 0.0_8
      temp99b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp99b0 - dd2*temp99b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp99b0
      distpb(k, 1) = 0.0_8
    END DO
    temp98 = dd2**5
    temp97 = peff**2/temp98
    temp96 = (dd1+dd2)**5
    temp95 = dd1**5
    temp94 = 3.d0*pi*(1.0/temp95+64.d0*peff/temp96+temp97)
    temp93 = DSQRT(temp94)
    IF (temp94 .EQ. 0.0) THEN
      temp93b0 = 0.0
    ELSE
      temp93b0 = -(pi*3.d0*cb/(temp93**2*2.D0*DSQRT(temp94)))
    END IF
    temp93b1 = 64.d0*temp93b0/temp96
    temp93b2 = -(peff*5*(dd1+dd2)**4*temp93b1/temp96)
    dd1b = dd1b + temp93b2 - 5*dd1**4*temp93b0/temp95**2
    peffb = peffb + 2*peff*temp93b0/temp98 + temp93b1
    dd2b = dd2b + temp93b2 - temp97*5*dd2**4*temp93b0/temp98
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (7) 
! 2s double Z NO CUSP                                 
! normalized IS WRONG!!!                
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      distp(k, 2) = DEXP(-(dd2*r(k)))
    END DO
!           if(iflagnorm.gt.2) then 
    c = 1/DSQRT(1/(3.d0/4.d0/dd1**5+peff**2/dd2**3/4+12*peff/(dd1+dd2)**&
&      4))*1.d0/DSQRT(4.0*pi)
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1)) + peff*distp(0, 2)*(1.d0-dd2*r(0))
      fun2 = distp(0, 1)*dd1**2 + peff*distp(0, 2)*(dd2**2*r(0)-2.d0*dd2&
&        )
      temp110 = fun/r(0)
      temp110b = c*2.d0*zb(indorbp, indt+4)/r(0)
      cb = (2.d0*temp110+fun2)*zb(indorbp, indt+4)
      funb = temp110b
      rb(0) = rb(0) - temp110*temp110b
      fun2b = c*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp109 = rmu(i, 0)/r(0)
        temp109b5 = fun*c*zb(indorbp, indt+i)/r(0)
        funb = funb + temp109*c*zb(indorbp, indt+i)
        cb = cb + temp109*fun*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + temp109b5
        rb(0) = rb(0) - temp109*temp109b5
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp109b1 = (dd2**2*r(0)-2.d0*dd2)*fun2b
      temp109b2 = peff*distp(0, 2)*fun2b
      distpb(0, 1) = dd1**2*fun2b
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb
      temp109b3 = (1.d0-dd2*r(0))*funb
      peffb = distp(0, 2)*temp109b3 + distp(0, 2)*temp109b1
      distpb(0, 2) = peff*temp109b3 + peff*temp109b1
      temp109b4 = peff*distp(0, 2)*funb
      dd2b = (r(0)*2*dd2-2.d0)*temp109b2 - r(0)*temp109b4
      rb(0) = rb(0) + dd2**2*temp109b2 - dd2*temp109b4
      distpb(0, 1) = distpb(0, 1) - dd1*funb
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      cb = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp109b = c*zb(indorbp, i)
      temp109b0 = distp(i, 2)*temp109b
      cb = cb + (distp(i, 1)+r(i)*peff*distp(i, 2))*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp109b
      rb(i) = rb(i) + peff*temp109b0
      peffb = peffb + r(i)*temp109b0
      distpb(i, 2) = distpb(i, 2) + r(i)*peff*temp109b
      zb(indorbp, i) = 0.0_8
    END DO
    temp108 = (dd1+dd2)**4
    temp107 = 4*dd2**3
    temp106 = peff**2/temp107
    temp105 = 4.d0*dd1**5
    temp100 = 3.d0/temp105 + temp106 + 12*(peff/temp108)
    temp104 = 1.0/temp100
    temp103 = DSQRT(temp104)
    temp102 = DSQRT(4.0*pi)
    temp101 = temp102*temp103
    IF (temp104 .EQ. 0.0) THEN
      temp100b2 = 0.0
    ELSE
      temp100b2 = temp102*temp104*cb/(temp101**2*2.D0*DSQRT(temp104)*&
&        temp100)
    END IF
    temp100b3 = 12*temp100b2/temp108
    temp100b4 = -(peff*4*(dd1+dd2)**3*temp100b3/temp108)
    dd1b = dd1b + temp100b4 - 3.d0*4.d0*5*dd1**4*temp100b2/temp105**2
    peffb = peffb + temp100b3 + 2*peff*temp100b2/temp107
    dd2b = dd2b + temp100b4 - temp106*4*3*dd2**2*temp100b2/temp107
    DO k=indtm,indtmin,-1
      temp100b0 = DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp100b0
      distpb(k, 2) = 0.0_8
      temp100b1 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp100b1 - dd2*temp100b0
      dd1b = dd1b - r(k)*temp100b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (8) 
! 2s double Z WITH CUSP                           
! normalized                        
! exp(-dd1*r) + (dd1-zeta) * r * exp(-dd2*r)                            
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd1 - zeta(1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      distp(k, 2) = DEXP(-(dd2*r(k)))
    END DO
!           if(iflagnorm.gt.2) then 
    c = 1.d0/DSQRT(1/4.d0/dd1**3+12*peff/(dd1+dd2)**4+3*peff**2/4/dd2**5&
&      )/DSQRT(4.0*pi)
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1)) + peff*distp(0, 2)*(1.d0-dd2*r(0))
      fun2 = distp(0, 1)*dd1**2 + peff*distp(0, 2)*(dd2**2*r(0)-2.d0*dd2&
&        )
      temp119 = fun/r(0)
      temp119b = c*2.d0*zb(indorbp, indt+4)/r(0)
      cb = (2.d0*temp119+fun2)*zb(indorbp, indt+4)
      funb = temp119b
      rb(0) = rb(0) - temp119*temp119b
      fun2b = c*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp118 = rmu(i, 0)/r(0)
        temp118b5 = fun*c*zb(indorbp, indt+i)/r(0)
        funb = funb + temp118*c*zb(indorbp, indt+i)
        cb = cb + temp118*fun*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + temp118b5
        rb(0) = rb(0) - temp118*temp118b5
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp118b1 = (dd2**2*r(0)-2.d0*dd2)*fun2b
      temp118b2 = peff*distp(0, 2)*fun2b
      distpb(0, 1) = dd1**2*fun2b
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb
      temp118b3 = (1.d0-dd2*r(0))*funb
      peffb = distp(0, 2)*temp118b3 + distp(0, 2)*temp118b1
      distpb(0, 2) = peff*temp118b3 + peff*temp118b1
      temp118b4 = peff*distp(0, 2)*funb
      dd2b = (r(0)*2*dd2-2.d0)*temp118b2 - r(0)*temp118b4
      rb(0) = rb(0) + dd2**2*temp118b2 - dd2*temp118b4
      distpb(0, 1) = distpb(0, 1) - dd1*funb
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      cb = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp118b = c*zb(indorbp, i)
      temp118b0 = distp(i, 2)*temp118b
      cb = cb + (distp(i, 1)+r(i)*peff*distp(i, 2))*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp118b
      rb(i) = rb(i) + peff*temp118b0
      peffb = peffb + r(i)*temp118b0
      distpb(i, 2) = distpb(i, 2) + r(i)*peff*temp118b
      zb(indorbp, i) = 0.0_8
    END DO
    temp117 = 4*dd2**5
    temp111 = peff**2/temp117
    temp116 = (dd1+dd2)**4
    temp115 = 4.d0*dd1**3
    temp112 = 1.0/temp115 + 12*(peff/temp116) + 3*temp111
    temp114 = DSQRT(temp112)
    temp113 = DSQRT(4.0*pi)
    IF (temp112 .EQ. 0.0) THEN
      temp112b = 0.0
    ELSE
      temp112b = -(cb/(temp113*temp114**2*2.D0*DSQRT(temp112)))
    END IF
    temp112b0 = 12*temp112b/temp116
    temp112b1 = -(peff*4*(dd1+dd2)**3*temp112b0/temp116)
    temp111b1 = 3*temp112b/temp117
    dd1b = dd1b + temp112b1 - 4.d0*3*dd1**2*temp112b/temp115**2
    peffb = peffb + 2*peff*temp111b1 + temp112b0
    dd2b = dd2b + temp112b1 - temp111*4*5*dd2**4*temp111b1
    DO k=indtm,indtmin,-1
      temp111b = DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp111b
      distpb(k, 2) = 0.0_8
      temp111b0 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp111b0 - dd2*temp111b
      dd1b = dd1b - r(k)*temp111b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (10) 
! 3s single zeta                                    
! R(r)=r**2*exp(-z1*r)                                                  
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!           c=dsqrt((2*dd1)**7/720.d0/pi)/2.d0 
    c = dd1**3.5d0*0.11894160774351807429d0
!           endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd1*r(0))*distp(0, 1)
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp120b0 = distp(0, 1)*fun2b
      temp120b1 = 2*dd1*r(0)*temp120b0
      dd1b = r(0)*temp120b1 - 4*r(0)*temp120b0 - distp(0, 1)*r(0)*funb
      rb(0) = rb(0) + dd1*temp120b1 - 4*dd1*temp120b0 - distp(0, 1)*dd1*&
&        funb
      distpb(0, 1) = (2.d0-dd1*r(0))*funb + ((dd1*r(0))**2-4*(dd1*r(0))+&
&        2.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp120b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp120b
      rb(k) = rb(k) - dd1*temp120b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.11894160774351807429d0*3.5d0*dd1**2.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (11) 
! 3s double zeta                                     
! R(r)=r**2*(exp(-z1*r)+p*exp(-z2*r))                                   
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
!           if(iflagnorm.gt.2) then 
    c = 1.d0/2.d0/DSQRT(pi*720.d0*(1.d0/(2.d0*dd1)**7+2.d0*peff/(dd1+dd2&
&      )**7+peff**2/(2.d0*dd2)**7))
!           endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
!              the first derivative                                     
      fun = distp(0, 1)*(2.d0*r(0)-dd1*rp1) + peff*distp(0, 2)*(2.d0*r(0&
&        )-dd2*rp1)
!                                                                       
!              the second derivative                                    
      temp129b = 2.d0*zb(indorbp, indt+4)/r(0)
      funb = temp129b
      rb(0) = rb(0) - fun*temp129b/r(0)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp128 = fun/r(0)
        temp128b8 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp128*zb(indorbp, indt+i)
        funb = funb + temp128b8
        rb(0) = rb(0) - temp128*temp128b8
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp128b2 = distp(0, 1)*fun2b
      temp128b3 = (dd2**2*rp1-4.d0*(dd2*r(0))+2.d0)*fun2b
      temp128b4 = peff*distp(0, 2)*fun2b
      distpb(0, 1) = (dd1**2*rp1-4.d0*(dd1*r(0))+2.d0)*fun2b
      temp128b5 = distp(0, 1)*funb
      dd1b = (rp1*2*dd1-4.d0*r(0))*temp128b2 - rp1*temp128b5
      temp128b6 = peff*distp(0, 2)*funb
      rp1b = dd2**2*temp128b4 - dd2*temp128b6 - dd1*temp128b5 + dd1**2*&
&        temp128b2
      rb(0) = rb(0) + 2.d0*temp128b5 + 2.d0*temp128b6 + 2*r(0)*rp1b - &
&        4.d0*dd2*temp128b4 - 4.d0*dd1*temp128b2
      temp128b7 = (2.d0*r(0)-dd2*rp1)*funb
      peffb = distp(0, 2)*temp128b7 + distp(0, 2)*temp128b3
      distpb(0, 2) = peff*temp128b3
      dd2b = (rp1*2*dd2-4.d0*r(0))*temp128b4 - rp1*temp128b6
      distpb(0, 1) = distpb(0, 1) + (2.d0*r(0)-dd1*rp1)*funb
      distpb(0, 2) = distpb(0, 2) + peff*temp128b7
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp128b1 = r(i)**2*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp128b1
      peffb = peffb + distp(i, 2)*temp128b1
      distpb(i, 2) = distpb(i, 2) + peff*temp128b1
      rb(i) = rb(i) + (distp(i, 1)+peff*distp(i, 2))*2*r(i)*zb(indorbp, &
&        i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp128b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp128b
      distpb(k, 2) = 0.0_8
      temp128b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp128b0 - dd2*temp128b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp128b0
      distpb(k, 1) = 0.0_8
    END DO
    temp127 = 2.d0**7
    temp126 = temp127*dd2**7
    temp125 = peff**2/temp126
    temp124 = (dd1+dd2)**7
    temp123 = 2.d0**7
    temp122 = temp123*dd1**7
    temp121 = 720.d0*pi*(1.0/temp122+2.d0*peff/temp124+temp125)
    temp120 = DSQRT(temp121)
    IF (temp121 .EQ. 0.0) THEN
      temp120b2 = 0.0
    ELSE
      temp120b2 = -(pi*720.d0*cb/(2.d0*temp120**2*2.D0*DSQRT(temp121)))
    END IF
    temp120b3 = 2.d0*temp120b2/temp124
    temp120b4 = -(peff*7*(dd1+dd2)**6*temp120b3/temp124)
    dd1b = dd1b + temp120b4 - temp123*7*dd1**6*temp120b2/temp122**2
    peffb = peffb + 2*peff*temp120b2/temp126 + temp120b3
    dd2b = dd2b + temp120b4 - temp125*temp127*7*dd2**6*temp120b2/temp126
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (12) 
! 4s single zeta                                    
! R(r)=r**3*exp(-z1*r)                                                  
!                                                                       
!       if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!           c=dsqrt((2*dd1)**9/40320.d0/pi)/2.d0 
    c = dd1**4.5d0*.03178848180059307346d0
!           endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**3
      rp2 = r(0)**2
!                                                                       
!c              the first derivative                                    
      fun = distp(0, 1)*(3.d0*rp2-dd1*rp1)
!c                                                                      
!c              the second derivative                                   
      temp130b = 2.d0*zb(indorbp, indt+4)/r(0)
      funb = temp130b
      rb(0) = rb(0) - fun*temp130b/r(0)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp129 = fun/r(0)
        temp129b3 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp129*zb(indorbp, indt+i)
        funb = funb + temp129b3
        rb(0) = rb(0) - temp129*temp129b3
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp129b1 = distp(0, 1)*fun2b
      distpb(0, 1) = (3.d0*rp2-dd1*rp1)*funb + (6.d0*r(0)-6.d0*(dd1*rp2)&
&        +dd1**2*rp1)*fun2b
      temp129b2 = distp(0, 1)*funb
      rp2b = 3.d0*temp129b2 - 6.d0*dd1*temp129b1
      rp1b = dd1**2*temp129b1 - dd1*temp129b2
      rb(0) = rb(0) + 2*r(0)*rp2b + 3*r(0)**2*rp1b + 6.d0*temp129b1
      dd1b = (rp1*2*dd1-6.d0*rp2)*temp129b1 - rp1*temp129b2
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**3*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*3*r(i)**2*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp129b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp129b0
      rb(k) = rb(k) - dd1*temp129b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .03178848180059307346d0*4.5d0*dd1**3.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (13) 
!                                                                       
! 4s double zeta                                    
! R(r)=r**3*(exp(-z1*r)+z3*exp(-z2*r))                                  
!                                                                       
!                                                                       
!                                                                       
!        if(iocc(indshellp).eq.1) then 
!                                                                       
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    dd3 = dd(indpar+3)
!           if(iflagnorm.gt.2) then 
    c = 1.d0/2.d0/DSQRT(pi*40320.d0*(1.d0/(2.d0*dd1)**9+2.d0*dd3/(dd1+&
&      dd2)**9+dd3**2/(2.d0*dd2)**9))
!           endif 
!                                                                       
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
!                                                                       
    IF (typec .NE. 1) THEN
      rp1 = r(0)**3
      rp2 = r(0)**2
!                                                                       
!c              the first derivative                                    
      fun = distp(0, 1)*(3.d0*rp2-dd1*rp1) + dd3*distp(0, 2)*(3.d0*rp2-&
&        dd2*rp1)
!c                                                                      
!              the second derivative                                    
      temp139b = 2.d0*zb(indorbp, indt+4)/r(0)
      funb = temp139b
      rb(0) = rb(0) - fun*temp139b/r(0)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp138 = fun/r(0)
        temp138b8 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp138*zb(indorbp, indt+i)
        funb = funb + temp138b8
        rb(0) = rb(0) - temp138*temp138b8
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp138b2 = distp(0, 1)*fun2b
      temp138b3 = (6.d0*r(0)-6.d0*(dd2*rp2)+dd2**2*rp1)*fun2b
      temp138b4 = dd3*distp(0, 2)*fun2b
      distpb(0, 1) = (6.d0*r(0)-6.d0*(dd1*rp2)+dd1**2*rp1)*fun2b
      temp138b5 = distp(0, 1)*funb
      temp138b6 = dd3*distp(0, 2)*funb
      rp2b = 3.d0*temp138b5 + 3.d0*temp138b6 - 6.d0*dd2*temp138b4 - 6.d0&
&        *dd1*temp138b2
      rp1b = dd2**2*temp138b4 - dd2*temp138b6 - dd1*temp138b5 + dd1**2*&
&        temp138b2
      rb(0) = rb(0) + 2*r(0)*rp2b + 3*r(0)**2*rp1b + 6.d0*temp138b4 + &
&        6.d0*temp138b2
      dd1b = (rp1*2*dd1-6.d0*rp2)*temp138b2 - rp1*temp138b5
      temp138b7 = (3.d0*rp2-dd2*rp1)*funb
      dd3b = distp(0, 2)*temp138b7 + distp(0, 2)*temp138b3
      distpb(0, 2) = dd3*temp138b3
      dd2b = (rp1*2*dd2-6.d0*rp2)*temp138b4 - rp1*temp138b6
      distpb(0, 1) = distpb(0, 1) + (3.d0*rp2-dd1*rp1)*funb
      distpb(0, 2) = distpb(0, 2) + dd3*temp138b7
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp138b1 = r(i)**3*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp138b1
      dd3b = dd3b + distp(i, 2)*temp138b1
      distpb(i, 2) = distpb(i, 2) + dd3*temp138b1
      rb(i) = rb(i) + (distp(i, 1)+dd3*distp(i, 2))*3*r(i)**2*zb(indorbp&
&        , i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp138b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp138b
      distpb(k, 2) = 0.0_8
      temp138b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp138b0 - dd2*temp138b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp138b0
      distpb(k, 1) = 0.0_8
    END DO
    temp137 = 2.d0**9
    temp136 = temp137*dd2**9
    temp135 = dd3**2/temp136
    temp134 = (dd1+dd2)**9
    temp133 = 2.d0**9
    temp132 = temp133*dd1**9
    temp131 = 40320.d0*pi*(1.0/temp132+2.d0*dd3/temp134+temp135)
    temp130 = DSQRT(temp131)
    IF (temp131 .EQ. 0.0) THEN
      temp130b0 = 0.0
    ELSE
      temp130b0 = -(pi*40320.d0*cb/(2.d0*temp130**2*2.D0*DSQRT(temp131))&
&        )
    END IF
    temp130b1 = 2.d0*temp130b0/temp134
    temp130b2 = -(dd3*9*(dd1+dd2)**8*temp130b1/temp134)
    dd1b = dd1b + temp130b2 - temp133*9*dd1**8*temp130b0/temp132**2
    dd3b = dd3b + 2*dd3*temp130b0/temp136 + temp130b1
    dd2b = dd2b + temp130b2 - temp135*temp137*9*dd2**8*temp130b0/temp136
    ddb(indpar+3) = ddb(indpar+3) + dd3b
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (14) 
! 1s single Z pseudo                              
! (1.d0 + dd1 r) * exp(-dd1 * r)   ! normalized                         
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
!           if(iflagnorm.gt.2) then 
!           c=dsqrt(dd1**3.d0/7.d0/pi) 
    c = dd1**1.5d0*0.213243618622923d0
    IF (typec .NE. 1) THEN
      fun = -(distp(0, 1)*dd1**2*r(0))
      fun2 = -(distp(0, 1)*dd1**2*(1.d0-dd1*r(0)))
      temp140b = 2.d0*zb(indorbp, indt+4)/r(0)
      cb = fun2*zb(indorbp, indt+4) + fun*temp140b
      funb = c*temp140b
      rb(0) = rb(0) - c*fun*temp140b/r(0)
      fun2b = c*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp139 = rmu(i, 0)/r(0)
        temp139b6 = c*fun*zb(indorbp, indt+i)/r(0)
        cb = cb + temp139*fun*zb(indorbp, indt+i)
        funb = funb + temp139*c*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + temp139b6
        rb(0) = rb(0) - temp139*temp139b6
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp139b3 = -((1.d0-dd1*r(0))*fun2b)
      temp139b4 = -(distp(0, 1)*dd1**2*fun2b)
      temp139b5 = -(dd1**2*funb)
      distpb(0, 1) = r(0)*temp139b5 + dd1**2*temp139b3
      dd1b = distp(0, 1)*2*dd1*temp139b3 - r(0)*temp139b4 - distp(0, 1)*&
&        r(0)*2*dd1*funb
      rb(0) = rb(0) + distp(0, 1)*temp139b5 - dd1*temp139b4
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      cb = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp139b1 = c*distp(i, 1)*zb(indorbp, i)
      temp139b2 = (dd1*r(i)+1.d0)*zb(indorbp, i)
      dd1b = dd1b + r(i)*temp139b1
      rb(i) = rb(i) + dd1*temp139b1
      cb = cb + distp(i, 1)*temp139b2
      distpb(i, 1) = distpb(i, 1) + c*temp139b2
      zb(indorbp, i) = 0.0_8
    END DO
    dd1b = dd1b + 0.213243618622923d0*1.5d0*dd1**0.5D0*cb
    DO k=indtm,indtmin,-1
      temp139b0 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp139b0
      rb(k) = rb(k) - dd1*temp139b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (15) 
! 1s single Z pseudo                              
! (r**2 + dd2*(1 + dd1*r))*exp(-dd1*r)  ! normalized                    
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    c = DSQRT(2.d0*dd1**7/pi/(45.d0+42.d0*dd1**2*dd2+14.d0*dd1**4*dd2**2&
&      ))
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*r(0)*(2.d0-dd1**2*dd2-dd1*r(0))
      temp147b = 2.d0*zb(indorbp, indt+4)/r(0)
      funb = temp147b
      rb(0) = rb(0) - fun*temp147b/r(0)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp146 = fun/r(0)
        temp146b0 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp146*zb(indorbp, indt+i)
        funb = funb + temp146b0
        rb(0) = rb(0) - temp146*temp146b0
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp145 = -(dd1*r(0)) - dd1**2*dd2 + 3.d0
      temp146b = distp(0, 1)*fun2b
      temp145b0 = (1.d0-dd1*r(0))*temp146b
      temp145b1 = (2.d0-dd1*r(0)-dd1**2*dd2)*funb
      distpb(0, 1) = r(0)*temp145b1 + ((1.d0-dd1*r(0))*temp145-1.d0)*&
&        fun2b
      temp145b2 = distp(0, 1)*r(0)*funb
      dd1b = (-(dd2*2*dd1)-r(0))*temp145b2 + (-(dd2*2*dd1)-r(0))*&
&        temp145b0 - temp145*r(0)*temp146b
      rb(0) = rb(0) + distp(0, 1)*temp145b1 - dd1*temp145b2 - dd1*&
&        temp145b0 - temp145*dd1*temp146b
      dd2b = -(dd1**2*temp145b2) - dd1**2*temp145b0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp145b = distp(i, 1)*zb(indorbp, i)
      temp144 = dd1*r(i) + 1.d0
      rb(i) = rb(i) + (dd2*dd1+2*r(i))*temp145b
      dd2b = dd2b + temp144*temp145b
      dd1b = dd1b + dd2*r(i)*temp145b
      distpb(i, 1) = distpb(i, 1) + (r(i)**2+dd2*temp144)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp144b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp144b
      rb(k) = rb(k) - dd1*temp144b
      distpb(k, 1) = 0.0_8
    END DO
    temp143 = dd1**4
    temp142 = pi*(42.d0*dd1**2*dd2+14.d0*temp143*dd2**2+45.d0)
    temp141 = dd1**7
    temp140 = temp141/temp142
    IF (2.d0*temp140 .EQ. 0.0) THEN
      temp140b0 = 0.0
    ELSE
      temp140b0 = 2.d0*cb/(2.D0*DSQRT(2.d0*temp140)*temp142)
    END IF
    temp140b1 = -(temp140*pi*temp140b0)
    dd1b = dd1b + (14.d0*dd2**2*4*dd1**3+42.d0*dd2*2*dd1)*temp140b1 + 7*&
&      dd1**6*temp140b0
    dd2b = dd2b + (14.d0*temp143*2*dd2+42.d0*dd1**2)*temp140b1
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (16) 
! 2s gaussian for pseudo                                
! R(r)=exp(-z*r**2) single zeta                                         
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
    IF (dd1 .NE. 0.) THEN
      c = 0.71270547035499016d0*dd1**0.75d0
!           c=(2.d0*dd1/pi)**(3.d0/4.d0) 
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
!                    ! the constant                                     
      c = 1.d0
    END IF
!           endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    IF (typec .NE. 1) THEN
!              the first derivative /r                                  
      fun = -(2.d0*dd1*distp(0, 1))
!              the second derivative                                    
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp148b = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp148b - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp148b
      distpb = 0.0_8
      distpb(0, 1) = -(2.d0*dd1*funb)
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp147 = r(k)**2
      temp147b0 = c*DEXP(-(dd1*temp147))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp147))*distpb(k, 1)
      dd1b = dd1b - temp147*temp147b0
      rb(k) = rb(k) - dd1*2*r(k)*temp147b0
      distpb(k, 1) = 0.0_8
    END DO
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) dd1b = dd1b + 0.71270547035499016d0*0.75d0*&
&        dd1**(-0.25D0)*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (17) 
! 2s gaussian for pseudo                                
! R(r)=r**2*exp(-z*r**2) single zeta                                    
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!        c=4.d0*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)/dsqrt(15.d0) 
    c = .73607904464954686606d0*dd1**1.75d0
!           endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
!              the first derivative / r                                 
      fun = 2.d0*distp(0, 1)*(1.d0-dd1*rp1)
!              the second derivative                                    
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp149b = 2.d0*distp(0, 1)*fun2b
      distpb(0, 1) = 2.d0*(1.d0-dd1*rp1)*funb + 2.d0*(2.d0*(dd1**2*rp1**&
&        2)-5.d0*(dd1*rp1)+1.d0)*fun2b
      temp149b0 = 2.d0*distp(0, 1)*funb
      dd1b = (2.d0*rp1**2*2*dd1-5.d0*rp1)*temp149b - rp1*temp149b0
      rp1b = (2.d0*dd1**2*2*rp1-5.d0*dd1)*temp149b - dd1*temp149b0
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp148 = r(k)**2
      temp148b0 = c*DEXP(-(dd1*temp148))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp148))*distpb(k, 1)
      dd1b = dd1b - temp148*temp148b0
      rb(k) = rb(k) - dd1*2*r(k)*temp148b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .73607904464954686606d0*1.75d0*dd1**0.75D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (18) 
! 2s gaussian for pseudo                                
! R(r)=r**4*exp(-z*r**2) single zeta                                    
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!           c=(2.d0*dd1**11/pi)**(1.d0/4.d0)*(512.d0/945.d0/pi) 
    c = dd1**2.75d0*0.1540487967684377d0
!           endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
!              the first derivative                                     
      fun = distp(0, 1)*rp1*(4.d0-2.d0*dd1*rp1)
!              the second derivative                                    
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp150b = (4.d0*(dd1**2*rp1**2)-18.d0*(dd1*rp1)+12.d0)*fun2b
      temp150b0 = distp(0, 1)*rp1*fun2b
      temp150b1 = (4.d0-2.d0*(dd1*rp1))*funb
      distpb(0, 1) = rp1*temp150b1 + rp1*temp150b
      temp150b2 = -(distp(0, 1)*rp1*2.d0*funb)
      rp1b = distp(0, 1)*temp150b1 + dd1*temp150b2 + (4.d0*dd1**2*2*rp1-&
&        18.d0*dd1)*temp150b0 + distp(0, 1)*temp150b
      dd1b = rp1*temp150b2 + (4.d0*rp1**2*2*dd1-18.d0*rp1)*temp150b0
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      rb(i) = rb(i) + distp(i, 1)*4*r(i)**3*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + r(i)**4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp149 = r(k)**2
      temp149b1 = c*DEXP(-(dd1*temp149))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp149))*distpb(k, 1)
      dd1b = dd1b - temp149*temp149b1
      rb(k) = rb(k) - dd1*2*r(k)*temp149b1
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.1540487967684377d0*2.75d0*dd1**1.75D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (19) 
! derivative of 16 with respect to z                    
! R(r)=c*exp(-z*r**2)*(3/4/z-r**2)                                      
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then 
!          if(dd1.ne.0.) then 
!            c=(2.d0*dd1/pi)**(3.d0/4.d0) 
    c = 0.71270547035499016d0*dd1**0.75d0
!          else 
!          c=1.d0 
!          endif 
!         endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    IF (typec .NE. 1) THEN
!              the first derivative /r                                  
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-7.d0/2.d0)
!              the second derivative                                    
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp153 = r(0)**4
      temp153b = distp(0, 1)*fun2b
      distpb(0, 1) = (2.d0*(dd1*r(0)**2)-7.d0/2.d0)*funb + (13.d0*(dd1*r&
&        (0)**2)-7.d0/2.d0-4.d0*(dd1**2*temp153))*fun2b
      temp153b0 = distp(0, 1)*2.d0*funb
      dd1b = r(0)**2*temp153b0 + (13.d0*r(0)**2-4.d0*temp153*2*dd1)*&
&        temp153b
      rb(0) = rb(0) + dd1*2*r(0)*temp153b0 + (13.d0*dd1*2*r(0)-4.d0*dd1&
&        **2*4*r(0)**3)*temp153b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp152 = 4.d0*dd1
      temp151 = 3.d0/temp152
      temp151b = distp(i, 1)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + (temp151-r(i)**2)*zb(indorbp, i)
      dd1b = dd1b - temp151*4.d0*temp151b/temp152
      rb(i) = rb(i) - 2*r(i)*temp151b
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp150 = r(k)**2
      temp150b3 = c*DEXP(-(dd1*temp150))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp150))*distpb(k, 1)
      dd1b = dd1b - temp150*temp150b3
      rb(k) = rb(k) - dd1*2*r(k)*temp150b3
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.71270547035499016d0*0.75d0*dd1**(-0.25D0)*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (20) 
! 2p single zeta                                    
!     2p single Z with no  cusp condition                               
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then 
!        c=dsqrt((2.d0*dd1)**5/8.d0/pi)/2.d0 
    c = dd1**2.5d0*0.5641895835477562d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
!        indorbp=indorb 
!                                                                       
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1))
      fun2 = dd1**2*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp155 = fun/r(0)
        temp156b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp155b = 4.d0*temp156b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp155+fun2)*zb(indorbp, indt&
&          +4)
        funb = funb + temp155b
        rb(0) = rb(0) - temp155*temp155b
        fun2b = fun2b + temp156b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp154 = fun/r(0)
          temp154b0 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp154*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp154*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb = funb + temp154b0
          rb(0) = rb(0) - temp154*temp154b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb
      distpb(0, 1) = fun0b - dd1*funb + dd1**2*fun2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp154b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp154b
      rb(k) = rb(k) - dd1*temp154b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.5641895835477562d0*2.5d0*dd1**1.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (21) 
! 2p double zeta                                     
!     2p without cusp condition                                         
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
    c = 0.5d0/DSQRT(8.d0*pi*(1.d0/(2.d0*dd1)**5+2.d0*peff/(dd1+dd2)**5+&
&      peff**2/(2.d0*dd2)**5))
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1) + peff*distp(i, 2)
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = (-(dd1*distp(0, 1))-dd2*peff*distp(0, 2))/r(0)
      fun2 = dd1**2*distp(0, 1) + peff*dd2**2*distp(0, 2)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp164b4 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp164b4
        fun2b = fun2b + temp164b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) distpb(0, 3) = distpb(0, 3) + zb(&
&              indorbp, indt+i)
          temp164b3 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp164b3
          funb = funb + rmu(ic, 0)*temp164b3
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp164b1 = dd2**2*fun2b
      temp164b2 = funb/r(0)
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*temp164b2
      distpb(0, 1) = distpb(0, 1) + dd1**2*fun2b
      dd2b = peff*distp(0, 2)*2*dd2*fun2b - distp(0, 2)*peff*temp164b2
      peffb = distp(0, 2)*temp164b1 - distp(0, 2)*dd2*temp164b2
      distpb(0, 2) = distpb(0, 2) + peff*temp164b1
      distpb(0, 1) = distpb(0, 1) - dd1*temp164b2
      distpb(0, 2) = distpb(0, 2) - dd2*peff*temp164b2
      rb(0) = rb(0) - (-(dd1*distp(0, 1))-dd2*peff*distp(0, 2))*&
&        temp164b2/r(0)
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distpb(i, 1) = distpb(i, 1) + distpb(i, 3)
      peffb = peffb + distp(i, 2)*distpb(i, 3)
      distpb(i, 2) = distpb(i, 2) + peff*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp164b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp164b
      distpb(k, 2) = 0.0_8
      temp164b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp164b0 - dd2*temp164b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp164b0
      distpb(k, 1) = 0.0_8
    END DO
    temp163 = 2.d0**5
    temp162 = temp163*dd2**5
    temp161 = peff**2/temp162
    temp160 = (dd1+dd2)**5
    temp159 = 2.d0**5
    temp158 = temp159*dd1**5
    temp157 = 8.d0*pi*(1.0/temp158+2.d0*peff/temp160+temp161)
    temp156 = DSQRT(temp157)
    IF (temp157 .EQ. 0.0) THEN
      temp156b0 = 0.0
    ELSE
      temp156b0 = -(0.5d0*pi*8.d0*cb/(temp156**2*2.D0*DSQRT(temp157)))
    END IF
    temp156b1 = 2.d0*temp156b0/temp160
    temp156b2 = -(peff*5*(dd1+dd2)**4*temp156b1/temp160)
    dd1b = dd1b + temp156b2 - temp159*5*dd1**4*temp156b0/temp158**2
    peffb = peffb + 2*peff*temp156b0/temp162 + temp156b1
    dd2b = dd2b + temp156b2 - temp161*temp163*5*dd2**4*temp156b0/temp162
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (22) 
! 3p single zeta                                 
!      3p without cusp condition                                        
!      r e^{-z1 r }                                                     
    dd1 = dd(indpar+1)
!        c=dsqrt((2.d0*dd1)**7/240.d0/pi)/2.d0 
    c = dd1**3.5d0*0.2060129077457011d0
!                                                                       
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(k, 2))
      distp(k, 2) = r(k)*distp(k, 1)
    END DO
!                                                                       
!        indorbp=indorb 
!                                                                       
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
!                                                                       
!                                                                       
    IF (typec .NE. 1) THEN
      fun = (1.d0-dd1*r(0))*distp(0, 1)
      fun2 = dd1*(dd1*r(0)-2.d0)*distp(0, 1)
!                                                                       
!              indorbp=indorb 
!                                                                       
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp165 = fun/r(0)
        temp166b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp165b = 4.d0*temp166b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp165+fun2)*zb(indorbp, indt&
&          +4)
        funb = funb + temp165b
        rb(0) = rb(0) - temp165*temp165b
        fun2b = fun2b + temp166b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp164 = fun/r(0)
          temp164b8 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp164*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp164*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb = funb + temp164b8
          rb(0) = rb(0) - temp164*temp164b8
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp164b6 = dd1*distp(0, 1)*fun2b
      temp164b7 = (dd1*r(0)-2.d0)*fun2b
      dd1b = distp(0, 1)*temp164b7 - distp(0, 1)*r(0)*funb + r(0)*&
&        temp164b6
      rb(0) = rb(0) + dd1*temp164b6 - distp(0, 1)*dd1*funb
      distpb(0, 1) = (1.d0-dd1*r(0))*funb + dd1*temp164b7
      distpb(0, 2) = distpb(0, 2) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 2)*zb(indorbp, i)
        distpb(i, 2) = distpb(i, 2) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(k, 2))
      rb(k) = rb(k) + distp(k, 1)*distpb(k, 2)
      distpb(k, 1) = distpb(k, 1) + r(k)*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      temp164b5 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp164b5
      rb(k) = rb(k) - dd1*temp164b5
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.2060129077457011d0*3.5d0*dd1**2.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (23) 
! 3p double zeta                                 
!      3p without cusp condition                                        
!      r ( e^{-z2 r } + z1 e^{-z3 r } )                                 
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    dd3 = dd(indpar+3)
!        if(iflagnorm.gt.2) then 
    c = 1.d0/2.d0/DSQRT(240.d0*pi*(1.d0/(2.d0*dd1)**7+2.d0*dd3/(dd1+dd2)&
&      **7+dd3**2/(2.d0*dd2)**7))
!        endif 
!                                                                       
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
!                                                                       
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = r(i)*(distp(i, 1)+dd3*distp(i, 2))
    END DO
!                                                                       
!        indorbp=indorb 
!                                                                       
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
!                                                                       
!                                                                       
    IF (typec .NE. 1) THEN
      fun = (1.d0-dd1*r(0))*distp(0, 1) + dd3*(1.d0-dd2*r(0))*distp(0, 2&
&        )
      fun2 = dd1*(dd1*r(0)-2.d0)*distp(0, 1) + dd3*dd2*(dd2*r(0)-2.d0)*&
&        distp(0, 2)
!                                                                       
!              indorbp=indorb 
!                                                                       
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp175 = fun/r(0)
        temp176b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp175b = 4.d0*temp176b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp175+fun2)*zb(indorbp, indt&
&          +4)
        funb = funb + temp175b
        rb(0) = rb(0) - temp175*temp175b
        fun2b = fun2b + temp176b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp174 = fun/r(0)
          temp174b8 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp174*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp174*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb = funb + temp174b8
          rb(0) = rb(0) - temp174*temp174b8
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp174b2 = dd1*distp(0, 1)*fun2b
      temp174b3 = (dd1*r(0)-2.d0)*fun2b
      temp174b4 = (dd2*r(0)-2.d0)*fun2b
      temp174b5 = dd3*dd2*distp(0, 2)*fun2b
      dd1b = distp(0, 1)*temp174b3 - distp(0, 1)*r(0)*funb + r(0)*&
&        temp174b2
      temp174b6 = dd3*distp(0, 2)*funb
      rb(0) = rb(0) + dd2*temp174b5 - dd2*temp174b6 - distp(0, 1)*dd1*&
&        funb + dd1*temp174b2
      distpb(0, 1) = dd1*temp174b3
      temp174b7 = (1.d0-dd2*r(0))*funb
      dd3b = distp(0, 2)*temp174b7 + distp(0, 2)*dd2*temp174b4
      dd2b = r(0)*temp174b5 - r(0)*temp174b6 + distp(0, 2)*dd3*temp174b4
      distpb(0, 2) = dd3*dd2*temp174b4
      distpb(0, 1) = distpb(0, 1) + (1.d0-dd1*r(0))*funb
      distpb(0, 2) = distpb(0, 2) + dd3*temp174b7
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      temp174b1 = r(i)*distpb(i, 3)
      rb(i) = rb(i) + (distp(i, 1)+dd3*distp(i, 2))*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + temp174b1
      dd3b = dd3b + distp(i, 2)*temp174b1
      distpb(i, 2) = distpb(i, 2) + dd3*temp174b1
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp174b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp174b
      distpb(k, 2) = 0.0_8
      temp174b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp174b0 - dd2*temp174b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp174b0
      distpb(k, 1) = 0.0_8
    END DO
    temp173 = 2.d0**7
    temp172 = temp173*dd2**7
    temp171 = dd3**2/temp172
    temp170 = (dd1+dd2)**7
    temp169 = 2.d0**7
    temp168 = temp169*dd1**7
    temp167 = 240.d0*pi*(1.0/temp168+2.d0*dd3/temp170+temp171)
    temp166 = DSQRT(temp167)
    IF (temp167 .EQ. 0.0) THEN
      temp166b0 = 0.0
    ELSE
      temp166b0 = -(pi*240.d0*cb/(2.d0*temp166**2*2.D0*DSQRT(temp167)))
    END IF
    temp166b1 = 2.d0*temp166b0/temp170
    temp166b2 = -(dd3*7*(dd1+dd2)**6*temp166b1/temp170)
    dd1b = dd1b + temp166b2 - temp169*7*dd1**6*temp166b0/temp168**2
    dd3b = dd3b + 2*dd3*temp166b0/temp172 + temp166b1
    dd2b = dd2b + temp166b2 - temp171*temp173*7*dd2**6*temp166b0/temp172
    ddb(indpar+3) = ddb(indpar+3) + dd3b
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (24) 
! 4p single zeta                                      
!c     4p without cusp condition                                        
!c      r^2   e^{-z1 r }                                                
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then 
!        c=dsqrt((2.d0*dd1)**9/120960.d0/pi)/2.d0 
    c = dd1**4.5d0*0.01835308852470193d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = r(i)**2*distp(i, 1)
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = (2.d0*r(0)-dd1*r(0)**2)*distp(0, 1)
      fun2 = ((dd1*r(0))**2+2.d0-4.d0*dd1*r(0))*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp177 = fun/r(0)
        temp178b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp177b = 4.d0*temp178b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp177+fun2)*zb(indorbp, indt&
&          +4)
        funb = funb + temp177b
        rb(0) = rb(0) - temp177*temp177b
        fun2b = fun2b + temp178b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp176 = fun/r(0)
          temp176b4 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp176*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp176*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb = funb + temp176b4
          rb(0) = rb(0) - temp176*temp176b4
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp176b1 = distp(0, 1)*fun2b
      temp176b2 = 2*dd1*r(0)*temp176b1
      temp176b3 = distp(0, 1)*funb
      dd1b = r(0)*temp176b2 - 4.d0*r(0)*temp176b1 - r(0)**2*temp176b3
      rb(0) = rb(0) + (2.d0-dd1*2*r(0))*temp176b3 - 4.d0*dd1*temp176b1 +&
&        dd1*temp176b2
      distpb(0, 1) = (2.d0*r(0)-dd1*r(0)**2)*funb + ((dd1*r(0))**2-4.d0*&
&        (dd1*r(0))+2.d0)*fun2b
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + r(i)**2*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp176b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp176b0
      rb(k) = rb(k) - dd1*temp176b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.01835308852470193d0*4.5d0*dd1**3.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (25) 
! 4p double zeta                                    
!     4p without cusp condition                                         
!      r^2  ( e^{-z2 r } + z1 e^{-z3 r } )                              
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    dd3 = dd(indpar+3)
!        if(iflagnorm.gt.2) then 
    c = 1.d0/2.d0/DSQRT(120960.d0*pi*(1.d0/(2.d0*dd1)**9+2.d0*dd3/(dd1+&
&      dd2)**9+dd3**2/(2.d0*dd2)**9))
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = r(i)**2*(distp(i, 1)+dd3*distp(i, 2))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = (2.d0*r(0)-dd1*r(0)**2)*distp(0, 1) + dd3*(2.d0*r(0)-dd2*r(0&
&        )**2)*distp(0, 2)
      fun2 = ((dd1*r(0))**2+2.d0-4.d0*dd1*r(0))*distp(0, 1) + dd3*((dd2*&
&        r(0))**2+2.d0-4.d0*dd2*r(0))*distp(0, 2)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp187 = fun/r(0)
        temp188b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp187b = 4.d0*temp188b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp187+fun2)*zb(indorbp, indt&
&          +4)
        funb = funb + temp187b
        rb(0) = rb(0) - temp187*temp187b
        fun2b = fun2b + temp188b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp186 = fun/r(0)
          temp186b10 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp186*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp186*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb = funb + temp186b10
          rb(0) = rb(0) - temp186*temp186b10
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp186b2 = distp(0, 1)*fun2b
      temp186b3 = 2*dd1*r(0)*temp186b2
      temp186b4 = dd3*distp(0, 2)*fun2b
      temp186b5 = 2*dd2*r(0)*temp186b4
      temp186b6 = ((dd2*r(0))**2-4.d0*(dd2*r(0))+2.d0)*fun2b
      temp186b7 = distp(0, 1)*funb
      dd1b = r(0)*temp186b3 - 4.d0*r(0)*temp186b2 - r(0)**2*temp186b7
      temp186b8 = dd3*distp(0, 2)*funb
      rb(0) = rb(0) + (2.d0-dd1*2*r(0))*temp186b7 + (2.d0-dd2*2*r(0))*&
&        temp186b8 - 4.d0*dd2*temp186b4 + dd2*temp186b5 - 4.d0*dd1*&
&        temp186b2 + dd1*temp186b3
      distpb(0, 1) = ((dd1*r(0))**2-4.d0*(dd1*r(0))+2.d0)*fun2b
      dd2b = r(0)*temp186b5 - 4.d0*r(0)*temp186b4 - r(0)**2*temp186b8
      temp186b9 = (2.d0*r(0)-dd2*r(0)**2)*funb
      dd3b = distp(0, 2)*temp186b9 + distp(0, 2)*temp186b6
      distpb(0, 2) = dd3*temp186b6
      distpb(0, 1) = distpb(0, 1) + (2.d0*r(0)-dd1*r(0)**2)*funb
      distpb(0, 2) = distpb(0, 2) + dd3*temp186b9
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      temp186b1 = r(i)**2*distpb(i, 3)
      rb(i) = rb(i) + (distp(i, 1)+dd3*distp(i, 2))*2*r(i)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + temp186b1
      dd3b = dd3b + distp(i, 2)*temp186b1
      distpb(i, 2) = distpb(i, 2) + dd3*temp186b1
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp186b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp186b
      distpb(k, 2) = 0.0_8
      temp186b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp186b0 - dd2*temp186b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp186b0
      distpb(k, 1) = 0.0_8
    END DO
    temp185 = 2.d0**9
    temp184 = temp185*dd2**9
    temp183 = dd3**2/temp184
    temp182 = (dd1+dd2)**9
    temp181 = 2.d0**9
    temp180 = temp181*dd1**9
    temp179 = 120960.d0*pi*(1.0/temp180+2.d0*dd3/temp182+temp183)
    temp178 = DSQRT(temp179)
    IF (temp179 .EQ. 0.0) THEN
      temp178b0 = 0.0
    ELSE
      temp178b0 = -(pi*120960.d0*cb/(2.d0*temp178**2*2.D0*DSQRT(temp179)&
&        ))
    END IF
    temp178b1 = 2.d0*temp178b0/temp182
    temp178b2 = -(dd3*9*(dd1+dd2)**8*temp178b1/temp182)
    dd1b = dd1b + temp178b2 - temp181*9*dd1**8*temp178b0/temp180**2
    dd3b = dd3b + 2*dd3*temp178b0/temp184 + temp178b1
    dd2b = dd2b + temp178b2 - temp183*temp185*9*dd2**8*temp178b0/temp184
    ddb(indpar+3) = ddb(indpar+3) + dd3b
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (26) 
! 2p triple zeta                                     
!     2p without cusp condition                                         
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
    dd3 = dd(indpar+4)
    peff2 = dd(indpar+5)
!        if(iflagnorm.gt.2) then 
    c = 1.d0/2.d0/DSQRT(8.d0*pi*(1.d0/(2.d0*dd1)**5+2.d0*peff/(dd1+dd2)&
&      **5+peff**2/(2.d0*dd2)**5+2.d0*peff2/(dd1+dd3)**5+peff2**2/(2.d0*&
&      dd3)**5+2.d0*peff2*peff/(dd2+dd3)**5))
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
      distp(k, 3) = c*DEXP(-(dd3*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = distp(i, 1) + peff*distp(i, 2) + peff2*distp(i, 3)
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = (-(dd1*distp(0, 1))-dd2*peff*distp(0, 2)-dd3*peff2*distp(0, &
&        3))/r(0)
      fun2 = dd1**2*distp(0, 1) + peff*dd2**2*distp(0, 2) + peff2*dd3**2&
&        *distp(0, 3)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp202b6 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp202b6
        fun2b = fun2b + temp202b6
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) distpb(0, 4) = distpb(0, 4) + zb(&
&              indorbp, indt+i)
          temp202b5 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp202b5
          funb = funb + rmu(ic, 0)*temp202b5
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp202b2 = dd2**2*fun2b
      temp202b3 = dd3**2*fun2b
      temp202b4 = funb/r(0)
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*temp202b4
      distpb(0, 1) = distpb(0, 1) + dd1**2*fun2b
      dd2b = peff*distp(0, 2)*2*dd2*fun2b - distp(0, 2)*peff*temp202b4
      peffb = distp(0, 2)*temp202b2 - distp(0, 2)*dd2*temp202b4
      distpb(0, 2) = distpb(0, 2) + peff*temp202b2
      dd3b = peff2*distp(0, 3)*2*dd3*fun2b - distp(0, 3)*peff2*temp202b4
      peff2b = distp(0, 3)*temp202b3 - distp(0, 3)*dd3*temp202b4
      distpb(0, 3) = distpb(0, 3) + peff2*temp202b3
      distpb(0, 1) = distpb(0, 1) - dd1*temp202b4
      distpb(0, 2) = distpb(0, 2) - dd2*peff*temp202b4
      distpb(0, 3) = distpb(0, 3) - dd3*peff2*temp202b4
      rb(0) = rb(0) - (-(dd1*distp(0, 1))-dd2*peff*distp(0, 2)-dd3*peff2&
&        *distp(0, 3))*temp202b4/r(0)
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      peff2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 4)*zb(indorbp, i)
        distpb(i, 4) = distpb(i, 4) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distpb(i, 1) = distpb(i, 1) + distpb(i, 4)
      peffb = peffb + distp(i, 2)*distpb(i, 4)
      distpb(i, 2) = distpb(i, 2) + peff*distpb(i, 4)
      peff2b = peff2b + distp(i, 3)*distpb(i, 4)
      distpb(i, 3) = distpb(i, 3) + peff2*distpb(i, 4)
      distpb(i, 4) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp202b = c*DEXP(-(dd3*r(k)))*distpb(k, 3)
      cb = cb + DEXP(-(dd3*r(k)))*distpb(k, 3)
      dd3b = dd3b - r(k)*temp202b
      distpb(k, 3) = 0.0_8
      temp202b0 = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      temp202b1 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp202b0 - dd1*temp202b1 - dd3*temp202b
      dd2b = dd2b - r(k)*temp202b0
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp202b1
      distpb(k, 1) = 0.0_8
    END DO
    temp201 = (dd2+dd3)**5
    temp188 = peff2*peff/temp201
    temp200 = 2.d0**5
    temp199 = temp200*dd3**5
    temp198 = peff2**2/temp199
    temp197 = (dd1+dd3)**5
    temp196 = 2.d0**5
    temp195 = temp196*dd2**5
    temp194 = peff**2/temp195
    temp193 = (dd1+dd2)**5
    temp192 = 2.d0**5
    temp191 = temp192*dd1**5
    temp190 = 8.d0*pi*(1.0/temp191+2.d0*peff/temp193+temp194+2.d0*peff2/&
&      temp197+temp198+2.d0*temp188)
    temp189 = DSQRT(temp190)
    IF (temp190 .EQ. 0.0) THEN
      temp189b = 0.0
    ELSE
      temp189b = -(pi*8.d0*cb/(2.d0*temp189**2*2.D0*DSQRT(temp190)))
    END IF
    temp189b0 = 2.d0*temp189b/temp193
    temp189b1 = -(peff*5*(dd1+dd2)**4*temp189b0/temp193)
    temp189b2 = 2.d0*temp189b/temp197
    temp189b3 = -(peff2*5*(dd1+dd3)**4*temp189b2/temp197)
    temp188b0 = 2.d0*temp189b/temp201
    temp188b1 = -(temp188*5*(dd2+dd3)**4*temp188b0)
    dd1b = dd1b + temp189b3 + temp189b1 - temp192*5*dd1**4*temp189b/&
&      temp191**2
    peffb = peffb + peff2*temp188b0 + 2*peff*temp189b/temp195 + &
&      temp189b0
    dd2b = dd2b + temp188b1 - temp194*temp196*5*dd2**4*temp189b/temp195 &
&      + temp189b1
    peff2b = peff2b + peff*temp188b0 + 2*peff2*temp189b/temp199 + &
&      temp189b2
    dd3b = dd3b + temp188b1 - temp198*temp200*5*dd3**4*temp189b/temp199 &
&      + temp189b3
    ddb(indpar+5) = ddb(indpar+5) + peff2b
    ddb(indpar+4) = ddb(indpar+4) + dd3b
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (27) 
! 3p triple zeta                                     
!     2p without cusp condition                                         
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
    dd3 = dd(indpar+4)
    peff2 = dd(indpar+5)
!        if(iflagnorm.gt.2) then 
    c = 1.d0/2.d0/DSQRT(240.d0*pi*(1.d0/(2.d0*dd1)**7+2.d0*peff/(dd1+dd2&
&      )**7+peff**2/(2.d0*dd2)**7+2.d0*peff2/(dd1+dd3)**7+peff2**2/(2.d0*&
&      dd3)**7+2.d0*peff2*peff/(dd2+dd3)**7))
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
      distp(k, 3) = c*DEXP(-(dd3*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = r(i)*(distp(i, 1)+peff*distp(i, 2)+peff2*distp(i, 3)&
&        )
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = (1.d0-dd1*r(0))*distp(0, 1) + peff*(1.d0-dd2*r(0))*distp(0, &
&        2) + peff2*(1.d0-dd3*r(0))*distp(0, 3)
      fun2 = dd1*(dd1*r(0)-2.d0)*distp(0, 1) + peff*dd2*(dd2*r(0)-2.d0)*&
&        distp(0, 2) + peff2*dd3*(dd3*r(0)-2.d0)*distp(0, 3)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp217 = fun/r(0)
        temp218b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp217b = 4.d0*temp218b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp217+fun2)*zb(indorbp, indt&
&          +4)
        funb = funb + temp217b
        rb(0) = rb(0) - temp217*temp217b
        fun2b = fun2b + temp218b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp216 = fun/r(0)
          temp216b13 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp216*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp216*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb = funb + temp216b13
          rb(0) = rb(0) - temp216*temp216b13
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp216b3 = dd1*distp(0, 1)*fun2b
      temp216b4 = (dd1*r(0)-2.d0)*fun2b
      temp216b5 = (dd2*r(0)-2.d0)*fun2b
      temp216b6 = peff*dd2*distp(0, 2)*fun2b
      temp216b7 = (dd3*r(0)-2.d0)*fun2b
      temp216b8 = peff2*dd3*distp(0, 3)*fun2b
      dd1b = distp(0, 1)*temp216b4 - distp(0, 1)*r(0)*funb + r(0)*&
&        temp216b3
      temp216b9 = peff*distp(0, 2)*funb
      temp216b10 = peff2*distp(0, 3)*funb
      rb(0) = rb(0) + dd3*temp216b8 - dd2*temp216b9 - dd3*temp216b10 - &
&        distp(0, 1)*dd1*funb + dd2*temp216b6 + dd1*temp216b3
      distpb(0, 1) = dd1*temp216b4
      temp216b11 = (1.d0-dd2*r(0))*funb
      peffb = distp(0, 2)*temp216b11 + distp(0, 2)*dd2*temp216b5
      dd2b = r(0)*temp216b6 - r(0)*temp216b9 + distp(0, 2)*peff*&
&        temp216b5
      distpb(0, 2) = peff*dd2*temp216b5
      temp216b12 = (1.d0-dd3*r(0))*funb
      peff2b = distp(0, 3)*temp216b12 + distp(0, 3)*dd3*temp216b7
      dd3b = r(0)*temp216b8 - r(0)*temp216b10 + distp(0, 3)*peff2*&
&        temp216b7
      distpb(0, 3) = peff2*dd3*temp216b7
      distpb(0, 1) = distpb(0, 1) + (1.d0-dd1*r(0))*funb
      distpb(0, 2) = distpb(0, 2) + peff*temp216b11
      distpb(0, 3) = distpb(0, 3) + peff2*temp216b12
      distpb(0, 4) = distpb(0, 4) + fun0b
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      peff2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 4)*zb(indorbp, i)
        distpb(i, 4) = distpb(i, 4) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      temp216b2 = r(i)*distpb(i, 4)
      rb(i) = rb(i) + (distp(i, 1)+peff*distp(i, 2)+peff2*distp(i, 3))*&
&        distpb(i, 4)
      distpb(i, 1) = distpb(i, 1) + temp216b2
      peffb = peffb + distp(i, 2)*temp216b2
      distpb(i, 2) = distpb(i, 2) + peff*temp216b2
      peff2b = peff2b + distp(i, 3)*temp216b2
      distpb(i, 3) = distpb(i, 3) + peff2*temp216b2
      distpb(i, 4) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp216b = c*DEXP(-(dd3*r(k)))*distpb(k, 3)
      cb = cb + DEXP(-(dd3*r(k)))*distpb(k, 3)
      dd3b = dd3b - r(k)*temp216b
      distpb(k, 3) = 0.0_8
      temp216b0 = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      temp216b1 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp216b0 - dd1*temp216b1 - dd3*temp216b
      dd2b = dd2b - r(k)*temp216b0
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp216b1
      distpb(k, 1) = 0.0_8
    END DO
    temp215 = (dd2+dd3)**7
    temp202 = peff2*peff/temp215
    temp214 = 2.d0**7
    temp213 = temp214*dd3**7
    temp212 = peff2**2/temp213
    temp211 = (dd1+dd3)**7
    temp210 = 2.d0**7
    temp209 = temp210*dd2**7
    temp208 = peff**2/temp209
    temp207 = (dd1+dd2)**7
    temp206 = 2.d0**7
    temp205 = temp206*dd1**7
    temp204 = 240.d0*pi*(1.0/temp205+2.d0*peff/temp207+temp208+2.d0*&
&      peff2/temp211+temp212+2.d0*temp202)
    temp203 = DSQRT(temp204)
    IF (temp204 .EQ. 0.0) THEN
      temp203b = 0.0
    ELSE
      temp203b = -(pi*240.d0*cb/(2.d0*temp203**2*2.D0*DSQRT(temp204)))
    END IF
    temp203b0 = 2.d0*temp203b/temp207
    temp203b1 = -(peff*7*(dd1+dd2)**6*temp203b0/temp207)
    temp203b2 = 2.d0*temp203b/temp211
    temp203b3 = -(peff2*7*(dd1+dd3)**6*temp203b2/temp211)
    temp202b7 = 2.d0*temp203b/temp215
    temp202b8 = -(temp202*7*(dd2+dd3)**6*temp202b7)
    dd1b = dd1b + temp203b3 + temp203b1 - temp206*7*dd1**6*temp203b/&
&      temp205**2
    peffb = peffb + peff2*temp202b7 + 2*peff*temp203b/temp209 + &
&      temp203b0
    dd2b = dd2b + temp202b8 - temp208*temp210*7*dd2**6*temp203b/temp209 &
&      + temp203b1
    peff2b = peff2b + peff*temp202b7 + 2*peff2*temp203b/temp213 + &
&      temp203b2
    dd3b = dd3b + temp202b8 - temp212*temp214*7*dd3**6*temp203b/temp213 &
&      + temp203b3
    ddb(indpar+5) = ddb(indpar+5) + peff2b
    ddb(indpar+4) = ddb(indpar+4) + dd3b
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (28) 
! R(r)=(Z*b*r)^4/(1+(Z*b*r)^4)*exp(-z*r)     orbital 1s (no cusp)                                    
! d -> b1s (defined in module constants)
! normadization: cost1s, depends on b1s
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!             if(dd1.gt.0.) then 
    c = cost1s*dd1**1.5d0
!             else 
!               c=1.d0 
!             endif 
!           endif 
    DO i=indtmin,indtm
      distp(i, 1) = c*DEXP(-(dd1*r(i)))
    END DO
    DO i=i0,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = (dd1*b1s*r(i))**4
    END DO
    IF (typec .NE. 1) THEN
      rp1 = dd1*b1s*r(0)
      rp2 = rp1**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = rp2**2
      rp5 = r(0)*dd1
      rp6 = (b1s*dd1)**2*rp2
!              the first derivative /r                                  
      fun = -(distp(0, 1)*rp6*(-4.d0+rp5+rp4*rp5)/(1.d0+rp4)**2)
!              the second derivative derivative                                 
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp222 = (rp4+1.d0)**3
      temp221 = distp(0, 1)*rp6/temp222
      temp222b = temp221*fun2b
      temp222b0 = 2*rp4*rp5*temp222b
      temp221b = (rp5**2-8*rp5-20*rp4+2*(rp4*rp5**2)-8*(rp4*rp5)+(rp4*&
&        rp5)**2+12.d0)*fun2b/temp222
      temp220 = (rp4+1.d0)**2
      temp219 = distp(0, 1)*rp6/temp220
      temp219b = -(temp219*funb)
      rp5b = (rp4+1.0_8)*temp219b + rp4*temp222b0 + (2**2*rp4*rp5-8*rp4+&
&        2*rp5-8)*temp222b
      temp219b0 = -((rp5+rp4*rp5-4.d0)*funb/temp220)
      rp4b = rp5*temp219b - temp219*2*(rp4+1.d0)*temp219b0 - temp221*3*(&
&        rp4+1.d0)**2*temp221b + rp5*temp222b0 + (2*rp5**2-8*rp5-20)*&
&        temp222b
      distpb(0, 1) = rp6*temp219b0 + rp6*temp221b
      rp6b = distp(0, 1)*temp219b0 + distp(0, 1)*temp221b
      temp219b1 = b1s**2*rp6b
      rp2b = 2*rp2*rp4b + dd1**2*temp219b1
      rp1b = 2*rp1*rp2b
      dd1b = r(0)*rp5b + b1s*r(0)*rp1b + rp2*2*dd1*temp219b1
      rb(0) = rb(0) + b1s*dd1*rp1b + dd1*rp5b
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp218 = rp4/(rp4+1.d0)
      temp218b1 = distp(i, 1)*zb(indorbp, i)/(rp4+1.d0)
      distpb(i, 1) = distpb(i, 1) + temp218*zb(indorbp, i)
      rp4b = (1.0_8-temp218)*temp218b1
      zb(indorbp, i) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      temp218b2 = 4*b1s**4*dd1**3*r(i)**3*rp4b
      dd1b = dd1b + r(i)*temp218b2
      rb(i) = rb(i) + dd1*temp218b2
    END DO
    cb = 0.0_8
    DO i=indtm,indtmin,-1
      temp218b0 = c*DEXP(-(dd1*r(i)))*distpb(i, 1)
      cb = cb + DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp218b0
      rb(i) = rb(i) - dd1*temp218b0
      distpb(i, 1) = 0.0_8
    END DO
    dd1b = dd1b + cost1s*1.5d0*dd1**0.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (29) 
! derivative of (28)                                       
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!             if(dd1.gt.0.) then 
    c = cost1s*dd1**1.5d0
!             else 
!               c=1.d0 
!             endif 
!           endif 
!             if(dd1.gt.0.) then 
    c1 = 1.5d0/dd1
!             else
!               c1=0.d0
!             endif
    DO i=indtmin,indtm
      distp(i, 1) = c*DEXP(-(dd1*r(i)))
    END DO
    DO i=i0,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
!              rp1=(b1s*r(i))**4*dd1**3
!              rp4=rp1*dd1
!              rp5=dd1*r(i)
!              z(indorbp,i)=distp(i,1)*&
!                 &(c1*rp4/(1+rp4)-rp1*(-4+rp5+rp4*rp5)/(1+rp4)**2)
      rp4 = (b1s*dd1*r(i))**4
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp5)
      rp5 = dd1*r(i)
    END DO
    IF (typec .NE. 1) THEN
      rp1 = dd1*b1s*r(0)
      rp2 = rp1**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = rp2**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp5)
      rp5 = rp4*rp1
      rp8 = rp4*rp4
      fun = distp(0, 1)*(dd1*rp2*(4*b1s**2*(11-5*rp4)+2*(rp1+rp5)**2-b1s&
&        *rp1*(21+26*rp4+5*rp8)))/(2.*(1+rp4)**3)
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp236 = 2.*b1s*(rp4+1)**4
      temp235 = distp(0, 1)*dd1*rp2
      temp232 = temp235/temp236
      temp235b = temp232*fun2b
      temp235b0 = b1s*(7*rp4+31)*2*(rp1+rp5)*temp235b
      temp235b1 = -(2*3*(rp1+rp5)**2*temp235b)
      temp234 = 64*b1s**2
      temp234b = temp234*temp235b
      temp233 = 4*b1s**3
      temp232b = (b1s*((7*rp4+31)*(rp1+rp5)**2)-2*(rp1+rp5)**3+temp234*(&
&        rp1*(rp8-rp4-2))+temp233*(25*rp8-134*rp4+33))*fun2b/temp236
      temp231 = 2.*(rp4+1)**3
      temp230 = distp(0, 1)*dd1*rp2
      temp227 = temp230/temp231
      temp230b = temp227*funb
      temp229b = 2**2*(rp1+rp5)*temp230b
      rp5b = temp229b + temp235b1 + temp235b0
      temp228b = -(b1s*temp230b)
      rp8b = rp1*5*temp228b + temp233*25*temp235b + rp1*temp234b
      temp229 = 4*b1s**2
      temp228 = 26*rp4 + 5*rp8 + 21
      temp227b0 = (temp229*(11-5*rp4)+2*(rp1+rp5)**2-b1s*(rp1*temp228))*&
&        funb/temp231
      rp4b = rp1*26*temp228b - temp229*5*temp230b - temp227*2.*3*(rp4+1)&
&        **2*temp227b0 + rp1*rp5b + 2*rp4*rp8b - temp232*2.*b1s*4*(rp4+1)&
&        **3*temp232b - rp1*temp234b + (7*(b1s*(rp1+rp5)**2)-134*temp233)&
&        *temp235b
      rp2b = distp(0, 1)*dd1*temp227b0 + 2*rp2*rp4b + distp(0, 1)*dd1*&
&        temp232b
      rp1b = temp229b + temp228*temp228b + 2*rp1*rp2b + rp4*rp5b + (rp8-&
&        rp4-2)*temp234b + temp235b1 + temp235b0
      distpb(0, 1) = dd1*rp2*temp227b0 + dd1*rp2*temp232b
      dd1b = distp(0, 1)*rp2*temp227b0 + b1s*r(0)*rp1b + distp(0, 1)*rp2&
&        *temp232b
      CALL POPREAL8(adr8ibuf,adr8buf,rp5)
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      rb(0) = rb(0) + b1s*dd1*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    c1b = 0.0_8
    DO i=indtm,i0,-1
      temp223 = rp4/(rp4+1)
      temp227b = distp(i, 1)*temp223*zb(indorbp, i)
      temp224 = dd1*(rp4+1)
      temp225b = -(temp227b/temp224)
      temp226 = rp5 + rp4*rp5 - 4
      temp225 = temp226/temp224
      temp224b = -(temp225*temp225b)
      temp223b0 = (c1-temp225)*distp(i, 1)*zb(indorbp, i)/(rp4+1)
      c1b = c1b + temp227b
      rp5b = (rp4+1.0_8)*temp225b
      rp4b = (1.0_8-temp223)*temp223b0 + dd1*temp224b + rp5*temp225b
      temp223b1 = 4*b1s**4*dd1**3*r(i)**3*rp4b
      dd1b = dd1b + r(i)*rp5b + r(i)*temp223b1 + (rp4+1)*temp224b
      distpb(i, 1) = distpb(i, 1) + (c1-temp225)*temp223*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp5)
      rb(i) = rb(i) + dd1*temp223b1 + dd1*rp5b
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
    END DO
    cb = 0.0_8
    DO i=indtm,indtmin,-1
      temp223b = c*DEXP(-(dd1*r(i)))*distpb(i, 1)
      cb = cb + DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp223b
      rb(i) = rb(i) - dd1*temp223b
      distpb(i, 1) = 0.0_8
    END DO
    dd1b = dd1b + cost1s*1.5d0*dd1**0.5D0*cb - 1.5d0*c1b/dd1**2
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (57) 
!     orbital 1s (no cusp) - STO regolarized for r->0                            
! R(r)= C(z) * P(z*r) * exp(-z*r)  
!     P(x) = (x+a)^n/(1+(x+a)^n)    with a so that P(0)==dP(0)/dx
!     C(z) = const * z^(3/2)       normalization
! the following definitions are in module constants 
!     n         -> costSTO1s_n = 4 
!     a         -> costSTO1s_a = 1.2263393530877080588 
!     const(n)  -> costSTO1s_c = 0.58542132302621750732
!     
!     
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!             if(dd1.gt.0.) then 
    c = coststo1s_c*dd1**1.5d0
!             else 
!               c=1.d0 
!             endif 
!           endif 
    DO i=indtmin,indtm
      distp(i, 1) = c*DEXP(-(dd1*r(i)))
    END DO
    DO i=i0,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = (dd1*r(i)+coststo1s_a)**coststo1s_n
    END DO
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0) + coststo1s_a
      rp2 = rp1**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = rp1**coststo1s_n
!              the first derivative /r                                  
!fun=-z(indorbp,0)*((dd1**2*(-costSTO1s_n+rp1+rp1*rp4))/&
!   &(rp1*(-costSTO1s_a+rp1)*(1.d0+rp4)))
      fun = -(distp(0, 1)*rp4*(dd1**2*(-coststo1s_n+rp1+rp1*rp4)/(rp1*(-&
&        coststo1s_a+rp1)*(1.d0+rp4)**2)))
!              the second derivative derivative                                 
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp245 = (rp4+1.d0)**3
      temp242 = rp2*temp245
      temp243b = (rp2*(rp4+1.d0)**2-coststo1s_n*((2.d0*rp1+1.d0)*(rp4+&
&        1.d0))-coststo1s_n**2*(rp4-1.d0))*fun2b/temp242
      temp245b = dd1**2*temp243b
      temp244 = distp(0, 1)*rp4*dd1**2
      temp243 = temp244/temp242
      temp242b = -(temp243*temp243b)
      temp242b0 = temp243*fun2b
      temp241 = (rp4+1.d0)**2
      temp238 = rp1*(rp1-coststo1s_a)*temp241
      temp241b = -(funb/temp238)
      temp239 = rp1 - coststo1s_n + rp1*rp4
      temp240b = temp239*temp241b
      temp241b0 = dd1**2*temp240b
      distpb(0, 1) = rp4*temp241b0 + rp4*temp245b
      temp240 = distp(0, 1)*rp4*dd1**2
      temp239b = temp240*temp241b
      temp238b = -(temp240*temp239*temp241b/temp238)
      rp4b = distp(0, 1)*temp241b0 + rp1*temp239b + rp1*(rp1-coststo1s_a&
&        )*2*(rp4+1.d0)*temp238b + (rp2*2*(rp4+1.d0)-coststo1s_n*(2.d0*&
&        rp1+1.d0)-coststo1s_n**2)*temp242b0 + rp2*3*(rp4+1.d0)**2*&
&        temp242b + distp(0, 1)*temp245b
      rp2b = (rp4+1.d0)**2*temp242b0 + temp245*temp242b
      IF (rp1 .LE. 0.0 .AND. (coststo1s_n .EQ. 0.0 .OR. coststo1s_n .NE.&
&          INT(coststo1s_n))) THEN
        rp1b = (rp4+1.0_8)*temp239b + (temp241*rp1+temp241*(rp1-&
&          coststo1s_a))*temp238b + 2*rp1*rp2b - coststo1s_n*(rp4+1.d0)*&
&          2.d0*temp242b0
      ELSE
        rp1b = (rp4+1.0_8)*temp239b + (temp241*rp1+temp241*(rp1-&
&          coststo1s_a))*temp238b + 2*rp1*rp2b + coststo1s_n*rp1**(&
&          coststo1s_n-1)*rp4b - coststo1s_n*(rp4+1.d0)*2.d0*temp242b0
      END IF
      dd1b = distp(0, 1)*rp4*2*dd1*temp240b + r(0)*rp1b + distp(0, 1)*&
&        rp4*2*dd1*temp243b
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      rb(0) = rb(0) + dd1*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp237 = rp4/(rp4+1.d0)
      temp237b0 = distp(i, 1)*zb(indorbp, i)/(rp4+1.d0)
      distpb(i, 1) = distpb(i, 1) + temp237*zb(indorbp, i)
      rp4b = (1.0_8-temp237)*temp237b0
      zb(indorbp, i) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      IF (coststo1s_a + dd1*r(i) .LE. 0.0 .AND. (coststo1s_n .EQ. 0.0 &
&          .OR. coststo1s_n .NE. INT(coststo1s_n))) THEN
        temp237b1 = 0.0
      ELSE
        temp237b1 = coststo1s_n*(coststo1s_a+dd1*r(i))**(coststo1s_n-1)*&
&          rp4b
      END IF
      dd1b = dd1b + r(i)*temp237b1
      rb(i) = rb(i) + dd1*temp237b1
    END DO
    cb = 0.0_8
    DO i=indtm,indtmin,-1
      temp237b = c*DEXP(-(dd1*r(i)))*distpb(i, 1)
      cb = cb + DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp237b
      rb(i) = rb(i) - dd1*temp237b
      distpb(i, 1) = 0.0_8
    END DO
    dd1b = dd1b + coststo1s_c*1.5d0*dd1**0.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (66) 
!     derivative of 57 (orbital 1s STO regolarized for r->0) 
!  dR(r)/dz    with    R(r)= C(z) * P(z*r) * exp(-z*r)  
!     P(x) = (x+a)^n/(1+(x+a)^n)    with a so that P(0)==dP(0)/dx
!     C(z) = const * z^(3/2)       normalization
! the following definitions are in module constants 
!     n         -> costSTO1s_n = 4 
!     a         -> costSTO1s_a = 1.2263393530877080588 
!     const(n)  -> costSTO1s_c = 0.58542132302621750732
!     
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!             if(dd1.gt.0.) then 
    c = coststo1s_c*dd1**1.5d0
!             else 
!               c=1.d0 
!             endif 
!           endif 
    DO i=indtmin,indtm
      distp(i, 1) = c*DEXP(-(dd1*r(i)))
    END DO
    DO i=i0,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
      rp1 = dd1*r(i) + coststo1s_a
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = rp1**coststo1s_n
    END DO
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
      rp1 = dd1*r(0) + coststo1s_a
      rp2 = rp1**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = rp1**coststo1s_n
      rp6 = rp4**2
!              the first derivative /r                                  
      fun = distp(0, 1)*(dd1*rp4*(-(2.d0*coststo1s_a*(coststo1s_n**2*(-&
&        1.d0+rp4)+coststo1s_n*(1.d0+2.d0*rp1)*(1.d0+rp4)-rp2*(1.d0+rp4)&
&        **2))+rp1*(2*coststo1s_n**2*(-1+rp4)+coststo1s_n*(-3.d0+4.d0*rp1&
&        )*(1.d0+rp4)-rp1*(-5.d0+2.d0*rp1)*(1.d0+rp4)**2)))/(2.d0*rp2*(&
&        coststo1s_a-rp1)*(1.d0+rp4)**3)
!              fun=+distp(0,1)*rp4/(1.d0+rp4)*(1.5d0/dd1 + r(0)*   &
!               &(-1.d0+(costSTO1s_n)/(rp1*(1.d0+rp4))))               &
!               & *(dd1*(2.d0 + 5.d0/(-dd1*r(0)) +                 &
!               &(4.d0*costSTO1s_n**2)/(rp2*(1.d0+rp4)**2) +           &
!               &(costSTO1s_n*((3.d0 - 2.d0*costSTO1s_n - 4.d0*rp1)*rp1&
!               & + 2.d0*costSTO1s_a*(1.d0+costSTO1s_n+2.d0*rp1)))/    &
!               &(rp2*(dd1*r(0))*(1 + rp4))))/2.d0
!              the second derivative derivative                                 
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp270 = (rp4+1)**4
      temp257 = 2.d0*rp1*rp2
      temp258 = temp257*temp270
      temp269 = distp(0, 1)*dd1*rp4
      temp259 = temp269/temp258
      temp269b = -(temp259*fun2b)
      temp268 = coststo1s_n**3
      temp264 = 6.d0*rp2 - 8.d0*rp1 - 3.d0
      temp267 = (rp4+1.d0)**3
      temp266 = rp2*(2.d0*rp1-7.d0)
      temp265 = temp266*temp267 - coststo1s_n*temp264*(rp4+1.d0)**2 - &
&        coststo1s_n**2*(6.d0*rp1-1.d0)*(rp6-1.d0) - 2*temp268*(rp4*(rp4-&
&        4.d0)+1.d0)
      temp265b = rp1*temp269b
      temp264b = -(coststo1s_n*(rp4+1.d0)**2*temp265b)
      temp264b0 = -(coststo1s_n**2*temp265b)
      temp264b1 = -(temp268*2*temp265b)
      temp263 = coststo1s_n**3
      temp262 = 3.d0*rp1*(rp1+1.d0) + 2.d0
      temp261 = (rp4+1.d0)**3
      temp260 = 3.d0*coststo1s_n**2
      temp260b = coststo1s_a*2.d0*temp269b
      temp260b0 = coststo1s_n*(rp4+1.d0)**2*3.d0*temp260b
      temp259b = -((rp1*temp265+coststo1s_a*2.d0*(temp260*((rp1+1.d0)*(&
&        rp6-1.d0))-rp1*rp2*temp261+coststo1s_n*((rp4+1.d0)**2*temp262)+&
&        temp263*(rp4*(rp4-4.d0)+1.d0)))*fun2b/temp258)
      temp258b = -(temp259*temp259b)
      temp257b = temp270*temp258b
      temp256 = (rp4+1.d0)**3
      temp249 = 2.d0*rp2*(coststo1s_a-rp1)
      temp250 = temp249*temp256
      temp255 = distp(0, 1)*dd1*rp4
      temp251 = temp255/temp250
      temp255b = temp251*funb
      temp254 = (rp4+1.d0)**2
      temp253 = rp1*(2.d0*rp1-5.d0)
      temp252 = 2*coststo1s_n**2*(rp4-1) + coststo1s_n*(4.d0*rp1-3.d0)*(&
&        rp4+1.d0) - temp253*temp254
      temp252b = -(coststo1s_a*2.d0*temp255b)
      temp251b = (rp1*temp252-coststo1s_a*2.d0*(coststo1s_n**2*(rp4-1.d0&
&        )+coststo1s_n*((2.d0*rp1+1.d0)*(rp4+1.d0))-rp2*(rp4+1.d0)**2))*&
&        funb/temp250
      temp250b = -(temp251*temp251b)
      temp249b0 = temp256*temp250b
      rp2b = (coststo1s_a-rp1)*2.d0*temp249b0 - (rp4+1.d0)**2*temp252b +&
&        2.d0*rp1*temp257b - temp261*rp1*temp260b + 6.d0*temp264b + &
&        temp267*(2.d0*rp1-7.d0)*temp265b
      rp6b = temp260*(rp1+1.d0)*temp260b + (6.d0*rp1-1.d0)*temp264b0
      temp252b0 = rp1*temp255b
      rp4b = (coststo1s_n*(4.d0*rp1-3.d0)-temp253*2*(rp4+1.d0)+2*&
&        coststo1s_n**2)*temp252b0 + (coststo1s_n*(2.d0*rp1+1.d0)-rp2*2*(&
&        rp4+1.d0)+coststo1s_n**2)*temp252b + distp(0, 1)*dd1*temp251b + &
&        temp249*3*(rp4+1.d0)**2*temp250b + 2*rp4*rp6b + temp257*4*(rp4+1&
&        )**3*temp258b + distp(0, 1)*dd1*temp259b + (temp263*rp4+temp263*&
&        (rp4-4.d0)+coststo1s_n*temp262*2*(rp4+1.d0)-rp1*rp2*3*(rp4+1.d0)&
&        **2)*temp260b + (2*rp4-4.d0)*temp264b1 + (temp266*3*(rp4+1.d0)**&
&        2-coststo1s_n*temp264*2*(rp4+1.d0))*temp265b
      IF (rp1 .LE. 0.0 .AND. (coststo1s_n .EQ. 0.0 .OR. coststo1s_n .NE.&
&          INT(coststo1s_n))) THEN
        rp1b = temp252*temp255b + (coststo1s_n*(rp4+1.d0)*4.d0-temp254*(&
&          2.d0*rp1-5.d0)-temp254*rp1*2.d0)*temp252b0 + coststo1s_n*(rp4+&
&          1.d0)*2.d0*temp252b - 2.d0*rp2*temp249b0 + 2*rp1*rp2b + rp2*&
&          2.d0*temp257b + (2*rp1+1.d0)*temp260b0 + (temp260*(rp6-1.d0)-&
&          temp261*rp2)*temp260b + (rp6-1.d0)*6.d0*temp264b0 - 8.d0*&
&          temp264b + temp267*rp2*2.d0*temp265b + temp265*temp269b
      ELSE
        rp1b = temp252*temp255b + (coststo1s_n*(rp4+1.d0)*4.d0-temp254*(&
&          2.d0*rp1-5.d0)-temp254*rp1*2.d0)*temp252b0 + coststo1s_n*(rp4+&
&          1.d0)*2.d0*temp252b - 2.d0*rp2*temp249b0 + 2*rp1*rp2b + &
&          coststo1s_n*rp1**(coststo1s_n-1)*rp4b + rp2*2.d0*temp257b + (2&
&          *rp1+1.d0)*temp260b0 + (temp260*(rp6-1.d0)-temp261*rp2)*&
&          temp260b + (rp6-1.d0)*6.d0*temp264b0 - 8.d0*temp264b + temp267&
&          *rp2*2.d0*temp265b + temp265*temp269b
      END IF
      distpb(0, 1) = dd1*rp4*temp251b + dd1*rp4*temp259b
      dd1b = distp(0, 1)*rp4*temp251b + r(0)*rp1b + distp(0, 1)*rp4*&
&        temp259b
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      CALL POPREAL8(adr8ibuf,adr8buf,rp1)
      rb(0) = rb(0) + dd1*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp246 = rp4/(rp4+1.d0)
      temp249b = distp(i, 1)*temp246*zb(indorbp, i)
      temp247 = rp1*(rp4+1.d0)
      temp248 = coststo1s_n/temp247
      temp247b = -(r(i)*temp248*temp249b/temp247)
      temp247b0 = (1.5d0/dd1+r(i)*(temp248-1.d0))*zb(indorbp, i)
      temp246b0 = distp(i, 1)*temp247b0/(rp4+1.d0)
      rp4b = (1.0_8-temp246)*temp246b0 + rp1*temp247b
      IF (rp1 .LE. 0.0 .AND. (coststo1s_n .EQ. 0.0 .OR. coststo1s_n .NE.&
&          INT(coststo1s_n))) THEN
        rp1b = (rp4+1.d0)*temp247b
      ELSE
        rp1b = coststo1s_n*rp1**(coststo1s_n-1)*rp4b + (rp4+1.d0)*&
&          temp247b
      END IF
      dd1b = dd1b + r(i)*rp1b - 1.5d0*temp249b/dd1**2
      rb(i) = rb(i) + dd1*rp1b + (temp248-1.d0)*temp249b
      distpb(i, 1) = distpb(i, 1) + temp246*temp247b0
      zb(indorbp, i) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      CALL POPREAL8(adr8ibuf,adr8buf,rp1)
    END DO
    cb = 0.0_8
    DO i=indtm,indtmin,-1
      temp246b = c*DEXP(-(dd1*r(i)))*distpb(i, 1)
      cb = cb + DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp246b
      rb(i) = rb(i) - dd1*temp246b
      distpb(i, 1) = 0.0_8
    END DO
    dd1b = dd1b + coststo1s_c*1.5d0*dd1**0.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (30) 
!     3d without cusp and one parmater                                  
    dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then 
!     c=                                                                &
!    & 1.d0/(2.d0**3*3.d0)*dsqrt(1.d0/pi)*(2.d0*dd1)**(7.d0/2.d0)       
    c = dd1**3.5d0*0.26596152026762178d0
!         endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 3) = distp(i, 1)
! lz=0
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2     
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1     
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1     
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!            endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(dd1*distp(0, 1))
      fun2 = dd1**2*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp272 = fun/r(0)
        temp273b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp272b3 = 6.d0*temp273b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp272+fun2)*zb(&
&          indorbp, indt+4)
        funb = funb + temp272b3
        rb(0) = rb(0) - temp272*temp272b3
        fun2b = fun2b + temp273b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp272b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp272b
                  fun0b = fun0b + rmu(i, 0)*temp272b
                ELSE
                  temp272b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp272b0
                  fun0b = fun0b + rmu(i, 0)*temp272b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp272b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp272b1
                fun0b = fun0b + rmu(i, 0)*temp272b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp272b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp272b2
                fun0b = fun0b + rmu(i, 0)*temp272b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp271 = fun/r(0)
          temp271b0 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp271*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp271*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb = funb + temp271b0
          rb(0) = rb(0) - temp271*temp271b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) + dd1**2*fun2b - dd1*funb
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      distpb(i, 1) = distpb(i, 1) + distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp271b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp271b
      rb(k) = rb(k) - dd1*temp271b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.26596152026762178d0*3.5d0*dd1**2.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (31) 
!     3d without cusp condition double Z                                
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
!        if(iflagnorm.gt.2) then 
    c = 1/2.d0*DSQRT(5.d0/pi)/DSQRT(1/dd1**7/128.d0+2*peff/(dd1+dd2)**7+&
&      peff**2/dd2**7/128.d0)/DSQRT(720.d0)
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      distp(k, 2) = DEXP(-(dd2*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = c*(distp(i, 1)+peff*distp(i, 2))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
!lz=0  
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
!lz=+/-2
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
! lz=+/- 2     
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
! lz=+/-1      
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
! lz=+/-1      
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!        indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = c*(-(dd1*distp(0, 1))-peff*dd2*distp(0, 2))
      fun2 = c*(dd1**2*distp(0, 1)+peff*dd2**2*distp(0, 2))
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp281 = fun/r(0)
        temp282b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp281b3 = 6.d0*temp282b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp281+fun2)*zb(&
&          indorbp, indt+4)
        funb = funb + temp281b3
        rb(0) = rb(0) - temp281*temp281b3
        fun2b = fun2b + temp282b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp281b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp281b
                  fun0b = fun0b + rmu(i, 0)*temp281b
                ELSE
                  temp281b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp281b0
                  fun0b = fun0b + rmu(i, 0)*temp281b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp281b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp281b1
                fun0b = fun0b + rmu(i, 0)*temp281b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp281b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp281b2
                fun0b = fun0b + rmu(i, 0)*temp281b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp280 = fun/r(0)
          temp280b5 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp280*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp280*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb = funb + temp280b5
          rb(0) = rb(0) - temp280*temp280b5
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp280b2 = c*fun2b
      temp280b3 = dd2**2*temp280b2
      cb = (-(dd1*distp(0, 1))-peff*dd2*distp(0, 2))*funb + (dd1**2*&
&        distp(0, 1)+dd2**2*(peff*distp(0, 2)))*fun2b
      temp280b4 = c*funb
      dd1b = distp(0, 1)*2*dd1*temp280b2 - distp(0, 1)*temp280b4
      distpb(0, 1) = distpb(0, 1) + dd1**2*temp280b2
      dd2b = peff*distp(0, 2)*2*dd2*temp280b2 - distp(0, 2)*peff*&
&        temp280b4
      peffb = distp(0, 2)*temp280b3 - distp(0, 2)*dd2*temp280b4
      distpb(0, 2) = distpb(0, 2) + peff*temp280b3
      distpb(0, 1) = distpb(0, 1) - dd1*temp280b4
      distpb(0, 2) = distpb(0, 2) - peff*dd2*temp280b4
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      cb = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      temp280b1 = c*distpb(i, 3)
      cb = cb + (distp(i, 1)+peff*distp(i, 2))*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + temp280b1
      peffb = peffb + distp(i, 2)*temp280b1
      distpb(i, 2) = distpb(i, 2) + peff*temp280b1
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp280b = DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp280b
      distpb(k, 2) = 0.0_8
      temp280b0 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp280b0 - dd2*temp280b
      dd1b = dd1b - r(k)*temp280b0
      distpb(k, 1) = 0.0_8
    END DO
    temp279 = 128.d0*dd2**7
    temp278 = peff**2/temp279
    temp277 = (dd1+dd2)**7
    temp276 = 128.d0*dd1**7
    temp273 = 1.0/temp276 + 2*(peff/temp277) + temp278
    temp275 = DSQRT(temp273)
    temp274 = 2.d0*DSQRT(720.d0)
    IF (temp273 .EQ. 0.0) THEN
      temp273b0 = 0.0
    ELSE
      temp273b0 = -(DSQRT(5.d0/pi)*cb/(temp274*temp275**2*2.D0*DSQRT(&
&        temp273)))
    END IF
    temp273b1 = 2*temp273b0/temp277
    temp273b2 = -(peff*7*(dd1+dd2)**6*temp273b1/temp277)
    dd1b = dd1b + temp273b2 - 128.d0*7*dd1**6*temp273b0/temp276**2
    peffb = peffb + 2*peff*temp273b0/temp279 + temp273b1
    dd2b = dd2b + temp273b2 - temp278*128.d0*7*dd2**6*temp273b0/temp279
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (32) 
!     3d without cusp condition triple Z                                
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
    dd3 = dd(indpar+4)
    peff2 = dd(indpar+5)
!        if(iflagnorm.gt.2) then 
    c = 1/2.d0*DSQRT(5.d0/pi)/DSQRT(1/(2.d0*dd1)**7+2*peff/(dd1+dd2)**7+&
&      peff**2/(2.d0*dd2)**7+2*peff2/(dd1+dd3)**7+peff2**2/(2.d0*dd3)**7+&
&      2*peff*peff2/(dd2+dd3)**7)/DSQRT(720.d0)
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      distp(k, 2) = DEXP(-(dd2*r(k)))
      distp(k, 3) = DEXP(-(dd3*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = c*(distp(i, 1)+peff*distp(i, 2)+peff2*distp(i, 3))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
!lz=0  
      distp(i, 5) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
!lz=+/-2
      distp(i, 6) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
! lz=+/- 2     
      distp(i, 7) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
! lz=+/-1      
      distp(i, 8) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 9))
! lz=+/-1      
      distp(i, 9) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!        indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 4)
      fun = c*(-(dd1*distp(0, 1))-peff*dd2*distp(0, 2)-peff2*dd3*distp(0&
&        , 3))
      fun2 = c*(dd1**2*distp(0, 1)+peff*dd2**2*distp(0, 2)+peff2*dd3**2*&
&        distp(0, 3))
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp298 = fun/r(0)
        temp299b = distp(0, 4+ic)*zb(indorbp, indt+4)
        temp298b3 = 6.d0*temp299b/r(0)
        distpb(0, 4+ic) = distpb(0, 4+ic) + (6.d0*temp298+fun2)*zb(&
&          indorbp, indt+4)
        funb = funb + temp298b3
        rb(0) = rb(0) - temp298*temp298b3
        fun2b = fun2b + temp299b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp298b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp298b
                  fun0b = fun0b + rmu(i, 0)*temp298b
                ELSE
                  temp298b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp298b0
                  fun0b = fun0b + rmu(i, 0)*temp298b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp298b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp298b1
                fun0b = fun0b + rmu(i, 0)*temp298b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp298b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp298b2
                fun0b = fun0b + rmu(i, 0)*temp298b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp297 = fun/r(0)
          temp297b7 = distp(0, 4+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 4+ic) = distpb(0, 4+ic) + temp297*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp297*distp(0, 4+ic)*zb(indorbp, &
&            indt+i)
          funb = funb + temp297b7
          rb(0) = rb(0) - temp297*temp297b7
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp297b3 = c*fun2b
      temp297b4 = dd2**2*temp297b3
      temp297b5 = dd3**2*temp297b3
      cb = (-(dd1*distp(0, 1))-peff*dd2*distp(0, 2)-peff2*dd3*distp(0, 3&
&        ))*funb + (dd1**2*distp(0, 1)+dd2**2*(peff*distp(0, 2))+dd3**2*(&
&        peff2*distp(0, 3)))*fun2b
      temp297b6 = c*funb
      dd1b = distp(0, 1)*2*dd1*temp297b3 - distp(0, 1)*temp297b6
      distpb(0, 1) = distpb(0, 1) + dd1**2*temp297b3
      dd2b = peff*distp(0, 2)*2*dd2*temp297b3 - distp(0, 2)*peff*&
&        temp297b6
      peffb = distp(0, 2)*temp297b4 - distp(0, 2)*dd2*temp297b6
      distpb(0, 2) = distpb(0, 2) + peff*temp297b4
      dd3b = peff2*distp(0, 3)*2*dd3*temp297b3 - distp(0, 3)*peff2*&
&        temp297b6
      peff2b = distp(0, 3)*temp297b5 - distp(0, 3)*dd3*temp297b6
      distpb(0, 3) = distpb(0, 3) + peff2*temp297b5
      distpb(0, 1) = distpb(0, 1) - dd1*temp297b6
      distpb(0, 2) = distpb(0, 2) - peff*dd2*temp297b6
      distpb(0, 3) = distpb(0, 3) - peff2*dd3*temp297b6
      distpb(0, 4) = distpb(0, 4) + fun0b
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      peff2b = 0.0_8
      cb = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 4+ic) = distpb(i, 4+ic) + distp(i, 4)*zb(indorbp, i)
        distpb(i, 4) = distpb(i, 4) + distp(i, 4+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 9))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 9)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 9)
      distpb(i, 9) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 7)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 5)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      temp297b2 = c*distpb(i, 4)
      cb = cb + (distp(i, 1)+peff*distp(i, 2)+peff2*distp(i, 3))*distpb(&
&        i, 4)
      distpb(i, 1) = distpb(i, 1) + temp297b2
      peffb = peffb + distp(i, 2)*temp297b2
      distpb(i, 2) = distpb(i, 2) + peff*temp297b2
      peff2b = peff2b + distp(i, 3)*temp297b2
      distpb(i, 3) = distpb(i, 3) + peff2*temp297b2
      distpb(i, 4) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp297b = DEXP(-(dd3*r(k)))*distpb(k, 3)
      dd3b = dd3b - r(k)*temp297b
      distpb(k, 3) = 0.0_8
      temp297b0 = DEXP(-(dd2*r(k)))*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      temp297b1 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp297b0 - dd1*temp297b1 - dd3*temp297b
      dd2b = dd2b - r(k)*temp297b0
      dd1b = dd1b - r(k)*temp297b1
      distpb(k, 1) = 0.0_8
    END DO
    temp296 = (dd2+dd3)**7
    temp282 = peff*peff2/temp296
    temp295 = 2.d0**7
    temp294 = temp295*dd3**7
    temp293 = peff2**2/temp294
    temp292 = (dd1+dd3)**7
    temp291 = 2.d0**7
    temp290 = temp291*dd2**7
    temp289 = peff**2/temp290
    temp288 = (dd1+dd2)**7
    temp287 = 2.d0**7
    temp286 = temp287*dd1**7
    temp283 = 1.0/temp286 + 2*(peff/temp288) + temp289 + 2*(peff2/&
&      temp292) + temp293 + 2*temp282
    temp285 = DSQRT(temp283)
    temp284 = 2.d0*DSQRT(720.d0)
    IF (temp283 .EQ. 0.0) THEN
      temp283b = 0.0
    ELSE
      temp283b = -(DSQRT(5.d0/pi)*cb/(temp284*temp285**2*2.D0*DSQRT(&
&        temp283)))
    END IF
    temp283b0 = 2*temp283b/temp288
    temp283b1 = -(peff*7*(dd1+dd2)**6*temp283b0/temp288)
    temp283b2 = 2*temp283b/temp292
    temp283b3 = -(peff2*7*(dd1+dd3)**6*temp283b2/temp292)
    temp282b0 = 2*temp283b/temp296
    temp282b1 = -(temp282*7*(dd2+dd3)**6*temp282b0)
    dd1b = dd1b + temp283b3 + temp283b1 - temp287*7*dd1**6*temp283b/&
&      temp286**2
    peffb = peffb + peff2*temp282b0 + 2*peff*temp283b/temp290 + &
&      temp283b0
    dd2b = dd2b + temp282b1 - temp289*temp291*7*dd2**6*temp283b/temp290 &
&      + temp283b1
    peff2b = peff2b + peff*temp282b0 + 2*peff2*temp283b/temp294 + &
&      temp283b2
    dd3b = dd3b + temp282b1 - temp293*temp295*7*dd3**6*temp283b/temp294 &
&      + temp283b3
    ddb(indpar+5) = ddb(indpar+5) + peff2b
    ddb(indpar+4) = ddb(indpar+4) + dd3b
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (33) 
!     4d without cusp and one parmater                                  
    dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then 
!     c=                                                                
!    & 1/(2.d0**3*3.d0)*dsqrt(1.d0/pi)*(2.d0*dd1)**(7.d0/2.d0)          
!     c=                                                                &
!    & 1.d0/(2.d0**3*3.d0)/dsqrt(56.d0*pi)*(2.d0*dd1)**(9.d0/2.d0)      
    c = dd1**4.5d0*0.0710812062076410d0
!         endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*r(i)
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
! lz=0
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
! lz=+/
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
! lz=+/-2     
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
! lz=+/-1     
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
! lz=+/-1     
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!            endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(dd1*distp(0, 3)) + distp(0, 1)
      fun2 = dd1**2*distp(0, 3) - 2.d0*dd1*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp300 = fun/r(0)
        temp301b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp300b3 = 6.d0*temp301b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp300+fun2)*zb(&
&          indorbp, indt+4)
        funb = funb + temp300b3
        rb(0) = rb(0) - temp300*temp300b3
        fun2b = fun2b + temp301b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp300b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp300b
                  fun0b = fun0b + rmu(i, 0)*temp300b
                ELSE
                  temp300b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp300b0
                  fun0b = fun0b + rmu(i, 0)*temp300b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp300b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp300b1
                fun0b = fun0b + rmu(i, 0)*temp300b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp300b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp300b2
                fun0b = fun0b + rmu(i, 0)*temp300b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp299 = fun/r(0)
          temp299b1 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp299*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp299*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb = funb + temp299b1
          rb(0) = rb(0) - temp299*temp299b1
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      dd1b = (distp(0, 3)*2*dd1-2.d0*distp(0, 1))*fun2b - distp(0, 3)*&
&        funb
      distpb(0, 3) = distpb(0, 3) + dd1**2*fun2b
      distpb(0, 1) = distpb(0, 1) + funb - 2.d0*dd1*fun2b
      distpb(0, 3) = distpb(0, 3) + fun0b - dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distpb(i, 1) = distpb(i, 1) + r(i)*distpb(i, 3)
      rb(i) = rb(i) + distp(i, 1)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp299b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp299b0
      rb(k) = rb(k) - dd1*temp299b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.0710812062076410d0*4.5d0*dd1**3.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (34) 
! 2s single  Z WITH CUSP zero                    
! normalized                        
! exp(-dd1*r) + dd1*r*exp(-dd1*r)                                       
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           peff=dd1                                                    
!           if(iflagnorm.gt.2) then 
!              c=1.d0/dsqrt(1.d0/4.d0/dd1**3+12.d0*dd1/(2.d0*dd1)**4+      &
!               &3.d0*dd1**2/4.d0/dd1**5)/dsqrt(4.d0*pi)                           
!             c=dd1*dsqrt(dd1)/dsqrt(7.d0*pi)
    c = dd1*DSQRT(dd1)*.2132436186229231d0
!           endif 
    DO i=indtmin,indtm
      distp(i, 1) = c*DEXP(-(dd1*r(i)))
    END DO
    IF (typec .NE. 1) THEN
      fun = -(dd1**2*distp(0, 1))
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      funb = funb + (1.d0-dd1*r(0))*fun2b
      dd1b = -(distp(0, 1)*2*dd1*funb) - fun*r(0)*fun2b
      rb(0) = rb(0) - fun*dd1*fun2b
      distpb = 0.0_8
      distpb(0, 1) = -(dd1**2*funb)
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp302b0 = distp(i, 1)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + (r(i)*dd1+1.d0)*zb(indorbp, i)
      rb(i) = rb(i) + dd1*temp302b0
      dd1b = dd1b + r(i)*temp302b0
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO i=indtm,indtmin,-1
      temp302b = c*DEXP(-(dd1*r(i)))*distpb(i, 1)
      cb = cb + DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp302b
      rb(i) = rb(i) - dd1*temp302b
      distpb(i, 1) = 0.0_8
    END DO
    temp301 = DSQRT(dd1)
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + .2132436186229231d0*temp301*cb
    ELSE
      dd1b = dd1b + (.2132436186229231d0*dd1/(2.D0*DSQRT(dd1))+&
&        .2132436186229231d0*temp301)*cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (35) 
! 2s single  Z WITH CUSP                         
! normalized                        
! exp(-dd1*r) + dd1* r * exp(-dd2*r)                                    
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      distp(k, 2) = DEXP(-(dd2*r(k)))
    END DO
!           if(iflagnorm.gt.2) then 
    c = 1.d0/DSQRT(1/4.d0/dd1**3+12*peff/(dd1+dd2)**4+3*peff**2/4/dd2**5&
&      )/DSQRT(4.0*pi)
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1)) + peff*distp(0, 2)*(1.d0-dd2*r(0))
      fun2 = distp(0, 1)*dd1**2 + peff*distp(0, 2)*(dd2**2*r(0)-2.d0*dd2&
&        )
      temp310 = fun/r(0)
      temp310b = c*2.d0*zb(indorbp, indt+4)/r(0)
      cb = (2.d0*temp310+fun2)*zb(indorbp, indt+4)
      funb = temp310b
      rb(0) = rb(0) - temp310*temp310b
      fun2b = c*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp309 = rmu(i, 0)/r(0)
        temp309b5 = fun*c*zb(indorbp, indt+i)/r(0)
        funb = funb + temp309*c*zb(indorbp, indt+i)
        cb = cb + temp309*fun*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + temp309b5
        rb(0) = rb(0) - temp309*temp309b5
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp309b1 = (dd2**2*r(0)-2.d0*dd2)*fun2b
      temp309b2 = peff*distp(0, 2)*fun2b
      distpb(0, 1) = dd1**2*fun2b
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb
      temp309b3 = (1.d0-dd2*r(0))*funb
      peffb = distp(0, 2)*temp309b3 + distp(0, 2)*temp309b1
      distpb(0, 2) = peff*temp309b3 + peff*temp309b1
      temp309b4 = peff*distp(0, 2)*funb
      dd2b = (r(0)*2*dd2-2.d0)*temp309b2 - r(0)*temp309b4
      rb(0) = rb(0) + dd2**2*temp309b2 - dd2*temp309b4
      distpb(0, 1) = distpb(0, 1) - dd1*funb
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      cb = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp309b = c*zb(indorbp, i)
      temp309b0 = distp(i, 2)*temp309b
      cb = cb + (distp(i, 1)+r(i)*peff*distp(i, 2))*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp309b
      rb(i) = rb(i) + peff*temp309b0
      peffb = peffb + r(i)*temp309b0
      distpb(i, 2) = distpb(i, 2) + r(i)*peff*temp309b
      zb(indorbp, i) = 0.0_8
    END DO
    temp308 = 4*dd2**5
    temp302 = peff**2/temp308
    temp307 = (dd1+dd2)**4
    temp306 = 4.d0*dd1**3
    temp303 = 1.0/temp306 + 12*(peff/temp307) + 3*temp302
    temp305 = DSQRT(temp303)
    temp304 = DSQRT(4.0*pi)
    IF (temp303 .EQ. 0.0) THEN
      temp303b = 0.0
    ELSE
      temp303b = -(cb/(temp304*temp305**2*2.D0*DSQRT(temp303)))
    END IF
    temp303b0 = 12*temp303b/temp307
    temp303b1 = -(peff*4*(dd1+dd2)**3*temp303b0/temp307)
    temp302b3 = 3*temp303b/temp308
    dd1b = dd1b + temp303b1 - 4.d0*3*dd1**2*temp303b/temp306**2
    peffb = peffb + 2*peff*temp302b3 + temp303b0
    dd2b = dd2b + temp303b1 - temp302*4*5*dd2**4*temp302b3
    DO k=indtm,indtmin,-1
      temp302b1 = DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp302b1
      distpb(k, 2) = 0.0_8
      temp302b2 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp302b2 - dd2*temp302b1
      dd1b = dd1b - r(k)*temp302b2
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (36) 
! single gaussian p orbitals                            
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then 
!        c=dsqrt(2.d0)*pi**(-0.75d0)*(2.d0*dd1)**1.25d0 
    c = dd1**1.25d0*1.42541094070998d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
!        indorbp=indorb 
!                                                                       
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp312b1 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp312b1
        fun2b = fun2b + temp312b1
        zb(indorbp, indt+4) = 0.0_8
        fun0b = fun0b + zb(indorbp, indt+ic)
        DO i=3,1,-1
          temp312b0 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp312b0
          funb = funb + rmu(ic, 0)*temp312b0
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp312b = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp312b - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp312b
      distpb = 0.0_8
      distpb(0, 1) = fun0b - 2.d0*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp311 = r(k)**2
      temp311b = c*DEXP(-(dd1*temp311))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp311))*distpb(k, 1)
      dd1b = dd1b - temp311*temp311b
      rb(k) = rb(k) - dd1*2*r(k)*temp311b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.42541094070998d0*1.25d0*dd1**0.25D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (37, 68) 
! d orbitals                                                            
! R(r)= exp(-alpha r^2)                                                 
! each gaussian term is normalized                                      
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
!        c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0) 
    c = dd1**1.75d0*1.64592278064948967213d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
! lz=0       
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2     
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2            
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1            
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1            
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        END IF
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp313b6 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 6.d0*temp313b6
        fun2b = fun2b + temp313b6
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 3) THEN
          IF (branch .LT. 2) THEN
            IF (branch .LT. 1) THEN
              temp313b1 = cost1d*4.d0*zb(indorbp, indt+3)
              rmub(3, 0) = rmub(3, 0) + fun0*temp313b1
              temp313b2 = -(cost1d*2.d0*zb(indorbp, indt+2))
              temp313b3 = -(cost1d*2.d0*zb(indorbp, indt+1))
              fun0b = fun0b + rmu(2, 0)*temp313b2 + rmu(1, 0)*temp313b3 &
&                + rmu(3, 0)*temp313b1
              rmub(2, 0) = rmub(2, 0) + fun0*temp313b2
              rmub(1, 0) = rmub(1, 0) + fun0*temp313b3
            ELSE
              temp313b4 = -(cost2d*2.d0*zb(indorbp, indt+2))
              rmub(2, 0) = rmub(2, 0) + fun0*temp313b4
              temp313b5 = cost2d*2.d0*zb(indorbp, indt+1)
              fun0b = fun0b + rmu(1, 0)*temp313b5 + rmu(2, 0)*temp313b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp313b5
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+2)
            fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+1) + &
&              cost3d*rmu(1, 0)*zb(indorbp, indt+2)
            rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+1)
          END IF
        ELSE IF (branch .LT. 5) THEN
          IF (branch .LT. 4) THEN
            rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+3)
            fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+2) + &
&              cost3d*rmu(2, 0)*zb(indorbp, indt+3)
            rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+2)
          END IF
        ELSE
          rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+3)
          fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+1) + cost3d*&
&            rmu(1, 0)*zb(indorbp, indt+3)
          rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+1)
        END IF
        DO i=3,1,-1
          temp313b0 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp313b0
          funb = funb + rmu(i, 0)*temp313b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp313b = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp313b - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp313b
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp312 = r(k)**2
      temp312b2 = c*DEXP(-(dd1*temp312))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp312))*distpb(k, 1)
      dd1b = dd1b - temp312*temp312b2
      rb(k) = rb(k) - dd1*2*r(k)*temp312b2
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.64592278064948967213d0*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (47) 
! d orbitals cartesian !!!                                              
! R(r)= exp(-alpha r^2)                                                 
! each gaussian term is normalized                                      
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
    c = dd1**1.75d0*1.64592278064948967213d0
!        c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0) 
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = rmu(1, i)**2
      distp(i, 3) = rmu(2, i)**2
      distp(i, 4) = rmu(3, i)**2
! lz=+/-2            
      distp(i, 5) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1            
      distp(i, 6) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1            
      distp(i, 7) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,6
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
!              indorbp=indorb 
      DO ic=1,6
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .LE. 3) THEN
            IF (i .EQ. ic) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
          END IF
        END DO
!endif for ic                           
!enddo for i                                 
        IF (ic .LE. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=6,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 2) THEN
          temp314b1 = distp(0, 1+ic)*zb(indorbp, indt+4)
          distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp&
&            , indt+4)
          funb = funb + 6.d0*temp314b1
          fun2b = fun2b + temp314b1
          distpb(0, 1) = distpb(0, 1) + 2.d0*zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.0_8
        ELSE
          temp314b2 = distp(0, 1+ic)*zb(indorbp, indt+4)
          distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp&
&            , indt+4)
          funb = funb + 6.d0*temp314b2
          fun2b = fun2b + temp314b2
          zb(indorbp, indt+4) = 0.0_8
        END IF
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 7) THEN
            IF (branch .LT. 4) THEN
              IF (branch .LT. 3) THEN
                IF (.NOT.branch .LT. 2) THEN
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun0*zb(indorbp, indt+i&
&                    )
                  fun0b = fun0b + 2.d0*rmu(i, 0)*zb(indorbp, indt+i)
                END IF
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 6) THEN
              IF (.NOT.branch .LT. 5) THEN
                rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
              END IF
            ELSE
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 10) THEN
            IF (branch .LT. 9) THEN
              IF (.NOT.branch .LT. 8) THEN
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            END IF
          ELSE IF (branch .LT. 12) THEN
            IF (branch .LT. 11) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp314b0 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp314b0
          funb = funb + rmu(i, 0)*temp314b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp314b = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp314b - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp314b
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=6,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(3, i) = rmub(3, i) + 2*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(2, i) = rmub(2, i) + 2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp313 = r(k)**2
      temp313b7 = c*DEXP(-(dd1*temp313))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp313))*distpb(k, 1)
      dd1b = dd1b - temp313*temp313b7
      rb(k) = rb(k) - dd1*2*r(k)*temp313b7
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.64592278064948967213d0*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (48) 
! f single gaussian orbital                                             
! R(r)= exp(-alpha r^2)                                                 
! normalized                                                            
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
!        c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0) 
    c = dd1**2.25d0*1.47215808929909374563d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0        
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2           
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2                   
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3     
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3     
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
!              indorbp=indorb 
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        ELSE IF (ic .EQ. 6) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
        END IF
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp315b28 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 8.d0*temp315b28
        fun2b = fun2b + temp315b28
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 4) THEN
          IF (branch .LT. 2) THEN
            IF (branch .LT. 1) THEN
              temp315b9 = cost1f*zb(indorbp, indt+3)
              temp315b10 = -(cost1f*6.d0*zb(indorbp, indt+2))
              temp315b11 = -(cost1f*6.d0*zb(indorbp, indt+1))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp315b10 + rmu(3, 0)&
&                *rmu(1, 0)*temp315b11 + (9.d0*rmu(3, 0)**2-3.d0*r(0)**2)&
&                *temp315b9
              rmub(3, 0) = rmub(3, 0) + fun0*9.d0*2*rmu(3, 0)*temp315b9
              rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp315b9
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp315b10
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp315b10
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp315b11
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp315b11
            ELSE
              temp315b12 = cost2f*8.d0*zb(indorbp, indt+3)
              temp315b13 = -(cost2f*2.d0*zb(indorbp, indt+2))
              fun0b = fun0b + rmu(1, 0)*rmu(2, 0)*temp315b13 + cost2f*(&
&                5.d0*rmu(3, 0)**2-r(0)**2-2.d0*rmu(1, 0)**2)*zb(indorbp&
&                , indt+1) + rmu(1, 0)*rmu(3, 0)*temp315b12
              rmub(3, 0) = rmub(3, 0) + rmu(1, 0)*fun0*temp315b12
              rmub(1, 0) = rmub(1, 0) + fun0*rmu(3, 0)*temp315b12
              rmub(2, 0) = rmub(2, 0) + rmu(1, 0)*fun0*temp315b13
              rmub(1, 0) = rmub(1, 0) + fun0*rmu(2, 0)*temp315b13
              temp315b14 = cost2f*fun0*zb(indorbp, indt+1)
              rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp315b14
              rb(0) = rb(0) - 2*r(0)*temp315b14
              rmub(1, 0) = rmub(1, 0) - 2.d0*2*rmu(1, 0)*temp315b14
            END IF
          ELSE IF (branch .LT. 3) THEN
            temp315b15 = cost2f*8.d0*zb(indorbp, indt+3)
            temp315b16 = -(cost2f*2.d0*zb(indorbp, indt+1))
            fun0b = fun0b + cost2f*(5.d0*rmu(3, 0)**2-r(0)**2-2.d0*rmu(2&
&              , 0)**2)*zb(indorbp, indt+2) + rmu(2, 0)*rmu(1, 0)*&
&              temp315b16 + rmu(2, 0)*rmu(3, 0)*temp315b15
            rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*fun0*temp315b15
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(3, 0)*temp315b15
            temp315b17 = cost2f*fun0*zb(indorbp, indt+2)
            rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp315b17
            rb(0) = rb(0) - 2*r(0)*temp315b17
            rmub(2, 0) = rmub(2, 0) - 2.d0*2*rmu(2, 0)*temp315b17
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp315b16
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp315b16
          ELSE
            temp315b18 = cost3f*zb(indorbp, indt+3)
            temp315b19 = -(cost3f*2.d0*zb(indorbp, indt+2))
            temp315b20 = cost3f*2.d0*zb(indorbp, indt+1)
            fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp315b19 + rmu(3, 0)*&
&              rmu(1, 0)*temp315b20 + (rmu(1, 0)**2-rmu(2, 0)**2)*&
&              temp315b18
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp315b18
            rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp315b19 - fun0*2&
&              *rmu(2, 0)*temp315b18
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp315b19
            rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp315b20
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp315b20
          END IF
        ELSE IF (branch .LT. 6) THEN
          IF (branch .LT. 5) THEN
            temp315b21 = cost3f*2.d0*zb(indorbp, indt+3)
            temp315b22 = cost3f*2.d0*zb(indorbp, indt+2)
            temp315b23 = cost3f*2.d0*zb(indorbp, indt+1)
            fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp315b22 + rmu(3, 0)*&
&              rmu(2, 0)*temp315b23 + rmu(2, 0)*rmu(1, 0)*temp315b21
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp315b21
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp315b21
            rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp315b22
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp315b22
            rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp315b23
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp315b23
          ELSE
            temp315b24 = -(cost4f*6.d0*zb(indorbp, indt+2))
            temp315b25 = cost4f*3.d0*zb(indorbp, indt+1)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp315b25 + rmu&
&              (2, 0)*rmu(1, 0)*temp315b24
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp315b24
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp315b24
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp315b25
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp315b25
          END IF
        ELSE
          temp315b26 = cost4f*3.d0*zb(indorbp, indt+2)
          temp315b27 = cost4f*6.d0*zb(indorbp, indt+1)
          fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp315b27 + (rmu(1, 0)**2&
&            -rmu(2, 0)**2)*temp315b26
          rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp315b26
          rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp315b26
          rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp315b27
          rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp315b27
        END IF
        DO i=3,1,-1
          temp315b8 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp315b8
          funb = funb + rmu(i, 0)*temp315b8
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp315b7 = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp315b7 - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp315b7
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp315b = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp315b
      distpb(i, 8) = 0.0_8
      temp315b0 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp315b0 + 3.d0*2*rmu(1, i)*temp315b
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp315b0
      distpb(i, 7) = 0.0_8
      temp315b1 = cost3f*2.d0*distpb(i, 6)
      temp315b2 = rmu(2, i)*temp315b1
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp315b2
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp315b2
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp315b1
      distpb(i, 6) = 0.0_8
      temp315b3 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp315b3
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp315b3
      temp315b4 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp315b4
      distpb(i, 4) = 0.0_8
      temp315b5 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp315b6 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp315b5 - 3.d0*2*r(i)*temp315b6 - 2*r(i)*&
&        temp315b4
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp315b6 + 5.d0*2*rmu(3, i)*&
&        temp315b5
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp314 = r(k)**2
      temp314b3 = c*DEXP(-(dd1*temp314))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp314))*distpb(k, 1)
      dd1b = dd1b - temp314*temp314b3
      rb(k) = rb(k) - dd1*2*r(k)*temp314b3
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.47215808929909374563d0*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (49) 
! derivative of 48 with respect to z                    
! f orbitals                                                            
! R(r)= c*exp(-z r^2)*(9/4/z-r^2)                                       
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
!        c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0) 
    c = dd1**2.25d0*1.47215808929909374563d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0        
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2           
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2                   
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3     
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3     
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)*(9.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-13.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+19.d0*dd1*r(0)**2-13.d0&
&        /2.d0)
!              indorbp=indorb 
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp321b23 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 8.d0*temp321b23
        fun2b = fun2b + temp321b23
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp321b2 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp321b2
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp321b2
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp321b2
                  END IF
                  temp321b0 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp321b1 = rmu(i, 0)*temp321b0
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp321b0
                  fun0b = fun0b + rmu(3, 0)*temp321b1
                  rmub(3, 0) = rmub(3, 0) + fun0*temp321b1
                  GOTO 120
                ELSE
                  temp321b5 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp321b5
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp321b5
                  rb(0) = rb(0) - fun0*2*r(0)*temp321b5
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp321b6 = cost2f*10.d0*zb(indorbp, indt+i)
                temp321b7 = rmu(i, 0)*temp321b6
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp321b6
                fun0b = fun0b + rmu(1, 0)*temp321b7
                rmub(1, 0) = rmub(1, 0) + fun0*temp321b7
              END IF
              temp321b3 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp321b4 = rmu(i, 0)*temp321b3
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp321b3
              fun0b = fun0b + rmu(1, 0)*temp321b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp321b4
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp321b10 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp321b10
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp321b10
                  rb(0) = rb(0) - fun0*2*r(0)*temp321b10
                END IF
              ELSE
                temp321b11 = cost2f*10.d0*zb(indorbp, indt+i)
                temp321b12 = rmu(i, 0)*temp321b11
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp321b11
                fun0b = fun0b + rmu(2, 0)*temp321b12
                rmub(2, 0) = rmub(2, 0) + fun0*temp321b12
              END IF
              temp321b8 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp321b9 = rmu(i, 0)*temp321b8
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp321b8
              fun0b = fun0b + rmu(2, 0)*temp321b9
              rmub(2, 0) = rmub(2, 0) + fun0*temp321b9
            ELSE IF (branch .LT. 10) THEN
              temp321b13 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp321b13
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp321b13
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp321b13
            ELSE
              temp321b14 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp321b14
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp321b14
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp321b14
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp321b15 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp321b15
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp321b15
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp321b15
                ELSE
                  temp321b16 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp321b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp321b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp321b16
                END IF
              ELSE
                temp321b17 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp321b17
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp321b17
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp321b17
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp321b18 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp321b18
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp321b18
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp321b18
            ELSE
              temp321b19 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp321b19
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp321b19
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp321b19
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp321b20 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp321b20
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp321b20
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp321b20
              END IF
            ELSE
              temp321b21 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp321b21
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp321b21
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp321b21
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp321b22 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp321b22
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp321b22
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp321b22
          END IF
 120      temp321b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp321b
          funb = funb + rmu(i, 0)*temp321b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp320 = r(0)**4
      temp320b = distp(0, 1)*fun2b
      temp319 = 4.d0*dd1
      temp318 = 9.d0/temp319
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-13.d0/2.d0)*funb&
&        + (temp318-r(0)**2)*fun0b + (19.d0*(dd1*r(0)**2)-13.d0/2.d0-4.d0&
&        *(dd1**2*temp320))*fun2b
      temp320b0 = distp(0, 1)*2.d0*funb
      dd1b = r(0)**2*temp320b0 - distp(0, 1)*temp318*4.d0*fun0b/temp319 &
&        + (19.d0*r(0)**2-4.d0*temp320*2*dd1)*temp320b
      rb(0) = rb(0) + dd1*2*r(0)*temp320b0 - distp(0, 1)*2*r(0)*fun0b + &
&        (19.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp320b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    dd1b = 0.0_8
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        temp318b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp317 = 4.d0*dd1
        temp316 = 9.d0/temp317
        temp316b7 = (temp316-r(k)**2)*zb(indorbp, k)
        dd1b = dd1b - temp316*4.d0*temp318b/temp317
        rb(k) = rb(k) - 2*r(k)*temp318b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp316b7
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp316b7
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp316b = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp316b
      distpb(i, 8) = 0.0_8
      temp316b0 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp316b0 + 3.d0*2*rmu(1, i)*temp316b
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp316b0
      distpb(i, 7) = 0.0_8
      temp316b1 = cost3f*2.d0*distpb(i, 6)
      temp316b2 = rmu(2, i)*temp316b1
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp316b2
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp316b2
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp316b1
      distpb(i, 6) = 0.0_8
      temp316b3 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp316b3
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp316b3
      temp316b4 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp316b4
      distpb(i, 4) = 0.0_8
      temp316b5 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp316b6 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp316b5 - 3.d0*2*r(i)*temp316b6 - 2*r(i)*&
&        temp316b4
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp316b6 + 5.d0*2*rmu(3, i)*&
&        temp316b5
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp315 = r(k)**2
      temp315b29 = c*DEXP(-(dd1*temp315))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp315))*distpb(k, 1)
      dd1b = dd1b - temp315*temp315b29
      rb(k) = rb(k) - dd1*2*r(k)*temp315b29
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.47215808929909374563d0*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (70) 
! f single Slater orbital                                             
! R(r)= exp(-alpha r)                                                 
! normalized                                                            
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
! l = 3
! \int d\omega Y*Y = 4 pi / (2 l + 1)
! \int dr r^{2 l + 2} Exp [- 2 dd1 r^2 ] =  7 * 5 * 3**2 / 2**2 / dd1**9 
!        c=1.d0/dsqrt(10.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(9.d0/2.d0)/3.d0
    c = dd1**4.5d0*0.084104417400672d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0        
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2           
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2                   
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3     
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3     
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(dd1*distp(0, 1)/r(0))
      fun2 = dd1**2*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp322b23 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 8.d0*temp322b23
        fun2b = fun2b + temp322b23
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp322b2 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp322b2
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp322b2
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp322b2
                  END IF
                  temp322b0 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp322b1 = rmu(i, 0)*temp322b0
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp322b0
                  fun0b = fun0b + rmu(3, 0)*temp322b1
                  rmub(3, 0) = rmub(3, 0) + fun0*temp322b1
                  GOTO 130
                ELSE
                  temp322b5 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp322b5
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp322b5
                  rb(0) = rb(0) - fun0*2*r(0)*temp322b5
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp322b6 = cost2f*10.d0*zb(indorbp, indt+i)
                temp322b7 = rmu(i, 0)*temp322b6
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp322b6
                fun0b = fun0b + rmu(1, 0)*temp322b7
                rmub(1, 0) = rmub(1, 0) + fun0*temp322b7
              END IF
              temp322b3 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp322b4 = rmu(i, 0)*temp322b3
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp322b3
              fun0b = fun0b + rmu(1, 0)*temp322b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp322b4
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp322b10 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp322b10
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp322b10
                  rb(0) = rb(0) - fun0*2*r(0)*temp322b10
                END IF
              ELSE
                temp322b11 = cost2f*10.d0*zb(indorbp, indt+i)
                temp322b12 = rmu(i, 0)*temp322b11
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp322b11
                fun0b = fun0b + rmu(2, 0)*temp322b12
                rmub(2, 0) = rmub(2, 0) + fun0*temp322b12
              END IF
              temp322b8 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp322b9 = rmu(i, 0)*temp322b8
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp322b8
              fun0b = fun0b + rmu(2, 0)*temp322b9
              rmub(2, 0) = rmub(2, 0) + fun0*temp322b9
            ELSE IF (branch .LT. 10) THEN
              temp322b13 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp322b13
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp322b13
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp322b13
            ELSE
              temp322b14 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp322b14
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp322b14
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp322b14
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp322b15 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp322b15
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp322b15
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp322b15
                ELSE
                  temp322b16 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp322b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp322b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp322b16
                END IF
              ELSE
                temp322b17 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp322b17
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp322b17
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp322b17
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp322b18 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp322b18
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp322b18
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp322b18
            ELSE
              temp322b19 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp322b19
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp322b19
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp322b19
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp322b20 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp322b20
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp322b20
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp322b20
              END IF
            ELSE
              temp322b21 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp322b21
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp322b21
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp322b21
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp322b22 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp322b22
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp322b22
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp322b22
          END IF
 130      temp322b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp322b
          funb = funb + rmu(i, 0)*temp322b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp321b33 = -(distp(0, 1)*funb/r(0))
      dd1b = temp321b33 + distp(0, 1)*2*dd1*fun2b
      temp321 = dd1/r(0)
      distpb(0, 1) = distpb(0, 1) + fun0b - temp321*funb + dd1**2*fun2b
      rb(0) = rb(0) - temp321*temp321b33
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp321b25 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp321b25
      distpb(i, 8) = 0.0_8
      temp321b26 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp321b26 + 3.d0*2*rmu(1, i)*&
&        temp321b25
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp321b26
      distpb(i, 7) = 0.0_8
      temp321b27 = cost3f*2.d0*distpb(i, 6)
      temp321b28 = rmu(2, i)*temp321b27
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp321b28
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp321b28
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp321b27
      distpb(i, 6) = 0.0_8
      temp321b29 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp321b29
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp321b29
      temp321b30 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp321b30
      distpb(i, 4) = 0.0_8
      temp321b31 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp321b32 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp321b31 - 3.d0*2*r(i)*temp321b32 - 2*r(i&
&        )*temp321b30
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp321b32 + 5.d0*2*rmu(3, i)*&
&        temp321b31
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp321b24 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp321b24
      rb(k) = rb(k) - dd1*temp321b24
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.084104417400672d0*4.5d0*dd1**3.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (71) 
! f single Slater orbital derivative of 70     
! R(r)= (9.d0/2.0 1/dd1 - r) * exp(-alpha r)                     
! normalized                                                            
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
! l = 3
! \int d\omega Y*Y = 4 pi / (2 l + 1)
! \int dr r^{2 l + 2} Exp [- 2 dd1 r^2 ] =  7 * 5 * 3**2 / 2**2 / dd1**9 
!        c=1.d0/dsqrt(10.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(9.d0/2.d0)/3.d0
    c = dd1**4.5d0*0.084104417400672d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0        
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2           
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2                   
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3     
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3     
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)*(9.d0/2.d0/dd1-r(0))
      fun = distp(0, 1)*(dd1-11.d0/2.d0/r(0))
      fun2 = dd1*distp(0, 1)*(13.d0/2.d0-dd1*r(0))
!              indorbp=indorb 
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp328b25 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 8.d0*temp328b25
        fun2b = fun2b + temp328b25
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp328b4 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp328b4
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp328b4
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp328b4
                  END IF
                  temp328b2 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp328b3 = rmu(i, 0)*temp328b2
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp328b2
                  fun0b = fun0b + rmu(3, 0)*temp328b3
                  rmub(3, 0) = rmub(3, 0) + fun0*temp328b3
                  GOTO 140
                ELSE
                  temp328b7 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp328b7
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp328b7
                  rb(0) = rb(0) - fun0*2*r(0)*temp328b7
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp328b8 = cost2f*10.d0*zb(indorbp, indt+i)
                temp328b9 = rmu(i, 0)*temp328b8
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp328b8
                fun0b = fun0b + rmu(1, 0)*temp328b9
                rmub(1, 0) = rmub(1, 0) + fun0*temp328b9
              END IF
              temp328b5 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp328b6 = rmu(i, 0)*temp328b5
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp328b5
              fun0b = fun0b + rmu(1, 0)*temp328b6
              rmub(1, 0) = rmub(1, 0) + fun0*temp328b6
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp328b12 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp328b12
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp328b12
                  rb(0) = rb(0) - fun0*2*r(0)*temp328b12
                END IF
              ELSE
                temp328b13 = cost2f*10.d0*zb(indorbp, indt+i)
                temp328b14 = rmu(i, 0)*temp328b13
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp328b13
                fun0b = fun0b + rmu(2, 0)*temp328b14
                rmub(2, 0) = rmub(2, 0) + fun0*temp328b14
              END IF
              temp328b10 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp328b11 = rmu(i, 0)*temp328b10
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp328b10
              fun0b = fun0b + rmu(2, 0)*temp328b11
              rmub(2, 0) = rmub(2, 0) + fun0*temp328b11
            ELSE IF (branch .LT. 10) THEN
              temp328b15 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp328b15
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp328b15
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp328b15
            ELSE
              temp328b16 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp328b16
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp328b16
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp328b16
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp328b17 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp328b17
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp328b17
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp328b17
                ELSE
                  temp328b18 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp328b18
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp328b18
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp328b18
                END IF
              ELSE
                temp328b19 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp328b19
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp328b19
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp328b19
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp328b20 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp328b20
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp328b20
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp328b20
            ELSE
              temp328b21 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp328b21
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp328b21
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp328b21
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp328b22 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp328b22
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp328b22
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp328b22
              END IF
            ELSE
              temp328b23 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp328b23
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp328b23
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp328b23
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp328b24 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp328b24
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp328b24
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp328b24
          END IF
 140      temp328b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp328b1
          funb = funb + rmu(i, 0)*temp328b1
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp328b = (13.d0/2.d0-dd1*r(0))*fun2b
      temp328b0 = dd1*distp(0, 1)*fun2b
      temp325 = 2.d0*dd1
      temp324 = 9.d0/temp325
      dd1b = distp(0, 1)*funb - distp(0, 1)*temp324*2.d0*fun0b/temp325 -&
&        r(0)*temp328b0 + distp(0, 1)*temp328b
      temp327 = 2.d0*r(0)
      temp326 = 11.d0/temp327
      distpb(0, 1) = distpb(0, 1) + (dd1-temp326)*funb + (temp324-r(0))*&
&        fun0b + dd1*temp328b
      rb(0) = rb(0) + distp(0, 1)*temp326*2.d0*funb/temp327 - distp(0, 1&
&        )*fun0b - dd1*temp328b0
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    dd1b = 0.0_8
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        temp323 = 2.d0*dd1
        temp322 = 9.d0/temp323
        temp322b33 = (temp322-r(k))*zb(indorbp, k)
        temp322b34 = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp322b33
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp322b33
        dd1b = dd1b - temp322*2.d0*temp322b34/temp323
        rb(k) = rb(k) - temp322b34
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp322b25 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp322b25
      distpb(i, 8) = 0.0_8
      temp322b26 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp322b26 + 3.d0*2*rmu(1, i)*&
&        temp322b25
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp322b26
      distpb(i, 7) = 0.0_8
      temp322b27 = cost3f*2.d0*distpb(i, 6)
      temp322b28 = rmu(2, i)*temp322b27
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp322b28
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp322b28
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp322b27
      distpb(i, 6) = 0.0_8
      temp322b29 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp322b29
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp322b29
      temp322b30 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp322b30
      distpb(i, 4) = 0.0_8
      temp322b31 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp322b32 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp322b31 - 3.d0*2*r(i)*temp322b32 - 2*r(i&
&        )*temp322b30
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp322b32 + 5.d0*2*rmu(3, i)*&
&        temp322b31
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp322b24 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp322b24
      rb(k) = rb(k) - dd1*temp322b24
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.084104417400672d0*4.5d0*dd1**3.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (38) 
! 3s -derivative of 34 with respect to dd1          
! R(r)=r**2*exp(-z1*r)                                                  
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!              c=1.d0/dsqrt(1.d0/4.d0/dd1**3+12.d0*dd1/(2.d0*dd1)**4+      &
!               &3.d0*dd1**2/4.d0/dd1**5)/dsqrt(4.d0*pi)                           
!             c=dd1*dsqrt(dd1)/dsqrt(7.d0*pi)
    c = dd1*DSQRT(dd1)*0.21324361862292308211d0
!           endif 
    c0 = -(c*dd1)
    c1 = 1.5d0*c/dd1
    DO i=indtmin,indtm
      distp(i, 1) = DEXP(-(dd1*r(i)))
    END DO
    CALL PUSHREAL8(adr8ibuf,adr8buf,c1)
    c1 = c1*dd1**2
    IF (typec .NE. 1) THEN
      fun = (c0*(2.d0-dd1*r(0))-c1)*distp(0, 1)
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp331b = distp(0, 1)*fun2b
      temp330 = (dd1*r(0))**2 - 4*(dd1*r(0)) + 2.d0
      temp330b0 = c0*temp331b
      temp330b1 = 2*dd1*r(0)*temp330b0
      temp330b2 = distp(0, 1)*funb
      c0b = (2.d0-dd1*r(0))*temp330b2 + temp330*temp331b
      dd1b = c1*r(0)*temp331b - c0*r(0)*temp330b2 - 4*r(0)*temp330b0 + r&
&        (0)*temp330b1
      rb(0) = rb(0) + c1*dd1*temp331b - c0*dd1*temp330b2 - 4*dd1*&
&        temp330b0 + dd1*temp330b1
      c1b = (dd1*r(0)-1.d0)*temp331b - temp330b2
      distpb(0, 1) = (c0*(2.d0-dd1*r(0))-c1)*funb + (c0*temp330+c1*(dd1*&
&        r(0)-1.d0))*fun2b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    CALL POPREAL8(adr8ibuf,adr8buf,c1)
    dd1b = dd1b + c1*2*dd1*c1b
    c1b = dd1**2*c1b
    DO i=indtm,i0,-1
      temp330b = distp(i, 1)*zb(indorbp, i)
      temp329 = dd1*r(i) + 1.d0
      c0b = c0b + r(i)**2*temp330b
      rb(i) = rb(i) + (c1*dd1+c0*2*r(i))*temp330b
      c1b = c1b + temp329*temp330b
      dd1b = dd1b + c1*r(i)*temp330b
      distpb(i, 1) = distpb(i, 1) + (c0*r(i)**2+c1*temp329)*zb(indorbp, &
&        i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO i=indtm,indtmin,-1
      temp329b0 = DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp329b0
      rb(i) = rb(i) - dd1*temp329b0
      distpb(i, 1) = 0.0_8
    END DO
    temp329b = 1.5d0*c1b/dd1
    cb = temp329b - dd1*c0b
    temp328 = DSQRT(dd1)
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + 0.21324361862292308211d0*temp328*cb - c*c0b - c*&
&        temp329b/dd1
    ELSE
      dd1b = dd1b + (0.21324361862292308211d0*dd1/(2.D0*DSQRT(dd1))+&
&        0.21324361862292308211d0*temp328)*cb - c*c0b - c*temp329b/dd1
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (39) 
! 4s single zeta derivative of 10                   
! R(r)=r**3*exp(-z1*r)                                                  
!                                                                       
!       if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!           c=dsqrt((2*dd1)**9/40320.d0/pi)/2.d0                        
!           c=dsqrt((2*dd1)**7/720.d0/pi)/2.d0 
    c = dd1**3.5d0*0.11894160774351807429d0
!           c=-c                                                        
!           endif 
    c0 = -c
    c1 = 3.5d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**3
      rp2 = r(0)**2
!              fun=(2.d0-dd1*r(0))*distp(0,1)                       
!              fun2=(2.d0-4*dd1*r(0)+(dd1*r(0))**2)*distp(0,1)  
!                                                                       
!c              the first derivative/r                                  
      fun = distp(0, 1)*(c0*(3.d0*r(0)-dd1*rp2)+c1*(2.d0-dd1*r(0)))
!c                                                                      
!c              the second derivative                                   
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp333 = (dd1*r(0))**2 - 4*(dd1*r(0)) + 2.d0
      temp334 = 6.d0*r(0) - 6.d0*dd1*rp2 + dd1**2*rp1
      temp335b = distp(0, 1)*fun2b
      temp334b = c0*temp335b
      temp333b = c1*temp335b
      temp333b0 = 2*dd1*r(0)*temp333b
      temp332 = 3.d0*r(0) - dd1*rp2
      distpb(0, 1) = (c0*temp332+c1*(2.d0-dd1*r(0)))*funb + (c0*temp334+&
&        c1*temp333)*fun2b
      temp333b1 = distp(0, 1)*funb
      c0b = temp332*temp333b1 + temp334*temp335b
      temp332b0 = c0*temp333b1
      rp2b = -(dd1*temp332b0) - 6.d0*dd1*temp334b
      rp1b = dd1**2*temp334b
      rb(0) = rb(0) + 3.d0*temp332b0 - c1*dd1*temp333b1 + 3*r(0)**2*rp1b&
&        + 2*r(0)*rp2b - 4*dd1*temp333b + dd1*temp333b0 + 6.d0*temp334b
      dd1b = r(0)*temp333b0 - c1*r(0)*temp333b1 - 4*r(0)*temp333b - rp2*&
&        temp332b0 + (rp1*2*dd1-6.d0*rp2)*temp334b
      c1b = (2.d0-dd1*r(0))*temp333b1 + temp333*temp335b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp332b = distp(i, 1)*zb(indorbp, i)
      temp331 = r(i)**3
      c0b = c0b + temp331*temp332b
      rb(i) = rb(i) + (c1*2*r(i)+c0*3*r(i)**2)*temp332b
      c1b = c1b + r(i)**2*temp332b
      distpb(i, 1) = distpb(i, 1) + (c0*temp331+c1*r(i)**2)*zb(indorbp, &
&        i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp331b1 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp331b1
      rb(k) = rb(k) - dd1*temp331b1
      distpb(k, 1) = 0.0_8
    END DO
    temp331b0 = 3.5d0*c1b/dd1
    cb = temp331b0 - c0b
    dd1b = dd1b + 0.11894160774351807429d0*3.5d0*dd1**2.5D0*cb - c*&
&      temp331b0/dd1
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (40) 
!                                                                       
! 3p single zeta                                 
!      3p without cusp condition derivative of 20                       
!      r e^{-z1 r }                                                     
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then 
!        c=dsqrt((2.d0*dd1)**5/8.d0/pi)/2.d0 
    c = dd1**2.5d0*0.5641895835477562d0
!        endif 
    c0 = -c
    c1 = 2.5d0*c/dd1
!                                                                       
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(k, 2))
      distp(k, 2) = r(k)*distp(k, 1)
    END DO
!                                                                       
!        indorbp=indorb 
!                                                                       
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
!                                                                       
!                                                                       
    IF (typec .NE. 1) THEN
      fun = (c0*(1.d0-dd1*r(0))-c1*dd1)*distp(0, 1)
      fun2 = (c0*dd1*(dd1*r(0)-2.d0)+c1*dd1**2)*distp(0, 1)
!                                                                       
!              indorbp=indorb 
!                                                                       
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp337 = fun/r(0)
        temp338b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp337b = 4.d0*temp338b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp337+fun2)*zb(indorbp, indt&
&          +4)
        funb = funb + temp337b
        rb(0) = rb(0) - temp337*temp337b
        fun2b = fun2b + temp338b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp336 = fun/r(0)
          temp336b0 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp336*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp336*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb = funb + temp336b0
          rb(0) = rb(0) - temp336*temp336b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp336b = distp(0, 1)*fun2b
      temp335 = dd1*r(0) - 2.d0
      temp335b3 = c0*dd1*temp336b
      temp335b4 = distp(0, 1)*funb
      c0b = (1.d0-dd1*r(0))*temp335b4 + distp(0, 2)*fun0b + temp335*dd1*&
&        temp336b
      dd1b = (-c1-c0*r(0))*temp335b4 + r(0)*temp335b3 + (c1*2*dd1+&
&        temp335*c0)*temp336b
      rb(0) = rb(0) + dd1*temp335b3 - c0*dd1*temp335b4
      c1b = distp(0, 1)*fun0b - dd1*temp335b4 + dd1**2*temp336b
      distpb(0, 1) = (c0*(1.d0-dd1*r(0))-c1*dd1)*funb + (c0*dd1*temp335+&
&        c1*dd1**2)*fun2b
      distpb(0, 2) = distpb(0, 2) + c0*fun0b
      distpb(0, 1) = distpb(0, 1) + c1*fun0b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp335b2 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (c0*distp(i, 2)+c1*distp(i, 1))*zb(&
&          indorbp, i)
        c0b = c0b + distp(i, 2)*temp335b2
        distpb(i, 2) = distpb(i, 2) + c0*temp335b2
        c1b = c1b + distp(i, 1)*temp335b2
        distpb(i, 1) = distpb(i, 1) + c1*temp335b2
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(k, 2))
      rb(k) = rb(k) + distp(k, 1)*distpb(k, 2)
      distpb(k, 1) = distpb(k, 1) + r(k)*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      temp335b1 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp335b1
      rb(k) = rb(k) - dd1*temp335b1
      distpb(k, 1) = 0.0_8
    END DO
    temp335b0 = 2.5d0*c1b/dd1
    cb = temp335b0 - c0b
    dd1b = dd1b + 0.5641895835477562d0*2.5d0*dd1**1.5D0*cb - c*temp335b0&
&      /dd1
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (41) 
! 4p single zeta                                      
!c     4p without cusp condition derivative of 22                       
!c      r^2   e^{-z1 r }                                                
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then 
!        c=dsqrt((2.d0*dd1)**7/240.d0/pi)/2.d0 
    c = dd1**3.5d0*0.2060129077457011d0
!        endif 
    c0 = -c
    c1 = 3.5d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = r(i)**2*distp(i, 1)
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
!           fun=(1.d0-dd1*r(0))*distp(0,1)                          
!           fun2=dd1*(dd1*r(0)-2.d0)*distp(0,1)                     
      fun = (c0*(2.d0-dd1*r(0))*r(0)+c1*(1.d0-dd1*r(0)))*distp(0, 1)
      fun2 = (c0*((dd1*r(0))**2+2.d0-4.d0*dd1*r(0))+c1*dd1*(dd1*r(0)-&
&        2.d0))*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp343 = fun/r(0)
        temp344b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp343b = 4.d0*temp344b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp343+fun2)*zb(indorbp, indt&
&          +4)
        funb = funb + temp343b
        rb(0) = rb(0) - temp343*temp343b
        fun2b = fun2b + temp344b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp342 = fun/r(0)
          temp342b0 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp342*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp342*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb = funb + temp342b0
          rb(0) = rb(0) - temp342*temp342b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp342b = distp(0, 1)*fun2b
      temp341 = (dd1*r(0))**2 - 4.d0*dd1*r(0) + 2.d0
      temp341b = c0*temp342b
      temp341b0 = 2*dd1*r(0)*temp341b
      temp340 = dd1*r(0) - 2.d0
      temp340b = c1*dd1*temp342b
      temp340b0 = distp(0, 1)*funb
      temp338 = -(dd1*r(0)) + 2.d0
      c0b = temp338*r(0)*temp340b0 + distp(0, 3)*fun0b + temp341*&
&        temp342b
      temp339 = c0*r(0)
      dd1b = (-(c1*r(0))-temp339*r(0))*temp340b0 + r(0)*temp340b + &
&        temp340*c1*temp342b - 4.d0*r(0)*temp341b + r(0)*temp341b0
      rb(0) = rb(0) + (temp338*c0-c1*dd1-temp339*dd1)*temp340b0 + distp(&
&        0, 1)*c1*fun0b + dd1*temp340b - 4.d0*dd1*temp341b + dd1*&
&        temp341b0
      c1b = (1.d0-dd1*r(0))*temp340b0 + distp(0, 1)*r(0)*fun0b + temp340&
&        *dd1*temp342b
      distpb(0, 1) = (temp338*temp339+c1*(1.d0-dd1*r(0)))*funb + (c0*&
&        temp341+c1*dd1*temp340)*fun2b
      distpb(0, 3) = distpb(0, 3) + c0*fun0b
      distpb(0, 1) = distpb(0, 1) + c1*r(0)*fun0b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp338b2 = rmu(ic, i)*zb(indorbp, i)
        temp338b3 = distp(i, 1)*temp338b2
        rmub(ic, i) = rmub(ic, i) + (c0*distp(i, 3)+c1*r(i)*distp(i, 1))&
&          *zb(indorbp, i)
        c0b = c0b + distp(i, 3)*temp338b2
        distpb(i, 3) = distpb(i, 3) + c0*temp338b2
        c1b = c1b + r(i)*temp338b3
        rb(i) = rb(i) + c1*temp338b3
        distpb(i, 1) = distpb(i, 1) + c1*r(i)*temp338b2
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + r(i)**2*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp338b1 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp338b1
      rb(k) = rb(k) - dd1*temp338b1
      distpb(k, 1) = 0.0_8
    END DO
    temp338b0 = 3.5d0*c1b/dd1
    cb = temp338b0 - c0b
    dd1b = dd1b + 0.2060129077457011d0*3.5d0*dd1**2.5D0*cb - c*temp338b0&
&      /dd1
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (42) 
!     4d without cusp and one parmater derivative of 30                 
    dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then 
!     c=                                                                &
!    & 1.d0/(2.d0**3*3.d0)*dsqrt(1.d0/pi)*(2.d0*dd1)**(7.d0/2.d0)       
    c = dd1**3.5d0*0.26596152026762178d0
!     c=                                                                
!    & 1.d0/(2.d0**3*3.d0)/dsqrt(56.d0*pi)*(2.d0*dd1)**(9.d0/2.d0)      
!         endif 
    c0 = -c
    c1 = 3.5d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*(c0*r(i)+c1)
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
! lz=0
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
! lz=+/
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
! lz=+/-2     
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
! lz=+/-1     
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
! lz=+/-1     
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!            endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(dd1*distp(0, 3)) + c0*distp(0, 1)
      fun2 = dd1**2*distp(0, 3) - 2.d0*dd1*c0*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp345 = fun/r(0)
        temp346b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp345b3 = 6.d0*temp346b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp345+fun2)*zb(&
&          indorbp, indt+4)
        funb = funb + temp345b3
        rb(0) = rb(0) - temp345*temp345b3
        fun2b = fun2b + temp346b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp345b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp345b
                  fun0b = fun0b + rmu(i, 0)*temp345b
                ELSE
                  temp345b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp345b0
                  fun0b = fun0b + rmu(i, 0)*temp345b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp345b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp345b1
                fun0b = fun0b + rmu(i, 0)*temp345b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp345b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp345b2
                fun0b = fun0b + rmu(i, 0)*temp345b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp344 = fun/r(0)
          temp344b4 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp344*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp344*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb = funb + temp344b4
          rb(0) = rb(0) - temp344*temp344b4
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp344b3 = -(2.d0*distp(0, 1)*fun2b)
      dd1b = c0*temp344b3 - distp(0, 3)*funb + distp(0, 3)*2*dd1*fun2b
      distpb(0, 3) = distpb(0, 3) + dd1**2*fun2b
      c0b = distp(0, 1)*funb + dd1*temp344b3
      distpb(0, 1) = distpb(0, 1) + c0*funb - 2.d0*dd1*c0*fun2b
      distpb(0, 3) = distpb(0, 3) + fun0b - dd1*funb
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    c1b = 0.0_8
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      temp344b2 = distp(i, 1)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + (c0*r(i)+c1)*distpb(i, 3)
      c0b = c0b + r(i)*temp344b2
      rb(i) = rb(i) + c0*temp344b2
      c1b = c1b + temp344b2
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp344b1 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp344b1
      rb(k) = rb(k) - dd1*temp344b1
      distpb(k, 1) = 0.0_8
    END DO
    temp344b0 = 3.5d0*c1b/dd1
    cb = temp344b0 - c0b
    dd1b = dd1b + 0.26596152026762178d0*3.5d0*dd1**2.5D0*cb - c*&
&      temp344b0/dd1
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (43) 
!     4d without cusp and one parmater  derivative of 33                
    dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then 
!     c=                                                                &
!    & 1.d0/(2.d0**3*3.d0)/dsqrt(56.d0*pi)*(2.d0*dd1)**(9.d0/2.d0)      
    c = dd1**4.5d0*0.0710812062076410d0
!         endif 
    c0 = -c
    c1 = 4.5d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*(c0*r(i)**2+c1*r(i))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
! lz=0
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
! lz=+/
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
! lz=+/-2     
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
! lz=+/-1     
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
! lz=+/-1     
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!            endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(dd1*distp(0, 3)) + distp(0, 1)*(2.d0*c0*r(0)+c1)
      fun2 = dd1**2*distp(0, 3) + distp(0, 1)*(-(2.d0*dd1*(2.d0*c0*r(0)+&
&        c1))+2.d0*c0)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp348 = fun/r(0)
        temp349b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp348b3 = 6.d0*temp349b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp348+fun2)*zb(&
&          indorbp, indt+4)
        funb = funb + temp348b3
        rb(0) = rb(0) - temp348*temp348b3
        fun2b = fun2b + temp349b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp348b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp348b
                  fun0b = fun0b + rmu(i, 0)*temp348b
                ELSE
                  temp348b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp348b0
                  fun0b = fun0b + rmu(i, 0)*temp348b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp348b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp348b1
                fun0b = fun0b + rmu(i, 0)*temp348b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp348b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp348b2
                fun0b = fun0b + rmu(i, 0)*temp348b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp347 = fun/r(0)
          temp347b0 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp347*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp347*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb = funb + temp347b0
          rb(0) = rb(0) - temp347*temp347b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp346 = 2.d0*c0*r(0) + c1
      temp347b = -(distp(0, 1)*2.d0*fun2b)
      temp346b3 = dd1*temp347b
      dd1b = temp346*temp347b - distp(0, 3)*funb + distp(0, 3)*2*dd1*&
&        fun2b
      distpb(0, 3) = distpb(0, 3) + dd1**2*fun2b
      distpb(0, 1) = distpb(0, 1) + (2.d0*(c0*r(0))+c1)*funb + (2.d0*c0-&
&        2.d0*(dd1*temp346))*fun2b
      temp346b4 = distp(0, 1)*funb
      c0b = 2.d0*r(0)*temp346b4 + 2.d0*r(0)*temp346b3 + distp(0, 1)*2.d0&
&        *fun2b
      rb(0) = rb(0) + 2.d0*c0*temp346b4 + 2.d0*c0*temp346b3
      c1b = temp346b4 + temp346b3
      distpb(0, 3) = distpb(0, 3) + fun0b - dd1*funb
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      temp346b2 = distp(i, 1)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + (c0*r(i)**2+c1*r(i))*distpb(i, 3)
      c0b = c0b + r(i)**2*temp346b2
      rb(i) = rb(i) + (c1+c0*2*r(i))*temp346b2
      c1b = c1b + r(i)*temp346b2
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp346b1 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp346b1
      rb(k) = rb(k) - dd1*temp346b1
      distpb(k, 1) = 0.0_8
    END DO
    temp346b0 = 4.5d0*c1b/dd1
    cb = temp346b0 - c0b
    dd1b = dd1b + 0.0710812062076410d0*4.5d0*dd1**3.5D0*cb - c*temp346b0&
&      /dd1
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (44) 
! derivative of 36 with respect zeta                    
! R(r)=x*exp(-z*r**2)*(5/4/z-r**2)                                      
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then 
!        c=dsqrt(2.d0)*pi**(-0.75d0)*(2.d0*dd1)**1.25d0 
    c = dd1**1.25d0*1.42541094070998d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
!        indorbp=indorb 
!                                                                       
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-9.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+15.d0*dd1*r(0)**2-9.d0/&
&        2.d0)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp355b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp355b0
        fun2b = fun2b + temp355b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp355b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp355b
          funb = funb + rmu(ic, 0)*temp355b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp354 = r(0)**4
      temp354b = distp(0, 1)*fun2b
      temp353 = 4.d0*dd1
      temp352 = 5.d0/temp353
      distpb(0, 1) = (2.d0*(dd1*r(0)**2)-9.d0/2.d0)*funb + (temp352-r(0)&
&        **2)*fun0b + (15.d0*(dd1*r(0)**2)-9.d0/2.d0-4.d0*(dd1**2*temp354&
&        ))*fun2b
      temp354b0 = distp(0, 1)*2.d0*funb
      dd1b = r(0)**2*temp354b0 - distp(0, 1)*temp352*4.d0*fun0b/temp353 &
&        + (15.d0*r(0)**2-4.d0*temp354*2*dd1)*temp354b
      rb(0) = rb(0) + dd1*2*r(0)*temp354b0 - distp(0, 1)*2*r(0)*fun0b + &
&        (15.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp354b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp351 = 4.d0*dd1
        temp350 = 5.d0/temp351
        temp350b = (temp350-r(i)**2)*zb(indorbp, i)
        temp350b0 = rmu(ic, i)*distp(i, 1)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp350b
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp350b
        dd1b = dd1b - temp350*4.d0*temp350b0/temp351
        rb(i) = rb(i) - 2*r(i)*temp350b0
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp349 = r(k)**2
      temp349b0 = c*DEXP(-(dd1*temp349))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp349))*distpb(k, 1)
      dd1b = dd1b - temp349*temp349b0
      rb(k) = rb(k) - dd1*2*r(k)*temp349b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.42541094070998d0*1.25d0*dd1**0.25D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (45, 69) 
! derivative of 37 with respect to z                    
! d orbitals                                                            
! R(r)= c*exp(-z r^2)*(7/4/z-r^2)                                       
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
!        c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0) 
    c = dd1**1.75d0*1.64592278064948967213d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
! lz=0       
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2     
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2            
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1            
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1            
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)*(7.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-11.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+17.d0*dd1*r(0)**2-11.d0&
&        /2.d0)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp361b4 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 6.d0*temp361b4
        fun2b = fun2b + temp361b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp361b0 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp361b0
                  fun0b = fun0b + rmu(i, 0)*temp361b0
                ELSE
                  temp361b1 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp361b1
                  fun0b = fun0b + rmu(i, 0)*temp361b1
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp361b2 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp361b2
                fun0b = fun0b + rmu(i, 0)*temp361b2
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp361b3 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp361b3
                fun0b = fun0b + rmu(i, 0)*temp361b3
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp361b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp361b
          funb = funb + rmu(i, 0)*temp361b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp360 = r(0)**4
      temp360b = distp(0, 1)*fun2b
      temp359 = 4.d0*dd1
      temp358 = 7.d0/temp359
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-11.d0/2.d0)*funb&
&        + (temp358-r(0)**2)*fun0b + (17.d0*(dd1*r(0)**2)-11.d0/2.d0-4.d0&
&        *(dd1**2*temp360))*fun2b
      temp360b0 = distp(0, 1)*2.d0*funb
      dd1b = r(0)**2*temp360b0 - distp(0, 1)*temp358*4.d0*fun0b/temp359 &
&        + (17.d0*r(0)**2-4.d0*temp360*2*dd1)*temp360b
      rb(0) = rb(0) + dd1*2*r(0)*temp360b0 - distp(0, 1)*2*r(0)*fun0b + &
&        (17.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp360b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    dd1b = 0.0_8
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        temp358b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp357 = 4.d0*dd1
        temp356 = 7.d0/temp357
        temp356b = (temp356-r(k)**2)*zb(indorbp, k)
        dd1b = dd1b - temp356*4.d0*temp358b/temp357
        rb(k) = rb(k) - 2*r(k)*temp358b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp356b
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp356b
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp355 = r(k)**2
      temp355b1 = c*DEXP(-(dd1*temp355))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp355))*distpb(k, 1)
      dd1b = dd1b - temp355*temp355b1
      rb(k) = rb(k) - dd1*2*r(k)*temp355b1
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.64592278064948967213d0*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (46) 
! derivative of 17 with respect to z                    
! R(r)=c*r**2*exp(-z*r**2)*(7/4/z-r**2)                                 
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
    c = 4.d0*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)/DSQRT(15.d0)
!           endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
!              the first derivative / r                                 
      fun = distp(0, 1)*(7.d0-15.d0*dd1*rp1+4.d0*(dd1*rp1)**2)/2.d0/dd1
!              the second derivative                                    
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp367 = 2.d0*dd1
      temp366 = distp(0, 1)/temp367
      temp367b = temp366*fun2b
      temp367b0 = 50*2*dd1*rp1*temp367b
      temp367b1 = -(8*3*dd1**2*rp1**2*temp367b)
      temp366b = (50*(dd1*rp1)**2-59*(dd1*rp1)-8*(dd1*rp1)**3+7.d0)*&
&        fun2b/temp367
      temp365 = 2.d0*dd1
      temp364 = distp(0, 1)/temp365
      temp365b = temp364*funb
      temp364b = (4.d0*(dd1**2*rp1**2)-15.d0*(dd1*rp1)+7.d0)*funb/&
&        temp365
      dd1b = (4.d0*rp1**2*2*dd1-15.d0*rp1)*temp365b - temp364*2.d0*&
&        temp364b - temp366*2.d0*temp366b + rp1*temp367b1 - 59*rp1*&
&        temp367b + rp1*temp367b0
      rp1b = (4.d0*dd1**2*2*rp1-15.d0*dd1)*temp365b + dd1*temp367b1 - 59&
&        *dd1*temp367b + dd1*temp367b0
      distpb(0, 1) = temp364b + temp366b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp363 = 4.d0*dd1
      temp362 = r(i)**2/temp363
      temp363b = distp(i, 1)*zb(indorbp, i)
      temp362b = 7.d0*temp363b/temp363
      distpb(i, 1) = distpb(i, 1) + (7.d0*temp362-r(i)**4)*zb(indorbp, i&
&        )
      rb(i) = rb(i) + 2*r(i)*temp362b - 4*r(i)**3*temp363b
      dd1b = dd1b - temp362*4.d0*temp362b
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp361 = r(k)**2
      temp361b5 = c*DEXP(-(dd1*temp361))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp361))*distpb(k, 1)
      dd1b = dd1b - temp361*temp361b5
      rb(k) = rb(k) - dd1*2*r(k)*temp361b5
      distpb(k, 1) = 0.0_8
    END DO
    IF (.NOT.(dd1 .LE. 0.0 .AND. (7.d0/4.d0 .EQ. 0.0 .OR. 7.d0/4.d0 .NE.&
&        INT(7.d0/4.d0)))) dd1b = dd1b + (2.d0/pi)**(3.d0/4.d0)*7.d0*dd1&
&        **(7.d0/4.d0-1)*cb/DSQRT(15.d0)
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (50) 
! 5s single zeta derivative of 12                   
! R(r)=(c0*r**4+c1*r**3)*exp(-z1*r)                                     
!                                                                       
!       if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
    c = DSQRT((2*dd1)**9/40320.d0/pi)/2.d0
!           endif 
    c0 = -c
    c1 = 4.5d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = r(k)*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)*dd1
      rp2 = rp1*rp1
!c              the first derivative/r                                  
      fun = -(distp(0, 1)*(c0*r(0)*(rp1-4.d0)+c1*(rp1-3.d0)))
!c                                                                      
!c              the second derivative                                   
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp371 = rp2 - 8.d0*rp1 + 12.d0
      temp370 = c0*r(0)
      temp370b0 = distp(0, 1)*fun2b
      distpb(0, 1) = (temp370*temp371+c1*(rp2-6*rp1+6.d0))*fun2b - (c0*r&
&        (0)*(rp1-4.d0)+c1*(rp1-3.d0))*funb
      temp370b1 = -(distp(0, 1)*funb)
      c0b = (rp1-4.d0)*r(0)*temp370b1 + temp371*r(0)*temp370b0
      rp2b = (c1+temp370)*temp370b0
      rp1b = (c1+c0*r(0))*temp370b1 + 2*rp1*rp2b + ((-6)*c1-temp370*8.d0&
&        )*temp370b0
      rb(0) = rb(0) + (rp1-4.d0)*c0*temp370b1 + dd1*rp1b + temp371*c0*&
&        temp370b0
      c1b = (rp1-3.d0)*temp370b1 + (rp2-6*rp1+6.d0)*temp370b0
      dd1b = r(0)*rp1b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp370b = distp(i, 1)*zb(indorbp, i)
      temp369 = r(i)**3
      c0b = c0b + temp369*temp370b
      rb(i) = rb(i) + (c1*2*r(i)+c0*3*r(i)**2)*temp370b
      c1b = c1b + r(i)**2*temp370b
      distpb(i, 1) = distpb(i, 1) + (c0*temp369+c1*r(i)**2)*zb(indorbp, &
&        i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp369b0 = r(k)*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) + DEXP(-(dd1*r(k)))*distpb(k, 1) - dd1*temp369b0
      dd1b = dd1b - r(k)*temp369b0
      distpb(k, 1) = 0.0_8
    END DO
    temp369b = 4.5d0*c1b/dd1
    cb = temp369b - c0b
    temp368 = 2**9
    IF (temp368*(dd1**9/(40320.d0*pi)) .EQ. 0.0) THEN
      dd1b = dd1b - c*temp369b/dd1
    ELSE
      dd1b = dd1b + temp368*9*dd1**8*cb/(2.d0*2.D0*DSQRT(temp368*(dd1**9&
&        /(40320.d0*pi)))*40320.d0*pi) - c*temp369b/dd1
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (51) 
!                                                                       
! g single gaussian orbital                                             
! R(r)= exp(-alpha r^2)                                                 
! normalized                                                            
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
!        c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0) 
    c = dd1**2.75d0*1.11284691281640568826d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0        
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2           
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2                   
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
!              indorbp=indorb 
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        ELSE IF (ic .EQ. 6) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE IF (ic .EQ. 7) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
        ELSE IF (ic .EQ. 8) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
        ELSE IF (ic .EQ. 9) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
        END IF
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp373b74 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb = funb + 10.d0*temp373b74
        fun2b = fun2b + temp373b74
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 5) THEN
          IF (branch .LT. 3) THEN
            IF (branch .LT. 2) THEN
              IF (branch .LT. 1) THEN
                temp373b19 = cost1g*fun0*zb(indorbp, indt+3)
                fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-60.d0*&
&                  (rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+2) + cost1g&
&                  *(12.d0*(rmu(1, 0)*r(0)**2)-60.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*zb(indorbp, indt+1) + cost1g*(80.d0*rmu(3, 0)**3&
&                  -48.d0*(rmu(3, 0)*r(0)**2))*zb(indorbp, indt+3)
                rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*r(&
&                  0)**2)*temp373b19
                temp373b20 = cost1g*fun0*zb(indorbp, indt+2)
                temp373b21 = cost1g*fun0*zb(indorbp, indt+1)
                rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp373b20 + &
&                  12.d0*rmu(1, 0)*2*r(0)*temp373b21 - 48.d0*rmu(3, 0)*2*&
&                  r(0)*temp373b19
                rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3, 0)&
&                  **2)*temp373b20
                rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp373b20
                rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3, 0)&
&                  **2)*temp373b21
                rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp373b21
              ELSE
                temp373b22 = -(cost2g*3.d0*zb(indorbp, indt+3))
                temp373b23 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)**&
&                  2)*temp373b22
                temp373b24 = fun0*rmu(1, 0)*temp373b22
                temp373b25 = -(cost2g*6.d0*zb(indorbp, indt+2))
                temp373b26 = rmu(2, 0)*rmu(3, 0)*temp373b25
                fun0b = fun0b + rmu(1, 0)*temp373b26 + cost2g*(4.d0*rmu(&
&                  3, 0)**3-3.d0*(rmu(2, 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)&
&                  **2*rmu(3, 0)))*zb(indorbp, indt+1) + rmu(1, 0)*&
&                  temp373b23
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp373b24 + fun0*&
&                  temp373b23
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp373b24
                rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp373b24
                temp373b27 = fun0*rmu(1, 0)*temp373b25
                rmub(1, 0) = rmub(1, 0) + fun0*temp373b26
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp373b27
                temp373b28 = cost2g*fun0*zb(indorbp, indt+1)
                rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*rmu(&
&                  2, 0)**2-9.d0*rmu(1, 0)**2)*temp373b28 + rmu(2, 0)*&
&                  temp373b27
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                  temp373b28
                rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                  temp373b28
              END IF
            ELSE
              temp373b29 = -(cost2g*3.d0*zb(indorbp, indt+3))
              temp373b30 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)**2)&
&                *temp373b29
              temp373b31 = fun0*rmu(2, 0)*temp373b29
              temp373b32 = -(cost2g*6.d0*zb(indorbp, indt+1))
              temp373b33 = rmu(2, 0)*rmu(3, 0)*temp373b32
              fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2, 0)&
&                **2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb(indorbp&
&                , indt+2) + rmu(1, 0)*temp373b33 + rmu(2, 0)*temp373b30
              rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp373b31 + fun0*&
&                temp373b30
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp373b31
              temp373b34 = cost2g*fun0*zb(indorbp, indt+2)
              rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*rmu(2&
&                , 0)**2-3.d0*rmu(1, 0)**2)*temp373b34 - 4.d0*2*rmu(3, 0)&
&                *temp373b31
              rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                temp373b34
              rmub(1, 0) = rmub(1, 0) + fun0*temp373b33 - 3.d0*rmu(3, 0)&
&                *2*rmu(1, 0)*temp373b34
              temp373b35 = fun0*rmu(1, 0)*temp373b32
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp373b35
              rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp373b35
            END IF
          ELSE IF (branch .LT. 4) THEN
            temp373b36 = cost3g*12.d0*zb(indorbp, indt+3)
            temp373b37 = fun0*rmu(3, 0)*temp373b36
            temp373b38 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp373b36
            rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp373b37
            rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp373b37
            temp373b39 = cost3g*4.d0*zb(indorbp, indt+2)
            temp373b40 = -(cost3g*4.d0*zb(indorbp, indt+1))
            fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)**2))&
&              *temp373b39 + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)**2))&
&              *temp373b40 + rmu(3, 0)*temp373b38
            rmub(3, 0) = rmub(3, 0) + fun0*temp373b38
            temp373b41 = fun0*temp373b39
            rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)**2)&
&              *temp373b41
            rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&              temp373b41
            temp373b42 = fun0*temp373b40
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)**2)&
&              *temp373b42
            rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&              temp373b42
          ELSE
            temp373b43 = cost3g*24.d0*zb(indorbp, indt+3)
            temp373b44 = rmu(2, 0)*rmu(3, 0)*temp373b43
            temp373b45 = fun0*rmu(1, 0)*temp373b43
            temp373b46 = -(cost3g*2.d0*zb(indorbp, indt+2))
            temp373b47 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0)&
&              **2)*temp373b46
            temp373b48 = -(cost3g*2.d0*zb(indorbp, indt+1))
            temp373b49 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3, 0)&
&              **2)*temp373b48
            fun0b = fun0b + rmu(1, 0)*temp373b47 + rmu(2, 0)*temp373b49 &
&              + rmu(1, 0)*temp373b44
            rmub(1, 0) = rmub(1, 0) + fun0*temp373b44
            rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp373b45
            rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp373b45
            temp373b50 = fun0*rmu(1, 0)*temp373b46
            rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp373b50 + fun0*&
&              temp373b47
            rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp373b50
            rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp373b50
            temp373b51 = fun0*rmu(2, 0)*temp373b48
            rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp373b51 + fun0*&
&              temp373b49
            rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp373b51
            rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp373b51
          END IF
        ELSE IF (branch .LT. 8) THEN
          IF (branch .LT. 7) THEN
            IF (branch .LT. 6) THEN
              temp373b52 = cost4g*fun0*zb(indorbp, indt+3)
              temp373b53 = -(cost4g*6.d0*zb(indorbp, indt+2))
              temp373b54 = rmu(2, 0)*rmu(3, 0)*temp373b53
              temp373b55 = cost4g*3.d0*zb(indorbp, indt+1)
              temp373b56 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp373b55
              fun0b = fun0b + rmu(1, 0)*temp373b54 + rmu(3, 0)*&
&                temp373b56 + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2&
&                , 0)**2))*zb(indorbp, indt+3)
              rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**&
&                2)*temp373b52
              rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                temp373b52
              temp373b57 = fun0*rmu(1, 0)*temp373b53
              rmub(1, 0) = rmub(1, 0) + fun0*temp373b54
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp373b57
              rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp373b57
              temp373b58 = fun0*rmu(3, 0)*temp373b55
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp373b58
              rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp373b58
              rmub(3, 0) = rmub(3, 0) + fun0*temp373b56
            ELSE
              temp373b59 = cost4g*fun0*zb(indorbp, indt+3)
              temp373b60 = cost4g*3.d0*zb(indorbp, indt+2)
              temp373b61 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp373b60
              temp373b62 = cost4g*6.d0*zb(indorbp, indt+1)
              temp373b63 = rmu(2, 0)*rmu(3, 0)*temp373b62
              fun0b = fun0b + rmu(3, 0)*temp373b61 + rmu(1, 0)*&
&                temp373b63 + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2&
&                , 0)**3)*zb(indorbp, indt+3)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp373b59
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp373b59
              temp373b64 = fun0*rmu(3, 0)*temp373b60
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp373b64
              rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp373b64
              rmub(3, 0) = rmub(3, 0) + fun0*temp373b61
              temp373b65 = fun0*rmu(1, 0)*temp373b62
              rmub(1, 0) = rmub(1, 0) + fun0*temp373b63
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp373b65
              rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp373b65
            END IF
          ELSE
            temp373b66 = cost5g*4.d0*zb(indorbp, indt+2)
            temp373b67 = fun0*temp373b66
            temp373b68 = cost5g*4.d0*zb(indorbp, indt+1)
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp373b68 + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)))&
&              *temp373b66
            rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**2)&
&              *temp373b67
            temp373b69 = fun0*temp373b68
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp373b69 - 3.d0*rmu(2, 0)*2*rmu(1, 0)*temp373b67
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp373b69
          END IF
        ELSE IF (.NOT.branch .LT. 9) THEN
          temp373b70 = cost5g*4.d0*zb(indorbp, indt+2)
          temp373b71 = fun0*temp373b70
          temp373b72 = cost5g*4.d0*zb(indorbp, indt+1)
          fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**3)*&
&            temp373b72 + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))*&
&            temp373b70
          rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)*&
&            temp373b71
          rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&            temp373b71
          temp373b73 = fun0*temp373b72
          rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&            temp373b73
          rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**2)*&
&            temp373b73
        END IF
        DO i=3,1,-1
          temp373b18 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp373b18
          funb = funb + rmu(i, 0)*temp373b18
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp373b17 = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp373b17 - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp373b17
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp373b = cost5g*4.d0*distpb(i, 10)
      temp373b0 = (rmu(1, i)**2-rmu(2, i)**2)*temp373b
      temp373b1 = rmu(1, i)*rmu(2, i)*temp373b
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp373b1 + rmu(2, i)*&
&        temp373b0
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp373b0 - 2*rmu(2, i)*&
&        temp373b1
      distpb(i, 10) = 0.0_8
      temp373b2 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp373b2
      distpb(i, 9) = 0.0_8
      temp373b3 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp373b4 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp373b3 - 2*rmu(2, i)*&
&        temp373b4 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp373b2
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp373b3
      distpb(i, 8) = 0.0_8
      temp373b5 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp373b6 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp373b5 + 2*rmu(1, i)*&
&        temp373b6 + 3.d0*2*rmu(1, i)*temp373b4
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp373b5
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp373b6
      distpb(i, 7) = 0.0_8
      temp373b7 = cost3g*2.d0*distpb(i, 6)
      temp373b8 = (7.d0*rmu(3, i)**2-r(i)**2)*temp373b7
      temp373b9 = rmu(1, i)*rmu(2, i)*temp373b7
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp373b8
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp373b8
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp373b9
      distpb(i, 6) = 0.0_8
      temp373b10 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp373b11 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp373b12 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp373b13 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp373b14 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp373b15 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp373b16 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp373b16 - 3.d0*2*r(i)*temp373b15 - 2*r(i)*temp373b11 - 3.d0*2&
&        *r(i)*temp373b13 - 2*r(i)*temp373b9
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp373b10
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp373b10
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp373b11
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp373b12
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp373b13 + rmu(2, i)*&
&        temp373b12
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp373b14
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp373b16 + 7.d0*2*rmu(3, i)*temp373b15 + rmu(1, i)*&
&        temp373b14
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp372 = r(k)**2
      temp372b = c*DEXP(-(dd1*temp372))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp372))*distpb(k, 1)
      dd1b = dd1b - temp372*temp372b
      rb(k) = rb(k) - dd1*2*r(k)*temp372b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.11284691281640568826d0*2.75d0*dd1**1.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (52) 
! g single gaussian orbital                                             
! derivative of 51
! R(r)= exp(-alpha r^2)                                                 
! normalized                                                            
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
!        c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0) 
    c = dd1**2.75d0*1.11284691281640568826d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0        
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2           
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2                   
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)*(11.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-15.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+21.d0*dd1*r(0)**2-15.d0&
&        /2.d0)
!              indorbp=indorb 
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
          ELSE IF (ic .EQ. 7) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            END IF
          ELSE IF (ic .EQ. 8) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
          ELSE IF (ic .EQ. 9) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp379b55 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb = funb + 10.d0*temp379b55
        fun2b = fun2b + temp379b55
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 15) THEN
            IF (branch .LT. 8) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    temp379b0 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2)-&
&                      60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp379b0
                    rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp379b0
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0&
&                      )*temp379b0
                  ELSE
                    temp379b1 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-&
&                      60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp379b1
                    rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp379b1
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0&
&                      )*temp379b1
                  END IF
                ELSE IF (branch .LT. 4) THEN
                  temp379b2 = cost1g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(rmu(&
&                    3, 0)*r(0)**2))*zb(indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*&
&                    r(0)**2)*temp379b2
                  rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp379b2
                ELSE
                  temp379b3 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*&
&                    rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp379b3
                  rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp379b3
                  rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp379b3
                END IF
              ELSE IF (branch .LT. 7) THEN
                IF (branch .LT. 6) THEN
                  temp379b4 = -(cost2g*6.d0*zb(indorbp, indt+i))
                  temp379b5 = rmu(2, 0)*rmu(3, 0)*temp379b4
                  temp379b6 = fun0*rmu(1, 0)*temp379b4
                  fun0b = fun0b + rmu(1, 0)*temp379b5
                  rmub(1, 0) = rmub(1, 0) + fun0*temp379b5
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp379b6
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp379b6
                ELSE
                  temp379b7 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp379b8 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp379b7
                  temp379b9 = fun0*rmu(1, 0)*temp379b7
                  fun0b = fun0b + rmu(1, 0)*temp379b8
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp379b9 + fun0&
&                    *temp379b8
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp379b9
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp379b9
                END IF
              ELSE
                temp379b10 = -(cost2g*6.d0*zb(indorbp, indt+i))
                temp379b11 = rmu(2, 0)*rmu(3, 0)*temp379b10
                temp379b12 = fun0*rmu(1, 0)*temp379b10
                fun0b = fun0b + rmu(1, 0)*temp379b11
                rmub(1, 0) = rmub(1, 0) + fun0*temp379b11
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp379b12
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp379b12
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  temp379b13 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*&
&                    rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp379b13
                  rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp379b13
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp379b13
                ELSE
                  temp379b14 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp379b15 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp379b14
                  temp379b16 = fun0*rmu(2, 0)*temp379b14
                  fun0b = fun0b + rmu(2, 0)*temp379b15
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp379b16 + &
&                    fun0*temp379b15
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp379b16
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp379b16
                END IF
              ELSE IF (branch .LT. 11) THEN
                temp379b17 = -(cost3g*4.d0*zb(indorbp, indt+i))
                temp379b18 = fun0*temp379b17
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*temp379b17
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp379b18
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp379b18
              ELSE
                temp379b19 = cost3g*4.d0*zb(indorbp, indt+i)
                temp379b20 = fun0*temp379b19
                fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)&
&                  **2))*temp379b19
                rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp379b20
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp379b20
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                temp379b21 = cost3g*12.d0*zb(indorbp, indt+i)
                temp379b22 = fun0*rmu(3, 0)*temp379b21
                temp379b23 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp379b21
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp379b22
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp379b22
                fun0b = fun0b + rmu(3, 0)*temp379b23
                rmub(3, 0) = rmub(3, 0) + fun0*temp379b23
              ELSE
                temp379b24 = -(cost3g*2.d0*zb(indorbp, indt+i))
                temp379b25 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3&
&                  , 0)**2)*temp379b24
                temp379b26 = fun0*rmu(2, 0)*temp379b24
                fun0b = fun0b + rmu(2, 0)*temp379b25
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp379b26 + fun0*&
&                  temp379b25
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp379b26
                rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp379b26
              END IF
            ELSE
              temp379b27 = -(cost3g*2.d0*zb(indorbp, indt+i))
              temp379b28 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0&
&                )**2)*temp379b27
              temp379b29 = fun0*rmu(1, 0)*temp379b27
              fun0b = fun0b + rmu(1, 0)*temp379b28
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp379b29 + fun0*&
&                temp379b28
              rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp379b29
              rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp379b29
            END IF
          ELSE IF (branch .LT. 22) THEN
            IF (branch .LT. 19) THEN
              IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  temp379b30 = cost3g*24.d0*zb(indorbp, indt+i)
                  temp379b31 = rmu(2, 0)*rmu(3, 0)*temp379b30
                  temp379b32 = fun0*rmu(1, 0)*temp379b30
                  fun0b = fun0b + rmu(1, 0)*temp379b31
                  rmub(1, 0) = rmub(1, 0) + fun0*temp379b31
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp379b32
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp379b32
                ELSE
                  temp379b33 = cost4g*3.d0*zb(indorbp, indt+i)
                  temp379b34 = fun0*rmu(3, 0)*temp379b33
                  temp379b35 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp379b33
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp379b34
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp379b34
                  fun0b = fun0b + rmu(3, 0)*temp379b35
                  rmub(3, 0) = rmub(3, 0) + fun0*temp379b35
                END IF
              ELSE IF (branch .LT. 18) THEN
                temp379b36 = -(cost4g*6.d0*zb(indorbp, indt+i))
                temp379b37 = rmu(2, 0)*rmu(3, 0)*temp379b36
                temp379b38 = fun0*rmu(1, 0)*temp379b36
                fun0b = fun0b + rmu(1, 0)*temp379b37
                rmub(1, 0) = rmub(1, 0) + fun0*temp379b37
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp379b38
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp379b38
              ELSE
                temp379b39 = cost4g*fun0*zb(indorbp, indt+i)
                fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu&
&                  (2, 0)**2))*zb(indorbp, indt+i)
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp379b39
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp379b39
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                temp379b40 = cost4g*6.d0*zb(indorbp, indt+i)
                temp379b41 = rmu(2, 0)*rmu(3, 0)*temp379b40
                temp379b42 = fun0*rmu(1, 0)*temp379b40
                fun0b = fun0b + rmu(1, 0)*temp379b41
                rmub(1, 0) = rmub(1, 0) + fun0*temp379b41
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp379b42
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp379b42
              ELSE
                temp379b43 = cost4g*3.d0*zb(indorbp, indt+i)
                temp379b44 = fun0*rmu(3, 0)*temp379b43
                temp379b45 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp379b43
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp379b44
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp379b44
                fun0b = fun0b + rmu(3, 0)*temp379b45
                rmub(3, 0) = rmub(3, 0) + fun0*temp379b45
              END IF
            ELSE
              temp379b46 = cost4g*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(&
&                2, 0)**3)*zb(indorbp, indt+i)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp379b46
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp379b46
            END IF
          ELSE IF (branch .LT. 26) THEN
            IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                temp379b47 = cost5g*4.d0*zb(indorbp, indt+i)
                temp379b48 = fun0*temp379b47
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp379b47
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp379b48
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp379b48
              END IF
            ELSE IF (branch .LT. 25) THEN
              temp379b49 = cost5g*4.d0*zb(indorbp, indt+i)
              temp379b50 = fun0*temp379b49
              fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)&
&                ))*temp379b49
              rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**&
&                2)*temp379b50
              rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp379b50
            END IF
          ELSE IF (branch .LT. 28) THEN
            IF (branch .LT. 27) THEN
              temp379b51 = cost5g*4.d0*zb(indorbp, indt+i)
              temp379b52 = fun0*temp379b51
              fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**&
&                3)*temp379b51
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp379b52
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp379b52
            END IF
          ELSE
            temp379b53 = cost5g*4.d0*zb(indorbp, indt+i)
            temp379b54 = fun0*temp379b53
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp379b53
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp379b54
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp379b54
          END IF
          temp379b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp379b
          funb = funb + rmu(i, 0)*temp379b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp378 = r(0)**4
      temp378b = distp(0, 1)*fun2b
      temp377 = 4.d0*dd1
      temp376 = 11.d0/temp377
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-15.d0/2.d0)*funb&
&        + (temp376-r(0)**2)*fun0b + (21.d0*(dd1*r(0)**2)-15.d0/2.d0-4.d0&
&        *(dd1**2*temp378))*fun2b
      temp378b0 = distp(0, 1)*2.d0*funb
      dd1b = r(0)**2*temp378b0 - distp(0, 1)*temp376*4.d0*fun0b/temp377 &
&        + (21.d0*r(0)**2-4.d0*temp378*2*dd1)*temp378b
      rb(0) = rb(0) + dd1*2*r(0)*temp378b0 - distp(0, 1)*2*r(0)*fun0b + &
&        (21.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp378b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    dd1b = 0.0_8
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        temp376b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp375 = 4.d0*dd1
        temp374 = 11.d0/temp375
        temp374b17 = (temp374-r(k)**2)*zb(indorbp, k)
        dd1b = dd1b - temp374*4.d0*temp376b/temp375
        rb(k) = rb(k) - 2*r(k)*temp376b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp374b17
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp374b17
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp374b = cost5g*4.d0*distpb(i, 10)
      temp374b0 = (rmu(1, i)**2-rmu(2, i)**2)*temp374b
      temp374b1 = rmu(1, i)*rmu(2, i)*temp374b
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp374b1 + rmu(2, i)*&
&        temp374b0
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp374b0 - 2*rmu(2, i)*&
&        temp374b1
      distpb(i, 10) = 0.0_8
      temp374b2 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp374b2
      distpb(i, 9) = 0.0_8
      temp374b3 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp374b4 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp374b3 - 2*rmu(2, i)*&
&        temp374b4 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp374b2
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp374b3
      distpb(i, 8) = 0.0_8
      temp374b5 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp374b6 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp374b5 + 2*rmu(1, i)*&
&        temp374b6 + 3.d0*2*rmu(1, i)*temp374b4
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp374b5
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp374b6
      distpb(i, 7) = 0.0_8
      temp374b7 = cost3g*2.d0*distpb(i, 6)
      temp374b8 = (7.d0*rmu(3, i)**2-r(i)**2)*temp374b7
      temp374b9 = rmu(1, i)*rmu(2, i)*temp374b7
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp374b8
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp374b8
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp374b9
      distpb(i, 6) = 0.0_8
      temp374b10 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp374b11 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp374b12 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp374b13 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp374b14 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp374b15 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp374b16 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp374b16 - 3.d0*2*r(i)*temp374b15 - 2*r(i)*temp374b11 - 3.d0*2&
&        *r(i)*temp374b13 - 2*r(i)*temp374b9
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp374b10
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp374b10
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp374b11
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp374b12
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp374b13 + rmu(2, i)*&
&        temp374b12
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp374b14
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp374b16 + 7.d0*2*rmu(3, i)*temp374b15 + rmu(1, i)*&
&        temp374b14
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp373 = r(k)**2
      temp373b75 = c*DEXP(-(dd1*temp373))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp373))*distpb(k, 1)
      dd1b = dd1b - temp373*temp373b75
      rb(k) = rb(k) - dd1*2*r(k)*temp373b75
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.11284691281640568826d0*2.75d0*dd1**1.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (55) 
! g single Slater orbital                                             
! R(r)= exp(-alpha r)                                                 
! normalized                                                            
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
! l = 4
! \int d\omega Y*Y = 4 pi / (2 l + 1)
! \int dr r^{2 l + 2} Exp [- 2 dd1 r^2 ] =  7 * 5**2 * 3**4 / 2**3 / dd1**11 
!        c=1.d0/dsqrt(7.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(11.d0/2.d0)/3.d0/5.d0 
    c = dd1**5.5d0*.020104801169736915d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0        
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2           
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2                   
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(dd1*distp(0, 1)/r(0))
      fun2 = dd1**2*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
          ELSE IF (ic .EQ. 7) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            END IF
          ELSE IF (ic .EQ. 8) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
          ELSE IF (ic .EQ. 9) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp380b55 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb = funb + 10.d0*temp380b55
        fun2b = fun2b + temp380b55
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 15) THEN
            IF (branch .LT. 8) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    temp380b0 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2)-&
&                      60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp380b0
                    rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp380b0
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0&
&                      )*temp380b0
                  ELSE
                    temp380b1 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-&
&                      60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp380b1
                    rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp380b1
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0&
&                      )*temp380b1
                  END IF
                ELSE IF (branch .LT. 4) THEN
                  temp380b2 = cost1g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(rmu(&
&                    3, 0)*r(0)**2))*zb(indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*&
&                    r(0)**2)*temp380b2
                  rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp380b2
                ELSE
                  temp380b3 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*&
&                    rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp380b3
                  rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp380b3
                  rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp380b3
                END IF
              ELSE IF (branch .LT. 7) THEN
                IF (branch .LT. 6) THEN
                  temp380b4 = -(cost2g*6.d0*zb(indorbp, indt+i))
                  temp380b5 = rmu(2, 0)*rmu(3, 0)*temp380b4
                  temp380b6 = fun0*rmu(1, 0)*temp380b4
                  fun0b = fun0b + rmu(1, 0)*temp380b5
                  rmub(1, 0) = rmub(1, 0) + fun0*temp380b5
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp380b6
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp380b6
                ELSE
                  temp380b7 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp380b8 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp380b7
                  temp380b9 = fun0*rmu(1, 0)*temp380b7
                  fun0b = fun0b + rmu(1, 0)*temp380b8
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp380b9 + fun0&
&                    *temp380b8
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp380b9
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp380b9
                END IF
              ELSE
                temp380b10 = -(cost2g*6.d0*zb(indorbp, indt+i))
                temp380b11 = rmu(2, 0)*rmu(3, 0)*temp380b10
                temp380b12 = fun0*rmu(1, 0)*temp380b10
                fun0b = fun0b + rmu(1, 0)*temp380b11
                rmub(1, 0) = rmub(1, 0) + fun0*temp380b11
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp380b12
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp380b12
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  temp380b13 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*&
&                    rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp380b13
                  rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp380b13
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp380b13
                ELSE
                  temp380b14 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp380b15 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp380b14
                  temp380b16 = fun0*rmu(2, 0)*temp380b14
                  fun0b = fun0b + rmu(2, 0)*temp380b15
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp380b16 + &
&                    fun0*temp380b15
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp380b16
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp380b16
                END IF
              ELSE IF (branch .LT. 11) THEN
                temp380b17 = -(cost3g*4.d0*zb(indorbp, indt+i))
                temp380b18 = fun0*temp380b17
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*temp380b17
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp380b18
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp380b18
              ELSE
                temp380b19 = cost3g*4.d0*zb(indorbp, indt+i)
                temp380b20 = fun0*temp380b19
                fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)&
&                  **2))*temp380b19
                rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp380b20
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp380b20
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                temp380b21 = cost3g*12.d0*zb(indorbp, indt+i)
                temp380b22 = fun0*rmu(3, 0)*temp380b21
                temp380b23 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp380b21
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp380b22
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp380b22
                fun0b = fun0b + rmu(3, 0)*temp380b23
                rmub(3, 0) = rmub(3, 0) + fun0*temp380b23
              ELSE
                temp380b24 = -(cost3g*2.d0*zb(indorbp, indt+i))
                temp380b25 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3&
&                  , 0)**2)*temp380b24
                temp380b26 = fun0*rmu(2, 0)*temp380b24
                fun0b = fun0b + rmu(2, 0)*temp380b25
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp380b26 + fun0*&
&                  temp380b25
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp380b26
                rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp380b26
              END IF
            ELSE
              temp380b27 = -(cost3g*2.d0*zb(indorbp, indt+i))
              temp380b28 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0&
&                )**2)*temp380b27
              temp380b29 = fun0*rmu(1, 0)*temp380b27
              fun0b = fun0b + rmu(1, 0)*temp380b28
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp380b29 + fun0*&
&                temp380b28
              rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp380b29
              rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp380b29
            END IF
          ELSE IF (branch .LT. 22) THEN
            IF (branch .LT. 19) THEN
              IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  temp380b30 = cost3g*24.d0*zb(indorbp, indt+i)
                  temp380b31 = rmu(2, 0)*rmu(3, 0)*temp380b30
                  temp380b32 = fun0*rmu(1, 0)*temp380b30
                  fun0b = fun0b + rmu(1, 0)*temp380b31
                  rmub(1, 0) = rmub(1, 0) + fun0*temp380b31
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp380b32
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp380b32
                ELSE
                  temp380b33 = cost4g*3.d0*zb(indorbp, indt+i)
                  temp380b34 = fun0*rmu(3, 0)*temp380b33
                  temp380b35 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp380b33
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp380b34
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp380b34
                  fun0b = fun0b + rmu(3, 0)*temp380b35
                  rmub(3, 0) = rmub(3, 0) + fun0*temp380b35
                END IF
              ELSE IF (branch .LT. 18) THEN
                temp380b36 = -(cost4g*6.d0*zb(indorbp, indt+i))
                temp380b37 = rmu(2, 0)*rmu(3, 0)*temp380b36
                temp380b38 = fun0*rmu(1, 0)*temp380b36
                fun0b = fun0b + rmu(1, 0)*temp380b37
                rmub(1, 0) = rmub(1, 0) + fun0*temp380b37
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp380b38
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp380b38
              ELSE
                temp380b39 = cost4g*fun0*zb(indorbp, indt+i)
                fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu&
&                  (2, 0)**2))*zb(indorbp, indt+i)
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp380b39
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp380b39
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                temp380b40 = cost4g*6.d0*zb(indorbp, indt+i)
                temp380b41 = rmu(2, 0)*rmu(3, 0)*temp380b40
                temp380b42 = fun0*rmu(1, 0)*temp380b40
                fun0b = fun0b + rmu(1, 0)*temp380b41
                rmub(1, 0) = rmub(1, 0) + fun0*temp380b41
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp380b42
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp380b42
              ELSE
                temp380b43 = cost4g*3.d0*zb(indorbp, indt+i)
                temp380b44 = fun0*rmu(3, 0)*temp380b43
                temp380b45 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp380b43
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp380b44
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp380b44
                fun0b = fun0b + rmu(3, 0)*temp380b45
                rmub(3, 0) = rmub(3, 0) + fun0*temp380b45
              END IF
            ELSE
              temp380b46 = cost4g*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(&
&                2, 0)**3)*zb(indorbp, indt+i)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp380b46
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp380b46
            END IF
          ELSE IF (branch .LT. 26) THEN
            IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                temp380b47 = cost5g*4.d0*zb(indorbp, indt+i)
                temp380b48 = fun0*temp380b47
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp380b47
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp380b48
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp380b48
              END IF
            ELSE IF (branch .LT. 25) THEN
              temp380b49 = cost5g*4.d0*zb(indorbp, indt+i)
              temp380b50 = fun0*temp380b49
              fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)&
&                ))*temp380b49
              rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**&
&                2)*temp380b50
              rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp380b50
            END IF
          ELSE IF (branch .LT. 28) THEN
            IF (branch .LT. 27) THEN
              temp380b51 = cost5g*4.d0*zb(indorbp, indt+i)
              temp380b52 = fun0*temp380b51
              fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**&
&                3)*temp380b51
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp380b52
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp380b52
            END IF
          ELSE
            temp380b53 = cost5g*4.d0*zb(indorbp, indt+i)
            temp380b54 = fun0*temp380b53
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp380b53
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp380b54
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp380b54
          END IF
          temp380b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp380b
          funb = funb + rmu(i, 0)*temp380b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp379b75 = -(distp(0, 1)*funb/r(0))
      dd1b = temp379b75 + distp(0, 1)*2*dd1*fun2b
      temp379 = dd1/r(0)
      distpb(0, 1) = distpb(0, 1) + fun0b - temp379*funb + dd1**2*fun2b
      rb(0) = rb(0) - temp379*temp379b75
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp379b57 = cost5g*4.d0*distpb(i, 10)
      temp379b58 = (rmu(1, i)**2-rmu(2, i)**2)*temp379b57
      temp379b59 = rmu(1, i)*rmu(2, i)*temp379b57
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp379b59 + rmu(2, i)*&
&        temp379b58
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp379b58 - 2*rmu(2, i)*&
&        temp379b59
      distpb(i, 10) = 0.0_8
      temp379b60 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp379b60
      distpb(i, 9) = 0.0_8
      temp379b61 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp379b62 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp379b61 - 2*rmu(2, i)*&
&        temp379b62 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp379b60
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp379b61
      distpb(i, 8) = 0.0_8
      temp379b63 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp379b64 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp379b63 + 2*rmu(1, i)*&
&        temp379b64 + 3.d0*2*rmu(1, i)*temp379b62
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp379b63
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp379b64
      distpb(i, 7) = 0.0_8
      temp379b65 = cost3g*2.d0*distpb(i, 6)
      temp379b66 = (7.d0*rmu(3, i)**2-r(i)**2)*temp379b65
      temp379b67 = rmu(1, i)*rmu(2, i)*temp379b65
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp379b66
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp379b66
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp379b67
      distpb(i, 6) = 0.0_8
      temp379b68 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp379b69 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp379b70 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp379b71 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp379b72 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp379b73 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp379b74 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp379b74 - 3.d0*2*r(i)*temp379b73 - 2*r(i)*temp379b69 - 3.d0*2&
&        *r(i)*temp379b71 - 2*r(i)*temp379b67
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp379b68
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp379b68
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp379b69
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp379b70
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp379b71 + rmu(2, i)*&
&        temp379b70
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp379b72
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp379b74 + 7.d0*2*rmu(3, i)*temp379b73 + rmu(1, i)*&
&        temp379b72
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp379b56 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp379b56
      rb(k) = rb(k) - dd1*temp379b56
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .020104801169736915d0*5.5d0*dd1**4.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (56) 
! g single Slater orbital derivative of 55                                             
! R(r)= (11.d0/2.0 1/dd1 - r) * exp(-alpha r)                                                 
! normalized                                                            
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization                                                 
! l = 4
! \int d\omega Y*Y = 4 pi / (2 l + 1)
! \int dr r^{2 l + 2} Exp [- 2 dd1 r^2 ] =  7 * 5**2 * 3**4 / 2**3 / dd1**11 
    c = dd1**5.5d0*.020104801169736915d0
!        c=1.d0/dsqrt(7.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(11.d0/2.d0)/3.d0/5.d0 
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0        
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1         
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2           
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2                   
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)*(11.d0/2.d0/dd1-r(0))
      fun = distp(0, 1)*(dd1-13.d0/2.d0/r(0))
      fun2 = dd1*distp(0, 1)*(15.d0/2.d0-dd1*r(0))
!              indorbp=indorb 
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
          ELSE IF (ic .EQ. 7) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            END IF
          ELSE IF (ic .EQ. 8) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
          ELSE IF (ic .EQ. 9) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp386b57 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb = funb + 10.d0*temp386b57
        fun2b = fun2b + temp386b57
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 15) THEN
            IF (branch .LT. 8) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    temp386b2 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2)-&
&                      60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp386b2
                    rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp386b2
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0&
&                      )*temp386b2
                  ELSE
                    temp386b3 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-&
&                      60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp386b3
                    rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp386b3
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0&
&                      )*temp386b3
                  END IF
                ELSE IF (branch .LT. 4) THEN
                  temp386b4 = cost1g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(rmu(&
&                    3, 0)*r(0)**2))*zb(indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*&
&                    r(0)**2)*temp386b4
                  rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp386b4
                ELSE
                  temp386b5 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*&
&                    rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp386b5
                  rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp386b5
                  rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp386b5
                END IF
              ELSE IF (branch .LT. 7) THEN
                IF (branch .LT. 6) THEN
                  temp386b6 = -(cost2g*6.d0*zb(indorbp, indt+i))
                  temp386b7 = rmu(2, 0)*rmu(3, 0)*temp386b6
                  temp386b8 = fun0*rmu(1, 0)*temp386b6
                  fun0b = fun0b + rmu(1, 0)*temp386b7
                  rmub(1, 0) = rmub(1, 0) + fun0*temp386b7
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp386b8
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp386b8
                ELSE
                  temp386b9 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp386b10 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp386b9
                  temp386b11 = fun0*rmu(1, 0)*temp386b9
                  fun0b = fun0b + rmu(1, 0)*temp386b10
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp386b11 + &
&                    fun0*temp386b10
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp386b11
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp386b11
                END IF
              ELSE
                temp386b12 = -(cost2g*6.d0*zb(indorbp, indt+i))
                temp386b13 = rmu(2, 0)*rmu(3, 0)*temp386b12
                temp386b14 = fun0*rmu(1, 0)*temp386b12
                fun0b = fun0b + rmu(1, 0)*temp386b13
                rmub(1, 0) = rmub(1, 0) + fun0*temp386b13
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp386b14
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp386b14
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  temp386b15 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*&
&                    rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp386b15
                  rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp386b15
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp386b15
                ELSE
                  temp386b16 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp386b17 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp386b16
                  temp386b18 = fun0*rmu(2, 0)*temp386b16
                  fun0b = fun0b + rmu(2, 0)*temp386b17
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp386b18 + &
&                    fun0*temp386b17
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp386b18
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp386b18
                END IF
              ELSE IF (branch .LT. 11) THEN
                temp386b19 = -(cost3g*4.d0*zb(indorbp, indt+i))
                temp386b20 = fun0*temp386b19
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*temp386b19
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp386b20
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp386b20
              ELSE
                temp386b21 = cost3g*4.d0*zb(indorbp, indt+i)
                temp386b22 = fun0*temp386b21
                fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)&
&                  **2))*temp386b21
                rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp386b22
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp386b22
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                temp386b23 = cost3g*12.d0*zb(indorbp, indt+i)
                temp386b24 = fun0*rmu(3, 0)*temp386b23
                temp386b25 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp386b23
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp386b24
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp386b24
                fun0b = fun0b + rmu(3, 0)*temp386b25
                rmub(3, 0) = rmub(3, 0) + fun0*temp386b25
              ELSE
                temp386b26 = -(cost3g*2.d0*zb(indorbp, indt+i))
                temp386b27 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3&
&                  , 0)**2)*temp386b26
                temp386b28 = fun0*rmu(2, 0)*temp386b26
                fun0b = fun0b + rmu(2, 0)*temp386b27
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp386b28 + fun0*&
&                  temp386b27
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp386b28
                rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp386b28
              END IF
            ELSE
              temp386b29 = -(cost3g*2.d0*zb(indorbp, indt+i))
              temp386b30 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0&
&                )**2)*temp386b29
              temp386b31 = fun0*rmu(1, 0)*temp386b29
              fun0b = fun0b + rmu(1, 0)*temp386b30
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp386b31 + fun0*&
&                temp386b30
              rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp386b31
              rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp386b31
            END IF
          ELSE IF (branch .LT. 22) THEN
            IF (branch .LT. 19) THEN
              IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  temp386b32 = cost3g*24.d0*zb(indorbp, indt+i)
                  temp386b33 = rmu(2, 0)*rmu(3, 0)*temp386b32
                  temp386b34 = fun0*rmu(1, 0)*temp386b32
                  fun0b = fun0b + rmu(1, 0)*temp386b33
                  rmub(1, 0) = rmub(1, 0) + fun0*temp386b33
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp386b34
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp386b34
                ELSE
                  temp386b35 = cost4g*3.d0*zb(indorbp, indt+i)
                  temp386b36 = fun0*rmu(3, 0)*temp386b35
                  temp386b37 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp386b35
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp386b36
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp386b36
                  fun0b = fun0b + rmu(3, 0)*temp386b37
                  rmub(3, 0) = rmub(3, 0) + fun0*temp386b37
                END IF
              ELSE IF (branch .LT. 18) THEN
                temp386b38 = -(cost4g*6.d0*zb(indorbp, indt+i))
                temp386b39 = rmu(2, 0)*rmu(3, 0)*temp386b38
                temp386b40 = fun0*rmu(1, 0)*temp386b38
                fun0b = fun0b + rmu(1, 0)*temp386b39
                rmub(1, 0) = rmub(1, 0) + fun0*temp386b39
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp386b40
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp386b40
              ELSE
                temp386b41 = cost4g*fun0*zb(indorbp, indt+i)
                fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu&
&                  (2, 0)**2))*zb(indorbp, indt+i)
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp386b41
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp386b41
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                temp386b42 = cost4g*6.d0*zb(indorbp, indt+i)
                temp386b43 = rmu(2, 0)*rmu(3, 0)*temp386b42
                temp386b44 = fun0*rmu(1, 0)*temp386b42
                fun0b = fun0b + rmu(1, 0)*temp386b43
                rmub(1, 0) = rmub(1, 0) + fun0*temp386b43
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp386b44
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp386b44
              ELSE
                temp386b45 = cost4g*3.d0*zb(indorbp, indt+i)
                temp386b46 = fun0*rmu(3, 0)*temp386b45
                temp386b47 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp386b45
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp386b46
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp386b46
                fun0b = fun0b + rmu(3, 0)*temp386b47
                rmub(3, 0) = rmub(3, 0) + fun0*temp386b47
              END IF
            ELSE
              temp386b48 = cost4g*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(&
&                2, 0)**3)*zb(indorbp, indt+i)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp386b48
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp386b48
            END IF
          ELSE IF (branch .LT. 26) THEN
            IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                temp386b49 = cost5g*4.d0*zb(indorbp, indt+i)
                temp386b50 = fun0*temp386b49
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp386b49
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp386b50
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp386b50
              END IF
            ELSE IF (branch .LT. 25) THEN
              temp386b51 = cost5g*4.d0*zb(indorbp, indt+i)
              temp386b52 = fun0*temp386b51
              fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)&
&                ))*temp386b51
              rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**&
&                2)*temp386b52
              rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp386b52
            END IF
          ELSE IF (branch .LT. 28) THEN
            IF (branch .LT. 27) THEN
              temp386b53 = cost5g*4.d0*zb(indorbp, indt+i)
              temp386b54 = fun0*temp386b53
              fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**&
&                3)*temp386b53
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp386b54
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp386b54
            END IF
          ELSE
            temp386b55 = cost5g*4.d0*zb(indorbp, indt+i)
            temp386b56 = fun0*temp386b55
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp386b55
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp386b56
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp386b56
          END IF
          temp386b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp386b1
          funb = funb + rmu(i, 0)*temp386b1
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp386b = (15.d0/2.d0-dd1*r(0))*fun2b
      temp386b0 = dd1*distp(0, 1)*fun2b
      temp383 = 2.d0*dd1
      temp382 = 11.d0/temp383
      dd1b = distp(0, 1)*funb - distp(0, 1)*temp382*2.d0*fun0b/temp383 -&
&        r(0)*temp386b0 + distp(0, 1)*temp386b
      temp385 = 2.d0*r(0)
      temp384 = 13.d0/temp385
      distpb(0, 1) = distpb(0, 1) + (dd1-temp384)*funb + (temp382-r(0))*&
&        fun0b + dd1*temp386b
      rb(0) = rb(0) + distp(0, 1)*temp384*2.d0*funb/temp385 - distp(0, 1&
&        )*fun0b - dd1*temp386b0
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    dd1b = 0.0_8
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        temp381 = 2.d0*dd1
        temp380 = 11.d0/temp381
        temp380b75 = (temp380-r(k))*zb(indorbp, k)
        temp380b76 = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp380b75
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp380b75
        dd1b = dd1b - temp380*2.d0*temp380b76/temp381
        rb(k) = rb(k) - temp380b76
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp380b57 = cost5g*4.d0*distpb(i, 10)
      temp380b58 = (rmu(1, i)**2-rmu(2, i)**2)*temp380b57
      temp380b59 = rmu(1, i)*rmu(2, i)*temp380b57
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp380b59 + rmu(2, i)*&
&        temp380b58
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp380b58 - 2*rmu(2, i)*&
&        temp380b59
      distpb(i, 10) = 0.0_8
      temp380b60 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp380b60
      distpb(i, 9) = 0.0_8
      temp380b61 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp380b62 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp380b61 - 2*rmu(2, i)*&
&        temp380b62 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp380b60
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp380b61
      distpb(i, 8) = 0.0_8
      temp380b63 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp380b64 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp380b63 + 2*rmu(1, i)*&
&        temp380b64 + 3.d0*2*rmu(1, i)*temp380b62
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp380b63
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp380b64
      distpb(i, 7) = 0.0_8
      temp380b65 = cost3g*2.d0*distpb(i, 6)
      temp380b66 = (7.d0*rmu(3, i)**2-r(i)**2)*temp380b65
      temp380b67 = rmu(1, i)*rmu(2, i)*temp380b65
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp380b66
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp380b66
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp380b67
      distpb(i, 6) = 0.0_8
      temp380b68 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp380b69 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp380b70 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp380b71 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp380b72 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp380b73 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp380b74 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp380b74 - 3.d0*2*r(i)*temp380b73 - 2*r(i)*temp380b69 - 3.d0*2&
&        *r(i)*temp380b71 - 2*r(i)*temp380b67
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp380b68
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp380b68
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp380b69
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp380b70
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp380b71 + rmu(2, i)*&
&        temp380b70
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp380b72
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp380b74 + 7.d0*2*rmu(3, i)*temp380b73 + rmu(1, i)*&
&        temp380b72
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp380b56 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp380b56
      rb(k) = rb(k) - dd1*temp380b56
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .020104801169736915d0*5.5d0*dd1**4.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (72) 
! h-orbitals
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization  obtained by Mathematica                                               
    c = dd1**3.25d0*0.79296269381073167718d0
!  C= dd1^13/4 /Sqrt[Integrate[x^12 Exp[-2 x^2],{x,0,Infinity}]] 
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      DO k=1,5
        CALL PUSHREAL8(adr8ibuf,adr8buf,zv(k))
        zv(k) = rmu(3, i)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,yv(k))
        yv(k) = rmu(2, i)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,xv(k))
        xv(k) = rmu(1, i)**k
      END DO
      CALL PUSHREAL8(adr8ibuf,adr8buf,r2)
      r2 = xv(2) + yv(2) + zv(2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,r4)
      r4 = r2*r2
! lz=0        
      distp(i, 2) = cost1h*(63.d0*zv(5)-70.d0*zv(3)*r2+15.d0*zv(1)*r4)
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 21.d0*zv(4) - 14.d0*zv(2)*r2 + r4
! lz=+/-1         
      distp(i, 3) = cost2h*rmu(1, i)*cost
! lz=+/-1         
      distp(i, 4) = cost2h*rmu(2, i)*cost
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 3.d0*zv(3) - zv(1)*r2
! lz=+/-2         
      distp(i, 5) = cost3h*(xv(2)-yv(2))*cost
! lz=+/-2           
      distp(i, 6) = 2.d0*cost3h*xv(1)*yv(1)*cost
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 9.d0*zv(2) - r2
! lz=+/-3                   
      distp(i, 7) = cost4h*(xv(3)-3.d0*xv(1)*yv(2))*cost
! lz=+/-3                   
      distp(i, 8) = -(cost4h*(yv(3)-3.d0*yv(1)*xv(2))*cost)
! lz=+/-4
      distp(i, 9) = cost5h*(xv(4)-6.d0*xv(2)*yv(2)+yv(4))*zv(1)
! lz=+/-4
      distp(i, 10) = cost5h*4.d0*(xv(3)*yv(1)-yv(3)*xv(1))*zv(1)
! lz=+/-5
      distp(i, 11) = cost6h*(xv(5)-10.d0*xv(3)*yv(2)+5.d0*xv(1)*yv(4))
! lz=+/-5
      distp(i, 12) = -(cost6h*(-(5.d0*xv(4)*yv(1))+10.d0*xv(2)*yv(3)-yv(&
&        5)))
    END DO
    DO ic=1,11
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      DO k=1,5
        CALL PUSHREAL8(adr8ibuf,adr8buf,zv(k))
        zv(k) = rmu(3, 0)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,yv(k))
        yv(k) = rmu(2, 0)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,xv(k))
        xv(k) = rmu(1, 0)**k
      END DO
      CALL PUSHREAL8(adr8ibuf,adr8buf,r2)
      r2 = xv(2) + yv(2) + zv(2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,r4)
      r4 = r2*r2
!              indorbp=indorb 
      DO ic=1,11
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        ELSE IF (ic .EQ. 6) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE IF (ic .EQ. 7) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
        ELSE IF (ic .EQ. 8) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
        ELSE IF (ic .EQ. 9) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
        ELSE IF (ic .EQ. 10) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
        ELSE IF (ic .EQ. 11) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
        END IF
      END DO
      distpb = 0.0_8
      zvb = 0.0_8
      xvb = 0.0_8
      funb = 0.0_8
      yvb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      r2b = 0.0_8
      r4b = 0.0_8
      DO ic=11,1,-1
        temp387b61 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (12.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb = funb + 12.d0*temp387b61
        fun2b = fun2b + temp387b61
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 6) THEN
          IF (branch .LT. 3) THEN
            IF (branch .LT. 2) THEN
              IF (branch .LT. 1) THEN
                temp387b11 = cost1h*fun0*zb(indorbp, indt+3)
                temp387b12 = cost1h*20.d0*zb(indorbp, indt+2)
                temp387b13 = (3.d0*xv(2)+3.d0*yv(2)-4.d0*zv(2))*&
&                  temp387b12
                temp387b14 = cost1h*20.d0*zb(indorbp, indt+1)
                temp387b15 = (3.d0*xv(2)+3.d0*yv(2)-4.d0*zv(2))*&
&                  temp387b14
                fun0b = fun0b + zv(1)*yv(1)*temp387b13 + zv(1)*xv(1)*&
&                  temp387b15 + cost1h*(175.d0*zv(4)-150.d0*(zv(2)*r2)+&
&                  15.d0*r4)*zb(indorbp, indt+3)
                zvb(4) = zvb(4) + 175.d0*temp387b11
                zvb(2) = zvb(2) - 150.d0*r2*temp387b11
                r2b = r2b - 150.d0*zv(2)*temp387b11
                r4b = r4b + 15.d0*temp387b11
                temp387b16 = fun0*yv(1)*zv(1)*temp387b12
                yvb(1) = yvb(1) + zv(1)*fun0*temp387b13
                zvb(1) = zvb(1) + fun0*yv(1)*temp387b13
                xvb(2) = xvb(2) + 3.d0*temp387b16
                temp387b17 = fun0*xv(1)*zv(1)*temp387b14
                yvb(2) = yvb(2) + 3.d0*temp387b17 + 3.d0*temp387b16
                zvb(2) = zvb(2) - 4.d0*temp387b16
                xvb(1) = xvb(1) + zv(1)*fun0*temp387b15
                zvb(1) = zvb(1) + fun0*xv(1)*temp387b15
                xvb(2) = xvb(2) + 3.d0*temp387b17
                zvb(2) = zvb(2) - 4.d0*temp387b17
              ELSE
                temp387b18 = cost2h*fun0*zb(indorbp, indt+3)
                temp387b19 = -(24.d0*zv(1)*temp387b18)
                fun0b = fun0b + cost2h*(4.d0*(xv(3)*yv(1))+4.d0*(xv(1)*&
&                  yv(3))-24.d0*(xv(1)*yv(1)*zv(2)))*zb(indorbp, indt+2) &
&                  + cost2h*(5.d0*xv(4)+6.d0*(xv(2)*yv(2))+yv(4)+8.d0*zv(&
&                  4)-12.d0*(yv(2)*zv(2))-36.d0*(xv(2)*zv(2)))*zb(indorbp&
&                  , indt+1) + cost2h*(32.d0*(zv(3)*xv(1))-24.d0*(xv(1)*&
&                  yv(2)*zv(1))-24.d0*(xv(3)*zv(1)))*zb(indorbp, indt+3)
                zvb(3) = zvb(3) + 32.d0*xv(1)*temp387b18
                xvb(1) = xvb(1) + yv(2)*temp387b19 + 32.d0*zv(3)*&
&                  temp387b18
                yvb(2) = yvb(2) + xv(1)*temp387b19
                zvb(1) = zvb(1) + (-(24.d0*xv(3))-24.d0*xv(1)*yv(2))*&
&                  temp387b18
                temp387b20 = cost2h*fun0*zb(indorbp, indt+2)
                xvb(3) = xvb(3) + 4.d0*yv(1)*temp387b20 - 24.d0*zv(1)*&
&                  temp387b18
                temp387b21 = -(24.d0*zv(2)*temp387b20)
                yvb(1) = yvb(1) + xv(1)*temp387b21 + 4.d0*xv(3)*&
&                  temp387b20
                xvb(1) = xvb(1) + yv(1)*temp387b21 + 4.d0*yv(3)*&
&                  temp387b20
                yvb(3) = yvb(3) + 4.d0*xv(1)*temp387b20
                zvb(2) = zvb(2) - 24.d0*xv(1)*yv(1)*temp387b20
                temp387b22 = cost2h*fun0*zb(indorbp, indt+1)
                xvb(4) = xvb(4) + 5.d0*temp387b22
                xvb(2) = xvb(2) + (6.d0*yv(2)-36.d0*zv(2))*temp387b22
                yvb(2) = yvb(2) + (6.d0*xv(2)-12.d0*zv(2))*temp387b22
                yvb(4) = yvb(4) + temp387b22
                zvb(4) = zvb(4) + 8.d0*temp387b22
                zvb(2) = zvb(2) + (-(36.d0*xv(2))-12.d0*yv(2))*&
&                  temp387b22
              END IF
            ELSE
              temp387b23 = cost2h*fun0*zb(indorbp, indt+3)
              temp387b24 = -(24.d0*zv(1)*temp387b23)
              fun0b = fun0b + cost2h*(5.d0*yv(4)+6.d0*(xv(2)*yv(2))+xv(4&
&                )+8.d0*zv(4)-12.d0*(xv(2)*zv(2))-36.d0*(yv(2)*zv(2)))*zb&
&                (indorbp, indt+2) - cost2h*(24.d0*(xv(1)*yv(1)*zv(2))-&
&                4.d0*(xv(1)*yv(3))-4.d0*(xv(3)*yv(1)))*zb(indorbp, indt+&
&                1) + cost2h*(32.d0*(zv(3)*yv(1))-24.d0*(yv(1)*xv(2)*zv(1&
&                ))-24.d0*(yv(3)*zv(1)))*zb(indorbp, indt+3)
              zvb(3) = zvb(3) + 32.d0*yv(1)*temp387b23
              yvb(1) = yvb(1) + xv(2)*temp387b24 + 32.d0*zv(3)*&
&                temp387b23
              temp387b25 = cost2h*fun0*zb(indorbp, indt+2)
              xvb(2) = xvb(2) + (6.d0*yv(2)-12.d0*zv(2))*temp387b25 + yv&
&                (1)*temp387b24
              zvb(1) = zvb(1) + (-(24.d0*yv(3))-24.d0*yv(1)*xv(2))*&
&                temp387b23
              yvb(3) = yvb(3) - 24.d0*zv(1)*temp387b23
              yvb(4) = yvb(4) + 5.d0*temp387b25
              yvb(2) = yvb(2) + (6.d0*xv(2)-36.d0*zv(2))*temp387b25
              xvb(4) = xvb(4) + temp387b25
              zvb(4) = zvb(4) + 8.d0*temp387b25
              temp387b26 = -(cost2h*fun0*zb(indorbp, indt+1))
              zvb(2) = zvb(2) + 24.d0*xv(1)*yv(1)*temp387b26 + (-(36.d0*&
&                yv(2))-12.d0*xv(2))*temp387b25
              temp387b27 = 24.d0*zv(2)*temp387b26
              xvb(1) = xvb(1) + yv(1)*temp387b27 - 4.d0*yv(3)*temp387b26
              yvb(1) = yvb(1) + xv(1)*temp387b27 - 4.d0*xv(3)*temp387b26
              yvb(3) = yvb(3) - 4.d0*xv(1)*temp387b26
              xvb(3) = xvb(3) - 4.d0*yv(1)*temp387b26
            END IF
          ELSE IF (branch .LT. 5) THEN
            IF (branch .LT. 4) THEN
              temp387b28 = cost3h*fun0*zb(indorbp, indt+3)
              fun0b = fun0b + cost3h*(4.d0*(yv(3)*zv(1))-4.d0*(yv(1)*zv(&
&                3)))*zb(indorbp, indt+2) + cost3h*(4.d0*(xv(1)*zv(3))-&
&                4.d0*(xv(3)*zv(1)))*zb(indorbp, indt+1) + cost3h*(yv(4)-&
&                xv(4)+6.d0*(xv(2)*zv(2))-6.d0*(yv(2)*zv(2)))*zb(indorbp&
&                , indt+3)
              yvb(4) = yvb(4) + temp387b28
              xvb(4) = xvb(4) - temp387b28
              xvb(2) = xvb(2) + 6.d0*zv(2)*temp387b28
              zvb(2) = zvb(2) + (6.d0*xv(2)-6.d0*yv(2))*temp387b28
              yvb(2) = yvb(2) - 6.d0*zv(2)*temp387b28
              temp387b29 = cost3h*fun0*zb(indorbp, indt+2)
              yvb(3) = yvb(3) + 4.d0*zv(1)*temp387b29
              zvb(1) = zvb(1) + 4.d0*yv(3)*temp387b29
              yvb(1) = yvb(1) - 4.d0*zv(3)*temp387b29
              temp387b30 = cost3h*fun0*zb(indorbp, indt+1)
              zvb(3) = zvb(3) + 4.d0*xv(1)*temp387b30 - 4.d0*yv(1)*&
&                temp387b29
              xvb(1) = xvb(1) + 4.d0*zv(3)*temp387b30
              xvb(3) = xvb(3) - 4.d0*zv(1)*temp387b30
              zvb(1) = zvb(1) - 4.d0*xv(3)*temp387b30
            ELSE
              temp387b31 = -(cost3h*fun0*zb(indorbp, indt+3))
              temp387b32 = -(12.d0*zv(2)*temp387b31)
              fun0b = fun0b - cost3h*(2.d0*(xv(3)*zv(1))+6.d0*(xv(1)*yv(&
&                2)*zv(1))-4.d0*(xv(1)*zv(3)))*zb(indorbp, indt+2) - &
&                cost3h*(6.d0*(xv(2)*yv(1)*zv(1))+2.d0*(yv(3)*zv(1))-4.d0&
&                *(yv(1)*zv(3)))*zb(indorbp, indt+1) - cost3h*(2.d0*(xv(3&
&                )*yv(1))+2.d0*(xv(1)*yv(3))-12.d0*(xv(1)*yv(1)*zv(2)))*&
&                zb(indorbp, indt+3)
              xvb(3) = xvb(3) + 2.d0*yv(1)*temp387b31
              yvb(1) = yvb(1) + xv(1)*temp387b32 + 2.d0*xv(3)*temp387b31
              xvb(1) = xvb(1) + yv(1)*temp387b32 + 2.d0*yv(3)*temp387b31
              yvb(3) = yvb(3) + 2.d0*xv(1)*temp387b31
              zvb(2) = zvb(2) - 12.d0*xv(1)*yv(1)*temp387b31
              temp387b33 = -(cost3h*fun0*zb(indorbp, indt+2))
              temp387b34 = 6.d0*zv(1)*temp387b33
              xvb(3) = xvb(3) + 2.d0*zv(1)*temp387b33
              zvb(1) = zvb(1) + (6.d0*xv(1)*yv(2)+2.d0*xv(3))*temp387b33
              xvb(1) = xvb(1) + yv(2)*temp387b34 - 4.d0*zv(3)*temp387b33
              yvb(2) = yvb(2) + xv(1)*temp387b34
              zvb(3) = zvb(3) - 4.d0*xv(1)*temp387b33
              temp387b35 = -(cost3h*fun0*zb(indorbp, indt+1))
              temp387b36 = 6.d0*zv(1)*temp387b35
              xvb(2) = xvb(2) + yv(1)*temp387b36
              yvb(1) = yvb(1) + xv(2)*temp387b36 - 4.d0*zv(3)*temp387b35
              zvb(1) = zvb(1) + (2.d0*yv(3)+6.d0*xv(2)*yv(1))*temp387b35
              yvb(3) = yvb(3) + 2.d0*zv(1)*temp387b35
              zvb(3) = zvb(3) - 4.d0*yv(1)*temp387b35
            END IF
          ELSE
            temp387b37 = cost4h*fun0*zb(indorbp, indt+3)
            temp387b38 = -(48.d0*zv(1)*temp387b37)
            fun0b = fun0b + cost4h*(4.d0*(xv(3)*yv(1))+12.d0*(xv(1)*yv(3&
&              ))-48.d0*(xv(1)*yv(1)*zv(2)))*zb(indorbp, indt+2) + cost4h&
&              *(6.d0*(xv(2)*yv(2))-5.d0*xv(4)+3.d0*yv(4)+24.d0*(xv(2)*zv&
&              (2))-24.d0*(yv(2)*zv(2)))*zb(indorbp, indt+1) + cost4h*(&
&              16.d0*(xv(3)*zv(1))-48.d0*(xv(1)*yv(2)*zv(1)))*zb(indorbp&
&              , indt+3)
            xvb(3) = xvb(3) + 16.d0*zv(1)*temp387b37
            zvb(1) = zvb(1) + (16.d0*xv(3)-48.d0*xv(1)*yv(2))*temp387b37
            xvb(1) = xvb(1) + yv(2)*temp387b38
            yvb(2) = yvb(2) + xv(1)*temp387b38
            temp387b39 = cost4h*fun0*zb(indorbp, indt+2)
            temp387b40 = -(48.d0*zv(2)*temp387b39)
            xvb(3) = xvb(3) + 4.d0*yv(1)*temp387b39
            yvb(1) = yvb(1) + xv(1)*temp387b40 + 4.d0*xv(3)*temp387b39
            xvb(1) = xvb(1) + yv(1)*temp387b40 + 12.d0*yv(3)*temp387b39
            yvb(3) = yvb(3) + 12.d0*xv(1)*temp387b39
            temp387b41 = cost4h*fun0*zb(indorbp, indt+1)
            zvb(2) = zvb(2) + (24.d0*xv(2)-24.d0*yv(2))*temp387b41 - &
&              48.d0*xv(1)*yv(1)*temp387b39
            xvb(2) = xvb(2) + (24.d0*zv(2)+6.d0*yv(2))*temp387b41
            yvb(2) = yvb(2) + (6.d0*xv(2)-24.d0*zv(2))*temp387b41
            xvb(4) = xvb(4) - 5.d0*temp387b41
            yvb(4) = yvb(4) + 3.d0*temp387b41
          END IF
        ELSE IF (branch .LT. 9) THEN
          IF (branch .LT. 8) THEN
            IF (branch .LT. 7) THEN
              temp387b42 = -(cost4h*fun0*zb(indorbp, indt+3))
              temp387b43 = -(48.d0*zv(1)*temp387b42)
              fun0b = fun0b - cost4h*(3.d0*xv(4)+6.d0*(xv(2)*yv(2))-5.d0&
&                *yv(4)+24.d0*(yv(2)*zv(2))-24.d0*(xv(2)*zv(2)))*zb(&
&                indorbp, indt+2) - cost4h*(12.d0*(xv(3)*yv(1))+4.d0*(xv(&
&                1)*yv(3))-48.d0*(xv(1)*yv(1)*zv(2)))*zb(indorbp, indt+1)&
&                - cost4h*(16.d0*(yv(3)*zv(1))-48.d0*(xv(2)*yv(1)*zv(1)))&
&                *zb(indorbp, indt+3)
              yvb(3) = yvb(3) + 16.d0*zv(1)*temp387b42
              zvb(1) = zvb(1) + (16.d0*yv(3)-48.d0*xv(2)*yv(1))*&
&                temp387b42
              xvb(2) = xvb(2) + yv(1)*temp387b43
              yvb(1) = yvb(1) + xv(2)*temp387b43
              temp387b44 = -(cost4h*fun0*zb(indorbp, indt+2))
              xvb(4) = xvb(4) + 3.d0*temp387b44
              xvb(2) = xvb(2) + (6.d0*yv(2)-24.d0*zv(2))*temp387b44
              yvb(2) = yvb(2) + (24.d0*zv(2)+6.d0*xv(2))*temp387b44
              yvb(4) = yvb(4) - 5.d0*temp387b44
              temp387b45 = -(cost4h*fun0*zb(indorbp, indt+1))
              zvb(2) = zvb(2) + (24.d0*yv(2)-24.d0*xv(2))*temp387b44 - &
&                48.d0*xv(1)*yv(1)*temp387b45
              temp387b46 = -(48.d0*zv(2)*temp387b45)
              xvb(3) = xvb(3) + 12.d0*yv(1)*temp387b45
              yvb(1) = yvb(1) + xv(1)*temp387b46 + 12.d0*xv(3)*&
&                temp387b45
              xvb(1) = xvb(1) + yv(1)*temp387b46 + 4.d0*yv(3)*temp387b45
              yvb(3) = yvb(3) + 4.d0*xv(1)*temp387b45
            ELSE
              temp387b47 = cost5h*fun0*zb(indorbp, indt+3)
              fun0b = fun0b + cost5h*(4.d0*(yv(3)*zv(1))-12.d0*(xv(2)*yv&
&                (1)*zv(1)))*zb(indorbp, indt+2) + cost5h*(4.d0*(xv(3)*zv&
&                (1))-12.d0*(xv(1)*yv(2)*zv(1)))*zb(indorbp, indt+1) + &
&                cost5h*(xv(4)-6.d0*(xv(2)*yv(2))+yv(4))*zb(indorbp, indt&
&                +3)
              xvb(4) = xvb(4) + temp387b47
              temp387b48 = cost5h*fun0*zb(indorbp, indt+2)
              temp387b49 = -(12.d0*zv(1)*temp387b48)
              xvb(2) = xvb(2) + yv(1)*temp387b49 - 6.d0*yv(2)*temp387b47
              yvb(2) = yvb(2) - 6.d0*xv(2)*temp387b47
              yvb(4) = yvb(4) + temp387b47
              yvb(3) = yvb(3) + 4.d0*zv(1)*temp387b48
              temp387b50 = cost5h*fun0*zb(indorbp, indt+1)
              zvb(1) = zvb(1) + (4.d0*xv(3)-12.d0*xv(1)*yv(2))*&
&                temp387b50 + (4.d0*yv(3)-12.d0*xv(2)*yv(1))*temp387b48
              yvb(1) = yvb(1) + xv(2)*temp387b49
              temp387b51 = -(12.d0*zv(1)*temp387b50)
              xvb(3) = xvb(3) + 4.d0*zv(1)*temp387b50
              xvb(1) = xvb(1) + yv(2)*temp387b51
              yvb(2) = yvb(2) + xv(1)*temp387b51
            END IF
          ELSE
            temp387b52 = -(cost5h*fun0*zb(indorbp, indt+3))
            fun0b = fun0b - cost5h*(12.d0*(xv(1)*yv(2)*zv(1))-4.d0*(xv(3&
&              )*zv(1)))*zb(indorbp, indt+2) - cost5h*(4.d0*(yv(3)*zv(1))&
&              -12.d0*(xv(2)*yv(1)*zv(1)))*zb(indorbp, indt+1) - cost5h*(&
&              4.d0*(xv(1)*yv(3))-4.d0*(xv(3)*yv(1)))*zb(indorbp, indt+3)
            xvb(1) = xvb(1) + 4.d0*yv(3)*temp387b52
            yvb(3) = yvb(3) + 4.d0*xv(1)*temp387b52
            xvb(3) = xvb(3) - 4.d0*yv(1)*temp387b52
            yvb(1) = yvb(1) - 4.d0*xv(3)*temp387b52
            temp387b53 = -(cost5h*fun0*zb(indorbp, indt+2))
            temp387b54 = 12.d0*zv(1)*temp387b53
            xvb(1) = xvb(1) + yv(2)*temp387b54
            yvb(2) = yvb(2) + xv(1)*temp387b54
            temp387b55 = -(cost5h*fun0*zb(indorbp, indt+1))
            zvb(1) = zvb(1) + (4.d0*yv(3)-12.d0*xv(2)*yv(1))*temp387b55 &
&              + (12.d0*xv(1)*yv(2)-4.d0*xv(3))*temp387b53
            xvb(3) = xvb(3) - 4.d0*zv(1)*temp387b53
            temp387b56 = -(12.d0*zv(1)*temp387b55)
            yvb(3) = yvb(3) + 4.d0*zv(1)*temp387b55
            xvb(2) = xvb(2) + yv(1)*temp387b56
            yvb(1) = yvb(1) + xv(2)*temp387b56
          END IF
        ELSE IF (branch .LT. 11) THEN
          IF (branch .LT. 10) THEN
            temp387b57 = cost6h*fun0*zb(indorbp, indt+2)
            fun0b = fun0b + cost6h*(5.d0*xv(4)-30.d0*(xv(2)*yv(2))+5.d0*&
&              yv(4))*zb(indorbp, indt+1) + cost6h*(20.d0*(xv(1)*yv(3))-&
&              20.d0*(xv(3)*yv(1)))*zb(indorbp, indt+2)
            xvb(1) = xvb(1) + 20.d0*yv(3)*temp387b57
            yvb(3) = yvb(3) + 20.d0*xv(1)*temp387b57
            xvb(3) = xvb(3) - 20.d0*yv(1)*temp387b57
            yvb(1) = yvb(1) - 20.d0*xv(3)*temp387b57
            temp387b58 = cost6h*fun0*zb(indorbp, indt+1)
            xvb(4) = xvb(4) + 5.d0*temp387b58
            xvb(2) = xvb(2) - 30.d0*yv(2)*temp387b58
            yvb(2) = yvb(2) - 30.d0*xv(2)*temp387b58
            yvb(4) = yvb(4) + 5.d0*temp387b58
          END IF
        ELSE
          temp387b59 = -(cost6h*fun0*zb(indorbp, indt+2))
          fun0b = fun0b - cost6h*(20.d0*(xv(1)*yv(3))-20.d0*(xv(3)*yv(1)&
&            ))*zb(indorbp, indt+1) - cost6h*(30.d0*(xv(2)*yv(2))-5.d0*xv&
&            (4)-5.d0*yv(4))*zb(indorbp, indt+2)
          xvb(2) = xvb(2) + 30.d0*yv(2)*temp387b59
          yvb(2) = yvb(2) + 30.d0*xv(2)*temp387b59
          xvb(4) = xvb(4) - 5.d0*temp387b59
          yvb(4) = yvb(4) - 5.d0*temp387b59
          temp387b60 = -(cost6h*fun0*zb(indorbp, indt+1))
          xvb(1) = xvb(1) + 20.d0*yv(3)*temp387b60
          yvb(3) = yvb(3) + 20.d0*xv(1)*temp387b60
          xvb(3) = xvb(3) - 20.d0*yv(1)*temp387b60
          yvb(1) = yvb(1) - 20.d0*xv(3)*temp387b60
        END IF
        DO i=3,1,-1
          temp387b10 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp387b10
          funb = funb + rmu(i, 0)*temp387b10
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,r4)
      r2b = r2b + 2*r2*r4b
      CALL POPREAL8(adr8ibuf,adr8buf,r2)
      xvb(2) = xvb(2) + r2b
      yvb(2) = yvb(2) + r2b
      zvb(2) = zvb(2) + r2b
      DO k=5,1,-1
        CALL POPREAL8(adr8ibuf,adr8buf,xv(k))
        IF (.NOT.(rmu(1, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(1, 0) = rmub(1, 0) + k*rmu(1, 0)**(k-1)*xvb(k)
        xvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,yv(k))
        IF (.NOT.(rmu(2, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(2, 0) = rmub(2, 0) + k*rmu(2, 0)**(k-1)*yvb(k)
        yvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,zv(k))
        IF (.NOT.(rmu(3, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(3, 0) = rmub(3, 0) + k*rmu(3, 0)**(k-1)*zvb(k)
        zvb(k) = 0.0_8
      END DO
      temp387b9 = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp387b9 - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp387b9
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
      zvb = 0.0_8
      xvb = 0.0_8
      yvb = 0.0_8
    END IF
    DO ic=11,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp387b = -(cost6h*distpb(i, 12))
      xvb(2) = xvb(2) + 10.d0*yv(3)*temp387b
      yvb(3) = yvb(3) + 10.d0*xv(2)*temp387b
      xvb(4) = xvb(4) - 5.d0*yv(1)*temp387b
      yvb(1) = yvb(1) - 5.d0*xv(4)*temp387b
      yvb(5) = yvb(5) - temp387b
      distpb(i, 12) = 0.0_8
      temp387b0 = cost6h*distpb(i, 11)
      xvb(5) = xvb(5) + temp387b0
      xvb(3) = xvb(3) - 10.d0*yv(2)*temp387b0
      yvb(2) = yvb(2) - 10.d0*xv(3)*temp387b0
      xvb(1) = xvb(1) + 5.d0*yv(4)*temp387b0
      yvb(4) = yvb(4) + 5.d0*xv(1)*temp387b0
      distpb(i, 11) = 0.0_8
      temp387b1 = cost5h*4.d0*distpb(i, 10)
      temp387b2 = zv(1)*temp387b1
      xvb(3) = xvb(3) + yv(1)*temp387b2
      yvb(1) = yvb(1) + xv(3)*temp387b2
      yvb(3) = yvb(3) - xv(1)*temp387b2
      xvb(1) = xvb(1) - yv(3)*temp387b2
      distpb(i, 10) = 0.0_8
      zvb(1) = zvb(1) + cost5h*(xv(4)-6.d0*(xv(2)*yv(2))+yv(4))*distpb(i&
&        , 9) + (xv(3)*yv(1)-yv(3)*xv(1))*temp387b1
      temp387b3 = cost5h*zv(1)*distpb(i, 9)
      xvb(4) = xvb(4) + temp387b3
      distpb(i, 9) = 0.0_8
      temp387b4 = -(cost4h*cost*distpb(i, 8))
      xvb(2) = xvb(2) - 3.d0*yv(1)*temp387b4 - 6.d0*yv(2)*temp387b3
      yvb(2) = yvb(2) - 6.d0*xv(2)*temp387b3
      yvb(4) = yvb(4) + temp387b3
      yvb(3) = yvb(3) + temp387b4
      yvb(1) = yvb(1) - 3.d0*xv(2)*temp387b4
      costb = -(cost4h*(yv(3)-3.d0*(yv(1)*xv(2)))*distpb(i, 8))
      distpb(i, 8) = 0.0_8
      temp387b5 = cost4h*cost*distpb(i, 7)
      xvb(3) = xvb(3) + temp387b5
      costb = costb + cost4h*(xv(3)-3.d0*(xv(1)*yv(2)))*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp387b6 = cost3h*2.d0*distpb(i, 6)
      xvb(1) = xvb(1) + yv(1)*cost*temp387b6 - 3.d0*yv(2)*temp387b5
      yvb(2) = yvb(2) - 3.d0*xv(1)*temp387b5
      zvb(2) = zvb(2) + 9.d0*costb
      r2b = -costb
      distpb(i, 6) = 0.0_8
      temp387b7 = cost3h*distpb(i, 5)
      costb = (xv(2)-yv(2))*temp387b7 + yv(1)*xv(1)*temp387b6
      yvb(1) = yvb(1) + xv(1)*cost*temp387b6
      xvb(2) = xvb(2) + cost*temp387b7
      yvb(2) = yvb(2) - cost*temp387b7
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      zvb(3) = zvb(3) + 3.d0*costb
      zvb(1) = zvb(1) - r2*costb
      r2b = r2b - zv(1)*costb
      rmub(2, i) = rmub(2, i) + cost2h*cost*distpb(i, 4)
      costb = cost2h*rmu(2, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2h*cost*distpb(i, 3)
      costb = costb + cost2h*rmu(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      zvb(4) = zvb(4) + 21.d0*costb
      zvb(2) = zvb(2) - 14.d0*r2*costb
      temp387b8 = cost1h*distpb(i, 2)
      r4b = 15.d0*zv(1)*temp387b8 + costb
      r2b = r2b + 2*r2*r4b - 70.d0*zv(3)*temp387b8 - 14.d0*zv(2)*costb
      zvb(5) = zvb(5) + 63.d0*temp387b8
      zvb(3) = zvb(3) - 70.d0*r2*temp387b8
      zvb(1) = zvb(1) + 15.d0*r4*temp387b8
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,r4)
      CALL POPREAL8(adr8ibuf,adr8buf,r2)
      xvb(2) = xvb(2) + r2b
      yvb(2) = yvb(2) + r2b
      zvb(2) = zvb(2) + r2b
      DO k=5,1,-1
        CALL POPREAL8(adr8ibuf,adr8buf,xv(k))
        IF (.NOT.(rmu(1, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(1, i) = rmub(1, i) + k*rmu(1, i)**(k-1)*xvb(k)
        xvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,yv(k))
        IF (.NOT.(rmu(2, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(2, i) = rmub(2, i) + k*rmu(2, i)**(k-1)*yvb(k)
        yvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,zv(k))
        IF (.NOT.(rmu(3, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(3, i) = rmub(3, i) + k*rmu(3, i)**(k-1)*zvb(k)
        zvb(k) = 0.0_8
      END DO
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp386 = r(k)**2
      temp386b58 = c*DEXP(-(dd1*temp386))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp386))*distpb(k, 1)
      dd1b = dd1b - temp386*temp386b58
      rb(k) = rb(k) - dd1*2*r(k)*temp386b58
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.79296269381073167718d0*3.25d0*dd1**2.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (73) 
! 2s gaussian for pseudo                                
! I-orbitals
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization  obtained by Mathematica                                               
    c = dd1**3.75d0*0.43985656185609913955d0
!  C= dd1^15/4 /Sqrt[Integrate[x^14 Exp[-2 x^2],{x,0,Infinity}]] 
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      DO k=1,6
        CALL PUSHREAL8(adr8ibuf,adr8buf,zv(k))
        zv(k) = rmu(3, i)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,yv(k))
        yv(k) = rmu(2, i)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,xv(k))
        xv(k) = rmu(1, i)**k
      END DO
      CALL PUSHREAL8(adr8ibuf,adr8buf,r2)
      r2 = xv(2) + yv(2) + zv(2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,r4)
      r4 = r2*r2
      r6 = r2*r4
! lz=0        
      distp(i, 2) = cost1i*(231.d0*zv(6)-315.d0*zv(4)*r2+105.d0*zv(2)*r4&
&        -5.d0*r6)
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 33.d0*zv(5) - 30.d0*zv(3)*r2 + 5.d0*zv(1)*r4
! lz=+/-1         
      distp(i, 3) = cost2i*rmu(1, i)*cost
! lz=+/-1         
      distp(i, 4) = cost2i*rmu(2, i)*cost
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 33.d0*zv(4) - 18.d0*zv(2)*r2 + r4
! lz=+/-2         
      distp(i, 5) = cost3i*(xv(2)-yv(2))*cost
! lz=+/-2           
      distp(i, 6) = 2.d0*cost3i*xv(1)*yv(1)*cost
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 11.d0*zv(3) - 3.d0*zv(1)*r2
! lz=+/-3                   
      distp(i, 7) = cost4i*(xv(3)-3.d0*xv(1)*yv(2))*cost
! lz=+/-3                   
      distp(i, 8) = -(cost4i*(yv(3)-3.d0*yv(1)*xv(2))*cost)
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 11.d0*zv(2) - r2
! lz=+/-4
      distp(i, 9) = cost5i*(xv(4)-6.d0*xv(2)*yv(2)+yv(4))*cost
! lz=+/-4
      distp(i, 10) = cost5i*4.d0*(xv(3)*yv(1)-yv(3)*xv(1))*cost
! lz=+/-5
      distp(i, 11) = cost6i*(xv(5)-10.d0*xv(3)*yv(2)+5.d0*xv(1)*yv(4))*&
&        zv(1)
! lz=+/-5
      distp(i, 12) = -(cost6i*(-(5.d0*xv(4)*yv(1))+10.d0*xv(2)*yv(3)-yv(&
&        5))*zv(1))
! lz=+/-6
      distp(i, 13) = cost7i*(xv(6)-15.d0*xv(4)*yv(2)+15.d0*xv(2)*yv(4)-&
&        yv(6))
! lz=+/-6
      distp(i, 14) = -(cost7i*(-(6.d0*xv(5)*yv(1))+20.d0*xv(3)*yv(3)-&
&        6.d0*yv(5)*xv(1)))
    END DO
    DO ic=1,13
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      DO k=1,6
        CALL PUSHREAL8(adr8ibuf,adr8buf,zv(k))
        zv(k) = rmu(3, 0)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,yv(k))
        yv(k) = rmu(2, 0)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,xv(k))
        xv(k) = rmu(1, 0)**k
      END DO
!              indorbp=indorb 
      DO ic=1,13
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        ELSE IF (ic .EQ. 6) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE IF (ic .EQ. 7) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
        ELSE IF (ic .EQ. 8) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
        ELSE IF (ic .EQ. 9) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
        ELSE IF (ic .EQ. 10) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
        ELSE IF (ic .EQ. 11) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
        ELSE IF (ic .EQ. 12) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
        ELSE IF (ic .EQ. 13) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
        END IF
      END DO
      distpb = 0.0_8
      zvb = 0.0_8
      xvb = 0.0_8
      funb = 0.0_8
      yvb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=13,1,-1
        temp388b91 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (14.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb = funb + 14.d0*temp388b91
        fun2b = fun2b + temp388b91
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 7) THEN
          IF (branch .LT. 4) THEN
            IF (branch .LT. 2) THEN
              IF (branch .LT. 1) THEN
                temp388b13 = cost1i*fun0*zb(indorbp, indt+3)
                temp388b14 = 360.d0*zv(1)*temp388b13
                fun0b = fun0b + cost1i*(360.d0*(xv(2)*yv(1)*zv(2))-60.d0&
&                  *(xv(2)*yv(3))-30.d0*yv(5)-30.d0*(xv(4)*yv(1))+360.d0*&
&                  (yv(3)*zv(2))-240.d0*(yv(1)*zv(4)))*zb(indorbp, indt+2&
&                  ) + cost1i*(360.d0*(xv(3)*zv(2))-60.d0*(xv(3)*yv(2))-&
&                  30.d0*(xv(1)*yv(4))-30.d0*xv(5)+360.d0*(xv(1)*yv(2)*zv&
&                  (2))-240.d0*(xv(1)*zv(4)))*zb(indorbp, indt+1) + &
&                  cost1i*(180.d0*(xv(4)*zv(1))+360.d0*(xv(2)*yv(2)*zv(1)&
&                  )+180.d0*(yv(4)*zv(1))+96.d0*zv(5)-480.d0*(yv(2)*zv(3)&
&                  )-480.d0*(xv(2)*zv(3)))*zb(indorbp, indt+3)
                xvb(4) = xvb(4) + 180.d0*zv(1)*temp388b13
                zvb(1) = zvb(1) + (180.d0*yv(4)+360.d0*xv(2)*yv(2)+&
&                  180.d0*xv(4))*temp388b13
                temp388b15 = cost1i*fun0*zb(indorbp, indt+2)
                temp388b16 = 360.d0*zv(2)*temp388b15
                xvb(2) = xvb(2) + yv(1)*temp388b16 - 60.d0*yv(3)*&
&                  temp388b15 - 480.d0*zv(3)*temp388b13 + yv(2)*&
&                  temp388b14
                yvb(2) = yvb(2) + xv(2)*temp388b14 - 480.d0*zv(3)*&
&                  temp388b13
                yvb(4) = yvb(4) + 180.d0*zv(1)*temp388b13
                zvb(5) = zvb(5) + 96.d0*temp388b13
                zvb(3) = zvb(3) + (-(480.d0*xv(2))-480.d0*yv(2))*&
&                  temp388b13
                yvb(1) = yvb(1) + (-(240.d0*zv(4))-30.d0*xv(4))*&
&                  temp388b15 + xv(2)*temp388b16
                zvb(2) = zvb(2) + (360.d0*yv(3)+360.d0*xv(2)*yv(1))*&
&                  temp388b15
                yvb(3) = yvb(3) + (360.d0*zv(2)-60.d0*xv(2))*temp388b15
                yvb(5) = yvb(5) - 30.d0*temp388b15
                xvb(4) = xvb(4) - 30.d0*yv(1)*temp388b15
                zvb(4) = zvb(4) - 240.d0*yv(1)*temp388b15
                temp388b17 = cost1i*fun0*zb(indorbp, indt+1)
                temp388b18 = 360.d0*zv(2)*temp388b17
                xvb(3) = xvb(3) + (360.d0*zv(2)-60.d0*yv(2))*temp388b17
                zvb(2) = zvb(2) + (360.d0*xv(1)*yv(2)+360.d0*xv(3))*&
&                  temp388b17
                yvb(2) = yvb(2) + xv(1)*temp388b18 - 60.d0*xv(3)*&
&                  temp388b17
                xvb(1) = xvb(1) + yv(2)*temp388b18 + (-(240.d0*zv(4))-&
&                  30.d0*yv(4))*temp388b17
                yvb(4) = yvb(4) - 30.d0*xv(1)*temp388b17
                xvb(5) = xvb(5) - 30.d0*temp388b17
                zvb(4) = zvb(4) - 240.d0*xv(1)*temp388b17
              ELSE
                temp388b19 = cost2i*fun0*zb(indorbp, indt+3)
                temp388b20 = -(60.d0*zv(2)*temp388b19)
                fun0b = fun0b + cost2i*(20.d0*(xv(3)*yv(1)*zv(1))+20.d0*&
&                  (xv(1)*yv(3)*zv(1))-40.d0*(xv(1)*yv(1)*zv(3)))*zb(&
&                  indorbp, indt+2) + cost2i*(25.d0*(xv(4)*zv(1))+30.d0*(&
&                  xv(2)*yv(2)*zv(1))+5.d0*(yv(4)*zv(1))+8.d0*zv(5)-20.d0&
&                  *(yv(2)*zv(3))-60.d0*(xv(2)*zv(3)))*zb(indorbp, indt+1&
&                  ) + cost2i*(5.d0*xv(5)+10.d0*(xv(3)*yv(2))+5.d0*(yv(4)&
&                  *xv(1))+40.d0*(xv(1)*zv(4))-60.d0*(xv(1)*yv(2)*zv(2))-&
&                  60.d0*(xv(3)*zv(2)))*zb(indorbp, indt+3)
                xvb(5) = xvb(5) + 5.d0*temp388b19
                xvb(3) = xvb(3) + (10.d0*yv(2)-60.d0*zv(2))*temp388b19
                yvb(2) = yvb(2) + xv(1)*temp388b20 + 10.d0*xv(3)*&
&                  temp388b19
                yvb(4) = yvb(4) + 5.d0*xv(1)*temp388b19
                xvb(1) = xvb(1) + yv(2)*temp388b20 + (40.d0*zv(4)+5.d0*&
&                  yv(4))*temp388b19
                zvb(4) = zvb(4) + 40.d0*xv(1)*temp388b19
                zvb(2) = zvb(2) + (-(60.d0*xv(3))-60.d0*xv(1)*yv(2))*&
&                  temp388b19
                temp388b21 = cost2i*fun0*zb(indorbp, indt+2)
                temp388b22 = 20.d0*zv(1)*temp388b21
                temp388b23 = 20.d0*zv(1)*temp388b21
                temp388b24 = -(40.d0*zv(3)*temp388b21)
                xvb(3) = xvb(3) + yv(1)*temp388b22
                yvb(1) = yvb(1) + xv(1)*temp388b24 + xv(3)*temp388b22
                zvb(1) = zvb(1) + (20.d0*xv(1)*yv(3)+20.d0*xv(3)*yv(1))*&
&                  temp388b21
                xvb(1) = xvb(1) + yv(1)*temp388b24 + yv(3)*temp388b23
                yvb(3) = yvb(3) + xv(1)*temp388b23
                zvb(3) = zvb(3) - 40.d0*xv(1)*yv(1)*temp388b21
                temp388b25 = cost2i*fun0*zb(indorbp, indt+1)
                temp388b26 = 30.d0*zv(1)*temp388b25
                xvb(4) = xvb(4) + 25.d0*zv(1)*temp388b25
                zvb(1) = zvb(1) + (5.d0*yv(4)+30.d0*xv(2)*yv(2)+25.d0*xv&
&                  (4))*temp388b25
                xvb(2) = xvb(2) + yv(2)*temp388b26 - 60.d0*zv(3)*&
&                  temp388b25
                yvb(2) = yvb(2) + xv(2)*temp388b26 - 20.d0*zv(3)*&
&                  temp388b25
                yvb(4) = yvb(4) + 5.d0*zv(1)*temp388b25
                zvb(5) = zvb(5) + 8.d0*temp388b25
                zvb(3) = zvb(3) + (-(60.d0*xv(2))-20.d0*yv(2))*&
&                  temp388b25
              END IF
            ELSE IF (branch .LT. 3) THEN
              temp388b27 = -(cost2i*fun0*zb(indorbp, indt+3))
              temp388b28 = 60.d0*zv(2)*temp388b27
              fun0b = fun0b - cost2i*(20.d0*(xv(2)*zv(3))-30.d0*(xv(2)*&
&                yv(2)*zv(1))-25.d0*(yv(4)*zv(1))-5.d0*(xv(4)*zv(1))+&
&                60.d0*(yv(2)*zv(3))-8.d0*zv(5))*zb(indorbp, indt+2) - &
&                cost2i*(40.d0*(xv(1)*yv(1)*zv(3))-20.d0*(xv(1)*yv(3)*zv(&
&                1))-20.d0*(xv(3)*yv(1)*zv(1)))*zb(indorbp, indt+1) - &
&                cost2i*(60.d0*(xv(2)*yv(1)*zv(2))-10.d0*(xv(2)*yv(3))-&
&                5.d0*yv(5)-5.d0*(xv(4)*yv(1))+60.d0*(yv(3)*zv(2))-40.d0*&
&                (yv(1)*zv(4)))*zb(indorbp, indt+3)
              xvb(2) = xvb(2) + yv(1)*temp388b28 - 10.d0*yv(3)*&
&                temp388b27
              yvb(1) = yvb(1) + (-(40.d0*zv(4))-5.d0*xv(4))*temp388b27 +&
&                xv(2)*temp388b28
              zvb(2) = zvb(2) + (60.d0*yv(3)+60.d0*xv(2)*yv(1))*&
&                temp388b27
              yvb(3) = yvb(3) + (60.d0*zv(2)-10.d0*xv(2))*temp388b27
              yvb(5) = yvb(5) - 5.d0*temp388b27
              xvb(4) = xvb(4) - 5.d0*yv(1)*temp388b27
              zvb(4) = zvb(4) - 40.d0*yv(1)*temp388b27
              temp388b29 = -(cost2i*fun0*zb(indorbp, indt+2))
              temp388b30 = -(30.d0*zv(1)*temp388b29)
              xvb(2) = xvb(2) + yv(2)*temp388b30 + 20.d0*zv(3)*&
&                temp388b29
              zvb(3) = zvb(3) + (60.d0*yv(2)+20.d0*xv(2))*temp388b29
              yvb(2) = yvb(2) + 60.d0*zv(3)*temp388b29 + xv(2)*&
&                temp388b30
              zvb(1) = zvb(1) + (-(5.d0*xv(4))-25.d0*yv(4)-30.d0*xv(2)*&
&                yv(2))*temp388b29
              yvb(4) = yvb(4) - 25.d0*zv(1)*temp388b29
              xvb(4) = xvb(4) - 5.d0*zv(1)*temp388b29
              zvb(5) = zvb(5) - 8.d0*temp388b29
              temp388b31 = -(cost2i*fun0*zb(indorbp, indt+1))
              temp388b32 = 40.d0*zv(3)*temp388b31
              temp388b33 = -(20.d0*zv(1)*temp388b31)
              temp388b34 = -(20.d0*zv(1)*temp388b31)
              xvb(1) = xvb(1) + yv(3)*temp388b33 + yv(1)*temp388b32
              yvb(1) = yvb(1) + xv(3)*temp388b34 + xv(1)*temp388b32
              zvb(3) = zvb(3) + 40.d0*xv(1)*yv(1)*temp388b31
              yvb(3) = yvb(3) + xv(1)*temp388b33
              zvb(1) = zvb(1) + (-(20.d0*xv(3)*yv(1))-20.d0*xv(1)*yv(3))&
&                *temp388b31
              xvb(3) = xvb(3) + yv(1)*temp388b34
            ELSE
              temp388b35 = cost3i*fun0*zb(indorbp, indt+3)
              fun0b = fun0b + cost3i*(2.d0*(xv(4)*yv(1))-4.d0*(xv(2)*yv(&
&                3))-6.d0*yv(5)+64.d0*(yv(3)*zv(2))-32.d0*(yv(1)*zv(4)))*&
&                zb(indorbp, indt+2) + cost3i*(6.d0*xv(5)+4.d0*(xv(3)*yv(&
&                2))-2.d0*(xv(1)*yv(4))+32.d0*(xv(1)*zv(4))-64.d0*(xv(3)*&
&                zv(2)))*zb(indorbp, indt+1) + cost3i*(32.d0*(yv(4)*zv(1)&
&                )-32.d0*(xv(4)*zv(1))+64.d0*(xv(2)*zv(3))-64.d0*(yv(2)*&
&                zv(3)))*zb(indorbp, indt+3)
              yvb(4) = yvb(4) + 32.d0*zv(1)*temp388b35
              zvb(1) = zvb(1) + (32.d0*yv(4)-32.d0*xv(4))*temp388b35
              xvb(4) = xvb(4) - 32.d0*zv(1)*temp388b35
              xvb(2) = xvb(2) + 64.d0*zv(3)*temp388b35
              zvb(3) = zvb(3) + (64.d0*xv(2)-64.d0*yv(2))*temp388b35
              yvb(2) = yvb(2) - 64.d0*zv(3)*temp388b35
              temp388b36 = cost3i*fun0*zb(indorbp, indt+2)
              xvb(4) = xvb(4) + 2.d0*yv(1)*temp388b36
              yvb(1) = yvb(1) + (2.d0*xv(4)-32.d0*zv(4))*temp388b36
              xvb(2) = xvb(2) - 4.d0*yv(3)*temp388b36
              yvb(3) = yvb(3) + (64.d0*zv(2)-4.d0*xv(2))*temp388b36
              yvb(5) = yvb(5) - 6.d0*temp388b36
              zvb(2) = zvb(2) + 64.d0*yv(3)*temp388b36
              temp388b37 = cost3i*fun0*zb(indorbp, indt+1)
              zvb(4) = zvb(4) + 32.d0*xv(1)*temp388b37 - 32.d0*yv(1)*&
&                temp388b36
              xvb(5) = xvb(5) + 6.d0*temp388b37
              xvb(3) = xvb(3) + (4.d0*yv(2)-64.d0*zv(2))*temp388b37
              yvb(2) = yvb(2) + 4.d0*xv(3)*temp388b37
              xvb(1) = xvb(1) + (32.d0*zv(4)-2.d0*yv(4))*temp388b37
              yvb(4) = yvb(4) - 2.d0*xv(1)*temp388b37
              zvb(2) = zvb(2) - 64.d0*xv(3)*temp388b37
            END IF
          ELSE IF (branch .LT. 6) THEN
            IF (branch .LT. 5) THEN
              temp388b38 = -(cost3i*fun0*zb(indorbp, indt+3))
              temp388b39 = 64.d0*zv(1)*temp388b38
              temp388b40 = 64.d0*zv(1)*temp388b38
              temp388b41 = -(128.d0*zv(3)*temp388b38)
              fun0b = fun0b - cost3i*(32.d0*(xv(3)*zv(2))-12.d0*(xv(3)*&
&                yv(2))-10.d0*(xv(1)*yv(4))-2.d0*xv(5)+96.d0*(xv(1)*yv(2)&
&                *zv(2))-32.d0*(xv(1)*zv(4)))*zb(indorbp, indt+2) - &
&                cost3i*(96.d0*(xv(2)*yv(1)*zv(2))-12.d0*(xv(2)*yv(3))-&
&                2.d0*yv(5)-10.d0*(xv(4)*yv(1))+32.d0*(yv(3)*zv(2))-32.d0&
&                *(yv(1)*zv(4)))*zb(indorbp, indt+1) - cost3i*(64.d0*(xv(&
&                3)*yv(1)*zv(1))+64.d0*(xv(1)*yv(3)*zv(1))-128.d0*(xv(1)*&
&                yv(1)*zv(3)))*zb(indorbp, indt+3)
              xvb(3) = xvb(3) + yv(1)*temp388b39
              yvb(1) = yvb(1) + xv(1)*temp388b41 + xv(3)*temp388b39
              zvb(1) = zvb(1) + (64.d0*xv(1)*yv(3)+64.d0*xv(3)*yv(1))*&
&                temp388b38
              xvb(1) = xvb(1) + yv(1)*temp388b41 + yv(3)*temp388b40
              yvb(3) = yvb(3) + xv(1)*temp388b40
              zvb(3) = zvb(3) - 128.d0*xv(1)*yv(1)*temp388b38
              temp388b42 = -(cost3i*fun0*zb(indorbp, indt+2))
              temp388b43 = 96.d0*zv(2)*temp388b42
              xvb(3) = xvb(3) + (32.d0*zv(2)-12.d0*yv(2))*temp388b42
              zvb(2) = zvb(2) + (96.d0*xv(1)*yv(2)+32.d0*xv(3))*&
&                temp388b42
              yvb(2) = yvb(2) + xv(1)*temp388b43 - 12.d0*xv(3)*&
&                temp388b42
              xvb(1) = xvb(1) + yv(2)*temp388b43 + (-(32.d0*zv(4))-10.d0&
&                *yv(4))*temp388b42
              yvb(4) = yvb(4) - 10.d0*xv(1)*temp388b42
              xvb(5) = xvb(5) - 2.d0*temp388b42
              zvb(4) = zvb(4) - 32.d0*xv(1)*temp388b42
              temp388b44 = -(cost3i*fun0*zb(indorbp, indt+1))
              temp388b45 = 96.d0*zv(2)*temp388b44
              xvb(2) = xvb(2) + yv(1)*temp388b45 - 12.d0*yv(3)*&
&                temp388b44
              yvb(1) = yvb(1) + (-(32.d0*zv(4))-10.d0*xv(4))*temp388b44 &
&                + xv(2)*temp388b45
              zvb(2) = zvb(2) + (32.d0*yv(3)+96.d0*xv(2)*yv(1))*&
&                temp388b44
              yvb(3) = yvb(3) + (32.d0*zv(2)-12.d0*xv(2))*temp388b44
              yvb(5) = yvb(5) - 2.d0*temp388b44
              xvb(4) = xvb(4) - 10.d0*yv(1)*temp388b44
              zvb(4) = zvb(4) - 32.d0*yv(1)*temp388b44
            ELSE
              temp388b46 = cost4i*fun0*zb(indorbp, indt+3)
              temp388b47 = -(72.d0*zv(2)*temp388b46)
              fun0b = fun0b + cost4i*(12.d0*(xv(3)*yv(1)*zv(1))+36.d0*(&
&                xv(1)*yv(3)*zv(1))-48.d0*(xv(1)*yv(1)*zv(3)))*zb(indorbp&
&                , indt+2) + cost4i*(18.d0*(xv(2)*yv(2)*zv(1))-15.d0*(xv(&
&                4)*zv(1))+9.d0*(yv(4)*zv(1))+24.d0*(xv(2)*zv(3))-24.d0*(&
&                yv(2)*zv(3)))*zb(indorbp, indt+1) + cost4i*(6.d0*(xv(3)*&
&                yv(2))-3.d0*xv(5)+9.d0*(xv(1)*yv(4))+24.d0*(xv(3)*zv(2))&
&                -72.d0*(xv(1)*yv(2)*zv(2)))*zb(indorbp, indt+3)
              xvb(3) = xvb(3) + (24.d0*zv(2)+6.d0*yv(2))*temp388b46
              yvb(2) = yvb(2) + xv(1)*temp388b47 + 6.d0*xv(3)*temp388b46
              xvb(5) = xvb(5) - 3.d0*temp388b46
              xvb(1) = xvb(1) + yv(2)*temp388b47 + 9.d0*yv(4)*temp388b46
              yvb(4) = yvb(4) + 9.d0*xv(1)*temp388b46
              zvb(2) = zvb(2) + (24.d0*xv(3)-72.d0*xv(1)*yv(2))*&
&                temp388b46
              temp388b48 = cost4i*fun0*zb(indorbp, indt+2)
              temp388b49 = 12.d0*zv(1)*temp388b48
              temp388b50 = 36.d0*zv(1)*temp388b48
              temp388b51 = -(48.d0*zv(3)*temp388b48)
              xvb(3) = xvb(3) + yv(1)*temp388b49
              yvb(1) = yvb(1) + xv(1)*temp388b51 + xv(3)*temp388b49
              zvb(1) = zvb(1) + (36.d0*xv(1)*yv(3)+12.d0*xv(3)*yv(1))*&
&                temp388b48
              xvb(1) = xvb(1) + yv(1)*temp388b51 + yv(3)*temp388b50
              yvb(3) = yvb(3) + xv(1)*temp388b50
              zvb(3) = zvb(3) - 48.d0*xv(1)*yv(1)*temp388b48
              temp388b52 = cost4i*fun0*zb(indorbp, indt+1)
              temp388b53 = 18.d0*zv(1)*temp388b52
              xvb(2) = xvb(2) + 24.d0*zv(3)*temp388b52 + yv(2)*&
&                temp388b53
              yvb(2) = yvb(2) + xv(2)*temp388b53 - 24.d0*zv(3)*&
&                temp388b52
              zvb(1) = zvb(1) + (9.d0*yv(4)-15.d0*xv(4)+18.d0*xv(2)*yv(2&
&                ))*temp388b52
              xvb(4) = xvb(4) - 15.d0*zv(1)*temp388b52
              yvb(4) = yvb(4) + 9.d0*zv(1)*temp388b52
              zvb(3) = zvb(3) + (24.d0*xv(2)-24.d0*yv(2))*temp388b52
            END IF
          ELSE
            temp388b54 = -(cost4i*fun0*zb(indorbp, indt+3))
            temp388b55 = -(72.d0*zv(2)*temp388b54)
            fun0b = fun0b - cost4i*(9.d0*(xv(4)*zv(1))+18.d0*(xv(2)*yv(2&
&              )*zv(1))-15.d0*(yv(4)*zv(1))+24.d0*(yv(2)*zv(3))-24.d0*(xv&
&              (2)*zv(3)))*zb(indorbp, indt+2) - cost4i*(36.d0*(xv(3)*yv(&
&              1)*zv(1))+12.d0*(xv(1)*yv(3)*zv(1))-48.d0*(xv(1)*yv(1)*zv(&
&              3)))*zb(indorbp, indt+1) - cost4i*(9.d0*(xv(4)*yv(1))+6.d0&
&              *(xv(2)*yv(3))-3.d0*yv(5)+24.d0*(yv(3)*zv(2))-72.d0*(xv(2)&
&              *yv(1)*zv(2)))*zb(indorbp, indt+3)
            xvb(4) = xvb(4) + 9.d0*yv(1)*temp388b54
            yvb(1) = yvb(1) + xv(2)*temp388b55 + 9.d0*xv(4)*temp388b54
            xvb(2) = xvb(2) + yv(1)*temp388b55 + 6.d0*yv(3)*temp388b54
            yvb(3) = yvb(3) + (24.d0*zv(2)+6.d0*xv(2))*temp388b54
            yvb(5) = yvb(5) - 3.d0*temp388b54
            zvb(2) = zvb(2) + (24.d0*yv(3)-72.d0*xv(2)*yv(1))*temp388b54
            temp388b56 = -(cost4i*fun0*zb(indorbp, indt+2))
            temp388b57 = 18.d0*zv(1)*temp388b56
            xvb(4) = xvb(4) + 9.d0*zv(1)*temp388b56
            zvb(1) = zvb(1) + (18.d0*xv(2)*yv(2)-15.d0*yv(4)+9.d0*xv(4))&
&              *temp388b56
            xvb(2) = xvb(2) + yv(2)*temp388b57 - 24.d0*zv(3)*temp388b56
            yvb(2) = yvb(2) + 24.d0*zv(3)*temp388b56 + xv(2)*temp388b57
            yvb(4) = yvb(4) - 15.d0*zv(1)*temp388b56
            zvb(3) = zvb(3) + (24.d0*yv(2)-24.d0*xv(2))*temp388b56
            temp388b58 = -(cost4i*fun0*zb(indorbp, indt+1))
            temp388b59 = 36.d0*zv(1)*temp388b58
            temp388b60 = 12.d0*zv(1)*temp388b58
            temp388b61 = -(48.d0*zv(3)*temp388b58)
            xvb(3) = xvb(3) + yv(1)*temp388b59
            yvb(1) = yvb(1) + xv(1)*temp388b61 + xv(3)*temp388b59
            zvb(1) = zvb(1) + (12.d0*xv(1)*yv(3)+36.d0*xv(3)*yv(1))*&
&              temp388b58
            xvb(1) = xvb(1) + yv(1)*temp388b61 + yv(3)*temp388b60
            yvb(3) = yvb(3) + xv(1)*temp388b60
            zvb(3) = zvb(3) - 48.d0*xv(1)*yv(1)*temp388b58
          END IF
        ELSE IF (branch .LT. 11) THEN
          IF (branch .LT. 9) THEN
            IF (branch .LT. 8) THEN
              temp388b62 = cost5i*fun0*zb(indorbp, indt+3)
              temp388b63 = -(120.d0*zv(1)*temp388b62)
              fun0b = fun0b + cost5i*(10.d0*(xv(4)*yv(1))+20.d0*(xv(2)*&
&                yv(3))-6.d0*yv(5)+40.d0*(yv(3)*zv(2))-120.d0*(xv(2)*yv(1&
&                )*zv(2)))*zb(indorbp, indt+2) + cost5i*(20.d0*(xv(3)*yv(&
&                2))-6.d0*xv(5)+10.d0*(xv(1)*yv(4))+40.d0*(xv(3)*zv(2))-&
&                120.d0*(xv(1)*yv(2)*zv(2)))*zb(indorbp, indt+1) + cost5i&
&                *(20.d0*(xv(4)*zv(1))-120.d0*(xv(2)*yv(2)*zv(1))+20.d0*(&
&                yv(4)*zv(1)))*zb(indorbp, indt+3)
              xvb(4) = xvb(4) + 20.d0*zv(1)*temp388b62
              zvb(1) = zvb(1) + (20.d0*yv(4)-120.d0*xv(2)*yv(2)+20.d0*xv&
&                (4))*temp388b62
              xvb(2) = xvb(2) + yv(2)*temp388b63
              yvb(2) = yvb(2) + xv(2)*temp388b63
              yvb(4) = yvb(4) + 20.d0*zv(1)*temp388b62
              temp388b64 = cost5i*fun0*zb(indorbp, indt+2)
              temp388b65 = -(120.d0*zv(2)*temp388b64)
              xvb(4) = xvb(4) + 10.d0*yv(1)*temp388b64
              yvb(1) = yvb(1) + xv(2)*temp388b65 + 10.d0*xv(4)*&
&                temp388b64
              xvb(2) = xvb(2) + yv(1)*temp388b65 + 20.d0*yv(3)*&
&                temp388b64
              yvb(3) = yvb(3) + (40.d0*zv(2)+20.d0*xv(2))*temp388b64
              yvb(5) = yvb(5) - 6.d0*temp388b64
              temp388b66 = cost5i*fun0*zb(indorbp, indt+1)
              zvb(2) = zvb(2) + (40.d0*xv(3)-120.d0*xv(1)*yv(2))*&
&                temp388b66 + (40.d0*yv(3)-120.d0*xv(2)*yv(1))*temp388b64
              temp388b67 = -(120.d0*zv(2)*temp388b66)
              xvb(3) = xvb(3) + (40.d0*zv(2)+20.d0*yv(2))*temp388b66
              yvb(2) = yvb(2) + xv(1)*temp388b67 + 20.d0*xv(3)*&
&                temp388b66
              xvb(5) = xvb(5) - 6.d0*temp388b66
              xvb(1) = xvb(1) + yv(2)*temp388b67 + 10.d0*yv(4)*&
&                temp388b66
              yvb(4) = yvb(4) + 10.d0*xv(1)*temp388b66
            ELSE
              temp388b68 = -(cost5i*fun0*zb(indorbp, indt+3))
              temp388b69 = 80.d0*zv(1)*temp388b68
              temp388b70 = -(80.d0*zv(1)*temp388b68)
              fun0b = fun0b - cost5i*(4.d0*xv(5)-20.d0*(xv(1)*yv(4))+&
&                120.d0*(xv(1)*yv(2)*zv(2))-40.d0*(xv(3)*zv(2)))*zb(&
&                indorbp, indt+2) - cost5i*(20.d0*(xv(4)*yv(1))-4.d0*yv(5&
&                )+40.d0*(yv(3)*zv(2))-120.d0*(xv(2)*yv(1)*zv(2)))*zb(&
&                indorbp, indt+1) - cost5i*(80.d0*(xv(1)*yv(3)*zv(1))-&
&                80.d0*(xv(3)*yv(1)*zv(1)))*zb(indorbp, indt+3)
              xvb(1) = xvb(1) + yv(3)*temp388b69
              yvb(3) = yvb(3) + xv(1)*temp388b69
              zvb(1) = zvb(1) + (80.d0*xv(1)*yv(3)-80.d0*xv(3)*yv(1))*&
&                temp388b68
              xvb(3) = xvb(3) + yv(1)*temp388b70
              yvb(1) = yvb(1) + xv(3)*temp388b70
              temp388b71 = -(cost5i*fun0*zb(indorbp, indt+2))
              temp388b72 = 120.d0*zv(2)*temp388b71
              xvb(5) = xvb(5) + 4.d0*temp388b71
              xvb(1) = xvb(1) + yv(2)*temp388b72 - 20.d0*yv(4)*&
&                temp388b71
              yvb(4) = yvb(4) - 20.d0*xv(1)*temp388b71
              yvb(2) = yvb(2) + xv(1)*temp388b72
              temp388b73 = -(cost5i*fun0*zb(indorbp, indt+1))
              zvb(2) = zvb(2) + (40.d0*yv(3)-120.d0*xv(2)*yv(1))*&
&                temp388b73 + (120.d0*xv(1)*yv(2)-40.d0*xv(3))*temp388b71
              xvb(3) = xvb(3) - 40.d0*zv(2)*temp388b71
              temp388b74 = -(120.d0*zv(2)*temp388b73)
              xvb(4) = xvb(4) + 20.d0*yv(1)*temp388b73
              yvb(1) = yvb(1) + xv(2)*temp388b74 + 20.d0*xv(4)*&
&                temp388b73
              yvb(5) = yvb(5) - 4.d0*temp388b73
              yvb(3) = yvb(3) + 40.d0*zv(2)*temp388b73
              xvb(2) = xvb(2) + yv(1)*temp388b74
            END IF
          ELSE IF (branch .LT. 10) THEN
            temp388b75 = cost6i*fun0*zb(indorbp, indt+3)
            fun0b = fun0b + cost6i*(20.d0*(xv(1)*yv(3)*zv(1))-20.d0*(xv(&
&              3)*yv(1)*zv(1)))*zb(indorbp, indt+2) + cost6i*(5.d0*(xv(4)&
&              *zv(1))-30.d0*(xv(2)*yv(2)*zv(1))+5.d0*(yv(4)*zv(1)))*zb(&
&              indorbp, indt+1) + cost6i*(xv(5)-10.d0*(xv(3)*yv(2))+5.d0*&
&              (xv(1)*yv(4)))*zb(indorbp, indt+3)
            xvb(5) = xvb(5) + temp388b75
            xvb(3) = xvb(3) - 10.d0*yv(2)*temp388b75
            yvb(2) = yvb(2) - 10.d0*xv(3)*temp388b75
            temp388b76 = cost6i*fun0*zb(indorbp, indt+2)
            temp388b77 = 20.d0*zv(1)*temp388b76
            xvb(1) = xvb(1) + yv(3)*temp388b77 + 5.d0*yv(4)*temp388b75
            yvb(4) = yvb(4) + 5.d0*xv(1)*temp388b75
            temp388b78 = -(20.d0*zv(1)*temp388b76)
            yvb(3) = yvb(3) + xv(1)*temp388b77
            temp388b79 = cost6i*fun0*zb(indorbp, indt+1)
            zvb(1) = zvb(1) + (5.d0*yv(4)-30.d0*xv(2)*yv(2)+5.d0*xv(4))*&
&              temp388b79 + (20.d0*xv(1)*yv(3)-20.d0*xv(3)*yv(1))*&
&              temp388b76
            xvb(3) = xvb(3) + yv(1)*temp388b78
            yvb(1) = yvb(1) + xv(3)*temp388b78
            temp388b80 = -(30.d0*zv(1)*temp388b79)
            xvb(4) = xvb(4) + 5.d0*zv(1)*temp388b79
            xvb(2) = xvb(2) + yv(2)*temp388b80
            yvb(2) = yvb(2) + xv(2)*temp388b80
            yvb(4) = yvb(4) + 5.d0*zv(1)*temp388b79
          ELSE
            temp388b81 = -(cost6i*fun0*zb(indorbp, indt+3))
            fun0b = fun0b - cost6i*(30.d0*(xv(2)*yv(2)*zv(1))-5.d0*(xv(4&
&              )*zv(1))-5.d0*(yv(4)*zv(1)))*zb(indorbp, indt+2) - cost6i*&
&              (20.d0*(xv(1)*yv(3)*zv(1))-20.d0*(xv(3)*yv(1)*zv(1)))*zb(&
&              indorbp, indt+1) - cost6i*(10.d0*(xv(2)*yv(3))-5.d0*(xv(4)&
&              *yv(1))-yv(5))*zb(indorbp, indt+3)
            xvb(2) = xvb(2) + 10.d0*yv(3)*temp388b81
            yvb(3) = yvb(3) + 10.d0*xv(2)*temp388b81
            xvb(4) = xvb(4) - 5.d0*yv(1)*temp388b81
            yvb(1) = yvb(1) - 5.d0*xv(4)*temp388b81
            yvb(5) = yvb(5) - temp388b81
            temp388b82 = -(cost6i*fun0*zb(indorbp, indt+2))
            temp388b83 = 30.d0*zv(1)*temp388b82
            xvb(2) = xvb(2) + yv(2)*temp388b83
            yvb(2) = yvb(2) + xv(2)*temp388b83
            temp388b84 = -(cost6i*fun0*zb(indorbp, indt+1))
            zvb(1) = zvb(1) + (20.d0*xv(1)*yv(3)-20.d0*xv(3)*yv(1))*&
&              temp388b84 + (30.d0*xv(2)*yv(2)-5.d0*xv(4)-5.d0*yv(4))*&
&              temp388b82
            xvb(4) = xvb(4) - 5.d0*zv(1)*temp388b82
            yvb(4) = yvb(4) - 5.d0*zv(1)*temp388b82
            temp388b85 = 20.d0*zv(1)*temp388b84
            temp388b86 = -(20.d0*zv(1)*temp388b84)
            xvb(1) = xvb(1) + yv(3)*temp388b85
            yvb(3) = yvb(3) + xv(1)*temp388b85
            xvb(3) = xvb(3) + yv(1)*temp388b86
            yvb(1) = yvb(1) + xv(3)*temp388b86
          END IF
        ELSE IF (branch .LT. 13) THEN
          IF (branch .LT. 12) THEN
            temp388b87 = cost7i*fun0*zb(indorbp, indt+2)
            fun0b = fun0b + cost7i*(6.d0*xv(5)-60.d0*(xv(3)*yv(2))+30.d0&
&              *(xv(1)*yv(4)))*zb(indorbp, indt+1) + cost7i*(60.d0*(xv(2)&
&              *yv(3))-30.d0*(xv(4)*yv(1))-6.d0*yv(5))*zb(indorbp, indt+2&
&              )
            xvb(2) = xvb(2) + 60.d0*yv(3)*temp388b87
            yvb(3) = yvb(3) + 60.d0*xv(2)*temp388b87
            xvb(4) = xvb(4) - 30.d0*yv(1)*temp388b87
            yvb(1) = yvb(1) - 30.d0*xv(4)*temp388b87
            yvb(5) = yvb(5) - 6.d0*temp388b87
            temp388b88 = cost7i*fun0*zb(indorbp, indt+1)
            xvb(5) = xvb(5) + 6.d0*temp388b88
            xvb(3) = xvb(3) - 60.d0*yv(2)*temp388b88
            yvb(2) = yvb(2) - 60.d0*xv(3)*temp388b88
            xvb(1) = xvb(1) + 30.d0*yv(4)*temp388b88
            yvb(4) = yvb(4) + 30.d0*xv(1)*temp388b88
          END IF
        ELSE
          temp388b89 = -(cost7i*fun0*zb(indorbp, indt+2))
          fun0b = fun0b - cost7i*(60.d0*(xv(2)*yv(3))-30.d0*(xv(4)*yv(1)&
&            )-6.d0*yv(5))*zb(indorbp, indt+1) - cost7i*(60.d0*(xv(3)*yv(&
&            2))-6.d0*xv(5)-30.d0*(xv(1)*yv(4)))*zb(indorbp, indt+2)
          xvb(3) = xvb(3) + 60.d0*yv(2)*temp388b89
          yvb(2) = yvb(2) + 60.d0*xv(3)*temp388b89
          xvb(5) = xvb(5) - 6.d0*temp388b89
          xvb(1) = xvb(1) - 30.d0*yv(4)*temp388b89
          yvb(4) = yvb(4) - 30.d0*xv(1)*temp388b89
          temp388b90 = -(cost7i*fun0*zb(indorbp, indt+1))
          xvb(2) = xvb(2) + 60.d0*yv(3)*temp388b90
          yvb(3) = yvb(3) + 60.d0*xv(2)*temp388b90
          xvb(4) = xvb(4) - 30.d0*yv(1)*temp388b90
          yvb(1) = yvb(1) - 30.d0*xv(4)*temp388b90
          yvb(5) = yvb(5) - 6.d0*temp388b90
        END IF
        DO i=3,1,-1
          temp388b12 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp388b12
          funb = funb + rmu(i, 0)*temp388b12
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      DO k=6,1,-1
        CALL POPREAL8(adr8ibuf,adr8buf,xv(k))
        IF (.NOT.(rmu(1, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(1, 0) = rmub(1, 0) + k*rmu(1, 0)**(k-1)*xvb(k)
        xvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,yv(k))
        IF (.NOT.(rmu(2, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(2, 0) = rmub(2, 0) + k*rmu(2, 0)**(k-1)*yvb(k)
        yvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,zv(k))
        IF (.NOT.(rmu(3, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(3, 0) = rmub(3, 0) + k*rmu(3, 0)**(k-1)*zvb(k)
        zvb(k) = 0.0_8
      END DO
      temp388b11 = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp388b11 - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp388b11
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
      zvb = 0.0_8
      xvb = 0.0_8
      yvb = 0.0_8
    END IF
    DO ic=13,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp388b = -(cost7i*distpb(i, 14))
      xvb(3) = xvb(3) + 20.d0*yv(3)*temp388b
      yvb(3) = yvb(3) + 20.d0*xv(3)*temp388b
      xvb(5) = xvb(5) - 6.d0*yv(1)*temp388b
      yvb(1) = yvb(1) - 6.d0*xv(5)*temp388b
      yvb(5) = yvb(5) - 6.d0*xv(1)*temp388b
      xvb(1) = xvb(1) - 6.d0*yv(5)*temp388b
      distpb(i, 14) = 0.0_8
      temp388b0 = cost7i*distpb(i, 13)
      xvb(6) = xvb(6) + temp388b0
      xvb(4) = xvb(4) - 15.d0*yv(2)*temp388b0
      yvb(2) = yvb(2) - 15.d0*xv(4)*temp388b0
      distpb(i, 13) = 0.0_8
      temp388b1 = -(cost6i*zv(1)*distpb(i, 12))
      xvb(2) = xvb(2) + 10.d0*yv(3)*temp388b1 + 15.d0*yv(4)*temp388b0
      yvb(4) = yvb(4) + 15.d0*xv(2)*temp388b0
      yvb(6) = yvb(6) - temp388b0
      yvb(3) = yvb(3) + 10.d0*xv(2)*temp388b1
      xvb(4) = xvb(4) - 5.d0*yv(1)*temp388b1
      yvb(1) = yvb(1) - 5.d0*xv(4)*temp388b1
      yvb(5) = yvb(5) - temp388b1
      zvb(1) = zvb(1) - cost6i*(10.d0*(xv(2)*yv(3))-5.d0*(xv(4)*yv(1))-&
&        yv(5))*distpb(i, 12)
      distpb(i, 12) = 0.0_8
      temp388b2 = cost6i*zv(1)*distpb(i, 11)
      xvb(5) = xvb(5) + temp388b2
      xvb(3) = xvb(3) - 10.d0*yv(2)*temp388b2
      yvb(2) = yvb(2) - 10.d0*xv(3)*temp388b2
      xvb(1) = xvb(1) + 5.d0*yv(4)*temp388b2
      yvb(4) = yvb(4) + 5.d0*xv(1)*temp388b2
      zvb(1) = zvb(1) + cost6i*(xv(5)-10.d0*(xv(3)*yv(2))+5.d0*(xv(1)*yv&
&        (4)))*distpb(i, 11)
      distpb(i, 11) = 0.0_8
      temp388b3 = cost5i*4.d0*distpb(i, 10)
      temp388b4 = cost*temp388b3
      xvb(3) = xvb(3) + yv(1)*temp388b4
      yvb(1) = yvb(1) + xv(3)*temp388b4
      yvb(3) = yvb(3) - xv(1)*temp388b4
      xvb(1) = xvb(1) - yv(3)*temp388b4
      distpb(i, 10) = 0.0_8
      costb = cost5i*(xv(4)-6.d0*(xv(2)*yv(2))+yv(4))*distpb(i, 9) + (xv&
&        (3)*yv(1)-yv(3)*xv(1))*temp388b3
      temp388b5 = cost5i*cost*distpb(i, 9)
      xvb(4) = xvb(4) + temp388b5
      distpb(i, 9) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp388b6 = -(cost4i*cost*distpb(i, 8))
      xvb(2) = xvb(2) - 3.d0*yv(1)*temp388b6 - 6.d0*yv(2)*temp388b5
      yvb(2) = yvb(2) - 6.d0*xv(2)*temp388b5
      yvb(4) = yvb(4) + temp388b5
      zvb(2) = zvb(2) + 11.d0*costb
      r2b = -costb
      yvb(3) = yvb(3) + temp388b6
      yvb(1) = yvb(1) - 3.d0*xv(2)*temp388b6
      costb = -(cost4i*(yv(3)-3.d0*(yv(1)*xv(2)))*distpb(i, 8))
      distpb(i, 8) = 0.0_8
      temp388b7 = cost4i*cost*distpb(i, 7)
      xvb(3) = xvb(3) + temp388b7
      costb = costb + cost4i*(xv(3)-3.d0*(xv(1)*yv(2)))*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp388b8 = cost3i*2.d0*distpb(i, 6)
      xvb(1) = xvb(1) + yv(1)*cost*temp388b8 - 3.d0*yv(2)*temp388b7
      yvb(2) = yvb(2) - 3.d0*xv(1)*temp388b7
      zvb(3) = zvb(3) + 11.d0*costb
      zvb(1) = zvb(1) - 3.d0*r2*costb
      r2b = r2b - 3.d0*zv(1)*costb
      distpb(i, 6) = 0.0_8
      temp388b9 = cost3i*distpb(i, 5)
      costb = (xv(2)-yv(2))*temp388b9 + yv(1)*xv(1)*temp388b8
      yvb(1) = yvb(1) + xv(1)*cost*temp388b8
      xvb(2) = xvb(2) + cost*temp388b9
      yvb(2) = yvb(2) - cost*temp388b9
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      zvb(4) = zvb(4) + 33.d0*costb
      zvb(2) = zvb(2) - 18.d0*r2*costb
      r2b = r2b - 18.d0*zv(2)*costb
      r4b = costb
      rmub(2, i) = rmub(2, i) + cost2i*cost*distpb(i, 4)
      costb = cost2i*rmu(2, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2i*cost*distpb(i, 3)
      costb = costb + cost2i*rmu(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      zvb(5) = zvb(5) + 33.d0*costb
      zvb(3) = zvb(3) - 30.d0*r2*costb
      temp388b10 = cost1i*distpb(i, 2)
      r6b = -(5.d0*temp388b10)
      r4b = r4b + 105.d0*zv(2)*temp388b10 + r2*r6b + 5.d0*zv(1)*costb
      r2b = r2b + 2*r2*r4b - 315.d0*zv(4)*temp388b10 + r4*r6b - 30.d0*zv&
&        (3)*costb
      zvb(1) = zvb(1) + 5.d0*r4*costb
      zvb(6) = zvb(6) + 231.d0*temp388b10
      zvb(4) = zvb(4) - 315.d0*r2*temp388b10
      zvb(2) = zvb(2) + r2b + 105.d0*r4*temp388b10
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,r4)
      CALL POPREAL8(adr8ibuf,adr8buf,r2)
      xvb(2) = xvb(2) + r2b
      yvb(2) = yvb(2) + r2b
      DO k=6,1,-1
        CALL POPREAL8(adr8ibuf,adr8buf,xv(k))
        IF (.NOT.(rmu(1, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(1, i) = rmub(1, i) + k*rmu(1, i)**(k-1)*xvb(k)
        xvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,yv(k))
        IF (.NOT.(rmu(2, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(2, i) = rmub(2, i) + k*rmu(2, i)**(k-1)*yvb(k)
        yvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,zv(k))
        IF (.NOT.(rmu(3, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(3, i) = rmub(3, i) + k*rmu(3, i)**(k-1)*zvb(k)
        zvb(k) = 0.0_8
      END DO
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp387 = r(k)**2
      temp387b62 = c*DEXP(-(dd1*temp387))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp387))*distpb(k, 1)
      dd1b = dd1b - temp387*temp387b62
      rb(k) = rb(k) - dd1*2*r(k)*temp387b62
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.43985656185609913955d0*3.75d0*dd1**2.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (60) 
! 2s gaussian for pseudo                                
! R(r)=r**3*exp(-z*r**2) single zeta                                    
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then 
!     c=2.d0/pi**(3.d0/4.d0)*(2.d0*dd1)**(9.d0/4.d0)*dsqrt(2.d0/105.d0) 
    c = dd1**2.25d0*.55642345640820284397d0
!           endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))*r(k)
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2*dd1
!              the first derivative / r                                 
      fun = distp(0, 1)*(3.d0-2.d0*rp1)
!              the second derivative                                    
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      distpb(0, 1) = (3.d0-2.d0*rp1)*funb + (4.d0*rp1**2-14.d0*rp1+6.d0)&
&        *fun2b
      rp1b = (distp(0, 1)*4.d0*2*rp1-distp(0, 1)*14.d0)*fun2b - distp(0&
&        , 1)*2.d0*funb
      rb(0) = rb(0) + dd1*2*r(0)*rp1b
      dd1b = r(0)**2*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp388 = r(k)**2
      temp388b92 = c*r(k)*DEXP(-(dd1*temp388))*distpb(k, 1)
      temp388b93 = DEXP(-(dd1*temp388))*distpb(k, 1)
      dd1b = dd1b - temp388*temp388b92
      rb(k) = rb(k) + c*temp388b93 - dd1*2*r(k)*temp388b92
      cb = cb + r(k)*temp388b93
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .55642345640820284397d0*2.25d0*dd1**1.25D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (61) 
! 3s -derivative of 60 with respect to dd1          
! R(r)=c (-r**5*exp(-z1*r**2)+c1 r**3 exp(-z1*r**2))                    
!        if(iocc(indshellp).eq.1) then 
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!          if(iflagnorm.gt.2) then 
!     c=2.d0/pi**(3.d0/4.d0)*(2.d0*dd1)**(9.d0/4.d0)*dsqrt(2.d0/105.d0) 
    c = dd1**2.25d0*.55642345640820284397d0
!           endif 
    c1 = 2.25d0/dd1
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))*r(k)
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      rp2 = rp1*dd1
      fun = c1*distp(0, 1)*(3.d0-2.d0*rp2) + distp(0, 1)*rp1*(-5.d0+2.d0&
&        *rp2)
!              the second derivative                                    
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp390b0 = (4.d0*rp2**2-14.d0*rp2+6.d0)*fun2b
      temp390b1 = c1*distp(0, 1)*fun2b
      temp390b2 = (22.d0*rp2-4.d0*rp2**2-20.d0)*fun2b
      temp390b3 = distp(0, 1)*rp1*fun2b
      temp390b4 = (3.d0-2.d0*rp2)*funb
      c1b = distp(0, 1)*temp390b4 + distp(0, 1)*temp390b0
      temp390b5 = (2.d0*rp2-5.d0)*funb
      distpb(0, 1) = c1*temp390b4 + rp1*temp390b5 + rp1*temp390b2 + c1*&
&        temp390b0
      rp2b = (distp(0, 1)*rp1*2.d0-c1*distp(0, 1)*2.d0)*funb + (22.d0-&
&        4.d0*2*rp2)*temp390b3 + (4.d0*2*rp2-14.d0)*temp390b1
      rp1b = distp(0, 1)*temp390b5 + dd1*rp2b + distp(0, 1)*temp390b2
      dd1b = rp1*rp2b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp390b = distp(i, 1)*zb(indorbp, i)
      c1b = c1b + r(i)**2*temp390b
      rb(i) = rb(i) + (c1*2*r(i)-4*r(i)**3)*temp390b
      distpb(i, 1) = distpb(i, 1) + (c1*r(i)**2-r(i)**4)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp389 = r(k)**2
      temp389b = c*r(k)*DEXP(-(dd1*temp389))*distpb(k, 1)
      temp389b0 = DEXP(-(dd1*temp389))*distpb(k, 1)
      dd1b = dd1b - temp389*temp389b
      rb(k) = rb(k) + c*temp389b0 - dd1*2*r(k)*temp389b
      cb = cb + r(k)*temp389b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .55642345640820284397d0*2.25d0*dd1**1.25D0*cb - 2.25d0&
&      *c1b/dd1**2
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (62) 
! single gaussianx r  p orbitals                        
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then 
!        c=2.d0/pi**0.75d0*(2.d0*dd1)**1.75d0/dsqrt(5.d0) 
    c = dd1**1.75d0*1.2749263037197753d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
!        indorbp=indorb 
!                                                                       
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 1)*r(0)
      cost = 2.d0*dd1*r(0)**2
      fun = distp(0, 1)*(1.d0-cost)/r(0)
      fun2 = 2.d0*dd1*fun0*(cost-3.d0)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp392b1 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp392b1
        fun2b = fun2b + temp392b1
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp392b0 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp392b0
          funb = funb + rmu(ic, 0)*temp392b0
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp392b = 2.d0*(cost-3.d0)*fun2b
      temp391b0 = distp(0, 1)*funb/r(0)
      costb = 2.d0*dd1*fun0*fun2b - temp391b0
      dd1b = 2.d0*r(0)**2*costb + fun0*temp392b
      fun0b = fun0b + dd1*temp392b
      distpb = 0.0_8
      temp391 = (-cost+1.d0)/r(0)
      distpb(0, 1) = r(0)*fun0b + temp391*funb
      rb(0) = rb(0) + 2.d0*dd1*2*r(0)*costb + distp(0, 1)*fun0b - &
&        temp391*temp391b0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp391b = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*r(i)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + r(i)*temp391b
        rb(i) = rb(i) + distp(i, 1)*temp391b
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp390 = r(k)**2
      temp390b6 = c*DEXP(-(dd1*temp390))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp390))*distpb(k, 1)
      dd1b = dd1b - temp390*temp390b6
      rb(k) = rb(k) - dd1*2*r(k)*temp390b6
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.2749263037197753d0*1.75d0*dd1**0.75D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (63) 
! derivative of 62 with respect zeta                    
! R(r)=c x*exp(-z*r**2)*r (c1 - r^2)                                    
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then 
    c = dd1**1.75d0*1.2749263037197753d0
!        c=2.d0/pi**0.75d0*(2.d0*dd1)**1.75d0/dsqrt(5.d0) 
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    c1 = 1.75d0/dd1
!        indorbp=indorb 
!                                                                       
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0)**2
      cost = 2.d0*rp1
      fun = distp(0, 1)*(c1*(1.d0-cost)/r(0)+(-3.d0+cost)*r(0))
!           My bug !!!                                                  
!           fun2=distp(0,1)*(c1*2.d0*dd1*fun0*(cost-3.d0)               
!    &-2.d0*r(0)*(3.d0-7.d0*rp1+2.d0*rp1**2))                       
      fun2 = -(2.d0*distp(0, 1)*r(0)*(3.d0-7.d0*rp1+2.d0*rp1**2+c1*dd1*(&
&        3.d0-cost)))
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp395b3 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp395b3
        fun2b = fun2b + temp395b3
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp395b2 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp395b2
          funb = funb + rmu(ic, 0)*temp395b2
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp395b = -(2.d0*(2.d0*rp1**2-7.d0*rp1+c1*dd1*(3.d0-cost)+3.d0)*&
&        fun2b)
      temp395b0 = -(2.d0*distp(0, 1)*r(0)*fun2b)
      temp394 = c1*(-cost+1.d0)/r(0)
      temp394b1 = (c1-r(0)**2)*fun0b
      distpb(0, 1) = (temp394+(cost-3.d0)*r(0))*funb + r(0)*temp394b1 + &
&        r(0)*temp395b
      temp395b1 = distp(0, 1)*funb
      temp394b2 = temp395b1/r(0)
      costb = r(0)*temp395b1 - c1*temp394b2 - c1*dd1*temp395b0
      rp1b = 2.d0*costb + (2.d0*2*rp1-7.d0)*temp395b0
      temp394b3 = distp(0, 1)*r(0)*fun0b
      rb(0) = rb(0) + (cost-3.d0)*temp395b1 - temp394*temp394b2 + dd1*2*&
&        r(0)*rp1b - 2*r(0)*temp394b3 + distp(0, 1)*temp394b1 + distp(0, &
&        1)*temp395b
      c1b = (1.d0-cost)*temp394b2 + temp394b3 + (3.d0-cost)*dd1*&
&        temp395b0
      dd1b = r(0)**2*rp1b + (3.d0-cost)*c1*temp395b0
    ELSE
      distpb = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp393 = c1 - r(i)**2
        temp394b = rmu(ic, i)*temp393*zb(indorbp, i)
        temp394b0 = distp(i, 1)*r(i)*zb(indorbp, i)
        temp393b = rmu(ic, i)*temp394b0
        distpb(i, 1) = distpb(i, 1) + r(i)*temp394b
        rb(i) = rb(i) + distp(i, 1)*temp394b - 2*r(i)*temp393b
        rmub(ic, i) = rmub(ic, i) + temp393*temp394b0
        c1b = c1b + temp393b
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    dd1b = dd1b - 1.75d0*c1b/dd1**2
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp392 = r(k)**2
      temp392b2 = c*DEXP(-(dd1*temp392))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp392))*distpb(k, 1)
      dd1b = dd1b - temp392*temp392b2
      rb(k) = rb(k) - dd1*2*r(k)*temp392b2
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.2749263037197753d0*1.75d0*dd1**0.75D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (64) 
! d orbitals                                                            
! R(r)= r exp(-alpha r^2)                                               
! each gaussian term is normalized                                      
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
!        c=8.d0/dsqrt(21.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0) 
    c = dd1**2.25d0*1.24420067280413253d0
!        endif 
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
! lz=0       
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2     
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2            
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1            
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1            
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      rp1 = 2.d0*dd1*r(0)
      rp2 = rp1*r(0)
      fun0 = distp(0, 1)*r(0)
      fun = (1.d0-rp2)*distp(0, 1)/r(0)
      fun2 = distp(0, 1)*rp1*(rp2-3.d0)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp397b4 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 6.d0*temp397b4
        fun2b = fun2b + temp397b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp397b0 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp397b0
                  fun0b = fun0b + rmu(i, 0)*temp397b0
                ELSE
                  temp397b1 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp397b1
                  fun0b = fun0b + rmu(i, 0)*temp397b1
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp397b2 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp397b2
                fun0b = fun0b + rmu(i, 0)*temp397b2
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp397b3 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp397b3
                fun0b = fun0b + rmu(i, 0)*temp397b3
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp397b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp397b
          funb = funb + rmu(i, 0)*temp397b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp396 = (-rp2+1.d0)/r(0)
      distpb(0, 1) = distpb(0, 1) + temp396*funb + r(0)*fun0b + rp1*(rp2&
&        -3.d0)*fun2b
      temp396b0 = distp(0, 1)*funb/r(0)
      rp2b = distp(0, 1)*rp1*fun2b - temp396b0
      rp1b = r(0)*rp2b + distp(0, 1)*(rp2-3.d0)*fun2b
      rb(0) = rb(0) + distp(0, 1)*fun0b + 2.d0*dd1*rp1b + rp1*rp2b - &
&        temp396*temp396b0
      dd1b = 2.d0*r(0)*rp1b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        temp396b = distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1) = distpb(k, 1) + r(k)*temp396b
        rb(k) = rb(k) + distp(k, 1)*temp396b
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*r(k)*zb(indorbp&
&          , k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp395 = r(k)**2
      temp395b4 = c*DEXP(-(dd1*temp395))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp395))*distpb(k, 1)
      dd1b = dd1b - temp395*temp395b4
      rb(k) = rb(k) - dd1*2*r(k)*temp395b4
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.24420067280413253d0*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (65) 
! d orbitals                                                            
! R(r)= c0 r^3  exp(-alpha r^2)+ c1 r exp(-alpha r^2)                   
! each gaussian term is normalized                                      
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then 
! overall normalization to be done                                      
!        c=8.d0/dsqrt(21.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0) 
    c = dd1**2.25d0*1.24420067280413253d0
!        endif 
    c0 = -c
    c1 = 2.25d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
! lz=0       
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2     
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2            
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1            
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1            
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      rp1 = 2.d0*dd1*r(0)
      rp2 = rp1*r(0)
      fun0 = distp(0, 1)*(c1*r(0)+c0*r(0)**3)
      fun = (c1*(1.d0-rp2)+c0*r(0)**2*(3.d0-rp2))*distp(0, 1)/r(0)
      fun2 = distp(0, 1)*(c1*rp1*(rp2-3.d0)+c0*r(0)*(3.d0-3.5d0*rp2+&
&        0.5d0*rp2**2))
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp404b4 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 6.d0*temp404b4
        fun2b = fun2b + temp404b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp404b0 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp404b0
                  fun0b = fun0b + rmu(i, 0)*temp404b0
                ELSE
                  temp404b1 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp404b1
                  fun0b = fun0b + rmu(i, 0)*temp404b1
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp404b2 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp404b2
                fun0b = fun0b + rmu(i, 0)*temp404b2
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp404b3 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp404b3
                fun0b = fun0b + rmu(i, 0)*temp404b3
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp404b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp404b
          funb = funb + rmu(i, 0)*temp404b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp403 = 0.5d0*rp2**2 - 3.5d0*rp2 + 3.d0
      temp402 = c0*r(0)
      temp402b = distp(0, 1)*fun2b
      temp401b = (c1*(1.d0-rp2)+r(0)**2*(c0*(3.d0-rp2)))*funb/r(0)
      temp400 = r(0)**3
      distpb(0, 1) = distpb(0, 1) + temp401b + (c1*r(0)+c0*temp400)*&
&        fun0b + (c1*rp1*(rp2-3.d0)+temp402*temp403)*fun2b
      temp401 = distp(0, 1)/r(0)
      temp402b0 = temp401*funb
      temp400b = distp(0, 1)*fun0b
      c1b = (1.d0-rp2)*temp402b0 + r(0)*temp400b + (rp2-3.d0)*rp1*&
&        temp402b
      temp402b1 = r(0)**2*temp402b0
      rp2b = (temp402*0.5d0*2*rp2-temp402*3.5d0+c1*rp1)*temp402b - c0*&
&        temp402b1 - c1*temp402b0
      rp1b = r(0)*rp2b + (rp2-3.d0)*c1*temp402b
      c0b = (3.d0-rp2)*temp402b1 + temp400*temp400b + temp403*r(0)*&
&        temp402b
      rb(0) = rb(0) + c0*(3.d0-rp2)*2*r(0)*temp402b0 - temp401*temp401b &
&        + rp1*rp2b + 2.d0*dd1*rp1b + (c0*3*r(0)**2+c1)*temp400b + &
&        temp403*c0*temp402b
      dd1b = 2.d0*r(0)*rp1b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        temp399 = r(k)**3
        temp398 = c0*distp(k, 1+ic)
        temp398b = distp(k, 1)*zb(indorbp, k)
        distpb(k, 1) = distpb(k, 1) + (temp398*temp399+c1*r(k))*zb(&
&          indorbp, k)
        c0b = c0b + temp399*distp(k, 1+ic)*temp398b
        distpb(k, 1+ic) = distpb(k, 1+ic) + temp399*c0*temp398b
        rb(k) = rb(k) + (c1+temp398*3*r(k)**2)*temp398b
        c1b = c1b + r(k)*temp398b
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp397 = r(k)**2
      temp397b6 = c*DEXP(-(dd1*temp397))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp397))*distpb(k, 1)
      dd1b = dd1b - temp397*temp397b6
      rb(k) = rb(k) - dd1*2*r(k)*temp397b6
      distpb(k, 1) = 0.0_8
    END DO
    temp397b5 = 2.25d0*c1b/dd1
    cb = cb + temp397b5 - c0b
    dd1b = dd1b + 1.24420067280413253d0*2.25d0*dd1**1.25D0*cb - c*&
&      temp397b5/dd1
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (100) 
! ******************* END GAUSSIAN BASIS ************************       
! ** ** ** ** ** ** **  JASTROW ORBITALS ** ** ** ** ** ** ** ** *      
!     2s single gaussian                                                
!     exp(-dd2*r^2)                                                     
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)*2.d0)
      distpb = 0.0_8
      temp404b6 = 2.d0**2*dd2*distp(0, 1)*zb(indorbp, indt+4)
      temp404b7 = 2.d0*(2.d0*(dd2*r(0)**2)-3.d0)*zb(indorbp, indt+4)
      dd2b = distp(0, 1)*temp404b7 + r(0)**2*temp404b6
      rb(0) = rb(0) + dd2*2*r(0)*temp404b6
      distpb(0, 1) = dd2*temp404b7
      zb(indorbp, indt+4) = 0.0_8
      funb = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      dd2b = dd2b - 2.d0*distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) - 2.d0*dd2*funb
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp404b5 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp404b5
      rb(k) = rb(k) - dd2*2*r(k)*temp404b5
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (101) 
!     2s without cusp condition                                         
!     dd1*( dd3 +exp(-dd2*r^2))                                         
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)*2.d0)
      distpb = 0.0_8
      temp404b9 = 2.d0**2*dd2*distp(0, 1)*zb(indorbp, indt+4)
      temp404b10 = 2.d0*(2.d0*(dd2*r(0)**2)-3.d0)*zb(indorbp, indt+4)
      dd2b = distp(0, 1)*temp404b10 + r(0)**2*temp404b9
      rb(0) = rb(0) + dd2*2*r(0)*temp404b9
      distpb(0, 1) = dd2*temp404b10
      zb(indorbp, indt+4) = 0.0_8
      funb = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      dd2b = dd2b - 2.d0*distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) - 2.d0*dd2*funb
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp404b8 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp404b8
      rb(k) = rb(k) - dd2*2*r(k)*temp404b8
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (102) 
!     2s double gaussian with constant                                  
!     (dd3+ exp (-dd2 r^2)+dd4*exp(-dd5*r^2))                           
    dd2 = dd(indpar+1)
    dd4 = dd(indpar+3)
    dd5 = dd(indpar+4)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
      distp(k, 2) = DEXP(-(dd5*r(k)*r(k)))
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)            
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(2.d0*(dd2*distp(0, 1)+dd5*dd4*distp(0, 2)))
      fun2 = r(0)**2
      distpb = 0.0_8
      temp404b14 = 2.d0*zb(indorbp, indt+4)
      temp404b15 = dd2*distp(0, 1)*2.d0*temp404b14
      temp404b16 = (2.d0*(dd2*fun2)-3.d0)*temp404b14
      temp404b17 = (2.d0*(dd5*fun2)-3.d0)*temp404b14
      temp404b18 = dd5*dd4*distp(0, 2)*2.d0*temp404b14
      dd2b = distp(0, 1)*temp404b16 + fun2*temp404b15
      fun2b = dd5*temp404b18 + dd2*temp404b15
      distpb(0, 1) = dd2*temp404b16
      dd5b = fun2*temp404b18 + distp(0, 2)*dd4*temp404b17
      dd4b = distp(0, 2)*dd5*temp404b17
      distpb(0, 2) = dd5*dd4*temp404b17
      zb(indorbp, indt+4) = 0.0_8
      funb = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      rb(0) = rb(0) + 2*r(0)*fun2b
      temp404b13 = -(2.d0*funb)
      dd2b = dd2b + distp(0, 1)*temp404b13
      distpb(0, 1) = distpb(0, 1) + dd2*temp404b13
      dd5b = dd5b + distp(0, 2)*dd4*temp404b13
      dd4b = dd4b + distp(0, 2)*dd5*temp404b13
      distpb(0, 2) = distpb(0, 2) + dd5*dd4*temp404b13
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp404b11 = DEXP(-(dd5*r(k)**2))*distpb(k, 2)
      dd5b = dd5b - r(k)**2*temp404b11
      distpb(k, 2) = 0.0_8
      temp404b12 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      rb(k) = rb(k) - dd2*2*r(k)*temp404b12 - dd5*2*r(k)*temp404b11
      dd2b = dd2b - r(k)**2*temp404b12
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+4) = ddb(indpar+4) + dd5b
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (104) 
!     2p  double gaussian                                               
!       dd1 * x_mu  (exp(-dd2 r^2)+dd3 * exp(-dd4*r^2))                 
    dd2 = dd(indpar+1)
    dd3 = dd(indpar+2)
    dd4 = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))
      distp(k, 2) = DEXP(-(dd4*r(k)**2))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = 2.d0*(-(dd2*distp(0, 1))-dd4*dd3*distp(0, 2))
      fun2 = 2.d0*(dd2*(-1.d0+2.d0*dd2*r(0)**2)*distp(0, 1)+dd4*dd3*(-&
&        1.d0+2.d0*dd4*r(0)**2)*distp(0, 2))
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp404b29 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp404b29
        fun2b = fun2b + temp404b29
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp404b28 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp404b28
          funb = funb + rmu(ic, 0)*temp404b28
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp404b22 = 2.d0*fun2b
      temp404b23 = dd2*distp(0, 1)*2.d0*temp404b22
      temp404b24 = (2.d0*(dd2*r(0)**2)-1.d0)*temp404b22
      temp404b25 = (2.d0*(dd4*r(0)**2)-1.d0)*temp404b22
      temp404b26 = dd4*dd3*distp(0, 2)*2.d0*temp404b22
      temp404b27 = 2.d0*funb
      dd2b = distp(0, 1)*temp404b24 - distp(0, 1)*temp404b27 + r(0)**2*&
&        temp404b23
      rb(0) = rb(0) + dd4*2*r(0)*temp404b26 + dd2*2*r(0)*temp404b23
      distpb(0, 1) = dd2*temp404b24
      dd4b = r(0)**2*temp404b26 - distp(0, 2)*dd3*temp404b27 + distp(0, &
&        2)*dd3*temp404b25
      dd3b = distp(0, 2)*fun0b - distp(0, 2)*dd4*temp404b27 + distp(0, 2&
&        )*dd4*temp404b25
      distpb(0, 2) = dd4*dd3*temp404b25
      distpb(0, 1) = distpb(0, 1) - dd2*temp404b27
      distpb(0, 2) = distpb(0, 2) - dd4*dd3*temp404b27
      distpb(0, 1) = distpb(0, 1) + fun0b
      distpb(0, 2) = distpb(0, 2) + dd3*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      dd4b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp404b21 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (distp(i, 1)+dd3*distp(i, 2))*zb(&
&          indorbp, i)
        distpb(i, 1) = distpb(i, 1) + temp404b21
        dd3b = dd3b + distp(i, 2)*temp404b21
        distpb(i, 2) = distpb(i, 2) + dd3*temp404b21
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp404b19 = DEXP(-(dd4*r(k)**2))*distpb(k, 2)
      dd4b = dd4b - r(k)**2*temp404b19
      distpb(k, 2) = 0.0_8
      temp404b20 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      rb(k) = rb(k) - dd2*2*r(k)*temp404b20 - dd4*2*r(k)*temp404b19
      dd2b = dd2b - r(k)**2*temp404b20
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (103) 
!     2p single gaussian                                                
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)*2.d0)
      fun2 = 2.d0*dd2*(-1.d0+2.d0*dd2*r(0)**2)*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp404b34 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp404b34
        fun2b = fun2b + temp404b34
        zb(indorbp, indt+4) = 0.0_8
        fun0b = fun0b + zb(indorbp, indt+ic)
        DO i=3,1,-1
          temp404b33 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp404b33
          funb = funb + rmu(ic, 0)*temp404b33
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp404b31 = 2.d0**2*dd2*distp(0, 1)*fun2b
      temp404b32 = 2.d0*(2.d0*(dd2*r(0)**2)-1.d0)*fun2b
      dd2b = distp(0, 1)*temp404b32 - 2.d0*distp(0, 1)*funb + r(0)**2*&
&        temp404b31
      rb(0) = rb(0) + dd2*2*r(0)*temp404b31
      distpb(0, 1) = fun0b - 2.d0*dd2*funb + dd2*temp404b32
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp404b30 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp404b30
      rb(k) = rb(k) - dd2*2*r(k)*temp404b30
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (105) 
!     2s double gaussian without  constant                              
!     (exp (-dd2 r^2)+dd4*exp(-dd5*r^2))                                
!        dd1=1.d0                                                       
    dd2 = dd(indpar+1)
!        dd3=dd(indpar+2)                                               
!        dd4=dd(indpar+3)                                               
!        dd5=dd(indpar+4)                                               
    dd4 = dd(indpar+2)
    dd5 = dd(indpar+3)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
      distp(k, 2) = DEXP(-(dd5*r(k)*r(k)))
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)            
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(2.d0*(dd2*distp(0, 1)+dd5*dd4*distp(0, 2)))
      fun2 = r(0)**2
      distpb = 0.0_8
      temp404b38 = 2.d0*zb(indorbp, indt+4)
      temp404b39 = dd2*distp(0, 1)*2.d0*temp404b38
      temp404b40 = (2.d0*(dd2*fun2)-3.d0)*temp404b38
      temp404b41 = (2.d0*(dd5*fun2)-3.d0)*temp404b38
      temp404b42 = dd5*dd4*distp(0, 2)*2.d0*temp404b38
      dd2b = distp(0, 1)*temp404b40 + fun2*temp404b39
      fun2b = dd5*temp404b42 + dd2*temp404b39
      distpb(0, 1) = dd2*temp404b40
      dd5b = fun2*temp404b42 + distp(0, 2)*dd4*temp404b41
      dd4b = distp(0, 2)*dd5*temp404b41
      distpb(0, 2) = dd5*dd4*temp404b41
      zb(indorbp, indt+4) = 0.0_8
      funb = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      rb(0) = rb(0) + 2*r(0)*fun2b
      temp404b37 = -(2.d0*funb)
      dd2b = dd2b + distp(0, 1)*temp404b37
      distpb(0, 1) = distpb(0, 1) + dd2*temp404b37
      dd5b = dd5b + distp(0, 2)*dd4*temp404b37
      dd4b = dd4b + distp(0, 2)*dd5*temp404b37
      distpb(0, 2) = distpb(0, 2) + dd5*dd4*temp404b37
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp404b35 = DEXP(-(dd5*r(k)**2))*distpb(k, 2)
      dd5b = dd5b - r(k)**2*temp404b35
      distpb(k, 2) = 0.0_8
      temp404b36 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      rb(k) = rb(k) - dd2*2*r(k)*temp404b36 - dd5*2*r(k)*temp404b35
      dd2b = dd2b - r(k)**2*temp404b36
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd5b
    ddb(indpar+2) = ddb(indpar+2) + dd4b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (106) 
!     2s without cusp condition                                         
!     dd1*( dd3 +1/(1+dd2*r^2))                                         
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)*r(k))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)**2*2.d0)
      fun2b = zb(indorbp, indt+4)
      funb = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp405b = (1.-3.d0*(dd2*r(0)**2))*fun2b
      temp405b0 = -(fun*distp(0, 1)*3.d0*fun2b)
      funb = funb + distp(0, 1)*temp405b
      distpb(0, 1) = fun*temp405b - 2.d0*dd2*2*distp(0, 1)*funb
      dd2b = r(0)**2*temp405b0 - 2.d0*distp(0, 1)**2*funb
      rb(0) = rb(0) + dd2*2*r(0)*temp405b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp404 = dd2*r(k)**2 + 1.d0
      temp404b43 = -(distpb(k, 1)/temp404**2)
      dd2b = dd2b + r(k)**2*temp404b43
      rb(k) = rb(k) + dd2*2*r(k)*temp404b43
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (107) 
!     2p single  lorentian  parent of 103                               
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)**2)
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)**2*2.d0)
      fun2 = fun*distp(0, 1)*(1.d0-3.d0*dd2*r(0)**2)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp406b2 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp406b2
        fun2b = fun2b + temp406b2
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp406b1 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp406b1
          funb = funb + rmu(ic, 0)*temp406b1
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp406b = (1.d0-3.d0*(dd2*r(0)**2))*fun2b
      temp406b0 = -(fun*distp(0, 1)*3.d0*fun2b)
      funb = funb + distp(0, 1)*temp406b
      distpb(0, 1) = fun0b - 2.d0*dd2*2*distp(0, 1)*funb + fun*temp406b
      dd2b = r(0)**2*temp406b0 - 2.d0*distp(0, 1)**2*funb
      rb(0) = rb(0) + dd2*2*r(0)*temp406b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp405 = dd2*r(k)**2 + 1.d0
      temp405b1 = -(distpb(k, 1)/temp405**2)
      dd2b = dd2b + r(k)**2*temp405b1
      rb(k) = rb(k) + dd2*2*r(k)*temp405b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (108) 
!     2s double lorentian with constant  parent of 102                  
!     (dd3+ L(dd2 r^2)+dd4*L(dd5*r^2)) ;  L(x)=1/1+x^2                  
    dd2 = dd(indpar+1)
    dd4 = dd(indpar+3)
    dd5 = dd(indpar+4)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)*r(k))
      distp(k, 2) = 1.d0/(1.d0+dd5*r(k)*r(k))
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)            
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(2.d0*(dd2*distp(0, 1)**2+dd5*dd4*distp(0, 2)**2))
      fun2b = zb(indorbp, indt+4)
      funb = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp409 = distp(0, 1)**3
      temp409b = 2.d0*(3.d0*(dd2*r(0)**2)-1.d0)*fun2b
      temp409b0 = 2.d0*dd2*temp409*3.d0*fun2b
      temp408 = distp(0, 2)**3
      temp408b = 2.d0*(3.d0*(dd5*r(0)**2)-1.d0)*fun2b
      temp408b0 = 2.d0*dd5*dd4*temp408*3.d0*fun2b
      temp408b1 = -(2.d0*funb)
      dd2b = distp(0, 1)**2*temp408b1 + r(0)**2*temp409b0 + temp409*&
&        temp409b
      distpb(0, 1) = dd2*3*distp(0, 1)**2*temp409b
      rb(0) = rb(0) + dd5*2*r(0)*temp408b0 + dd2*2*r(0)*temp409b0
      temp408b2 = distp(0, 2)**2*temp408b1
      dd5b = dd4*temp408b2 + r(0)**2*temp408b0 + temp408*dd4*temp408b
      dd4b = dd5*temp408b2 + temp408*dd5*temp408b
      distpb(0, 2) = dd5*dd4*3*distp(0, 2)**2*temp408b
      distpb(0, 1) = distpb(0, 1) + dd2*2*distp(0, 1)*temp408b1
      distpb(0, 2) = distpb(0, 2) + dd5*dd4*2*distp(0, 2)*temp408b1
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp407 = dd5*r(k)**2 + 1.d0
      temp407b = -(distpb(k, 2)/temp407**2)
      dd5b = dd5b + r(k)**2*temp407b
      distpb(k, 2) = 0.0_8
      temp406 = dd2*r(k)**2 + 1.d0
      temp406b3 = -(distpb(k, 1)/temp406**2)
      rb(k) = rb(k) + dd2*2*r(k)*temp406b3 + dd5*2*r(k)*temp407b
      dd2b = dd2b + r(k)**2*temp406b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+4) = ddb(indpar+4) + dd5b
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (109) 
!     2p  double  Lorentian                                             
!       dd1 * x_mu  (L(dd2 r^2)+dd3 * L(dd4*r^2)) ; L(x)=1/(1+x^2)      
    dd2 = dd(indpar+1)
    dd3 = dd(indpar+2)
    dd4 = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)**2)
      distp(k, 2) = 1.d0/(1.d0+dd4*r(k)**2)
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = 2.d0*(-(dd2*distp(0, 1)**2)-dd4*dd3*distp(0, 2)**2)
!     fun2=2.d0*(dd2*(-1.d0+2.d0*dd2*r(0)**2)*distp(0,1)            
!    1+dd4*dd3*(-1.d0+2.d0*dd4*r(0)**2)*distp(0,2))                 
      fun2 = 2*dd2*distp(0, 1)**3*(-1.d0+3.d0*dd2*r(0)**2) + 2*dd3*dd4*&
&        distp(0, 2)**3*(-1.d0+3.d0*dd4*r(0)**2)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp414b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp414b0
        fun2b = fun2b + temp414b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp414b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp414b
          funb = funb + rmu(ic, 0)*temp414b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp413 = distp(0, 1)**3
      temp413b = 2*(3.d0*(dd2*r(0)**2)-1.d0)*fun2b
      temp413b0 = 2*dd2*temp413*3.d0*fun2b
      temp412 = distp(0, 2)**3
      temp412b0 = 2*(3.d0*(dd4*r(0)**2)-1.d0)*fun2b
      temp412b1 = 2*dd3*dd4*temp412*3.d0*fun2b
      temp412b2 = 2.d0*funb
      dd2b = r(0)**2*temp413b0 - distp(0, 1)**2*temp412b2 + temp413*&
&        temp413b
      distpb(0, 1) = dd2*3*distp(0, 1)**2*temp413b
      rb(0) = rb(0) + dd4*2*r(0)*temp412b1 + dd2*2*r(0)*temp413b0
      temp412b3 = -(distp(0, 2)**2*temp412b2)
      dd3b = dd4*temp412b3 + distp(0, 2)*fun0b + temp412*dd4*temp412b0
      dd4b = dd3*temp412b3 + r(0)**2*temp412b1 + temp412*dd3*temp412b0
      distpb(0, 2) = dd3*dd4*3*distp(0, 2)**2*temp412b0
      distpb(0, 1) = distpb(0, 1) - dd2*2*distp(0, 1)*temp412b2
      distpb(0, 2) = distpb(0, 2) - dd4*dd3*2*distp(0, 2)*temp412b2
      distpb(0, 1) = distpb(0, 1) + fun0b
      distpb(0, 2) = distpb(0, 2) + dd3*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      dd4b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp412b = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (distp(i, 1)+dd3*distp(i, 2))*zb(&
&          indorbp, i)
        distpb(i, 1) = distpb(i, 1) + temp412b
        dd3b = dd3b + distp(i, 2)*temp412b
        distpb(i, 2) = distpb(i, 2) + dd3*temp412b
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp411 = dd4*r(k)**2 + 1.d0
      temp411b = -(distpb(k, 2)/temp411**2)
      dd4b = dd4b + r(k)**2*temp411b
      distpb(k, 2) = 0.0_8
      temp410 = dd2*r(k)**2 + 1.d0
      temp410b = -(distpb(k, 1)/temp410**2)
      rb(k) = rb(k) + dd2*2*r(k)*temp410b + dd4*2*r(k)*temp411b
      dd2b = dd2b + r(k)**2*temp410b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (110) 
!     2s without cusp condition                                         
!     dd1*( dd3 +1/(1+dd2*r^3))                                         
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)**3)
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)**2*3.d0*r(0))
      fun2b = zb(indorbp, indt+4)
      funb = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp415 = r(0)**3
      temp415b = (2.d0-4.d0*(dd2*temp415))*fun2b
      temp415b0 = -(fun*distp(0, 1)*4.d0*fun2b)
      funb = funb + distp(0, 1)*temp415b
      distpb(0, 1) = fun*temp415b - 3.d0*dd2*r(0)*2*distp(0, 1)*funb
      temp415b1 = -(3.d0*distp(0, 1)**2*funb)
      dd2b = r(0)*temp415b1 + temp415*temp415b0
      rb(0) = rb(0) + dd2*temp415b1 + dd2*3*r(0)**2*temp415b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp414 = r(k)**3
      temp414b1 = -(distpb(k, 1)/(dd2*temp414+1.d0)**2)
      dd2b = dd2b + temp414*temp414b1
      rb(k) = rb(k) + dd2*3*r(k)**2*temp414b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (111) 
!     2p single   r_mu/(1+b r^3)   parent of 103                        
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)**3)
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)**2*3.d0*r(0))
      fun2 = fun*distp(0, 1)*(2.d0-4.d0*dd2*r(0)**3)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp418b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp418b0
        fun2b = fun2b + temp418b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp418b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp418b
          funb = funb + rmu(ic, 0)*temp418b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp417 = r(0)**3
      temp417b = (2.d0-4.d0*(dd2*temp417))*fun2b
      temp417b0 = -(fun*distp(0, 1)*4.d0*fun2b)
      funb = funb + distp(0, 1)*temp417b
      distpb(0, 1) = fun0b - 3.d0*dd2*r(0)*2*distp(0, 1)*funb + fun*&
&        temp417b
      temp417b1 = -(3.d0*distp(0, 1)**2*funb)
      dd2b = r(0)*temp417b1 + temp417*temp417b0
      rb(0) = rb(0) + dd2*temp417b1 + dd2*3*r(0)**2*temp417b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp416 = r(k)**3
      temp416b = -(distpb(k, 1)/(dd2*temp416+1.d0)**2)
      dd2b = dd2b + temp416*temp416b
      rb(k) = rb(k) + dd2*3*r(k)**2*temp416b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (112) 
!     2p single   r_mu/(1+b r)^3   parent of 103                        
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k))**3
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(3.d0*dd2*distp(0, 1)/(r(0)*(1.d0+dd2*r(0))))
      fun2 = 12.d0*dd2**2/(1.+dd2*r(0))**5
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp422b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp422b0
        fun2b = fun2b + temp422b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp422b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp422b
          funb = funb + rmu(ic, 0)*temp422b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp421 = (dd2*r(0)+1.)**5
      temp421b = 12.d0*fun2b/temp421
      temp421b0 = -(dd2**2*5*(dd2*r(0)+1.)**4*temp421b/temp421)
      temp420 = dd2*r(0) + 1.d0
      temp420b = -(3.d0*funb/(r(0)*temp420))
      temp420b0 = -(dd2*distp(0, 1)*temp420b/(r(0)*temp420))
      dd2b = distp(0, 1)*temp420b + r(0)**2*temp420b0 + r(0)*temp421b0 +&
&        2*dd2*temp421b
      rb(0) = rb(0) + (r(0)*dd2+temp420)*temp420b0 + dd2*temp421b0
      distpb = 0.0_8
      distpb(0, 1) = fun0b + dd2*temp420b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp418 = dd2*r(k) + 1.d0
      temp419 = temp418**3
      temp418b1 = -(3*temp418**2*distpb(k, 1)/temp419**2)
      dd2b = dd2b + r(k)*temp418b1
      rb(k) = rb(k) + dd2*temp418b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (113) 
!     2s without cusp condition                                         
!     dd1*( dd3 +r^2/(1+dd2*r)^4)                                       
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
!           endif 
    IF (typec .NE. 1) THEN
      fun = (2.d0-2.d0*dd2*r(0))/(1+dd2*r(0))**5
      fun2b = zb(indorbp, indt+4)
      funb = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp425 = (dd2*r(0)+1)**6
      temp425b = 2.d0*fun2b/temp425
      temp425b0 = -((3.d0*(dd2**2*r(0)**2)-6.d0*(dd2*r(0))+1.d0)*6*(dd2*&
&        r(0)+1)**5*temp425b/temp425)
      temp424 = (dd2*r(0)+1)**5
      temp424b = funb/temp424
      temp424b0 = -((2.d0-2.d0*(dd2*r(0)))*5*(dd2*r(0)+1)**4*temp424b/&
&        temp424)
      dd2b = r(0)*temp424b0 - 2.d0*r(0)*temp424b + r(0)*temp425b0 + (&
&        3.d0*r(0)**2*2*dd2-6.d0*r(0))*temp425b
      rb(0) = rb(0) + dd2*temp424b0 - 2.d0*dd2*temp424b + dd2*temp425b0 &
&        + (3.d0*dd2**2*2*r(0)-6.d0*dd2)*temp425b
    ELSE
      dd2b = 0.0_8
    END IF
    distpb = 0.0_8
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp422 = dd2*r(k) + 1.d0
      temp423 = temp422**4
      temp422b1 = -(r(k)**2*4*temp422**3*distpb(k, 1)/temp423**2)
      rb(k) = rb(k) + dd2*temp422b1 + 2*r(k)*distpb(k, 1)/temp423
      dd2b = dd2b + r(k)*temp422b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (114) 
!     2s without cusp condition                                         
!     dd1*( dd3 +r^2/(1+dd2*r)^3)                                       
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
!           endif 
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd2*r(0))/(1+dd2*r(0))**4
      fun2b = zb(indorbp, indt+4)
      funb = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp429 = (dd2*r(0)+1)**5
      temp429b = 2.d0*fun2b/temp429
      temp429b0 = 2*dd2*r(0)*temp429b
      temp429b1 = -(((dd2*r(0))**2-4.d0*(dd2*r(0))+1.d0)*5*(dd2*r(0)+1)&
&        **4*temp429b/temp429)
      temp428 = (dd2*r(0)+1)**4
      temp428b = funb/temp428
      temp428b0 = -((2.d0-dd2*r(0))*4*(dd2*r(0)+1)**3*temp428b/temp428)
      dd2b = r(0)*temp428b0 - r(0)*temp428b + r(0)*temp429b1 - 4.d0*r(0)&
&        *temp429b + r(0)*temp429b0
      rb(0) = rb(0) + dd2*temp428b0 - dd2*temp428b + dd2*temp429b1 - &
&        4.d0*dd2*temp429b + dd2*temp429b0
    ELSE
      dd2b = 0.0_8
    END IF
    distpb = 0.0_8
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp426 = dd2*r(k) + 1.d0
      temp427 = temp426**3
      temp426b = -(r(k)**2*3*temp426**2*distpb(k, 1)/temp427**2)
      rb(k) = rb(k) + dd2*temp426b + 2*r(k)*distpb(k, 1)/temp427
      dd2b = dd2b + r(k)*temp426b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (115) 
!     2s double lorentian with constant  parent of 102                  
!     (dd3+ r^2/(1+dd2*r)^3+dd4*r^3/(1+dd5*r)^4;                        
    dd2 = dd(indpar+1)
    dd4 = dd(indpar+3)
    dd5 = dd(indpar+4)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = r(k)**2/(1.d0+dd2*r(k))**3
      distp(k, 2) = r(k)**3/(1.d0+dd5*r(k))**4
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)            
!           endif 
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd2*r(0))/(1+dd2*r(0))**4 - dd4*r(0)*(-3.d0+dd5*r(0))/&
&        (1.d0+dd5*r(0))**5
      fun2b = zb(indorbp, indt+4)
      funb = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp440 = (dd2*r(0)+1)**5
      temp440b = 2.d0*fun2b/temp440
      temp440b0 = 2*dd2*r(0)*temp440b
      temp440b1 = -(((dd2*r(0))**2-4.d0*(dd2*r(0))+1.d0)*5*(dd2*r(0)+1)&
&        **4*temp440b/temp440)
      temp439 = (dd5*r(0)+1.d0)**6
      temp438 = dd4*r(0)/temp439
      temp439b = 2.d0*temp438*fun2b
      temp439b0 = 2*dd5*r(0)*temp439b
      temp438b = 2.d0*((dd5*r(0))**2-6.d0*(dd5*r(0))+3.d0)*fun2b/temp439
      temp438b0 = -(temp438*6*(dd5*r(0)+1.d0)**5*temp438b)
      temp437 = (dd2*r(0)+1)**4
      temp437b = funb/temp437
      temp437b0 = -((2.d0-dd2*r(0))*4*(dd2*r(0)+1)**3*temp437b/temp437)
      dd2b = r(0)*temp437b0 - r(0)*temp437b + r(0)*temp440b1 - 4.d0*r(0)&
&        *temp440b + r(0)*temp440b0
      temp436 = (dd5*r(0)+1.d0)**5
      temp436b = -(funb/temp436)
      temp435 = dd5*r(0) - 3.d0
      temp434 = dd4*r(0)
      temp434b = -(temp434*temp435*5*(dd5*r(0)+1.d0)**4*temp436b/temp436&
&        )
      rb(0) = rb(0) + dd2*temp437b0 - dd2*temp437b + (temp434*dd5+&
&        temp435*dd4)*temp436b + dd5*temp434b + dd5*temp438b0 + dd4*&
&        temp438b - 6.d0*dd5*temp439b + dd5*temp439b0 + dd2*temp440b1 - &
&        4.d0*dd2*temp440b + dd2*temp440b0
      dd5b = temp434*r(0)*temp436b + r(0)*temp434b + r(0)*temp438b0 - &
&        6.d0*r(0)*temp439b + r(0)*temp439b0
      dd4b = temp435*r(0)*temp436b + r(0)*temp438b
    ELSE
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    distpb = 0.0_8
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp432 = dd5*r(k) + 1.d0
      temp433 = temp432**4
      temp432b = -(r(k)**3*4*temp432**3*distpb(k, 2)/temp433**2)
      rb(k) = rb(k) + dd5*temp432b + 3*r(k)**2*distpb(k, 2)/temp433
      dd5b = dd5b + r(k)*temp432b
      distpb(k, 2) = 0.0_8
      temp430 = dd2*r(k) + 1.d0
      temp431 = temp430**3
      temp430b = -(r(k)**2*3*temp430**2*distpb(k, 1)/temp431**2)
      rb(k) = rb(k) + dd2*temp430b + 2*r(k)*distpb(k, 1)/temp431
      dd2b = dd2b + r(k)*temp430b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+4) = ddb(indpar+4) + dd5b
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (116) 
!     2p  double  Lorentian                                             
!       dd1 * x_mu  (L^3(dd2 r)+dd3 r * L(dd4*r)^4) ; L(x)=1/(1+x)      
    dd2 = dd(indpar+1)
    dd3 = dd(indpar+2)
    dd4 = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k))**3
      distp(k, 2) = r(k)/(1.d0+dd4*r(k))**4
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(3.d0*dd2*distp(0, 1)/(r(0)*(1.d0+dd2*r(0)))) + dd3*distp(0&
&        , 2)/r(0)**2*(1.d0-3*dd4*r(0))/(1.d0+dd4*r(0))
      fun2 = 12.d0*dd2**2/(1.+dd2*r(0))**5 + dd3*4.d0*dd4*(-2.d0+3.d0*&
&        dd4*r(0))/(1.+dd4*r(0))**6
!           fun0=distp(0,1)+dd3*distp(0,2)                              
!           fun=2.d0*(-dd2*distp(0,1)**2-dd4*dd3*distp(0,2)**2)         
!       fun2=2*dd2*distp(0,1)**3*(-1.d0+3.d0*dd2*r(0)**2)           
!    1+2*dd3*dd4*distp(0,2)**3*(-1.d0+3.d0*dd4*r(0)**2)             
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp451b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp451b0
        fun2b = fun2b + temp451b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp451b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp451b
          funb = funb + rmu(ic, 0)*temp451b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp450 = (dd2*r(0)+1.)**5
      temp450b = 12.d0*fun2b/temp450
      temp450b0 = -(dd2**2*5*(dd2*r(0)+1.)**4*temp450b/temp450)
      temp449 = (dd4*r(0)+1.)**6
      temp448 = 3.d0*dd4*r(0) - 2.d0
      temp448b = 4.d0*fun2b/temp449
      temp448b0 = dd3*dd4*3.d0*temp448b
      temp448b1 = -(dd3*dd4*temp448*6*(dd4*r(0)+1.)**5*temp448b/temp449)
      temp445 = dd2*r(0) + 1.d0
      temp445b0 = -(3.d0*funb/(r(0)*temp445))
      temp445b1 = -(dd2*distp(0, 1)*temp445b0/(r(0)*temp445))
      dd2b = distp(0, 1)*temp445b0 + r(0)**2*temp445b1 + r(0)*temp450b0 &
&        + 2*dd2*temp450b
      temp446 = r(0)**2*(dd4*r(0)+1.d0)
      temp448b2 = funb/temp446
      temp447 = (-3)*(dd4*r(0)) + 1.d0
      temp447b = -(dd3*distp(0, 2)*3*temp448b2)
      temp446b = -(dd3*distp(0, 2)*temp447*temp448b2/temp446)
      temp446b0 = r(0)**2*temp446b
      rb(0) = rb(0) + dd4*temp447b + (dd4*r(0)+1.d0)*2*r(0)*temp446b + &
&        dd4*temp446b0 + (r(0)*dd2+temp445)*temp445b1 + dd4*temp448b1 + &
&        dd4*temp448b0 + dd2*temp450b0
      dd3b = temp447*distp(0, 2)*temp448b2 + distp(0, 2)*fun0b + temp448&
&        *dd4*temp448b
      dd4b = r(0)*temp447b + r(0)*temp446b0 + r(0)*temp448b1 + r(0)*&
&        temp448b0 + temp448*dd3*temp448b
      distpb = 0.0_8
      distpb(0, 2) = temp447*dd3*temp448b2
      distpb(0, 1) = fun0b + dd2*temp445b0
      distpb(0, 2) = distpb(0, 2) + dd3*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      dd4b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp445b = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (distp(i, 1)+dd3*distp(i, 2))*zb(&
&          indorbp, i)
        distpb(i, 1) = distpb(i, 1) + temp445b
        dd3b = dd3b + distp(i, 2)*temp445b
        distpb(i, 2) = distpb(i, 2) + dd3*temp445b
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp443 = dd4*r(k) + 1.d0
      temp444 = temp443**4
      temp443b = -(r(k)*4*temp443**3*distpb(k, 2)/temp444**2)
      rb(k) = rb(k) + dd4*temp443b + distpb(k, 2)/temp444
      dd4b = dd4b + r(k)*temp443b
      distpb(k, 2) = 0.0_8
      temp441 = dd2*r(k) + 1.d0
      temp442 = temp441**3
      temp441b = -(3*temp441**2*distpb(k, 1)/temp442**2)
      dd2b = dd2b + r(k)*temp441b
      rb(k) = rb(k) + dd2*temp441b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (117) 
!     2s double lorentian with constant  parent of 102                  
!     (dd3+r^3/(1+dd5*r)^4;                                             
    dd5 = dd(indpar+2)
    indorbp = indorb + 1
!              write(6,*) ' function inside = ',z(indorbp,i)            
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(r(0)*(-3.d0+dd5*r(0))/(1.d0+dd5*r(0))**5)
      fun2b = zb(indorbp, indt+4)
      funb = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp455 = (dd5*r(0)+1.d0)**6
      temp454 = r(0)/temp455
      temp455b = 2.d0*temp454*fun2b
      temp455b0 = 2*dd5*r(0)*temp455b
      temp454b = 2.d0*((dd5*r(0))**2-6.d0*(dd5*r(0))+3.d0)*fun2b/temp455
      temp454b0 = -(temp454*6*(dd5*r(0)+1.d0)**5*temp454b)
      temp453 = (dd5*r(0)+1.d0)**5
      temp453b = -(funb/temp453)
      temp453b0 = -(r(0)*(dd5*r(0)-3.d0)*5*(dd5*r(0)+1.d0)**4*temp453b/&
&        temp453)
      dd5b = r(0)**2*temp453b + r(0)*temp453b0 + r(0)*temp454b0 - 6.d0*r&
&        (0)*temp455b + r(0)*temp455b0
      rb(0) = rb(0) + (r(0)*dd5+dd5*r(0)-3.d0)*temp453b + dd5*temp453b0 &
&        + dd5*temp454b0 + temp454b - 6.d0*dd5*temp455b + dd5*temp455b0
    ELSE
      dd5b = 0.0_8
    END IF
    distpb = 0.0_8
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      dd3b = dd3b + zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp451 = dd5*r(k) + 1.d0
      temp452 = temp451**4
      temp451b1 = -(r(k)**3*4*temp451**3*distpb(k, 1)/temp452**2)
      rb(k) = rb(k) + dd5*temp451b1 + 3*r(k)**2*distpb(k, 1)/temp452
      dd5b = dd5b + r(k)*temp451b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd5b
    ddb(indpar+1) = ddb(indpar+1) + dd3b
  CASE (118) 
!     2s double lorentian with constant  parent of 102                  
!     (dd1+  1/ (1 + Exp[  dd2 (r^2 - r_0^2) ] )   | dd3=r_0            
!      Fermi distribution with r^2                                      
    dd2 = dd(indpar+2)
    dd3 = -(dd2*dd(indpar+3)**2)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,arg)
      arg = dd2*r(k)**2 + dd3
      IF (arg .GT. 200) THEN
        distp(k, 1) = DEXP(200.d0)
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        distp(k, 1) = DEXP(arg)
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      END IF
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)            
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(2.d0*dd2*distp(0, 1)/(1.d0+distp(0, 1))**2)
      fun2b = zb(indorbp, indt+4)
      funb = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp458 = (distp(0, 1)+1.d0)**3
      temp457 = -(2.d0*dd2*r(0)**2) - 1.d0
      temp456 = -(2.d0*dd2*r(0)**2) + 1.d0
      temp456b = -(2.d0*dd2*fun2b/temp458)
      temp456b0 = -(distp(0, 1)**2*2.d0*temp456b)
      temp456b1 = distp(0, 1)*2.d0*temp456b
      temp456b2 = -(2.d0*(distp(0, 1)**2*temp456-distp(0, 1)*temp457)*&
&        fun2b/temp458)
      temp456b3 = -(2.d0*funb/(distp(0, 1)+1.d0)**2)
      distpb(0, 1) = (dd2-dd2*distp(0, 1)*2/(distp(0, 1)+1.d0))*&
&        temp456b3 - dd2*3*(distp(0, 1)+1.d0)**2*temp456b2/temp458 + (&
&        temp456*2*distp(0, 1)-temp457)*temp456b
      dd2b = distp(0, 1)*temp456b3 + temp456b2 + r(0)**2*temp456b1 + r(0&
&        )**2*temp456b0
      rb(0) = rb(0) + dd2*2*r(0)*temp456b1 + dd2*2*r(0)*temp456b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd1b = 0.0_8
    DO i=indtm,i0,-1
      dd1b = dd1b + zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) - zb(indorbp, i)/(distp(i, 1)+1.d0)**2
      zb(indorbp, i) = 0.0_8
    END DO
    dd3b = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 2) THEN
        distpb(k, 1) = 0.0_8
        argb = 0.0_8
      ELSE
        argb = DEXP(arg)*distpb(k, 1)
        distpb(k, 1) = 0.0_8
      END IF
      CALL POPREAL8(adr8ibuf,adr8buf,arg)
      dd2b = dd2b + r(k)**2*argb
      rb(k) = rb(k) + dd2*2*r(k)*argb
      dd3b = dd3b + argb
    END DO
    dd2b = dd2b - dd(indpar+3)**2*dd3b
    ddb(indpar+3) = ddb(indpar+3) - dd2*2*dd(indpar+3)*dd3b
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (119) 
!     2p single   r_mu/(1+b r^2)^(3/2)   parent of 103                  
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)**2)**1.5d0
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(3.d0*dd2*distp(0, 1)/(1.d0+dd2*r(0)**2))
      fun2 = 3.d0*dd2*(-1.d0+4.d0*dd2*r(0)**2)/(1.d0+dd2*r(0)**2)**3.5d0
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp465b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp465b0
        fun2b = fun2b + temp465b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp465b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp465b
          funb = funb + rmu(ic, 0)*temp465b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp462 = dd2*r(0)**2 + 1.d0
      temp464 = temp462**3.5d0
      temp463 = 4.d0*dd2*r(0)**2 - 1.d0
      temp463b = 3.d0*fun2b/temp464
      temp463b0 = dd2*4.d0*temp463b
      temp462b = -(dd2*temp463*3.5d0*temp462**2.5D0*temp463b/temp464)
      temp461 = dd2*r(0)**2 + 1.d0
      temp462b0 = -(3.d0*funb/temp461)
      temp461b = -(dd2*distp(0, 1)*temp462b0/temp461)
      dd2b = distp(0, 1)*temp462b0 + r(0)**2*temp461b + r(0)**2*temp462b&
&        + r(0)**2*temp463b0 + temp463*temp463b
      rb(0) = rb(0) + dd2*2*r(0)*temp461b + dd2*2*r(0)*temp462b + dd2*2*&
&        r(0)*temp463b0
      distpb = 0.0_8
      distpb(0, 1) = fun0b + dd2*temp462b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp459 = dd2*r(k)**2 + 1.d0
      temp460 = temp459**1.5d0
      temp459b = -(1.5d0*temp459**0.5D0*distpb(k, 1)/temp460**2)
      dd2b = dd2b + r(k)**2*temp459b
      rb(k) = rb(k) + dd2*2*r(k)*temp459b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (120) 
!     2p  double  cubic                                                 
!       dd1 * x_mu  (L^3(dd2 r)+dd3 L(dd4*r)^3) ; L(x)=1/(1+x)          
    dd2 = dd(indpar+1)
    dd3 = dd(indpar+2)
    dd4 = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k))**3
      distp(k, 2) = 1.d0/(1.d0+dd4*r(k))**3
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(3.d0*dd2*distp(0, 1)/(r(0)*(1.d0+dd2*r(0)))) - 3.d0*dd4*&
&        dd3*distp(0, 2)/(r(0)*(1.d0+dd4*r(0)))
      fun2 = 12.d0*dd2**2/(1.+dd2*r(0))**5 + 12.d0*dd3*dd4**2/(1.+dd4*r(&
&        0))**5
!           fun0=distp(0,1)+dd3*distp(0,2)                              
!           fun=2.d0*(-dd2*distp(0,1)**2-dd4*dd3*distp(0,2)**2)         
!       fun2=2*dd2*distp(0,1)**3*(-1.d0+3.d0*dd2*r(0)**2)           
!    1+2*dd3*dd4*distp(0,2)**3*(-1.d0+3.d0*dd4*r(0)**2)             
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp473b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp473b0
        fun2b = fun2b + temp473b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp473b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp473b
          funb = funb + rmu(ic, 0)*temp473b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp472 = (dd2*r(0)+1.)**5
      temp472b = 12.d0*fun2b/temp472
      temp472b0 = -(dd2**2*5*(dd2*r(0)+1.)**4*temp472b/temp472)
      temp471 = (dd4*r(0)+1.)**5
      temp471b = 12.d0*fun2b/temp471
      temp471b0 = -(dd3*dd4**2*5*(dd4*r(0)+1.)**4*temp471b/temp471)
      temp470 = dd2*r(0) + 1.d0
      temp470b = -(3.d0*funb/(r(0)*temp470))
      temp470b0 = -(dd2*distp(0, 1)*temp470b/(r(0)*temp470))
      dd2b = distp(0, 1)*temp470b + r(0)**2*temp470b0 + r(0)*temp472b0 +&
&        2*dd2*temp472b
      temp469 = dd4*r(0) + 1.d0
      temp469b0 = -(3.d0*funb/(r(0)*temp469))
      temp469b1 = -(dd4*dd3*distp(0, 2)*temp469b0/(r(0)*temp469))
      rb(0) = rb(0) + (r(0)*dd2+temp470)*temp470b0 + (r(0)*dd4+temp469)*&
&        temp469b1 + dd4*temp471b0 + dd2*temp472b0
      dd3b = distp(0, 2)*dd4*temp469b0 + distp(0, 2)*fun0b + dd4**2*&
&        temp471b
      dd4b = distp(0, 2)*dd3*temp469b0 + r(0)**2*temp469b1 + r(0)*&
&        temp471b0 + dd3*2*dd4*temp471b
      distpb = 0.0_8
      distpb(0, 1) = dd2*temp470b
      distpb(0, 2) = dd4*dd3*temp469b0
      distpb(0, 1) = distpb(0, 1) + fun0b
      distpb(0, 2) = distpb(0, 2) + dd3*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      dd4b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp469b = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (distp(i, 1)+dd3*distp(i, 2))*zb(&
&          indorbp, i)
        distpb(i, 1) = distpb(i, 1) + temp469b
        dd3b = dd3b + distp(i, 2)*temp469b
        distpb(i, 2) = distpb(i, 2) + dd3*temp469b
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp467 = dd4*r(k) + 1.d0
      temp468 = temp467**3
      temp467b = -(3*temp467**2*distpb(k, 2)/temp468**2)
      dd4b = dd4b + r(k)*temp467b
      distpb(k, 2) = 0.0_8
      temp465 = dd2*r(k) + 1.d0
      temp466 = temp465**3
      temp465b1 = -(3*temp465**2*distpb(k, 1)/temp466**2)
      rb(k) = rb(k) + dd2*temp465b1 + dd4*temp467b
      dd2b = dd2b + r(k)*temp465b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (121) 
!     2p single exponential                                             
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)/r(0))
      fun2 = dd2**2*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp474b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp474b0
        fun2b = fun2b + temp474b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp474b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp474b
          funb = funb + rmu(ic, 0)*temp474b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp473b2 = -(distp(0, 1)*funb/r(0))
      dd2b = temp473b2 + distp(0, 1)*2*dd2*fun2b
      temp473 = dd2/r(0)
      distpb(0, 1) = fun0b - temp473*funb + dd2**2*fun2b
      rb(0) = rb(0) - temp473*temp473b2
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp473b1 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp473b1
      rb(k) = rb(k) - dd2*temp473b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (122) 
!     2s with cusp condition                                            
!     dd1*( dd3 +exp(-dd2*r)*(1+dd2*r))                                 
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2**2*distp(0, 1))
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      funb = funb + (1.d0-dd2*r(0))*fun2b
      dd2b = -(distp(0, 1)*2*dd2*funb) - fun*r(0)*fun2b
      rb(0) = rb(0) - fun*dd2*fun2b
      distpb = 0.0_8
      distpb(0, 1) = -(dd2**2*funb)
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      temp474b2 = distp(i, 1)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + (dd2*r(i)+1.d0)*zb(indorbp, i)
      dd2b = dd2b + r(i)*temp474b2
      rb(i) = rb(i) + dd2*temp474b2
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp474b1 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp474b1
      rb(k) = rb(k) - dd2*temp474b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (123) 
!     2p  double  exp                                                   
!       dd1 * x_mu  (exp(-dd2 r)+dd3 * exp(-dd4*r))                     
    dd2 = dd(indpar+1)
    dd3 = dd(indpar+2)
    dd4 = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
      distp(k, 2) = DEXP(-(dd4*r(k)))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -((dd2*distp(0, 1)+dd3*dd4*distp(0, 2))/r(0))
      fun2 = dd2**2*distp(0, 1) + dd3*dd4**2*distp(0, 2)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp474b9 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp474b9
        fun2b = fun2b + temp474b9
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp474b8 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp474b8
          funb = funb + rmu(ic, 0)*temp474b8
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp474b6 = dd4**2*fun2b
      temp474b7 = -(funb/r(0))
      dd2b = distp(0, 1)*temp474b7 + distp(0, 1)*2*dd2*fun2b
      distpb(0, 1) = dd2**2*fun2b
      dd4b = distp(0, 2)*dd3*temp474b7 + dd3*distp(0, 2)*2*dd4*fun2b
      dd3b = distp(0, 2)*dd4*temp474b7 + distp(0, 2)*fun0b + distp(0, 2)&
&        *temp474b6
      distpb(0, 2) = dd3*temp474b6
      distpb(0, 1) = distpb(0, 1) + dd2*temp474b7
      distpb(0, 2) = distpb(0, 2) + dd3*dd4*temp474b7
      rb(0) = rb(0) - (dd2*distp(0, 1)+dd3*dd4*distp(0, 2))*temp474b7/r(&
&        0)
      distpb(0, 1) = distpb(0, 1) + fun0b
      distpb(0, 2) = distpb(0, 2) + dd3*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      dd4b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp474b5 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (distp(i, 1)+dd3*distp(i, 2))*zb(&
&          indorbp, i)
        distpb(i, 1) = distpb(i, 1) + temp474b5
        dd3b = dd3b + distp(i, 2)*temp474b5
        distpb(i, 2) = distpb(i, 2) + dd3*temp474b5
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp474b3 = DEXP(-(dd4*r(k)))*distpb(k, 2)
      dd4b = dd4b - r(k)*temp474b3
      distpb(k, 2) = 0.0_8
      temp474b4 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp474b4 - dd4*temp474b3
      dd2b = dd2b - r(k)*temp474b4
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (124) 
!     2s double exp  with constant and cusp cond.                       
!     (dd3+ exp (-dd2 r)*(1+dd2*r)+dd4*exp(-dd5*r)*(1+dd5*r))           
    dd2 = dd(indpar+1)
    dd4 = dd(indpar+3)
    dd5 = dd(indpar+4)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 3) = DEXP(-(dd2*r(k)))
      distp(k, 4) = DEXP(-(dd5*r(k)))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(k, 1))
      distp(k, 1) = distp(k, 3)*(1.d0+dd2*r(k))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(k, 2))
      distp(k, 2) = distp(k, 4)*(1.d0+dd5*r(k))
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)            
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2**2*distp(0, 3)) - dd5**2*dd4*distp(0, 4)
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp474b14 = -((1.d0-dd2*r(0))*fun2b)
      temp474b15 = -(dd2**2*distp(0, 3)*fun2b)
      temp474b16 = -((1.d0-dd5*r(0))*fun2b)
      temp474b17 = dd5**2*temp474b16
      temp474b18 = -(dd5**2*dd4*distp(0, 4)*fun2b)
      dd2b = distp(0, 3)*2*dd2*temp474b14 - r(0)*temp474b15 - distp(0, 3&
&        )*2*dd2*funb
      distpb(0, 3) = dd2**2*temp474b14
      rb(0) = rb(0) - dd5*temp474b18 - dd2*temp474b15
      dd5b = dd4*distp(0, 4)*2*dd5*temp474b16 - r(0)*temp474b18 - dd4*&
&        distp(0, 4)*2*dd5*funb
      temp474b19 = -(dd5**2*funb)
      dd4b = distp(0, 4)*temp474b19 + distp(0, 4)*temp474b17
      distpb(0, 4) = dd4*temp474b17
      distpb(0, 3) = distpb(0, 3) - dd2**2*funb
      distpb(0, 4) = distpb(0, 4) + dd4*temp474b19
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(k, 2))
      temp474b10 = distp(k, 4)*distpb(k, 2)
      distpb(k, 4) = distpb(k, 4) + (dd5*r(k)+1.d0)*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(k, 1))
      temp474b11 = distp(k, 3)*distpb(k, 1)
      distpb(k, 3) = distpb(k, 3) + (dd2*r(k)+1.d0)*distpb(k, 1)
      distpb(k, 1) = 0.0_8
      temp474b12 = DEXP(-(dd5*r(k)))*distpb(k, 4)
      dd5b = dd5b + r(k)*temp474b10 - r(k)*temp474b12
      distpb(k, 4) = 0.0_8
      temp474b13 = DEXP(-(dd2*r(k)))*distpb(k, 3)
      rb(k) = rb(k) + dd2*temp474b11 - dd2*temp474b13 - dd5*temp474b12 +&
&        dd5*temp474b10
      dd2b = dd2b + r(k)*temp474b11 - r(k)*temp474b13
      distpb(k, 3) = 0.0_8
    END DO
    ddb(indpar+4) = ddb(indpar+4) + dd5b
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (125) 
!     2s with cusp condition                                            
!     dd1*( dd3 +exp(-dd2*r))  ! with no cusp condition                 
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)/r(0))
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp474b21 = -(distp(0, 1)*funb/r(0))
      dd2b = temp474b21 + distp(0, 1)*2*dd2*fun2b
      temp474 = dd2/r(0)
      distpb(0, 1) = dd2**2*fun2b - temp474*funb
      rb(0) = rb(0) - temp474*temp474b21
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp474b20 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp474b20
      rb(k) = rb(k) - dd2*temp474b20
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (126) 
!     2s double exp  with constant                                      
!     (dd3+ exp (-dd2 r)+dd4*exp(-dd5*r))                               
    dd2 = dd(indpar+1)
    dd4 = dd(indpar+3)
    dd5 = dd(indpar+4)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
      distp(k, 2) = DEXP(-(dd5*r(k)))
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)            
!           endif 
    IF (typec .NE. 1) THEN
      fun = -((dd2*distp(0, 1)+dd5*dd4*distp(0, 2))/r(0))
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp475b1 = dd5**2*fun2b
      temp475b2 = -(funb/r(0))
      dd2b = distp(0, 1)*temp475b2 + distp(0, 1)*2*dd2*fun2b
      distpb(0, 1) = dd2**2*fun2b
      dd5b = distp(0, 2)*dd4*temp475b2 + dd4*distp(0, 2)*2*dd5*fun2b
      dd4b = distp(0, 2)*dd5*temp475b2 + distp(0, 2)*temp475b1
      distpb(0, 2) = dd4*temp475b1
      distpb(0, 1) = distpb(0, 1) + dd2*temp475b2
      distpb(0, 2) = distpb(0, 2) + dd5*dd4*temp475b2
      rb(0) = rb(0) - (dd2*distp(0, 1)+dd5*dd4*distp(0, 2))*temp475b2/r(&
&        0)
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp475b = DEXP(-(dd5*r(k)))*distpb(k, 2)
      dd5b = dd5b - r(k)*temp475b
      distpb(k, 2) = 0.0_8
      temp475b0 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp475b0 - dd5*temp475b
      dd2b = dd2b - r(k)*temp475b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+4) = ddb(indpar+4) + dd5b
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (127) 
!     3d without cusp and one parmater                                  
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 3) = distp(i, 1)
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!            endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(dd1*distp(0, 1))
      fun2 = dd1**2*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp476 = fun/r(0)
        temp477b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp476b3 = 6.d0*temp477b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp476+fun2)*zb(&
&          indorbp, indt+4)
        funb = funb + temp476b3
        rb(0) = rb(0) - temp476*temp476b3
        fun2b = fun2b + temp477b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp476b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp476b
                  fun0b = fun0b + rmu(i, 0)*temp476b
                ELSE
                  temp476b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp476b0
                  fun0b = fun0b + rmu(i, 0)*temp476b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp476b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp476b1
                fun0b = fun0b + rmu(i, 0)*temp476b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp476b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp476b2
                fun0b = fun0b + rmu(i, 0)*temp476b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp475 = fun/r(0)
          temp475b4 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp475*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp475*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb = funb + temp475b4
          rb(0) = rb(0) - temp475*temp475b4
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb
      distpb(0, 1) = distpb(0, 1) + dd1**2*fun2b - dd1*funb
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      distpb(i, 1) = distpb(i, 1) + distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp475b3 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp475b3
      rb(k) = rb(k) - dd1*temp475b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (128) 
!     2s with cusp condition                                            
!     ( r^2*exp(-dd2*r))  ! with no cusp condition                      
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd2*r(0))*distp(0, 1)
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp477b1 = distp(0, 1)*fun2b
      temp477b2 = 2*dd2*r(0)*temp477b1
      dd2b = r(0)*temp477b2 - 4*r(0)*temp477b1 - distp(0, 1)*r(0)*funb
      rb(0) = rb(0) + dd2*temp477b2 - 4*dd2*temp477b1 - distp(0, 1)*dd2*&
&        funb
      distpb(0, 1) = (2.d0-dd2*r(0))*funb + ((dd2*r(0))**2-4*(dd2*r(0))+&
&        2.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp477b0 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp477b0
      rb(k) = rb(k) - dd2*temp477b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (129) 
!     2p single exponential  r e^{-z r}  ! parent of 121                
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(1.d0-dd2*r(0))/r(0)
      fun2 = dd2*(dd2*r(0)-2.d0)*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp478b2 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp478b2
        fun2b = fun2b + temp478b2
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp478b1 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp478b1
          funb = funb + rmu(ic, 0)*temp478b1
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp478b = dd2*distp(0, 1)*fun2b
      temp478b0 = (dd2*r(0)-2.d0)*fun2b
      temp477 = distp(0, 1)/r(0)
      dd2b = distp(0, 1)*temp478b0 - temp477*r(0)*funb + r(0)*temp478b
      temp477b5 = (1.d0-dd2*r(0))*funb/r(0)
      rb(0) = rb(0) + distp(0, 1)*fun0b - temp477*dd2*funb - temp477*&
&        temp477b5 + dd2*temp478b
      distpb(0, 1) = temp477b5 + r(0)*fun0b + dd2*temp478b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp477b4 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*r(i)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + r(i)*temp477b4
        rb(i) = rb(i) + distp(i, 1)*temp477b4
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp477b3 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp477b3
      rb(k) = rb(k) - dd2*temp477b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (130) 
!     2p single exponential  r^2  e^{-z r}  ! parent of 121             
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(2.d0-dd2*r(0))
      fun2 = (2.d0-4.d0*dd2*r(0)+(dd2*r(0))**2)*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp478b8 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp478b8
        fun2b = fun2b + temp478b8
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp478b7 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp478b7
          funb = funb + rmu(ic, 0)*temp478b7
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp478b5 = distp(0, 1)*fun2b
      temp478b6 = 2*dd2*r(0)*temp478b5
      dd2b = r(0)*temp478b6 - 4.d0*r(0)*temp478b5 - distp(0, 1)*r(0)*&
&        funb
      rb(0) = rb(0) + distp(0, 1)*2*r(0)*fun0b - distp(0, 1)*dd2*funb - &
&        4.d0*dd2*temp478b5 + dd2*temp478b6
      distpb(0, 1) = (2.d0-dd2*r(0))*funb + r(0)**2*fun0b + ((dd2*r(0))&
&        **2-4.d0*(dd2*r(0))+2.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp478b4 = r(i)**2*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp478b4
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp478b4
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp478b3 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp478b3
      rb(k) = rb(k) - dd2*temp478b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (131) 
!     2s without cusp condition                                         
!     dd1*(r^2*exp(-dd2*r^2))                                           
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun0 = dd2*r(0)**2
      fun = 2.d0*distp(0, 1)*(1.d0-fun0)
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp478b10 = 2.d0*distp(0, 1)*fun2b
      distpb(0, 1) = 2.d0*(1.d0-fun0)*funb + 2.d0*(2.d0*fun0**2-5.d0*&
&        fun0+1.d0)*fun2b
      fun0b = (2.d0*2*fun0-5.d0)*temp478b10 - 2.d0*distp(0, 1)*funb
      dd2b = r(0)**2*fun0b
      rb(0) = rb(0) + dd2*2*r(0)*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp478b9 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp478b9
      rb(k) = rb(k) - dd2*2*r(k)*temp478b9
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (132) 
!     2s with cusp condition                                            
!     ( r^3*exp(-dd2*r))  ! with no cusp condition                      
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))*r(k)
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = (3.d0-dd2*r(0))*distp(0, 1)
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp478b12 = distp(0, 1)*fun2b
      temp478b13 = 2*dd2*r(0)*temp478b12
      dd2b = r(0)*temp478b13 - 6*r(0)*temp478b12 - distp(0, 1)*r(0)*funb
      rb(0) = rb(0) + dd2*temp478b13 - 6*dd2*temp478b12 - distp(0, 1)*&
&        dd2*funb
      distpb(0, 1) = (3.d0-dd2*r(0))*funb + ((dd2*r(0))**2-6*(dd2*r(0))+&
&        6.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp478b11 = r(k)*DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp478b11
      rb(k) = rb(k) + DEXP(-(dd2*r(k)))*distpb(k, 1) - dd2*temp478b11
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (133) 
!     4d  one parmater                                                  
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*r(i)
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!            endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = (1.d0-dd1*r(0))*distp(0, 1)
      fun2 = dd1*(dd1*r(0)-2.d0)*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp479 = fun/r(0)
        temp480b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp479b3 = 6.d0*temp480b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp479+fun2)*zb(&
&          indorbp, indt+4)
        funb = funb + temp479b3
        rb(0) = rb(0) - temp479*temp479b3
        fun2b = fun2b + temp480b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp479b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp479b
                  fun0b = fun0b + rmu(i, 0)*temp479b
                ELSE
                  temp479b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp479b0
                  fun0b = fun0b + rmu(i, 0)*temp479b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp479b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp479b1
                fun0b = fun0b + rmu(i, 0)*temp479b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp479b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp479b2
                fun0b = fun0b + rmu(i, 0)*temp479b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp478 = fun/r(0)
          temp478b17 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp478*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp478*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb = funb + temp478b17
          rb(0) = rb(0) - temp478*temp478b17
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp478b15 = dd1*distp(0, 1)*fun2b
      temp478b16 = (dd1*r(0)-2.d0)*fun2b
      dd1b = distp(0, 1)*temp478b16 - distp(0, 1)*r(0)*funb + r(0)*&
&        temp478b15
      rb(0) = rb(0) + dd1*temp478b15 - distp(0, 1)*dd1*funb
      distpb(0, 1) = distpb(0, 1) + (1.d0-dd1*r(0))*funb + dd1*&
&        temp478b16
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distpb(i, 1) = distpb(i, 1) + r(i)*distpb(i, 3)
      rb(i) = rb(i) + distp(i, 1)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp478b14 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp478b14
      rb(k) = rb(k) - dd1*temp478b14
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (134) 
!     2p single exponential  r^3 e^{-z r}  !                            
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(3.d0-dd2*r(0))*r(0)
!           fun= derivative of fun0 respect to r divided dy r           
      fun2 = distp(0, 1)*(dd2**2*r(0)**3-6*dd2*r(0)**2+6*r(0))
!           fun2= second derivative of fun0 respect to r                
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp481b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp481b0
        fun2b = fun2b + temp481b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp481b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp481b
          funb = funb + rmu(ic, 0)*temp481b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp480 = r(0)**3
      temp480b2 = distp(0, 1)*fun2b
      temp480b3 = (3.d0-dd2*r(0))*funb
      distpb(0, 1) = r(0)*temp480b3 + r(0)**3*fun0b + (dd2**2*temp480-6*&
&        (dd2*r(0)**2)+6*r(0))*fun2b
      temp480b4 = distp(0, 1)*r(0)*funb
      dd2b = (temp480*2*dd2-6*r(0)**2)*temp480b2 - r(0)*temp480b4
      rb(0) = rb(0) + distp(0, 1)*temp480b3 - dd2*temp480b4 + distp(0, 1&
&        )*3*r(0)**2*fun0b + (dd2**2*3*r(0)**2-6*dd2*2*r(0)+6)*temp480b2
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp480b1 = r(i)**3*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp480b1
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp480b1
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*3*r(i)**2*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp480b0 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp480b0
      rb(k) = rb(k) - dd2*temp480b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (135) 
!     2p single exponential  r^4 e^{-z r}  !                            
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(4.d0-dd2*r(0))*r(0)**2
      fun2 = distp(0, 1)*(12*r(0)**2-8*dd2*r(0)**3+dd2**2*r(0)**4)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp483b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp483b0
        fun2b = fun2b + temp483b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp483b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp483b
          funb = funb + rmu(ic, 0)*temp483b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp482 = r(0)**4
      temp481 = r(0)**3
      temp481b3 = distp(0, 1)*fun2b
      temp481b4 = (4.d0-dd2*r(0))*funb
      distpb(0, 1) = r(0)**2*temp481b4 + r(0)**4*fun0b + (12*r(0)**2-8*(&
&        dd2*temp481)+dd2**2*temp482)*fun2b
      temp481b5 = distp(0, 1)*r(0)**2*funb
      rb(0) = rb(0) + distp(0, 1)*2*r(0)*temp481b4 - dd2*temp481b5 + &
&        distp(0, 1)*4*r(0)**3*fun0b + (dd2**2*4*r(0)**3-8*dd2*3*r(0)**2+&
&        12*2*r(0))*temp481b3
      dd2b = (temp482*2*dd2-8*temp481)*temp481b3 - r(0)*temp481b5
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp481b2 = r(i)**4*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp481b2
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp481b2
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*4*r(i)**3*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp481b1 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp481b1
      rb(k) = rb(k) - dd2*temp481b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (136) 
!     2p single exponential  r^5 e^{-z r}  !                            
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(5.d0-dd2*r(0))*r(0)**3
      fun2 = distp(0, 1)*(20*r(0)**3-10*dd2*r(0)**4+dd2**2*r(0)**5)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp485b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp485b0
        fun2b = fun2b + temp485b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp485b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp485b
          funb = funb + rmu(ic, 0)*temp485b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp484 = r(0)**5
      temp483 = r(0)**4
      temp483b3 = distp(0, 1)*fun2b
      temp483b4 = r(0)**3*funb
      distpb(0, 1) = (5.d0-dd2*r(0))*temp483b4 + r(0)**5*fun0b + (20*r(0&
&        )**3-10*(dd2*temp483)+dd2**2*temp484)*fun2b
      rb(0) = rb(0) + distp(0, 1)*(5.d0-dd2*r(0))*3*r(0)**2*funb - distp&
&        (0, 1)*dd2*temp483b4 + distp(0, 1)*5*r(0)**4*fun0b + (dd2**2*5*r&
&        (0)**4-10*dd2*4*r(0)**3+20*3*r(0)**2)*temp483b3
      dd2b = (temp484*2*dd2-10*temp483)*temp483b3 - distp(0, 1)*r(0)*&
&        temp483b4
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp483b2 = r(i)**5*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp483b2
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp483b2
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*5*r(i)**4*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp483b1 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp483b1
      rb(k) = rb(k) - dd2*temp483b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (137) 
!     2s with cusp condition                                            
!     dd1*(exp(-dd2*r)*(1+dd2*r))                                       
    dd2 = dd(indpar+1)
!           if(iflagnorm.gt.2) then                                     
!           c=1.d0/dsqrt(1/4.d0/dd2**3+12*dd2/(2.d0*dd2)**4+            
!    &3*dd2**2/4/dd2**5)/dsqrt(4.0*pi)                                  
!           endif                                                       
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = -(dd2**2*distp(0, 1))
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      funb = funb + (1.d0-dd2*r(0))*fun2b
      dd2b = -(distp(0, 1)*2*dd2*funb) - fun*r(0)*fun2b
      rb(0) = rb(0) - fun*dd2*fun2b
      distpb = 0.0_8
      distpb(0, 1) = -(dd2**2*funb)
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp485b2 = distp(i, 1)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + (dd2*r(i)+1.d0)*zb(indorbp, i)
      dd2b = dd2b + r(i)*temp485b2
      rb(i) = rb(i) + dd2*temp485b2
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp485b1 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp485b1
      rb(k) = rb(k) - dd2*temp485b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (138) 
!     2s with cusp condition                                            
!     ( -dd2*r^2*exp(-dd2*r))  ! with no cusp condition der of 137      
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = -(dd2*DEXP(-(dd2*r(k))))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd2*r(0))*distp(0, 1)
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp485b4 = distp(0, 1)*fun2b
      temp485b5 = 2*dd2*r(0)*temp485b4
      dd2b = r(0)*temp485b5 - 4*r(0)*temp485b4 - distp(0, 1)*r(0)*funb
      rb(0) = rb(0) + dd2*temp485b5 - 4*dd2*temp485b4 - distp(0, 1)*dd2*&
&        funb
      distpb(0, 1) = (2.d0-dd2*r(0))*funb + ((dd2*r(0))**2-4*(dd2*r(0))+&
&        2.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp485b3 = -(dd2*DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp485b3 - DEXP(-(dd2*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp485b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (139) 
!     2s with cusp condition                                            
!     ( r^3*exp(-dd2*r))  !  der of 128                                 
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = -(DEXP(-(dd2*r(k)))*r(k))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = (3.d0-dd2*r(0))*distp(0, 1)
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp485b7 = distp(0, 1)*fun2b
      temp485b8 = 2*dd2*r(0)*temp485b7
      dd2b = r(0)*temp485b8 - 6*r(0)*temp485b7 - distp(0, 1)*r(0)*funb
      rb(0) = rb(0) + dd2*temp485b8 - 6*dd2*temp485b7 - distp(0, 1)*dd2*&
&        funb
      distpb(0, 1) = (3.d0-dd2*r(0))*funb + ((dd2*r(0))**2-6*(dd2*r(0))+&
&        6.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp485b6 = -(r(k)*DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp485b6
      rb(k) = rb(k) - DEXP(-(dd2*r(k)))*distpb(k, 1) - dd2*temp485b6
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (140) 
!     2p single exponential  -r e^{-z r}  ! der  of 121                 
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(1.d0-dd2*r(0))/r(0)
      fun2 = dd2*(dd2*r(0)-2.d0)*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp486b2 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp486b2
        fun2b = fun2b + temp486b2
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp486b1 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp486b1
          funb = funb + rmu(ic, 0)*temp486b1
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp486b = dd2*distp(0, 1)*fun2b
      temp486b0 = (dd2*r(0)-2.d0)*fun2b
      temp485 = distp(0, 1)/r(0)
      dd2b = distp(0, 1)*temp486b0 - temp485*r(0)*funb + r(0)*temp486b
      temp485b11 = (1.d0-dd2*r(0))*funb/r(0)
      rb(0) = rb(0) + distp(0, 1)*fun0b - temp485*dd2*funb - temp485*&
&        temp485b11 + dd2*temp486b
      distpb(0, 1) = temp485b11 + r(0)*fun0b + dd2*temp486b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp485b10 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*r(i)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + r(i)*temp485b10
        rb(i) = rb(i) + distp(i, 1)*temp485b10
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp485b9 = -(DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp485b9
      rb(k) = rb(k) - dd2*temp485b9
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (141) 
!     2p single exponential  r^2  e^{-z r}  ! parent of 121             
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(2.d0-dd2*r(0))
      fun2 = (2.d0-4.d0*dd2*r(0)+(dd2*r(0))**2)*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp486b8 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp486b8
        fun2b = fun2b + temp486b8
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp486b7 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp486b7
          funb = funb + rmu(ic, 0)*temp486b7
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp486b5 = distp(0, 1)*fun2b
      temp486b6 = 2*dd2*r(0)*temp486b5
      dd2b = r(0)*temp486b6 - 4.d0*r(0)*temp486b5 - distp(0, 1)*r(0)*&
&        funb
      rb(0) = rb(0) + distp(0, 1)*2*r(0)*fun0b - distp(0, 1)*dd2*funb - &
&        4.d0*dd2*temp486b5 + dd2*temp486b6
      distpb(0, 1) = (2.d0-dd2*r(0))*funb + r(0)**2*fun0b + ((dd2*r(0))&
&        **2-4.d0*(dd2*r(0))+2.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp486b4 = r(i)**2*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp486b4
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp486b4
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp486b3 = -(DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp486b3
      rb(k) = rb(k) - dd2*temp486b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (142) 
! der of 127                                          
!     4d  one parmater                                                  
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*r(i)
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!            endif 
    IF (typec .NE. 1) THEN
      fun0 = -distp(0, 3)
      fun = -((1.d0-dd1*r(0))*distp(0, 1))
      fun2 = -(dd1*(dd1*r(0)-2.d0)*distp(0, 1))
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp487 = fun/r(0)
        temp488b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp487b3 = 6.d0*temp488b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp487+fun2)*zb(&
&          indorbp, indt+4)
        funb = funb + temp487b3
        rb(0) = rb(0) - temp487*temp487b3
        fun2b = fun2b + temp488b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp487b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp487b
                  fun0b = fun0b + rmu(i, 0)*temp487b
                ELSE
                  temp487b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp487b0
                  fun0b = fun0b + rmu(i, 0)*temp487b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp487b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp487b1
                fun0b = fun0b + rmu(i, 0)*temp487b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp487b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp487b2
                fun0b = fun0b + rmu(i, 0)*temp487b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp486 = fun/r(0)
          temp486b12 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp486*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp486*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb = funb + temp486b12
          rb(0) = rb(0) - temp486*temp486b12
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp486b10 = -(dd1*distp(0, 1)*fun2b)
      temp486b11 = -((dd1*r(0)-2.d0)*fun2b)
      dd1b = distp(0, 1)*r(0)*funb + distp(0, 1)*temp486b11 + r(0)*&
&        temp486b10
      rb(0) = rb(0) + distp(0, 1)*dd1*funb + dd1*temp486b10
      distpb(0, 1) = distpb(0, 1) + dd1*temp486b11 - (1.d0-dd1*r(0))*&
&        funb
      distpb(0, 3) = distpb(0, 3) - fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) - distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) - distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distpb(i, 1) = distpb(i, 1) + r(i)*distpb(i, 3)
      rb(i) = rb(i) + distp(i, 1)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp486b9 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp486b9
      rb(k) = rb(k) - dd1*temp486b9
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (143) 
!     4d  one parmater der of 133                                       
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*r(i)**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!            endif 
    IF (typec .NE. 1) THEN
      fun0 = -distp(0, 3)
      fun = -((-2.d0+dd1*r(0))*distp(0, 1))
      fun2 = ((dd1*r(0))**2-4.d0*r(0)*dd1+2.d0)*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp488b8 = distp(0, 3+ic)*zb(indorbp, indt+4)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 6.d0*temp488b8
        fun2b = fun2b + temp488b8
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp488b4 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp488b4
                  fun0b = fun0b + rmu(i, 0)*temp488b4
                ELSE
                  temp488b5 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp488b5
                  fun0b = fun0b + rmu(i, 0)*temp488b5
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp488b6 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp488b6
                fun0b = fun0b + rmu(i, 0)*temp488b6
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp488b7 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp488b7
                fun0b = fun0b + rmu(i, 0)*temp488b7
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp488b3 = distp(0, 3+ic)*zb(indorbp, indt+i)
          distpb(0, 3+ic) = distpb(0, 3+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp488b3
          funb = funb + rmu(i, 0)*temp488b3
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp488b1 = distp(0, 1)*fun2b
      temp488b2 = 2*dd1*r(0)*temp488b1
      dd1b = r(0)*temp488b2 - 4.d0*r(0)*temp488b1 - distp(0, 1)*r(0)*&
&        funb
      rb(0) = rb(0) + dd1*temp488b2 - 4.d0*dd1*temp488b1 - distp(0, 1)*&
&        dd1*funb
      distpb(0, 1) = distpb(0, 1) + ((dd1*r(0))**2-4.d0*(r(0)*dd1)+2.d0)&
&        *fun2b - (dd1*r(0)-2.d0)*funb
      distpb(0, 3) = distpb(0, 3) - fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) - distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) - distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distpb(i, 1) = distpb(i, 1) + r(i)**2*distpb(i, 3)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp488b0 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp488b0
      rb(k) = rb(k) - dd1*temp488b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (144) 
!     2p single exponential  -r^3 e^{-z r}  ! derivative of  130        
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(3.d0-dd2*r(0))*r(0)
!           fun= derivative of fun0 respect to r divided dy r           
      fun2 = distp(0, 1)*(dd2**2*r(0)**3-6*dd2*r(0)**2+6*r(0))
!           fun2= second derivative of fun0 respect to r                
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp489b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp489b0
        fun2b = fun2b + temp489b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp489b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp489b
          funb = funb + rmu(ic, 0)*temp489b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp488 = r(0)**3
      temp488b11 = distp(0, 1)*fun2b
      temp488b12 = (3.d0-dd2*r(0))*funb
      distpb(0, 1) = r(0)*temp488b12 + r(0)**3*fun0b + (dd2**2*temp488-6&
&        *(dd2*r(0)**2)+6*r(0))*fun2b
      temp488b13 = distp(0, 1)*r(0)*funb
      dd2b = (temp488*2*dd2-6*r(0)**2)*temp488b11 - r(0)*temp488b13
      rb(0) = rb(0) + distp(0, 1)*temp488b12 - dd2*temp488b13 + distp(0&
&        , 1)*3*r(0)**2*fun0b + (dd2**2*3*r(0)**2-6*dd2*2*r(0)+6)*&
&        temp488b11
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp488b10 = r(i)**3*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp488b10
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp488b10
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*3*r(i)**2*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp488b9 = -(DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp488b9
      rb(k) = rb(k) - dd2*temp488b9
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (145) 
!     2s without cusp condition  !derivative 100                        
!     -(r^2*exp(-dd2*r^2))                                              
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun0 = dd2*r(0)**2
      fun = -(2.d0*distp(0, 1)*(1.d0-fun0))
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp489b2 = -(2.d0*distp(0, 1)*fun2b)
      distpb(0, 1) = -(2.d0*(1.d0-fun0)*funb) - 2.d0*(2.d0*fun0**2-5.d0*&
&        fun0+1.d0)*fun2b
      fun0b = 2.d0*distp(0, 1)*funb + (2.d0*2*fun0-5.d0)*temp489b2
      dd2b = r(0)**2*fun0b
      rb(0) = rb(0) + dd2*2*r(0)*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) - r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) - distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp489b1 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp489b1
      rb(k) = rb(k) - dd2*2*r(k)*temp489b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (146) 
!     2p single exponential  -r^2  e^{-z r^2}  ! derivative  of 103     
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp2 = dd2*r(0)*r(0)
      fun = distp(0, 1)*(-2.d0+2.d0*rp2)
      fun2 = (-2.d0+10.d0*rp2-4.d0*rp2*rp2)*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp489b6 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp489b6
        fun2b = fun2b + temp489b6
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp489b5 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp489b5
          funb = funb + rmu(ic, 0)*temp489b5
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      rp2b = distp(0, 1)*2.d0*funb + (distp(0, 1)*10.d0-distp(0, 1)*4.d0&
&        *2*rp2)*fun2b
      distpb(0, 1) = (2.d0*rp2-2.d0)*funb - r(0)**2*fun0b + (10.d0*rp2-&
&        4.d0*rp2**2-2.d0)*fun2b
      rb(0) = rb(0) + dd2*2*r(0)*rp2b - distp(0, 1)*2*r(0)*fun0b
      dd2b = r(0)**2*rp2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp489b4 = -(r(i)**2*zb(indorbp, i))
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp489b4
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp489b4
        rb(i) = rb(i) - rmu(ic, i)*distp(i, 1)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp489b3 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp489b3
      rb(k) = rb(k) - dd2*2*r(k)*temp489b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (147) 
! 3d single gaussian                                                    
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 3) = distp(i, 1)
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!            endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = ((2.d0*dd1*r(0))**2-2.d0*dd1)*distp(0, 1)
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        END IF
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp490b5 = distp(0, 3+ic)*zb(indorbp, indt+4)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 6.d0*temp490b5
        fun2b = fun2b + temp490b5
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 3) THEN
          IF (branch .LT. 2) THEN
            IF (branch .LT. 1) THEN
              temp490b0 = cost1d*4.d0*zb(indorbp, indt+3)
              rmub(3, 0) = rmub(3, 0) + fun0*temp490b0
              temp490b1 = -(cost1d*2.d0*zb(indorbp, indt+2))
              temp490b2 = -(cost1d*2.d0*zb(indorbp, indt+1))
              fun0b = fun0b + rmu(2, 0)*temp490b1 + rmu(1, 0)*temp490b2 &
&                + rmu(3, 0)*temp490b0
              rmub(2, 0) = rmub(2, 0) + fun0*temp490b1
              rmub(1, 0) = rmub(1, 0) + fun0*temp490b2
            ELSE
              temp490b3 = -(cost2d*2.d0*zb(indorbp, indt+2))
              rmub(2, 0) = rmub(2, 0) + fun0*temp490b3
              temp490b4 = cost2d*2.d0*zb(indorbp, indt+1)
              fun0b = fun0b + rmu(1, 0)*temp490b4 + rmu(2, 0)*temp490b3
              rmub(1, 0) = rmub(1, 0) + fun0*temp490b4
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+2)
            fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+1) + &
&              cost3d*rmu(1, 0)*zb(indorbp, indt+2)
            rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+1)
          END IF
        ELSE IF (branch .LT. 5) THEN
          IF (branch .LT. 4) THEN
            rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+3)
            fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+2) + &
&              cost3d*rmu(2, 0)*zb(indorbp, indt+3)
            rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+2)
          END IF
        ELSE
          rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+3)
          fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+1) + cost3d*&
&            rmu(1, 0)*zb(indorbp, indt+3)
          rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+1)
        END IF
        DO i=3,1,-1
          temp490b = distp(0, 3+ic)*zb(indorbp, indt+i)
          distpb(0, 3+ic) = distpb(0, 3+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp490b
          funb = funb + rmu(i, 0)*temp490b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp489 = 2.d0*dd1*r(0)
      temp489b8 = distp(0, 1)*2*temp489*2.d0*fun2b
      dd1b = r(0)*temp489b8 - distp(0, 1)*2.d0*fun2b - 2.d0*distp(0, 1)*&
&        funb
      rb(0) = rb(0) + dd1*temp489b8
      distpb(0, 1) = distpb(0, 1) + (temp489**2-2.d0*dd1)*fun2b - 2.d0*&
&        dd1*funb
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      distpb(i, 1) = distpb(i, 1) + distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp489b7 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp489b7
      rb(k) = rb(k) - dd1*2*r(k)*temp489b7
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (148) 
!  derivative of 147 with respect to dd1                                
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = -(r(i)**2*distp(i, 1))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb 
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!            endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = 2.d0*(dd1*r(0)**2-1.d0)*r(0)*distp(0, 1)
      fun2 = -(2.d0*(2.d0*dd1**2*r(0)**4+1.d0-5.d0*dd1*r(0)**2)*distp(0&
&        , 1))
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp492 = fun/r(0)
        temp493b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp492b3 = 6.d0*temp493b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp492+fun2)*zb(&
&          indorbp, indt+4)
        funb = funb + temp492b3
        rb(0) = rb(0) - temp492*temp492b3
        fun2b = fun2b + temp493b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp492b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp492b
                  fun0b = fun0b + rmu(i, 0)*temp492b
                ELSE
                  temp492b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp492b0
                  fun0b = fun0b + rmu(i, 0)*temp492b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp492b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp492b1
                fun0b = fun0b + rmu(i, 0)*temp492b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp492b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp492b2
                fun0b = fun0b + rmu(i, 0)*temp492b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp491 = fun/r(0)
          temp491b = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp491*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp491*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb = funb + temp491b
          rb(0) = rb(0) - temp491*temp491b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp490 = r(0)**4
      temp490b7 = -(2.d0*distp(0, 1)*fun2b)
      temp490b8 = 2.d0*r(0)*distp(0, 1)*funb
      dd1b = r(0)**2*temp490b8 + (2.d0*temp490*2*dd1-5.d0*r(0)**2)*&
&        temp490b7
      temp490b9 = 2.d0*(dd1*r(0)**2-1.d0)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp490b8 + distp(0, 1)*temp490b9 + (&
&        2.d0*dd1**2*4*r(0)**3-5.d0*dd1*2*r(0))*temp490b7
      distpb(0, 1) = distpb(0, 1) + r(0)*temp490b9 - 2.d0*(2.d0*(dd1**2*&
&        temp490)-5.d0*(dd1*r(0)**2)+1.d0)*fun2b
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      rb(i) = rb(i) - distp(i, 1)*2*r(i)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) - r(i)**2*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp490b6 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp490b6
      rb(k) = rb(k) - dd1*2*r(k)*temp490b6
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (149) 
! derivative of 131 with respect z_1                                    
! - r^4 exp(-z_1 r^2)                                                   
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun0 = dd2*r(0)**2
      fun = -(2.d0*r(0)**2*distp(0, 1)*(2.d0-fun0))
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp493b1 = -(2.d0*(2.d0*fun0**2-9.d0*fun0+6.d0)*fun2b)
      temp493b2 = -(2.d0*r(0)**2*distp(0, 1)*fun2b)
      temp493b3 = -(2.d0*r(0)**2*funb)
      fun0b = (2.d0*2*fun0-9.d0)*temp493b2 - distp(0, 1)*temp493b3
      rb(0) = rb(0) + dd2*2*r(0)*fun0b - 2.d0*distp(0, 1)*(2.d0-fun0)*2*&
&        r(0)*funb + distp(0, 1)*2*r(0)*temp493b1
      distpb(0, 1) = (2.d0-fun0)*temp493b3 + r(0)**2*temp493b1
      dd2b = r(0)**2*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) - r(i)**4*zb(indorbp, i)
      rb(i) = rb(i) - distp(i, 1)*4*r(i)**3*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp493b0 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp493b0
      rb(k) = rb(k) - dd2*2*r(k)*temp493b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (150) 
!     2p single exponential  r e^{-z r^2}                               
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 1)*r(0)
      cost = 2.d0*dd2*r(0)**2
      fun = distp(0, 1)*(1.d0-cost)/r(0)
      fun2 = 2.d0*dd2*fun0*(cost-3.d0)
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp494b1 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp494b1
        fun2b = fun2b + temp494b1
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp494b0 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp494b0
          funb = funb + rmu(ic, 0)*temp494b0
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp494b = 2.d0*(cost-3.d0)*fun2b
      temp493b6 = distp(0, 1)*funb/r(0)
      costb = 2.d0*dd2*fun0*fun2b - temp493b6
      dd2b = 2.d0*r(0)**2*costb + fun0*temp494b
      fun0b = fun0b + dd2*temp494b
      distpb = 0.0_8
      temp493 = (-cost+1.d0)/r(0)
      distpb(0, 1) = r(0)*fun0b + temp493*funb
      rb(0) = rb(0) + 2.d0*dd2*2*r(0)*costb + distp(0, 1)*fun0b - &
&        temp493*temp493b6
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp493b5 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*r(i)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + r(i)*temp493b5
        rb(i) = rb(i) + distp(i, 1)*temp493b5
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp493b4 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp493b4
      rb(k) = rb(k) - dd2*2*r(k)*temp493b4
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (151) 
!     2p single exponential  -r^3  e^{-z r^2}  ! parent of 150          
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))
    END DO
!        indorbp=indorb 
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      cost = dd2*r(0)**2
      fun = distp(0, 1)*(-3.d0+2.d0*cost)*r(0)
      fun2 = -(2.d0*distp(0, 1)*r(0)*(3.d0-7.d0*cost+2.d0*cost**2))
!              indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp494b8 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp494b8
        fun2b = fun2b + temp494b8
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp494b7 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp494b7
          funb = funb + rmu(ic, 0)*temp494b7
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp494b4 = -(2.d0*(2.d0*cost**2-7.d0*cost+3.d0)*fun2b)
      temp494b5 = -(2.d0*distp(0, 1)*r(0)*fun2b)
      temp494b6 = (2.d0*cost-3.d0)*funb
      distpb(0, 1) = r(0)*temp494b6 - r(0)**3*fun0b + r(0)*temp494b4
      costb = distp(0, 1)*r(0)*2.d0*funb + (2.d0*2*cost-7.d0)*temp494b5
      rb(0) = rb(0) + distp(0, 1)*temp494b6 - distp(0, 1)*3*r(0)**2*&
&        fun0b + dd2*2*r(0)*costb + distp(0, 1)*temp494b4
      dd2b = r(0)**2*costb
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp494b3 = -(r(i)**3*zb(indorbp, i))
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp494b3
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp494b3
        rb(i) = rb(i) - rmu(ic, i)*distp(i, 1)*3*r(i)**2*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp494b2 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp494b2
      rb(k) = rb(k) - dd2*2*r(k)*temp494b2
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (152) 
!     2s with cusp condition                                            
!     ( r^3*exp(-dd2*r^2))  ! with no cusp condition                    
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))*r(k)
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2*dd2
      fun = (3.d0-2.d0*rp1)*distp(0, 1)
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      rp1b = (distp(0, 1)*4.d0*2*rp1-distp(0, 1)*14.d0)*fun2b - distp(0&
&        , 1)*2.d0*funb
      distpb(0, 1) = (3.d0-2.d0*rp1)*funb + (4.d0*rp1**2-14.d0*rp1+6.d0)&
&        *fun2b
      rb(0) = rb(0) + dd2*2*r(0)*rp1b
      dd2b = r(0)**2*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp494 = r(k)**2
      temp494b9 = r(k)*DEXP(-(dd2*temp494))*distpb(k, 1)
      dd2b = dd2b - temp494*temp494b9
      rb(k) = rb(k) + DEXP(-(dd2*temp494))*distpb(k, 1) - dd2*2*r(k)*&
&        temp494b9
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (153) 
!     2s with cusp condition                                            
!     (-r^5*exp(-dd2*r^2))  ! derivative of 152                         
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))*r(k)**3
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp1 = dd2*r(0)**2
      fun = (-5.d0+2.d0*rp1)*distp(0, 1)
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      rp1b = distp(0, 1)*2.d0*funb + (distp(0, 1)*22.d0-distp(0, 1)*4.d0&
&        *2*rp1)*fun2b
      distpb(0, 1) = (2.d0*rp1-5.d0)*funb + (22.d0*rp1-4.d0*rp1**2-20.d0&
&        )*fun2b
      dd2b = r(0)**2*rp1b
      rb(0) = rb(0) + dd2*2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) - r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) - distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp495 = r(k)**2
      temp495b = r(k)**3*DEXP(-(dd2*temp495))*distpb(k, 1)
      dd2b = dd2b - temp495*temp495b
      rb(k) = rb(k) + DEXP(-(dd2*temp495))*3*r(k)**2*distpb(k, 1) - dd2*&
&        2*r(k)*temp495b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (154) 
! Jastrow single gaussian f orbital
! R(r)= exp(-alpha r^2)                                                 
! unnormalized                                                            
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0        
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2           
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2                   
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3     
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3     
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
!            dd1=dd(indparp) 
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
!              indorbp=indorb 
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        ELSE IF (ic .EQ. 6) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
        END IF
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp496b29 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 8.d0*temp496b29
        fun2b = fun2b + temp496b29
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 4) THEN
          IF (branch .LT. 2) THEN
            IF (branch .LT. 1) THEN
              temp496b10 = cost1f*zb(indorbp, indt+3)
              temp496b11 = -(cost1f*6.d0*zb(indorbp, indt+2))
              temp496b12 = -(cost1f*6.d0*zb(indorbp, indt+1))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp496b11 + rmu(3, 0)&
&                *rmu(1, 0)*temp496b12 + (9.d0*rmu(3, 0)**2-3.d0*r(0)**2)&
&                *temp496b10
              rmub(3, 0) = rmub(3, 0) + fun0*9.d0*2*rmu(3, 0)*temp496b10
              rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp496b10
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp496b11
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp496b11
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp496b12
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp496b12
            ELSE
              temp496b13 = cost2f*8.d0*zb(indorbp, indt+3)
              temp496b14 = -(cost2f*2.d0*zb(indorbp, indt+2))
              fun0b = fun0b + rmu(1, 0)*rmu(2, 0)*temp496b14 + cost2f*(&
&                5.d0*rmu(3, 0)**2-r(0)**2-2.d0*rmu(1, 0)**2)*zb(indorbp&
&                , indt+1) + rmu(1, 0)*rmu(3, 0)*temp496b13
              rmub(3, 0) = rmub(3, 0) + rmu(1, 0)*fun0*temp496b13
              rmub(1, 0) = rmub(1, 0) + fun0*rmu(3, 0)*temp496b13
              rmub(2, 0) = rmub(2, 0) + rmu(1, 0)*fun0*temp496b14
              rmub(1, 0) = rmub(1, 0) + fun0*rmu(2, 0)*temp496b14
              temp496b15 = cost2f*fun0*zb(indorbp, indt+1)
              rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp496b15
              rb(0) = rb(0) - 2*r(0)*temp496b15
              rmub(1, 0) = rmub(1, 0) - 2.d0*2*rmu(1, 0)*temp496b15
            END IF
          ELSE IF (branch .LT. 3) THEN
            temp496b16 = cost2f*8.d0*zb(indorbp, indt+3)
            temp496b17 = -(cost2f*2.d0*zb(indorbp, indt+1))
            fun0b = fun0b + cost2f*(5.d0*rmu(3, 0)**2-r(0)**2-2.d0*rmu(2&
&              , 0)**2)*zb(indorbp, indt+2) + rmu(2, 0)*rmu(1, 0)*&
&              temp496b17 + rmu(2, 0)*rmu(3, 0)*temp496b16
            rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*fun0*temp496b16
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(3, 0)*temp496b16
            temp496b18 = cost2f*fun0*zb(indorbp, indt+2)
            rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp496b18
            rb(0) = rb(0) - 2*r(0)*temp496b18
            rmub(2, 0) = rmub(2, 0) - 2.d0*2*rmu(2, 0)*temp496b18
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp496b17
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp496b17
          ELSE
            temp496b19 = cost3f*zb(indorbp, indt+3)
            temp496b20 = -(cost3f*2.d0*zb(indorbp, indt+2))
            temp496b21 = cost3f*2.d0*zb(indorbp, indt+1)
            fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp496b20 + rmu(3, 0)*&
&              rmu(1, 0)*temp496b21 + (rmu(1, 0)**2-rmu(2, 0)**2)*&
&              temp496b19
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp496b19
            rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp496b20 - fun0*2&
&              *rmu(2, 0)*temp496b19
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp496b20
            rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp496b21
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp496b21
          END IF
        ELSE IF (branch .LT. 6) THEN
          IF (branch .LT. 5) THEN
            temp496b22 = cost3f*2.d0*zb(indorbp, indt+3)
            temp496b23 = cost3f*2.d0*zb(indorbp, indt+2)
            temp496b24 = cost3f*2.d0*zb(indorbp, indt+1)
            fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp496b23 + rmu(3, 0)*&
&              rmu(2, 0)*temp496b24 + rmu(2, 0)*rmu(1, 0)*temp496b22
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp496b22
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp496b22
            rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp496b23
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp496b23
            rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp496b24
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp496b24
          ELSE
            temp496b25 = -(cost4f*6.d0*zb(indorbp, indt+2))
            temp496b26 = cost4f*3.d0*zb(indorbp, indt+1)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp496b26 + rmu&
&              (2, 0)*rmu(1, 0)*temp496b25
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp496b25
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp496b25
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp496b26
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp496b26
          END IF
        ELSE
          temp496b27 = cost4f*3.d0*zb(indorbp, indt+2)
          temp496b28 = cost4f*6.d0*zb(indorbp, indt+1)
          fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp496b28 + (rmu(1, 0)**2&
&            -rmu(2, 0)**2)*temp496b27
          rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp496b27
          rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp496b27
          rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp496b28
          rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp496b28
        END IF
        DO i=3,1,-1
          temp496b9 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp496b9
          funb = funb + rmu(i, 0)*temp496b9
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp496b8 = -(fun*2.d0*fun2b)
      funb = funb + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp496b8 - 2.d0*distp(0, 1)*funb
      rb(0) = rb(0) + dd1*2*r(0)*temp496b8
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp496b0 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp496b0
      distpb(i, 8) = 0.0_8
      temp496b1 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp496b1 + 3.d0*2*rmu(1, i)*&
&        temp496b0
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp496b1
      distpb(i, 7) = 0.0_8
      temp496b2 = cost3f*2.d0*distpb(i, 6)
      temp496b3 = rmu(2, i)*temp496b2
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp496b3
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp496b3
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp496b2
      distpb(i, 6) = 0.0_8
      temp496b4 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp496b4
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp496b4
      temp496b5 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp496b5
      distpb(i, 4) = 0.0_8
      temp496b6 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp496b7 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp496b6 - 3.d0*2*r(i)*temp496b7 - 2*r(i)*&
&        temp496b5
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp496b7 + 5.d0*2*rmu(3, i)*&
&        temp496b6
      distpb(i, 2) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp496b = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp496b
      rb(k) = rb(k) - dd1*2*r(k)*temp496b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (155) 
! Jastrow single gaussian f orbital
! derivative of 154 with respect to z
! unnormalized f orbitals                                                            
! R(r)= -r^2*exp(-z r^2)                                       
!        indorbp=indorb 
    indparp = indpar + 1
    dd1 = dd(indparp)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0        
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1         
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2           
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2                   
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3     
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3     
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = -(r(0)**2*distp(0, 1))
      fun = 2.d0*(dd1*r(0)**2-1.d0)*distp(0, 1)
      fun2 = -(2.d0*(2.d0*dd1**2*r(0)**4+1.d0-5.d0*dd1*r(0)**2)*distp(0&
&        , 1))
!              indorbp=indorb 
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp497b23 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 8.d0*temp497b23
        fun2b = fun2b + temp497b23
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp497b2 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp497b2
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp497b2
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp497b2
                  END IF
                  temp497b0 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp497b1 = rmu(i, 0)*temp497b0
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp497b0
                  fun0b = fun0b + rmu(3, 0)*temp497b1
                  rmub(3, 0) = rmub(3, 0) + fun0*temp497b1
                  GOTO 150
                ELSE
                  temp497b5 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp497b5
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp497b5
                  rb(0) = rb(0) - fun0*2*r(0)*temp497b5
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp497b6 = cost2f*10.d0*zb(indorbp, indt+i)
                temp497b7 = rmu(i, 0)*temp497b6
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp497b6
                fun0b = fun0b + rmu(1, 0)*temp497b7
                rmub(1, 0) = rmub(1, 0) + fun0*temp497b7
              END IF
              temp497b3 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp497b4 = rmu(i, 0)*temp497b3
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp497b3
              fun0b = fun0b + rmu(1, 0)*temp497b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp497b4
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp497b10 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp497b10
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp497b10
                  rb(0) = rb(0) - fun0*2*r(0)*temp497b10
                END IF
              ELSE
                temp497b11 = cost2f*10.d0*zb(indorbp, indt+i)
                temp497b12 = rmu(i, 0)*temp497b11
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp497b11
                fun0b = fun0b + rmu(2, 0)*temp497b12
                rmub(2, 0) = rmub(2, 0) + fun0*temp497b12
              END IF
              temp497b8 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp497b9 = rmu(i, 0)*temp497b8
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp497b8
              fun0b = fun0b + rmu(2, 0)*temp497b9
              rmub(2, 0) = rmub(2, 0) + fun0*temp497b9
            ELSE IF (branch .LT. 10) THEN
              temp497b13 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp497b13
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp497b13
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp497b13
            ELSE
              temp497b14 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp497b14
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp497b14
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp497b14
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp497b15 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp497b15
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp497b15
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp497b15
                ELSE
                  temp497b16 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp497b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp497b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp497b16
                END IF
              ELSE
                temp497b17 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp497b17
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp497b17
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp497b17
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp497b18 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp497b18
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp497b18
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp497b18
            ELSE
              temp497b19 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp497b19
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp497b19
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp497b19
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp497b20 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp497b20
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp497b20
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp497b20
              END IF
            ELSE
              temp497b21 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp497b21
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp497b21
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp497b21
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp497b22 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp497b22
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp497b22
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp497b22
          END IF
 150      temp497b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp497b
          funb = funb + rmu(i, 0)*temp497b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp496 = r(0)**4
      temp496b40 = -(2.d0*distp(0, 1)*fun2b)
      temp496b41 = 2.d0*distp(0, 1)*funb
      dd1b = r(0)**2*temp496b41 + (2.d0*temp496*2*dd1-5.d0*r(0)**2)*&
&        temp496b40
      rb(0) = rb(0) + dd1*2*r(0)*temp496b41 - distp(0, 1)*2*r(0)*fun0b +&
&        (2.d0*dd1**2*4*r(0)**3-5.d0*dd1*2*r(0))*temp496b40
      distpb(0, 1) = distpb(0, 1) + 2.d0*(dd1*r(0)**2-1.d0)*funb - r(0)&
&        **2*fun0b - 2.d0*(2.d0*(dd1**2*temp496)-5.d0*(dd1*r(0)**2)+1.d0)&
&        *fun2b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        temp496b39 = -(r(k)**2*zb(indorbp, k))
        rb(k) = rb(k) - distp(k, 1)*distp(k, 1+ic)*2*r(k)*zb(indorbp, k)
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp496b39
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp496b39
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp496b31 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp496b31
      distpb(i, 8) = 0.0_8
      temp496b32 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp496b32 + 3.d0*2*rmu(1, i)*&
&        temp496b31
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp496b32
      distpb(i, 7) = 0.0_8
      temp496b33 = cost3f*2.d0*distpb(i, 6)
      temp496b34 = rmu(2, i)*temp496b33
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp496b34
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp496b34
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp496b33
      distpb(i, 6) = 0.0_8
      temp496b35 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp496b35
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp496b35
      temp496b36 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp496b36
      distpb(i, 4) = 0.0_8
      temp496b37 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp496b38 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp496b37 - 3.d0*2*r(i)*temp496b38 - 2*r(i&
&        )*temp496b36
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp496b38 + 5.d0*2*rmu(3, i)*&
&        temp496b37
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    DO k=indtm,indtmin,-1
      temp496b30 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp496b30
      rb(k) = rb(k) - dd1*2*r(k)*temp496b30
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (199) 
! derivative of 200 LA COSTANTE                                         
    indorbp = indorb + 1
!           endif 
    IF (typec .NE. 1) THEN
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        zb(indorbp, indt+i) = 0.0_8
      END DO
    END IF
    DO i=indtm,i0,-1
      zb(indorbp, i) = 0.0_8
    END DO
    distpb = 0.0_8
  CASE (200) 
!     THE  COSTANT                                                      
    indorbp = indorb + 1
!           endif 
    IF (typec .NE. 1) THEN
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        zb(indorbp, indt+i) = 0.0_8
      END DO
    END IF
    DO i=indtm,i0,-1
      zb(indorbp, i) = 0.0_8
    END DO
    distpb = 0.0_8
  CASE (1000:1099) 
!     s gaussian  r**(2*npower)*exp(-alpha*r**2)                        
    npower = iopt - 1000
    indorbp = indorb + 1
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = r(k)**(2*npower)*DEXP(-(dd2*r(k)**2))
    END DO
!        endif 
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp500 = distp(0, 1)/rp1
      temp501b = 2.d0*temp500*fun2b
      temp501b0 = -((npower*4.d0+1.d0)*temp501b)
      temp500b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp499 = distp(0, 1)/rp1
      temp500b0 = 2.d0*temp499*funb
      dd2b = rp1*temp501b0 - rp1*temp500b0 + 2.d0*rp1**2*2*dd2*temp501b
      temp499b = 2.d0*(npower-dd2*rp1)*funb/rp1
      rp1b = dd2*temp501b0 - temp499*temp499b - temp500*temp500b - dd2*&
&        temp500b0 + 2.d0*dd2**2*2*rp1*temp501b
      distpb(0, 1) = temp499b + temp500b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp498 = r(k)**2
      temp497 = 2*npower
      temp497b24 = r(k)**temp497*DEXP(-(dd2*temp498))*distpb(k, 1)
      IF (r(k) .LE. 0.0 .AND. (temp497 .EQ. 0.0 .OR. temp497 .NE. INT(&
&          temp497))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp497b24
      ELSE
        rb(k) = rb(k) + DEXP(-(dd2*temp498))*temp497*r(k)**(temp497-1)*&
&          distpb(k, 1) - dd2*2*r(k)*temp497b24
      END IF
      dd2b = dd2b - temp498*temp497b24
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (2000:2099) 
!     s gaussian  -r**(2*(npower+1))*exp(-alpha*r**2) derivative of 1000
    npower = iopt + 1 - 2000
    indorbp = indorb + 1
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -(r(k)**(2*npower)*DEXP(-(dd2*r(k)**2)))
    END DO
!        endif 
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      funb = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        funb = funb + rmu(i, 0)*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp504 = distp(0, 1)/rp1
      temp505b = 2.d0*temp504*fun2b
      temp505b0 = -((npower*4.d0+1.d0)*temp505b)
      temp504b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp503 = distp(0, 1)/rp1
      temp504b0 = 2.d0*temp503*funb
      dd2b = rp1*temp505b0 - rp1*temp504b0 + 2.d0*rp1**2*2*dd2*temp505b
      temp503b = 2.d0*(npower-dd2*rp1)*funb/rp1
      rp1b = dd2*temp505b0 - temp503*temp503b - temp504*temp504b - dd2*&
&        temp504b0 + 2.d0*dd2**2*2*rp1*temp505b
      distpb(0, 1) = temp503b + temp504b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp502 = r(k)**2
      temp501 = 2*npower
      temp501b1 = -(r(k)**temp501*DEXP(-(dd2*temp502))*distpb(k, 1))
      IF (r(k) .LE. 0.0 .AND. (temp501 .EQ. 0.0 .OR. temp501 .NE. INT(&
&          temp501))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp501b1
      ELSE
        rb(k) = rb(k) - dd2*2*r(k)*temp501b1 - DEXP(-(dd2*temp502))*&
&          temp501*r(k)**(temp501-1)*distpb(k, 1)
      END IF
      dd2b = dd2b - temp502*temp501b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (1100:1199) 
!     p gaussian  r**(2*npower)*exp(-alpha*r**2)                        
    npower = iopt - 1100
!        indorbp=indorb 
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = r(k)**(2*npower)*DEXP(-(dd2*r(k)**2))
    END DO
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      fun2 = (npower*(2.d0*npower-1.d0)-(1.d0+4.d0*npower)*dd2*rp1+2.d0*&
&        (dd2*rp1)**2)*distp(0, 1)*2.d0/rp1
!           indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!              if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp509b2 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp509b2
        fun2b = fun2b + temp509b2
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp509b1 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp509b1
          funb = funb + rmu(ic, 0)*temp509b1
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp508 = distp(0, 1)/rp1
      temp509b = 2.d0*temp508*fun2b
      temp509b0 = -((npower*4.d0+1.d0)*temp509b)
      temp508b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp507 = distp(0, 1)/rp1
      temp508b0 = 2.d0*temp507*funb
      dd2b = rp1*temp509b0 - rp1*temp508b0 + 2.d0*rp1**2*2*dd2*temp509b
      temp507b = 2.d0*(npower-dd2*rp1)*funb/rp1
      rp1b = dd2*temp509b0 - temp507*temp507b - temp508*temp508b - dd2*&
&        temp508b0 + 2.d0*dd2**2*2*rp1*temp509b
      distpb(0, 1) = temp507b + fun0b + temp508b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp506 = r(k)**2
      temp505 = 2*npower
      temp505b1 = r(k)**temp505*DEXP(-(dd2*temp506))*distpb(k, 1)
      IF (r(k) .LE. 0.0 .AND. (temp505 .EQ. 0.0 .OR. temp505 .NE. INT(&
&          temp505))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp505b1
      ELSE
        rb(k) = rb(k) + DEXP(-(dd2*temp506))*temp505*r(k)**(temp505-1)*&
&          distpb(k, 1) - dd2*2*r(k)*temp505b1
      END IF
      dd2b = dd2b - temp506*temp505b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (2100:2199) 
!     p gaussian  -r**(2*(npower+1))*exp(-alpha*r**2) derivative 1100   
    npower = iopt + 1 - 2100
!        indorbp=indorb 
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -(r(k)**(2*npower)*DEXP(-(dd2*r(k)**2)))
    END DO
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      fun2 = (npower*(2.d0*npower-1.d0)-(1.d0+4.d0*npower)*dd2*rp1+2.d0*&
&        (dd2*rp1)**2)*distp(0, 1)*2.d0/rp1
!           indorbp=indorb 
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!              if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp513b2 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb = funb + 4.d0*temp513b2
        fun2b = fun2b + temp513b2
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp513b1 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp513b1
          funb = funb + rmu(ic, 0)*temp513b1
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp512 = distp(0, 1)/rp1
      temp513b = 2.d0*temp512*fun2b
      temp513b0 = -((npower*4.d0+1.d0)*temp513b)
      temp512b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp511 = distp(0, 1)/rp1
      temp512b0 = 2.d0*temp511*funb
      dd2b = rp1*temp513b0 - rp1*temp512b0 + 2.d0*rp1**2*2*dd2*temp513b
      temp511b = 2.d0*(npower-dd2*rp1)*funb/rp1
      rp1b = dd2*temp513b0 - temp511*temp511b - temp512*temp512b - dd2*&
&        temp512b0 + 2.d0*dd2**2*2*rp1*temp513b
      distpb(0, 1) = temp511b + fun0b + temp512b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp510 = r(k)**2
      temp509 = 2*npower
      temp509b3 = -(r(k)**temp509*DEXP(-(dd2*temp510))*distpb(k, 1))
      IF (r(k) .LE. 0.0 .AND. (temp509 .EQ. 0.0 .OR. temp509 .NE. INT(&
&          temp509))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp509b3
      ELSE
        rb(k) = rb(k) - dd2*2*r(k)*temp509b3 - DEXP(-(dd2*temp510))*&
&          temp509*r(k)**(temp509-1)*distpb(k, 1)
      END IF
      dd2b = dd2b - temp510*temp509b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (1200:1299) 
!     d gaussian  r**(2*npower)*exp(-alpha*r**2)                        
    npower = iopt - 1200
!        indorbp=indorb 
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = r(k)**(2*npower)*DEXP(-(dd2*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun0 = distp(0, 1)
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      fun2 = (npower*(2.d0*npower-1.d0)-(1.d0+4.d0*npower)*dd2*rp1+2.d0*&
&        (dd2*rp1)**2)*distp(0, 1)*2.d0/rp1
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp517b6 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 6.d0*temp517b6
        fun2b = fun2b + temp517b6
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp517b2 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp517b2
                  fun0b = fun0b + rmu(i, 0)*temp517b2
                ELSE
                  temp517b3 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp517b3
                  fun0b = fun0b + rmu(i, 0)*temp517b3
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp517b4 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp517b4
                fun0b = fun0b + rmu(i, 0)*temp517b4
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp517b5 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp517b5
                fun0b = fun0b + rmu(i, 0)*temp517b5
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp517b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp517b1
          funb = funb + rmu(i, 0)*temp517b1
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp516 = distp(0, 1)/rp1
      temp517b = 2.d0*temp516*fun2b
      temp517b0 = -((npower*4.d0+1.d0)*temp517b)
      temp516b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp515 = distp(0, 1)/rp1
      temp516b0 = 2.d0*temp515*funb
      dd2b = rp1*temp517b0 - rp1*temp516b0 + 2.d0*rp1**2*2*dd2*temp517b
      temp515b = 2.d0*(npower-dd2*rp1)*funb/rp1
      rp1b = dd2*temp517b0 - temp515*temp515b - temp516*temp516b - dd2*&
&        temp516b0 + 2.d0*dd2**2*2*rp1*temp517b
      distpb(0, 1) = distpb(0, 1) + temp515b + fun0b + temp516b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 1+ic) = distpb(i, 1+ic) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + distp(i, 1+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp514 = r(k)**2
      temp513 = 2*npower
      temp513b3 = r(k)**temp513*DEXP(-(dd2*temp514))*distpb(k, 1)
      IF (r(k) .LE. 0.0 .AND. (temp513 .EQ. 0.0 .OR. temp513 .NE. INT(&
&          temp513))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp513b3
      ELSE
        rb(k) = rb(k) + DEXP(-(dd2*temp514))*temp513*r(k)**(temp513-1)*&
&          distpb(k, 1) - dd2*2*r(k)*temp513b3
      END IF
      dd2b = dd2b - temp514*temp513b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (2200:2299) 
!     d gaussian  -r**(2*(npower+1))*exp(-alpha*r**2) derivative 1200   
    npower = iopt + 1 - 2200
!        indorbp=indorb 
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -(r(k)**(2*npower)*DEXP(-(dd2*r(k)**2)))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then 
      indorbp = indorb + ic
    END DO
!           endif 
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun0 = distp(0, 1)
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      fun2 = (npower*(2.d0*npower-1.d0)-(1.d0+4.d0*npower)*dd2*rp1+2.d0*&
&        (dd2*rp1)**2)*distp(0, 1)*2.d0/rp1
!              indorbp=indorb 
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then 
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp521b6 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb = funb + 6.d0*temp521b6
        fun2b = fun2b + temp521b6
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp521b2 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp521b2
                  fun0b = fun0b + rmu(i, 0)*temp521b2
                ELSE
                  temp521b3 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp521b3
                  fun0b = fun0b + rmu(i, 0)*temp521b3
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp521b4 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp521b4
                fun0b = fun0b + rmu(i, 0)*temp521b4
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp521b5 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp521b5
                fun0b = fun0b + rmu(i, 0)*temp521b5
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp521b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp521b1
          funb = funb + rmu(i, 0)*temp521b1
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp520 = distp(0, 1)/rp1
      temp521b = 2.d0*temp520*fun2b
      temp521b0 = -((npower*4.d0+1.d0)*temp521b)
      temp520b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp519 = distp(0, 1)/rp1
      temp520b0 = 2.d0*temp519*funb
      dd2b = rp1*temp521b0 - rp1*temp520b0 + 2.d0*rp1**2*2*dd2*temp521b
      temp519b = 2.d0*(npower-dd2*rp1)*funb/rp1
      rp1b = dd2*temp521b0 - temp519*temp519b - temp520*temp520b - dd2*&
&        temp520b0 + 2.d0*dd2**2*2*rp1*temp521b
      distpb(0, 1) = distpb(0, 1) + temp519b + fun0b + temp520b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 1+ic) = distpb(i, 1+ic) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + distp(i, 1+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp518 = r(k)**2
      temp517 = 2*npower
      temp517b7 = -(r(k)**temp517*DEXP(-(dd2*temp518))*distpb(k, 1))
      IF (r(k) .LE. 0.0 .AND. (temp517 .EQ. 0.0 .OR. temp517 .NE. INT(&
&          temp517))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp517b7
      ELSE
        rb(k) = rb(k) - dd2*2*r(k)*temp517b7 - DEXP(-(dd2*temp518))*&
&          temp517*r(k)**(temp517-1)*distpb(k, 1)
      END IF
      dd2b = dd2b - temp518*temp517b7
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE DEFAULT
    distpb = 0.0_8
  END SELECT
END SUBROUTINE MAKEFUN_B
