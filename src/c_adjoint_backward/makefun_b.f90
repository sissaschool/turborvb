!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.3 (r3163) - 09/25/2009 09:03
!
!  Differentiation of makefun in reverse (adjoint) mode:
!   gradient, with respect to input variables: dd r z rmu distp
!   of linear combination of output variables: dd r z rmu
!TL off
SUBROUTINE MAKEFUN_B(iopt, indt, i0, indtmin, indtm, typec, indpar, &
&  indorb, indshell, nelskip, z, zb, dd, ddb, zeta, r, rb, rmu, rmub, &
&  distp, distpb, iflagnorm_unused, cr)
  USE CONSTANTS
  IMPLICIT NONE
! TAPENADE adBuffer vars
  integer :: adi4ibuf,adr8ibuf,adi4buf(1024)
  real*8  :: adr8buf(1024)
! ---
  INTEGER :: iopt, indt, i, k, nelskip, indpar, indorbp, indorb, &
&  indshell, indshellp, ic, indtmin, i0, iflagnorm_unused, indparp, indtm&
&  , npower, typec, ii, jj, kk
! up to i
  REAL*8 :: z(nelskip, i0:*), dd(*), zeta(*), rmu(3, 0:indtm), r(0:indtm&
&  ), distp(0:indtm, 20), peff, fun, fun0, fun2, rp1, rp2, rp3, rp4, rp5&
&  , rp6, rp7, rp8, dd1, dd2, dd3, dd4, dd5, c, cr, funp, fun2p, funb, &
&  peff2, arg, c0, c1, cost, zv(6), yv(6), xv(6), r2, r4, r6
  REAL*8 :: zb(nelskip, i0:*), ddb(*), rmub(3, 0:indtm), rb(0:indtm), &
&  distpb(0:indtm, 20), peffb, funb0, fun0b, fun2b, rp1b, rp2b, rp3b, &
&  rp4b, rp5b, rp6b, rp8b, dd1b, dd2b, dd3b, dd4b, dd5b, cb, funpb, &
&  fun2pb, funbb, peff2b, argb, c0b, c1b, costb, zvb(6), yvb(6), xvb(6), &
&  r2b, r4b, r6b
  INTEGER :: count, multiplicity
  INTEGER, PARAMETER :: max_power=20
  REAL*8 :: powers(3, -2:max_power, 0:indtm)
  REAL*8 :: powersb(3, -2:max_power, 0:indtm)
  REAL*8 :: tmp
  REAL*8 :: tmp0
  REAL*8 :: tmp1
  REAL*8 :: tmp2
  REAL*8 :: tmp3
  REAL*8 :: tmp4
  REAL*8 :: tmp5
  REAL*8 :: tmp6
  INTEGER :: branch
  INTEGER :: ad_from
  INTEGER :: ad_from0
  INTEGER :: ad_from1
  INTEGER :: ad_from2
  INTEGER :: ad_from3
  INTEGER :: ad_to
  DOUBLE PRECISION :: temp3
  DOUBLE PRECISION :: temp8b56
  REAL*8 :: temp29
  REAL*8 :: temp25b2
  REAL*8 :: temp131b11
  REAL*8 :: temp131b48
  REAL*8 :: temp135b26
  REAL*8 :: temp153b
  REAL*8 :: temp155b0
  REAL*8 :: temp172b1
  REAL*8 :: temp197b55
  REAL*8 :: temp234b
  REAL*8 :: temp253b1
  REAL*8 :: temp253b52
  REAL*8 :: temp296
  REAL*8 :: temp317b0
  REAL*8 :: temp332b18
  REAL*8 :: temp335b24
  REAL*8 :: temp340b37
  REAL*8 :: temp340
  REAL*8 :: temp377
  REAL*8 :: temp421
  REAL*8 :: temp432b2
  REAL*8 :: temp448b74
  REAL*8 :: temp458
  REAL*8 :: temp486b3
  REAL*8 :: temp502
  REAL*8 :: temp2
  REAL*8 :: temp8b55
  REAL*8 :: temp28
  REAL*8 :: temp25b1
  REAL*8 :: temp42b2
  REAL*8 :: temp131b10
  REAL*8 :: temp131b47
  REAL*8 :: temp135b25
  REAL*8 :: temp172b0
  REAL*8 :: temp197b54
  REAL*8 :: temp198b
  REAL*8 :: temp242b
  REAL*8 :: temp253b0
  REAL*8 :: temp253b51
  REAL*8 :: temp279b
  REAL*8 :: temp295
  REAL*8 :: temp323b
  REAL*8 :: temp332b17
  REAL*8 :: temp335b23
  REAL*8 :: temp340b36
  REAL*8 :: temp344b9
  REAL*8 :: temp376
  DOUBLE PRECISION :: temp404b
  REAL*8 :: temp415b0
  REAL*8 :: temp420
  REAL*8 :: temp432b1
  REAL*8 :: temp448b73
  REAL*8 :: temp457
  DOUBLE PRECISION :: temp469b1
  REAL*8 :: temp486b2
  REAL*8 :: temp501
  REAL*8 :: temp1
  REAL*8 :: temp8b54
  REAL*8 :: temp27
  REAL*8 :: temp25b0
  REAL*8 :: temp42b1
  REAL*8 :: temp131b46
  REAL*8 :: temp135b24
  REAL*8 :: temp197b53
  REAL*8 :: temp250b
  REAL*8 :: temp253b50
  REAL*8 :: temp287b
  REAL*8 :: temp294
  REAL*8 :: temp331b
  REAL*8 :: temp332b16
  REAL*8 :: temp335b22
  REAL*8 :: temp340b35
  REAL*8 :: temp344b8
  DOUBLE PRECISION :: temp375
  REAL*8 :: temp412b
  REAL*8 :: temp432b0
  REAL*8 :: temp448b72
  REAL*8 :: temp449b
  REAL*8 :: temp456
  DOUBLE PRECISION :: temp469b0
  REAL*8 :: temp486b1
  REAL*8 :: temp500
  REAL*8 :: tmp4b
  REAL*8 :: temp0
  REAL*8 :: temp8b53
  DOUBLE PRECISION :: temp26
  DOUBLE PRECISION :: temp42b0
  DOUBLE PRECISION :: temp116b0
  REAL*8 :: temp131b45
  REAL*8 :: temp133b1
  REAL*8 :: temp135b23
  REAL*8 :: temp197b52
  REAL*8 :: temp293
  REAL*8 :: temp332b15
  REAL*8 :: temp335b21
  REAL*8 :: temp340b34
  REAL*8 :: temp344b7
  DOUBLE PRECISION :: temp374
  REAL*8 :: temp420b
  REAL*8 :: temp448b71
  REAL*8 :: temp455
  REAL*8 :: temp457b
  REAL*8 :: temp486b0
  REAL*8 :: temp501b
  REAL*8 :: temp7b
  REAL*8 :: temp8b52
  REAL*8 :: temp21b
  DOUBLE PRECISION :: temp25
  REAL*8 :: temp58b
  REAL*8 :: temp131b44
  REAL*8 :: temp133b0
  REAL*8 :: temp135b22
  REAL*8 :: temp191b39
  REAL*8 :: temp197b51
  REAL*8 :: temp224b9
  REAL*8 :: temp225b13
  REAL*8 :: temp292
  REAL*8 :: temp332b14
  REAL*8 :: temp335b20
  REAL*8 :: temp340b33
  REAL*8 :: temp344b6
  DOUBLE PRECISION :: temp373
  REAL*8 :: temp384b
  REAL*8 :: temp448b70
  DOUBLE PRECISION :: temp454
  REAL*8 :: temp465b
  REAL*8 :: temp464b3
  REAL*8 :: temp8b51
  REAL*8 :: temp24
  REAL*8 :: temp50b29
  REAL*8 :: temp66b
  REAL*8 :: temp74b3
  REAL*8 :: temp118b11
  REAL*8 :: temp131b43
  REAL*8 :: temp135b21
  REAL*8 :: temp191b38
  REAL*8 :: temp197b9
  REAL*8 :: temp197b50
  REAL*8 :: temp224b8
  REAL*8 :: temp225b12
  REAL*8 :: temp291
  REAL*8 :: temp312b0
  REAL*8 :: temp332b13
  REAL*8 :: temp335b56
  REAL*8 :: temp340b32
  REAL*8 :: temp344b5
  REAL*8 :: temp344b10
  DOUBLE PRECISION :: temp372
  REAL*8 :: temp392b
  REAL*8 :: temp453
  REAL*8 :: temp464b2
  INTRINSIC DEXP
  REAL*8 :: temp8b50
  REAL*8 :: temp23
  REAL*8 :: temp50b28
  REAL*8 :: temp74b
  REAL*8 :: temp74b2
  DOUBLE PRECISION :: temp119
  REAL*8 :: temp118b10
  REAL*8 :: temp131b42
  REAL*8 :: temp135b20
  REAL*8 :: temp148b
  REAL*8 :: temp191b37
  REAL*8 :: temp197b8
  REAL*8 :: temp224b7
  REAL*8 :: temp225b11
  REAL*8 :: temp229b
  REAL*8 :: temp290
  REAL*8 :: temp332b12
  REAL*8 :: temp335b55
  REAL*8 :: temp340b31
  REAL*8 :: temp344b4
  REAL*8 :: temp371
  REAL*8 :: temp447b0
  REAL*8 :: temp452
  REAL*8 :: temp464b1
  REAL*8 :: temp481b
  DOUBLE PRECISION :: temp489
  REAL*8 :: temp20b0
  DOUBLE PRECISION :: temp22
  REAL*8 :: temp50b27
  REAL*8 :: temp57b0
  DOUBLE PRECISION :: temp59
  REAL*8 :: temp74b1
  REAL*8 :: temp82b
  DOUBLE PRECISION :: temp83b12
  DOUBLE PRECISION :: temp118
  REAL*8 :: temp131b41
  REAL*8 :: temp131b78
  REAL*8 :: temp148b1
  DOUBLE PRECISION :: temp156b
  REAL*8 :: temp191b36
  REAL*8 :: temp197b7
  REAL*8 :: temp200b
  REAL*8 :: temp224b6
  REAL*8 :: temp225b10
  REAL*8 :: temp226b19
  REAL*8 :: temp237b
  REAL*8 :: temp318b
  REAL*8 :: temp332b11
  REAL*8 :: temp335b54
  REAL*8 :: temp340b30
  REAL*8 :: temp344b3
  REAL*8 :: temp370
  REAL*8 :: temp383b0
  REAL*8 :: temp451
  REAL*8 :: temp464b0
  REAL*8 :: temp481b1
  DOUBLE PRECISION :: temp488
  REAL*8 :: temp21
  REAL*8 :: temp50b26
  DOUBLE PRECISION :: temp58
  REAL*8 :: temp74b0
  DOUBLE PRECISION :: temp83b11
  REAL*8 :: temp117
  REAL*8 :: temp131b40
  REAL*8 :: temp131b77
  REAL*8 :: temp148b0
  REAL*8 :: temp164b
  REAL*8 :: temp191b35
  REAL*8 :: temp197b6
  REAL*8 :: temp224b5
  REAL*8 :: temp226b18
  REAL*8 :: temp263b2
  REAL*8 :: temp326b
  REAL*8 :: temp332b10
  REAL*8 :: temp335b53
  REAL*8 :: temp344b2
  REAL*8 :: temp450
  REAL*8 :: temp479b3
  REAL*8 :: temp481b0
  REAL*8 :: temp487
  REAL*8 :: temp20
  REAL*8 :: temp50b25
  REAL*8 :: temp57
  DOUBLE PRECISION :: temp83b10
  DOUBLE PRECISION :: temp116
  REAL*8 :: temp124b29
  REAL*8 :: temp131b76
  REAL*8 :: temp172b
  REAL*8 :: temp191b34
  REAL*8 :: temp197b5
  REAL*8 :: temp207b3
  REAL*8 :: temp224b4
  REAL*8 :: temp226b17
  REAL*8 :: temp246b0
  REAL*8 :: temp253b
  REAL*8 :: temp263b1
  REAL*8 :: temp335b52
  REAL*8 :: temp344b1
  REAL*8 :: temp415b
  REAL*8 :: temp420b6
  REAL*8 :: temp479b2
  REAL*8 :: temp486
  REAL*8 :: temp16b
  REAL*8 :: temp49b26
  REAL*8 :: temp50b24
  REAL*8 :: temp56
  REAL*8 :: temp115
  REAL*8 :: temp124b28
  REAL*8 :: temp131b75
  REAL*8 :: temp180b
  REAL*8 :: temp191b33
  REAL*8 :: temp197b4
  REAL*8 :: temp207b2
  REAL*8 :: temp224b3
  REAL*8 :: temp226b16
  REAL*8 :: temp261b
  REAL*8 :: temp263b0
  REAL*8 :: temp298b
  REAL*8 :: temp335b51
  REAL*8 :: temp342b
  REAL*8 :: temp344b0
  REAL*8 :: temp420b5
  REAL*8 :: temp479b1
  REAL*8 :: temp485
  REAL*8 :: temp506b0
  REAL*8 :: temp523b1
  REAL*8 :: temp24b
  REAL*8 :: temp49b25
  REAL*8 :: temp50b23
  DOUBLE PRECISION :: temp55
  REAL*8 :: temp114
  REAL*8 :: temp124b27
  REAL*8 :: temp131b74
  REAL*8 :: temp191b32
  REAL*8 :: temp197b3
  REAL*8 :: temp207b1
  REAL*8 :: temp224b2
  REAL*8 :: temp226b15
  REAL*8 :: temp280b0
  REAL*8 :: temp335b50
  REAL*8 :: temp387b
  REAL*8 :: temp420b4
  REAL*8 :: temp431b
  DOUBLE PRECISION :: temp442b0
  REAL*8 :: temp468b
  REAL*8 :: temp479b0
  REAL*8 :: temp484
  REAL*8 :: temp512b
  REAL*8 :: temp523b0
  REAL*8 :: tempb9
  REAL*8 :: temp32b
  REAL*8 :: temp49b24
  REAL*8 :: temp50b22
  REAL*8 :: temp54
  REAL*8 :: temp50b59
  REAL*8 :: temp69b
  REAL*8 :: temp106b
  DOUBLE PRECISION :: temp113
  REAL*8 :: temp124b26
  REAL*8 :: temp131b73
  REAL*8 :: temp143b1
  REAL*8 :: temp191b31
  REAL*8 :: temp197b2
  REAL*8 :: temp207b0
  REAL*8 :: temp224b1
  REAL*8 :: temp226b14
  REAL*8 :: temp340b62
  REAL*8 :: temp395b
  REAL*8 :: temp420b3
  REAL*8 :: temp476b
  REAL*8 :: temp483
  REAL*8 :: temp496b0
  REAL*8 :: temp520b
  REAL*8 :: tempb8
  REAL*8 :: temp49b23
  REAL*8 :: temp50b21
  REAL*8 :: temp53
  REAL*8 :: temp50b58
  REAL*8 :: temp77b
  DOUBLE PRECISION :: temp112
  REAL*8 :: temp114b
  REAL*8 :: temp124b25
  REAL*8 :: temp131b72
  REAL*8 :: temp143b0
  REAL*8 :: temp149
  REAL*8 :: temp191b30
  REAL*8 :: temp197b1
  REAL*8 :: temp224b0
  REAL*8 :: temp226b13
  REAL*8 :: temp340b61
  REAL*8 :: temp420b2
  REAL*8 :: temp431b24
  REAL*8 :: temp482
  REAL*8 :: temp484b
  REAL*8 :: tempb7
  REAL*8 :: temp49b22
  REAL*8 :: temp50b20
  DOUBLE PRECISION :: temp52
  REAL*8 :: temp50b57
  REAL*8 :: temp89
  DOUBLE PRECISION :: temp111
  REAL*8 :: temp124b24
  REAL*8 :: temp131b71
  REAL*8 :: temp148
  REAL*8 :: temp197b0
  REAL*8 :: temp203b
  REAL*8 :: temp226b12
  REAL*8 :: temp229
  REAL*8 :: temp322b0
  REAL*8 :: temp332b9
  REAL*8 :: temp340b60
  REAL*8 :: temp420b1
  REAL*8 :: temp431b23
  REAL*8 :: temp481
  REAL*8 :: temp492b
  REAL*8 :: tempb6
  REAL*8 :: temp49b21
  DOUBLE PRECISION :: temp51
  REAL*8 :: temp50b56
  DOUBLE PRECISION :: temp88
  REAL*8 :: temp93b
  DOUBLE PRECISION :: temp110
  REAL*8 :: temp124b23
  REAL*8 :: temp130b
  REAL*8 :: temp131b70
  REAL*8 :: temp147
  REAL*8 :: temp226b11
  REAL*8 :: temp228
  REAL*8 :: temp248b
  REAL*8 :: temp290b5
  DOUBLE PRECISION :: temp309
  REAL*8 :: temp329b
  REAL*8 :: temp332b8
  REAL*8 :: temp420b0
  REAL*8 :: temp431b22
  REAL*8 :: temp457b0
  REAL*8 :: temp480
  REAL*8 :: temp501b0
  REAL*8 :: tempb5
  REAL*8 :: temp49b20
  REAL*8 :: temp50b55
  DOUBLE PRECISION :: temp50
  DOUBLE PRECISION :: temp87
  REAL*8 :: temp124b22
  REAL*8 :: temp146
  REAL*8 :: temp226b10
  REAL*8 :: temp227
  REAL*8 :: temp256b
  REAL*8 :: temp290b4
  REAL*8 :: temp300b
  REAL*8 :: temp308
  REAL*8 :: temp332b7
  REAL*8 :: temp337b
  REAL*8 :: temp431b21
  REAL*8 :: tempb4
  REAL*8 :: temp19b
  REAL*8 :: temp50b54
  DOUBLE PRECISION :: temp86
  REAL*8 :: temp124b21
  REAL*8 :: temp131b9
  REAL*8 :: temp145
  REAL*8 :: temp183b
  REAL*8 :: temp226
  REAL*8 :: temp253b19
  REAL*8 :: temp264b
  REAL*8 :: temp277b13
  REAL*8 :: temp290b3
  REAL*8 :: temp300b1
  REAL*8 :: temp307
  REAL*8 :: temp332b6
  REAL*8 :: temp345b
  REAL*8 :: temp371b3
  REAL*8 :: temp426b
  REAL*8 :: temp431b20
  REAL*8 :: temp507b
  REAL*8 :: tempb3
  REAL*8 :: temp50b53
  DOUBLE PRECISION :: temp85
  REAL*8 :: temp124b20
  REAL*8 :: temp131b8
  REAL*8 :: temp144
  REAL*8 :: temp191b
  REAL*8 :: temp206b29
  REAL*8 :: temp225
  REAL*8 :: temp253b18
  REAL*8 :: temp256b0
  REAL*8 :: temp277b12
  REAL*8 :: temp290b2
  REAL*8 :: temp300b0
  DOUBLE PRECISION :: temp306
  REAL*8 :: temp332b5
  REAL*8 :: temp353b
  REAL*8 :: temp371b2
  REAL*8 :: temp467b6
  REAL*8 :: tempb2
  REAL*8 :: temp45b1
  REAL*8 :: temp50b52
  DOUBLE PRECISION :: temp84
  REAL*8 :: temp109b
  REAL*8 :: temp131b7
  REAL*8 :: temp143
  REAL*8 :: temp206b28
  DOUBLE PRECISION :: temp224
  REAL*8 :: temp253b17
  REAL*8 :: temp277b11
  REAL*8 :: temp280b
  REAL*8 :: temp290b1
  DOUBLE PRECISION :: temp305
  REAL*8 :: temp332b4
  REAL*8 :: temp371b1
  DOUBLE PRECISION :: temp398b
  REAL*8 :: temp442b
  REAL*8 :: temp448b39
  REAL*8 :: temp467b5
  REAL*8 :: temp479b
  REAL*8 :: temp523b
  REAL*8 :: tempb1
  REAL*8 :: temp43b
  REAL*8 :: temp45b0
  REAL*8 :: temp50b51
  DOUBLE PRECISION :: temp83
  REAL*8 :: temp117b
  REAL*8 :: temp131b6
  REAL*8 :: temp136b1
  REAL*8 :: temp142
  REAL*8 :: temp179
  REAL*8 :: temp197b19
  REAL*8 :: temp206b27
  REAL*8 :: temp223
  REAL*8 :: temp253b16
  REAL*8 :: temp277b10
  REAL*8 :: temp290b0
  DOUBLE PRECISION :: temp304
  REAL*8 :: temp332b3
  REAL*8 :: temp371b0
  REAL*8 :: temp448b38
  REAL*8 :: temp467b4
  REAL*8 :: temp487b
  REAL*8 :: temp499b9
  REAL*8 :: tempb0
  REAL*8 :: temp0b
  REAL*8 :: temp8b19
  REAL*8 :: temp50b50
  DOUBLE PRECISION :: temp82
  REAL*8 :: temp99b0
  REAL*8 :: temp125b
  REAL*8 :: temp131b5
  REAL*8 :: temp136b0
  REAL*8 :: temp141
  REAL*8 :: temp178
  REAL*8 :: temp197b18
  REAL*8 :: temp206b
  REAL*8 :: temp206b26
  REAL*8 :: temp222
  REAL*8 :: temp253b15
  REAL*8 :: temp259
  DOUBLE PRECISION :: temp303
  REAL*8 :: temp332b2
  REAL*8 :: temp448b37
  REAL*8 :: temp467b3
  REAL*8 :: temp495b
  REAL*8 :: temp499b8
  REAL*8 :: temp8b18
  REAL*8 :: temp81
  REAL*8 :: temp96b
  REAL*8 :: temp131b4
  REAL*8 :: temp133b
  REAL*8 :: temp140
  REAL*8 :: temp153b0
  REAL*8 :: temp177
  REAL*8 :: temp197b17
  REAL*8 :: temp206b25
  REAL*8 :: temp221
  REAL*8 :: temp234b0
  REAL*8 :: temp253b14
  REAL*8 :: temp258
  REAL*8 :: temp302
  REAL*8 :: temp332b1
  REAL*8 :: temp339
  REAL*8 :: temp448b36
  REAL*8 :: temp467b2
  REAL*8 :: temp499b7
  REAL*8 :: temp8b17
  DOUBLE PRECISION :: temp80
  REAL*8 :: temp131b3
  REAL*8 :: temp141b
  REAL*8 :: temp170b0
  REAL*8 :: temp176
  REAL*8 :: temp178b
  REAL*8 :: temp197b16
  REAL*8 :: temp206b24
  REAL*8 :: temp220
  REAL*8 :: temp222b
  REAL*8 :: temp253b13
  REAL*8 :: temp257
  REAL*8 :: temp259b
  REAL*8 :: temp301
  REAL*8 :: temp303b
  REAL*8 :: temp332b0
  REAL*8 :: temp338
  REAL*8 :: temp386b1
  REAL*8 :: temp419
  REAL*8 :: temp448b35
  REAL*8 :: temp467b1
  REAL*8 :: temp499b6
  REAL*8 :: temp8b16
  REAL*8 :: temp23b0
  REAL*8 :: temp131b2
  REAL*8 :: temp155b39
  REAL*8 :: temp175
  REAL*8 :: temp197b15
  REAL*8 :: temp206b23
  REAL*8 :: temp230b
  REAL*8 :: temp253b12
  REAL*8 :: temp253b49
  REAL*8 :: temp256
  REAL*8 :: temp300
  REAL*8 :: temp311b
  REAL*8 :: temp337
  REAL*8 :: temp386b0
  REAL*8 :: temp418
  REAL*8 :: temp429b
  REAL*8 :: temp445b4
  REAL*8 :: temp448b34
  REAL*8 :: temp467b0
  REAL*8 :: tmpb
  REAL*8 :: temp499b5
  REAL*8 :: tempb11
  REAL*8 :: temp8b15
  REAL*8 :: temp50b9
  REAL*8 :: temp114b0
  REAL*8 :: temp124b9
  REAL*8 :: temp131b1
  REAL*8 :: temp155b38
  REAL*8 :: temp168b1
  REAL*8 :: temp174
  REAL*8 :: temp197b14
  REAL*8 :: temp206b22
  REAL*8 :: temp253b11
  REAL*8 :: temp253b48
  REAL*8 :: temp255
  REAL*8 :: temp336
  DOUBLE PRECISION :: temp356b
  REAL*8 :: temp400b
  REAL*8 :: temp417
  REAL*8 :: temp440b8
  REAL*8 :: temp445b3
  REAL*8 :: temp448b33
  REAL*8 :: temp484b0
  REAL*8 :: temp499b4
  REAL*8 :: temp499b37
  REAL*8 :: temp518b
  REAL*8 :: tempb10
  REAL*8 :: temp8b14
  REAL*8 :: temp50b8
  REAL*8 :: temp124b8
  REAL*8 :: temp131b0
  REAL*8 :: temp155b37
  REAL*8 :: temp168b0
  REAL*8 :: temp173
  REAL*8 :: temp197b13
  REAL*8 :: temp206b21
  REAL*8 :: temp253b10
  REAL*8 :: temp253b47
  REAL*8 :: temp254
  REAL*8 :: temp283b
  REAL*8 :: temp335b19
  INTEGER :: temp335
  REAL*8 :: temp416
  REAL*8 :: temp440b7
  REAL*8 :: temp445b
  REAL*8 :: temp445b2
  REAL*8 :: temp448b32
  REAL*8 :: temp448b69
  REAL*8 :: tmp0b
  REAL*8 :: temp499b3
  REAL*8 :: temp499b36
  REAL*8 :: temp522b11
  REAL*8 :: temp526b
  REAL*8 :: temp8b13
  REAL*8 :: temp50b7
  REAL*8 :: temp124b7
  REAL*8 :: temp155b36
  REAL*8 :: temp172
  REAL*8 :: temp185b0
  REAL*8 :: temp197b12
  REAL*8 :: temp197b49
  REAL*8 :: temp206b20
  REAL*8 :: temp253b46
  INTEGER :: temp253
  REAL*8 :: temp334
  REAL*8 :: temp335b18
  REAL*8 :: temp372b
  REAL*8 :: temp415
  REAL*8 :: temp440b6
  REAL*8 :: temp445b1
  REAL*8 :: temp448b31
  REAL*8 :: temp448b68
  REAL*8 :: temp453b
  REAL*8 :: temp499b2
  REAL*8 :: temp499b35
  REAL*8 :: temp509b0
  REAL*8 :: temp522b10
  REAL*8 :: temp3b
  REAL*8 :: temp8b12
  REAL*8 :: temp8b49
  REAL*8 :: temp50b6
  REAL*8 :: temp124b6
  REAL*8 :: temp135b19
  REAL*8 :: temp155b35
  REAL*8 :: temp171
  REAL*8 :: temp197b11
  REAL*8 :: temp197b48
  REAL*8 :: temp252
  REAL*8 :: temp253b45
  REAL*8 :: temp289
  REAL*8 :: temp283b0
  REAL*8 :: temp333
  REAL*8 :: temp335b17
  REAL*8 :: temp380b
  REAL*8 :: temp414
  REAL*8 :: temp440b5
  REAL*8 :: temp445b0
  REAL*8 :: temp448b30
  REAL*8 :: temp448b67
  REAL*8 :: temp461b
  REAL*8 :: temp498b
  REAL*8 :: temp499b1
  REAL*8 :: temp499b34
  REAL*8 :: temp526b0
  REAL*8 :: temp8b11
  REAL*8 :: temp8b48
  REAL*8 :: temp16b3
  REAL*8 :: temp50b5
  REAL*8 :: temp99b
  REAL*8 :: temp124b5
  REAL*8 :: temp129b0
  REAL*8 :: temp135b18
  REAL*8 :: temp136b
  REAL*8 :: temp155b34
  REAL*8 :: temp170
  REAL*8 :: temp180b3
  REAL*8 :: temp197b10
  REAL*8 :: temp197b47
  REAL*8 :: temp251
  REAL*8 :: temp253b44
  REAL*8 :: temp288
  REAL*8 :: temp332
  REAL*8 :: temp335b16
  REAL*8 :: temp340b29
  REAL*8 :: temp369
  REAL*8 :: temp413
  REAL*8 :: temp440b4
  REAL*8 :: temp448b66
  DOUBLE PRECISION :: temp462b0
  REAL*8 :: temp499b0
  REAL*8 :: temp499b33
  REAL*8 :: temp7b0
  REAL*8 :: temp8b10
  REAL*8 :: temp8b47
  REAL*8 :: temp16b2
  REAL*8 :: temp50b4
  REAL*8 :: temp70b
  REAL*8 :: temp124b4
  REAL*8 :: temp131b39
  REAL*8 :: temp135b17
  REAL*8 :: temp144b
  REAL*8 :: temp155b33
  REAL*8 :: temp180b2
  REAL*8 :: temp197b46
  REAL*8 :: temp225b
  REAL*8 :: temp227b0
  REAL*8 :: temp250
  REAL*8 :: temp253b43
  REAL*8 :: temp287
  REAL*8 :: temp331
  REAL*8 :: temp335b15
  REAL*8 :: temp340b28
  DOUBLE PRECISION :: temp368
  REAL*8 :: temp412
  REAL*8 :: temp440b3
  REAL*8 :: temp448b65
  REAL*8 :: temp449
  REAL*8 :: temp499b32
  REAL*8 :: temp8b46
  REAL*8 :: temp16b1
  REAL*8 :: temp19
  REAL*8 :: temp50b3
  REAL*8 :: temp124b3
  REAL*8 :: temp131b38
  REAL*8 :: temp135b16
  REAL*8 :: temp155b32
  REAL*8 :: temp180b1
  REAL*8 :: temp189b
  REAL*8 :: temp197b45
  REAL*8 :: temp233b
  REAL*8 :: temp244b0
  REAL*8 :: temp253b42
  REAL*8 :: temp286
  REAL*8 :: temp314b
  REAL*8 :: temp325b0
  REAL*8 :: temp330
  REAL*8 :: temp335b9
  REAL*8 :: temp335b14
  REAL*8 :: temp340b27
  DOUBLE PRECISION :: temp367
  REAL*8 :: temp411
  REAL*8 :: temp440b2
  REAL*8 :: temp448b64
  REAL*8 :: temp448
  REAL*8 :: temp499b31
  REAL*8 :: temp8b45
  REAL*8 :: temp16b0
  REAL*8 :: temp18
  REAL*8 :: temp50b2
  REAL*8 :: temp107b1
  REAL*8 :: temp124b2
  REAL*8 :: temp131b37
  REAL*8 :: temp135b15
  REAL*8 :: temp155b31
  REAL*8 :: temp180b0
  REAL*8 :: temp190b9
  REAL*8 :: temp197b
  REAL*8 :: temp197b44
  REAL*8 :: temp253b41
  REAL*8 :: temp261b0
  REAL*8 :: temp278b
  REAL*8 :: temp285
  REAL*8 :: temp298b0
  REAL*8 :: temp322b
  REAL*8 :: temp335b8
  REAL*8 :: temp335b13
  REAL*8 :: temp340b26
  REAL*8 :: temp342b0
  REAL*8 :: temp366
  REAL*8 :: temp410
  REAL*8 :: temp440b1
  REAL*8 :: temp447
  REAL*8 :: temp448b63
  REAL*8 :: temp455b5
  REAL*8 :: temp499b30
  REAL*8 :: temp8b44
  REAL*8 :: temp17
  REAL*8 :: temp50b1
  REAL*8 :: temp107b0
  REAL*8 :: temp124b1
  REAL*8 :: temp131b36
  REAL*8 :: temp135b14
  REAL*8 :: temp155b30
  REAL*8 :: temp190b8
  REAL*8 :: temp197b43
  REAL*8 :: temp253b40
  DOUBLE PRECISION :: temp284
  REAL*8 :: temp286b
  REAL*8 :: temp303b2
  REAL*8 :: temp330b
  REAL*8 :: temp335b7
  REAL*8 :: temp335b12
  REAL*8 :: temp335b49
  REAL*8 :: temp340b25
  REAL*8 :: temp365
  REAL*8 :: temp411b
  REAL*8 :: temp440b0
  REAL*8 :: temp446
  REAL*8 :: temp448b
  REAL*8 :: temp448b62
  REAL*8 :: temp455b4
  REAL*8 :: tmp3b
  REAL*8 :: temp521b0
  REAL*8 :: temp8b43
  REAL*8 :: temp16
  REAL*8 :: temp49b
  REAL*8 :: temp50b0
  REAL*8 :: temp124b0
  REAL*8 :: temp131b35
  REAL*8 :: temp135b13
  REAL*8 :: temp190b7
  REAL*8 :: temp197b42
  REAL*8 :: temp205b0
  DOUBLE PRECISION :: temp283
  REAL*8 :: temp294b
  REAL*8 :: temp303b1
  REAL*8 :: temp335b6
  REAL*8 :: temp335b11
  REAL*8 :: temp335b48
  REAL*8 :: temp340b24
  DOUBLE PRECISION :: temp364
  REAL*8 :: temp445
  REAL*8 :: temp448b61
  REAL*8 :: temp455b3
  REAL*8 :: temp456b
  REAL*8 :: temp500b
  REAL*8 :: temp526
  REAL*8 :: temp2b0
  REAL*8 :: temp8b42
  REAL*8 :: temp15
  REAL*8 :: temp20b
  REAL*8 :: temp57b
  REAL*8 :: temp131b34
  REAL*8 :: temp135b12
  REAL*8 :: temp141b0
  REAL*8 :: temp190b6
  REAL*8 :: temp191b29
  REAL*8 :: temp197b41
  REAL*8 :: temp222b0
  DOUBLE PRECISION :: temp282
  REAL*8 :: temp303b0
  REAL*8 :: temp313b9
  REAL*8 :: temp335b5
  REAL*8 :: temp335b10
  REAL*8 :: temp335b47
  REAL*8 :: temp340b23
  DOUBLE PRECISION :: temp363
  REAL*8 :: temp383b
  DOUBLE PRECISION :: temp444
  REAL*8 :: temp448b60
  REAL*8 :: temp455b2
  REAL*8 :: temp464b
  REAL*8 :: temp525
  REAL*8 :: temp8b41
  DOUBLE PRECISION :: temp14
  REAL*8 :: temp50b19
  REAL*8 :: temp102b
  REAL*8 :: temp131b33
  REAL*8 :: temp135b11
  REAL*8 :: temp139b
  REAL*8 :: temp190b5
  REAL*8 :: temp191b28
  REAL*8 :: temp197b40
  DOUBLE PRECISION :: temp281
  REAL*8 :: temp313b8
  REAL*8 :: temp335b4
  REAL*8 :: temp335b46
  REAL*8 :: temp340b22
  REAL*8 :: temp340b59
  REAL*8 :: temp362
  REAL*8 :: temp399
  REAL*8 :: temp391b
  REAL*8 :: temp443
  REAL*8 :: temp448b9
  REAL*8 :: temp455b1
  REAL*8 :: temp524
  REAL*8 :: temp8b40
  REAL*8 :: temp13
  REAL*8 :: temp48b0
  REAL*8 :: temp50b18
  REAL*8 :: temp73b
  REAL*8 :: temp109
  REAL*8 :: temp110b
  REAL*8 :: temp117b5
  REAL*8 :: temp131b32
  REAL*8 :: temp131b69
  REAL*8 :: temp135b10
  REAL*8 :: temp190b4
  REAL*8 :: temp191b27
  REAL*8 :: temp228b
  REAL*8 :: temp280
  REAL*8 :: temp313b7
  REAL*8 :: temp318b2
  REAL*8 :: temp335b3
  REAL*8 :: temp335b45
  REAL*8 :: temp340b21
  REAL*8 :: temp340b58
  REAL*8 :: temp361
  DOUBLE PRECISION :: temp398
  DOUBLE PRECISION :: temp442
  REAL*8 :: temp448b8
  REAL*8 :: temp455b0
  REAL*8 :: temp479
  REAL*8 :: temp480b
  REAL*8 :: temp523
  REAL*8 :: temp12
  REAL*8 :: temp49b19
  REAL*8 :: temp49
  REAL*8 :: temp50b17
  REAL*8 :: temp82b1
  REAL*8 :: temp81b
  DOUBLE PRECISION :: temp108
  REAL*8 :: temp117b4
  REAL*8 :: temp131b31
  REAL*8 :: temp131b68
  REAL*8 :: temp139b0
  REAL*8 :: temp155b
  DOUBLE PRECISION :: temp156b1
  REAL*8 :: temp190b3
  REAL*8 :: temp191b26
  REAL*8 :: temp313b6
  REAL*8 :: temp317b
  REAL*8 :: temp318b1
  REAL*8 :: temp335b2
  REAL*8 :: temp335b44
  REAL*8 :: temp340b20
  REAL*8 :: temp340b57
  DOUBLE PRECISION :: temp360
  DOUBLE PRECISION :: temp397
  REAL*8 :: temp441
  REAL*8 :: temp448b7
  REAL*8 :: temp478
  REAL*8 :: temp522
  DOUBLE PRECISION :: temp11
  REAL*8 :: temp48
  REAL*8 :: temp49b18
  REAL*8 :: temp50b16
  REAL*8 :: temp82b0
  REAL*8 :: temp107
  REAL*8 :: temp117b3
  REAL*8 :: temp131b30
  REAL*8 :: temp131b67
  DOUBLE PRECISION :: temp156b0
  REAL*8 :: temp163b
  REAL*8 :: temp190b2
  REAL*8 :: temp191b25
  REAL*8 :: temp244b
  REAL*8 :: temp243b18
  REAL*8 :: temp313b5
  REAL*8 :: temp318b0
  REAL*8 :: temp325b
  REAL*8 :: temp328b9
  REAL*8 :: temp335b1
  REAL*8 :: temp335b43
  REAL*8 :: temp340b56
  REAL*8 :: temp396
  REAL*8 :: temp431b19
  REAL*8 :: temp440
  REAL*8 :: temp448b6
  REAL*8 :: temp448b93
  REAL*8 :: temp477
  REAL*8 :: temp487b3
  REAL*8 :: temp521
  DOUBLE PRECISION :: temp10
  REAL*8 :: temp47
  REAL*8 :: temp49b17
  REAL*8 :: temp50b15
  DOUBLE PRECISION :: temp106
  REAL*8 :: temp117b2
  REAL*8 :: temp124b19
  REAL*8 :: temp131b66
  REAL*8 :: temp134b3
  REAL*8 :: temp171b
  REAL*8 :: temp190b1
  REAL*8 :: temp191b24
  REAL*8 :: temp243b17
  REAL*8 :: temp313b4
  REAL*8 :: temp328b8
  REAL*8 :: temp333b
  REAL*8 :: temp335b0
  REAL*8 :: temp335b42
  REAL*8 :: temp340b55
  REAL*8 :: temp395
  REAL*8 :: temp416b0
  REAL*8 :: temp414b
  REAL*8 :: temp431b18
  REAL*8 :: temp448b5
  REAL*8 :: temp448b92
  REAL*8 :: temp476
  REAL*8 :: temp487b2
  REAL*8 :: tmp6b
  REAL*8 :: temp520
  REAL*8 :: temp15b
  REAL*8 :: temp46
  REAL*8 :: temp49b16
  REAL*8 :: temp50b14
  DOUBLE PRECISION :: temp105
  REAL*8 :: temp117b1
  REAL*8 :: temp124b18
  REAL*8 :: temp131b65
  REAL*8 :: temp134b2
  REAL*8 :: temp190b0
  REAL*8 :: temp191b23
  REAL*8 :: temp243b16
  REAL*8 :: temp260b
  REAL*8 :: temp297b
  REAL*8 :: temp313b3
  REAL*8 :: temp328b7
  REAL*8 :: temp335b41
  REAL*8 :: temp340b54
  REAL*8 :: temp341b
  REAL*8 :: temp394
  DOUBLE PRECISION :: temp389b0
  REAL*8 :: temp422b
  REAL*8 :: temp431b17
  REAL*8 :: temp448b4
  REAL*8 :: temp448b91
  REAL*8 :: temp459b
  REAL*8 :: temp475
  REAL*8 :: temp487b1
  REAL*8 :: temp503b
  REAL*8 :: temp23b
  REAL*8 :: temp43b0
  INTEGER :: temp45
  REAL*8 :: temp49b15
  REAL*8 :: temp50b13
  REAL*8 :: temp104
  REAL*8 :: temp117b0
  REAL*8 :: temp124b17
  REAL*8 :: temp131b64
  REAL*8 :: temp134b1
  REAL*8 :: temp151b2
  REAL*8 :: temp191b22
  REAL*8 :: temp243b15
  REAL*8 :: temp313b2
  REAL*8 :: temp328b6
  REAL*8 :: temp330b3
  REAL*8 :: temp335b40
  REAL*8 :: temp340b53
  REAL*8 :: temp345b7
  REAL*8 :: temp384b4
  REAL*8 :: temp386b
  REAL*8 :: temp393
  REAL*8 :: temp431b16
  REAL*8 :: temp448b3
  REAL*8 :: temp448b90
  REAL*8 :: temp467b
  REAL*8 :: temp474
  REAL*8 :: temp487b0
  REAL*8 :: temp31b
  REAL*8 :: temp44
  REAL*8 :: temp49b14
  REAL*8 :: temp50b12
  REAL*8 :: temp50b49
  REAL*8 :: temp68b
  REAL*8 :: temp92b5
  REAL*8 :: temp103
  REAL*8 :: temp124b16
  REAL*8 :: temp131b63
  REAL*8 :: temp134b0
  REAL*8 :: temp151b1
  REAL*8 :: temp191b21
  REAL*8 :: temp225b9
  REAL*8 :: temp243b14
  REAL*8 :: temp313b1
  REAL*8 :: temp328b5
  REAL*8 :: temp330b2
  REAL*8 :: temp340b52
  REAL*8 :: temp345b6
  REAL*8 :: temp384b3
  DOUBLE PRECISION :: temp392
  REAL*8 :: temp431b15
  REAL*8 :: temp448b2
  REAL*8 :: temp473
  REAL*8 :: temp475b
  REAL*8 :: temp43
  REAL*8 :: temp49b13
  REAL*8 :: temp50b11
  REAL*8 :: temp50b48
  REAL*8 :: temp76b
  REAL*8 :: temp92b4
  REAL*8 :: temp102
  REAL*8 :: temp124b15
  REAL*8 :: temp131b62
  REAL*8 :: temp139
  REAL*8 :: temp151b0
  REAL*8 :: temp188b0
  REAL*8 :: temp191b20
  REAL*8 :: temp225b8
  REAL*8 :: temp243b13
  REAL*8 :: temp313b0
  REAL*8 :: temp328b4
  REAL*8 :: temp330b1
  REAL*8 :: temp340b51
  REAL*8 :: temp345b5
  REAL*8 :: temp384b2
  REAL*8 :: temp391
  REAL*8 :: temp411b1
  REAL*8 :: temp431b14
  REAL*8 :: temp448b1
  DOUBLE PRECISION :: temp472
  REAL*8 :: temp483b
  DOUBLE PRECISION :: temp42
  REAL*8 :: temp49b12
  REAL*8 :: temp50b10
  REAL*8 :: temp50b47
  REAL*8 :: temp58b1
  REAL*8 :: temp79
  REAL*8 :: temp92b3
  DOUBLE PRECISION :: temp101
  REAL*8 :: temp124b14
  REAL*8 :: temp131b61
  REAL*8 :: temp138
  REAL*8 :: temp219
  REAL*8 :: temp225b7
  REAL*8 :: temp239b
  REAL*8 :: temp243b12
  REAL*8 :: temp328b3
  REAL*8 :: temp330b0
  REAL*8 :: temp340b9
  REAL*8 :: temp340b50
  REAL*8 :: temp345b4
  REAL*8 :: temp384b1
  DOUBLE PRECISION :: temp390
  REAL*8 :: temp411b0
  REAL*8 :: temp431b13
  REAL*8 :: temp448b0
  DOUBLE PRECISION :: temp471
  REAL*8 :: temp497b6
  REAL*8 :: temp41
  REAL*8 :: temp49b11
  REAL*8 :: temp50b46
  REAL*8 :: temp58b0
  REAL*8 :: temp75b1
  DOUBLE PRECISION :: temp78
  REAL*8 :: temp92b
  REAL*8 :: temp92b2
  REAL*8 :: temp100
  REAL*8 :: temp124b13
  REAL*8 :: temp131b60
  DOUBLE PRECISION :: temp137
  REAL*8 :: temp166b
  REAL*8 :: temp183b3
  DOUBLE PRECISION :: temp218
  REAL*8 :: temp225b6
  REAL*8 :: temp243b11
  REAL*8 :: temp264b3
  REAL*8 :: temp328b
  REAL*8 :: temp328b2
  REAL*8 :: temp340b8
  REAL*8 :: temp345b3
  REAL*8 :: temp384b0
  REAL*8 :: temp409b
  REAL*8 :: temp421b8
  REAL*8 :: temp431b12
  DOUBLE PRECISION :: temp470
  REAL*8 :: temp497b5
  REAL*8 :: temp40
  REAL*8 :: temp49b10
  REAL*8 :: temp50b45
  REAL*8 :: temp75b0
  REAL*8 :: temp77
  REAL*8 :: temp92b1
  REAL*8 :: temp124b12
  REAL*8 :: temp136
  REAL*8 :: temp149b0
  REAL*8 :: temp174b
  REAL*8 :: temp183b2
  DOUBLE PRECISION :: temp217
  REAL*8 :: temp225b5
  REAL*8 :: temp243b10
  REAL*8 :: temp255b
  REAL*8 :: temp264b2
  REAL*8 :: temp328b1
  REAL*8 :: temp340b7
  REAL*8 :: temp345b2
  REAL*8 :: temp417b
  REAL*8 :: temp421b7
  REAL*8 :: temp431b11
  REAL*8 :: temp497b4
  REAL*8 :: temp31b7
  REAL*8 :: temp50b44
  REAL*8 :: temp76
  REAL*8 :: temp92b0
  REAL*8 :: temp124b11
  DOUBLE PRECISION :: temp135
  REAL*8 :: temp182b
  REAL*8 :: temp183b1
  REAL*8 :: temp216
  REAL*8 :: temp225b4
  REAL*8 :: temp242b5
  REAL*8 :: temp263b
  REAL*8 :: temp264b1
  REAL*8 :: temp328b0
  REAL*8 :: temp340b6
  REAL*8 :: temp344b
  REAL*8 :: temp345b1
  REAL*8 :: temp421b6
  REAL*8 :: temp431b10
  REAL*8 :: temp497b3
  REAL*8 :: temp506b
  REAL*8 :: temp19b0
  REAL*8 :: temp31b6
  REAL*8 :: temp50b43
  REAL*8 :: temp75
  REAL*8 :: temp124b10
  REAL*8 :: temp134
  REAL*8 :: temp183b0
  REAL*8 :: temp190b
  REAL*8 :: temp206b19
  REAL*8 :: temp215
  REAL*8 :: temp225b3
  REAL*8 :: temp242b4
  REAL*8 :: temp264b0
  REAL*8 :: temp340b5
  REAL*8 :: temp345b0
  REAL*8 :: temp389b
  REAL*8 :: temp421b5
  REAL*8 :: temp443b1
  REAL*8 :: temp497b2
  REAL*8 :: temp507b0
  REAL*8 :: temp31b5
  REAL*8 :: temp34b
  REAL*8 :: temp50b42
  REAL*8 :: temp74
  REAL*8 :: temp133
  REAL*8 :: temp206b18
  DOUBLE PRECISION :: temp214
  REAL*8 :: temp220b7
  REAL*8 :: temp225b2
  REAL*8 :: temp242b3
  REAL*8 :: temp281b0
  REAL*8 :: temp340b4
  DOUBLE PRECISION :: temp397b
  REAL*8 :: temp421b4
  REAL*8 :: temp441b
  REAL*8 :: temp443b0
  REAL*8 :: temp448b29
  REAL*8 :: temp460b1
  REAL*8 :: temp475b5
  REAL*8 :: temp478b
  REAL*8 :: temp497b1
  REAL*8 :: temp522b
  REAL*8 :: temp31b4
  REAL*8 :: temp42b
  REAL*8 :: temp50b41
  REAL*8 :: temp73
  REAL*8 :: temp79b
  REAL*8 :: temp116b
  REAL*8 :: temp132
  REAL*8 :: temp169
  REAL*8 :: temp191b50
  REAL*8 :: temp206b17
  DOUBLE PRECISION :: temp213
  REAL*8 :: temp220b6
  REAL*8 :: temp225b1
  REAL*8 :: temp242b2
  REAL*8 :: temp323b2
  REAL*8 :: temp340b3
  REAL*8 :: temp421b3
  REAL*8 :: temp432b16
  REAL*8 :: temp448b28
  REAL*8 :: temp460b0
  REAL*8 :: temp475b4
  REAL*8 :: temp486b
  REAL*8 :: temp497b0
  REAL*8 :: temp31b3
  REAL*8 :: temp50b
  REAL*8 :: temp50b40
  REAL*8 :: temp70b0
  REAL*8 :: temp72
  REAL*8 :: temp124b
  REAL*8 :: temp131
  REAL*8 :: temp168
  REAL*8 :: temp205b
  REAL*8 :: temp206b16
  REAL*8 :: temp212
  REAL*8 :: temp220b5
  REAL*8 :: temp225b0
  REAL*8 :: temp242b1
  REAL*8 :: temp249
  REAL*8 :: temp323b1
  REAL*8 :: temp340b2
  REAL*8 :: temp404b1
  REAL*8 :: temp421b2
  REAL*8 :: temp432b15
  REAL*8 :: temp448b27
  REAL*8 :: temp475b3
  REAL*8 :: tempb
  REAL*8 :: temp31b2
  REAL*8 :: temp71
  REAL*8 :: temp95b
  REAL*8 :: temp130
  REAL*8 :: temp132b
  REAL*8 :: temp167
  REAL*8 :: temp169b
  REAL*8 :: temp198b0
  REAL*8 :: temp206b15
  REAL*8 :: temp211
  REAL*8 :: temp220b4
  REAL*8 :: temp242b0
  REAL*8 :: temp248
  REAL*8 :: temp279b0
  REAL*8 :: temp323b0
  REAL*8 :: temp329
  REAL*8 :: temp340b1
  REAL*8 :: temp404b0
  REAL*8 :: temp421b1
  REAL*8 :: temp432b14
  REAL*8 :: temp448b26
  REAL*8 :: temp475b2
  REAL*8 :: temp31b1
  REAL*8 :: temp70
  REAL*8 :: temp137b6
  REAL*8 :: temp140b
  REAL*8 :: temp166
  REAL*8 :: temp177b
  REAL*8 :: temp206b14
  DOUBLE PRECISION :: temp210
  REAL*8 :: temp220b3
  REAL*8 :: temp221b
  DOUBLE PRECISION :: temp247
  REAL*8 :: temp257b3
  REAL*8 :: temp302b
  REAL*8 :: temp328
  REAL*8 :: temp339b
  REAL*8 :: temp340b0
  REAL*8 :: temp409
  REAL*8 :: temp421b0
  REAL*8 :: temp431b9
  REAL*8 :: temp432b13
  REAL*8 :: temp448b25
  REAL*8 :: temp475b1
  REAL*8 :: temp499b29
  REAL*8 :: temp31b0
  REAL*8 :: temp68b0
  REAL*8 :: temp137b5
  REAL*8 :: temp155b29
  REAL*8 :: temp165
  REAL*8 :: temp185b
  REAL*8 :: temp206b13
  REAL*8 :: temp220b2
  DOUBLE PRECISION :: temp246
  REAL*8 :: temp253b39
  REAL*8 :: temp257b2
  REAL*8 :: temp301b2
  REAL*8 :: temp327
  REAL*8 :: temp372b4
  DOUBLE PRECISION :: temp408
  REAL*8 :: temp428b
  REAL*8 :: temp431b8
  REAL*8 :: temp432b12
  REAL*8 :: temp448b24
  REAL*8 :: temp475b0
  REAL*8 :: temp485b9
  REAL*8 :: temp499b28
  REAL*8 :: temp509b
  REAL*8 :: temp137b4
  REAL*8 :: temp155b28
  REAL*8 :: temp164
  REAL*8 :: temp206b12
  REAL*8 :: temp220b1
  DOUBLE PRECISION :: temp245
  REAL*8 :: temp253b38
  REAL*8 :: temp257b1
  REAL*8 :: temp301b1
  REAL*8 :: temp326
  REAL*8 :: temp355b
  REAL*8 :: temp372b3
  REAL*8 :: temp407
  REAL*8 :: temp431b7
  REAL*8 :: temp432b11
  REAL*8 :: temp448b23
  REAL*8 :: temp485b8
  REAL*8 :: temp492b0
  REAL*8 :: temp499b27
  REAL*8 :: temp0b0
  REAL*8 :: temp37b
  REAL*8 :: temp137b3
  REAL*8 :: temp155b27
  REAL*8 :: temp163
  REAL*8 :: temp176b0
  REAL*8 :: temp206b11
  REAL*8 :: temp220b0
  DOUBLE PRECISION :: temp244
  REAL*8 :: temp253b37
  REAL*8 :: temp257b0
  REAL*8 :: temp301b0
  REAL*8 :: temp325
  REAL*8 :: temp338b0
  REAL*8 :: temp355b1
  REAL*8 :: temp372b2
  REAL*8 :: temp406
  REAL*8 :: temp431b6
  REAL*8 :: temp432b10
  DOUBLE PRECISION :: temp444b
  REAL*8 :: temp448b22
  REAL*8 :: temp448b59
  REAL*8 :: temp485b7
  REAL*8 :: temp499b26
  REAL*8 :: temp525b
  REAL*8 :: temp45b
  REAL*8 :: temp137b2
  REAL*8 :: temp155b26
  REAL*8 :: temp162
  REAL*8 :: temp197b39
  REAL*8 :: temp199
  REAL*8 :: temp206b10
  DOUBLE PRECISION :: temp224b29
  REAL*8 :: temp243
  REAL*8 :: temp253b36
  REAL*8 :: temp290b
  REAL*8 :: temp311b8
  REAL*8 :: temp324
  REAL*8 :: temp355b0
  REAL*8 :: temp371b
  REAL*8 :: temp372b1
  REAL*8 :: temp405
  REAL*8 :: temp431b5
  REAL*8 :: temp448b21
  REAL*8 :: temp448b58
  REAL*8 :: temp452b
  REAL*8 :: temp453b1
  REAL*8 :: temp485b6
  REAL*8 :: temp499b25
  REAL*8 :: temp2b
  REAL*8 :: temp8b39
  REAL*8 :: temp127b
  REAL*8 :: temp137b1
  REAL*8 :: temp155b25
  REAL*8 :: temp161
  REAL*8 :: temp197b38
  REAL*8 :: temp198
  REAL*8 :: temp224b28
  REAL*8 :: temp242
  REAL*8 :: temp253b35
  REAL*8 :: temp279
  REAL*8 :: temp311b7
  REAL*8 :: temp323
  REAL*8 :: temp372b0
  DOUBLE PRECISION :: temp404
  REAL*8 :: temp431b4
  REAL*8 :: temp448b20
  REAL*8 :: temp448b57
  REAL*8 :: temp453b0
  REAL*8 :: temp460b
  REAL*8 :: temp468b4
  REAL*8 :: temp485b5
  REAL*8 :: temp497b
  REAL*8 :: temp499b24
  REAL*8 :: temp8b9
  REAL*8 :: temp8b38
  REAL*8 :: temp24b3
  REAL*8 :: temp135b
  REAL*8 :: temp137b0
  REAL*8 :: temp154b1
  REAL*8 :: temp155b24
  REAL*8 :: temp160
  REAL*8 :: temp197b37
  DOUBLE PRECISION :: temp197
  REAL*8 :: temp224b27
  REAL*8 :: temp241
  REAL*8 :: temp253b34
  REAL*8 :: temp278
  REAL*8 :: temp311b6
  REAL*8 :: temp322
  REAL*8 :: temp340b19
  DOUBLE PRECISION :: temp359
  DOUBLE PRECISION :: temp403
  REAL*8 :: temp431b3
  REAL*8 :: temp448b56
  REAL*8 :: temp468b3
  REAL*8 :: temp485b4
  REAL*8 :: temp499b23
  REAL*8 :: temp8b8
  REAL*8 :: temp8b37
  REAL*8 :: temp24b2
  REAL*8 :: temp95b4
  REAL*8 :: temp131b29
  REAL*8 :: temp143b
  REAL*8 :: temp154b0
  REAL*8 :: temp155b23
  DOUBLE PRECISION :: temp196
  REAL*8 :: temp197b36
  REAL*8 :: temp224b
  REAL*8 :: temp224b26
  REAL*8 :: temp235b0
  REAL*8 :: temp240
  REAL*8 :: temp253b33
  REAL*8 :: temp277
  REAL*8 :: temp311b5
  DOUBLE PRECISION :: temp321
  REAL*8 :: temp340b18
  DOUBLE PRECISION :: temp358
  DOUBLE PRECISION :: temp402
  REAL*8 :: temp431b2
  DOUBLE PRECISION :: temp439
  REAL*8 :: temp448b55
  REAL*8 :: temp468b2
  REAL*8 :: temp485b3
  REAL*8 :: temp499b22
  REAL*8 :: temp8b7
  REAL*8 :: temp8b36
  REAL*8 :: temp24b1
  REAL*8 :: temp95b3
  REAL*8 :: temp131b28
  REAL*8 :: temp132b3
  REAL*8 :: temp151b
  REAL*8 :: temp155b22
  REAL*8 :: temp171b0
  REAL*8 :: temp188b
  DOUBLE PRECISION :: temp195
  REAL*8 :: temp197b35
  REAL*8 :: temp224b25
  REAL*8 :: temp253b32
  REAL*8 :: temp276
  REAL*8 :: temp311b4
  REAL*8 :: temp313b
  REAL*8 :: temp320
  REAL*8 :: temp333b0
  REAL*8 :: temp340b17
  DOUBLE PRECISION :: temp357
  REAL*8 :: temp401
  REAL*8 :: temp431b1
  DOUBLE PRECISION :: temp438
  REAL*8 :: temp448b54
  REAL*8 :: temp463b6
  REAL*8 :: temp468b1
  REAL*8 :: temp485b2
  REAL*8 :: temp499b21
  REAL*8 :: temp512b1
  REAL*8 :: temp519
  REAL*8 :: temp8b6
  REAL*8 :: temp8b35
  REAL*8 :: temp24b0
  REAL*8 :: temp73b6
  REAL*8 :: temp95b2
  REAL*8 :: temp115b1
  REAL*8 :: temp131b27
  REAL*8 :: temp132b2
  REAL*8 :: temp155b21
  DOUBLE PRECISION :: temp194
  REAL*8 :: temp197b34
  REAL*8 :: temp224b24
  REAL*8 :: temp240b
  REAL*8 :: temp253b31
  DOUBLE PRECISION :: temp275
  REAL*8 :: temp277b
  REAL*8 :: temp311b3
  REAL*8 :: temp321b
  REAL*8 :: temp340b16
  DOUBLE PRECISION :: temp356
  REAL*8 :: temp387b0
  DOUBLE PRECISION :: temp400
  REAL*8 :: temp431b0
  REAL*8 :: temp437
  REAL*8 :: temp448b53
  REAL*8 :: temp463b5
  REAL*8 :: temp468b0
  REAL*8 :: temp485b1
  REAL*8 :: temp499b20
  REAL*8 :: temp512b0
  REAL*8 :: temp518
  REAL*8 :: temp522b9
  REAL*8 :: temp8b5
  REAL*8 :: temp8b34
  REAL*8 :: temp73b5
  REAL*8 :: temp95b1
  REAL*8 :: temp115b0
  REAL*8 :: temp131b26
  REAL*8 :: temp132b1
  REAL*8 :: temp155b20
  REAL*8 :: temp181b7
  DOUBLE PRECISION :: temp193
  REAL*8 :: temp197b33
  REAL*8 :: temp206b9
  REAL*8 :: temp224b23
  REAL*8 :: temp253b30
  DOUBLE PRECISION :: temp274
  REAL*8 :: temp285b
  REAL*8 :: temp311b2
  REAL*8 :: temp335b39
  REAL*8 :: temp340b15
  REAL*8 :: temp355
  REAL*8 :: temp436
  REAL*8 :: temp447b
  REAL*8 :: temp446b3
  REAL*8 :: temp448b52
  REAL*8 :: temp448b89
  REAL*8 :: temp463b4
  REAL*8 :: temp485b0
  REAL*8 :: tmp2b
  DOUBLE PRECISION :: temp517
  REAL*8 :: temp522b8
  REAL*8 :: temp3b9
  REAL*8 :: temp8b4
  REAL*8 :: temp8b33
  REAL*8 :: temp48b
  REAL*8 :: temp56b3
  REAL*8 :: temp73b4
  REAL*8 :: temp95b0
  REAL*8 :: temp131b25
  REAL*8 :: temp132b0
  REAL*8 :: temp169b0
  REAL*8 :: temp181b6
  DOUBLE PRECISION :: temp192
  REAL*8 :: temp197b32
  REAL*8 :: temp206b8
  REAL*8 :: temp224b22
  REAL*8 :: temp273
  REAL*8 :: temp311b1
  REAL*8 :: temp335b38
  REAL*8 :: temp340b14
  REAL*8 :: temp343b6
  REAL*8 :: temp354
  DOUBLE PRECISION :: temp435
  REAL*8 :: temp446b2
  REAL*8 :: temp448b51
  REAL*8 :: temp448b88
  REAL*8 :: temp455b
  REAL*8 :: temp463b3
  REAL*8 :: temp516
  REAL*8 :: temp522b7
  REAL*8 :: temp3b8
  REAL*8 :: temp5b
  REAL*8 :: temp8b3
  REAL*8 :: temp8b32
  REAL*8 :: temp56b
  REAL*8 :: temp56b2
  REAL*8 :: temp73b3
  REAL*8 :: temp131b24
  REAL*8 :: temp164b4
  REAL*8 :: temp181b5
  REAL*8 :: temp190b10
  REAL*8 :: temp191b19
  DOUBLE PRECISION :: temp191
  REAL*8 :: temp197b31
  REAL*8 :: temp206b7
  REAL*8 :: temp224b21
  REAL*8 :: temp228b3
  REAL*8 :: temp272
  REAL*8 :: temp277b9
  REAL*8 :: temp311b0
  REAL*8 :: temp335b37
  REAL*8 :: temp340b13
  REAL*8 :: temp343b5
  REAL*8 :: temp353
  REAL*8 :: temp382b
  REAL*8 :: temp382b2
  DOUBLE PRECISION :: temp434
  REAL*8 :: temp446b1
  REAL*8 :: temp448b50
  REAL*8 :: temp448b87
  REAL*8 :: temp463b
  REAL*8 :: temp463b2
  REAL*8 :: temp515
  REAL*8 :: temp522b6
  REAL*8 :: temp3b7
  REAL*8 :: temp8b2
  REAL*8 :: temp8b31
  REAL*8 :: temp34b5
  REAL*8 :: temp49b9
  REAL*8 :: temp56b1
  REAL*8 :: temp73b2
  REAL*8 :: temp101b
  REAL*8 :: temp131b23
  REAL*8 :: temp164b3
  REAL*8 :: temp181b4
  REAL*8 :: temp190
  REAL*8 :: temp191b18
  REAL*8 :: temp197b30
  REAL*8 :: temp206b6
  REAL*8 :: temp224b20
  REAL*8 :: temp228b2
  DOUBLE PRECISION :: temp271
  REAL*8 :: temp277b8
  REAL*8 :: temp335b36
  REAL*8 :: temp340b12
  REAL*8 :: temp340b49
  REAL*8 :: temp343b4
  DOUBLE PRECISION :: temp352
  REAL*8 :: temp382b1
  DOUBLE PRECISION :: temp389
  DOUBLE PRECISION :: temp390b
  DOUBLE PRECISION :: temp433
  REAL*8 :: temp446b0
  REAL*8 :: temp448b86
  REAL*8 :: temp463b1
  DOUBLE PRECISION :: temp514
  REAL*8 :: temp522b5
  REAL*8 :: temp3b6
  REAL*8 :: temp8b1
  REAL*8 :: temp8b30
  REAL*8 :: temp34b4
  REAL*8 :: temp49b8
  REAL*8 :: temp56b0
  REAL*8 :: temp72b
  REAL*8 :: temp73b1
  REAL*8 :: temp131b22
  REAL*8 :: temp131b59
  REAL*8 :: temp146b
  REAL*8 :: temp164b2
  REAL*8 :: temp181b3
  REAL*8 :: temp191b17
  REAL*8 :: temp206b5
  REAL*8 :: temp227b
  REAL*8 :: temp228b1
  DOUBLE PRECISION :: temp270
  REAL*8 :: temp277b7
  REAL*8 :: temp335b35
  REAL*8 :: temp340b11
  REAL*8 :: temp340b48
  REAL*8 :: temp343b3
  DOUBLE PRECISION :: temp351
  REAL*8 :: temp382b0
  DOUBLE PRECISION :: temp388
  DOUBLE PRECISION :: temp432
  REAL*8 :: temp448b85
  REAL*8 :: temp463b0
  DOUBLE PRECISION :: temp469
  DOUBLE PRECISION :: temp513
  REAL*8 :: temp522b4
  REAL*8 :: temp3b5
  REAL*8 :: temp8b0
  REAL*8 :: temp34b3
  DOUBLE PRECISION :: temp39
  REAL*8 :: temp49b7
  REAL*8 :: temp66b8
  REAL*8 :: temp73b0
  REAL*8 :: temp80b
  REAL*8 :: temp83b9
  REAL*8 :: temp110b0
  REAL*8 :: temp131b21
  REAL*8 :: temp131b58
  REAL*8 :: temp154b
  REAL*8 :: temp164b1
  REAL*8 :: temp181b2
  REAL*8 :: temp191b16
  REAL*8 :: temp206b4
  REAL*8 :: temp228b0
  REAL*8 :: temp235b
  REAL*8 :: temp277b6
  REAL*8 :: temp316b
  REAL*8 :: temp335b34
  REAL*8 :: temp340b10
  REAL*8 :: temp340b47
  REAL*8 :: temp343b2
  REAL*8 :: temp350
  REAL*8 :: temp387
  REAL*8 :: temp431
  REAL*8 :: temp448b84
  REAL*8 :: temp468
  REAL*8 :: temp480b0
  DOUBLE PRECISION :: temp512
  REAL*8 :: temp522b3
  REAL*8 :: temp3b4
  REAL*8 :: temp34b2
  REAL*8 :: temp38
  REAL*8 :: temp49b6
  REAL*8 :: temp66b7
  REAL*8 :: temp83b8
  REAL*8 :: temp131b20
  REAL*8 :: temp131b57
  REAL*8 :: temp162b
  REAL*8 :: temp164b0
  REAL*8 :: temp181b1
  REAL*8 :: temp191b15
  REAL*8 :: temp199b
  REAL*8 :: temp206b3
  REAL*8 :: temp243b
  REAL*8 :: temp277b5
  REAL*8 :: temp324b
  REAL*8 :: temp326b0
  REAL*8 :: temp335b33
  REAL*8 :: temp340b46
  REAL*8 :: temp343b1
  REAL*8 :: temp386
  REAL*8 :: temp405b
  REAL*8 :: temp430
  REAL*8 :: temp448b83
  REAL*8 :: temp467
  REAL*8 :: temp511
  REAL*8 :: temp522b2
  REAL*8 :: temp3b3
  REAL*8 :: temp17b0
  REAL*8 :: temp34b1
  REAL*8 :: temp37
  REAL*8 :: temp49b5
  REAL*8 :: temp66b6
  REAL*8 :: temp83b7
  REAL*8 :: temp131b56
  REAL*8 :: temp170b
  REAL*8 :: temp181b0
  REAL*8 :: temp191b9
  REAL*8 :: temp191b14
  REAL*8 :: temp201b7
  REAL*8 :: temp206b2
  REAL*8 :: temp251b
  REAL*8 :: temp277b4
  REAL*8 :: temp288b
  REAL*8 :: temp299b0
  REAL*8 :: temp319b7
  REAL*8 :: temp332b
  REAL*8 :: temp335b32
  REAL*8 :: temp340b45
  REAL*8 :: temp343b0
  REAL*8 :: temp353b9
  REAL*8 :: temp385
  REAL*8 :: temp413b
  REAL*8 :: temp424b0
  REAL*8 :: temp441b1
  REAL*8 :: temp448b82
  DOUBLE PRECISION :: temp466
  REAL*8 :: tmp5b
  REAL*8 :: temp505b0
  REAL*8 :: temp510
  REAL*8 :: temp522b1
  REAL*8 :: temp3b2
  REAL*8 :: temp34b0
  REAL*8 :: temp36
  REAL*8 :: temp49b4
  REAL*8 :: temp66b5
  REAL*8 :: temp83b6
  REAL*8 :: temp118b9
  REAL*8 :: temp125b1
  REAL*8 :: temp131b55
  REAL*8 :: temp191b8
  REAL*8 :: temp191b13
  REAL*8 :: temp201b6
  REAL*8 :: temp206b1
  REAL*8 :: temp277b3
  REAL*8 :: temp296b
  REAL*8 :: temp319b6
  REAL*8 :: temp335b31
  REAL*8 :: temp340b
  REAL*8 :: temp340b44
  REAL*8 :: temp353b8
  REAL*8 :: temp384
  REAL*8 :: temp421b
  REAL*8 :: temp441b0
  REAL*8 :: temp448b81
  DOUBLE PRECISION :: temp465
  REAL*8 :: temp522b0
  REAL*8 :: temp3b1
  REAL*8 :: temp8b
  REAL*8 :: temp22b
  DOUBLE PRECISION :: temp35
  REAL*8 :: temp49b3
  REAL*8 :: temp66b4
  REAL*8 :: temp83b5
  REAL*8 :: temp118b8
  REAL*8 :: temp125b0
  REAL*8 :: temp131b54
  REAL*8 :: temp135b9
  REAL*8 :: temp191b7
  REAL*8 :: temp191b12
  REAL*8 :: temp191b49
  REAL*8 :: temp201b5
  REAL*8 :: temp206b0
  REAL*8 :: temp277b2
  REAL*8 :: temp319b5
  REAL*8 :: temp335b30
  REAL*8 :: temp340b43
  REAL*8 :: temp353b7
  REAL*8 :: temp383
  REAL*8 :: temp385b
  REAL*8 :: temp448b80
  REAL*8 :: temp464
  REAL*8 :: temp510b
  REAL*8 :: temp3b0
  DOUBLE PRECISION :: temp34
  REAL*8 :: temp49b2
  REAL*8 :: temp50b39
  REAL*8 :: temp66b3
  REAL*8 :: temp67b
  REAL*8 :: temp83b4
  REAL*8 :: temp104b
  REAL*8 :: temp118b7
  REAL*8 :: temp131b53
  REAL*8 :: temp135b8
  REAL*8 :: temp191b6
  REAL*8 :: temp191b11
  REAL*8 :: temp191b48
  REAL*8 :: temp201b4
  REAL*8 :: temp277b1
  REAL*8 :: temp319b4
  REAL*8 :: temp340b42
  REAL*8 :: temp353b6
  REAL*8 :: temp370b7
  REAL*8 :: temp382
  REAL*8 :: temp463
  REAL*8 :: temp33
  REAL*8 :: temp49b1
  REAL*8 :: temp50b38
  REAL*8 :: temp66b2
  REAL*8 :: temp75b
  REAL*8 :: temp83b3
  REAL*8 :: temp118b6
  REAL*8 :: temp129
  REAL*8 :: temp131b52
  REAL*8 :: temp135b7
  REAL*8 :: temp135b30
  REAL*8 :: temp149b
  REAL*8 :: temp191b5
  REAL*8 :: temp191b10
  REAL*8 :: temp191b47
  REAL*8 :: temp201b3
  REAL*8 :: temp277b0
  REAL*8 :: temp319b3
  REAL*8 :: temp340b41
  REAL*8 :: temp353b5
  REAL*8 :: temp353b10
  REAL*8 :: temp370b6
  REAL*8 :: temp381
  DOUBLE PRECISION :: temp462
  REAL*8 :: temp499
  REAL*8 :: temp32
  REAL*8 :: temp44b5
  REAL*8 :: temp49b0
  REAL*8 :: temp50b37
  REAL*8 :: temp66b1
  REAL*8 :: temp69
  REAL*8 :: temp83b
  REAL*8 :: temp83b2
  REAL*8 :: temp118b5
  DOUBLE PRECISION :: temp128
  REAL*8 :: temp131b51
  REAL*8 :: temp135b6
  REAL*8 :: temp191b4
  REAL*8 :: temp191b46
  REAL*8 :: temp201b
  REAL*8 :: temp201b2
  DOUBLE PRECISION :: temp209
  REAL*8 :: temp238b
  REAL*8 :: temp319b
  REAL*8 :: temp319b2
  REAL*8 :: temp340b40
  REAL*8 :: temp353b4
  REAL*8 :: temp370b5
  REAL*8 :: temp380
  REAL*8 :: temp456b0
  REAL*8 :: temp461
  REAL*8 :: temp490b
  REAL*8 :: temp498
  REAL*8 :: temp500b0
  REAL*8 :: temp31
  REAL*8 :: temp44b4
  REAL*8 :: temp50b36
  REAL*8 :: temp66b0
  REAL*8 :: temp68
  REAL*8 :: temp83b1
  REAL*8 :: temp118b4
  DOUBLE PRECISION :: temp127
  REAL*8 :: temp131b50
  REAL*8 :: temp135b5
  REAL*8 :: temp191b3
  REAL*8 :: temp191b45
  REAL*8 :: temp201b1
  DOUBLE PRECISION :: temp208
  REAL*8 :: temp246b
  REAL*8 :: temp319b1
  REAL*8 :: temp353b3
  REAL*8 :: temp370b4
  DOUBLE PRECISION :: temp392b0
  REAL*8 :: temp460
  REAL(8) :: temp497
  REAL*8 :: temp3b17
  REAL*8 :: temp22b7
  REAL*8 :: temp30
  REAL*8 :: temp44b3
  REAL*8 :: temp50b35
  REAL*8 :: temp67
  REAL*8 :: temp83b0
  REAL*8 :: temp118b3
  REAL*8 :: temp126
  REAL*8 :: temp135b4
  REAL*8 :: temp174b1
  REAL*8 :: temp189b5
  REAL*8 :: temp191b2
  REAL*8 :: temp191b44
  REAL*8 :: temp201b0
  DOUBLE PRECISION :: temp207
  REAL*8 :: temp319b0
  REAL*8 :: temp335b
  REAL*8 :: temp353b2
  REAL*8 :: temp370b3
  REAL*8 :: temp416b
  REAL*8 :: temp496
  REAL*8 :: temp3b16
  REAL*8 :: temp17b
  DOUBLE PRECISION :: temp22b6
  REAL*8 :: temp44b2
  REAL*8 :: temp50b34
  REAL*8 :: temp66
  REAL*8 :: temp118b2
  REAL*8 :: temp125
  REAL*8 :: temp135b3
  REAL*8 :: temp174b0
  REAL*8 :: temp181b
  REAL*8 :: temp189b4
  REAL*8 :: temp191b1
  REAL*8 :: temp191b43
  REAL*8 :: temp206
  REAL*8 :: temp299b
  REAL*8 :: temp343b
  REAL*8 :: temp353b1
  REAL*8 :: temp370b2
  REAL*8 :: temp424b
  REAL*8 :: temp495
  REAL*8 :: temp505b
  REAL*8 :: temp3b15
  REAL*8 :: temp22b5
  REAL*8 :: temp25b
  REAL*8 :: temp44b1
  REAL*8 :: temp50b33
  DOUBLE PRECISION :: temp65
  REAL*8 :: temp118b1
  REAL*8 :: temp124
  REAL*8 :: temp135b2
  REAL*8 :: temp189b3
  REAL*8 :: temp191b0
  REAL*8 :: temp191b42
  REAL*8 :: temp205
  REAL*8 :: temp314b3
  REAL*8 :: temp353b0
  REAL*8 :: temp370b1
  REAL*8 :: temp432b
  DOUBLE PRECISION :: temp469b
  REAL*8 :: temp494
  REAL*8 :: temp3b14
  REAL*8 :: temp22b4
  REAL*8 :: temp44b0
  REAL*8 :: temp50b32
  DOUBLE PRECISION :: temp64
  REAL*8 :: temp107b
  REAL*8 :: temp118b0
  DOUBLE PRECISION :: temp123
  REAL*8 :: temp135b1
  REAL*8 :: temp189b2
  REAL*8 :: temp191b41
  DOUBLE PRECISION :: temp204
  REAL*8 :: temp226b24
  REAL*8 :: temp314b2
  REAL*8 :: temp370b0
  REAL*8 :: temp440b
  REAL*8 :: temp448b19
  REAL*8 :: temp477b
  INTEGER :: temp493
  REAL*8 :: temp521b
  REAL*8 :: temp3b13
  REAL*8 :: temp22b3
  REAL*8 :: temp41b
  REAL*8 :: temp50b31
  REAL*8 :: temp63
  REAL*8 :: temp78b
  REAL*8 :: temp115b
  DOUBLE PRECISION :: temp122
  REAL*8 :: temp135b0
  DOUBLE PRECISION :: temp159
  REAL*8 :: temp189b1
  REAL*8 :: temp191b40
  DOUBLE PRECISION :: temp203
  REAL*8 :: temp226b9
  REAL*8 :: temp226b23
  REAL*8 :: temp233b1
  REAL*8 :: temp314b1
  REAL*8 :: temp385b3
  REAL*8 :: temp448b18
  REAL*8 :: temp485b
  REAL*8 :: temp492
  REAL*8 :: temp3b12
  REAL*8 :: temp22b2
  REAL*8 :: temp50b30
  REAL*8 :: temp62
  REAL*8 :: temp99
  DOUBLE PRECISION :: temp121
  DOUBLE PRECISION :: temp158
  REAL*8 :: temp189b0
  DOUBLE PRECISION :: temp202
  REAL*8 :: temp226b8
  REAL*8 :: temp226b22
  REAL*8 :: temp233b0
  REAL*8 :: temp239
  REAL*8 :: temp243b9
  REAL*8 :: temp314b0
  REAL*8 :: temp385b2
  REAL*8 :: temp448b17
  DOUBLE PRECISION :: temp491
  REAL*8 :: temp493b
  REAL*8 :: temp3b11
  REAL*8 :: temp22b1
  DOUBLE PRECISION :: temp61
  REAL*8 :: temp94b
  REAL*8 :: temp98
  DOUBLE PRECISION :: temp120
  REAL*8 :: temp131b
  DOUBLE PRECISION :: temp157
  REAL*8 :: temp168b
  DOUBLE PRECISION :: temp201
  REAL*8 :: temp226b7
  REAL*8 :: temp226b21
  REAL*8 :: temp238
  REAL*8 :: temp243b8
  REAL*8 :: temp249b
  REAL*8 :: temp319
  REAL*8 :: temp331b0
  REAL*8 :: temp385b1
  REAL*8 :: temp448b16
  DOUBLE PRECISION :: temp490
  REAL*8 :: temp510b1
  REAL*8 :: temp3b10
  REAL*8 :: temp22b0
  DOUBLE PRECISION :: temp60
  REAL*8 :: temp97
  REAL*8 :: temp124b32
  DOUBLE PRECISION :: temp156
  REAL*8 :: temp176b
  REAL*8 :: temp184b3
  REAL*8 :: temp200
  REAL*8 :: temp220b
  REAL*8 :: temp226b6
  REAL*8 :: temp226b20
  REAL*8 :: temp237
  REAL*8 :: temp243b7
  REAL*8 :: temp257b
  REAL*8 :: temp301b
  REAL*8 :: temp318
  REAL*8 :: temp338b
  REAL*8 :: temp380b5
  REAL*8 :: temp385b0
  REAL*8 :: temp419b
  REAL*8 :: temp448b15
  REAL*8 :: temp499b19
  REAL*8 :: temp510b0
  REAL*8 :: temp96
  REAL*8 :: temp124b31
  REAL*8 :: temp155b19
  REAL*8 :: temp155
  REAL*8 :: temp184b
  REAL*8 :: temp184b2
  REAL*8 :: temp226b5
  DOUBLE PRECISION :: temp236
  REAL*8 :: temp243b6
  REAL*8 :: temp253b29
  REAL*8 :: temp317
  REAL*8 :: temp380b4
  REAL*8 :: temp427b
  REAL*8 :: temp448b14
  REAL*8 :: temp483b0
  REAL*8 :: temp499b18
  REAL*8 :: temp95
  REAL*8 :: temp124b30
  REAL*8 :: temp154
  REAL*8 :: temp155b18
  REAL*8 :: temp162b5
  REAL*8 :: temp184b1
  REAL*8 :: temp226b4
  DOUBLE PRECISION :: temp235
  REAL*8 :: temp243b5
  REAL*8 :: temp253b28
  REAL*8 :: temp316
  REAL*8 :: temp354b
  REAL*8 :: temp380b3
  REAL*8 :: temp448b13
  REAL*8 :: temp499b17
  REAL*8 :: temp15b5
  REAL*8 :: temp94
  REAL*8 :: temp153
  REAL*8 :: temp155b17
  REAL*8 :: temp162b4
  REAL*8 :: temp184b0
  REAL*8 :: temp221b8
  REAL*8 :: temp226b3
  REAL*8 :: temp234
  REAL*8 :: temp243b4
  REAL*8 :: temp253b27
  REAL*8 :: temp281b
  REAL*8 :: temp315
  REAL*8 :: temp380b2
  REAL*8 :: temp399b
  REAL*8 :: temp443b
  REAL*8 :: temp448b12
  REAL*8 :: temp448b49
  REAL*8 :: temp499b16
  REAL*8 :: temp15b4
  REAL*8 :: temp37b0
  REAL*8 :: temp44b
  REAL*8 :: temp93
  REAL*8 :: temp118b
  REAL*8 :: temp152
  REAL*8 :: temp155b16
  REAL*8 :: temp162b3
  REAL*8 :: temp189
  REAL*8 :: temp197b29
  REAL*8 :: temp221b7
  REAL*8 :: temp224b19
  REAL*8 :: temp226b2
  REAL*8 :: temp233
  REAL*8 :: temp243b3
  REAL*8 :: temp253b26
  INTEGER :: temp314
  REAL*8 :: temp370b
  REAL*8 :: temp380b1
  REAL*8 :: temp448b11
  REAL*8 :: temp448b48
  REAL*8 :: temp451b
  REAL*8 :: temp461b1
  REAL*8 :: temp488b
  REAL*8 :: temp499b15
  REAL*8 :: temp1b
  REAL*8 :: temp8b29
  REAL*8 :: temp15b3
  REAL*8 :: temp92
  REAL*8 :: temp126b
  DOUBLE PRECISION :: temp151
  REAL*8 :: temp155b15
  REAL*8 :: temp162b2
  REAL*8 :: temp188
  REAL*8 :: temp197b28
  REAL*8 :: temp207b
  REAL*8 :: temp221b6
  REAL*8 :: temp224b18
  REAL*8 :: temp226b1
  REAL*8 :: temp232
  REAL*8 :: temp243b2
  REAL*8 :: temp253b25
  REAL*8 :: temp269
  REAL*8 :: temp313
  REAL*8 :: temp341b3
  REAL*8 :: temp380b0
  REAL*8 :: temp448b10
  REAL*8 :: temp448b47
  REAL*8 :: temp461b0
  REAL*8 :: temp493b5
  REAL*8 :: temp496b
  REAL*8 :: temp499b14
  INTRINSIC DSQRT
  REAL*8 :: temp
  REAL*8 :: temp8b28
  REAL*8 :: temp15b2
  REAL*8 :: temp32b3
  REAL*8 :: temp91
  REAL*8 :: temp97b
  REAL*8 :: temp134b
  DOUBLE PRECISION :: temp150
  REAL*8 :: temp155b9
  REAL*8 :: temp155b14
  REAL*8 :: temp162b1
  REAL*8 :: temp187
  REAL*8 :: temp197b27
  REAL*8 :: temp221b5
  REAL*8 :: temp224b17
  REAL*8 :: temp226b0
  REAL*8 :: temp231
  REAL*8 :: temp243b1
  REAL*8 :: temp253b24
  REAL*8 :: temp268
  REAL*8 :: temp312
  REAL*8 :: temp341b2
  REAL*8 :: temp349
  REAL*8 :: temp448b46
  REAL*8 :: temp493b4
  REAL*8 :: temp499b13
  REAL*8 :: temp8b27
  REAL*8 :: temp15b1
  REAL*8 :: temp32b2
  REAL*8 :: temp90
  REAL*8 :: temp131b19
  REAL*8 :: temp142b
  REAL*8 :: temp155b8
  REAL*8 :: temp155b13
  REAL*8 :: temp162b0
  REAL*8 :: temp179b
  REAL*8 :: temp186
  REAL*8 :: temp197b26
  REAL*8 :: temp221b4
  REAL*8 :: temp224b16
  REAL*8 :: temp230
  REAL*8 :: temp243b0
  REAL*8 :: temp253b9
  REAL*8 :: temp253b23
  DOUBLE PRECISION :: temp267
  REAL*8 :: temp311
  REAL*8 :: temp324b0
  REAL*8 :: temp341b1
  DOUBLE PRECISION :: temp348
  REAL*8 :: temp429
  REAL*8 :: temp448b45
  REAL*8 :: temp459b1
  REAL*8 :: temp493b3
  REAL*8 :: temp499b12
  REAL*8 :: temp8b26
  REAL*8 :: temp15b0
  REAL*8 :: temp32b1
  REAL*8 :: temp131b18
  REAL*8 :: temp150b
  REAL*8 :: temp155b7
  REAL*8 :: temp155b12
  INTEGER :: temp185
  REAL*8 :: temp187b
  REAL*8 :: temp197b25
  REAL*8 :: temp221b3
  REAL*8 :: temp224b15
  REAL*8 :: temp231b
  REAL*8 :: temp253b8
  REAL*8 :: temp253b22
  REAL*8 :: temp260b0
  DOUBLE PRECISION :: temp266
  REAL*8 :: temp297b0
  DOUBLE PRECISION :: temp310
  REAL*8 :: temp312b
  REAL*8 :: temp339b3
  REAL*8 :: temp341b0
  DOUBLE PRECISION :: temp347
  REAL*8 :: temp422b0
  REAL*8 :: temp428
  REAL*8 :: temp432b9
  REAL*8 :: temp448b44
  REAL*8 :: temp459b0
  REAL*8 :: temp493b2
  REAL*8 :: temp499b11
  REAL*8 :: temp509
  REAL*8 :: temp8b25
  DOUBLE PRECISION :: temp9
  REAL*8 :: temp32b0
  REAL*8 :: temp69b0
  REAL*8 :: temp131b17
  REAL*8 :: temp155b6
  REAL*8 :: temp155b11
  REAL*8 :: temp184
  REAL*8 :: temp197b24
  REAL*8 :: temp221b2
  REAL*8 :: temp224b14
  REAL*8 :: temp253b7
  REAL*8 :: temp253b21
  DOUBLE PRECISION :: temp265
  REAL*8 :: temp320b
  REAL*8 :: temp339b2
  DOUBLE PRECISION :: temp346
  DOUBLE PRECISION :: temp356b3
  REAL*8 :: temp427
  REAL*8 :: temp432b8
  REAL*8 :: temp448b43
  REAL*8 :: temp493b1
  REAL*8 :: temp499b10
  INTEGER :: temp508
  REAL*8 :: temp519b
  REAL*8 :: temp520b0
  REAL*8 :: temp8b24
  DOUBLE PRECISION :: temp8
  REAL*8 :: temp131b16
  REAL*8 :: temp155b5
  REAL*8 :: temp155b10
  REAL*8 :: temp177b1
  REAL*8 :: temp183
  REAL*8 :: temp197b23
  REAL*8 :: temp206b31
  REAL*8 :: temp221b1
  REAL*8 :: temp224b13
  REAL*8 :: temp253b6
  REAL*8 :: temp253b20
  DOUBLE PRECISION :: temp264
  REAL*8 :: temp335b29
  REAL*8 :: temp339b1
  DOUBLE PRECISION :: temp345
  DOUBLE PRECISION :: temp356b2
  REAL*8 :: temp426
  REAL*8 :: temp432b7
  REAL*8 :: temp446b
  REAL*8 :: temp448b42
  REAL*8 :: temp448b79
  REAL*8 :: temp493b0
  REAL*8 :: tmp1b
  REAL*8 :: temp507
  REAL*8 :: temp7
  REAL*8 :: temp8b23
  REAL*8 :: temp47b
  REAL*8 :: temp131b15
  REAL*8 :: temp140b0
  REAL*8 :: temp155b4
  REAL*8 :: temp172b5
  REAL*8 :: temp177b0
  REAL*8 :: temp182
  REAL*8 :: temp197b22
  REAL*8 :: temp206b30
  REAL*8 :: temp221b0
  REAL*8 :: temp224b12
  REAL*8 :: temp253b5
  REAL*8 :: temp253b56
  REAL*8 :: temp263
  REAL*8 :: temp292b
  REAL*8 :: temp335b28
  REAL*8 :: temp339b0
  REAL*8 :: temp344
  DOUBLE PRECISION :: temp356b1
  DOUBLE PRECISION :: temp425
  REAL*8 :: temp432b6
  REAL*8 :: temp448b41
  REAL*8 :: temp448b78
  REAL*8 :: temp506
  DOUBLE PRECISION :: temp6
  REAL*8 :: temp8b22
  REAL*8 :: temp129b
  REAL*8 :: temp131b14
  REAL*8 :: temp135b29
  REAL*8 :: temp155b3
  REAL*8 :: temp172b4
  REAL*8 :: temp181
  REAL*8 :: temp197b21
  REAL*8 :: temp224b11
  REAL*8 :: temp253b4
  REAL*8 :: temp253b55
  REAL*8 :: temp262
  REAL*8 :: temp299
  REAL*8 :: temp335b27
  DOUBLE PRECISION :: temp343
  DOUBLE PRECISION :: temp356b0
  REAL*8 :: temp381b
  REAL*8 :: temp400b0
  DOUBLE PRECISION :: temp424
  REAL*8 :: temp432b5
  REAL*8 :: temp448b40
  REAL*8 :: temp448b77
  REAL*8 :: temp462b
  REAL*8 :: temp499b
  REAL*8 :: temp505
  DOUBLE PRECISION :: temp5
  REAL*8 :: temp8b21
  DOUBLE PRECISION :: temp8b58
  REAL*8 :: temp100b
  REAL*8 :: temp131b13
  REAL*8 :: temp135b28
  REAL*8 :: temp137b
  REAL*8 :: temp155b2
  REAL*8 :: temp172b3
  REAL*8 :: temp180
  REAL*8 :: temp197b20
  REAL*8 :: temp197b57
  REAL*8 :: temp224b10
  REAL*8 :: temp253b3
  REAL*8 :: temp253b54
  DOUBLE PRECISION :: temp261
  REAL*8 :: temp298
  REAL*8 :: temp335b26
  REAL*8 :: temp340b39
  REAL*8 :: temp342
  DOUBLE PRECISION :: temp379
  DOUBLE PRECISION :: temp423
  REAL*8 :: temp432b4
  REAL*8 :: temp448b76
  REAL*8 :: temp504
  DOUBLE PRECISION :: temp4
  REAL*8 :: temp8b20
  DOUBLE PRECISION :: temp8b57
  REAL*8 :: temp131b12
  REAL*8 :: temp131b49
  REAL*8 :: temp135b27
  REAL*8 :: temp155b1
  REAL*8 :: temp172b2
  REAL*8 :: temp197b56
  REAL*8 :: temp226b
  REAL*8 :: temp253b2
  REAL*8 :: temp253b53
  REAL*8 :: temp260
  REAL*8 :: temp297
  REAL*8 :: temp335b25
  REAL*8 :: temp340b38
  REAL*8 :: temp341
  DOUBLE PRECISION :: temp378
  DOUBLE PRECISION :: temp422
  REAL*8 :: temp432b3
  REAL*8 :: temp448b75
  REAL*8 :: temp459
  REAL*8 :: temp503
!
! indorb are the number of orbitals occupied before calling
! this subroutine
!
! indpar is the number of variational parameters used
! before calling this subroutine
!
! indshell is the index of the last  occupied orbital
! in the shell, characterized by occupation number iocc(indshell)
!
! z(i,indt+4)   contains the laplacian of the orbital i
! z(i,indt+mu) contains the gradient of the orbital i (mu=1,2,3)
! In the following given a radial part of the orbital f(r)
! fun=1/r  d f(r)/d r
!print *,"minicode/src/c_adjoint_forward/makefun.f90"
!print *,'makefun: iopt=',iopt
!print *,'makefun: i=',i0,' a=',indtmin,' b=',indtm
!print *,'makefun: indpar=',indpar,' indorb=',indorb,' indshell=',indshell
!print *,'makefun: nelskip=',nelskip




  adi4ibuf=1
  adr8ibuf=1

  SELECT CASE  (iopt) 
  CASE (105) 
!     2s double gaussian without  constant
!     (exp (-dd2 r^2)+dd4*exp(-dd5*r^2))
!        dd1=1.d0
    dd2 = dd(indpar+1)
!        dd3=dd(indpar+2)
!        dd4=dd(indpar+3)
!        dd5=dd(indpar+4)
    dd4 = dd(indpar+2)
    dd5 = dd(indpar+3)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
      distp(k, 2) = DEXP(-(dd5*r(k)*r(k)))
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)
!           endif
    IF (typec .NE. 1) THEN
      fun = -(2.d0*(dd2*distp(0, 1)+dd5*dd4*distp(0, 2)))
      fun2 = r(0)**2
      distpb = 0.0_8
      tempb2 = 2.d0*zb(indorbp, indt+4)
      tempb3 = dd2*distp(0, 1)*2.d0*tempb2
      tempb4 = (2.d0*(dd2*fun2)-3.d0)*tempb2
      tempb5 = (2.d0*(dd5*fun2)-3.d0)*tempb2
      tempb6 = dd5*dd4*distp(0, 2)*2.d0*tempb2
      dd2b = distp(0, 1)*tempb4 + fun2*tempb3
      fun2b = dd5*tempb6 + dd2*tempb3
      distpb(0, 1) = dd2*tempb4
      dd5b = fun2*tempb6 + distp(0, 2)*dd4*tempb5
      dd4b = distp(0, 2)*dd5*tempb5
      distpb(0, 2) = dd5*dd4*tempb5
      zb(indorbp, indt+4) = 0.0_8
      funb0 = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      rb(0) = rb(0) + 2*r(0)*fun2b
      tempb1 = -(2.d0*funb0)
      dd2b = dd2b + distp(0, 1)*tempb1
      distpb(0, 1) = distpb(0, 1) + dd2*tempb1
      dd5b = dd5b + distp(0, 2)*dd4*tempb1
      dd4b = dd4b + distp(0, 2)*dd5*tempb1
      distpb(0, 2) = distpb(0, 2) + dd5*dd4*tempb1
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      tempb = DEXP(-(dd5*r(k)**2))*distpb(k, 2)
      dd5b = dd5b - r(k)**2*tempb
      distpb(k, 2) = 0.0_8
      tempb0 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      rb(k) = rb(k) - dd2*2*r(k)*tempb0 - dd5*2*r(k)*tempb
      dd2b = dd2b - r(k)**2*tempb0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd5b
    ddb(indpar+2) = ddb(indpar+2) + dd4b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (40) 
!      3p without cusp condition derivative of 20
!      r e^{-z1 r }
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then
!        c=dsqrt((2.d0*dd1)**5/8.d0/pi)/2.d0
    c = dd1**2.5d0*0.5641895835477562d0
!        endif
    c0 = -c
    c1 = 2.5d0*c/dd1
!
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(k, 2))
      distp(k, 2) = r(k)*distp(k, 1)
    END DO
!
!        indorbp=indorb
!
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
!
!
    IF (typec .NE. 1) THEN
      fun = (c0*(1.d0-dd1*r(0))-c1*dd1)*distp(0, 1)
      fun2 = (c0*dd1*(dd1*r(0)-2.d0)+c1*dd1**2)*distp(0, 1)
!
!              indorbp=indorb
!
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp1 = fun/r(0)
        temp2b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp1b = 4.d0*temp2b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp1+fun2)*zb(indorbp, indt+4&
&          )
        funb0 = funb0 + temp1b
        rb(0) = rb(0) - temp1*temp1b
        fun2b = fun2b + temp2b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp0 = fun/r(0)
          temp0b0 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp0*rmu(i, 0)*zb(indorbp, indt+i&
&            )
          rmub(i, 0) = rmub(i, 0) + temp0*rmu(ic, 0)*zb(indorbp, indt+i)
          funb0 = funb0 + temp0b0
          rb(0) = rb(0) - temp0*temp0b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp0b = distp(0, 1)*fun2b
      temp = dd1*r(0) - 2.d0
      tempb10 = c0*dd1*temp0b
      tempb11 = distp(0, 1)*funb0
      c0b = (1.d0-dd1*r(0))*tempb11 + distp(0, 2)*fun0b + temp*dd1*&
&        temp0b
      dd1b = (-c1-c0*r(0))*tempb11 + r(0)*tempb10 + (c1*2*dd1+temp*c0)*&
&        temp0b
      rb(0) = rb(0) + dd1*tempb10 - c0*dd1*tempb11
      c1b = distp(0, 1)*fun0b - dd1*tempb11 + dd1**2*temp0b
      distpb(0, 1) = (c0*(1.d0-dd1*r(0))-c1*dd1)*funb0 + (c0*dd1*temp+c1&
&        *dd1**2)*fun2b
      distpb(0, 2) = distpb(0, 2) + c0*fun0b
      distpb(0, 1) = distpb(0, 1) + c1*fun0b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        tempb9 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (c0*distp(i, 2)+c1*distp(i, 1))*zb(&
&          indorbp, i)
        c0b = c0b + distp(i, 2)*tempb9
        distpb(i, 2) = distpb(i, 2) + c0*tempb9
        c1b = c1b + distp(i, 1)*tempb9
        distpb(i, 1) = distpb(i, 1) + c1*tempb9
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(k, 2))
      rb(k) = rb(k) + distp(k, 1)*distpb(k, 2)
      distpb(k, 1) = distpb(k, 1) + r(k)*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      tempb8 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*tempb8
      rb(k) = rb(k) - dd1*tempb8
      distpb(k, 1) = 0.0_8
    END DO
    tempb7 = 2.5d0*c1b/dd1
    cb = tempb7 - c0b
    dd1b = dd1b + 0.5641895835477562d0*2.5d0*dd1**1.5D0*cb - c*tempb7/&
&      dd1
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (52) 
! 4p single zeta
! g single gaussian orbital
! derivative of 51
! R(r)= exp(-alpha r^2)
! normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization
!        c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)
    c = dd1**2.75d0*1.11284691281640568826d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)*(11.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-15.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+21.d0*dd1*r(0)**2-15.d0&
&        /2.d0)
!              indorbp=indorb
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
          ELSE IF (ic .EQ. 7) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            END IF
          ELSE IF (ic .EQ. 8) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
          ELSE IF (ic .EQ. 9) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp8b55 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb0 = funb0 + 10.d0*temp8b55
        fun2b = fun2b + temp8b55
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 15) THEN
            IF (branch .LT. 8) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    temp8b0 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2)-&
&                      60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp8b0
                    rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp8b0
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0&
&                      )*temp8b0
                  ELSE
                    temp8b1 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-&
&                      60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp8b1
                    rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp8b1
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0&
&                      )*temp8b1
                  END IF
                ELSE IF (branch .LT. 4) THEN
                  temp8b2 = cost1g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(rmu(&
&                    3, 0)*r(0)**2))*zb(indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*&
&                    r(0)**2)*temp8b2
                  rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp8b2
                ELSE
                  temp8b3 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*&
&                    rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp8b3
                  rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp8b3
                  rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp8b3
                END IF
              ELSE IF (branch .LT. 7) THEN
                IF (branch .LT. 6) THEN
                  temp8b4 = -(cost2g*6.d0*zb(indorbp, indt+i))
                  temp8b5 = rmu(2, 0)*rmu(3, 0)*temp8b4
                  temp8b6 = fun0*rmu(1, 0)*temp8b4
                  fun0b = fun0b + rmu(1, 0)*temp8b5
                  rmub(1, 0) = rmub(1, 0) + fun0*temp8b5
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp8b6
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp8b6
                ELSE
                  temp8b7 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp8b8 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)**2&
&                    )*temp8b7
                  temp8b9 = fun0*rmu(1, 0)*temp8b7
                  fun0b = fun0b + rmu(1, 0)*temp8b8
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp8b9 + fun0*&
&                    temp8b8
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp8b9
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp8b9
                END IF
              ELSE
                temp8b10 = -(cost2g*6.d0*zb(indorbp, indt+i))
                temp8b11 = rmu(2, 0)*rmu(3, 0)*temp8b10
                temp8b12 = fun0*rmu(1, 0)*temp8b10
                fun0b = fun0b + rmu(1, 0)*temp8b11
                rmub(1, 0) = rmub(1, 0) + fun0*temp8b11
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp8b12
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp8b12
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  temp8b13 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*&
&                    rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp8b13
                  rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp8b13
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp8b13
                ELSE
                  temp8b14 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp8b15 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)**&
&                    2)*temp8b14
                  temp8b16 = fun0*rmu(2, 0)*temp8b14
                  fun0b = fun0b + rmu(2, 0)*temp8b15
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp8b16 + fun0*&
&                    temp8b15
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp8b16
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp8b16
                END IF
              ELSE IF (branch .LT. 11) THEN
                temp8b17 = -(cost3g*4.d0*zb(indorbp, indt+i))
                temp8b18 = fun0*temp8b17
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*temp8b17
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp8b18
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp8b18
              ELSE
                temp8b19 = cost3g*4.d0*zb(indorbp, indt+i)
                temp8b20 = fun0*temp8b19
                fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)&
&                  **2))*temp8b19
                rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp8b20
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp8b20
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                temp8b21 = cost3g*12.d0*zb(indorbp, indt+i)
                temp8b22 = fun0*rmu(3, 0)*temp8b21
                temp8b23 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp8b21
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp8b22
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp8b22
                fun0b = fun0b + rmu(3, 0)*temp8b23
                rmub(3, 0) = rmub(3, 0) + fun0*temp8b23
              ELSE
                temp8b24 = -(cost3g*2.d0*zb(indorbp, indt+i))
                temp8b25 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3, 0&
&                  )**2)*temp8b24
                temp8b26 = fun0*rmu(2, 0)*temp8b24
                fun0b = fun0b + rmu(2, 0)*temp8b25
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp8b26 + fun0*&
&                  temp8b25
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp8b26
                rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp8b26
              END IF
            ELSE
              temp8b27 = -(cost3g*2.d0*zb(indorbp, indt+i))
              temp8b28 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0)&
&                **2)*temp8b27
              temp8b29 = fun0*rmu(1, 0)*temp8b27
              fun0b = fun0b + rmu(1, 0)*temp8b28
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp8b29 + fun0*&
&                temp8b28
              rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp8b29
              rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp8b29
            END IF
          ELSE IF (branch .LT. 22) THEN
            IF (branch .LT. 19) THEN
              IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  temp8b30 = cost3g*24.d0*zb(indorbp, indt+i)
                  temp8b31 = rmu(2, 0)*rmu(3, 0)*temp8b30
                  temp8b32 = fun0*rmu(1, 0)*temp8b30
                  fun0b = fun0b + rmu(1, 0)*temp8b31
                  rmub(1, 0) = rmub(1, 0) + fun0*temp8b31
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp8b32
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp8b32
                ELSE
                  temp8b33 = cost4g*3.d0*zb(indorbp, indt+i)
                  temp8b34 = fun0*rmu(3, 0)*temp8b33
                  temp8b35 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp8b33
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp8b34
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp8b34
                  fun0b = fun0b + rmu(3, 0)*temp8b35
                  rmub(3, 0) = rmub(3, 0) + fun0*temp8b35
                END IF
              ELSE IF (branch .LT. 18) THEN
                temp8b36 = -(cost4g*6.d0*zb(indorbp, indt+i))
                temp8b37 = rmu(2, 0)*rmu(3, 0)*temp8b36
                temp8b38 = fun0*rmu(1, 0)*temp8b36
                fun0b = fun0b + rmu(1, 0)*temp8b37
                rmub(1, 0) = rmub(1, 0) + fun0*temp8b37
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp8b38
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp8b38
              ELSE
                temp8b39 = cost4g*fun0*zb(indorbp, indt+i)
                fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu&
&                  (2, 0)**2))*zb(indorbp, indt+i)
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp8b39
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp8b39
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                temp8b40 = cost4g*6.d0*zb(indorbp, indt+i)
                temp8b41 = rmu(2, 0)*rmu(3, 0)*temp8b40
                temp8b42 = fun0*rmu(1, 0)*temp8b40
                fun0b = fun0b + rmu(1, 0)*temp8b41
                rmub(1, 0) = rmub(1, 0) + fun0*temp8b41
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp8b42
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp8b42
              ELSE
                temp8b43 = cost4g*3.d0*zb(indorbp, indt+i)
                temp8b44 = fun0*rmu(3, 0)*temp8b43
                temp8b45 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp8b43
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp8b44
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp8b44
                fun0b = fun0b + rmu(3, 0)*temp8b45
                rmub(3, 0) = rmub(3, 0) + fun0*temp8b45
              END IF
            ELSE
              temp8b46 = cost4g*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(&
&                2, 0)**3)*zb(indorbp, indt+i)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp8b46
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp8b46
            END IF
          ELSE IF (branch .LT. 26) THEN
            IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                temp8b47 = cost5g*4.d0*zb(indorbp, indt+i)
                temp8b48 = fun0*temp8b47
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp8b47
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp8b48
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp8b48
              END IF
            ELSE IF (branch .LT. 25) THEN
              temp8b49 = cost5g*4.d0*zb(indorbp, indt+i)
              temp8b50 = fun0*temp8b49
              fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)&
&                ))*temp8b49
              rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**&
&                2)*temp8b50
              rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp8b50
            END IF
          ELSE IF (branch .LT. 28) THEN
            IF (branch .LT. 27) THEN
              temp8b51 = cost5g*4.d0*zb(indorbp, indt+i)
              temp8b52 = fun0*temp8b51
              fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**&
&                3)*temp8b51
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp8b52
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp8b52
            END IF
          ELSE
            temp8b53 = cost5g*4.d0*zb(indorbp, indt+i)
            temp8b54 = fun0*temp8b53
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp8b53
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp8b54
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp8b54
          END IF
          temp8b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp8b
          funb0 = funb0 + rmu(i, 0)*temp8b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp7 = r(0)**4
      temp7b = distp(0, 1)*fun2b
      temp6 = 4.d0*dd1
      temp5 = 11.d0/temp6
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-15.d0/2.d0)*&
&        funb0 + (temp5-r(0)**2)*fun0b + (21.d0*(dd1*r(0)**2)-15.d0/2.d0-&
&        4.d0*(dd1**2*temp7))*fun2b
      temp7b0 = distp(0, 1)*2.d0*funb0
      dd1b = r(0)**2*temp7b0 - distp(0, 1)*temp5*4.d0*fun0b/temp6 + (&
&        21.d0*r(0)**2-4.d0*temp7*2*dd1)*temp7b
      rb(0) = rb(0) + dd1*2*r(0)*temp7b0 - distp(0, 1)*2*r(0)*fun0b + (&
&        21.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp7b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    dd1b = 0.0_8
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        temp5b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp4 = 4.d0*dd1
        temp3 = 11.d0/temp4
        temp3b17 = (temp3-r(k)**2)*zb(indorbp, k)
        dd1b = dd1b - temp3*4.d0*temp5b/temp4
        rb(k) = rb(k) - 2*r(k)*temp5b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp3b17
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp3b17
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp3b = cost5g*4.d0*distpb(i, 10)
      temp3b0 = (rmu(1, i)**2-rmu(2, i)**2)*temp3b
      temp3b1 = rmu(1, i)*rmu(2, i)*temp3b
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp3b1 + rmu(2, i)*temp3b0
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp3b0 - 2*rmu(2, i)*temp3b1
      distpb(i, 10) = 0.0_8
      temp3b2 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp3b2
      distpb(i, 9) = 0.0_8
      temp3b3 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp3b4 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp3b3 - 2*rmu(2, i)*temp3b4 &
&        + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*temp3b2
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp3b3
      distpb(i, 8) = 0.0_8
      temp3b5 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp3b6 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp3b5 + 2*rmu(1, i)*temp3b6 &
&        + 3.d0*2*rmu(1, i)*temp3b4
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp3b5
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp3b6
      distpb(i, 7) = 0.0_8
      temp3b7 = cost3g*2.d0*distpb(i, 6)
      temp3b8 = (7.d0*rmu(3, i)**2-r(i)**2)*temp3b7
      temp3b9 = rmu(1, i)*rmu(2, i)*temp3b7
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp3b8
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp3b8
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp3b9
      distpb(i, 6) = 0.0_8
      temp3b10 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp3b11 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp3b12 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp3b13 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp3b14 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp3b15 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp3b16 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp3b16 - 3.d0*2*r(i)*temp3b15 - 2*r(i)*temp3b11 - 3.d0*2*r(i)*&
&        temp3b13 - 2*r(i)*temp3b9
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp3b10
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp3b10
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp3b11
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp3b12
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp3b13 + rmu(2, i)*&
&        temp3b12
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp3b14
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp3b16 + 7.d0*2*rmu(3, i)*temp3b15 + rmu(1, i)*&
&        temp3b14
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp2 = r(k)**2
      temp2b0 = c*DEXP(-(dd1*temp2))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp2))*distpb(k, 1)
      dd1b = dd1b - temp2*temp2b0
      rb(k) = rb(k) - dd1*2*r(k)*temp2b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.11284691281640568826d0*2.75d0*dd1**1.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (31) 
!     3d without cusp condition double Z
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
!        if(iflagnorm.gt.2) then
    c = 1/2.d0*DSQRT(5.d0/pi)/DSQRT(1/dd1**7/128.d0+2*peff/(dd1+dd2)**7+&
&      peff**2/dd2**7/128.d0)/DSQRT(720.d0)
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      distp(k, 2) = DEXP(-(dd2*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = c*(distp(i, 1)+peff*distp(i, 2))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
!lz=0
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
!lz=+/-2
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
! lz=+/- 2
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
! lz=+/-1
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
! lz=+/-1
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!        indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = c*(-(dd1*distp(0, 1))-peff*dd2*distp(0, 2))
      fun2 = c*(dd1**2*distp(0, 1)+peff*dd2**2*distp(0, 2))
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp16 = fun/r(0)
        temp17b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp16b3 = 6.d0*temp17b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp16+fun2)*zb(&
&          indorbp, indt+4)
        funb0 = funb0 + temp16b3
        rb(0) = rb(0) - temp16*temp16b3
        fun2b = fun2b + temp17b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp16b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp16b
                  fun0b = fun0b + rmu(i, 0)*temp16b
                ELSE
                  temp16b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp16b0
                  fun0b = fun0b + rmu(i, 0)*temp16b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp16b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp16b1
                fun0b = fun0b + rmu(i, 0)*temp16b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp16b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp16b2
                fun0b = fun0b + rmu(i, 0)*temp16b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp15 = fun/r(0)
          temp15b5 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp15*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp15*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb0 = funb0 + temp15b5
          rb(0) = rb(0) - temp15*temp15b5
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp15b2 = c*fun2b
      temp15b3 = dd2**2*temp15b2
      cb = (-(dd1*distp(0, 1))-peff*dd2*distp(0, 2))*funb0 + (dd1**2*&
&        distp(0, 1)+dd2**2*(peff*distp(0, 2)))*fun2b
      temp15b4 = c*funb0
      dd1b = distp(0, 1)*2*dd1*temp15b2 - distp(0, 1)*temp15b4
      distpb(0, 1) = distpb(0, 1) + dd1**2*temp15b2
      dd2b = peff*distp(0, 2)*2*dd2*temp15b2 - distp(0, 2)*peff*temp15b4
      peffb = distp(0, 2)*temp15b3 - distp(0, 2)*dd2*temp15b4
      distpb(0, 2) = distpb(0, 2) + peff*temp15b3
      distpb(0, 1) = distpb(0, 1) - dd1*temp15b4
      distpb(0, 2) = distpb(0, 2) - peff*dd2*temp15b4
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      cb = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      temp15b1 = c*distpb(i, 3)
      cb = cb + (distp(i, 1)+peff*distp(i, 2))*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + temp15b1
      peffb = peffb + distp(i, 2)*temp15b1
      distpb(i, 2) = distpb(i, 2) + peff*temp15b1
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp15b = DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp15b
      distpb(k, 2) = 0.0_8
      temp15b0 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp15b0 - dd2*temp15b
      dd1b = dd1b - r(k)*temp15b0
      distpb(k, 1) = 0.0_8
    END DO
    temp14 = 128.d0*dd2**7
    temp13 = peff**2/temp14
    temp12 = (dd1+dd2)**7
    temp11 = 128.d0*dd1**7
    temp8 = 1.0/temp11 + 2*(peff/temp12) + temp13
    temp10 = DSQRT(temp8)
    temp9 = 2.d0*DSQRT(720.d0)
    IF (temp8 .EQ. 0.0) THEN
      temp8b56 = 0.0
    ELSE
      temp8b56 = -(DSQRT(5.d0/pi)*cb/(temp9*temp10**2*2.D0*DSQRT(temp8))&
&        )
    END IF
    temp8b57 = 2*temp8b56/temp12
    temp8b58 = -(peff*7*(dd1+dd2)**6*temp8b57/temp12)
    dd1b = dd1b + temp8b58 - 128.d0*7*dd1**6*temp8b56/temp11**2
    peffb = peffb + 2*peff*temp8b56/temp14 + temp8b57
    dd2b = dd2b + temp8b58 - temp13*128.d0*7*dd2**6*temp8b56/temp14
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (113) 
!     2s without cusp condition
!     dd1*( dd3 +r^2/(1+dd2*r)^4)
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
!           endif
    IF (typec .NE. 1) THEN
      fun = (2.d0-2.d0*dd2*r(0))/(1+dd2*r(0))**5
      fun2b = zb(indorbp, indt+4)
      funb0 = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp20 = (dd2*r(0)+1)**6
      temp20b = 2.d0*fun2b/temp20
      temp20b0 = -((3.d0*(dd2**2*r(0)**2)-6.d0*(dd2*r(0))+1.d0)*6*(dd2*r&
&        (0)+1)**5*temp20b/temp20)
      temp19 = (dd2*r(0)+1)**5
      temp19b = funb0/temp19
      temp19b0 = -((2.d0-2.d0*(dd2*r(0)))*5*(dd2*r(0)+1)**4*temp19b/&
&        temp19)
      dd2b = r(0)*temp19b0 - 2.d0*r(0)*temp19b + r(0)*temp20b0 + (3.d0*r&
&        (0)**2*2*dd2-6.d0*r(0))*temp20b
      rb(0) = rb(0) + dd2*temp19b0 - 2.d0*dd2*temp19b + dd2*temp20b0 + (&
&        3.d0*dd2**2*2*r(0)-6.d0*dd2)*temp20b
    ELSE
      dd2b = 0.0_8
    END IF
    distpb = 0.0_8
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp17 = dd2*r(k) + 1.d0
      temp18 = temp17**4
      temp17b0 = -(r(k)**2*4*temp17**3*distpb(k, 1)/temp18**2)
      rb(k) = rb(k) + dd2*temp17b0 + 2*r(k)*distpb(k, 1)/temp18
      dd2b = dd2b + r(k)*temp17b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (10000:11000) 
    distpb = 0.0_8
  CASE (107) 
! Reserved for dummy orbitals
!     2p single  lorentian  parent of 103
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)**2)
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)**2*2.d0)
      fun2 = fun*distp(0, 1)*(1.d0-3.d0*dd2*r(0)**2)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp22b2 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp22b2
        fun2b = fun2b + temp22b2
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp22b1 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp22b1
          funb0 = funb0 + rmu(ic, 0)*temp22b1
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp22b = (1.d0-3.d0*(dd2*r(0)**2))*fun2b
      temp22b0 = -(fun*distp(0, 1)*3.d0*fun2b)
      funb0 = funb0 + distp(0, 1)*temp22b
      distpb(0, 1) = fun0b - 2.d0*dd2*2*distp(0, 1)*funb0 + fun*temp22b
      dd2b = r(0)**2*temp22b0 - 2.d0*distp(0, 1)**2*funb0
      rb(0) = rb(0) + dd2*2*r(0)*temp22b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp21 = dd2*r(k)**2 + 1.d0
      temp21b = -(distpb(k, 1)/temp21**2)
      dd2b = dd2b + r(k)**2*temp21b
      rb(k) = rb(k) + dd2*2*r(k)*temp21b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (43) 
!     4d without cusp and one parmater  derivative of 33
    dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then
!     c=                                                           &
!                                                              &1.d0/(2.d0**3*3.d0)/dsqrt(56.d0*pi)*(2.d0*dd1)**(9.d0/2.d0)
    c = dd1**4.5d0*0.0710812062076410d0
!         endif
    c0 = -c
    c1 = 4.5d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*(c0*r(i)**2+c1*r(i))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
! lz=0
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
! lz=+/
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
! lz=+/-2
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
! lz=+/-1
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
! lz=+/-1
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!            endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(dd1*distp(0, 3)) + distp(0, 1)*(2.d0*c0*r(0)+c1)
      fun2 = dd1**2*distp(0, 3) + distp(0, 1)*(-(2.d0*dd1*(2.d0*c0*r(0)+&
&        c1))+2.d0*c0)
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp24 = fun/r(0)
        temp25b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp24b3 = 6.d0*temp25b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp24+fun2)*zb(&
&          indorbp, indt+4)
        funb0 = funb0 + temp24b3
        rb(0) = rb(0) - temp24*temp24b3
        fun2b = fun2b + temp25b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp24b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp24b
                  fun0b = fun0b + rmu(i, 0)*temp24b
                ELSE
                  temp24b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp24b0
                  fun0b = fun0b + rmu(i, 0)*temp24b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp24b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp24b1
                fun0b = fun0b + rmu(i, 0)*temp24b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp24b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp24b2
                fun0b = fun0b + rmu(i, 0)*temp24b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp23 = fun/r(0)
          temp23b0 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp23*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp23*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb0 = funb0 + temp23b0
          rb(0) = rb(0) - temp23*temp23b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp22 = 2.d0*c0*r(0) + c1
      temp23b = -(distp(0, 1)*2.d0*fun2b)
      temp22b6 = dd1*temp23b
      dd1b = temp22*temp23b - distp(0, 3)*funb0 + distp(0, 3)*2*dd1*&
&        fun2b
      distpb(0, 3) = distpb(0, 3) + dd1**2*fun2b
      distpb(0, 1) = distpb(0, 1) + (2.d0*(c0*r(0))+c1)*funb0 + (2.d0*c0&
&        -2.d0*(dd1*temp22))*fun2b
      temp22b7 = distp(0, 1)*funb0
      c0b = 2.d0*r(0)*temp22b7 + 2.d0*r(0)*temp22b6 + distp(0, 1)*2.d0*&
&        fun2b
      rb(0) = rb(0) + 2.d0*c0*temp22b7 + 2.d0*c0*temp22b6
      c1b = temp22b7 + temp22b6
      distpb(0, 3) = distpb(0, 3) + fun0b - dd1*funb0
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      temp22b5 = distp(i, 1)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + (c0*r(i)**2+c1*r(i))*distpb(i, 3)
      c0b = c0b + r(i)**2*temp22b5
      rb(i) = rb(i) + (c1+c0*2*r(i))*temp22b5
      c1b = c1b + r(i)*temp22b5
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp22b4 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp22b4
      rb(k) = rb(k) - dd1*temp22b4
      distpb(k, 1) = 0.0_8
    END DO
    temp22b3 = 4.5d0*c1b/dd1
    cb = temp22b3 - c0b
    dd1b = dd1b + 0.0710812062076410d0*4.5d0*dd1**3.5D0*cb - c*temp22b3/&
&      dd1
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (6) 
! derivative of 36 with respect zeta
! normalized
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
!           if(iflagnorm.gt.2) then
!            c=                                              WRONG
!                                                                  &0.5*dsqrt((1.d0/dd1**5/32.d0+2.d0*peff/(dd1+dd2)**5
!                                                              &+peff**2/dd2**5/32.d0)/(24.d0*pi))
    c = 1.d0/DSQRT(3.d0*pi*(1.d0/dd1**5+64.d0*peff/(dd1+dd2)**5+peff**2/&
&      dd2**5))
!           endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(1.d0-dd1*r(0)) + peff*distp(0, 2)*(1.d0-dd2*r(0&
&        ))
      temp32b = 2.d0*zb(indorbp, indt+4)/r(0)
      funb0 = temp32b
      rb(0) = rb(0) - fun*temp32b/r(0)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp31 = fun/r(0)
        temp31b7 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp31*zb(indorbp, indt+i)
        funb0 = funb0 + temp31b7
        rb(0) = rb(0) - temp31*temp31b7
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp31b2 = distp(0, 1)*fun2b
      temp31b3 = (dd2**2*r(0)-2.d0*dd2)*fun2b
      temp31b4 = peff*distp(0, 2)*fun2b
      distpb(0, 1) = (dd1**2*r(0)-2.d0*dd1)*fun2b
      dd1b = (r(0)*2*dd1-2.d0)*temp31b2 - distp(0, 1)*r(0)*funb0
      temp31b5 = peff*distp(0, 2)*funb0
      rb(0) = rb(0) + dd2**2*temp31b4 - dd2*temp31b5 - distp(0, 1)*dd1*&
&        funb0 + dd1**2*temp31b2
      temp31b6 = (1.d0-dd2*r(0))*funb0
      peffb = distp(0, 2)*temp31b6 + distp(0, 2)*temp31b3
      distpb(0, 2) = peff*temp31b3
      dd2b = (r(0)*2*dd2-2.d0)*temp31b4 - r(0)*temp31b5
      distpb(0, 1) = distpb(0, 1) + (1.d0-dd1*r(0))*funb0
      distpb(0, 2) = distpb(0, 2) + peff*temp31b6
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp31b1 = r(i)*zb(indorbp, i)
      rb(i) = rb(i) + (distp(i, 1)+distp(i, 2)*peff)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp31b1
      distpb(i, 2) = distpb(i, 2) + peff*temp31b1
      peffb = peffb + distp(i, 2)*temp31b1
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp31b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp31b
      distpb(k, 2) = 0.0_8
      temp31b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp31b0 - dd2*temp31b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp31b0
      distpb(k, 1) = 0.0_8
    END DO
    temp30 = dd2**5
    temp29 = peff**2/temp30
    temp28 = (dd1+dd2)**5
    temp27 = dd1**5
    temp26 = 3.d0*pi*(1.0/temp27+64.d0*peff/temp28+temp29)
    temp25 = DSQRT(temp26)
    IF (temp26 .EQ. 0.0) THEN
      temp25b0 = 0.0
    ELSE
      temp25b0 = -(pi*3.d0*cb/(temp25**2*2.D0*DSQRT(temp26)))
    END IF
    temp25b1 = 64.d0*temp25b0/temp28
    temp25b2 = -(peff*5*(dd1+dd2)**4*temp25b1/temp28)
    dd1b = dd1b + temp25b2 - 5*dd1**4*temp25b0/temp27**2
    peffb = peffb + 2*peff*temp25b0/temp30 + temp25b1
    dd2b = dd2b + temp25b2 - temp29*5*dd2**4*temp25b0/temp30
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (136) 
! 2s double Z NO CUSP
!     2p single exponential  r^5 e^{-z r}  !
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(5.d0-dd2*r(0))*r(0)**3
      fun2 = distp(0, 1)*(20*r(0)**3-10*dd2*r(0)**4+dd2**2*r(0)**5)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp34b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp34b0
        fun2b = fun2b + temp34b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp34b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp34b
          funb0 = funb0 + rmu(ic, 0)*temp34b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp33 = r(0)**5
      temp32 = r(0)**4
      temp32b2 = distp(0, 1)*fun2b
      temp32b3 = r(0)**3*funb0
      distpb(0, 1) = (5.d0-dd2*r(0))*temp32b3 + r(0)**5*fun0b + (20*r(0)&
&        **3-10*(dd2*temp32)+dd2**2*temp33)*fun2b
      rb(0) = rb(0) + distp(0, 1)*(5.d0-dd2*r(0))*3*r(0)**2*funb0 - &
&        distp(0, 1)*dd2*temp32b3 + distp(0, 1)*5*r(0)**4*fun0b + (dd2**2&
&        *5*r(0)**4-10*dd2*4*r(0)**3+20*3*r(0)**2)*temp32b2
      dd2b = (temp33*2*dd2-10*temp32)*temp32b2 - distp(0, 1)*r(0)*&
&        temp32b3
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp32b1 = r(i)**5*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp32b1
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp32b1
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*5*r(i)**4*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp32b0 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp32b0
      rb(k) = rb(k) - dd2*temp32b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (200) 
!     THE  COSTANT
    indorbp = indorb + 1
!           endif
    IF (typec .NE. 1) THEN
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        zb(indorbp, indt+i) = 0.0_8
      END DO
    END IF
    DO i=indtm,i0,-1
      zb(indorbp, i) = 0.0_8
    END DO
    distpb = 0.0_8
  CASE (118) 
!     2s double lorentian with constant  parent of 102
!     (dd1+  1/ (1 + Exp[  dd2 (r^2 - r_0^2) ] )   | dd3=r_0
!      Fermi distribution with r^2
    dd2 = dd(indpar+2)
    dd3 = -(dd2*dd(indpar+3)**2)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,arg)
      arg = dd2*r(k)**2 + dd3
      IF (arg .GT. 200) THEN
        distp(k, 1) = DEXP(200.d0)
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE
        distp(k, 1) = DEXP(arg)
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      END IF
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)
!           endif
    IF (typec .NE. 1) THEN
      fun = -(2.d0*dd2*distp(0, 1)/(1.d0+distp(0, 1))**2)
      fun2b = zb(indorbp, indt+4)
      funb0 = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp36 = (distp(0, 1)+1.d0)**3
      temp35 = -(2.d0*dd2*r(0)**2) - 1.d0
      temp34 = -(2.d0*dd2*r(0)**2) + 1.d0
      temp34b1 = -(2.d0*dd2*fun2b/temp36)
      temp34b2 = -(distp(0, 1)**2*2.d0*temp34b1)
      temp34b3 = distp(0, 1)*2.d0*temp34b1
      temp34b4 = -(2.d0*(distp(0, 1)**2*temp34-distp(0, 1)*temp35)*fun2b&
&        /temp36)
      temp34b5 = -(2.d0*funb0/(distp(0, 1)+1.d0)**2)
      distpb(0, 1) = (dd2-dd2*distp(0, 1)*2/(distp(0, 1)+1.d0))*temp34b5&
&        - dd2*3*(distp(0, 1)+1.d0)**2*temp34b4/temp36 + (temp34*2*distp(&
&        0, 1)-temp35)*temp34b1
      dd2b = distp(0, 1)*temp34b5 + temp34b4 + r(0)**2*temp34b3 + r(0)**&
&        2*temp34b2
      rb(0) = rb(0) + dd2*2*r(0)*temp34b3 + dd2*2*r(0)*temp34b2
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd1b = 0.0_8
    DO i=indtm,i0,-1
      dd1b = dd1b + zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) - zb(indorbp, i)/(distp(i, 1)+1.d0)**2
      zb(indorbp, i) = 0.0_8
    END DO
    dd3b = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
      IF (branch .LT. 2) THEN
        distpb(k, 1) = 0.0_8
        argb = 0.0_8
      ELSE
        argb = DEXP(arg)*distpb(k, 1)
        distpb(k, 1) = 0.0_8
      END IF
      CALL POPREAL8(adr8ibuf,adr8buf,arg)
      dd2b = dd2b + r(k)**2*argb
      rb(k) = rb(k) + dd2*2*r(k)*argb
      dd3b = dd3b + argb
    END DO
    dd2b = dd2b - dd(indpar+3)**2*dd3b
    ddb(indpar+3) = ddb(indpar+3) - dd2*2*dd(indpar+3)*dd3b
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (15) 
! (r**2 + dd2*(1 + dd1*r))*exp(-dd1*r)  ! normalized
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    c = DSQRT(2.d0*dd1**7/pi/(45.d0+42.d0*dd1**2*dd2+14.d0*dd1**4*dd2**2&
&      ))
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*r(0)*(2.d0-dd1**2*dd2-dd1*r(0))
      temp44b = 2.d0*zb(indorbp, indt+4)/r(0)
      funb0 = temp44b
      rb(0) = rb(0) - fun*temp44b/r(0)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp43 = fun/r(0)
        temp43b0 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp43*zb(indorbp, indt+i)
        funb0 = funb0 + temp43b0
        rb(0) = rb(0) - temp43*temp43b0
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp42 = -(dd1*r(0)) - dd1**2*dd2 + 3.d0
      temp43b = distp(0, 1)*fun2b
      temp42b0 = (1.d0-dd1*r(0))*temp43b
      temp42b1 = (2.d0-dd1*r(0)-dd1**2*dd2)*funb0
      distpb(0, 1) = r(0)*temp42b1 + ((1.d0-dd1*r(0))*temp42-1.d0)*fun2b
      temp42b2 = distp(0, 1)*r(0)*funb0
      dd1b = (-(dd2*2*dd1)-r(0))*temp42b2 + (-(dd2*2*dd1)-r(0))*temp42b0&
&        - temp42*r(0)*temp43b
      rb(0) = rb(0) + distp(0, 1)*temp42b1 - dd1*temp42b2 - dd1*temp42b0&
&        - temp42*dd1*temp43b
      dd2b = -(dd1**2*temp42b2) - dd1**2*temp42b0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp42b = distp(i, 1)*zb(indorbp, i)
      temp41 = dd1*r(i) + 1.d0
      rb(i) = rb(i) + (dd2*dd1+2*r(i))*temp42b
      dd2b = dd2b + temp41*temp42b
      dd1b = dd1b + dd2*r(i)*temp42b
      distpb(i, 1) = distpb(i, 1) + (r(i)**2+dd2*temp41)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp41b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp41b
      rb(k) = rb(k) - dd1*temp41b
      distpb(k, 1) = 0.0_8
    END DO
    temp40 = dd1**4
    temp39 = pi*(42.d0*dd1**2*dd2+14.d0*temp40*dd2**2+45.d0)
    temp38 = dd1**7
    temp37 = temp38/temp39
    IF (2.d0*temp37 .EQ. 0.0) THEN
      temp37b = 0.0
    ELSE
      temp37b = 2.d0*cb/(2.D0*DSQRT(2.d0*temp37)*temp39)
    END IF
    temp37b0 = -(temp37*pi*temp37b)
    dd1b = dd1b + (14.d0*dd2**2*4*dd1**3+42.d0*dd2*2*dd1)*temp37b0 + 7*&
&      dd1**6*temp37b
    dd2b = dd2b + (14.d0*temp40*2*dd2+42.d0*dd1**2)*temp37b0
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (122) 
! 2s gaussian for pseudo
!     2s with cusp condition
!     dd1*( dd3 +exp(-dd2*r)*(1+dd2*r))
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2**2*distp(0, 1))
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      funb0 = funb0 + (1.d0-dd2*r(0))*fun2b
      dd2b = -(distp(0, 1)*2*dd2*funb0) - fun*r(0)*fun2b
      rb(0) = rb(0) - fun*dd2*fun2b
      distpb = 0.0_8
      distpb(0, 1) = -(dd2**2*funb0)
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      temp44b1 = distp(i, 1)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + (dd2*r(i)+1.d0)*zb(indorbp, i)
      dd2b = dd2b + r(i)*temp44b1
      rb(i) = rb(i) + dd2*temp44b1
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp44b0 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp44b0
      rb(k) = rb(k) - dd2*temp44b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (128) 
!     2s with cusp condition
!     ( r^2*exp(-dd2*r))  ! with no cusp condition
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd2*r(0))*distp(0, 1)
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp44b3 = distp(0, 1)*fun2b
      temp44b4 = 2*dd2*r(0)*temp44b3
      dd2b = r(0)*temp44b4 - 4*r(0)*temp44b3 - distp(0, 1)*r(0)*funb0
      rb(0) = rb(0) + dd2*temp44b4 - 4*dd2*temp44b3 - distp(0, 1)*dd2*&
&        funb0
      distpb(0, 1) = (2.d0-dd2*r(0))*funb0 + ((dd2*r(0))**2-4*(dd2*r(0))&
&        +2.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp44b2 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp44b2
      rb(k) = rb(k) - dd2*temp44b2
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (16) 
! s orbital
! 
! - angmom = 0
! - type = Gaussian
! - normalized = yes
! - angtype = spherical
! - npar = 1
! - multiplicity = 1
!
! = N * R
!
! where N is the normalization constant
! N = (2*alpha/pi)**(3/4)
!
! and R is the radial part
! R = exp(-alpha*r**2)
!
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    IF (dd1 .NE. 0.) THEN
      c = 0.71270547035499016d0*dd1**0.75d0
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
      c = 1.d0
    END IF
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    IF (typec .NE. 1) THEN
! the first derivative /r
      fun = -(2.d0*dd1*distp(0, 1))
! the second derivative
      fun2 = fun*(1.d0-2.d0*dd1*r(0)*r(0))
      IF (typec .EQ. 2) THEN
! Backflow
        funb = (fun2-fun)/(r(0)*r(0))
        funbb = rmu(3, 0)*rmu(2, 0)*zb(indorbp, indt+10)
        rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*funb*zb(indorbp, indt+10)
        rmub(3, 0) = rmub(3, 0) + funb*rmu(2, 0)*zb(indorbp, indt+10)
        zb(indorbp, indt+10) = 0.0_8
        funbb = funbb + rmu(3, 0)*rmu(1, 0)*zb(indorbp, indt+9)
        rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*funb*zb(indorbp, indt+9)
        rmub(3, 0) = rmub(3, 0) + funb*rmu(1, 0)*zb(indorbp, indt+9)
        zb(indorbp, indt+9) = 0.0_8
        funbb = funbb + rmu(2, 0)*rmu(1, 0)*zb(indorbp, indt+8)
        rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*funb*zb(indorbp, indt+8)
        rmub(2, 0) = rmub(2, 0) + funb*rmu(1, 0)*zb(indorbp, indt+8)
        zb(indorbp, indt+8) = 0.0_8
        funbb = funbb + rmu(3, 0)**2*zb(indorbp, indt+7)
        rmub(3, 0) = rmub(3, 0) + funb*2*rmu(3, 0)*zb(indorbp, indt+7)
        funb0 = zb(indorbp, indt+7)
        zb(indorbp, indt+7) = 0.0_8
        funbb = funbb + rmu(2, 0)**2*zb(indorbp, indt+6)
        rmub(2, 0) = rmub(2, 0) + funb*2*rmu(2, 0)*zb(indorbp, indt+6)
        funb0 = funb0 + zb(indorbp, indt+6)
        zb(indorbp, indt+6) = 0.0_8
        funbb = funbb + rmu(1, 0)**2*zb(indorbp, indt+5)
        rmub(1, 0) = rmub(1, 0) + funb*2*rmu(1, 0)*zb(indorbp, indt+5)
        temp45b0 = funbb/r(0)**2
        funb0 = funb0 + zb(indorbp, indt+5) - temp45b0
        zb(indorbp, indt+5) = 0.0_8
        fun2b = temp45b0
        rb(0) = rb(0) - (fun2-fun)*2*temp45b0/r(0)
      ELSE
        funb0 = 0.0_8
        fun2b = 0.0_8
      END IF
      funb0 = funb0 + 2.d0*zb(indorbp, indt+4)
      fun2b = fun2b + zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp45b = -(fun*2.d0*fun2b)
      funb0 = funb0 + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp45b - 2.d0*distp(0, 1)*funb0
      rb(0) = rb(0) + dd1*2*r(0)*temp45b
      distpb = 0.0_8
      distpb(0, 1) = -(2.d0*dd1*funb0)
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp44 = r(k)**2
      temp44b5 = c*DEXP(-(dd1*temp44))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp44))*distpb(k, 1)
      dd1b = dd1b - temp44*temp44b5
      rb(k) = rb(k) - dd1*2*r(k)*temp44b5
      distpb(k, 1) = 0.0_8
    END DO
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) dd1b = dd1b + 0.71270547035499016d0*0.75d0*&
&        dd1**(-0.25D0)*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (2200:2299) 
!     d gaussian  -r**(2*(npower+1))*exp(-alpha*r**2) derivative 1200
    npower = iopt + 1 - 2200
!        indorbp=indorb
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -(r(k)**(2*npower)*DEXP(-(dd2*r(k)**2)))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun0 = distp(0, 1)
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      fun2 = (npower*(2.d0*npower-1.d0)-(1.d0+4.d0*npower)*dd2*rp1+2.d0*&
&        (dd2*rp1)**2)*distp(0, 1)*2.d0/rp1
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp49b6 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 6.d0*temp49b6
        fun2b = fun2b + temp49b6
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp49b2 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp49b2
                  fun0b = fun0b + rmu(i, 0)*temp49b2
                ELSE
                  temp49b3 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp49b3
                  fun0b = fun0b + rmu(i, 0)*temp49b3
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp49b4 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp49b4
                fun0b = fun0b + rmu(i, 0)*temp49b4
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp49b5 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp49b5
                fun0b = fun0b + rmu(i, 0)*temp49b5
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp49b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp49b1
          funb0 = funb0 + rmu(i, 0)*temp49b1
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp48 = distp(0, 1)/rp1
      temp49b = 2.d0*temp48*fun2b
      temp49b0 = -((npower*4.d0+1.d0)*temp49b)
      temp48b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp47 = distp(0, 1)/rp1
      temp48b0 = 2.d0*temp47*funb0
      dd2b = rp1*temp49b0 - rp1*temp48b0 + 2.d0*rp1**2*2*dd2*temp49b
      temp47b = 2.d0*(npower-dd2*rp1)*funb0/rp1
      rp1b = dd2*temp49b0 - temp47*temp47b - temp48*temp48b - dd2*&
&        temp48b0 + 2.d0*dd2**2*2*rp1*temp49b
      distpb(0, 1) = distpb(0, 1) + temp47b + fun0b + temp48b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 1+ic) = distpb(i, 1+ic) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + distp(i, 1+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp46 = r(k)**2
      temp45 = 2*npower
      temp45b1 = -(r(k)**temp45*DEXP(-(dd2*temp46))*distpb(k, 1))
      IF (r(k) .LE. 0.0 .AND. (temp45 .EQ. 0.0 .OR. temp45 .NE. INT(&
&          temp45))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp45b1
      ELSE
        rb(k) = rb(k) - dd2*2*r(k)*temp45b1 - DEXP(-(dd2*temp46))*temp45&
&          *r(k)**(temp45-1)*distpb(k, 1)
      END IF
      dd2b = dd2b - temp46*temp45b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (55) 
! g single Slater orbital
! R(r)= exp(-alpha r)
! normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization
! l = 4
! \int d\omega Y*Y = 4 pi / (2 l + 1)
! \int dr r^{2 l + 2} Exp [- 2 dd1 r^2 ] =  7 * 5**2 * 3**4 / 2**3 / dd1**11
!        c=1.d0/dsqrt(7.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(11.d0/2.d0)/3.d0/5.d0
    c = dd1**5.5d0*.020104801169736915d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(dd1*distp(0, 1)/r(0))
      fun2 = dd1**2*distp(0, 1)
!              indorbp=indorb
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
          ELSE IF (ic .EQ. 7) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            END IF
          ELSE IF (ic .EQ. 8) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
          ELSE IF (ic .EQ. 9) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp50b55 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb0 = funb0 + 10.d0*temp50b55
        fun2b = fun2b + temp50b55
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 15) THEN
            IF (branch .LT. 8) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    temp50b0 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2)-&
&                      60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp50b0
                    rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp50b0
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0&
&                      )*temp50b0
                  ELSE
                    temp50b1 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-&
&                      60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp50b1
                    rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp50b1
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0&
&                      )*temp50b1
                  END IF
                ELSE IF (branch .LT. 4) THEN
                  temp50b2 = cost1g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(rmu(&
&                    3, 0)*r(0)**2))*zb(indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*&
&                    r(0)**2)*temp50b2
                  rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp50b2
                ELSE
                  temp50b3 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*&
&                    rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp50b3
                  rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp50b3
                  rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp50b3
                END IF
              ELSE IF (branch .LT. 7) THEN
                IF (branch .LT. 6) THEN
                  temp50b4 = -(cost2g*6.d0*zb(indorbp, indt+i))
                  temp50b5 = rmu(2, 0)*rmu(3, 0)*temp50b4
                  temp50b6 = fun0*rmu(1, 0)*temp50b4
                  fun0b = fun0b + rmu(1, 0)*temp50b5
                  rmub(1, 0) = rmub(1, 0) + fun0*temp50b5
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp50b6
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp50b6
                ELSE
                  temp50b7 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp50b8 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)**&
&                    2)*temp50b7
                  temp50b9 = fun0*rmu(1, 0)*temp50b7
                  fun0b = fun0b + rmu(1, 0)*temp50b8
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp50b9 + fun0*&
&                    temp50b8
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp50b9
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp50b9
                END IF
              ELSE
                temp50b10 = -(cost2g*6.d0*zb(indorbp, indt+i))
                temp50b11 = rmu(2, 0)*rmu(3, 0)*temp50b10
                temp50b12 = fun0*rmu(1, 0)*temp50b10
                fun0b = fun0b + rmu(1, 0)*temp50b11
                rmub(1, 0) = rmub(1, 0) + fun0*temp50b11
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp50b12
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp50b12
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  temp50b13 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*&
&                    rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp50b13
                  rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp50b13
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp50b13
                ELSE
                  temp50b14 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp50b15 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp50b14
                  temp50b16 = fun0*rmu(2, 0)*temp50b14
                  fun0b = fun0b + rmu(2, 0)*temp50b15
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp50b16 + fun0&
&                    *temp50b15
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp50b16
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp50b16
                END IF
              ELSE IF (branch .LT. 11) THEN
                temp50b17 = -(cost3g*4.d0*zb(indorbp, indt+i))
                temp50b18 = fun0*temp50b17
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*temp50b17
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp50b18
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp50b18
              ELSE
                temp50b19 = cost3g*4.d0*zb(indorbp, indt+i)
                temp50b20 = fun0*temp50b19
                fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)&
&                  **2))*temp50b19
                rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp50b20
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp50b20
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                temp50b21 = cost3g*12.d0*zb(indorbp, indt+i)
                temp50b22 = fun0*rmu(3, 0)*temp50b21
                temp50b23 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp50b21
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp50b22
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp50b22
                fun0b = fun0b + rmu(3, 0)*temp50b23
                rmub(3, 0) = rmub(3, 0) + fun0*temp50b23
              ELSE
                temp50b24 = -(cost3g*2.d0*zb(indorbp, indt+i))
                temp50b25 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3, &
&                  0)**2)*temp50b24
                temp50b26 = fun0*rmu(2, 0)*temp50b24
                fun0b = fun0b + rmu(2, 0)*temp50b25
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp50b26 + fun0*&
&                  temp50b25
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp50b26
                rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp50b26
              END IF
            ELSE
              temp50b27 = -(cost3g*2.d0*zb(indorbp, indt+i))
              temp50b28 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0)&
&                **2)*temp50b27
              temp50b29 = fun0*rmu(1, 0)*temp50b27
              fun0b = fun0b + rmu(1, 0)*temp50b28
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp50b29 + fun0*&
&                temp50b28
              rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp50b29
              rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp50b29
            END IF
          ELSE IF (branch .LT. 22) THEN
            IF (branch .LT. 19) THEN
              IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  temp50b30 = cost3g*24.d0*zb(indorbp, indt+i)
                  temp50b31 = rmu(2, 0)*rmu(3, 0)*temp50b30
                  temp50b32 = fun0*rmu(1, 0)*temp50b30
                  fun0b = fun0b + rmu(1, 0)*temp50b31
                  rmub(1, 0) = rmub(1, 0) + fun0*temp50b31
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp50b32
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp50b32
                ELSE
                  temp50b33 = cost4g*3.d0*zb(indorbp, indt+i)
                  temp50b34 = fun0*rmu(3, 0)*temp50b33
                  temp50b35 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp50b33
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp50b34
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp50b34
                  fun0b = fun0b + rmu(3, 0)*temp50b35
                  rmub(3, 0) = rmub(3, 0) + fun0*temp50b35
                END IF
              ELSE IF (branch .LT. 18) THEN
                temp50b36 = -(cost4g*6.d0*zb(indorbp, indt+i))
                temp50b37 = rmu(2, 0)*rmu(3, 0)*temp50b36
                temp50b38 = fun0*rmu(1, 0)*temp50b36
                fun0b = fun0b + rmu(1, 0)*temp50b37
                rmub(1, 0) = rmub(1, 0) + fun0*temp50b37
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp50b38
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp50b38
              ELSE
                temp50b39 = cost4g*fun0*zb(indorbp, indt+i)
                fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu&
&                  (2, 0)**2))*zb(indorbp, indt+i)
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp50b39
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp50b39
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                temp50b40 = cost4g*6.d0*zb(indorbp, indt+i)
                temp50b41 = rmu(2, 0)*rmu(3, 0)*temp50b40
                temp50b42 = fun0*rmu(1, 0)*temp50b40
                fun0b = fun0b + rmu(1, 0)*temp50b41
                rmub(1, 0) = rmub(1, 0) + fun0*temp50b41
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp50b42
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp50b42
              ELSE
                temp50b43 = cost4g*3.d0*zb(indorbp, indt+i)
                temp50b44 = fun0*rmu(3, 0)*temp50b43
                temp50b45 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp50b43
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp50b44
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp50b44
                fun0b = fun0b + rmu(3, 0)*temp50b45
                rmub(3, 0) = rmub(3, 0) + fun0*temp50b45
              END IF
            ELSE
              temp50b46 = cost4g*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(&
&                2, 0)**3)*zb(indorbp, indt+i)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp50b46
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp50b46
            END IF
          ELSE IF (branch .LT. 26) THEN
            IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                temp50b47 = cost5g*4.d0*zb(indorbp, indt+i)
                temp50b48 = fun0*temp50b47
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp50b47
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp50b48
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp50b48
              END IF
            ELSE IF (branch .LT. 25) THEN
              temp50b49 = cost5g*4.d0*zb(indorbp, indt+i)
              temp50b50 = fun0*temp50b49
              fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)&
&                ))*temp50b49
              rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**&
&                2)*temp50b50
              rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp50b50
            END IF
          ELSE IF (branch .LT. 28) THEN
            IF (branch .LT. 27) THEN
              temp50b51 = cost5g*4.d0*zb(indorbp, indt+i)
              temp50b52 = fun0*temp50b51
              fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**&
&                3)*temp50b51
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp50b52
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp50b52
            END IF
          ELSE
            temp50b53 = cost5g*4.d0*zb(indorbp, indt+i)
            temp50b54 = fun0*temp50b53
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp50b53
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp50b54
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp50b54
          END IF
          temp50b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp50b
          funb0 = funb0 + rmu(i, 0)*temp50b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp49b26 = -(distp(0, 1)*funb0/r(0))
      dd1b = temp49b26 + distp(0, 1)*2*dd1*fun2b
      temp49 = dd1/r(0)
      distpb(0, 1) = distpb(0, 1) + fun0b - temp49*funb0 + dd1**2*fun2b
      rb(0) = rb(0) - temp49*temp49b26
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp49b8 = cost5g*4.d0*distpb(i, 10)
      temp49b9 = (rmu(1, i)**2-rmu(2, i)**2)*temp49b8
      temp49b10 = rmu(1, i)*rmu(2, i)*temp49b8
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp49b10 + rmu(2, i)*&
&        temp49b9
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp49b9 - 2*rmu(2, i)*&
&        temp49b10
      distpb(i, 10) = 0.0_8
      temp49b11 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp49b11
      distpb(i, 9) = 0.0_8
      temp49b12 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp49b13 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp49b12 - 2*rmu(2, i)*&
&        temp49b13 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp49b11
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp49b12
      distpb(i, 8) = 0.0_8
      temp49b14 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp49b15 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp49b14 + 2*rmu(1, i)*&
&        temp49b15 + 3.d0*2*rmu(1, i)*temp49b13
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp49b14
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp49b15
      distpb(i, 7) = 0.0_8
      temp49b16 = cost3g*2.d0*distpb(i, 6)
      temp49b17 = (7.d0*rmu(3, i)**2-r(i)**2)*temp49b16
      temp49b18 = rmu(1, i)*rmu(2, i)*temp49b16
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp49b17
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp49b17
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp49b18
      distpb(i, 6) = 0.0_8
      temp49b19 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp49b20 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp49b21 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp49b22 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp49b23 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp49b24 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp49b25 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp49b25 - 3.d0*2*r(i)*temp49b24 - 2*r(i)*temp49b20 - 3.d0*2*r(&
&        i)*temp49b22 - 2*r(i)*temp49b18
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp49b19
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp49b19
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp49b20
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp49b21
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp49b22 + rmu(2, i)*&
&        temp49b21
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp49b23
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp49b25 + 7.d0*2*rmu(3, i)*temp49b24 + rmu(1, i)*&
&        temp49b23
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp49b7 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp49b7
      rb(k) = rb(k) - dd1*temp49b7
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .020104801169736915d0*5.5d0*dd1**4.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (2) 
!
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = (zeta(1)-dd1)/(dd2-zeta(1))
!           if(iflagnorm.gt.2) then
    c = 1.d0/2.d0/DSQRT(2.d0*pi*(1.d0/(2.d0*dd1)**3+2.d0*peff/(dd1+dd2)&
&      **3+peff**2/(2.d0*dd2)**3))
!           endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = (-(dd1*distp(0, 1))-dd2*distp(0, 2)*peff)/r(0)
      distpb = 0.0_8
      temp57 = dd1/r(0)
      temp57b = -(distp(0, 1)*2.d0*zb(indorbp, indt+4)/r(0))
      temp57b0 = peff*distp(0, 2)*zb(indorbp, indt+4)
      temp56 = dd2/r(0)
      temp56b2 = -(2.d0*temp57b0/r(0))
      temp56b3 = (dd2**2-2.d0*temp56)*zb(indorbp, indt+4)
      dd1b = temp57b + distp(0, 1)*2*dd1*zb(indorbp, indt+4)
      rb(0) = rb(0) - temp56*temp56b2 - temp57*temp57b
      distpb(0, 1) = (dd1**2-2.d0*temp57)*zb(indorbp, indt+4)
      dd2b = temp56b2 + 2*dd2*temp57b0
      peffb = distp(0, 2)*temp56b3
      distpb(0, 2) = peff*temp56b3
      zb(indorbp, indt+4) = 0.0_8
      funb0 = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp56b1 = funb0/r(0)
      dd1b = dd1b - distp(0, 1)*temp56b1
      distpb(0, 1) = distpb(0, 1) - dd1*temp56b1
      distpb(0, 2) = distpb(0, 2) - dd2*peff*temp56b1
      dd2b = dd2b - distp(0, 2)*peff*temp56b1
      peffb = peffb - distp(0, 2)*dd2*temp56b1
      rb(0) = rb(0) - (-(dd1*distp(0, 1))-distp(0, 2)*(dd2*peff))*&
&        temp56b1/r(0)
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      peffb = peffb + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + peff*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp56b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp56b
      distpb(k, 2) = 0.0_8
      temp56b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp56b0 - dd2*temp56b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp56b0
      distpb(k, 1) = 0.0_8
    END DO
    temp55 = 2.d0**3*dd2**3
    temp54 = peff**2/temp55
    temp53 = (dd1+dd2)**3
    temp52 = 2.d0**3*dd1**3
    temp51 = 2.d0*pi*(1.0/temp52+2.d0*peff/temp53+temp54)
    temp50 = DSQRT(temp51)
    IF (temp51 .EQ. 0.0) THEN
      temp50b56 = 0.0
    ELSE
      temp50b56 = -(pi*cb/(temp50**2*2.D0*DSQRT(temp51)))
    END IF
    temp50b57 = 2.d0*temp50b56/temp53
    temp50b58 = -(peff*3*(dd1+dd2)**2*temp50b57/temp53)
    peffb = peffb + 2*peff*temp50b56/temp55 + temp50b57
    temp50b59 = peffb/(dd2-zeta(1))
    dd1b = dd1b + temp50b58 - temp50b59 - 2.d0**3*3*dd1**2*temp50b56/&
&      temp52**2
    dd2b = dd2b + temp50b58 - temp54*2.d0**3*3*dd2**2*temp50b56/temp55 -&
&      (zeta(1)-dd1)*temp50b59/(dd2-zeta(1))
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (23) 
! 1s double Z NO CUSP
!      3p without cusp condition
!      r ( e^{-z2 r } + z1 e^{-z3 r } )
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    dd3 = dd(indpar+3)
!        if(iflagnorm.gt.2) then
    c = 1.d0/2.d0/DSQRT(240.d0*pi*(1.d0/(2.d0*dd1)**7+2.d0*dd3/(dd1+dd2)&
&      **7+dd3**2/(2.d0*dd2)**7))
!        endif
!
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
!
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = r(i)*(distp(i, 1)+dd3*distp(i, 2))
    END DO
!
!        indorbp=indorb
!
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
!
!
    IF (typec .NE. 1) THEN
      fun = (1.d0-dd1*r(0))*distp(0, 1) + dd3*(1.d0-dd2*r(0))*distp(0, 2&
&        )
      fun2 = dd1*(dd1*r(0)-2.d0)*distp(0, 1) + dd3*dd2*(dd2*r(0)-2.d0)*&
&        distp(0, 2)
!
!              indorbp=indorb
!
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp67 = fun/r(0)
        temp68b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp67b = 4.d0*temp68b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp67+fun2)*zb(indorbp, indt+&
&          4)
        funb0 = funb0 + temp67b
        rb(0) = rb(0) - temp67*temp67b
        fun2b = fun2b + temp68b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp66 = fun/r(0)
          temp66b8 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp66*rmu(i, 0)*zb(indorbp, indt+&
&            i)
          rmub(i, 0) = rmub(i, 0) + temp66*rmu(ic, 0)*zb(indorbp, indt+i&
&            )
          funb0 = funb0 + temp66b8
          rb(0) = rb(0) - temp66*temp66b8
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp66b2 = dd1*distp(0, 1)*fun2b
      temp66b3 = (dd1*r(0)-2.d0)*fun2b
      temp66b4 = (dd2*r(0)-2.d0)*fun2b
      temp66b5 = dd3*dd2*distp(0, 2)*fun2b
      dd1b = distp(0, 1)*temp66b3 - distp(0, 1)*r(0)*funb0 + r(0)*&
&        temp66b2
      temp66b6 = dd3*distp(0, 2)*funb0
      rb(0) = rb(0) + dd2*temp66b5 - dd2*temp66b6 - distp(0, 1)*dd1*&
&        funb0 + dd1*temp66b2
      distpb(0, 1) = dd1*temp66b3
      temp66b7 = (1.d0-dd2*r(0))*funb0
      dd3b = distp(0, 2)*temp66b7 + distp(0, 2)*dd2*temp66b4
      dd2b = r(0)*temp66b5 - r(0)*temp66b6 + distp(0, 2)*dd3*temp66b4
      distpb(0, 2) = dd3*dd2*temp66b4
      distpb(0, 1) = distpb(0, 1) + (1.d0-dd1*r(0))*funb0
      distpb(0, 2) = distpb(0, 2) + dd3*temp66b7
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      temp66b1 = r(i)*distpb(i, 3)
      rb(i) = rb(i) + (distp(i, 1)+dd3*distp(i, 2))*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + temp66b1
      dd3b = dd3b + distp(i, 2)*temp66b1
      distpb(i, 2) = distpb(i, 2) + dd3*temp66b1
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp66b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp66b
      distpb(k, 2) = 0.0_8
      temp66b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp66b0 - dd2*temp66b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp66b0
      distpb(k, 1) = 0.0_8
    END DO
    temp65 = 2.d0**7
    temp64 = temp65*dd2**7
    temp63 = dd3**2/temp64
    temp62 = (dd1+dd2)**7
    temp61 = 2.d0**7
    temp60 = temp61*dd1**7
    temp59 = 240.d0*pi*(1.0/temp60+2.d0*dd3/temp62+temp63)
    temp58 = DSQRT(temp59)
    IF (temp59 .EQ. 0.0) THEN
      temp58b = 0.0
    ELSE
      temp58b = -(pi*240.d0*cb/(2.d0*temp58**2*2.D0*DSQRT(temp59)))
    END IF
    temp58b0 = 2.d0*temp58b/temp62
    temp58b1 = -(dd3*7*(dd1+dd2)**6*temp58b0/temp62)
    dd1b = dd1b + temp58b1 - temp61*7*dd1**6*temp58b/temp60**2
    dd3b = dd3b + 2*dd3*temp58b/temp64 + temp58b0
    dd2b = dd2b + temp58b1 - temp63*temp65*7*dd2**6*temp58b/temp64
    ddb(indpar+3) = ddb(indpar+3) + dd3b
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (80) 
! 4p single zeta
! R(r)=exp(-z*r**2) single zeta
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = DSQRT(dd1)
!           if(iflagnorm.gt.2) then
!           c=(2.d0*dd1/pi)**(3.d0/4.d0)*ratiocs
!           ratiocs--> ratiocs*(2/pi)**3/4
    c = dd1**0.75d0*ratiocs
!           endif
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    IF (typec .NE. 1) THEN
! the first derivative /r
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = -(dd1*distp(0, 1)*(2.d0+rp2)/rp3)
! the second derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp71 = rp3**2
      temp70b = (4.d0*rp1-2.d0*rp2+4.d0*(rp1*rp2)+rp1**2-2.d0)*fun2b/&
&        temp71
      temp70 = dd1*distp(0, 1)/temp71
      temp70b0 = temp70*fun2b
      rp1b = (2*rp1+4.d0*rp2+4.d0)*temp70b0
      temp69b0 = -(distp(0, 1)*(rp2+2.d0)*funb0/rp3)
      dd1b = temp69b0 + r(0)**2*rp1b + distp(0, 1)*temp70b
      temp69 = dd1/rp3
      distpb(0, 1) = dd1*temp70b - temp69*(rp2+2.d0)*funb0
      rp3b = -(temp69*temp69b0) - temp70*2*rp3*temp70b
      rp2b = 2*(rp2+1.d0)*rp3b - temp69*distp(0, 1)*funb0 + (4.d0*rp1-&
&        2.d0)*temp70b0
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp68 = dd2*r(k) + 1.d0
      temp69b = costb/temp68
      temp68b0 = -(dd1*r(k)**2*temp69b/temp68)
      dd1b = dd1b + r(k)**2*temp69b
      rb(k) = rb(k) + dd2*temp68b0 + dd1*2*r(k)*temp69b
      dd2b = dd2b + r(k)*temp68b0
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocs*0.75d0*dd1**(-0.25D0)*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocs*0.75d0*dd1**(&
&        -0.25D0)*cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (17) 
! 2s gaussian for pseudo
! R(r)=r**2*exp(-z*r**2) single zeta
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!        c=4.d0*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)/dsqrt(15.d0)
    c = .73607904464954686606d0*dd1**1.75d0
!           endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
!              the first derivative / r
      fun = 2.d0*distp(0, 1)*(1.d0-dd1*rp1)
!              the second derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp73b = 2.d0*distp(0, 1)*fun2b
      distpb(0, 1) = 2.d0*(1.d0-dd1*rp1)*funb0 + 2.d0*(2.d0*(dd1**2*rp1&
&        **2)-5.d0*(dd1*rp1)+1.d0)*fun2b
      temp73b0 = 2.d0*distp(0, 1)*funb0
      dd1b = (2.d0*rp1**2*2*dd1-5.d0*rp1)*temp73b - rp1*temp73b0
      rp1b = (2.d0*dd1**2*2*rp1-5.d0*dd1)*temp73b - dd1*temp73b0
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp72 = r(k)**2
      temp72b = c*DEXP(-(dd1*temp72))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp72))*distpb(k, 1)
      dd1b = dd1b - temp72*temp72b
      rb(k) = rb(k) - dd1*2*r(k)*temp72b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .73607904464954686606d0*1.75d0*dd1**0.75D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (10) 
! 2s gaussian for pseudo
! s orbital
! 
! - angmom = 0
! - type = Slater
! - normalized = yes
! - angtype = spherical
! - npar = 1
! - multiplicity = 1
!
! = N * R
!
! 3s single zeta
! and R is the radial part
! R(r) = r**2*exp(-z1*r)
!
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    c = dd1**3.5d0*0.11894160774351807429d0
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd1*r(0))*distp(0, 1)
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp73b2 = distp(0, 1)*fun2b
      temp73b3 = 2*dd1*r(0)*temp73b2
      dd1b = r(0)*temp73b3 - 4*r(0)*temp73b2 - distp(0, 1)*r(0)*funb0
      rb(0) = rb(0) + dd1*temp73b3 - 4*dd1*temp73b2 - distp(0, 1)*dd1*&
&        funb0
      distpb(0, 1) = (2.d0-dd1*r(0))*funb0 + ((dd1*r(0))**2-4*(dd1*r(0))&
&        +2.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp73b1 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp73b1
      rb(k) = rb(k) - dd1*temp73b1
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.11894160774351807429d0*3.5d0*dd1**2.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (129) 
!     2p single exponential  r e^{-z r}  ! parent of 121
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(1.d0-dd2*r(0))/r(0)
      fun2 = dd2*(dd2*r(0)-2.d0)*distp(0, 1)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp74b2 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp74b2
        fun2b = fun2b + temp74b2
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp74b1 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp74b1
          funb0 = funb0 + rmu(ic, 0)*temp74b1
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp74b = dd2*distp(0, 1)*fun2b
      temp74b0 = (dd2*r(0)-2.d0)*fun2b
      temp73 = distp(0, 1)/r(0)
      dd2b = distp(0, 1)*temp74b0 - temp73*r(0)*funb0 + r(0)*temp74b
      temp73b6 = (1.d0-dd2*r(0))*funb0/r(0)
      rb(0) = rb(0) + distp(0, 1)*fun0b - temp73*dd2*funb0 - temp73*&
&        temp73b6 + dd2*temp74b
      distpb(0, 1) = temp73b6 + r(0)*fun0b + dd2*temp74b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp73b5 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*r(i)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + r(i)*temp73b5
        rb(i) = rb(i) + distp(i, 1)*temp73b5
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp73b4 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp73b4
      rb(k) = rb(k) - dd2*temp73b4
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (110) 
!     2s without cusp condition
!     dd1*( dd3 +1/(1+dd2*r^3))
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)**3)
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)**2*3.d0*r(0))
      fun2b = zb(indorbp, indt+4)
      funb0 = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp75 = r(0)**3
      temp75b = (2.d0-4.d0*(dd2*temp75))*fun2b
      temp75b0 = -(fun*distp(0, 1)*4.d0*fun2b)
      funb0 = funb0 + distp(0, 1)*temp75b
      distpb(0, 1) = fun*temp75b - 3.d0*dd2*r(0)*2*distp(0, 1)*funb0
      temp75b1 = -(3.d0*distp(0, 1)**2*funb0)
      dd2b = r(0)*temp75b1 + temp75*temp75b0
      rb(0) = rb(0) + dd2*temp75b1 + dd2*3*r(0)**2*temp75b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp74 = r(k)**3
      temp74b3 = -(distpb(k, 1)/(dd2*temp74+1.d0)**2)
      dd2b = dd2b + temp74*temp74b3
      rb(k) = rb(k) + dd2*3*r(k)**2*temp74b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (46) 
! R(r)=c*r**2*exp(-z*r**2)*(7/4/z-r**2)
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
    c = 4.d0*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)/DSQRT(15.d0)
!           endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
!              the first derivative / r
      fun = distp(0, 1)*(7.d0-15.d0*dd1*rp1+4.d0*(dd1*rp1)**2)/2.d0/dd1
!              the second derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp82 = 2.d0*dd1
      temp81 = distp(0, 1)/temp82
      temp82b = temp81*fun2b
      temp82b0 = 50*2*dd1*rp1*temp82b
      temp82b1 = -(8*3*dd1**2*rp1**2*temp82b)
      temp81b = (50*(dd1*rp1)**2-59*(dd1*rp1)-8*(dd1*rp1)**3+7.d0)*fun2b&
&        /temp82
      temp80 = 2.d0*dd1
      temp79 = distp(0, 1)/temp80
      temp80b = temp79*funb0
      temp79b = (4.d0*(dd1**2*rp1**2)-15.d0*(dd1*rp1)+7.d0)*funb0/temp80
      dd1b = (4.d0*rp1**2*2*dd1-15.d0*rp1)*temp80b - temp79*2.d0*temp79b&
&        - temp81*2.d0*temp81b + rp1*temp82b1 - 59*rp1*temp82b + rp1*&
&        temp82b0
      rp1b = (4.d0*dd1**2*2*rp1-15.d0*dd1)*temp80b + dd1*temp82b1 - 59*&
&        dd1*temp82b + dd1*temp82b0
      distpb(0, 1) = temp79b + temp81b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp78 = 4.d0*dd1
      temp77 = r(i)**2/temp78
      temp78b = distp(i, 1)*zb(indorbp, i)
      temp77b = 7.d0*temp78b/temp78
      distpb(i, 1) = distpb(i, 1) + (7.d0*temp77-r(i)**4)*zb(indorbp, i)
      rb(i) = rb(i) + 2*r(i)*temp77b - 4*r(i)**3*temp78b
      dd1b = dd1b - temp77*4.d0*temp77b
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp76 = r(k)**2
      temp76b = c*DEXP(-(dd1*temp76))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp76))*distpb(k, 1)
      dd1b = dd1b - temp76*temp76b
      rb(k) = rb(k) - dd1*2*r(k)*temp76b
      distpb(k, 1) = 0.0_8
    END DO
    IF (.NOT.(dd1 .LE. 0.0 .AND. (7.d0/4.d0 .EQ. 0.0 .OR. 7.d0/4.d0 .NE.&
&        INT(7.d0/4.d0)))) dd1b = dd1b + (2.d0/pi)**(3.d0/4.d0)*7.d0*dd1&
&        **(7.d0/4.d0-1)*cb/DSQRT(15.d0)
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (143) 
! 5s single zeta derivative of 12
!     4d  one parmater der of 133
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*r(i)**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!            endif
    IF (typec .NE. 1) THEN
      fun0 = -distp(0, 3)
      fun = -((-2.d0+dd1*r(0))*distp(0, 1))
      fun2 = ((dd1*r(0))**2-4.d0*r(0)*dd1+2.d0)*distp(0, 1)
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp83b7 = distp(0, 3+ic)*zb(indorbp, indt+4)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 6.d0*temp83b7
        fun2b = fun2b + temp83b7
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp83b3 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp83b3
                  fun0b = fun0b + rmu(i, 0)*temp83b3
                ELSE
                  temp83b4 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp83b4
                  fun0b = fun0b + rmu(i, 0)*temp83b4
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp83b5 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp83b5
                fun0b = fun0b + rmu(i, 0)*temp83b5
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp83b6 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp83b6
                fun0b = fun0b + rmu(i, 0)*temp83b6
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp83b2 = distp(0, 3+ic)*zb(indorbp, indt+i)
          distpb(0, 3+ic) = distpb(0, 3+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp83b2
          funb0 = funb0 + rmu(i, 0)*temp83b2
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp83b0 = distp(0, 1)*fun2b
      temp83b1 = 2*dd1*r(0)*temp83b0
      dd1b = r(0)*temp83b1 - 4.d0*r(0)*temp83b0 - distp(0, 1)*r(0)*funb0
      rb(0) = rb(0) + dd1*temp83b1 - 4.d0*dd1*temp83b0 - distp(0, 1)*dd1&
&        *funb0
      distpb(0, 1) = distpb(0, 1) + ((dd1*r(0))**2-4.d0*(r(0)*dd1)+2.d0)&
&        *fun2b - (dd1*r(0)-2.d0)*funb0
      distpb(0, 3) = distpb(0, 3) - fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) - distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) - distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distpb(i, 1) = distpb(i, 1) + r(i)**2*distpb(i, 3)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp83b = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp83b
      rb(k) = rb(k) - dd1*temp83b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (7) 
! normalized IS WRONG!!!
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      distp(k, 2) = DEXP(-(dd2*r(k)))
    END DO
!           if(iflagnorm.gt.2) then
    c = 1/DSQRT(1/(3.d0/4.d0/dd1**5+peff**2/dd2**3/4+12*peff/(dd1+dd2)**&
&      4))*1.d0/DSQRT(4.0*pi)
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1)) + peff*distp(0, 2)*(1.d0-dd2*r(0))
      fun2 = distp(0, 1)*dd1**2 + peff*distp(0, 2)*(dd2**2*r(0)-2.d0*dd2&
&        )
      temp93 = fun/r(0)
      temp93b = c*2.d0*zb(indorbp, indt+4)/r(0)
      cb = (2.d0*temp93+fun2)*zb(indorbp, indt+4)
      funb0 = temp93b
      rb(0) = rb(0) - temp93*temp93b
      fun2b = c*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp92 = rmu(i, 0)/r(0)
        temp92b5 = fun*c*zb(indorbp, indt+i)/r(0)
        funb0 = funb0 + temp92*c*zb(indorbp, indt+i)
        cb = cb + temp92*fun*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + temp92b5
        rb(0) = rb(0) - temp92*temp92b5
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp92b1 = (dd2**2*r(0)-2.d0*dd2)*fun2b
      temp92b2 = peff*distp(0, 2)*fun2b
      distpb(0, 1) = dd1**2*fun2b
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb0
      temp92b3 = (1.d0-dd2*r(0))*funb0
      peffb = distp(0, 2)*temp92b3 + distp(0, 2)*temp92b1
      distpb(0, 2) = peff*temp92b3 + peff*temp92b1
      temp92b4 = peff*distp(0, 2)*funb0
      dd2b = (r(0)*2*dd2-2.d0)*temp92b2 - r(0)*temp92b4
      rb(0) = rb(0) + dd2**2*temp92b2 - dd2*temp92b4
      distpb(0, 1) = distpb(0, 1) - dd1*funb0
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      cb = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp92b = c*zb(indorbp, i)
      temp92b0 = distp(i, 2)*temp92b
      cb = cb + (distp(i, 1)+r(i)*peff*distp(i, 2))*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp92b
      rb(i) = rb(i) + peff*temp92b0
      peffb = peffb + r(i)*temp92b0
      distpb(i, 2) = distpb(i, 2) + r(i)*peff*temp92b
      zb(indorbp, i) = 0.0_8
    END DO
    temp91 = (dd1+dd2)**4
    temp90 = 4*dd2**3
    temp89 = peff**2/temp90
    temp88 = 4.d0*dd1**5
    temp83 = 3.d0/temp88 + temp89 + 12*(peff/temp91)
    temp87 = 1.0/temp83
    temp86 = DSQRT(temp87)
    temp85 = DSQRT(4.0*pi)
    temp84 = temp85*temp86
    IF (temp87 .EQ. 0.0) THEN
      temp83b10 = 0.0
    ELSE
      temp83b10 = temp85*temp87*cb/(temp84**2*2.D0*DSQRT(temp87)*temp83)
    END IF
    temp83b11 = 12*temp83b10/temp91
    temp83b12 = -(peff*4*(dd1+dd2)**3*temp83b11/temp91)
    dd1b = dd1b + temp83b12 - 3.d0*4.d0*5*dd1**4*temp83b10/temp88**2
    peffb = peffb + temp83b11 + 2*peff*temp83b10/temp90
    dd2b = dd2b + temp83b12 - temp89*4*3*dd2**2*temp83b10/temp90
    DO k=indtm,indtmin,-1
      temp83b8 = DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp83b8
      distpb(k, 2) = 0.0_8
      temp83b9 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp83b9 - dd2*temp83b8
      dd1b = dd1b - r(k)*temp83b9
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (36) 
! 2s double Z WITH CUSP
! p orbital
! 
! - angmom = 1
! - type = Gaussian
! - normalized = yes
! - angtype = spherical
! - npar = 1
! - multiplicity = 3
!
    dd1 = dd(indpar+1)
    c = dd1**1.25d0*1.42541094070998d0
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb + ic
    END DO
    IF (typec .NE. 1) THEN
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb + ic
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp95b1 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp95b1
        fun2b = fun2b + temp95b1
        zb(indorbp, indt+4) = 0.0_8
        fun0b = fun0b + zb(indorbp, indt+ic)
        DO i=3,1,-1
          temp95b0 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp95b0
          funb0 = funb0 + rmu(ic, 0)*temp95b0
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp95b = -(fun*2.d0*fun2b)
      funb0 = funb0 + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp95b - 2.d0*distp(0, 1)*funb0
      rb(0) = rb(0) + dd1*2*r(0)*temp95b
      distpb = 0.0_8
      distpb(0, 1) = fun0b - 2.d0*dd1*funb0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp94 = r(k)**2
      temp94b = c*DEXP(-(dd1*temp94))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp94))*distpb(k, 1)
      dd1b = dd1b - temp94*temp94b
      rb(k) = rb(k) - dd1*2*r(k)*temp94b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.42541094070998d0*1.25d0*dd1**0.25D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (29) 
! derivative of (28)
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!             if(dd1.gt.0.) then
    c = cost1s*dd1**1.5d0
!             else
!               c=1.d0
!             endif
!           endif
!             if(dd1.gt.0.) then
    c1 = 1.5d0/dd1
!             else
!               c1=0.d0
!             endif
    DO i=indtmin,indtm
      distp(i, 1) = c*DEXP(-(dd1*r(i)))
    END DO
    DO i=i0,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
!              rp1=(b1s*r(i))**4*dd1**3
!              rp4=rp1*dd1
!              rp5=dd1*r(i)
!              z(indorbp,i)=distp(i,1)*                          &
!                                                            &(c1*rp4/(1+rp4)-rp1*(-4+rp5+rp4*rp5)/(1+rp4)**2)
      rp4 = (b1s*dd1*r(i))**4
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp5)
      rp5 = dd1*r(i)
    END DO
    IF (typec .NE. 1) THEN
      rp1 = dd1*b1s*r(0)
      rp2 = rp1**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = rp2**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp5)
      rp5 = rp4*rp1
      rp8 = rp4*rp4
      fun = distp(0, 1)*(dd1*rp2*(4*b1s**2*(11-5*rp4)+2*(rp1+rp5)**2-b1s&
&        *rp1*(21+26*rp4+5*rp8)))/(2.*(1+rp4)**3)
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp108 = 2.*b1s*(rp4+1)**4
      temp107 = distp(0, 1)*dd1*rp2
      temp104 = temp107/temp108
      temp107b = temp104*fun2b
      temp107b0 = b1s*(7*rp4+31)*2*(rp1+rp5)*temp107b
      temp107b1 = -(2*3*(rp1+rp5)**2*temp107b)
      temp106 = 64*b1s**2
      temp106b = temp106*temp107b
      temp105 = 4*b1s**3
      temp104b = (b1s*((7*rp4+31)*(rp1+rp5)**2)-2*(rp1+rp5)**3+temp106*(&
&        rp1*(rp8-rp4-2))+temp105*(25*rp8-134*rp4+33))*fun2b/temp108
      temp103 = 2.*(rp4+1)**3
      temp102 = distp(0, 1)*dd1*rp2
      temp99 = temp102/temp103
      temp102b = temp99*funb0
      temp101b = 2**2*(rp1+rp5)*temp102b
      rp5b = temp101b + temp107b1 + temp107b0
      temp100b = -(b1s*temp102b)
      rp8b = rp1*5*temp100b + temp105*25*temp107b + rp1*temp106b
      temp101 = 4*b1s**2
      temp100 = 26*rp4 + 5*rp8 + 21
      temp99b0 = (temp101*(11-5*rp4)+2*(rp1+rp5)**2-b1s*(rp1*temp100))*&
&        funb0/temp103
      rp4b = rp1*26*temp100b - temp101*5*temp102b - temp99*2.*3*(rp4+1)&
&        **2*temp99b0 + rp1*rp5b + 2*rp4*rp8b - temp104*2.*b1s*4*(rp4+1)&
&        **3*temp104b - rp1*temp106b + (7*(b1s*(rp1+rp5)**2)-134*temp105)&
&        *temp107b
      rp2b = distp(0, 1)*dd1*temp99b0 + 2*rp2*rp4b + distp(0, 1)*dd1*&
&        temp104b
      rp1b = temp101b + temp100*temp100b + 2*rp1*rp2b + rp4*rp5b + (rp8-&
&        rp4-2)*temp106b + temp107b1 + temp107b0
      distpb(0, 1) = dd1*rp2*temp99b0 + dd1*rp2*temp104b
      dd1b = distp(0, 1)*rp2*temp99b0 + b1s*r(0)*rp1b + distp(0, 1)*rp2*&
&        temp104b
      CALL POPREAL8(adr8ibuf,adr8buf,rp5)
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      rb(0) = rb(0) + b1s*dd1*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    c1b = 0.0_8
    DO i=indtm,i0,-1
      temp95 = rp4/(rp4+1)
      temp99b = distp(i, 1)*temp95*zb(indorbp, i)
      temp96 = dd1*(rp4+1)
      temp97b = -(temp99b/temp96)
      temp98 = rp5 + rp4*rp5 - 4
      temp97 = temp98/temp96
      temp96b = -(temp97*temp97b)
      temp95b3 = (c1-temp97)*distp(i, 1)*zb(indorbp, i)/(rp4+1)
      c1b = c1b + temp99b
      rp5b = (rp4+1.0_8)*temp97b
      rp4b = (1.0_8-temp95)*temp95b3 + dd1*temp96b + rp5*temp97b
      temp95b4 = 4*b1s**4*dd1**3*r(i)**3*rp4b
      dd1b = dd1b + r(i)*rp5b + r(i)*temp95b4 + (rp4+1)*temp96b
      distpb(i, 1) = distpb(i, 1) + (c1-temp97)*temp95*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp5)
      rb(i) = rb(i) + dd1*temp95b4 + dd1*rp5b
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
    END DO
    cb = 0.0_8
    DO i=indtm,indtmin,-1
      temp95b2 = c*DEXP(-(dd1*r(i)))*distpb(i, 1)
      cb = cb + DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp95b2
      rb(i) = rb(i) - dd1*temp95b2
      distpb(i, 1) = 0.0_8
    END DO
    dd1b = dd1b + cost1s*1.5d0*dd1**0.5D0*cb - 1.5d0*c1b/dd1**2
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (44) 
! R(r)=x*exp(-z*r**2)*(5/4/z-r**2)
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then
!        c=dsqrt(2.d0)*pi**(-0.75d0)*(2.d0*dd1)**1.25d0
    c = dd1**1.25d0*1.42541094070998d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
!        indorbp=indorb
!
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-9.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+15.d0*dd1*r(0)**2-9.d0/&
&        2.d0)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp115b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp115b0
        fun2b = fun2b + temp115b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp115b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp115b
          funb0 = funb0 + rmu(ic, 0)*temp115b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp114 = r(0)**4
      temp114b = distp(0, 1)*fun2b
      temp113 = 4.d0*dd1
      temp112 = 5.d0/temp113
      distpb(0, 1) = (2.d0*(dd1*r(0)**2)-9.d0/2.d0)*funb0 + (temp112-r(0&
&        )**2)*fun0b + (15.d0*(dd1*r(0)**2)-9.d0/2.d0-4.d0*(dd1**2*&
&        temp114))*fun2b
      temp114b0 = distp(0, 1)*2.d0*funb0
      dd1b = r(0)**2*temp114b0 - distp(0, 1)*temp112*4.d0*fun0b/temp113 &
&        + (15.d0*r(0)**2-4.d0*temp114*2*dd1)*temp114b
      rb(0) = rb(0) + dd1*2*r(0)*temp114b0 - distp(0, 1)*2*r(0)*fun0b + &
&        (15.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp114b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp111 = 4.d0*dd1
        temp110 = 5.d0/temp111
        temp110b = (temp110-r(i)**2)*zb(indorbp, i)
        temp110b0 = rmu(ic, i)*distp(i, 1)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp110b
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp110b
        dd1b = dd1b - temp110*4.d0*temp110b0/temp111
        rb(i) = rb(i) - 2*r(i)*temp110b0
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp109 = r(k)**2
      temp109b = c*DEXP(-(dd1*temp109))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp109))*distpb(k, 1)
      dd1b = dd1b - temp109*temp109b
      rb(k) = rb(k) - dd1*2*r(k)*temp109b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.42541094070998d0*1.25d0*dd1**0.25D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (64) 
! derivative of 37 with respect to z
! d orbitals
! R(r)= r exp(-alpha r^2)
! each gaussian term is normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
!        c=8.d0/dsqrt(21.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)
    c = dd1**2.25d0*1.24420067280413253d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
! lz=0
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      rp1 = 2.d0*dd1*r(0)
      rp2 = rp1*r(0)
      fun0 = distp(0, 1)*r(0)
      fun = (1.d0-rp2)*distp(0, 1)/r(0)
      fun2 = distp(0, 1)*rp1*(rp2-3.d0)
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp117b4 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 6.d0*temp117b4
        fun2b = fun2b + temp117b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp117b0 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp117b0
                  fun0b = fun0b + rmu(i, 0)*temp117b0
                ELSE
                  temp117b1 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp117b1
                  fun0b = fun0b + rmu(i, 0)*temp117b1
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp117b2 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp117b2
                fun0b = fun0b + rmu(i, 0)*temp117b2
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp117b3 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp117b3
                fun0b = fun0b + rmu(i, 0)*temp117b3
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp117b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp117b
          funb0 = funb0 + rmu(i, 0)*temp117b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp116 = (-rp2+1.d0)/r(0)
      distpb(0, 1) = distpb(0, 1) + temp116*funb0 + r(0)*fun0b + rp1*(&
&        rp2-3.d0)*fun2b
      temp116b0 = distp(0, 1)*funb0/r(0)
      rp2b = distp(0, 1)*rp1*fun2b - temp116b0
      rp1b = r(0)*rp2b + distp(0, 1)*(rp2-3.d0)*fun2b
      rb(0) = rb(0) + distp(0, 1)*fun0b + 2.d0*dd1*rp1b + rp1*rp2b - &
&        temp116*temp116b0
      dd1b = 2.d0*r(0)*rp1b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        temp116b = distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1) = distpb(k, 1) + r(k)*temp116b
        rb(k) = rb(k) + distp(k, 1)*temp116b
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*r(k)*zb(indorbp&
&          , k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp115 = r(k)**2
      temp115b1 = c*DEXP(-(dd1*temp115))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp115))*distpb(k, 1)
      dd1b = dd1b - temp115*temp115b1
      rb(k) = rb(k) - dd1*2*r(k)*temp115b1
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.24420067280413253d0*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (106) 
!     2s without cusp condition
!     dd1*( dd3 +1/(1+dd2*r^2))
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)*r(k))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)**2*2.d0)
      fun2b = zb(indorbp, indt+4)
      funb0 = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp118b = (1.-3.d0*(dd2*r(0)**2))*fun2b
      temp118b0 = -(fun*distp(0, 1)*3.d0*fun2b)
      funb0 = funb0 + distp(0, 1)*temp118b
      distpb(0, 1) = fun*temp118b - 2.d0*dd2*2*distp(0, 1)*funb0
      dd2b = r(0)**2*temp118b0 - 2.d0*distp(0, 1)**2*funb0
      rb(0) = rb(0) + dd2*2*r(0)*temp118b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp117 = dd2*r(k)**2 + 1.d0
      temp117b5 = -(distpb(k, 1)/temp117**2)
      dd2b = dd2b + r(k)**2*temp117b5
      rb(k) = rb(k) + dd2*2*r(k)*temp117b5
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (71) 
! f single Slater orbital derivative of 70
! R(r)= (9.d0/2.0 1/dd1 - r) * exp(-alpha r)
! normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization
! l = 3
! \int d\omega Y*Y = 4 pi / (2 l + 1)
! \int dr r^{2 l + 2} Exp [- 2 dd1 r^2 ] =  7 * 5 * 3**2 / 2**2 / dd1**9
!        c=1.d0/dsqrt(10.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(9.d0/2.d0)/3.d0
    c = dd1**4.5d0*0.084104417400672d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)*(9.d0/2.d0/dd1-r(0))
      fun = distp(0, 1)*(dd1-11.d0/2.d0/r(0))
      fun2 = dd1*distp(0, 1)*(13.d0/2.d0-dd1*r(0))
!              indorbp=indorb
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp124b25 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 8.d0*temp124b25
        fun2b = fun2b + temp124b25
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp124b4 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp124b4
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp124b4
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp124b4
                  END IF
                  temp124b2 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp124b3 = rmu(i, 0)*temp124b2
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp124b2
                  fun0b = fun0b + rmu(3, 0)*temp124b3
                  rmub(3, 0) = rmub(3, 0) + fun0*temp124b3
                  GOTO 100
                ELSE
                  temp124b7 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp124b7
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp124b7
                  rb(0) = rb(0) - fun0*2*r(0)*temp124b7
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp124b8 = cost2f*10.d0*zb(indorbp, indt+i)
                temp124b9 = rmu(i, 0)*temp124b8
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp124b8
                fun0b = fun0b + rmu(1, 0)*temp124b9
                rmub(1, 0) = rmub(1, 0) + fun0*temp124b9
              END IF
              temp124b5 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp124b6 = rmu(i, 0)*temp124b5
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp124b5
              fun0b = fun0b + rmu(1, 0)*temp124b6
              rmub(1, 0) = rmub(1, 0) + fun0*temp124b6
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp124b12 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp124b12
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp124b12
                  rb(0) = rb(0) - fun0*2*r(0)*temp124b12
                END IF
              ELSE
                temp124b13 = cost2f*10.d0*zb(indorbp, indt+i)
                temp124b14 = rmu(i, 0)*temp124b13
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp124b13
                fun0b = fun0b + rmu(2, 0)*temp124b14
                rmub(2, 0) = rmub(2, 0) + fun0*temp124b14
              END IF
              temp124b10 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp124b11 = rmu(i, 0)*temp124b10
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp124b10
              fun0b = fun0b + rmu(2, 0)*temp124b11
              rmub(2, 0) = rmub(2, 0) + fun0*temp124b11
            ELSE IF (branch .LT. 10) THEN
              temp124b15 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp124b15
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp124b15
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp124b15
            ELSE
              temp124b16 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp124b16
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp124b16
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp124b16
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp124b17 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp124b17
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp124b17
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp124b17
                ELSE
                  temp124b18 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp124b18
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp124b18
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp124b18
                END IF
              ELSE
                temp124b19 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp124b19
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp124b19
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp124b19
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp124b20 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp124b20
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp124b20
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp124b20
            ELSE
              temp124b21 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp124b21
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp124b21
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp124b21
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp124b22 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp124b22
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp124b22
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp124b22
              END IF
            ELSE
              temp124b23 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp124b23
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp124b23
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp124b23
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp124b24 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp124b24
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp124b24
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp124b24
          END IF
 100      temp124b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp124b1
          funb0 = funb0 + rmu(i, 0)*temp124b1
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp124b = (13.d0/2.d0-dd1*r(0))*fun2b
      temp124b0 = dd1*distp(0, 1)*fun2b
      temp121 = 2.d0*dd1
      temp120 = 9.d0/temp121
      dd1b = distp(0, 1)*funb0 - distp(0, 1)*temp120*2.d0*fun0b/temp121 &
&        - r(0)*temp124b0 + distp(0, 1)*temp124b
      temp123 = 2.d0*r(0)
      temp122 = 11.d0/temp123
      distpb(0, 1) = distpb(0, 1) + (dd1-temp122)*funb0 + (temp120-r(0))&
&        *fun0b + dd1*temp124b
      rb(0) = rb(0) + distp(0, 1)*temp122*2.d0*funb0/temp123 - distp(0, &
&        1)*fun0b - dd1*temp124b0
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    dd1b = 0.0_8
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        temp119 = 2.d0*dd1
        temp118 = 9.d0/temp119
        temp118b10 = (temp118-r(k))*zb(indorbp, k)
        temp118b11 = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp118b10
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp118b10
        dd1b = dd1b - temp118*2.d0*temp118b11/temp119
        rb(k) = rb(k) - temp118b11
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp118b2 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp118b2
      distpb(i, 8) = 0.0_8
      temp118b3 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp118b3 + 3.d0*2*rmu(1, i)*&
&        temp118b2
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp118b3
      distpb(i, 7) = 0.0_8
      temp118b4 = cost3f*2.d0*distpb(i, 6)
      temp118b5 = rmu(2, i)*temp118b4
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp118b5
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp118b5
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp118b4
      distpb(i, 6) = 0.0_8
      temp118b6 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp118b6
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp118b6
      temp118b7 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp118b7
      distpb(i, 4) = 0.0_8
      temp118b8 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp118b9 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp118b8 - 3.d0*2*r(i)*temp118b9 - 2*r(i)*&
&        temp118b7
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp118b9 + 5.d0*2*rmu(3, i)*&
&        temp118b8
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp118b1 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp118b1
      rb(k) = rb(k) - dd1*temp118b1
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.084104417400672d0*4.5d0*dd1**3.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (14) 
! 3s -derivative of 34 with respect to dd1
! (1.d0 + dd1 r) * exp(-dd1 * r)   ! normalized
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
!           if(iflagnorm.gt.2) then
!           c=dsqrt(dd1**3.d0/7.d0/pi)
    c = dd1**1.5d0*0.213243618622923d0
    IF (typec .NE. 1) THEN
      fun = -(distp(0, 1)*dd1**2*r(0))
      fun2 = -(distp(0, 1)*dd1**2*(1.d0-dd1*r(0)))
      temp125b = 2.d0*zb(indorbp, indt+4)/r(0)
      cb = fun2*zb(indorbp, indt+4) + fun*temp125b
      funb0 = c*temp125b
      rb(0) = rb(0) - c*fun*temp125b/r(0)
      fun2b = c*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp124 = rmu(i, 0)/r(0)
        temp124b32 = c*fun*zb(indorbp, indt+i)/r(0)
        cb = cb + temp124*fun*zb(indorbp, indt+i)
        funb0 = funb0 + temp124*c*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + temp124b32
        rb(0) = rb(0) - temp124*temp124b32
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp124b29 = -((1.d0-dd1*r(0))*fun2b)
      temp124b30 = -(distp(0, 1)*dd1**2*fun2b)
      temp124b31 = -(dd1**2*funb0)
      distpb(0, 1) = r(0)*temp124b31 + dd1**2*temp124b29
      dd1b = distp(0, 1)*2*dd1*temp124b29 - r(0)*temp124b30 - distp(0, 1&
&        )*r(0)*2*dd1*funb0
      rb(0) = rb(0) + distp(0, 1)*temp124b31 - dd1*temp124b30
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      cb = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp124b27 = c*distp(i, 1)*zb(indorbp, i)
      temp124b28 = (dd1*r(i)+1.d0)*zb(indorbp, i)
      dd1b = dd1b + r(i)*temp124b27
      rb(i) = rb(i) + dd1*temp124b27
      cb = cb + distp(i, 1)*temp124b28
      distpb(i, 1) = distpb(i, 1) + c*temp124b28
      zb(indorbp, i) = 0.0_8
    END DO
    dd1b = dd1b + 0.213243618622923d0*1.5d0*dd1**0.5D0*cb
    DO k=indtm,indtmin,-1
      temp124b26 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp124b26
      rb(k) = rb(k) - dd1*temp124b26
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (60) 
! 1s single Z pseudo
! R(r)=r**3*exp(-z*r**2) single zeta
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!     c=2.d0/pi**(3.d0/4.d0)*(2.d0*dd1)**(9.d0/4.d0)*dsqrt(2.d0/105.d0)
    c = dd1**2.25d0*.55642345640820284397d0
!           endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))*r(k)
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2*dd1
!              the first derivative / r
      fun = distp(0, 1)*(3.d0-2.d0*rp1)
!              the second derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      distpb(0, 1) = (3.d0-2.d0*rp1)*funb0 + (4.d0*rp1**2-14.d0*rp1+6.d0&
&        )*fun2b
      rp1b = (distp(0, 1)*4.d0*2*rp1-distp(0, 1)*14.d0)*fun2b - distp(0&
&        , 1)*2.d0*funb0
      rb(0) = rb(0) + dd1*2*r(0)*rp1b
      dd1b = r(0)**2*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp125 = r(k)**2
      temp125b0 = c*r(k)*DEXP(-(dd1*temp125))*distpb(k, 1)
      temp125b1 = DEXP(-(dd1*temp125))*distpb(k, 1)
      dd1b = dd1b - temp125*temp125b0
      rb(k) = rb(k) + c*temp125b1 - dd1*2*r(k)*temp125b0
      cb = cb + r(k)*temp125b1
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .55642345640820284397d0*2.25d0*dd1**1.25D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (19) 
! 3s -derivative of 60 with respect to dd1
! R(r)=c*exp(-z*r**2)*(3/4/z-r**2)
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then
!          if(dd1.ne.0.) then
!            c=(2.d0*dd1/pi)**(3.d0/4.d0)
    c = 0.71270547035499016d0*dd1**0.75d0
!          else
!          c=1.d0
!          endif
!         endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    IF (typec .NE. 1) THEN
!              the first derivative /r
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-7.d0/2.d0)
!              the second derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp129 = r(0)**4
      temp129b = distp(0, 1)*fun2b
      distpb(0, 1) = (2.d0*(dd1*r(0)**2)-7.d0/2.d0)*funb0 + (13.d0*(dd1*&
&        r(0)**2)-7.d0/2.d0-4.d0*(dd1**2*temp129))*fun2b
      temp129b0 = distp(0, 1)*2.d0*funb0
      dd1b = r(0)**2*temp129b0 + (13.d0*r(0)**2-4.d0*temp129*2*dd1)*&
&        temp129b
      rb(0) = rb(0) + dd1*2*r(0)*temp129b0 + (13.d0*dd1*2*r(0)-4.d0*dd1&
&        **2*4*r(0)**3)*temp129b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp128 = 4.d0*dd1
      temp127 = 3.d0/temp128
      temp127b = distp(i, 1)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + (temp127-r(i)**2)*zb(indorbp, i)
      dd1b = dd1b - temp127*4.d0*temp127b/temp128
      rb(i) = rb(i) - 2*r(i)*temp127b
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp126 = r(k)**2
      temp126b = c*DEXP(-(dd1*temp126))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp126))*distpb(k, 1)
      dd1b = dd1b - temp126*temp126b
      rb(k) = rb(k) - dd1*2*r(k)*temp126b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.71270547035499016d0*0.75d0*dd1**(-0.25D0)*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (51) 
! 2p single zeta
! g single gaussian orbital
! R(r)= exp(-alpha r^2)
! normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization
!        c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)
    c = dd1**2.75d0*1.11284691281640568826d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
!              indorbp=indorb
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        ELSE IF (ic .EQ. 6) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE IF (ic .EQ. 7) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
        ELSE IF (ic .EQ. 8) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
        ELSE IF (ic .EQ. 9) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
        END IF
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp131b74 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb0 = funb0 + 10.d0*temp131b74
        fun2b = fun2b + temp131b74
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 5) THEN
          IF (branch .LT. 3) THEN
            IF (branch .LT. 2) THEN
              IF (branch .LT. 1) THEN
                temp131b19 = cost1g*fun0*zb(indorbp, indt+3)
                fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-60.d0*&
&                  (rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+2) + cost1g&
&                  *(12.d0*(rmu(1, 0)*r(0)**2)-60.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*zb(indorbp, indt+1) + cost1g*(80.d0*rmu(3, 0)**3&
&                  -48.d0*(rmu(3, 0)*r(0)**2))*zb(indorbp, indt+3)
                rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*r(&
&                  0)**2)*temp131b19
                temp131b20 = cost1g*fun0*zb(indorbp, indt+2)
                temp131b21 = cost1g*fun0*zb(indorbp, indt+1)
                rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp131b20 + &
&                  12.d0*rmu(1, 0)*2*r(0)*temp131b21 - 48.d0*rmu(3, 0)*2*&
&                  r(0)*temp131b19
                rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3, 0)&
&                  **2)*temp131b20
                rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp131b20
                rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3, 0)&
&                  **2)*temp131b21
                rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp131b21
              ELSE
                temp131b22 = -(cost2g*3.d0*zb(indorbp, indt+3))
                temp131b23 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)**&
&                  2)*temp131b22
                temp131b24 = fun0*rmu(1, 0)*temp131b22
                temp131b25 = -(cost2g*6.d0*zb(indorbp, indt+2))
                temp131b26 = rmu(2, 0)*rmu(3, 0)*temp131b25
                fun0b = fun0b + rmu(1, 0)*temp131b26 + cost2g*(4.d0*rmu(&
&                  3, 0)**3-3.d0*(rmu(2, 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)&
&                  **2*rmu(3, 0)))*zb(indorbp, indt+1) + rmu(1, 0)*&
&                  temp131b23
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp131b24 + fun0*&
&                  temp131b23
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp131b24
                rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp131b24
                temp131b27 = fun0*rmu(1, 0)*temp131b25
                rmub(1, 0) = rmub(1, 0) + fun0*temp131b26
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp131b27
                temp131b28 = cost2g*fun0*zb(indorbp, indt+1)
                rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*rmu(&
&                  2, 0)**2-9.d0*rmu(1, 0)**2)*temp131b28 + rmu(2, 0)*&
&                  temp131b27
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                  temp131b28
                rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                  temp131b28
              END IF
            ELSE
              temp131b29 = -(cost2g*3.d0*zb(indorbp, indt+3))
              temp131b30 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)**2)&
&                *temp131b29
              temp131b31 = fun0*rmu(2, 0)*temp131b29
              temp131b32 = -(cost2g*6.d0*zb(indorbp, indt+1))
              temp131b33 = rmu(2, 0)*rmu(3, 0)*temp131b32
              fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2, 0)&
&                **2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb(indorbp&
&                , indt+2) + rmu(1, 0)*temp131b33 + rmu(2, 0)*temp131b30
              rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp131b31 + fun0*&
&                temp131b30
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp131b31
              temp131b34 = cost2g*fun0*zb(indorbp, indt+2)
              rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*rmu(2&
&                , 0)**2-3.d0*rmu(1, 0)**2)*temp131b34 - 4.d0*2*rmu(3, 0)&
&                *temp131b31
              rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                temp131b34
              rmub(1, 0) = rmub(1, 0) + fun0*temp131b33 - 3.d0*rmu(3, 0)&
&                *2*rmu(1, 0)*temp131b34
              temp131b35 = fun0*rmu(1, 0)*temp131b32
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp131b35
              rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp131b35
            END IF
          ELSE IF (branch .LT. 4) THEN
            temp131b36 = cost3g*12.d0*zb(indorbp, indt+3)
            temp131b37 = fun0*rmu(3, 0)*temp131b36
            temp131b38 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp131b36
            rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp131b37
            rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp131b37
            temp131b39 = cost3g*4.d0*zb(indorbp, indt+2)
            temp131b40 = -(cost3g*4.d0*zb(indorbp, indt+1))
            fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)**2))&
&              *temp131b39 + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)**2))&
&              *temp131b40 + rmu(3, 0)*temp131b38
            rmub(3, 0) = rmub(3, 0) + fun0*temp131b38
            temp131b41 = fun0*temp131b39
            rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)**2)&
&              *temp131b41
            rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&              temp131b41
            temp131b42 = fun0*temp131b40
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)**2)&
&              *temp131b42
            rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&              temp131b42
          ELSE
            temp131b43 = cost3g*24.d0*zb(indorbp, indt+3)
            temp131b44 = rmu(2, 0)*rmu(3, 0)*temp131b43
            temp131b45 = fun0*rmu(1, 0)*temp131b43
            temp131b46 = -(cost3g*2.d0*zb(indorbp, indt+2))
            temp131b47 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0)&
&              **2)*temp131b46
            temp131b48 = -(cost3g*2.d0*zb(indorbp, indt+1))
            temp131b49 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3, 0)&
&              **2)*temp131b48
            fun0b = fun0b + rmu(1, 0)*temp131b47 + rmu(2, 0)*temp131b49 &
&              + rmu(1, 0)*temp131b44
            rmub(1, 0) = rmub(1, 0) + fun0*temp131b44
            rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp131b45
            rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp131b45
            temp131b50 = fun0*rmu(1, 0)*temp131b46
            rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp131b50 + fun0*&
&              temp131b47
            rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp131b50
            rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp131b50
            temp131b51 = fun0*rmu(2, 0)*temp131b48
            rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp131b51 + fun0*&
&              temp131b49
            rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp131b51
            rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp131b51
          END IF
        ELSE IF (branch .LT. 8) THEN
          IF (branch .LT. 7) THEN
            IF (branch .LT. 6) THEN
              temp131b52 = cost4g*fun0*zb(indorbp, indt+3)
              temp131b53 = -(cost4g*6.d0*zb(indorbp, indt+2))
              temp131b54 = rmu(2, 0)*rmu(3, 0)*temp131b53
              temp131b55 = cost4g*3.d0*zb(indorbp, indt+1)
              temp131b56 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp131b55
              fun0b = fun0b + rmu(1, 0)*temp131b54 + rmu(3, 0)*&
&                temp131b56 + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2&
&                , 0)**2))*zb(indorbp, indt+3)
              rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**&
&                2)*temp131b52
              rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                temp131b52
              temp131b57 = fun0*rmu(1, 0)*temp131b53
              rmub(1, 0) = rmub(1, 0) + fun0*temp131b54
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp131b57
              rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp131b57
              temp131b58 = fun0*rmu(3, 0)*temp131b55
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp131b58
              rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp131b58
              rmub(3, 0) = rmub(3, 0) + fun0*temp131b56
            ELSE
              temp131b59 = cost4g*fun0*zb(indorbp, indt+3)
              temp131b60 = cost4g*3.d0*zb(indorbp, indt+2)
              temp131b61 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp131b60
              temp131b62 = cost4g*6.d0*zb(indorbp, indt+1)
              temp131b63 = rmu(2, 0)*rmu(3, 0)*temp131b62
              fun0b = fun0b + rmu(3, 0)*temp131b61 + rmu(1, 0)*&
&                temp131b63 + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2&
&                , 0)**3)*zb(indorbp, indt+3)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp131b59
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp131b59
              temp131b64 = fun0*rmu(3, 0)*temp131b60
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp131b64
              rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp131b64
              rmub(3, 0) = rmub(3, 0) + fun0*temp131b61
              temp131b65 = fun0*rmu(1, 0)*temp131b62
              rmub(1, 0) = rmub(1, 0) + fun0*temp131b63
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp131b65
              rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp131b65
            END IF
          ELSE
            temp131b66 = cost5g*4.d0*zb(indorbp, indt+2)
            temp131b67 = fun0*temp131b66
            temp131b68 = cost5g*4.d0*zb(indorbp, indt+1)
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp131b68 + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)))&
&              *temp131b66
            rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**2)&
&              *temp131b67
            temp131b69 = fun0*temp131b68
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp131b69 - 3.d0*rmu(2, 0)*2*rmu(1, 0)*temp131b67
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp131b69
          END IF
        ELSE IF (.NOT.branch .LT. 9) THEN
          temp131b70 = cost5g*4.d0*zb(indorbp, indt+2)
          temp131b71 = fun0*temp131b70
          temp131b72 = cost5g*4.d0*zb(indorbp, indt+1)
          fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**3)*&
&            temp131b72 + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))*&
&            temp131b70
          rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)*&
&            temp131b71
          rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&            temp131b71
          temp131b73 = fun0*temp131b72
          rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&            temp131b73
          rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**2)*&
&            temp131b73
        END IF
        DO i=3,1,-1
          temp131b18 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp131b18
          funb0 = funb0 + rmu(i, 0)*temp131b18
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp131b17 = -(fun*2.d0*fun2b)
      funb0 = funb0 + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp131b17 - 2.d0*distp(0, 1)*funb0
      rb(0) = rb(0) + dd1*2*r(0)*temp131b17
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb0
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp131b = cost5g*4.d0*distpb(i, 10)
      temp131b0 = (rmu(1, i)**2-rmu(2, i)**2)*temp131b
      temp131b1 = rmu(1, i)*rmu(2, i)*temp131b
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp131b1 + rmu(2, i)*&
&        temp131b0
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp131b0 - 2*rmu(2, i)*&
&        temp131b1
      distpb(i, 10) = 0.0_8
      temp131b2 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp131b2
      distpb(i, 9) = 0.0_8
      temp131b3 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp131b4 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp131b3 - 2*rmu(2, i)*&
&        temp131b4 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp131b2
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp131b3
      distpb(i, 8) = 0.0_8
      temp131b5 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp131b6 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp131b5 + 2*rmu(1, i)*&
&        temp131b6 + 3.d0*2*rmu(1, i)*temp131b4
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp131b5
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp131b6
      distpb(i, 7) = 0.0_8
      temp131b7 = cost3g*2.d0*distpb(i, 6)
      temp131b8 = (7.d0*rmu(3, i)**2-r(i)**2)*temp131b7
      temp131b9 = rmu(1, i)*rmu(2, i)*temp131b7
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp131b8
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp131b8
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp131b9
      distpb(i, 6) = 0.0_8
      temp131b10 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp131b11 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp131b12 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp131b13 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp131b14 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp131b15 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp131b16 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp131b16 - 3.d0*2*r(i)*temp131b15 - 2*r(i)*temp131b11 - 3.d0*2&
&        *r(i)*temp131b13 - 2*r(i)*temp131b9
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp131b10
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp131b10
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp131b11
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp131b12
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp131b13 + rmu(2, i)*&
&        temp131b12
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp131b14
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp131b16 + 7.d0*2*rmu(3, i)*temp131b15 + rmu(1, i)*&
&        temp131b14
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp130 = r(k)**2
      temp130b = c*DEXP(-(dd1*temp130))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp130))*distpb(k, 1)
      dd1b = dd1b - temp130*temp130b
      rb(k) = rb(k) - dd1*2*r(k)*temp130b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.11284691281640568826d0*2.75d0*dd1**1.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (142) 
!     4d  one parmater
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*r(i)
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!            endif
    IF (typec .NE. 1) THEN
      fun0 = -distp(0, 3)
      fun = -((1.d0-dd1*r(0))*distp(0, 1))
      fun2 = -(dd1*(dd1*r(0)-2.d0)*distp(0, 1))
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp132 = fun/r(0)
        temp133b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp132b3 = 6.d0*temp133b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp132+fun2)*zb(&
&          indorbp, indt+4)
        funb0 = funb0 + temp132b3
        rb(0) = rb(0) - temp132*temp132b3
        fun2b = fun2b + temp133b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp132b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp132b
                  fun0b = fun0b + rmu(i, 0)*temp132b
                ELSE
                  temp132b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp132b0
                  fun0b = fun0b + rmu(i, 0)*temp132b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp132b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp132b1
                fun0b = fun0b + rmu(i, 0)*temp132b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp132b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp132b2
                fun0b = fun0b + rmu(i, 0)*temp132b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp131 = fun/r(0)
          temp131b78 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp131*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp131*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb0 = funb0 + temp131b78
          rb(0) = rb(0) - temp131*temp131b78
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp131b76 = -(dd1*distp(0, 1)*fun2b)
      temp131b77 = -((dd1*r(0)-2.d0)*fun2b)
      dd1b = distp(0, 1)*r(0)*funb0 + distp(0, 1)*temp131b77 + r(0)*&
&        temp131b76
      rb(0) = rb(0) + distp(0, 1)*dd1*funb0 + dd1*temp131b76
      distpb(0, 1) = distpb(0, 1) + dd1*temp131b77 - (1.d0-dd1*r(0))*&
&        funb0
      distpb(0, 3) = distpb(0, 3) - fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) - distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) - distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distpb(i, 1) = distpb(i, 1) + r(i)*distpb(i, 3)
      rb(i) = rb(i) + distp(i, 1)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp131b75 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp131b75
      rb(k) = rb(k) - dd1*temp131b75
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (33) 
!     4d without cusp and one parmater
    dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then
!     c=
!                                                                  &1/(2.d0**3*3.d0)*dsqrt(1.d0/pi)*(2.d0*dd1)**(7.d0/2.d0)
!     c=                                                       &
!                                                              &1.d0/(2.d0**3*3.d0)/dsqrt(56.d0*pi)*(2.d0*dd1)**(9.d0/2.d0)
    c = dd1**4.5d0*0.0710812062076410d0
!         endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*r(i)
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
! lz=0
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
! lz=+/
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
! lz=+/-2
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
! lz=+/-1
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
! lz=+/-1
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!            endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(dd1*distp(0, 3)) + distp(0, 1)
      fun2 = dd1**2*distp(0, 3) - 2.d0*dd1*distp(0, 1)
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp134 = fun/r(0)
        temp135b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp134b3 = 6.d0*temp135b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp134+fun2)*zb(&
&          indorbp, indt+4)
        funb0 = funb0 + temp134b3
        rb(0) = rb(0) - temp134*temp134b3
        fun2b = fun2b + temp135b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp134b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp134b
                  fun0b = fun0b + rmu(i, 0)*temp134b
                ELSE
                  temp134b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp134b0
                  fun0b = fun0b + rmu(i, 0)*temp134b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp134b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp134b1
                fun0b = fun0b + rmu(i, 0)*temp134b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp134b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp134b2
                fun0b = fun0b + rmu(i, 0)*temp134b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp133 = fun/r(0)
          temp133b1 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp133*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp133*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb0 = funb0 + temp133b1
          rb(0) = rb(0) - temp133*temp133b1
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      dd1b = (distp(0, 3)*2*dd1-2.d0*distp(0, 1))*fun2b - distp(0, 3)*&
&        funb0
      distpb(0, 3) = distpb(0, 3) + dd1**2*fun2b
      distpb(0, 1) = distpb(0, 1) + funb0 - 2.d0*dd1*fun2b
      distpb(0, 3) = distpb(0, 3) + fun0b - dd1*funb0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distpb(i, 1) = distpb(i, 1) + r(i)*distpb(i, 3)
      rb(i) = rb(i) + distp(i, 1)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp133b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp133b0
      rb(k) = rb(k) - dd1*temp133b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.0710812062076410d0*4.5d0*dd1**3.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (154) 
! 2s single  Z WITH CUSP zero
! Jastrow single gaussian f orbital
! R(r)= exp(-alpha r^2)
! unnormalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
!            dd1=dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
!              indorbp=indorb
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        ELSE IF (ic .EQ. 6) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
        END IF
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp135b30 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 8.d0*temp135b30
        fun2b = fun2b + temp135b30
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 4) THEN
          IF (branch .LT. 2) THEN
            IF (branch .LT. 1) THEN
              temp135b11 = cost1f*zb(indorbp, indt+3)
              temp135b12 = -(cost1f*6.d0*zb(indorbp, indt+2))
              temp135b13 = -(cost1f*6.d0*zb(indorbp, indt+1))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp135b12 + rmu(3, 0)&
&                *rmu(1, 0)*temp135b13 + (9.d0*rmu(3, 0)**2-3.d0*r(0)**2)&
&                *temp135b11
              rmub(3, 0) = rmub(3, 0) + fun0*9.d0*2*rmu(3, 0)*temp135b11
              rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp135b11
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp135b12
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp135b12
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp135b13
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp135b13
            ELSE
              temp135b14 = cost2f*8.d0*zb(indorbp, indt+3)
              temp135b15 = -(cost2f*2.d0*zb(indorbp, indt+2))
              fun0b = fun0b + rmu(1, 0)*rmu(2, 0)*temp135b15 + cost2f*(&
&                5.d0*rmu(3, 0)**2-r(0)**2-2.d0*rmu(1, 0)**2)*zb(indorbp&
&                , indt+1) + rmu(1, 0)*rmu(3, 0)*temp135b14
              rmub(3, 0) = rmub(3, 0) + rmu(1, 0)*fun0*temp135b14
              rmub(1, 0) = rmub(1, 0) + fun0*rmu(3, 0)*temp135b14
              rmub(2, 0) = rmub(2, 0) + rmu(1, 0)*fun0*temp135b15
              rmub(1, 0) = rmub(1, 0) + fun0*rmu(2, 0)*temp135b15
              temp135b16 = cost2f*fun0*zb(indorbp, indt+1)
              rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp135b16
              rb(0) = rb(0) - 2*r(0)*temp135b16
              rmub(1, 0) = rmub(1, 0) - 2.d0*2*rmu(1, 0)*temp135b16
            END IF
          ELSE IF (branch .LT. 3) THEN
            temp135b17 = cost2f*8.d0*zb(indorbp, indt+3)
            temp135b18 = -(cost2f*2.d0*zb(indorbp, indt+1))
            fun0b = fun0b + cost2f*(5.d0*rmu(3, 0)**2-r(0)**2-2.d0*rmu(2&
&              , 0)**2)*zb(indorbp, indt+2) + rmu(2, 0)*rmu(1, 0)*&
&              temp135b18 + rmu(2, 0)*rmu(3, 0)*temp135b17
            rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*fun0*temp135b17
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(3, 0)*temp135b17
            temp135b19 = cost2f*fun0*zb(indorbp, indt+2)
            rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp135b19
            rb(0) = rb(0) - 2*r(0)*temp135b19
            rmub(2, 0) = rmub(2, 0) - 2.d0*2*rmu(2, 0)*temp135b19
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp135b18
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp135b18
          ELSE
            temp135b20 = cost3f*zb(indorbp, indt+3)
            temp135b21 = -(cost3f*2.d0*zb(indorbp, indt+2))
            temp135b22 = cost3f*2.d0*zb(indorbp, indt+1)
            fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp135b21 + rmu(3, 0)*&
&              rmu(1, 0)*temp135b22 + (rmu(1, 0)**2-rmu(2, 0)**2)*&
&              temp135b20
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp135b20
            rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp135b21 - fun0*2&
&              *rmu(2, 0)*temp135b20
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp135b21
            rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp135b22
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp135b22
          END IF
        ELSE IF (branch .LT. 6) THEN
          IF (branch .LT. 5) THEN
            temp135b23 = cost3f*2.d0*zb(indorbp, indt+3)
            temp135b24 = cost3f*2.d0*zb(indorbp, indt+2)
            temp135b25 = cost3f*2.d0*zb(indorbp, indt+1)
            fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp135b24 + rmu(3, 0)*&
&              rmu(2, 0)*temp135b25 + rmu(2, 0)*rmu(1, 0)*temp135b23
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp135b23
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp135b23
            rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp135b24
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp135b24
            rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp135b25
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp135b25
          ELSE
            temp135b26 = -(cost4f*6.d0*zb(indorbp, indt+2))
            temp135b27 = cost4f*3.d0*zb(indorbp, indt+1)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp135b27 + rmu&
&              (2, 0)*rmu(1, 0)*temp135b26
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp135b26
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp135b26
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp135b27
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp135b27
          END IF
        ELSE
          temp135b28 = cost4f*3.d0*zb(indorbp, indt+2)
          temp135b29 = cost4f*6.d0*zb(indorbp, indt+1)
          fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp135b29 + (rmu(1, 0)**2&
&            -rmu(2, 0)**2)*temp135b28
          rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp135b28
          rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp135b28
          rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp135b29
          rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp135b29
        END IF
        DO i=3,1,-1
          temp135b10 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp135b10
          funb0 = funb0 + rmu(i, 0)*temp135b10
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp135b9 = -(fun*2.d0*fun2b)
      funb0 = funb0 + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp135b9 - 2.d0*distp(0, 1)*funb0
      rb(0) = rb(0) + dd1*2*r(0)*temp135b9
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp135b1 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp135b1
      distpb(i, 8) = 0.0_8
      temp135b2 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp135b2 + 3.d0*2*rmu(1, i)*&
&        temp135b1
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp135b2
      distpb(i, 7) = 0.0_8
      temp135b3 = cost3f*2.d0*distpb(i, 6)
      temp135b4 = rmu(2, i)*temp135b3
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp135b4
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp135b4
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp135b3
      distpb(i, 6) = 0.0_8
      temp135b5 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp135b5
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp135b5
      temp135b6 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp135b6
      distpb(i, 4) = 0.0_8
      temp135b7 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp135b8 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp135b7 - 3.d0*2*r(i)*temp135b8 - 2*r(i)*&
&        temp135b6
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp135b8 + 5.d0*2*rmu(3, i)*&
&        temp135b7
      distpb(i, 2) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp135b0 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp135b0
      rb(k) = rb(k) - dd1*2*r(k)*temp135b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (34) 
! normalized
! exp(-dd1*r) + dd1*r*exp(-dd1*r)
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           peff=dd1
!           if(iflagnorm.gt.2) then
!              c=1.d0/dsqrt(1.d0/4.d0/dd1**3+12.d0*dd1/(2.d0*dd1)**4+&
!                                                              &3.d0*dd1**2/4.d0/dd1**5)/dsqrt(4.d0*pi)
!             c=dd1*dsqrt(dd1)/dsqrt(7.d0*pi)
    c = dd1*DSQRT(dd1)*.2132436186229231d0
!           endif
    DO i=indtmin,indtm
      distp(i, 1) = c*DEXP(-(dd1*r(i)))
    END DO
    IF (typec .NE. 1) THEN
      fun = -(dd1**2*distp(0, 1))
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      funb0 = funb0 + (1.d0-dd1*r(0))*fun2b
      dd1b = -(distp(0, 1)*2*dd1*funb0) - fun*r(0)*fun2b
      rb(0) = rb(0) - fun*dd1*fun2b
      distpb = 0.0_8
      distpb(0, 1) = -(dd1**2*funb0)
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp136b0 = distp(i, 1)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + (r(i)*dd1+1.d0)*zb(indorbp, i)
      rb(i) = rb(i) + dd1*temp136b0
      dd1b = dd1b + r(i)*temp136b0
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO i=indtm,indtmin,-1
      temp136b = c*DEXP(-(dd1*r(i)))*distpb(i, 1)
      cb = cb + DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp136b
      rb(i) = rb(i) - dd1*temp136b
      distpb(i, 1) = 0.0_8
    END DO
    temp135 = DSQRT(dd1)
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + .2132436186229231d0*temp135*cb
    ELSE
      dd1b = dd1b + (.2132436186229231d0*dd1/(2.D0*DSQRT(dd1))+&
&        .2132436186229231d0*temp135)*cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (18) 
! 2s single  Z WITH CUSP
! R(r)=r**4*exp(-z*r**2) single zeta
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!           c=(2.d0*dd1**11/pi)**(1.d0/4.d0)*(512.d0/945.d0/pi)
    c = dd1**2.75d0*0.1540487967684377d0
!           endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
!              the first derivative
      fun = distp(0, 1)*rp1*(4.d0-2.d0*dd1*rp1)
!              the second derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp137b = (4.d0*(dd1**2*rp1**2)-18.d0*(dd1*rp1)+12.d0)*fun2b
      temp137b0 = distp(0, 1)*rp1*fun2b
      temp137b1 = (4.d0-2.d0*(dd1*rp1))*funb0
      distpb(0, 1) = rp1*temp137b1 + rp1*temp137b
      temp137b2 = -(distp(0, 1)*rp1*2.d0*funb0)
      rp1b = distp(0, 1)*temp137b1 + dd1*temp137b2 + (4.d0*dd1**2*2*rp1-&
&        18.d0*dd1)*temp137b0 + distp(0, 1)*temp137b
      dd1b = rp1*temp137b2 + (4.d0*rp1**2*2*dd1-18.d0*rp1)*temp137b0
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      rb(i) = rb(i) + distp(i, 1)*4*r(i)**3*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + r(i)**4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp136 = r(k)**2
      temp136b1 = c*DEXP(-(dd1*temp136))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp136))*distpb(k, 1)
      dd1b = dd1b - temp136*temp136b1
      rb(k) = rb(k) - dd1*2*r(k)*temp136b1
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.1540487967684377d0*2.75d0*dd1**1.75D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (41) 
! derivative of 16 with respect to z
!c     4p without cusp condition derivative of 22
!c      r^2   e^{-z1 r }
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then
!        c=dsqrt((2.d0*dd1)**7/240.d0/pi)/2.d0
    c = dd1**3.5d0*0.2060129077457011d0
!        endif
    c0 = -c
    c1 = 3.5d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = r(i)**2*distp(i, 1)
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
!           fun=(1.d0-dd1*r(0))*distp(0,1)
!           fun2=dd1*(dd1*r(0)-2.d0)*distp(0,1)
      fun = (c0*(2.d0-dd1*r(0))*r(0)+c1*(1.d0-dd1*r(0)))*distp(0, 1)
      fun2 = (c0*((dd1*r(0))**2+2.d0-4.d0*dd1*r(0))+c1*dd1*(dd1*r(0)-&
&        2.d0))*distp(0, 1)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp142 = fun/r(0)
        temp143b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp142b = 4.d0*temp143b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp142+fun2)*zb(indorbp, indt&
&          +4)
        funb0 = funb0 + temp142b
        rb(0) = rb(0) - temp142*temp142b
        fun2b = fun2b + temp143b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp141 = fun/r(0)
          temp141b0 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp141*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp141*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb0 = funb0 + temp141b0
          rb(0) = rb(0) - temp141*temp141b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp141b = distp(0, 1)*fun2b
      temp140 = (dd1*r(0))**2 - 4.d0*dd1*r(0) + 2.d0
      temp140b = c0*temp141b
      temp140b0 = 2*dd1*r(0)*temp140b
      temp139 = dd1*r(0) - 2.d0
      temp139b = c1*dd1*temp141b
      temp139b0 = distp(0, 1)*funb0
      temp137 = -(dd1*r(0)) + 2.d0
      c0b = temp137*r(0)*temp139b0 + distp(0, 3)*fun0b + temp140*&
&        temp141b
      temp138 = c0*r(0)
      dd1b = (-(c1*r(0))-temp138*r(0))*temp139b0 + r(0)*temp139b + &
&        temp139*c1*temp141b - 4.d0*r(0)*temp140b + r(0)*temp140b0
      rb(0) = rb(0) + (temp137*c0-c1*dd1-temp138*dd1)*temp139b0 + distp(&
&        0, 1)*c1*fun0b + dd1*temp139b - 4.d0*dd1*temp140b + dd1*&
&        temp140b0
      c1b = (1.d0-dd1*r(0))*temp139b0 + distp(0, 1)*r(0)*fun0b + temp139&
&        *dd1*temp141b
      distpb(0, 1) = (temp137*temp138+c1*(1.d0-dd1*r(0)))*funb0 + (c0*&
&        temp140+c1*dd1*temp139)*fun2b
      distpb(0, 3) = distpb(0, 3) + c0*fun0b
      distpb(0, 1) = distpb(0, 1) + c1*r(0)*fun0b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp137b5 = rmu(ic, i)*zb(indorbp, i)
        temp137b6 = distp(i, 1)*temp137b5
        rmub(ic, i) = rmub(ic, i) + (c0*distp(i, 3)+c1*r(i)*distp(i, 1))&
&          *zb(indorbp, i)
        c0b = c0b + distp(i, 3)*temp137b5
        distpb(i, 3) = distpb(i, 3) + c0*temp137b5
        c1b = c1b + r(i)*temp137b6
        rb(i) = rb(i) + c1*temp137b6
        distpb(i, 1) = distpb(i, 1) + c1*r(i)*temp137b5
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + r(i)**2*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp137b4 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp137b4
      rb(k) = rb(k) - dd1*temp137b4
      distpb(k, 1) = 0.0_8
    END DO
    temp137b3 = 3.5d0*c1b/dd1
    cb = temp137b3 - c0b
    dd1b = dd1b + 0.2060129077457011d0*3.5d0*dd1**2.5D0*cb - c*temp137b3&
&      /dd1
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (125) 
!     2s with cusp condition
!     dd1*( dd3 +exp(-dd2*r))  ! with no cusp condition
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)/r(0))
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp143b1 = -(distp(0, 1)*funb0/r(0))
      dd2b = temp143b1 + distp(0, 1)*2*dd2*fun2b
      temp143 = dd2/r(0)
      distpb(0, 1) = dd2**2*fun2b - temp143*funb0
      rb(0) = rb(0) - temp143*temp143b1
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp143b0 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp143b0
      rb(k) = rb(k) - dd2*temp143b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (116) 
!     2p  double  Lorentian
!       dd1 * x_mu  (L^3(dd2 r)+dd3 r * L(dd4*r)^4) ; L(x)=1/(1+x)
    dd2 = dd(indpar+1)
    dd3 = dd(indpar+2)
    dd4 = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k))**3
      distp(k, 2) = r(k)/(1.d0+dd4*r(k))**4
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(3.d0*dd2*distp(0, 1)/(r(0)*(1.d0+dd2*r(0)))) + dd3*distp(0&
&        , 2)/r(0)**2*(1.d0-3*dd4*r(0))/(1.d0+dd4*r(0))
      fun2 = 12.d0*dd2**2/(1.+dd2*r(0))**5 + dd3*4.d0*dd4*(-2.d0+3.d0*&
&        dd4*r(0))/(1.+dd4*r(0))**6
!           fun0=distp(0,1)+dd3*distp(0,2)
!           fun=2.d0*(-dd2*distp(0,1)**2-dd4*dd3*distp(0,2)**2)
!       fun2=2*dd2*distp(0,1)**3*(-1.d0+3.d0*dd2*r(0)**2)
!    1+2*dd3*dd4*distp(0,2)**3*(-1.d0+3.d0*dd4*r(0)**2)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp154b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp154b0
        fun2b = fun2b + temp154b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp154b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp154b
          funb0 = funb0 + rmu(ic, 0)*temp154b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp153 = (dd2*r(0)+1.)**5
      temp153b = 12.d0*fun2b/temp153
      temp153b0 = -(dd2**2*5*(dd2*r(0)+1.)**4*temp153b/temp153)
      temp152 = (dd4*r(0)+1.)**6
      temp151 = 3.d0*dd4*r(0) - 2.d0
      temp151b = 4.d0*fun2b/temp152
      temp151b0 = dd3*dd4*3.d0*temp151b
      temp151b1 = -(dd3*dd4*temp151*6*(dd4*r(0)+1.)**5*temp151b/temp152)
      temp148 = dd2*r(0) + 1.d0
      temp148b0 = -(3.d0*funb0/(r(0)*temp148))
      temp148b1 = -(dd2*distp(0, 1)*temp148b0/(r(0)*temp148))
      dd2b = distp(0, 1)*temp148b0 + r(0)**2*temp148b1 + r(0)*temp153b0 &
&        + 2*dd2*temp153b
      temp149 = r(0)**2*(dd4*r(0)+1.d0)
      temp151b2 = funb0/temp149
      temp150 = (-3)*(dd4*r(0)) + 1.d0
      temp150b = -(dd3*distp(0, 2)*3*temp151b2)
      temp149b = -(dd3*distp(0, 2)*temp150*temp151b2/temp149)
      temp149b0 = r(0)**2*temp149b
      rb(0) = rb(0) + dd4*temp150b + (dd4*r(0)+1.d0)*2*r(0)*temp149b + &
&        dd4*temp149b0 + (r(0)*dd2+temp148)*temp148b1 + dd4*temp151b1 + &
&        dd4*temp151b0 + dd2*temp153b0
      dd3b = temp150*distp(0, 2)*temp151b2 + distp(0, 2)*fun0b + temp151&
&        *dd4*temp151b
      dd4b = r(0)*temp150b + r(0)*temp149b0 + r(0)*temp151b1 + r(0)*&
&        temp151b0 + temp151*dd3*temp151b
      distpb = 0.0_8
      distpb(0, 2) = temp150*dd3*temp151b2
      distpb(0, 1) = fun0b + dd2*temp148b0
      distpb(0, 2) = distpb(0, 2) + dd3*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      dd4b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp148b = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (distp(i, 1)+dd3*distp(i, 2))*zb(&
&          indorbp, i)
        distpb(i, 1) = distpb(i, 1) + temp148b
        dd3b = dd3b + distp(i, 2)*temp148b
        distpb(i, 2) = distpb(i, 2) + dd3*temp148b
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp146 = dd4*r(k) + 1.d0
      temp147 = temp146**4
      temp146b = -(r(k)*4*temp146**3*distpb(k, 2)/temp147**2)
      rb(k) = rb(k) + dd4*temp146b + distpb(k, 2)/temp147
      dd4b = dd4b + r(k)*temp146b
      distpb(k, 2) = 0.0_8
      temp144 = dd2*r(k) + 1.d0
      temp145 = temp144**3
      temp144b = -(3*temp144**2*distpb(k, 1)/temp145**2)
      dd2b = dd2b + r(k)*temp144b
      rb(k) = rb(k) + dd2*temp144b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (48) 
! f orbital
! 
! - angmom = 3
! - type = Gaussian
! - normalized = yes
! - angtype = spherical
! - npar = 1
! - multiplicity = 7
!
    indparp = indpar + 1
    dd1 = dd(indparp)
    c = dd1**2.25d0*1.47215808929909374563d0
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb + ic
    END DO
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        ELSE IF (ic .EQ. 6) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
        END IF
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp155b28 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 8.d0*temp155b28
        fun2b = fun2b + temp155b28
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 4) THEN
          IF (branch .LT. 2) THEN
            IF (branch .LT. 1) THEN
              temp155b9 = cost1f*zb(indorbp, indt+3)
              temp155b10 = -(cost1f*6.d0*zb(indorbp, indt+2))
              temp155b11 = -(cost1f*6.d0*zb(indorbp, indt+1))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp155b10 + rmu(3, 0)&
&                *rmu(1, 0)*temp155b11 + (9.d0*rmu(3, 0)**2-3.d0*r(0)**2)&
&                *temp155b9
              rmub(3, 0) = rmub(3, 0) + fun0*9.d0*2*rmu(3, 0)*temp155b9
              rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp155b9
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp155b10
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp155b10
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp155b11
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp155b11
            ELSE
              temp155b12 = cost2f*8.d0*zb(indorbp, indt+3)
              temp155b13 = -(cost2f*2.d0*zb(indorbp, indt+2))
              fun0b = fun0b + rmu(1, 0)*rmu(2, 0)*temp155b13 + cost2f*(&
&                5.d0*rmu(3, 0)**2-r(0)**2-2.d0*rmu(1, 0)**2)*zb(indorbp&
&                , indt+1) + rmu(1, 0)*rmu(3, 0)*temp155b12
              rmub(3, 0) = rmub(3, 0) + rmu(1, 0)*fun0*temp155b12
              rmub(1, 0) = rmub(1, 0) + fun0*rmu(3, 0)*temp155b12
              rmub(2, 0) = rmub(2, 0) + rmu(1, 0)*fun0*temp155b13
              rmub(1, 0) = rmub(1, 0) + fun0*rmu(2, 0)*temp155b13
              temp155b14 = cost2f*fun0*zb(indorbp, indt+1)
              rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp155b14
              rb(0) = rb(0) - 2*r(0)*temp155b14
              rmub(1, 0) = rmub(1, 0) - 2.d0*2*rmu(1, 0)*temp155b14
            END IF
          ELSE IF (branch .LT. 3) THEN
            temp155b15 = cost2f*8.d0*zb(indorbp, indt+3)
            temp155b16 = -(cost2f*2.d0*zb(indorbp, indt+1))
            fun0b = fun0b + cost2f*(5.d0*rmu(3, 0)**2-r(0)**2-2.d0*rmu(2&
&              , 0)**2)*zb(indorbp, indt+2) + rmu(2, 0)*rmu(1, 0)*&
&              temp155b16 + rmu(2, 0)*rmu(3, 0)*temp155b15
            rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*fun0*temp155b15
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(3, 0)*temp155b15
            temp155b17 = cost2f*fun0*zb(indorbp, indt+2)
            rmub(3, 0) = rmub(3, 0) + 5.d0*2*rmu(3, 0)*temp155b17
            rb(0) = rb(0) - 2*r(0)*temp155b17
            rmub(2, 0) = rmub(2, 0) - 2.d0*2*rmu(2, 0)*temp155b17
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp155b16
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp155b16
          ELSE
            temp155b18 = cost3f*zb(indorbp, indt+3)
            temp155b19 = -(cost3f*2.d0*zb(indorbp, indt+2))
            temp155b20 = cost3f*2.d0*zb(indorbp, indt+1)
            fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp155b19 + rmu(3, 0)*&
&              rmu(1, 0)*temp155b20 + (rmu(1, 0)**2-rmu(2, 0)**2)*&
&              temp155b18
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp155b18
            rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp155b19 - fun0*2&
&              *rmu(2, 0)*temp155b18
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp155b19
            rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp155b20
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp155b20
          END IF
        ELSE IF (branch .LT. 6) THEN
          IF (branch .LT. 5) THEN
            temp155b21 = cost3f*2.d0*zb(indorbp, indt+3)
            temp155b22 = cost3f*2.d0*zb(indorbp, indt+2)
            temp155b23 = cost3f*2.d0*zb(indorbp, indt+1)
            fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp155b22 + rmu(3, 0)*&
&              rmu(2, 0)*temp155b23 + rmu(2, 0)*rmu(1, 0)*temp155b21
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp155b21
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp155b21
            rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp155b22
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp155b22
            rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp155b23
            rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp155b23
          ELSE
            temp155b24 = -(cost4f*6.d0*zb(indorbp, indt+2))
            temp155b25 = cost4f*3.d0*zb(indorbp, indt+1)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp155b25 + rmu&
&              (2, 0)*rmu(1, 0)*temp155b24
            rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp155b24
            rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp155b24
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp155b25
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp155b25
          END IF
        ELSE
          temp155b26 = cost4f*3.d0*zb(indorbp, indt+2)
          temp155b27 = cost4f*6.d0*zb(indorbp, indt+1)
          fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp155b27 + (rmu(1, 0)**2&
&            -rmu(2, 0)**2)*temp155b26
          rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp155b26
          rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp155b26
          rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp155b27
          rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp155b27
        END IF
        DO i=3,1,-1
          temp155b8 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp155b8
          funb0 = funb0 + rmu(i, 0)*temp155b8
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp155b7 = -(fun*2.d0*fun2b)
      funb0 = funb0 + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp155b7 - 2.d0*distp(0, 1)*funb0
      rb(0) = rb(0) + dd1*2*r(0)*temp155b7
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb0
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp155b = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp155b
      distpb(i, 8) = 0.0_8
      temp155b0 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp155b0 + 3.d0*2*rmu(1, i)*temp155b
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp155b0
      distpb(i, 7) = 0.0_8
      temp155b1 = cost3f*2.d0*distpb(i, 6)
      temp155b2 = rmu(2, i)*temp155b1
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp155b2
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp155b2
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp155b1
      distpb(i, 6) = 0.0_8
      temp155b3 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp155b3
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp155b3
      temp155b4 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp155b4
      distpb(i, 4) = 0.0_8
      temp155b5 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp155b6 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp155b5 - 3.d0*2*r(i)*temp155b6 - 2*r(i)*&
&        temp155b4
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp155b6 + 5.d0*2*rmu(3, i)*&
&        temp155b5
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp154 = r(k)**2
      temp154b1 = c*DEXP(-(dd1*temp154))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp154))*distpb(k, 1)
      dd1b = dd1b - temp154*temp154b1
      rb(k) = rb(k) - dd1*2*r(k)*temp154b1
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.47215808929909374563d0*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (102) 
!     2s double gaussian with constant
!     (dd3+ exp (-dd2 r^2)+dd4*exp(-dd5*r^2))
    dd2 = dd(indpar+1)
    dd4 = dd(indpar+3)
    dd5 = dd(indpar+4)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
      distp(k, 2) = DEXP(-(dd5*r(k)*r(k)))
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)
!           endif
    IF (typec .NE. 1) THEN
      fun = -(2.d0*(dd2*distp(0, 1)+dd5*dd4*distp(0, 2)))
      fun2 = r(0)**2
      distpb = 0.0_8
      temp155b32 = 2.d0*zb(indorbp, indt+4)
      temp155b33 = dd2*distp(0, 1)*2.d0*temp155b32
      temp155b34 = (2.d0*(dd2*fun2)-3.d0)*temp155b32
      temp155b35 = (2.d0*(dd5*fun2)-3.d0)*temp155b32
      temp155b36 = dd5*dd4*distp(0, 2)*2.d0*temp155b32
      dd2b = distp(0, 1)*temp155b34 + fun2*temp155b33
      fun2b = dd5*temp155b36 + dd2*temp155b33
      distpb(0, 1) = dd2*temp155b34
      dd5b = fun2*temp155b36 + distp(0, 2)*dd4*temp155b35
      dd4b = distp(0, 2)*dd5*temp155b35
      distpb(0, 2) = dd5*dd4*temp155b35
      zb(indorbp, indt+4) = 0.0_8
      funb0 = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      rb(0) = rb(0) + 2*r(0)*fun2b
      temp155b31 = -(2.d0*funb0)
      dd2b = dd2b + distp(0, 1)*temp155b31
      distpb(0, 1) = distpb(0, 1) + dd2*temp155b31
      dd5b = dd5b + distp(0, 2)*dd4*temp155b31
      dd4b = dd4b + distp(0, 2)*dd5*temp155b31
      distpb(0, 2) = distpb(0, 2) + dd5*dd4*temp155b31
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp155b29 = DEXP(-(dd5*r(k)**2))*distpb(k, 2)
      dd5b = dd5b - r(k)**2*temp155b29
      distpb(k, 2) = 0.0_8
      temp155b30 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      rb(k) = rb(k) - dd2*2*r(k)*temp155b30 - dd5*2*r(k)*temp155b29
      dd2b = dd2b - r(k)**2*temp155b30
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+4) = ddb(indpar+4) + dd5b
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (35) 
! normalized
! exp(-dd1*r) + dd1* r * exp(-dd2*r)
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      distp(k, 2) = DEXP(-(dd2*r(k)))
    END DO
!           if(iflagnorm.gt.2) then
    c = 1.d0/DSQRT(1/4.d0/dd1**3+12*peff/(dd1+dd2)**4+3*peff**2/4/dd2**5&
&      )/DSQRT(4.0*pi)
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1)) + peff*distp(0, 2)*(1.d0-dd2*r(0))
      fun2 = distp(0, 1)*dd1**2 + peff*distp(0, 2)*(dd2**2*r(0)-2.d0*dd2&
&        )
      temp163 = fun/r(0)
      temp163b = c*2.d0*zb(indorbp, indt+4)/r(0)
      cb = (2.d0*temp163+fun2)*zb(indorbp, indt+4)
      funb0 = temp163b
      rb(0) = rb(0) - temp163*temp163b
      fun2b = c*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp162 = rmu(i, 0)/r(0)
        temp162b5 = fun*c*zb(indorbp, indt+i)/r(0)
        funb0 = funb0 + temp162*c*zb(indorbp, indt+i)
        cb = cb + temp162*fun*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + temp162b5
        rb(0) = rb(0) - temp162*temp162b5
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp162b1 = (dd2**2*r(0)-2.d0*dd2)*fun2b
      temp162b2 = peff*distp(0, 2)*fun2b
      distpb(0, 1) = dd1**2*fun2b
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb0
      temp162b3 = (1.d0-dd2*r(0))*funb0
      peffb = distp(0, 2)*temp162b3 + distp(0, 2)*temp162b1
      distpb(0, 2) = peff*temp162b3 + peff*temp162b1
      temp162b4 = peff*distp(0, 2)*funb0
      dd2b = (r(0)*2*dd2-2.d0)*temp162b2 - r(0)*temp162b4
      rb(0) = rb(0) + dd2**2*temp162b2 - dd2*temp162b4
      distpb(0, 1) = distpb(0, 1) - dd1*funb0
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      cb = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp162b = c*zb(indorbp, i)
      temp162b0 = distp(i, 2)*temp162b
      cb = cb + (distp(i, 1)+r(i)*peff*distp(i, 2))*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp162b
      rb(i) = rb(i) + peff*temp162b0
      peffb = peffb + r(i)*temp162b0
      distpb(i, 2) = distpb(i, 2) + r(i)*peff*temp162b
      zb(indorbp, i) = 0.0_8
    END DO
    temp161 = 4*dd2**5
    temp155 = peff**2/temp161
    temp160 = (dd1+dd2)**4
    temp159 = 4.d0*dd1**3
    temp156 = 1.0/temp159 + 12*(peff/temp160) + 3*temp155
    temp158 = DSQRT(temp156)
    temp157 = DSQRT(4.0*pi)
    IF (temp156 .EQ. 0.0) THEN
      temp156b = 0.0
    ELSE
      temp156b = -(cb/(temp157*temp158**2*2.D0*DSQRT(temp156)))
    END IF
    temp156b0 = 12*temp156b/temp160
    temp156b1 = -(peff*4*(dd1+dd2)**3*temp156b0/temp160)
    temp155b39 = 3*temp156b/temp161
    dd1b = dd1b + temp156b1 - 4.d0*3*dd1**2*temp156b/temp159**2
    peffb = peffb + 2*peff*temp155b39 + temp156b0
    dd2b = dd2b + temp156b1 - temp155*4*5*dd2**4*temp155b39
    DO k=indtm,indtmin,-1
      temp155b37 = DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp155b37
      distpb(k, 2) = 0.0_8
      temp155b38 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp155b38 - dd2*temp155b37
      dd1b = dd1b - r(k)*temp155b38
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (103) 
! single gaussian p orbitals
!     2p single gaussian
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)*2.d0)
      fun2 = 2.d0*dd2*(-1.d0+2.d0*dd2*r(0)**2)*distp(0, 1)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp164b3 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp164b3
        fun2b = fun2b + temp164b3
        zb(indorbp, indt+4) = 0.0_8
        fun0b = fun0b + zb(indorbp, indt+ic)
        DO i=3,1,-1
          temp164b2 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp164b2
          funb0 = funb0 + rmu(ic, 0)*temp164b2
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp164b0 = 2.d0**2*dd2*distp(0, 1)*fun2b
      temp164b1 = 2.d0*(2.d0*(dd2*r(0)**2)-1.d0)*fun2b
      dd2b = distp(0, 1)*temp164b1 - 2.d0*distp(0, 1)*funb0 + r(0)**2*&
&        temp164b0
      rb(0) = rb(0) + dd2*2*r(0)*temp164b0
      distpb(0, 1) = fun0b - 2.d0*dd2*funb0 + dd2*temp164b1
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp164b = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp164b
      rb(k) = rb(k) - dd2*2*r(k)*temp164b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (120) 
!     2p  double  cubic
!       dd1 * x_mu  (L^3(dd2 r)+dd3 L(dd4*r)^3) ; L(x)=1/(1+x)
    dd2 = dd(indpar+1)
    dd3 = dd(indpar+2)
    dd4 = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k))**3
      distp(k, 2) = 1.d0/(1.d0+dd4*r(k))**3
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(3.d0*dd2*distp(0, 1)/(r(0)*(1.d0+dd2*r(0)))) - 3.d0*dd4*&
&        dd3*distp(0, 2)/(r(0)*(1.d0+dd4*r(0)))
      fun2 = 12.d0*dd2**2/(1.+dd2*r(0))**5 + 12.d0*dd3*dd4**2/(1.+dd4*r(&
&        0))**5
!           fun0=distp(0,1)+dd3*distp(0,2)
!           fun=2.d0*(-dd2*distp(0,1)**2-dd4*dd3*distp(0,2)**2)
!       fun2=2*dd2*distp(0,1)**3*(-1.d0+3.d0*dd2*r(0)**2)
!    1+2*dd3*dd4*distp(0,2)**3*(-1.d0+3.d0*dd4*r(0)**2)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp172b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp172b0
        fun2b = fun2b + temp172b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp172b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp172b
          funb0 = funb0 + rmu(ic, 0)*temp172b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp171 = (dd2*r(0)+1.)**5
      temp171b = 12.d0*fun2b/temp171
      temp171b0 = -(dd2**2*5*(dd2*r(0)+1.)**4*temp171b/temp171)
      temp170 = (dd4*r(0)+1.)**5
      temp170b = 12.d0*fun2b/temp170
      temp170b0 = -(dd3*dd4**2*5*(dd4*r(0)+1.)**4*temp170b/temp170)
      temp169 = dd2*r(0) + 1.d0
      temp169b = -(3.d0*funb0/(r(0)*temp169))
      temp169b0 = -(dd2*distp(0, 1)*temp169b/(r(0)*temp169))
      dd2b = distp(0, 1)*temp169b + r(0)**2*temp169b0 + r(0)*temp171b0 +&
&        2*dd2*temp171b
      temp168 = dd4*r(0) + 1.d0
      temp168b0 = -(3.d0*funb0/(r(0)*temp168))
      temp168b1 = -(dd4*dd3*distp(0, 2)*temp168b0/(r(0)*temp168))
      rb(0) = rb(0) + (r(0)*dd2+temp169)*temp169b0 + (r(0)*dd4+temp168)*&
&        temp168b1 + dd4*temp170b0 + dd2*temp171b0
      dd3b = distp(0, 2)*dd4*temp168b0 + distp(0, 2)*fun0b + dd4**2*&
&        temp170b
      dd4b = distp(0, 2)*dd3*temp168b0 + r(0)**2*temp168b1 + r(0)*&
&        temp170b0 + dd3*2*dd4*temp170b
      distpb = 0.0_8
      distpb(0, 1) = dd2*temp169b
      distpb(0, 2) = dd4*dd3*temp168b0
      distpb(0, 1) = distpb(0, 1) + fun0b
      distpb(0, 2) = distpb(0, 2) + dd3*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      dd4b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp168b = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (distp(i, 1)+dd3*distp(i, 2))*zb(&
&          indorbp, i)
        distpb(i, 1) = distpb(i, 1) + temp168b
        dd3b = dd3b + distp(i, 2)*temp168b
        distpb(i, 2) = distpb(i, 2) + dd3*temp168b
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp166 = dd4*r(k) + 1.d0
      temp167 = temp166**3
      temp166b = -(3*temp166**2*distpb(k, 2)/temp167**2)
      dd4b = dd4b + r(k)*temp166b
      distpb(k, 2) = 0.0_8
      temp164 = dd2*r(k) + 1.d0
      temp165 = temp164**3
      temp164b4 = -(3*temp164**2*distpb(k, 1)/temp165**2)
      rb(k) = rb(k) + dd2*temp164b4 + dd4*temp166b
      dd2b = dd2b + r(k)*temp164b4
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (135) 
!     2p single exponential  r^4 e^{-z r}  !
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(4.d0-dd2*r(0))*r(0)**2
      fun2 = distp(0, 1)*(12*r(0)**2-8*dd2*r(0)**3+dd2**2*r(0)**4)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp174b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp174b0
        fun2b = fun2b + temp174b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp174b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp174b
          funb0 = funb0 + rmu(ic, 0)*temp174b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp173 = r(0)**4
      temp172 = r(0)**3
      temp172b3 = distp(0, 1)*fun2b
      temp172b4 = (4.d0-dd2*r(0))*funb0
      distpb(0, 1) = r(0)**2*temp172b4 + r(0)**4*fun0b + (12*r(0)**2-8*(&
&        dd2*temp172)+dd2**2*temp173)*fun2b
      temp172b5 = distp(0, 1)*r(0)**2*funb0
      rb(0) = rb(0) + distp(0, 1)*2*r(0)*temp172b4 - dd2*temp172b5 + &
&        distp(0, 1)*4*r(0)**3*fun0b + (dd2**2*4*r(0)**3-8*dd2*3*r(0)**2+&
&        12*2*r(0))*temp172b3
      dd2b = (temp173*2*dd2-8*temp172)*temp172b3 - r(0)*temp172b5
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp172b2 = r(i)**4*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp172b2
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp172b2
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*4*r(i)**3*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp172b1 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp172b1
      rb(k) = rb(k) - dd2*temp172b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (114) 
!     2s without cusp condition
!     dd1*( dd3 +r^2/(1+dd2*r)^3)
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
!           endif
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd2*r(0))/(1+dd2*r(0))**4
      fun2b = zb(indorbp, indt+4)
      funb0 = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp177 = (dd2*r(0)+1)**5
      temp177b = 2.d0*fun2b/temp177
      temp177b0 = 2*dd2*r(0)*temp177b
      temp177b1 = -(((dd2*r(0))**2-4.d0*(dd2*r(0))+1.d0)*5*(dd2*r(0)+1)&
&        **4*temp177b/temp177)
      temp176 = (dd2*r(0)+1)**4
      temp176b = funb0/temp176
      temp176b0 = -((2.d0-dd2*r(0))*4*(dd2*r(0)+1)**3*temp176b/temp176)
      dd2b = r(0)*temp176b0 - r(0)*temp176b + r(0)*temp177b1 - 4.d0*r(0)&
&        *temp177b + r(0)*temp177b0
      rb(0) = rb(0) + dd2*temp176b0 - dd2*temp176b + dd2*temp177b1 - &
&        4.d0*dd2*temp177b + dd2*temp177b0
    ELSE
      dd2b = 0.0_8
    END IF
    distpb = 0.0_8
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp174 = dd2*r(k) + 1.d0
      temp175 = temp174**3
      temp174b1 = -(r(k)**2*3*temp174**2*distpb(k, 1)/temp175**2)
      rb(k) = rb(k) + dd2*temp174b1 + 2*r(k)*distpb(k, 1)/temp175
      dd2b = dd2b + r(k)*temp174b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (63) 
! R(r)=c x*exp(-z*r**2)*r (c1 - r^2)
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then
    c = dd1**1.75d0*1.2749263037197753d0
!        c=2.d0/pi**0.75d0*(2.d0*dd1)**1.75d0/dsqrt(5.d0)
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    c1 = 1.75d0/dd1
!        indorbp=indorb
!
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0)**2
      cost = 2.d0*rp1
      fun = distp(0, 1)*(c1*(1.d0-cost)/r(0)+(-3.d0+cost)*r(0))
!           My bug !!!
!           fun2=distp(0,1)*(c1*2.d0*dd1*fun0*(cost-3.d0)
!                                                                &-2.d0*r(0)*(3.d0-7.d0*rp1+2.d0*rp1**2))
      fun2 = -(2.d0*distp(0, 1)*r(0)*(3.d0-7.d0*rp1+2.d0*rp1**2+c1*dd1*(&
&        3.d0-cost)))
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp181b3 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp181b3
        fun2b = fun2b + temp181b3
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp181b2 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp181b2
          funb0 = funb0 + rmu(ic, 0)*temp181b2
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp181b = -(2.d0*(2.d0*rp1**2-7.d0*rp1+c1*dd1*(3.d0-cost)+3.d0)*&
&        fun2b)
      temp181b0 = -(2.d0*distp(0, 1)*r(0)*fun2b)
      temp180 = c1*(-cost+1.d0)/r(0)
      temp180b1 = (c1-r(0)**2)*fun0b
      distpb(0, 1) = (temp180+(cost-3.d0)*r(0))*funb0 + r(0)*temp180b1 +&
&        r(0)*temp181b
      temp181b1 = distp(0, 1)*funb0
      temp180b2 = temp181b1/r(0)
      costb = r(0)*temp181b1 - c1*temp180b2 - c1*dd1*temp181b0
      rp1b = 2.d0*costb + (2.d0*2*rp1-7.d0)*temp181b0
      temp180b3 = distp(0, 1)*r(0)*fun0b
      rb(0) = rb(0) + (cost-3.d0)*temp181b1 - temp180*temp180b2 + dd1*2*&
&        r(0)*rp1b - 2*r(0)*temp180b3 + distp(0, 1)*temp180b1 + distp(0, &
&        1)*temp181b
      c1b = (1.d0-cost)*temp180b2 + temp180b3 + (3.d0-cost)*dd1*&
&        temp181b0
      dd1b = r(0)**2*rp1b + (3.d0-cost)*c1*temp181b0
    ELSE
      distpb = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp179 = c1 - r(i)**2
        temp180b = rmu(ic, i)*temp179*zb(indorbp, i)
        temp180b0 = distp(i, 1)*r(i)*zb(indorbp, i)
        temp179b = rmu(ic, i)*temp180b0
        distpb(i, 1) = distpb(i, 1) + r(i)*temp180b
        rb(i) = rb(i) + distp(i, 1)*temp180b - 2*r(i)*temp179b
        rmub(ic, i) = rmub(ic, i) + temp179*temp180b0
        c1b = c1b + temp179b
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    dd1b = dd1b - 1.75d0*c1b/dd1**2
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp178 = r(k)**2
      temp178b = c*DEXP(-(dd1*temp178))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp178))*distpb(k, 1)
      dd1b = dd1b - temp178*temp178b
      rb(k) = rb(k) - dd1*2*r(k)*temp178b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.2749263037197753d0*1.75d0*dd1**0.75D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (148) 
!  derivative of 147 with respect to dd1
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = -(r(i)**2*distp(i, 1))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!            endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = 2.d0*(dd1*r(0)**2-1.d0)*r(0)*distp(0, 1)
      fun2 = -(2.d0*(2.d0*dd1**2*r(0)**4+1.d0-5.d0*dd1*r(0)**2)*distp(0&
&        , 1))
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp183 = fun/r(0)
        temp184b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp183b3 = 6.d0*temp184b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp183+fun2)*zb(&
&          indorbp, indt+4)
        funb0 = funb0 + temp183b3
        rb(0) = rb(0) - temp183*temp183b3
        fun2b = fun2b + temp184b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp183b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp183b
                  fun0b = fun0b + rmu(i, 0)*temp183b
                ELSE
                  temp183b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp183b0
                  fun0b = fun0b + rmu(i, 0)*temp183b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp183b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp183b1
                fun0b = fun0b + rmu(i, 0)*temp183b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp183b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp183b2
                fun0b = fun0b + rmu(i, 0)*temp183b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp182 = fun/r(0)
          temp182b = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp182*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp182*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb0 = funb0 + temp182b
          rb(0) = rb(0) - temp182*temp182b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp181 = r(0)**4
      temp181b5 = -(2.d0*distp(0, 1)*fun2b)
      temp181b6 = 2.d0*r(0)*distp(0, 1)*funb0
      dd1b = r(0)**2*temp181b6 + (2.d0*temp181*2*dd1-5.d0*r(0)**2)*&
&        temp181b5
      temp181b7 = 2.d0*(dd1*r(0)**2-1.d0)*funb0
      rb(0) = rb(0) + dd1*2*r(0)*temp181b6 + distp(0, 1)*temp181b7 + (&
&        2.d0*dd1**2*4*r(0)**3-5.d0*dd1*2*r(0))*temp181b5
      distpb(0, 1) = distpb(0, 1) + r(0)*temp181b7 - 2.d0*(2.d0*(dd1**2*&
&        temp181)-5.d0*(dd1*r(0)**2)+1.d0)*fun2b
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      rb(i) = rb(i) - distp(i, 1)*2*r(i)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) - r(i)**2*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp181b4 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp181b4
      rb(k) = rb(k) - dd1*2*r(k)*temp181b4
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (12) 
! R(r)=r**3*exp(-z1*r)
!
!       if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!           c=dsqrt((2*dd1)**9/40320.d0/pi)/2.d0
    c = dd1**4.5d0*.03178848180059307346d0
!           endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**3
      rp2 = r(0)**2
!
!c              the first derivative
      fun = distp(0, 1)*(3.d0*rp2-dd1*rp1)
!c
!c              the second derivative
      temp185b = 2.d0*zb(indorbp, indt+4)/r(0)
      funb0 = temp185b
      rb(0) = rb(0) - fun*temp185b/r(0)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp184 = fun/r(0)
        temp184b3 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp184*zb(indorbp, indt+i)
        funb0 = funb0 + temp184b3
        rb(0) = rb(0) - temp184*temp184b3
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp184b1 = distp(0, 1)*fun2b
      distpb(0, 1) = (3.d0*rp2-dd1*rp1)*funb0 + (6.d0*r(0)-6.d0*(dd1*rp2&
&        )+dd1**2*rp1)*fun2b
      temp184b2 = distp(0, 1)*funb0
      rp2b = 3.d0*temp184b2 - 6.d0*dd1*temp184b1
      rp1b = dd1**2*temp184b1 - dd1*temp184b2
      rb(0) = rb(0) + 2*r(0)*rp2b + 3*r(0)**2*rp1b + 6.d0*temp184b1
      dd1b = (rp1*2*dd1-6.d0*rp2)*temp184b1 - rp1*temp184b2
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**3*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*3*r(i)**2*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp184b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp184b0
      rb(k) = rb(k) - dd1*temp184b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .03178848180059307346d0*4.5d0*dd1**3.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (1000:1099) 
!
! 4s double zeta
!     s gaussian  r**(2*npower)*exp(-alpha*r**2)
    npower = iopt - 1000
    indorbp = indorb + 1
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = r(k)**(2*npower)*DEXP(-(dd2*r(k)**2))
    END DO
!        endif
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp188 = distp(0, 1)/rp1
      temp189b = 2.d0*temp188*fun2b
      temp189b0 = -((npower*4.d0+1.d0)*temp189b)
      temp188b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp187 = distp(0, 1)/rp1
      temp188b0 = 2.d0*temp187*funb0
      dd2b = rp1*temp189b0 - rp1*temp188b0 + 2.d0*rp1**2*2*dd2*temp189b
      temp187b = 2.d0*(npower-dd2*rp1)*funb0/rp1
      rp1b = dd2*temp189b0 - temp187*temp187b - temp188*temp188b - dd2*&
&        temp188b0 + 2.d0*dd2**2*2*rp1*temp189b
      distpb(0, 1) = temp187b + temp188b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp186 = r(k)**2
      temp185 = 2*npower
      temp185b0 = r(k)**temp185*DEXP(-(dd2*temp186))*distpb(k, 1)
      IF (r(k) .LE. 0.0 .AND. (temp185 .EQ. 0.0 .OR. temp185 .NE. INT(&
&          temp185))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp185b0
      ELSE
        rb(k) = rb(k) + DEXP(-(dd2*temp186))*temp185*r(k)**(temp185-1)*&
&          distpb(k, 1) - dd2*2*r(k)*temp185b0
      END IF
      dd2b = dd2b - temp186*temp185b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (144) 
!     2p single exponential  -r^3 e^{-z r}  ! derivative of  130
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(3.d0-dd2*r(0))*r(0)
!           fun= derivative of fun0 respect to r divided dy r
      fun2 = distp(0, 1)*(dd2**2*r(0)**3-6*dd2*r(0)**2+6*r(0))
!           fun2= second derivative of fun0 respect to r
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp190b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp190b0
        fun2b = fun2b + temp190b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp190b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp190b
          funb0 = funb0 + rmu(ic, 0)*temp190b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp189 = r(0)**3
      temp189b3 = distp(0, 1)*fun2b
      temp189b4 = (3.d0-dd2*r(0))*funb0
      distpb(0, 1) = r(0)*temp189b4 + r(0)**3*fun0b + (dd2**2*temp189-6*&
&        (dd2*r(0)**2)+6*r(0))*fun2b
      temp189b5 = distp(0, 1)*r(0)*funb0
      dd2b = (temp189*2*dd2-6*r(0)**2)*temp189b3 - r(0)*temp189b5
      rb(0) = rb(0) + distp(0, 1)*temp189b4 - dd2*temp189b5 + distp(0, 1&
&        )*3*r(0)**2*fun0b + (dd2**2*3*r(0)**2-6*dd2*2*r(0)+6)*temp189b3
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp189b2 = r(i)**3*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp189b2
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp189b2
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*3*r(i)**2*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp189b1 = -(DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp189b1
      rb(k) = rb(k) - dd2*temp189b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (70) 
! f single Slater orbital
! R(r)= exp(-alpha r)
! normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization
! l = 3
! \int d\omega Y*Y = 4 pi / (2 l + 1)
! \int dr r^{2 l + 2} Exp [- 2 dd1 r^2 ] =  7 * 5 * 3**2 / 2**2 / dd1**9
!        c=1.d0/dsqrt(10.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(9.d0/2.d0)/3.d0
    c = dd1**4.5d0*0.084104417400672d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(dd1*distp(0, 1)/r(0))
      fun2 = dd1**2*distp(0, 1)
!              indorbp=indorb
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp191b23 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 8.d0*temp191b23
        fun2b = fun2b + temp191b23
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp191b2 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp191b2
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp191b2
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp191b2
                  END IF
                  temp191b0 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp191b1 = rmu(i, 0)*temp191b0
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp191b0
                  fun0b = fun0b + rmu(3, 0)*temp191b1
                  rmub(3, 0) = rmub(3, 0) + fun0*temp191b1
                  GOTO 110
                ELSE
                  temp191b5 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp191b5
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp191b5
                  rb(0) = rb(0) - fun0*2*r(0)*temp191b5
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp191b6 = cost2f*10.d0*zb(indorbp, indt+i)
                temp191b7 = rmu(i, 0)*temp191b6
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp191b6
                fun0b = fun0b + rmu(1, 0)*temp191b7
                rmub(1, 0) = rmub(1, 0) + fun0*temp191b7
              END IF
              temp191b3 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp191b4 = rmu(i, 0)*temp191b3
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp191b3
              fun0b = fun0b + rmu(1, 0)*temp191b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp191b4
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp191b10 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp191b10
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp191b10
                  rb(0) = rb(0) - fun0*2*r(0)*temp191b10
                END IF
              ELSE
                temp191b11 = cost2f*10.d0*zb(indorbp, indt+i)
                temp191b12 = rmu(i, 0)*temp191b11
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp191b11
                fun0b = fun0b + rmu(2, 0)*temp191b12
                rmub(2, 0) = rmub(2, 0) + fun0*temp191b12
              END IF
              temp191b8 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp191b9 = rmu(i, 0)*temp191b8
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp191b8
              fun0b = fun0b + rmu(2, 0)*temp191b9
              rmub(2, 0) = rmub(2, 0) + fun0*temp191b9
            ELSE IF (branch .LT. 10) THEN
              temp191b13 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp191b13
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp191b13
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp191b13
            ELSE
              temp191b14 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp191b14
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp191b14
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp191b14
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp191b15 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp191b15
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp191b15
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp191b15
                ELSE
                  temp191b16 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp191b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp191b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp191b16
                END IF
              ELSE
                temp191b17 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp191b17
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp191b17
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp191b17
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp191b18 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp191b18
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp191b18
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp191b18
            ELSE
              temp191b19 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp191b19
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp191b19
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp191b19
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp191b20 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp191b20
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp191b20
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp191b20
              END IF
            ELSE
              temp191b21 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp191b21
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp191b21
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp191b21
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp191b22 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp191b22
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp191b22
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp191b22
          END IF
 110      temp191b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp191b
          funb0 = funb0 + rmu(i, 0)*temp191b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp190b10 = -(distp(0, 1)*funb0/r(0))
      dd1b = temp190b10 + distp(0, 1)*2*dd1*fun2b
      temp190 = dd1/r(0)
      distpb(0, 1) = distpb(0, 1) + fun0b - temp190*funb0 + dd1**2*fun2b
      rb(0) = rb(0) - temp190*temp190b10
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp190b2 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp190b2
      distpb(i, 8) = 0.0_8
      temp190b3 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp190b3 + 3.d0*2*rmu(1, i)*&
&        temp190b2
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp190b3
      distpb(i, 7) = 0.0_8
      temp190b4 = cost3f*2.d0*distpb(i, 6)
      temp190b5 = rmu(2, i)*temp190b4
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp190b5
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp190b5
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp190b4
      distpb(i, 6) = 0.0_8
      temp190b6 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp190b6
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp190b6
      temp190b7 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp190b7
      distpb(i, 4) = 0.0_8
      temp190b8 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp190b9 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp190b8 - 3.d0*2*r(i)*temp190b9 - 2*r(i)*&
&        temp190b7
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp190b9 + 5.d0*2*rmu(3, i)*&
&        temp190b8
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp190b1 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp190b1
      rb(k) = rb(k) - dd1*temp190b1
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.084104417400672d0*4.5d0*dd1**3.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (100) 
!     2s single gaussian
!     exp(-dd2*r^2)
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)*2.d0)
      distpb = 0.0_8
      temp191b25 = 2.d0**2*dd2*distp(0, 1)*zb(indorbp, indt+4)
      temp191b26 = 2.d0*(2.d0*(dd2*r(0)**2)-3.d0)*zb(indorbp, indt+4)
      dd2b = distp(0, 1)*temp191b26 + r(0)**2*temp191b25
      rb(0) = rb(0) + dd2*2*r(0)*temp191b25
      distpb(0, 1) = dd2*temp191b26
      zb(indorbp, indt+4) = 0.0_8
      funb0 = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      dd2b = dd2b - 2.d0*distp(0, 1)*funb0
      distpb(0, 1) = distpb(0, 1) - 2.d0*dd2*funb0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp191b24 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp191b24
      rb(k) = rb(k) - dd2*2*r(k)*temp191b24
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (138) 
!     2s with cusp condition
!     ( -dd2*r^2*exp(-dd2*r))  ! with no cusp condition der of 137
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = -(dd2*DEXP(-(dd2*r(k))))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd2*r(0))*distp(0, 1)
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp191b28 = distp(0, 1)*fun2b
      temp191b29 = 2*dd2*r(0)*temp191b28
      dd2b = r(0)*temp191b29 - 4*r(0)*temp191b28 - distp(0, 1)*r(0)*&
&        funb0
      rb(0) = rb(0) + dd2*temp191b29 - 4*dd2*temp191b28 - distp(0, 1)*&
&        dd2*funb0
      distpb(0, 1) = (2.d0-dd2*r(0))*funb0 + ((dd2*r(0))**2-4*(dd2*r(0))&
&        +2.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp191b27 = -(dd2*DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp191b27 - DEXP(-(dd2*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp191b27
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (56) 
! g single Slater orbital derivative of 55
! R(r)= (11.d0/2.0 1/dd1 - r) * exp(-alpha r)
! normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization
! l = 4
! \int d\omega Y*Y = 4 pi / (2 l + 1)
! \int dr r^{2 l + 2} Exp [- 2 dd1 r^2 ] =  7 * 5**2 * 3**4 / 2**3 / dd1**11
    c = dd1**5.5d0*.020104801169736915d0
!        c=1.d0/dsqrt(7.d0)*(2.d0/pi)**(1.d0/2.d0)*dd1**(11.d0/2.d0)/3.d0/5.d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)*(11.d0/2.d0/dd1-r(0))
      fun = distp(0, 1)*(dd1-13.d0/2.d0/r(0))
      fun2 = dd1*distp(0, 1)*(15.d0/2.d0-dd1*r(0))
!              indorbp=indorb
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
          ELSE IF (ic .EQ. 7) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            END IF
          ELSE IF (ic .EQ. 8) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
          ELSE IF (ic .EQ. 9) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp197b57 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb0 = funb0 + 10.d0*temp197b57
        fun2b = fun2b + temp197b57
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 15) THEN
            IF (branch .LT. 8) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    temp197b2 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2)-&
&                      60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp197b2
                    rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp197b2
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0&
&                      )*temp197b2
                  ELSE
                    temp197b3 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-&
&                      60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp197b3
                    rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp197b3
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0&
&                      )*temp197b3
                  END IF
                ELSE IF (branch .LT. 4) THEN
                  temp197b4 = cost1g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(rmu(&
&                    3, 0)*r(0)**2))*zb(indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*&
&                    r(0)**2)*temp197b4
                  rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp197b4
                ELSE
                  temp197b5 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*&
&                    rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp197b5
                  rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp197b5
                  rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp197b5
                END IF
              ELSE IF (branch .LT. 7) THEN
                IF (branch .LT. 6) THEN
                  temp197b6 = -(cost2g*6.d0*zb(indorbp, indt+i))
                  temp197b7 = rmu(2, 0)*rmu(3, 0)*temp197b6
                  temp197b8 = fun0*rmu(1, 0)*temp197b6
                  fun0b = fun0b + rmu(1, 0)*temp197b7
                  rmub(1, 0) = rmub(1, 0) + fun0*temp197b7
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp197b8
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp197b8
                ELSE
                  temp197b9 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp197b10 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp197b9
                  temp197b11 = fun0*rmu(1, 0)*temp197b9
                  fun0b = fun0b + rmu(1, 0)*temp197b10
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp197b11 + &
&                    fun0*temp197b10
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp197b11
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp197b11
                END IF
              ELSE
                temp197b12 = -(cost2g*6.d0*zb(indorbp, indt+i))
                temp197b13 = rmu(2, 0)*rmu(3, 0)*temp197b12
                temp197b14 = fun0*rmu(1, 0)*temp197b12
                fun0b = fun0b + rmu(1, 0)*temp197b13
                rmub(1, 0) = rmub(1, 0) + fun0*temp197b13
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp197b14
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp197b14
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  temp197b15 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*&
&                    rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp197b15
                  rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp197b15
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp197b15
                ELSE
                  temp197b16 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp197b17 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp197b16
                  temp197b18 = fun0*rmu(2, 0)*temp197b16
                  fun0b = fun0b + rmu(2, 0)*temp197b17
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp197b18 + &
&                    fun0*temp197b17
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp197b18
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp197b18
                END IF
              ELSE IF (branch .LT. 11) THEN
                temp197b19 = -(cost3g*4.d0*zb(indorbp, indt+i))
                temp197b20 = fun0*temp197b19
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*temp197b19
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp197b20
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp197b20
              ELSE
                temp197b21 = cost3g*4.d0*zb(indorbp, indt+i)
                temp197b22 = fun0*temp197b21
                fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)&
&                  **2))*temp197b21
                rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp197b22
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp197b22
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                temp197b23 = cost3g*12.d0*zb(indorbp, indt+i)
                temp197b24 = fun0*rmu(3, 0)*temp197b23
                temp197b25 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp197b23
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp197b24
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp197b24
                fun0b = fun0b + rmu(3, 0)*temp197b25
                rmub(3, 0) = rmub(3, 0) + fun0*temp197b25
              ELSE
                temp197b26 = -(cost3g*2.d0*zb(indorbp, indt+i))
                temp197b27 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3&
&                  , 0)**2)*temp197b26
                temp197b28 = fun0*rmu(2, 0)*temp197b26
                fun0b = fun0b + rmu(2, 0)*temp197b27
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp197b28 + fun0*&
&                  temp197b27
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp197b28
                rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp197b28
              END IF
            ELSE
              temp197b29 = -(cost3g*2.d0*zb(indorbp, indt+i))
              temp197b30 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0&
&                )**2)*temp197b29
              temp197b31 = fun0*rmu(1, 0)*temp197b29
              fun0b = fun0b + rmu(1, 0)*temp197b30
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp197b31 + fun0*&
&                temp197b30
              rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp197b31
              rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp197b31
            END IF
          ELSE IF (branch .LT. 22) THEN
            IF (branch .LT. 19) THEN
              IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  temp197b32 = cost3g*24.d0*zb(indorbp, indt+i)
                  temp197b33 = rmu(2, 0)*rmu(3, 0)*temp197b32
                  temp197b34 = fun0*rmu(1, 0)*temp197b32
                  fun0b = fun0b + rmu(1, 0)*temp197b33
                  rmub(1, 0) = rmub(1, 0) + fun0*temp197b33
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp197b34
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp197b34
                ELSE
                  temp197b35 = cost4g*3.d0*zb(indorbp, indt+i)
                  temp197b36 = fun0*rmu(3, 0)*temp197b35
                  temp197b37 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp197b35
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp197b36
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp197b36
                  fun0b = fun0b + rmu(3, 0)*temp197b37
                  rmub(3, 0) = rmub(3, 0) + fun0*temp197b37
                END IF
              ELSE IF (branch .LT. 18) THEN
                temp197b38 = -(cost4g*6.d0*zb(indorbp, indt+i))
                temp197b39 = rmu(2, 0)*rmu(3, 0)*temp197b38
                temp197b40 = fun0*rmu(1, 0)*temp197b38
                fun0b = fun0b + rmu(1, 0)*temp197b39
                rmub(1, 0) = rmub(1, 0) + fun0*temp197b39
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp197b40
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp197b40
              ELSE
                temp197b41 = cost4g*fun0*zb(indorbp, indt+i)
                fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu&
&                  (2, 0)**2))*zb(indorbp, indt+i)
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp197b41
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp197b41
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                temp197b42 = cost4g*6.d0*zb(indorbp, indt+i)
                temp197b43 = rmu(2, 0)*rmu(3, 0)*temp197b42
                temp197b44 = fun0*rmu(1, 0)*temp197b42
                fun0b = fun0b + rmu(1, 0)*temp197b43
                rmub(1, 0) = rmub(1, 0) + fun0*temp197b43
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp197b44
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp197b44
              ELSE
                temp197b45 = cost4g*3.d0*zb(indorbp, indt+i)
                temp197b46 = fun0*rmu(3, 0)*temp197b45
                temp197b47 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp197b45
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp197b46
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp197b46
                fun0b = fun0b + rmu(3, 0)*temp197b47
                rmub(3, 0) = rmub(3, 0) + fun0*temp197b47
              END IF
            ELSE
              temp197b48 = cost4g*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(&
&                2, 0)**3)*zb(indorbp, indt+i)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp197b48
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp197b48
            END IF
          ELSE IF (branch .LT. 26) THEN
            IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                temp197b49 = cost5g*4.d0*zb(indorbp, indt+i)
                temp197b50 = fun0*temp197b49
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp197b49
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp197b50
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp197b50
              END IF
            ELSE IF (branch .LT. 25) THEN
              temp197b51 = cost5g*4.d0*zb(indorbp, indt+i)
              temp197b52 = fun0*temp197b51
              fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)&
&                ))*temp197b51
              rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**&
&                2)*temp197b52
              rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp197b52
            END IF
          ELSE IF (branch .LT. 28) THEN
            IF (branch .LT. 27) THEN
              temp197b53 = cost5g*4.d0*zb(indorbp, indt+i)
              temp197b54 = fun0*temp197b53
              fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**&
&                3)*temp197b53
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp197b54
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp197b54
            END IF
          ELSE
            temp197b55 = cost5g*4.d0*zb(indorbp, indt+i)
            temp197b56 = fun0*temp197b55
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp197b55
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp197b56
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp197b56
          END IF
          temp197b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp197b1
          funb0 = funb0 + rmu(i, 0)*temp197b1
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp197b = (15.d0/2.d0-dd1*r(0))*fun2b
      temp197b0 = dd1*distp(0, 1)*fun2b
      temp194 = 2.d0*dd1
      temp193 = 11.d0/temp194
      dd1b = distp(0, 1)*funb0 - distp(0, 1)*temp193*2.d0*fun0b/temp194 &
&        - r(0)*temp197b0 + distp(0, 1)*temp197b
      temp196 = 2.d0*r(0)
      temp195 = 13.d0/temp196
      distpb(0, 1) = distpb(0, 1) + (dd1-temp195)*funb0 + (temp193-r(0))&
&        *fun0b + dd1*temp197b
      rb(0) = rb(0) + distp(0, 1)*temp195*2.d0*funb0/temp196 - distp(0, &
&        1)*fun0b - dd1*temp197b0
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    dd1b = 0.0_8
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        temp192 = 2.d0*dd1
        temp191 = 11.d0/temp192
        temp191b49 = (temp191-r(k))*zb(indorbp, k)
        temp191b50 = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp191b49
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp191b49
        dd1b = dd1b - temp191*2.d0*temp191b50/temp192
        rb(k) = rb(k) - temp191b50
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp191b31 = cost5g*4.d0*distpb(i, 10)
      temp191b32 = (rmu(1, i)**2-rmu(2, i)**2)*temp191b31
      temp191b33 = rmu(1, i)*rmu(2, i)*temp191b31
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp191b33 + rmu(2, i)*&
&        temp191b32
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp191b32 - 2*rmu(2, i)*&
&        temp191b33
      distpb(i, 10) = 0.0_8
      temp191b34 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp191b34
      distpb(i, 9) = 0.0_8
      temp191b35 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp191b36 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp191b35 - 2*rmu(2, i)*&
&        temp191b36 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp191b34
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp191b35
      distpb(i, 8) = 0.0_8
      temp191b37 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp191b38 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp191b37 + 2*rmu(1, i)*&
&        temp191b38 + 3.d0*2*rmu(1, i)*temp191b36
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp191b37
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp191b38
      distpb(i, 7) = 0.0_8
      temp191b39 = cost3g*2.d0*distpb(i, 6)
      temp191b40 = (7.d0*rmu(3, i)**2-r(i)**2)*temp191b39
      temp191b41 = rmu(1, i)*rmu(2, i)*temp191b39
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp191b40
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp191b40
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp191b41
      distpb(i, 6) = 0.0_8
      temp191b42 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp191b43 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp191b44 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp191b45 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp191b46 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp191b47 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp191b48 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp191b48 - 3.d0*2*r(i)*temp191b47 - 2*r(i)*temp191b43 - 3.d0*2&
&        *r(i)*temp191b45 - 2*r(i)*temp191b41
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp191b42
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp191b42
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp191b43
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp191b44
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp191b45 + rmu(2, i)*&
&        temp191b44
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp191b46
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp191b48 + 7.d0*2*rmu(3, i)*temp191b47 + rmu(1, i)*&
&        temp191b46
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp191b30 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp191b30
      rb(k) = rb(k) - dd1*temp191b30
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .020104801169736915d0*5.5d0*dd1**4.5D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (1) 
! s orbital
! 
! - angmom = 0
! - type = Slater
! - normalized = yes
! - angtype = spherical
! - npar = 1
! - multiplicity = 1
!
    dd1 = dd(indpar+1)
    c = dd1*DSQRT(dd1)*0.56418958354775628695d0
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1))
      distpb = 0.0_8
      temp199 = dd1/r(0)
      temp199b = -(distp(0, 1)*2.d0*zb(indorbp, indt+4)/r(0))
      dd1b = temp199b + distp(0, 1)*2*dd1*zb(indorbp, indt+4)
      rb(0) = rb(0) - temp199*temp199b
      distpb(0, 1) = (dd1**2-2.d0*temp199)*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      funb0 = 0.0_8
      DO i=3,1,-1
        temp198 = fun/r(0)
        temp198b0 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp198*zb(indorbp, indt+i)
        funb0 = funb0 + temp198b0
        rb(0) = rb(0) - temp198*temp198b0
        zb(indorbp, indt+i) = 0.0_8
      END DO
      dd1b = dd1b - distp(0, 1)*funb0
      distpb(0, 1) = distpb(0, 1) - dd1*funb0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp198b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp198b
      rb(k) = rb(k) - dd1*temp198b
      distpb(k, 1) = 0.0_8
    END DO
    temp197 = DSQRT(dd1)
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + 0.56418958354775628695d0*temp197*cb
    ELSE
      dd1b = dd1b + (0.56418958354775628695d0*dd1/(2.D0*DSQRT(dd1))+&
&        0.56418958354775628695d0*temp197)*cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (49) 
! f orbitals
! R(r)= c*exp(-z r^2)*(9/4/z-r^2)
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization
!        c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)
    c = dd1**2.25d0*1.47215808929909374563d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)*(9.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-13.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+19.d0*dd1*r(0)**2-13.d0&
&        /2.d0)
!              indorbp=indorb
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp206b23 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 8.d0*temp206b23
        fun2b = fun2b + temp206b23
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp206b2 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp206b2
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp206b2
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp206b2
                  END IF
                  temp206b0 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp206b1 = rmu(i, 0)*temp206b0
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp206b0
                  fun0b = fun0b + rmu(3, 0)*temp206b1
                  rmub(3, 0) = rmub(3, 0) + fun0*temp206b1
                  GOTO 120
                ELSE
                  temp206b5 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp206b5
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp206b5
                  rb(0) = rb(0) - fun0*2*r(0)*temp206b5
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp206b6 = cost2f*10.d0*zb(indorbp, indt+i)
                temp206b7 = rmu(i, 0)*temp206b6
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp206b6
                fun0b = fun0b + rmu(1, 0)*temp206b7
                rmub(1, 0) = rmub(1, 0) + fun0*temp206b7
              END IF
              temp206b3 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp206b4 = rmu(i, 0)*temp206b3
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp206b3
              fun0b = fun0b + rmu(1, 0)*temp206b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp206b4
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp206b10 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp206b10
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp206b10
                  rb(0) = rb(0) - fun0*2*r(0)*temp206b10
                END IF
              ELSE
                temp206b11 = cost2f*10.d0*zb(indorbp, indt+i)
                temp206b12 = rmu(i, 0)*temp206b11
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp206b11
                fun0b = fun0b + rmu(2, 0)*temp206b12
                rmub(2, 0) = rmub(2, 0) + fun0*temp206b12
              END IF
              temp206b8 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp206b9 = rmu(i, 0)*temp206b8
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp206b8
              fun0b = fun0b + rmu(2, 0)*temp206b9
              rmub(2, 0) = rmub(2, 0) + fun0*temp206b9
            ELSE IF (branch .LT. 10) THEN
              temp206b13 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp206b13
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp206b13
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp206b13
            ELSE
              temp206b14 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp206b14
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp206b14
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp206b14
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp206b15 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp206b15
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp206b15
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp206b15
                ELSE
                  temp206b16 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp206b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp206b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp206b16
                END IF
              ELSE
                temp206b17 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp206b17
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp206b17
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp206b17
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp206b18 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp206b18
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp206b18
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp206b18
            ELSE
              temp206b19 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp206b19
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp206b19
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp206b19
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp206b20 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp206b20
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp206b20
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp206b20
              END IF
            ELSE
              temp206b21 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp206b21
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp206b21
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp206b21
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp206b22 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp206b22
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp206b22
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp206b22
          END IF
 120      temp206b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp206b
          funb0 = funb0 + rmu(i, 0)*temp206b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp205 = r(0)**4
      temp205b = distp(0, 1)*fun2b
      temp204 = 4.d0*dd1
      temp203 = 9.d0/temp204
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-13.d0/2.d0)*&
&        funb0 + (temp203-r(0)**2)*fun0b + (19.d0*(dd1*r(0)**2)-13.d0/&
&        2.d0-4.d0*(dd1**2*temp205))*fun2b
      temp205b0 = distp(0, 1)*2.d0*funb0
      dd1b = r(0)**2*temp205b0 - distp(0, 1)*temp203*4.d0*fun0b/temp204 &
&        + (19.d0*r(0)**2-4.d0*temp205*2*dd1)*temp205b
      rb(0) = rb(0) + dd1*2*r(0)*temp205b0 - distp(0, 1)*2*r(0)*fun0b + &
&        (19.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp205b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    dd1b = 0.0_8
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        temp203b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp202 = 4.d0*dd1
        temp201 = 9.d0/temp202
        temp201b7 = (temp201-r(k)**2)*zb(indorbp, k)
        dd1b = dd1b - temp201*4.d0*temp203b/temp202
        rb(k) = rb(k) - 2*r(k)*temp203b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp201b7
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp201b7
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp201b = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp201b
      distpb(i, 8) = 0.0_8
      temp201b0 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp201b0 + 3.d0*2*rmu(1, i)*temp201b
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp201b0
      distpb(i, 7) = 0.0_8
      temp201b1 = cost3f*2.d0*distpb(i, 6)
      temp201b2 = rmu(2, i)*temp201b1
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp201b2
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp201b2
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp201b1
      distpb(i, 6) = 0.0_8
      temp201b3 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp201b3
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp201b3
      temp201b4 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp201b4
      distpb(i, 4) = 0.0_8
      temp201b5 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp201b6 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp201b5 - 3.d0*2*r(i)*temp201b6 - 2*r(i)*&
&        temp201b4
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp201b6 + 5.d0*2*rmu(3, i)*&
&        temp201b5
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp200 = r(k)**2
      temp200b = c*DEXP(-(dd1*temp200))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp200))*distpb(k, 1)
      dd1b = dd1b - temp200*temp200b
      rb(k) = rb(k) - dd1*2*r(k)*temp200b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.47215808929909374563d0*2.25d0*dd1**1.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (141) 
!     2p single exponential  r^2  e^{-z r}  ! parent of 121
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(2.d0-dd2*r(0))
      fun2 = (2.d0-4.d0*dd2*r(0)+(dd2*r(0))**2)*distp(0, 1)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp206b29 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp206b29
        fun2b = fun2b + temp206b29
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp206b28 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp206b28
          funb0 = funb0 + rmu(ic, 0)*temp206b28
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp206b26 = distp(0, 1)*fun2b
      temp206b27 = 2*dd2*r(0)*temp206b26
      dd2b = r(0)*temp206b27 - 4.d0*r(0)*temp206b26 - distp(0, 1)*r(0)*&
&        funb0
      rb(0) = rb(0) + distp(0, 1)*2*r(0)*fun0b - distp(0, 1)*dd2*funb0 -&
&        4.d0*dd2*temp206b26 + dd2*temp206b27
      distpb(0, 1) = (2.d0-dd2*r(0))*funb0 + r(0)**2*fun0b + ((dd2*r(0))&
&        **2-4.d0*(dd2*r(0))+2.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp206b25 = r(i)**2*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp206b25
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp206b25
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp206b24 = -(DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp206b24
      rb(k) = rb(k) - dd2*temp206b24
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (26) 
! der of 127
! s orbital
! 
! - angmom = 1
! - type = Slater
! - normalized = yes
! - angtype = spherical
! - npar = 5
! - multiplicity = 3
!
! 2p with cusp conditions
!
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
    dd3 = dd(indpar+4)
    peff2 = dd(indpar+5)
    c = 1.d0/2.d0/DSQRT(8.d0*pi*(1.d0/(2.d0*dd1)**5+2.d0*peff/(dd1+dd2)&
&      **5+peff**2/(2.d0*dd2)**5+2.d0*peff2/(dd1+dd3)**5+peff2**2/(2.d0*&
&      dd3)**5+2.d0*peff2*peff/(dd2+dd3)**5))
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
      distp(k, 3) = c*DEXP(-(dd3*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = distp(i, 1) + peff*distp(i, 2) + peff2*distp(i, 3)
    END DO
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb + ic
    END DO
    IF (typec .NE. 1) THEN
      fun = (-(dd1*distp(0, 1))-dd2*peff*distp(0, 2)-dd3*peff2*distp(0, &
&        3))/r(0)
      fun2 = dd1**2*distp(0, 1) + peff*dd2**2*distp(0, 2) + peff2*dd3**2&
&        *distp(0, 3)
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp220b6 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp220b6
        fun2b = fun2b + temp220b6
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) distpb(0, 4) = distpb(0, 4) + zb(&
&              indorbp, indt+i)
          temp220b5 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp220b5
          funb0 = funb0 + rmu(ic, 0)*temp220b5
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp220b2 = dd2**2*fun2b
      temp220b3 = dd3**2*fun2b
      temp220b4 = funb0/r(0)
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*temp220b4
      distpb(0, 1) = distpb(0, 1) + dd1**2*fun2b
      dd2b = peff*distp(0, 2)*2*dd2*fun2b - distp(0, 2)*peff*temp220b4
      peffb = distp(0, 2)*temp220b2 - distp(0, 2)*dd2*temp220b4
      distpb(0, 2) = distpb(0, 2) + peff*temp220b2
      dd3b = peff2*distp(0, 3)*2*dd3*fun2b - distp(0, 3)*peff2*temp220b4
      peff2b = distp(0, 3)*temp220b3 - distp(0, 3)*dd3*temp220b4
      distpb(0, 3) = distpb(0, 3) + peff2*temp220b3
      distpb(0, 1) = distpb(0, 1) - dd1*temp220b4
      distpb(0, 2) = distpb(0, 2) - dd2*peff*temp220b4
      distpb(0, 3) = distpb(0, 3) - dd3*peff2*temp220b4
      rb(0) = rb(0) - (-(dd1*distp(0, 1))-dd2*peff*distp(0, 2)-dd3*peff2&
&        *distp(0, 3))*temp220b4/r(0)
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      peff2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 4)*zb(indorbp, i)
        distpb(i, 4) = distpb(i, 4) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distpb(i, 1) = distpb(i, 1) + distpb(i, 4)
      peffb = peffb + distp(i, 2)*distpb(i, 4)
      distpb(i, 2) = distpb(i, 2) + peff*distpb(i, 4)
      peff2b = peff2b + distp(i, 3)*distpb(i, 4)
      distpb(i, 3) = distpb(i, 3) + peff2*distpb(i, 4)
      distpb(i, 4) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp220b = c*DEXP(-(dd3*r(k)))*distpb(k, 3)
      cb = cb + DEXP(-(dd3*r(k)))*distpb(k, 3)
      dd3b = dd3b - r(k)*temp220b
      distpb(k, 3) = 0.0_8
      temp220b0 = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      temp220b1 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp220b0 - dd1*temp220b1 - dd3*temp220b
      dd2b = dd2b - r(k)*temp220b0
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp220b1
      distpb(k, 1) = 0.0_8
    END DO
    temp219 = (dd2+dd3)**5
    temp206 = peff2*peff/temp219
    temp218 = 2.d0**5
    temp217 = temp218*dd3**5
    temp216 = peff2**2/temp217
    temp215 = (dd1+dd3)**5
    temp214 = 2.d0**5
    temp213 = temp214*dd2**5
    temp212 = peff**2/temp213
    temp211 = (dd1+dd2)**5
    temp210 = 2.d0**5
    temp209 = temp210*dd1**5
    temp208 = 8.d0*pi*(1.0/temp209+2.d0*peff/temp211+temp212+2.d0*peff2/&
&      temp215+temp216+2.d0*temp206)
    temp207 = DSQRT(temp208)
    IF (temp208 .EQ. 0.0) THEN
      temp207b = 0.0
    ELSE
      temp207b = -(pi*8.d0*cb/(2.d0*temp207**2*2.D0*DSQRT(temp208)))
    END IF
    temp207b0 = 2.d0*temp207b/temp211
    temp207b1 = -(peff*5*(dd1+dd2)**4*temp207b0/temp211)
    temp207b2 = 2.d0*temp207b/temp215
    temp207b3 = -(peff2*5*(dd1+dd3)**4*temp207b2/temp215)
    temp206b30 = 2.d0*temp207b/temp219
    temp206b31 = -(temp206*5*(dd2+dd3)**4*temp206b30)
    dd1b = dd1b + temp207b3 + temp207b1 - temp210*5*dd1**4*temp207b/&
&      temp209**2
    peffb = peffb + peff2*temp206b30 + 2*peff*temp207b/temp213 + &
&      temp207b0
    dd2b = dd2b + temp206b31 - temp212*temp214*5*dd2**4*temp207b/temp213&
&      + temp207b1
    peff2b = peff2b + peff*temp206b30 + 2*peff2*temp207b/temp217 + &
&      temp207b2
    dd3b = dd3b + temp206b31 - temp216*temp218*5*dd3**4*temp207b/temp217&
&      + temp207b3
    ddb(indpar+5) = ddb(indpar+5) + peff2b
    ddb(indpar+4) = ddb(indpar+4) + dd3b
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (86) 
! f single gaussian orbital
! R(r)= exp(-alpha r^2)
! normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!        if(iflagnorm.gt.2) then
! overall normalization
!        c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)*ratiocf
    c = dd1**2.25d0*ratiocf
!        endif
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 1)
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = -(dd1*distp(0, 1)*(2.d0+rp2)/rp3)
!              the second derivative
      fun2 = dd1*distp(0, 1)*(-2.d0-2.d0*rp2+4.d0*rp1+4.d0*rp1*rp2+rp1**&
&        2)/rp3**2
!              indorbp=indorb
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp224b23 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 8.d0*temp224b23
        fun2b = fun2b + temp224b23
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp224b2 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp224b2
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp224b2
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp224b2
                  END IF
                  temp224b0 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp224b1 = rmu(i, 0)*temp224b0
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp224b0
                  fun0b = fun0b + rmu(3, 0)*temp224b1
                  rmub(3, 0) = rmub(3, 0) + fun0*temp224b1
                  GOTO 130
                ELSE
                  temp224b5 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp224b5
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp224b5
                  rb(0) = rb(0) - fun0*2*r(0)*temp224b5
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp224b6 = cost2f*10.d0*zb(indorbp, indt+i)
                temp224b7 = rmu(i, 0)*temp224b6
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp224b6
                fun0b = fun0b + rmu(1, 0)*temp224b7
                rmub(1, 0) = rmub(1, 0) + fun0*temp224b7
              END IF
              temp224b3 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp224b4 = rmu(i, 0)*temp224b3
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp224b3
              fun0b = fun0b + rmu(1, 0)*temp224b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp224b4
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp224b10 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp224b10
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp224b10
                  rb(0) = rb(0) - fun0*2*r(0)*temp224b10
                END IF
              ELSE
                temp224b11 = cost2f*10.d0*zb(indorbp, indt+i)
                temp224b12 = rmu(i, 0)*temp224b11
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp224b11
                fun0b = fun0b + rmu(2, 0)*temp224b12
                rmub(2, 0) = rmub(2, 0) + fun0*temp224b12
              END IF
              temp224b8 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp224b9 = rmu(i, 0)*temp224b8
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp224b8
              fun0b = fun0b + rmu(2, 0)*temp224b9
              rmub(2, 0) = rmub(2, 0) + fun0*temp224b9
            ELSE IF (branch .LT. 10) THEN
              temp224b13 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp224b13
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp224b13
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp224b13
            ELSE
              temp224b14 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp224b14
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp224b14
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp224b14
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp224b15 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp224b15
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp224b15
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp224b15
                ELSE
                  temp224b16 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp224b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp224b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp224b16
                END IF
              ELSE
                temp224b17 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp224b17
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp224b17
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp224b17
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp224b18 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp224b18
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp224b18
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp224b18
            ELSE
              temp224b19 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp224b19
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp224b19
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp224b19
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp224b20 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp224b20
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp224b20
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp224b20
              END IF
            ELSE
              temp224b21 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp224b21
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp224b21
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp224b21
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp224b22 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp224b22
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp224b22
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp224b22
          END IF
 130      temp224b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp224b
          funb0 = funb0 + rmu(i, 0)*temp224b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp223 = rp3**2
      temp222b = (4.d0*rp1-2.d0*rp2+4.d0*(rp1*rp2)+rp1**2-2.d0)*fun2b/&
&        temp223
      temp222 = dd1*distp(0, 1)/temp223
      temp222b0 = temp222*fun2b
      rp1b = (2*rp1+4.d0*rp2+4.d0)*temp222b0
      temp221b8 = -(distp(0, 1)*(rp2+2.d0)*funb0/rp3)
      dd1b = temp221b8 + r(0)**2*rp1b + distp(0, 1)*temp222b
      temp221 = dd1/rp3
      distpb(0, 1) = distpb(0, 1) + fun0b - temp221*(rp2+2.d0)*funb0 + &
&        dd1*temp222b
      rp3b = -(temp221*temp221b8) - temp222*2*rp3*temp222b
      rp2b = 2*(rp2+1.d0)*rp3b - temp221*distp(0, 1)*funb0 + (4.d0*rp1-&
&        2.d0)*temp222b0
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp221b0 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp221b0
      distpb(i, 8) = 0.0_8
      temp221b1 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp221b1 + 3.d0*2*rmu(1, i)*&
&        temp221b0
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp221b1
      distpb(i, 7) = 0.0_8
      temp221b2 = cost3f*2.d0*distpb(i, 6)
      temp221b3 = rmu(2, i)*temp221b2
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp221b3
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp221b3
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp221b2
      distpb(i, 6) = 0.0_8
      temp221b4 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp221b4
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp221b4
      temp221b5 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp221b5
      distpb(i, 4) = 0.0_8
      temp221b6 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp221b7 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp221b6 - 3.d0*2*r(i)*temp221b7 - 2*r(i)*&
&        temp221b5
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp221b7 + 5.d0*2*rmu(3, i)*&
&        temp221b6
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp220 = dd2*r(k) + 1.d0
      temp221b = costb/temp220
      temp220b7 = -(dd1*r(k)**2*temp221b/temp220)
      dd1b = dd1b + r(k)**2*temp221b
      rb(k) = rb(k) + dd2*temp220b7 + dd1*2*r(k)*temp221b
      dd2b = dd2b + r(k)*temp220b7
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocf*2.25d0*dd1**1.25D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocf*2.25d0*dd1**1.25D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (101) 
! derivative of 48 with respect to z
!     2s without cusp condition
!     dd1*( dd3 +exp(-dd2*r^2))
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)*2.d0)
      distpb = 0.0_8
      temp224b25 = 2.d0**2*dd2*distp(0, 1)*zb(indorbp, indt+4)
      temp224b26 = 2.d0*(2.d0*(dd2*r(0)**2)-3.d0)*zb(indorbp, indt+4)
      dd2b = distp(0, 1)*temp224b26 + r(0)**2*temp224b25
      rb(0) = rb(0) + dd2*2*r(0)*temp224b25
      distpb(0, 1) = dd2*temp224b26
      zb(indorbp, indt+4) = 0.0_8
      funb0 = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      dd2b = dd2b - 2.d0*distp(0, 1)*funb0
      distpb(0, 1) = distpb(0, 1) - 2.d0*dd2*funb0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp224b24 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp224b24
      rb(k) = rb(k) - dd2*2*r(k)*temp224b24
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (150) 
!     2p single exponential  r e^{-z r^2}
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 1)*r(0)
      cost = 2.d0*dd2*r(0)**2
      fun = distp(0, 1)*(1.d0-cost)/r(0)
      fun2 = 2.d0*dd2*fun0*(cost-3.d0)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp225b1 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp225b1
        fun2b = fun2b + temp225b1
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp225b0 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp225b0
          funb0 = funb0 + rmu(ic, 0)*temp225b0
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp225b = 2.d0*(cost-3.d0)*fun2b
      temp224b29 = distp(0, 1)*funb0/r(0)
      costb = 2.d0*dd2*fun0*fun2b - temp224b29
      dd2b = 2.d0*r(0)**2*costb + fun0*temp225b
      fun0b = fun0b + dd2*temp225b
      distpb = 0.0_8
      temp224 = (-cost+1.d0)/r(0)
      distpb(0, 1) = r(0)*fun0b + temp224*funb0
      rb(0) = rb(0) + 2.d0*dd2*2*r(0)*costb + distp(0, 1)*fun0b - &
&        temp224*temp224b29
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp224b28 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*r(i)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + r(i)*temp224b28
        rb(i) = rb(i) + distp(i, 1)*temp224b28
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp224b27 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp224b27
      rb(k) = rb(k) - dd2*2*r(k)*temp224b27
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (155) 
! Jastrow single gaussian f orbital
! derivative of 154 with respect to z
! unnormalized f orbitals
! R(r)= -r^2*exp(-z r^2)
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = -(r(0)**2*distp(0, 1))
      fun = 2.d0*(dd1*r(0)**2-1.d0)*distp(0, 1)
      fun2 = -(2.d0*(2.d0*dd1**2*r(0)**4+1.d0-5.d0*dd1*r(0)**2)*distp(0&
&        , 1))
!              indorbp=indorb
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp226b23 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 8.d0*temp226b23
        fun2b = fun2b + temp226b23
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp226b2 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp226b2
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp226b2
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp226b2
                  END IF
                  temp226b0 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp226b1 = rmu(i, 0)*temp226b0
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp226b0
                  fun0b = fun0b + rmu(3, 0)*temp226b1
                  rmub(3, 0) = rmub(3, 0) + fun0*temp226b1
                  GOTO 140
                ELSE
                  temp226b5 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp226b5
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp226b5
                  rb(0) = rb(0) - fun0*2*r(0)*temp226b5
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp226b6 = cost2f*10.d0*zb(indorbp, indt+i)
                temp226b7 = rmu(i, 0)*temp226b6
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp226b6
                fun0b = fun0b + rmu(1, 0)*temp226b7
                rmub(1, 0) = rmub(1, 0) + fun0*temp226b7
              END IF
              temp226b3 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp226b4 = rmu(i, 0)*temp226b3
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp226b3
              fun0b = fun0b + rmu(1, 0)*temp226b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp226b4
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp226b10 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp226b10
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp226b10
                  rb(0) = rb(0) - fun0*2*r(0)*temp226b10
                END IF
              ELSE
                temp226b11 = cost2f*10.d0*zb(indorbp, indt+i)
                temp226b12 = rmu(i, 0)*temp226b11
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp226b11
                fun0b = fun0b + rmu(2, 0)*temp226b12
                rmub(2, 0) = rmub(2, 0) + fun0*temp226b12
              END IF
              temp226b8 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp226b9 = rmu(i, 0)*temp226b8
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp226b8
              fun0b = fun0b + rmu(2, 0)*temp226b9
              rmub(2, 0) = rmub(2, 0) + fun0*temp226b9
            ELSE IF (branch .LT. 10) THEN
              temp226b13 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp226b13
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp226b13
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp226b13
            ELSE
              temp226b14 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp226b14
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp226b14
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp226b14
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp226b15 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp226b15
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp226b15
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp226b15
                ELSE
                  temp226b16 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp226b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp226b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp226b16
                END IF
              ELSE
                temp226b17 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp226b17
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp226b17
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp226b17
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp226b18 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp226b18
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp226b18
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp226b18
            ELSE
              temp226b19 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp226b19
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp226b19
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp226b19
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp226b20 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp226b20
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp226b20
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp226b20
              END IF
            ELSE
              temp226b21 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp226b21
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp226b21
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp226b21
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp226b22 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp226b22
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp226b22
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp226b22
          END IF
 140      temp226b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp226b
          funb0 = funb0 + rmu(i, 0)*temp226b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp225 = r(0)**4
      temp225b12 = -(2.d0*distp(0, 1)*fun2b)
      temp225b13 = 2.d0*distp(0, 1)*funb0
      dd1b = r(0)**2*temp225b13 + (2.d0*temp225*2*dd1-5.d0*r(0)**2)*&
&        temp225b12
      rb(0) = rb(0) + dd1*2*r(0)*temp225b13 - distp(0, 1)*2*r(0)*fun0b +&
&        (2.d0*dd1**2*4*r(0)**3-5.d0*dd1*2*r(0))*temp225b12
      distpb(0, 1) = distpb(0, 1) + 2.d0*(dd1*r(0)**2-1.d0)*funb0 - r(0)&
&        **2*fun0b - 2.d0*(2.d0*(dd1**2*temp225)-5.d0*(dd1*r(0)**2)+1.d0)&
&        *fun2b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        temp225b11 = -(r(k)**2*zb(indorbp, k))
        rb(k) = rb(k) - distp(k, 1)*distp(k, 1+ic)*2*r(k)*zb(indorbp, k)
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp225b11
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp225b11
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp225b3 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp225b3
      distpb(i, 8) = 0.0_8
      temp225b4 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp225b4 + 3.d0*2*rmu(1, i)*&
&        temp225b3
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp225b4
      distpb(i, 7) = 0.0_8
      temp225b5 = cost3f*2.d0*distpb(i, 6)
      temp225b6 = rmu(2, i)*temp225b5
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp225b6
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp225b6
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp225b5
      distpb(i, 6) = 0.0_8
      temp225b7 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp225b7
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp225b7
      temp225b8 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp225b8
      distpb(i, 4) = 0.0_8
      temp225b9 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp225b10 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp225b9 - 3.d0*2*r(i)*temp225b10 - 2*r(i)&
&        *temp225b8
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp225b10 + 5.d0*2*rmu(3, i)*&
&        temp225b9
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    DO k=indtm,indtmin,-1
      temp225b2 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp225b2
      rb(k) = rb(k) - dd1*2*r(k)*temp225b2
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (83) 
! R(r)=x*exp(-z*r**2)*(5/4/z-r**2)
    dd1 = dd(indpar+1)
    dd2 = DSQRT(dd1)
    c = dd1**1.25d0*ratiocp
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
!        indorbp=indorb
!
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
      DO i=i0,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
        cost = (1.d0+0.5d0*dd2*r(i))/(1.d0+dd2*r(i))**2
      END DO
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = (1.d0+0.5d0*rp2)/rp3
      fun = 0.25d0*distp(0, 1)*(-18.d0-39.d0*rp2-20.d0*rp1+rp1*rp2+2.d0*&
&        rp1**2)/rp3**2
      fun2 = 0.25d0*distp(0, 1)*(-18.d0-42.d0*rp2+30.d0*rp1+138.d0*rp1*&
&        rp2+113.d0*rp1**2+30.d0*rp1**2*rp2-3.d0*rp1**3-2.d0*rp1**3*rp2)/&
&        rp3**3
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp233b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp233b0
        fun2b = fun2b + temp233b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp233b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp233b
          funb0 = funb0 + rmu(ic, 0)*temp233b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp232 = rp3**3
      temp230 = distp(0, 1)/temp232
      temp231 = rp1**3
      temp231b = 0.25d0*temp230*fun2b
      temp230b = 0.25d0*(30.d0*rp1-42.d0*rp2+138.d0*(rp1*rp2)+113.d0*rp1&
&        **2+30.d0*(rp1**2*rp2)-3.d0*rp1**3-2.d0*(temp231*rp2)-18.d0)*&
&        fun2b/temp232
      temp229 = rp3**2
      temp228 = distp(0, 1)/temp229
      temp229b = 0.25d0*temp228*funb0
      rp1b = (2.d0*2*rp1+rp2-20.d0)*temp229b + (30.d0*rp2*2*rp1-3.d0*3*&
&        rp1**2-2.d0*rp2*3*rp1**2+113.d0*2*rp1+138.d0*rp2+30.d0)*temp231b
      temp228b2 = 0.25d0*(rp1*rp2-20.d0*rp1-39.d0*rp2+2.d0*rp1**2-18.d0)&
&        *funb0/temp229
      temp228b3 = distp(0, 1)*fun0b
      costb = -(r(0)**2*temp228b3)
      rp3b = -(temp228*2*rp3*temp228b2) - (0.5d0*rp2+1.d0)*costb/rp3**2 &
&        - temp230*3*rp3**2*temp230b
      rp2b = (rp1-39.d0)*temp229b + 2*(rp2+1.d0)*rp3b + 0.5d0*costb/rp3 &
&        + (30.d0*rp1**2-2.d0*temp231+138.d0*rp1-42.d0)*temp231b
      distpb(0, 1) = temp228b2 + (1.25d0/dd1-r(0)**2*cost)*fun0b + &
&        temp230b
      dd1b = r(0)**2*rp1b - 1.25d0*temp228b3/dd1**2
      rb(0) = rb(0) + dd2*rp2b + dd1*2*r(0)*rp1b - cost*2*r(0)*temp228b3
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd2b = r(0)*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp228b = (1.25d0/dd1-r(i)**2*cost)*zb(indorbp, i)
        temp228b0 = rmu(ic, i)*distp(i, 1)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp228b
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp228b
        dd1b = dd1b - 1.25d0*temp228b0/dd1**2
        costb = -(r(i)**2*temp228b0)
        temp227 = dd2*r(i) + 1.d0
        temp228b1 = costb/temp227**2
        temp227b0 = -((0.5d0*(dd2*r(i))+1.d0)*2*temp228b1/temp227)
        rb(i) = rb(i) + 0.5d0*dd2*temp228b1 + dd2*temp227b0 - cost*2*r(i&
&          )*temp228b0
        zb(indorbp, i) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,cost)
        dd2b = dd2b + r(i)*temp227b0 + 0.5d0*r(i)*temp228b1
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp226 = dd2*r(k) + 1.d0
      temp227b = costb/temp226
      temp226b24 = -(dd1*r(k)**2*temp227b/temp226)
      dd1b = dd1b + r(k)**2*temp227b
      rb(k) = rb(k) + dd2*temp226b24 + dd1*2*r(k)*temp227b
      dd2b = dd2b + r(k)*temp226b24
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocp*1.25d0*dd1**0.25D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocp*1.25d0*dd1**0.25D0*&
&        cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (81) 
! R(r)=c*exp(-z*r**2)*(3/4/z-r**2)
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = DSQRT(dd1)
!         c=(2.d0*dd1/pi)**(3.d0/4.d0)*ratiocs
    c = dd1**0.75d0*ratiocs
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=i0,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = (1.d0+0.5d0*dd2*r(i))/(1.d0+dd2*r(i))**2
    END DO
    IF (typec .NE. 1) THEN
!              the first derivative /r
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = 0.25d0*distp(0, 1)*(-14.d0-29.d0*rp2-12.d0*rp1+3.d0*rp1*rp2+&
&        2.d0*rp1**2)/rp3**2
!              the second derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp241 = rp3**3
      temp239 = distp(0, 1)/temp241
      temp240 = rp1**3
      temp240b = 0.25d0*temp239*fun2b
      temp239b = 0.25d0*(34.d0*rp1-30.d0*rp2+118.d0*(rp1*rp2)+87.d0*rp1&
&        **2+18.d0*(rp1**2*rp2)-5.d0*rp1**3-2.d0*(temp240*rp2)-14.d0)*&
&        fun2b/temp241
      temp238 = rp3**2
      temp237 = distp(0, 1)/temp238
      temp238b = 0.25d0*temp237*funb0
      rp1b = (2.d0*2*rp1+3.d0*rp2-12.d0)*temp238b + (18.d0*rp2*2*rp1-&
&        5.d0*3*rp1**2-2.d0*rp2*3*rp1**2+87.d0*2*rp1+118.d0*rp2+34.d0)*&
&        temp240b
      temp237b = 0.25d0*(3.d0*(rp1*rp2)-12.d0*rp1-29.d0*rp2+2.d0*rp1**2-&
&        14.d0)*funb0/temp238
      rp3b = -(temp237*2*rp3*temp237b) - temp239*3*rp3**2*temp239b
      rp2b = (3.d0*rp1-29.d0)*temp238b + 2*(rp2+1.d0)*rp3b + (18.d0*rp1&
&        **2-2.d0*temp240+118.d0*rp1-30.d0)*temp240b
      distpb(0, 1) = temp237b + temp239b
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
      dd1b = r(0)**2*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp236 = 4.d0*dd1
      temp235 = 3.d0/temp236
      temp235b = distp(i, 1)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + (temp235-r(i)**2*cost)*zb(indorbp, i&
&        )
      dd1b = dd1b - temp235*4.d0*temp235b/temp236
      costb = -(r(i)**2*temp235b)
      temp234 = dd2*r(i) + 1.d0
      temp235b0 = costb/temp234**2
      temp234b0 = -((0.5d0*(dd2*r(i))+1.d0)*2*temp235b0/temp234)
      rb(i) = rb(i) + 0.5d0*dd2*temp235b0 + dd2*temp234b0 - cost*2*r(i)*&
&        temp235b
      zb(indorbp, i) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd2b = dd2b + r(i)*temp234b0 + 0.5d0*r(i)*temp235b0
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp233 = dd2*r(k) + 1.d0
      temp234b = costb/temp233
      temp233b1 = -(dd1*r(k)**2*temp234b/temp233)
      dd1b = dd1b + r(k)**2*temp234b
      rb(k) = rb(k) + dd2*temp233b1 + dd1*2*r(k)*temp234b
      dd2b = dd2b + r(k)*temp233b1
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocs*0.75d0*dd1**(-0.25D0)*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocs*0.75d0*dd1**(&
&        -0.25D0)*cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (130) 
!     2p single exponential  r^2  e^{-z r}  ! parent of 121
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(2.d0-dd2*r(0))
      fun2 = (2.d0-4.d0*dd2*r(0)+(dd2*r(0))**2)*distp(0, 1)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp242b4 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp242b4
        fun2b = fun2b + temp242b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp242b3 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp242b3
          funb0 = funb0 + rmu(ic, 0)*temp242b3
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp242b1 = distp(0, 1)*fun2b
      temp242b2 = 2*dd2*r(0)*temp242b1
      dd2b = r(0)*temp242b2 - 4.d0*r(0)*temp242b1 - distp(0, 1)*r(0)*&
&        funb0
      rb(0) = rb(0) + distp(0, 1)*2*r(0)*fun0b - distp(0, 1)*dd2*funb0 -&
&        4.d0*dd2*temp242b1 + dd2*temp242b2
      distpb(0, 1) = (2.d0-dd2*r(0))*funb0 + r(0)**2*fun0b + ((dd2*r(0))&
&        **2-4.d0*(dd2*r(0))+2.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp242b0 = r(i)**2*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp242b0
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp242b0
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp242b = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp242b
      rb(k) = rb(k) - dd2*temp242b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (89) 
! g single gaussian orbital
! derivative of 51
! R(r)= exp(-alpha r^2)
! normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!     if(iflagnorm.gt.2) then
! overall normalization
!     c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)*ratiocg
    c = dd1**2.75d0*ratiocg
!     endif
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
      DO k=i0,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
        cost = (1.d0+0.5d0*dd2*r(k))/(1.d0+dd2*r(k))**2
      END DO
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = (1.d0+0.5d0*rp2)/rp3
      fun0 = distp(0, 1)*(11.d0/4.d0/dd1-r(0)**2*cost)
      fun = 0.25d0*distp(0, 1)*(-30.d0-69.d0*rp2-44.d0*rp1-5.d0*rp1*rp2+&
&        2.d0*rp1**2)/rp3**2
      fun2 = 0.25d0*distp(0, 1)*(-30.d0-78.d0*rp2+18.d0*rp1+198.d0*rp1*&
&        rp2+191.d0*rp1**2+66.d0*rp1**2*rp2+3.d0*rp1**3-2.d0*rp1**3*rp2)/&
&        rp3**3
!              indorbp=indorb
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
          ELSE IF (ic .EQ. 7) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            END IF
          ELSE IF (ic .EQ. 8) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
          ELSE IF (ic .EQ. 9) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp253b55 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb0 = funb0 + 10.d0*temp253b55
        fun2b = fun2b + temp253b55
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 15) THEN
            IF (branch .LT. 8) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    temp253b0 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2)-&
&                      60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp253b0
                    rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp253b0
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0&
&                      )*temp253b0
                  ELSE
                    temp253b1 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-&
&                      60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp253b1
                    rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp253b1
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0&
&                      )*temp253b1
                  END IF
                ELSE IF (branch .LT. 4) THEN
                  temp253b2 = cost1g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(rmu(&
&                    3, 0)*r(0)**2))*zb(indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*&
&                    r(0)**2)*temp253b2
                  rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp253b2
                ELSE
                  temp253b3 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*&
&                    rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp253b3
                  rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp253b3
                  rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp253b3
                END IF
              ELSE IF (branch .LT. 7) THEN
                IF (branch .LT. 6) THEN
                  temp253b4 = -(cost2g*6.d0*zb(indorbp, indt+i))
                  temp253b5 = rmu(2, 0)*rmu(3, 0)*temp253b4
                  temp253b6 = fun0*rmu(1, 0)*temp253b4
                  fun0b = fun0b + rmu(1, 0)*temp253b5
                  rmub(1, 0) = rmub(1, 0) + fun0*temp253b5
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp253b6
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp253b6
                ELSE
                  temp253b7 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp253b8 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp253b7
                  temp253b9 = fun0*rmu(1, 0)*temp253b7
                  fun0b = fun0b + rmu(1, 0)*temp253b8
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp253b9 + fun0&
&                    *temp253b8
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp253b9
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp253b9
                END IF
              ELSE
                temp253b10 = -(cost2g*6.d0*zb(indorbp, indt+i))
                temp253b11 = rmu(2, 0)*rmu(3, 0)*temp253b10
                temp253b12 = fun0*rmu(1, 0)*temp253b10
                fun0b = fun0b + rmu(1, 0)*temp253b11
                rmub(1, 0) = rmub(1, 0) + fun0*temp253b11
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp253b12
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp253b12
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  temp253b13 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*&
&                    rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp253b13
                  rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp253b13
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp253b13
                ELSE
                  temp253b14 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp253b15 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp253b14
                  temp253b16 = fun0*rmu(2, 0)*temp253b14
                  fun0b = fun0b + rmu(2, 0)*temp253b15
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp253b16 + &
&                    fun0*temp253b15
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp253b16
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp253b16
                END IF
              ELSE IF (branch .LT. 11) THEN
                temp253b17 = -(cost3g*4.d0*zb(indorbp, indt+i))
                temp253b18 = fun0*temp253b17
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*temp253b17
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp253b18
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp253b18
              ELSE
                temp253b19 = cost3g*4.d0*zb(indorbp, indt+i)
                temp253b20 = fun0*temp253b19
                fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)&
&                  **2))*temp253b19
                rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp253b20
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp253b20
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                temp253b21 = cost3g*12.d0*zb(indorbp, indt+i)
                temp253b22 = fun0*rmu(3, 0)*temp253b21
                temp253b23 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp253b21
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp253b22
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp253b22
                fun0b = fun0b + rmu(3, 0)*temp253b23
                rmub(3, 0) = rmub(3, 0) + fun0*temp253b23
              ELSE
                temp253b24 = -(cost3g*2.d0*zb(indorbp, indt+i))
                temp253b25 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3&
&                  , 0)**2)*temp253b24
                temp253b26 = fun0*rmu(2, 0)*temp253b24
                fun0b = fun0b + rmu(2, 0)*temp253b25
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp253b26 + fun0*&
&                  temp253b25
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp253b26
                rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp253b26
              END IF
            ELSE
              temp253b27 = -(cost3g*2.d0*zb(indorbp, indt+i))
              temp253b28 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0&
&                )**2)*temp253b27
              temp253b29 = fun0*rmu(1, 0)*temp253b27
              fun0b = fun0b + rmu(1, 0)*temp253b28
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp253b29 + fun0*&
&                temp253b28
              rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp253b29
              rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp253b29
            END IF
          ELSE IF (branch .LT. 22) THEN
            IF (branch .LT. 19) THEN
              IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  temp253b30 = cost3g*24.d0*zb(indorbp, indt+i)
                  temp253b31 = rmu(2, 0)*rmu(3, 0)*temp253b30
                  temp253b32 = fun0*rmu(1, 0)*temp253b30
                  fun0b = fun0b + rmu(1, 0)*temp253b31
                  rmub(1, 0) = rmub(1, 0) + fun0*temp253b31
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp253b32
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp253b32
                ELSE
                  temp253b33 = cost4g*3.d0*zb(indorbp, indt+i)
                  temp253b34 = fun0*rmu(3, 0)*temp253b33
                  temp253b35 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp253b33
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp253b34
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp253b34
                  fun0b = fun0b + rmu(3, 0)*temp253b35
                  rmub(3, 0) = rmub(3, 0) + fun0*temp253b35
                END IF
              ELSE IF (branch .LT. 18) THEN
                temp253b36 = -(cost4g*6.d0*zb(indorbp, indt+i))
                temp253b37 = rmu(2, 0)*rmu(3, 0)*temp253b36
                temp253b38 = fun0*rmu(1, 0)*temp253b36
                fun0b = fun0b + rmu(1, 0)*temp253b37
                rmub(1, 0) = rmub(1, 0) + fun0*temp253b37
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp253b38
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp253b38
              ELSE
                temp253b39 = cost4g*fun0*zb(indorbp, indt+i)
                fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu&
&                  (2, 0)**2))*zb(indorbp, indt+i)
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp253b39
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp253b39
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                temp253b40 = cost4g*6.d0*zb(indorbp, indt+i)
                temp253b41 = rmu(2, 0)*rmu(3, 0)*temp253b40
                temp253b42 = fun0*rmu(1, 0)*temp253b40
                fun0b = fun0b + rmu(1, 0)*temp253b41
                rmub(1, 0) = rmub(1, 0) + fun0*temp253b41
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp253b42
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp253b42
              ELSE
                temp253b43 = cost4g*3.d0*zb(indorbp, indt+i)
                temp253b44 = fun0*rmu(3, 0)*temp253b43
                temp253b45 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp253b43
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp253b44
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp253b44
                fun0b = fun0b + rmu(3, 0)*temp253b45
                rmub(3, 0) = rmub(3, 0) + fun0*temp253b45
              END IF
            ELSE
              temp253b46 = cost4g*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(&
&                2, 0)**3)*zb(indorbp, indt+i)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp253b46
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp253b46
            END IF
          ELSE IF (branch .LT. 26) THEN
            IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                temp253b47 = cost5g*4.d0*zb(indorbp, indt+i)
                temp253b48 = fun0*temp253b47
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp253b47
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp253b48
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp253b48
              END IF
            ELSE IF (branch .LT. 25) THEN
              temp253b49 = cost5g*4.d0*zb(indorbp, indt+i)
              temp253b50 = fun0*temp253b49
              fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)&
&                ))*temp253b49
              rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**&
&                2)*temp253b50
              rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp253b50
            END IF
          ELSE IF (branch .LT. 28) THEN
            IF (branch .LT. 27) THEN
              temp253b51 = cost5g*4.d0*zb(indorbp, indt+i)
              temp253b52 = fun0*temp253b51
              fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**&
&                3)*temp253b51
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp253b52
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp253b52
            END IF
          ELSE
            temp253b53 = cost5g*4.d0*zb(indorbp, indt+i)
            temp253b54 = fun0*temp253b53
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp253b53
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp253b54
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp253b54
          END IF
          temp253b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp253b
          funb0 = funb0 + rmu(i, 0)*temp253b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp252 = rp3**3
      temp250 = distp(0, 1)/temp252
      temp251 = rp1**3
      temp251b = 0.25d0*temp250*fun2b
      temp250b = 0.25d0*(18.d0*rp1-78.d0*rp2+198.d0*(rp1*rp2)+191.d0*rp1&
&        **2+66.d0*(rp1**2*rp2)+3.d0*rp1**3-2.d0*(temp251*rp2)-30.d0)*&
&        fun2b/temp252
      temp249 = rp3**2
      temp248 = distp(0, 1)/temp249
      temp249b = 0.25d0*temp248*funb0
      rp1b = (2.d0*2*rp1-5.d0*rp2-44.d0)*temp249b + (3.d0*3*rp1**2-2.d0*&
&        rp2*3*rp1**2+66.d0*rp2*2*rp1+191.d0*2*rp1+198.d0*rp2+18.d0)*&
&        temp251b
      temp248b = 0.25d0*(2.d0*rp1**2-44.d0*rp1-69.d0*rp2-5.d0*(rp1*rp2)-&
&        30.d0)*funb0/temp249
      temp246b0 = distp(0, 1)*fun0b
      costb = -(r(0)**2*temp246b0)
      rp3b = -(temp248*2*rp3*temp248b) - (0.5d0*rp2+1.d0)*costb/rp3**2 -&
&        temp250*3*rp3**2*temp250b
      rp2b = ((-69.d0)-5.d0*rp1)*temp249b + 2*(rp2+1.d0)*rp3b + 0.5d0*&
&        costb/rp3 + (66.d0*rp1**2-2.d0*temp251+198.d0*rp1-78.d0)*&
&        temp251b
      temp247 = 4.d0*dd1
      temp246 = 11.d0/temp247
      distpb(0, 1) = distpb(0, 1) + temp248b + (temp246-r(0)**2*cost)*&
&        fun0b + temp250b
      dd1b = r(0)**2*rp1b - temp246*4.d0*temp246b0/temp247
      rb(0) = rb(0) + dd2*rp2b + dd1*2*r(0)*rp1b - cost*2*r(0)*temp246b0
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd2b = r(0)*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        temp246b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp245 = 4.d0*dd1
        temp244 = 11.d0/temp245
        temp244b = (temp244-r(k)**2*cost)*zb(indorbp, k)
        dd1b = dd1b - temp244*4.d0*temp246b/temp245
        costb = -(r(k)**2*temp246b)
        temp243 = dd2*r(k) + 1.d0
        temp244b0 = costb/temp243**2
        temp243b18 = -((0.5d0*(dd2*r(k))+1.d0)*2*temp244b0/temp243)
        rb(k) = rb(k) + 0.5d0*dd2*temp244b0 + dd2*temp243b18 - cost*2*r(&
&          k)*temp246b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp244b
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp244b
        zb(indorbp, k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,cost)
        dd2b = dd2b + r(k)*temp243b18 + 0.5d0*r(k)*temp244b0
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp243b0 = cost5g*4.d0*distpb(i, 10)
      temp243b1 = (rmu(1, i)**2-rmu(2, i)**2)*temp243b0
      temp243b2 = rmu(1, i)*rmu(2, i)*temp243b0
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp243b2 + rmu(2, i)*&
&        temp243b1
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp243b1 - 2*rmu(2, i)*&
&        temp243b2
      distpb(i, 10) = 0.0_8
      temp243b3 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp243b3
      distpb(i, 9) = 0.0_8
      temp243b4 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp243b5 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp243b4 - 2*rmu(2, i)*&
&        temp243b5 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp243b3
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp243b4
      distpb(i, 8) = 0.0_8
      temp243b6 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp243b7 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp243b6 + 2*rmu(1, i)*&
&        temp243b7 + 3.d0*2*rmu(1, i)*temp243b5
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp243b6
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp243b7
      distpb(i, 7) = 0.0_8
      temp243b8 = cost3g*2.d0*distpb(i, 6)
      temp243b9 = (7.d0*rmu(3, i)**2-r(i)**2)*temp243b8
      temp243b10 = rmu(1, i)*rmu(2, i)*temp243b8
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp243b9
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp243b9
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp243b10
      distpb(i, 6) = 0.0_8
      temp243b11 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp243b12 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp243b13 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp243b14 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp243b15 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp243b16 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp243b17 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp243b17 - 3.d0*2*r(i)*temp243b16 - 2*r(i)*temp243b12 - 3.d0*2&
&        *r(i)*temp243b14 - 2*r(i)*temp243b10
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp243b11
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp243b11
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp243b12
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp243b13
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp243b14 + rmu(2, i)*&
&        temp243b13
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp243b15
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp243b17 + 7.d0*2*rmu(3, i)*temp243b16 + rmu(1, i)*&
&        temp243b15
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp242 = dd2*r(k) + 1.d0
      temp243b = costb/temp242
      temp242b5 = -(dd1*r(k)**2*temp243b/temp242)
      dd1b = dd1b + r(k)**2*temp243b
      rb(k) = rb(k) + dd2*temp242b5 + dd1*2*r(k)*temp243b
      dd2b = dd2b + r(k)*temp242b5
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocg*2.75d0*dd1**1.75D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocg*2.75d0*dd1**1.75D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (1100:1199) 
! WARNING IN DFT it is assumed that UMRIGAR orbitals could be extended
! up to number 99, so i,h,... are possible extensions.
! 1s single Z NO CUSP!
!     p gaussian  r**(2*npower)*exp(-alpha*r**2)
    npower = iopt - 1100
!        indorbp=indorb
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = r(k)**(2*npower)*DEXP(-(dd2*r(k)**2))
    END DO
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      fun2 = (npower*(2.d0*npower-1.d0)-(1.d0+4.d0*npower)*dd2*rp1+2.d0*&
&        (dd2*rp1)**2)*distp(0, 1)*2.d0/rp1
!           indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!              if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp257b2 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp257b2
        fun2b = fun2b + temp257b2
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp257b1 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp257b1
          funb0 = funb0 + rmu(ic, 0)*temp257b1
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp256 = distp(0, 1)/rp1
      temp257b = 2.d0*temp256*fun2b
      temp257b0 = -((npower*4.d0+1.d0)*temp257b)
      temp256b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp255 = distp(0, 1)/rp1
      temp256b0 = 2.d0*temp255*funb0
      dd2b = rp1*temp257b0 - rp1*temp256b0 + 2.d0*rp1**2*2*dd2*temp257b
      temp255b = 2.d0*(npower-dd2*rp1)*funb0/rp1
      rp1b = dd2*temp257b0 - temp255*temp255b - temp256*temp256b - dd2*&
&        temp256b0 + 2.d0*dd2**2*2*rp1*temp257b
      distpb(0, 1) = temp255b + fun0b + temp256b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp254 = r(k)**2
      temp253 = 2*npower
      temp253b56 = r(k)**temp253*DEXP(-(dd2*temp254))*distpb(k, 1)
      IF (r(k) .LE. 0.0 .AND. (temp253 .EQ. 0.0 .OR. temp253 .NE. INT(&
&          temp253))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp253b56
      ELSE
        rb(k) = rb(k) + DEXP(-(dd2*temp254))*temp253*r(k)**(temp253-1)*&
&          distpb(k, 1) - dd2*2*r(k)*temp253b56
      END IF
      dd2b = dd2b - temp254*temp253b56
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (119) 
!     2p single   r_mu/(1+b r^2)^(3/2)   parent of 103
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)**2)**1.5d0
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(3.d0*dd2*distp(0, 1)/(1.d0+dd2*r(0)**2))
      fun2 = 3.d0*dd2*(-1.d0+4.d0*dd2*r(0)**2)/(1.d0+dd2*r(0)**2)**3.5d0
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp263b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp263b0
        fun2b = fun2b + temp263b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp263b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp263b
          funb0 = funb0 + rmu(ic, 0)*temp263b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp260 = dd2*r(0)**2 + 1.d0
      temp262 = temp260**3.5d0
      temp261 = 4.d0*dd2*r(0)**2 - 1.d0
      temp261b = 3.d0*fun2b/temp262
      temp261b0 = dd2*4.d0*temp261b
      temp260b = -(dd2*temp261*3.5d0*temp260**2.5D0*temp261b/temp262)
      temp259 = dd2*r(0)**2 + 1.d0
      temp260b0 = -(3.d0*funb0/temp259)
      temp259b = -(dd2*distp(0, 1)*temp260b0/temp259)
      dd2b = distp(0, 1)*temp260b0 + r(0)**2*temp259b + r(0)**2*temp260b&
&        + r(0)**2*temp261b0 + temp261*temp261b
      rb(0) = rb(0) + dd2*2*r(0)*temp259b + dd2*2*r(0)*temp260b + dd2*2*&
&        r(0)*temp261b0
      distpb = 0.0_8
      distpb(0, 1) = fun0b + dd2*temp260b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp257 = dd2*r(k)**2 + 1.d0
      temp258 = temp257**1.5d0
      temp257b3 = -(1.5d0*temp257**0.5D0*distpb(k, 1)/temp258**2)
      dd2b = dd2b + r(k)**2*temp257b3
      rb(k) = rb(k) + dd2*2*r(k)*temp257b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (27) 
!     2p without cusp condition
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
    dd3 = dd(indpar+4)
    peff2 = dd(indpar+5)
!        if(iflagnorm.gt.2) then
    c = 1.d0/2.d0/DSQRT(240.d0*pi*(1.d0/(2.d0*dd1)**7+2.d0*peff/(dd1+dd2&
&      )**7+peff**2/(2.d0*dd2)**7+2.d0*peff2/(dd1+dd3)**7+peff2**2/(2.d0*&
&      dd3)**7+2.d0*peff2*peff/(dd2+dd3)**7))
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
      distp(k, 3) = c*DEXP(-(dd3*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = r(i)*(distp(i, 1)+peff*distp(i, 2)+peff2*distp(i, 3)&
&        )
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = (1.d0-dd1*r(0))*distp(0, 1) + peff*(1.d0-dd2*r(0))*distp(0, &
&        2) + peff2*(1.d0-dd3*r(0))*distp(0, 3)
      fun2 = dd1*(dd1*r(0)-2.d0)*distp(0, 1) + peff*dd2*(dd2*r(0)-2.d0)*&
&        distp(0, 2) + peff2*dd3*(dd3*r(0)-2.d0)*distp(0, 3)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp278 = fun/r(0)
        temp279b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp278b = 4.d0*temp279b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp278+fun2)*zb(indorbp, indt&
&          +4)
        funb0 = funb0 + temp278b
        rb(0) = rb(0) - temp278*temp278b
        fun2b = fun2b + temp279b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp277 = fun/r(0)
          temp277b13 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp277*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp277*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb0 = funb0 + temp277b13
          rb(0) = rb(0) - temp277*temp277b13
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp277b3 = dd1*distp(0, 1)*fun2b
      temp277b4 = (dd1*r(0)-2.d0)*fun2b
      temp277b5 = (dd2*r(0)-2.d0)*fun2b
      temp277b6 = peff*dd2*distp(0, 2)*fun2b
      temp277b7 = (dd3*r(0)-2.d0)*fun2b
      temp277b8 = peff2*dd3*distp(0, 3)*fun2b
      dd1b = distp(0, 1)*temp277b4 - distp(0, 1)*r(0)*funb0 + r(0)*&
&        temp277b3
      temp277b9 = peff*distp(0, 2)*funb0
      temp277b10 = peff2*distp(0, 3)*funb0
      rb(0) = rb(0) + dd3*temp277b8 - dd2*temp277b9 - dd3*temp277b10 - &
&        distp(0, 1)*dd1*funb0 + dd2*temp277b6 + dd1*temp277b3
      distpb(0, 1) = dd1*temp277b4
      temp277b11 = (1.d0-dd2*r(0))*funb0
      peffb = distp(0, 2)*temp277b11 + distp(0, 2)*dd2*temp277b5
      dd2b = r(0)*temp277b6 - r(0)*temp277b9 + distp(0, 2)*peff*&
&        temp277b5
      distpb(0, 2) = peff*dd2*temp277b5
      temp277b12 = (1.d0-dd3*r(0))*funb0
      peff2b = distp(0, 3)*temp277b12 + distp(0, 3)*dd3*temp277b7
      dd3b = r(0)*temp277b8 - r(0)*temp277b10 + distp(0, 3)*peff2*&
&        temp277b7
      distpb(0, 3) = peff2*dd3*temp277b7
      distpb(0, 1) = distpb(0, 1) + (1.d0-dd1*r(0))*funb0
      distpb(0, 2) = distpb(0, 2) + peff*temp277b11
      distpb(0, 3) = distpb(0, 3) + peff2*temp277b12
      distpb(0, 4) = distpb(0, 4) + fun0b
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      peff2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 4)*zb(indorbp, i)
        distpb(i, 4) = distpb(i, 4) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      temp277b2 = r(i)*distpb(i, 4)
      rb(i) = rb(i) + (distp(i, 1)+peff*distp(i, 2)+peff2*distp(i, 3))*&
&        distpb(i, 4)
      distpb(i, 1) = distpb(i, 1) + temp277b2
      peffb = peffb + distp(i, 2)*temp277b2
      distpb(i, 2) = distpb(i, 2) + peff*temp277b2
      peff2b = peff2b + distp(i, 3)*temp277b2
      distpb(i, 3) = distpb(i, 3) + peff2*temp277b2
      distpb(i, 4) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp277b = c*DEXP(-(dd3*r(k)))*distpb(k, 3)
      cb = cb + DEXP(-(dd3*r(k)))*distpb(k, 3)
      dd3b = dd3b - r(k)*temp277b
      distpb(k, 3) = 0.0_8
      temp277b0 = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      temp277b1 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp277b0 - dd1*temp277b1 - dd3*temp277b
      dd2b = dd2b - r(k)*temp277b0
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp277b1
      distpb(k, 1) = 0.0_8
    END DO
    temp276 = (dd2+dd3)**7
    temp263 = peff2*peff/temp276
    temp275 = 2.d0**7
    temp274 = temp275*dd3**7
    temp273 = peff2**2/temp274
    temp272 = (dd1+dd3)**7
    temp271 = 2.d0**7
    temp270 = temp271*dd2**7
    temp269 = peff**2/temp270
    temp268 = (dd1+dd2)**7
    temp267 = 2.d0**7
    temp266 = temp267*dd1**7
    temp265 = 240.d0*pi*(1.0/temp266+2.d0*peff/temp268+temp269+2.d0*&
&      peff2/temp272+temp273+2.d0*temp263)
    temp264 = DSQRT(temp265)
    IF (temp265 .EQ. 0.0) THEN
      temp264b = 0.0
    ELSE
      temp264b = -(pi*240.d0*cb/(2.d0*temp264**2*2.D0*DSQRT(temp265)))
    END IF
    temp264b0 = 2.d0*temp264b/temp268
    temp264b1 = -(peff*7*(dd1+dd2)**6*temp264b0/temp268)
    temp264b2 = 2.d0*temp264b/temp272
    temp264b3 = -(peff2*7*(dd1+dd3)**6*temp264b2/temp272)
    temp263b1 = 2.d0*temp264b/temp276
    temp263b2 = -(temp263*7*(dd2+dd3)**6*temp263b1)
    dd1b = dd1b + temp264b3 + temp264b1 - temp267*7*dd1**6*temp264b/&
&      temp266**2
    peffb = peffb + peff2*temp263b1 + 2*peff*temp264b/temp270 + &
&      temp264b0
    dd2b = dd2b + temp263b2 - temp269*temp271*7*dd2**6*temp264b/temp270 &
&      + temp264b1
    peff2b = peff2b + peff*temp263b1 + 2*peff2*temp264b/temp274 + &
&      temp264b2
    dd3b = dd3b + temp263b2 - temp273*temp275*7*dd3**6*temp264b/temp274 &
&      + temp264b3
    ddb(indpar+5) = ddb(indpar+5) + peff2b
    ddb(indpar+4) = ddb(indpar+4) + dd3b
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (85) 
! d orbitals
! R(r)= c*exp(-z r^2)*(7/4/z-r^2)
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!        if(iflagnorm.gt.2) then
! overall normalization
!        c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)*ratiocd
    c = dd1**1.75d0*ratiocd
!        endif
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
! lz=0
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
      DO k=i0,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
        cost = (1.d0+0.5d0*dd2*r(k))/(1.d0+dd2*r(k))**2
      END DO
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = (1.d0+0.5d0*rp2)/rp3
      fun0 = distp(0, 1)*(7.d0/4.d0/dd1-r(0)**2*cost)
      fun = 0.25d0*distp(0, 1)*(-22.d0-49.d0*rp2-28.d0*rp1-rp1*rp2+2.d0*&
&        rp1**2)/rp3**2
      fun2 = -(0.25d0*distp(0, 1)*(22.d0+54.d0*rp2-26.d0*rp1-158.d0*rp1*&
&        rp2-139.d0*rp1**2-42.d0*rp1**2*rp2+rp1**3+2.d0*rp1**3*rp2)/rp3**&
&        3)
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp290b4 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 6.d0*temp290b4
        fun2b = fun2b + temp290b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp290b0 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp290b0
                  fun0b = fun0b + rmu(i, 0)*temp290b0
                ELSE
                  temp290b1 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp290b1
                  fun0b = fun0b + rmu(i, 0)*temp290b1
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp290b2 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp290b2
                fun0b = fun0b + rmu(i, 0)*temp290b2
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp290b3 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp290b3
                fun0b = fun0b + rmu(i, 0)*temp290b3
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp290b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp290b
          funb0 = funb0 + rmu(i, 0)*temp290b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp289 = rp3**3
      temp287 = distp(0, 1)/temp289
      temp288 = rp1**3
      temp288b = -(0.25d0*temp287*fun2b)
      temp287b = -(0.25d0*(54.d0*rp2-26.d0*rp1-158.d0*(rp1*rp2)-139.d0*&
&        rp1**2+rp1**3-42.d0*(rp1**2*rp2)+2.d0*(temp288*rp2)+22.d0)*fun2b&
&        /temp289)
      temp286 = rp3**2
      temp285 = distp(0, 1)/temp286
      temp285b = 0.25d0*(2.d0*rp1**2-28.d0*rp1-49.d0*rp2-rp1*rp2-22.d0)*&
&        funb0/temp286
      temp283b0 = distp(0, 1)*fun0b
      costb = -(r(0)**2*temp283b0)
      rp3b = -(temp285*2*rp3*temp285b) - (0.5d0*rp2+1.d0)*costb/rp3**2 -&
&        temp287*3*rp3**2*temp287b
      temp286b = 0.25d0*temp285*funb0
      rp2b = ((-49.d0)-rp1)*temp286b + 2*(rp2+1.d0)*rp3b + 0.5d0*costb/&
&        rp3 + (2.d0*temp288-42.d0*rp1**2-158.d0*rp1+54.d0)*temp288b
      rp1b = (2.d0*2*rp1-rp2-28.d0)*temp286b + (2.d0*rp2*3*rp1**2-42.d0*&
&        rp2*2*rp1+3*rp1**2-139.d0*2*rp1-158.d0*rp2-26.d0)*temp288b
      temp284 = 4.d0*dd1
      temp283 = 7.d0/temp284
      distpb(0, 1) = distpb(0, 1) + temp285b + (temp283-r(0)**2*cost)*&
&        fun0b + temp287b
      dd1b = r(0)**2*rp1b - temp283*4.d0*temp283b0/temp284
      rb(0) = rb(0) + dd2*rp2b + dd1*2*r(0)*rp1b - cost*2*r(0)*temp283b0
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd2b = r(0)*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        temp283b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp282 = 4.d0*dd1
        temp281 = 7.d0/temp282
        temp281b = (temp281-r(k)**2*cost)*zb(indorbp, k)
        dd1b = dd1b - temp281*4.d0*temp283b/temp282
        costb = -(r(k)**2*temp283b)
        temp280 = dd2*r(k) + 1.d0
        temp281b0 = costb/temp280**2
        temp280b0 = -((0.5d0*(dd2*r(k))+1.d0)*2*temp281b0/temp280)
        rb(k) = rb(k) + 0.5d0*dd2*temp281b0 + dd2*temp280b0 - cost*2*r(k&
&          )*temp283b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp281b
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp281b
        zb(indorbp, k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,cost)
        dd2b = dd2b + r(k)*temp280b0 + 0.5d0*r(k)*temp281b0
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp279 = dd2*r(k) + 1.d0
      temp280b = costb/temp279
      temp279b0 = -(dd1*r(k)**2*temp280b/temp279)
      dd1b = dd1b + r(k)**2*temp280b
      rb(k) = rb(k) + dd2*temp279b0 + dd1*2*r(k)*temp280b
      dd2b = dd2b + r(k)*temp279b0
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocd*1.75d0*dd1**0.75D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocd*1.75d0*dd1**0.75D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (115) 
!     2s double lorentian with constant  parent of 102
!     (dd3+ r^2/(1+dd2*r)^3+dd4*r^3/(1+dd5*r)^4;
    dd2 = dd(indpar+1)
    dd4 = dd(indpar+3)
    dd5 = dd(indpar+4)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = r(k)**2/(1.d0+dd2*r(k))**3
      distp(k, 2) = r(k)**3/(1.d0+dd5*r(k))**4
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)
!           endif
    IF (typec .NE. 1) THEN
      fun = (2.d0-dd2*r(0))/(1+dd2*r(0))**4 - dd4*r(0)*(-3.d0+dd5*r(0))/&
&        (1.d0+dd5*r(0))**5
      fun2b = zb(indorbp, indt+4)
      funb0 = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp300 = (dd2*r(0)+1)**5
      temp300b = 2.d0*fun2b/temp300
      temp300b0 = 2*dd2*r(0)*temp300b
      temp300b1 = -(((dd2*r(0))**2-4.d0*(dd2*r(0))+1.d0)*5*(dd2*r(0)+1)&
&        **4*temp300b/temp300)
      temp299 = (dd5*r(0)+1.d0)**6
      temp298 = dd4*r(0)/temp299
      temp299b = 2.d0*temp298*fun2b
      temp299b0 = 2*dd5*r(0)*temp299b
      temp298b = 2.d0*((dd5*r(0))**2-6.d0*(dd5*r(0))+3.d0)*fun2b/temp299
      temp298b0 = -(temp298*6*(dd5*r(0)+1.d0)**5*temp298b)
      temp297 = (dd2*r(0)+1)**4
      temp297b = funb0/temp297
      temp297b0 = -((2.d0-dd2*r(0))*4*(dd2*r(0)+1)**3*temp297b/temp297)
      dd2b = r(0)*temp297b0 - r(0)*temp297b + r(0)*temp300b1 - 4.d0*r(0)&
&        *temp300b + r(0)*temp300b0
      temp296 = (dd5*r(0)+1.d0)**5
      temp296b = -(funb0/temp296)
      temp295 = dd5*r(0) - 3.d0
      temp294 = dd4*r(0)
      temp294b = -(temp294*temp295*5*(dd5*r(0)+1.d0)**4*temp296b/temp296&
&        )
      rb(0) = rb(0) + dd2*temp297b0 - dd2*temp297b + (temp294*dd5+&
&        temp295*dd4)*temp296b + dd5*temp294b + dd5*temp298b0 + dd4*&
&        temp298b - 6.d0*dd5*temp299b + dd5*temp299b0 + dd2*temp300b1 - &
&        4.d0*dd2*temp300b + dd2*temp300b0
      dd5b = temp294*r(0)*temp296b + r(0)*temp294b + r(0)*temp298b0 - &
&        6.d0*r(0)*temp299b + r(0)*temp299b0
      dd4b = temp295*r(0)*temp296b + r(0)*temp298b
    ELSE
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    distpb = 0.0_8
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp292 = dd5*r(k) + 1.d0
      temp293 = temp292**4
      temp292b = -(r(k)**3*4*temp292**3*distpb(k, 2)/temp293**2)
      rb(k) = rb(k) + dd5*temp292b + 3*r(k)**2*distpb(k, 2)/temp293
      dd5b = dd5b + r(k)*temp292b
      distpb(k, 2) = 0.0_8
      temp290 = dd2*r(k) + 1.d0
      temp291 = temp290**3
      temp290b5 = -(r(k)**2*3*temp290**2*distpb(k, 1)/temp291**2)
      rb(k) = rb(k) + dd2*temp290b5 + 2*r(k)*distpb(k, 1)/temp291
      dd2b = dd2b + r(k)*temp290b5
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+4) = ddb(indpar+4) + dd5b
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (22) 
!      3p without cusp condition
!      r e^{-z1 r }
    dd1 = dd(indpar+1)
!        c=dsqrt((2.d0*dd1)**7/240.d0/pi)/2.d0
    c = dd1**3.5d0*0.2060129077457011d0
!
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(k, 2))
      distp(k, 2) = r(k)*distp(k, 1)
    END DO
!
!        indorbp=indorb
!
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
!
!
    IF (typec .NE. 1) THEN
      fun = (1.d0-dd1*r(0))*distp(0, 1)
      fun2 = dd1*(dd1*r(0)-2.d0)*distp(0, 1)
!
!              indorbp=indorb
!
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp302 = fun/r(0)
        temp303b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp302b = 4.d0*temp303b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp302+fun2)*zb(indorbp, indt&
&          +4)
        funb0 = funb0 + temp302b
        rb(0) = rb(0) - temp302*temp302b
        fun2b = fun2b + temp303b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp301 = fun/r(0)
          temp301b2 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp301*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp301*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb0 = funb0 + temp301b2
          rb(0) = rb(0) - temp301*temp301b2
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp301b0 = dd1*distp(0, 1)*fun2b
      temp301b1 = (dd1*r(0)-2.d0)*fun2b
      dd1b = distp(0, 1)*temp301b1 - distp(0, 1)*r(0)*funb0 + r(0)*&
&        temp301b0
      rb(0) = rb(0) + dd1*temp301b0 - distp(0, 1)*dd1*funb0
      distpb(0, 1) = (1.d0-dd1*r(0))*funb0 + dd1*temp301b1
      distpb(0, 2) = distpb(0, 2) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 2)*zb(indorbp, i)
        distpb(i, 2) = distpb(i, 2) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(k, 2))
      rb(k) = rb(k) + distp(k, 1)*distpb(k, 2)
      distpb(k, 1) = distpb(k, 1) + r(k)*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      temp301b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp301b
      rb(k) = rb(k) - dd1*temp301b
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.2060129077457011d0*3.5d0*dd1**2.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (13) 
! 3p double zeta
! R(r)=r**3*(exp(-z1*r)+z3*exp(-z2*r))
!
!
!
!        if(iocc(indshellp).eq.1) then
!
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    dd3 = dd(indpar+3)
!           if(iflagnorm.gt.2) then
    c = 1.d0/2.d0/DSQRT(pi*40320.d0*(1.d0/(2.d0*dd1)**9+2.d0*dd3/(dd1+&
&      dd2)**9+dd3**2/(2.d0*dd2)**9))
!           endif
!
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
!
    IF (typec .NE. 1) THEN
      rp1 = r(0)**3
      rp2 = r(0)**2
!
!c              the first derivative
      fun = distp(0, 1)*(3.d0*rp2-dd1*rp1) + dd3*distp(0, 2)*(3.d0*rp2-&
&        dd2*rp1)
!c
!              the second derivative
      temp312b = 2.d0*zb(indorbp, indt+4)/r(0)
      funb0 = temp312b
      rb(0) = rb(0) - fun*temp312b/r(0)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp311 = fun/r(0)
        temp311b8 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp311*zb(indorbp, indt+i)
        funb0 = funb0 + temp311b8
        rb(0) = rb(0) - temp311*temp311b8
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp311b2 = distp(0, 1)*fun2b
      temp311b3 = (6.d0*r(0)-6.d0*(dd2*rp2)+dd2**2*rp1)*fun2b
      temp311b4 = dd3*distp(0, 2)*fun2b
      distpb(0, 1) = (6.d0*r(0)-6.d0*(dd1*rp2)+dd1**2*rp1)*fun2b
      temp311b5 = distp(0, 1)*funb0
      temp311b6 = dd3*distp(0, 2)*funb0
      rp2b = 3.d0*temp311b5 + 3.d0*temp311b6 - 6.d0*dd2*temp311b4 - 6.d0&
&        *dd1*temp311b2
      rp1b = dd2**2*temp311b4 - dd2*temp311b6 - dd1*temp311b5 + dd1**2*&
&        temp311b2
      rb(0) = rb(0) + 2*r(0)*rp2b + 3*r(0)**2*rp1b + 6.d0*temp311b4 + &
&        6.d0*temp311b2
      dd1b = (rp1*2*dd1-6.d0*rp2)*temp311b2 - rp1*temp311b5
      temp311b7 = (3.d0*rp2-dd2*rp1)*funb0
      dd3b = distp(0, 2)*temp311b7 + distp(0, 2)*temp311b3
      distpb(0, 2) = dd3*temp311b3
      dd2b = (rp1*2*dd2-6.d0*rp2)*temp311b4 - rp1*temp311b6
      distpb(0, 1) = distpb(0, 1) + (3.d0*rp2-dd1*rp1)*funb0
      distpb(0, 2) = distpb(0, 2) + dd3*temp311b7
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp311b1 = r(i)**3*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp311b1
      dd3b = dd3b + distp(i, 2)*temp311b1
      distpb(i, 2) = distpb(i, 2) + dd3*temp311b1
      rb(i) = rb(i) + (distp(i, 1)+dd3*distp(i, 2))*3*r(i)**2*zb(indorbp&
&        , i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp311b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp311b
      distpb(k, 2) = 0.0_8
      temp311b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp311b0 - dd2*temp311b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp311b0
      distpb(k, 1) = 0.0_8
    END DO
    temp310 = 2.d0**9
    temp309 = temp310*dd2**9
    temp308 = dd3**2/temp309
    temp307 = (dd1+dd2)**9
    temp306 = 2.d0**9
    temp305 = temp306*dd1**9
    temp304 = 40320.d0*pi*(1.0/temp305+2.d0*dd3/temp307+temp308)
    temp303 = DSQRT(temp304)
    IF (temp304 .EQ. 0.0) THEN
      temp303b0 = 0.0
    ELSE
      temp303b0 = -(pi*40320.d0*cb/(2.d0*temp303**2*2.D0*DSQRT(temp304))&
&        )
    END IF
    temp303b1 = 2.d0*temp303b0/temp307
    temp303b2 = -(dd3*9*(dd1+dd2)**8*temp303b1/temp307)
    dd1b = dd1b + temp303b2 - temp306*9*dd1**8*temp303b0/temp305**2
    dd3b = dd3b + 2*dd3*temp303b0/temp309 + temp303b1
    dd2b = dd2b + temp303b2 - temp308*temp310*9*dd2**8*temp303b0/temp309
    ddb(indpar+3) = ddb(indpar+3) + dd3b
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (37, 68) 
! 1s single Z pseudo
! d orbital
! 
! - angmom = 2
! - type = Gaussian
! - normalized = yes
! - angtype = spherical
! - npar = 1
! - multiplicity = 5
!
    indparp = indpar + 1
    dd1 = dd(indparp)
    c = dd1**1.75d0*1.64592278064948967213d0
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
! lz=0
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb + ic
    END DO
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        END IF
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp313b6 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 6.d0*temp313b6
        fun2b = fun2b + temp313b6
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 3) THEN
          IF (branch .LT. 2) THEN
            IF (branch .LT. 1) THEN
              temp313b1 = cost1d*4.d0*zb(indorbp, indt+3)
              rmub(3, 0) = rmub(3, 0) + fun0*temp313b1
              temp313b2 = -(cost1d*2.d0*zb(indorbp, indt+2))
              temp313b3 = -(cost1d*2.d0*zb(indorbp, indt+1))
              fun0b = fun0b + rmu(2, 0)*temp313b2 + rmu(1, 0)*temp313b3 &
&                + rmu(3, 0)*temp313b1
              rmub(2, 0) = rmub(2, 0) + fun0*temp313b2
              rmub(1, 0) = rmub(1, 0) + fun0*temp313b3
            ELSE
              temp313b4 = -(cost2d*2.d0*zb(indorbp, indt+2))
              rmub(2, 0) = rmub(2, 0) + fun0*temp313b4
              temp313b5 = cost2d*2.d0*zb(indorbp, indt+1)
              fun0b = fun0b + rmu(1, 0)*temp313b5 + rmu(2, 0)*temp313b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp313b5
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+2)
            fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+1) + &
&              cost3d*rmu(1, 0)*zb(indorbp, indt+2)
            rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+1)
          END IF
        ELSE IF (branch .LT. 5) THEN
          IF (branch .LT. 4) THEN
            rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+3)
            fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+2) + &
&              cost3d*rmu(2, 0)*zb(indorbp, indt+3)
            rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+2)
          END IF
        ELSE
          rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+3)
          fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+1) + cost3d*&
&            rmu(1, 0)*zb(indorbp, indt+3)
          rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+1)
        END IF
        DO i=3,1,-1
          temp313b0 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp313b0
          funb0 = funb0 + rmu(i, 0)*temp313b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp313b = -(fun*2.d0*fun2b)
      funb0 = funb0 + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp313b - 2.d0*distp(0, 1)*funb0
      rb(0) = rb(0) + dd1*2*r(0)*temp313b
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb0
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp312 = r(k)**2
      temp312b0 = c*DEXP(-(dd1*temp312))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp312))*distpb(k, 1)
      dd1b = dd1b - temp312*temp312b0
      rb(k) = rb(k) - dd1*2*r(k)*temp312b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.64592278064948967213d0*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (140) 
!     2p single exponential  -r e^{-z r}  ! der  of 121
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(1.d0-dd2*r(0))/r(0)
      fun2 = dd2*(dd2*r(0)-2.d0)*distp(0, 1)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp314b2 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp314b2
        fun2b = fun2b + temp314b2
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp314b1 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp314b1
          funb0 = funb0 + rmu(ic, 0)*temp314b1
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp314b = dd2*distp(0, 1)*fun2b
      temp314b0 = (dd2*r(0)-2.d0)*fun2b
      temp313 = distp(0, 1)/r(0)
      dd2b = distp(0, 1)*temp314b0 - temp313*r(0)*funb0 + r(0)*temp314b
      temp313b9 = (1.d0-dd2*r(0))*funb0/r(0)
      rb(0) = rb(0) + distp(0, 1)*fun0b - temp313*dd2*funb0 - temp313*&
&        temp313b9 + dd2*temp314b
      distpb(0, 1) = temp313b9 + r(0)*fun0b + dd2*temp314b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp313b8 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*r(i)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + r(i)*temp313b8
        rb(i) = rb(i) + distp(i, 1)*temp313b8
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp313b7 = -(DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp313b7
      rb(k) = rb(k) - dd2*temp313b7
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (2000:2099) 
!     s gaussian  -r**(2*(npower+1))*exp(-alpha*r**2) derivative of 1000
    npower = iopt + 1 - 2000
    indorbp = indorb + 1
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -(r(k)**(2*npower)*DEXP(-(dd2*r(k)**2)))
    END DO
!        endif
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp317 = distp(0, 1)/rp1
      temp318b = 2.d0*temp317*fun2b
      temp318b0 = -((npower*4.d0+1.d0)*temp318b)
      temp317b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp316 = distp(0, 1)/rp1
      temp317b0 = 2.d0*temp316*funb0
      dd2b = rp1*temp318b0 - rp1*temp317b0 + 2.d0*rp1**2*2*dd2*temp318b
      temp316b = 2.d0*(npower-dd2*rp1)*funb0/rp1
      rp1b = dd2*temp318b0 - temp316*temp316b - temp317*temp317b - dd2*&
&        temp317b0 + 2.d0*dd2**2*2*rp1*temp318b
      distpb(0, 1) = temp316b + temp317b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp315 = r(k)**2
      temp314 = 2*npower
      temp314b3 = -(r(k)**temp314*DEXP(-(dd2*temp315))*distpb(k, 1))
      IF (r(k) .LE. 0.0 .AND. (temp314 .EQ. 0.0 .OR. temp314 .NE. INT(&
&          temp314))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp314b3
      ELSE
        rb(k) = rb(k) - dd2*2*r(k)*temp314b3 - DEXP(-(dd2*temp315))*&
&          temp314*r(k)**(temp314-1)*distpb(k, 1)
      END IF
      dd2b = dd2b - temp315*temp314b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (61) 
! R(r)=c (-r**5*exp(-z1*r**2)+c1 r**3 exp(-z1*r**2))
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!          if(iflagnorm.gt.2) then
!     c=2.d0/pi**(3.d0/4.d0)*(2.d0*dd1)**(9.d0/4.d0)*dsqrt(2.d0/105.d0)
    c = dd1**2.25d0*.55642345640820284397d0
!           endif
    c1 = 2.25d0/dd1
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))*r(k)
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      rp2 = rp1*dd1
      fun = c1*distp(0, 1)*(3.d0-2.d0*rp2) + distp(0, 1)*rp1*(-5.d0+2.d0&
&        *rp2)
!              the second derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp319b0 = (4.d0*rp2**2-14.d0*rp2+6.d0)*fun2b
      temp319b1 = c1*distp(0, 1)*fun2b
      temp319b2 = (22.d0*rp2-4.d0*rp2**2-20.d0)*fun2b
      temp319b3 = distp(0, 1)*rp1*fun2b
      temp319b4 = (3.d0-2.d0*rp2)*funb0
      c1b = distp(0, 1)*temp319b4 + distp(0, 1)*temp319b0
      temp319b5 = (2.d0*rp2-5.d0)*funb0
      distpb(0, 1) = c1*temp319b4 + rp1*temp319b5 + rp1*temp319b2 + c1*&
&        temp319b0
      rp2b = (distp(0, 1)*rp1*2.d0-c1*distp(0, 1)*2.d0)*funb0 + (22.d0-&
&        4.d0*2*rp2)*temp319b3 + (4.d0*2*rp2-14.d0)*temp319b1
      rp1b = distp(0, 1)*temp319b5 + dd1*rp2b + distp(0, 1)*temp319b2
      dd1b = rp1*rp2b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp319b = distp(i, 1)*zb(indorbp, i)
      c1b = c1b + r(i)**2*temp319b
      rb(i) = rb(i) + (c1*2*r(i)-4*r(i)**3)*temp319b
      distpb(i, 1) = distpb(i, 1) + (c1*r(i)**2-r(i)**4)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp318 = r(k)**2
      temp318b1 = c*r(k)*DEXP(-(dd1*temp318))*distpb(k, 1)
      temp318b2 = DEXP(-(dd1*temp318))*distpb(k, 1)
      dd1b = dd1b - temp318*temp318b1
      rb(k) = rb(k) + c*temp318b2 - dd1*2*r(k)*temp318b1
      cb = cb + r(k)*temp318b2
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + .55642345640820284397d0*2.25d0*dd1**1.25D0*cb - 2.25d0&
&      *c1b/dd1**2
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (20) 
! single gaussianx r  p orbitals
!     2p single Z with no  cusp condition
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then
!        c=dsqrt((2.d0*dd1)**5/8.d0/pi)/2.d0
    c = dd1**2.5d0*0.5641895835477562d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
!        indorbp=indorb
!
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1))
      fun2 = dd1**2*distp(0, 1)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp320 = fun/r(0)
        temp321b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp320b = 4.d0*temp321b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp320+fun2)*zb(indorbp, indt&
&          +4)
        funb0 = funb0 + temp320b
        rb(0) = rb(0) - temp320*temp320b
        fun2b = fun2b + temp321b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp319 = fun/r(0)
          temp319b7 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp319*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp319*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb0 = funb0 + temp319b7
          rb(0) = rb(0) - temp319*temp319b7
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb0
      distpb(0, 1) = fun0b - dd1*funb0 + dd1**2*fun2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp319b6 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp319b6
      rb(k) = rb(k) - dd1*temp319b6
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.5641895835477562d0*2.5d0*dd1**1.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (38) 
! 2p double zeta
! R(r)=r**2*exp(-z1*r)
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!              c=1.d0/dsqrt(1.d0/4.d0/dd1**3+12.d0*dd1/(2.d0*dd1)**4+&
!                                                              &3.d0*dd1**2/4.d0/dd1**5)/dsqrt(4.d0*pi)
!             c=dd1*dsqrt(dd1)/dsqrt(7.d0*pi)
    c = dd1*DSQRT(dd1)*0.21324361862292308211d0
!           endif
    c0 = -(c*dd1)
    c1 = 1.5d0*c/dd1
    DO i=indtmin,indtm
      distp(i, 1) = DEXP(-(dd1*r(i)))
    END DO
    CALL PUSHREAL8(adr8ibuf,adr8buf,c1)
    c1 = c1*dd1**2
    IF (typec .NE. 1) THEN
      fun = (c0*(2.d0-dd1*r(0))-c1)*distp(0, 1)
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp324b = distp(0, 1)*fun2b
      temp323 = (dd1*r(0))**2 - 4*(dd1*r(0)) + 2.d0
      temp323b0 = c0*temp324b
      temp323b1 = 2*dd1*r(0)*temp323b0
      temp323b2 = distp(0, 1)*funb0
      c0b = (2.d0-dd1*r(0))*temp323b2 + temp323*temp324b
      dd1b = c1*r(0)*temp324b - c0*r(0)*temp323b2 - 4*r(0)*temp323b0 + r&
&        (0)*temp323b1
      rb(0) = rb(0) + c1*dd1*temp324b - c0*dd1*temp323b2 - 4*dd1*&
&        temp323b0 + dd1*temp323b1
      c1b = (dd1*r(0)-1.d0)*temp324b - temp323b2
      distpb(0, 1) = (c0*(2.d0-dd1*r(0))-c1)*funb0 + (c0*temp323+c1*(dd1&
&        *r(0)-1.d0))*fun2b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    CALL POPREAL8(adr8ibuf,adr8buf,c1)
    dd1b = dd1b + c1*2*dd1*c1b
    c1b = dd1**2*c1b
    DO i=indtm,i0,-1
      temp323b = distp(i, 1)*zb(indorbp, i)
      temp322 = dd1*r(i) + 1.d0
      c0b = c0b + r(i)**2*temp323b
      rb(i) = rb(i) + (c1*dd1+c0*2*r(i))*temp323b
      c1b = c1b + temp322*temp323b
      dd1b = dd1b + c1*r(i)*temp323b
      distpb(i, 1) = distpb(i, 1) + (c0*r(i)**2+c1*temp322)*zb(indorbp, &
&        i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO i=indtm,indtmin,-1
      temp322b0 = DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp322b0
      rb(i) = rb(i) - dd1*temp322b0
      distpb(i, 1) = 0.0_8
    END DO
    temp322b = 1.5d0*c1b/dd1
    cb = temp322b - dd1*c0b
    temp321 = DSQRT(dd1)
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + 0.21324361862292308211d0*temp321*cb - c*c0b - c*&
&        temp322b/dd1
    ELSE
      dd1b = dd1b + (0.21324361862292308211d0*dd1/(2.D0*DSQRT(dd1))+&
&        0.21324361862292308211d0*temp321)*cb - c*c0b - c*temp322b/dd1
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (84) 
! 4s single zeta derivative of 10
! d orbitals
! R(r)= exp(-alpha r^2)
! each gaussian term is normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!        if(iflagnorm.gt.2) then
! overall normalization
!        c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)*ratiocd
    c = ratiocd*dd1**1.75d0
!        endif
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
! lz=0
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 1)
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = -(dd1*distp(0, 1)*(2.d0+rp2)/rp3)
!              the second derivative
      fun2 = dd1*distp(0, 1)*(-2.d0-2.d0*rp2+4.d0*rp1+4.d0*rp1*rp2+rp1**&
&        2)/rp3**2
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp328b4 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 6.d0*temp328b4
        fun2b = fun2b + temp328b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp328b0 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp328b0
                  fun0b = fun0b + rmu(i, 0)*temp328b0
                ELSE
                  temp328b1 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp328b1
                  fun0b = fun0b + rmu(i, 0)*temp328b1
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp328b2 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp328b2
                fun0b = fun0b + rmu(i, 0)*temp328b2
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp328b3 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp328b3
                fun0b = fun0b + rmu(i, 0)*temp328b3
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp328b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp328b
          funb0 = funb0 + rmu(i, 0)*temp328b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp327 = rp3**2
      temp326b = (4.d0*rp1-2.d0*rp2+4.d0*(rp1*rp2)+rp1**2-2.d0)*fun2b/&
&        temp327
      temp326 = dd1*distp(0, 1)/temp327
      temp326b0 = temp326*fun2b
      rp1b = (2*rp1+4.d0*rp2+4.d0)*temp326b0
      temp325b0 = -(distp(0, 1)*(rp2+2.d0)*funb0/rp3)
      dd1b = temp325b0 + r(0)**2*rp1b + distp(0, 1)*temp326b
      temp325 = dd1/rp3
      distpb(0, 1) = distpb(0, 1) + fun0b - temp325*(rp2+2.d0)*funb0 + &
&        dd1*temp326b
      rp3b = -(temp325*temp325b0) - temp326*2*rp3*temp326b
      rp2b = 2*(rp2+1.d0)*rp3b - temp325*distp(0, 1)*funb0 + (4.d0*rp1-&
&        2.d0)*temp326b0
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp324 = dd2*r(k) + 1.d0
      temp325b = costb/temp324
      temp324b0 = -(dd1*r(k)**2*temp325b/temp324)
      dd1b = dd1b + r(k)**2*temp325b
      rb(k) = rb(k) + dd2*temp324b0 + dd1*2*r(k)*temp325b
      dd2b = dd2b + r(k)*temp324b0
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocd*1.75d0*dd1**0.75D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocd*1.75d0*dd1**0.75D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (24) 
! derivative of 37 with respect to z
!c     4p without cusp condition
!c      r^2   e^{-z1 r }
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then
!        c=dsqrt((2.d0*dd1)**9/120960.d0/pi)/2.d0
    c = dd1**4.5d0*0.01835308852470193d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = r(i)**2*distp(i, 1)
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = (2.d0*r(0)-dd1*r(0)**2)*distp(0, 1)
      fun2 = ((dd1*r(0))**2+2.d0-4.d0*dd1*r(0))*distp(0, 1)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp329 = fun/r(0)
        temp330b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp329b = 4.d0*temp330b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp329+fun2)*zb(indorbp, indt&
&          +4)
        funb0 = funb0 + temp329b
        rb(0) = rb(0) - temp329*temp329b
        fun2b = fun2b + temp330b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp328 = fun/r(0)
          temp328b9 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp328*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp328*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb0 = funb0 + temp328b9
          rb(0) = rb(0) - temp328*temp328b9
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp328b6 = distp(0, 1)*fun2b
      temp328b7 = 2*dd1*r(0)*temp328b6
      temp328b8 = distp(0, 1)*funb0
      dd1b = r(0)*temp328b7 - 4.d0*r(0)*temp328b6 - r(0)**2*temp328b8
      rb(0) = rb(0) + (2.d0-dd1*2*r(0))*temp328b8 - 4.d0*dd1*temp328b6 +&
&        dd1*temp328b7
      distpb(0, 1) = (2.d0*r(0)-dd1*r(0)**2)*funb0 + ((dd1*r(0))**2-4.d0&
&        *(dd1*r(0))+2.d0)*fun2b
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + r(i)**2*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp328b5 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp328b5
      rb(k) = rb(k) - dd1*temp328b5
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.01835308852470193d0*4.5d0*dd1**3.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (5) 
! 4p double zeta
! normalized
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
!           if(iflagnorm.gt.2) then
!           c=dd1**2.5d0/dsqrt(3.d0*pi)
    c = dd1**2.5d0*0.32573500793527994772d0
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(1.d0-dd1*r(0))
      fun2 = distp(0, 1)*(dd1**2*r(0)-2.d0*dd1)
      temp331b = 2.d0*zb(indorbp, indt+4)/r(0)
      cb = fun2*zb(indorbp, indt+4) + fun*temp331b
      funb0 = c*temp331b
      rb(0) = rb(0) - c*fun*temp331b/r(0)
      fun2b = c*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp330 = rmu(i, 0)/r(0)
        temp330b3 = c*fun*zb(indorbp, indt+i)/r(0)
        cb = cb + temp330*fun*zb(indorbp, indt+i)
        funb0 = funb0 + temp330*c*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + temp330b3
        rb(0) = rb(0) - temp330*temp330b3
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp330b2 = distp(0, 1)*fun2b
      distpb(0, 1) = (1.d0-dd1*r(0))*funb0 + (dd1**2*r(0)-2.d0*dd1)*&
&        fun2b
      dd1b = (r(0)*2*dd1-2.d0)*temp330b2 - distp(0, 1)*r(0)*funb0
      rb(0) = rb(0) + dd1**2*temp330b2 - distp(0, 1)*dd1*funb0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      cb = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp330b1 = distp(i, 1)*zb(indorbp, i)
      cb = cb + r(i)*temp330b1
      rb(i) = rb(i) + c*temp330b1
      distpb(i, 1) = distpb(i, 1) + c*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    dd1b = dd1b + 0.32573500793527994772d0*2.5d0*dd1**1.5D0*cb
    DO k=indtm,indtmin,-1
      temp330b0 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp330b0
      rb(k) = rb(k) - dd1*temp330b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (88) 
! 2s double  Z NO CUSP
! g single gaussian orbital
! R(r)= exp(-alpha r^2)
! normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!     if(iflagnorm.gt.2) then
! overall normalization
!     c=16.d0/dsqrt(105.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(11.d0/4.d0)*ratiocg
    c = dd1**2.75d0*ratiocg
!     endif
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1g*(35.d0*rmu(3, i)**4-30.d0*rmu(3, i)**2*r(i)**&
&        2+3.d0*r(i)**4)
! lz=0
      distp(i, 3) = cost2g*rmu(1, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 4) = cost2g*rmu(2, i)*rmu(3, i)*(7.d0*rmu(3, i)**2-3.d0*r&
&        (i)**2)
! lz=+/-1
      distp(i, 5) = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*(7.d0*rmu(3, i)**&
&        2-r(i)**2)
! lz=+/-2
      distp(i, 6) = cost3g*2.d0*rmu(1, i)*rmu(2, i)*(7.d0*rmu(3, i)**2-r&
&        (i)**2)
! lz=+/-2
      distp(i, 7) = cost4g*rmu(1, i)*rmu(3, i)*(rmu(1, i)**2-3.0*rmu(2, &
&        i)**2)
! lz=+/-3
      distp(i, 8) = cost4g*rmu(2, i)*rmu(3, i)*(3.d0*rmu(1, i)**2-rmu(2&
&        , i)**2)
! lz=+/-3
      distp(i, 9) = cost5g*(rmu(1, i)**4-6.d0*rmu(1, i)**2*rmu(2, i)**2+&
&        rmu(2, i)**4)
! lz=+/-4
      distp(i, 10) = cost5g*4.d0*rmu(1, i)*rmu(2, i)*(rmu(1, i)**2-rmu(2&
&        , i)**2)
    END DO
! lz=+/-4
    DO ic=1,9
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 1)
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = -(dd1*distp(0, 1)*(2.d0+rp2)/rp3)
!              the second derivative
      fun2 = dd1*distp(0, 1)*(-2.d0-2.d0*rp2+4.d0*rp1+4.d0*rp1*rp2+rp1**&
&        2)/rp3**2
!              indorbp=indorb
      DO ic=1,9
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
            END IF
          ELSE IF (ic .EQ. 7) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,21)
            END IF
          ELSE IF (ic .EQ. 8) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,22)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,24)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,23)
            END IF
          ELSE IF (ic .EQ. 9) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,26)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,28)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,27)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,25)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=9,1,-1
        temp335b55 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (10.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb0 = funb0 + 10.d0*temp335b55
        fun2b = fun2b + temp335b55
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 15) THEN
            IF (branch .LT. 8) THEN
              IF (branch .LT. 5) THEN
                IF (branch .LT. 3) THEN
                  IF (branch .LT. 2) THEN
                    temp335b0 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(1, 0)*r(0)**2)-&
&                      60.d0*(rmu(1, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(1, 0) = rmub(1, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp335b0
                    rb(0) = rb(0) + 12.d0*rmu(1, 0)*2*r(0)*temp335b0
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(1, 0)*2*rmu(3, 0&
&                      )*temp335b0
                  ELSE
                    temp335b1 = cost1g*fun0*zb(indorbp, indt+i)
                    fun0b = fun0b + cost1g*(12.d0*(rmu(2, 0)*r(0)**2)-&
&                      60.d0*(rmu(2, 0)*rmu(3, 0)**2))*zb(indorbp, indt+i&
&                      )
                    rmub(2, 0) = rmub(2, 0) + (12.d0*r(0)**2-60.d0*rmu(3&
&                      , 0)**2)*temp335b1
                    rb(0) = rb(0) + 12.d0*rmu(2, 0)*2*r(0)*temp335b1
                    rmub(3, 0) = rmub(3, 0) - 60.d0*rmu(2, 0)*2*rmu(3, 0&
&                      )*temp335b1
                  END IF
                ELSE IF (branch .LT. 4) THEN
                  temp335b2 = cost1g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost1g*(80.d0*rmu(3, 0)**3-48.d0*(rmu(&
&                    3, 0)*r(0)**2))*zb(indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (80.d0*3*rmu(3, 0)**2-48.d0*&
&                    r(0)**2)*temp335b2
                  rb(0) = rb(0) - 48.d0*rmu(3, 0)*2*r(0)*temp335b2
                ELSE
                  temp335b3 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-3.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-9.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-3.d0*&
&                    rmu(2, 0)**2-9.d0*rmu(1, 0)**2)*temp335b3
                  rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp335b3
                  rmub(1, 0) = rmub(1, 0) - 9.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp335b3
                END IF
              ELSE IF (branch .LT. 7) THEN
                IF (branch .LT. 6) THEN
                  temp335b4 = -(cost2g*6.d0*zb(indorbp, indt+i))
                  temp335b5 = rmu(2, 0)*rmu(3, 0)*temp335b4
                  temp335b6 = fun0*rmu(1, 0)*temp335b4
                  fun0b = fun0b + rmu(1, 0)*temp335b5
                  rmub(1, 0) = rmub(1, 0) + fun0*temp335b5
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp335b6
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp335b6
                ELSE
                  temp335b7 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp335b8 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp335b7
                  temp335b9 = fun0*rmu(1, 0)*temp335b7
                  fun0b = fun0b + rmu(1, 0)*temp335b8
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp335b9 + fun0&
&                    *temp335b8
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp335b9
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp335b9
                END IF
              ELSE
                temp335b10 = -(cost2g*6.d0*zb(indorbp, indt+i))
                temp335b11 = rmu(2, 0)*rmu(3, 0)*temp335b10
                temp335b12 = fun0*rmu(1, 0)*temp335b10
                fun0b = fun0b + rmu(1, 0)*temp335b11
                rmub(1, 0) = rmub(1, 0) + fun0*temp335b11
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp335b12
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp335b12
              END IF
            ELSE IF (branch .LT. 12) THEN
              IF (branch .LT. 10) THEN
                IF (branch .LT. 9) THEN
                  temp335b13 = cost2g*fun0*zb(indorbp, indt+i)
                  fun0b = fun0b + cost2g*(4.d0*rmu(3, 0)**3-9.d0*(rmu(2&
&                    , 0)**2*rmu(3, 0))-3.d0*(rmu(1, 0)**2*rmu(3, 0)))*zb&
&                    (indorbp, indt+i)
                  rmub(3, 0) = rmub(3, 0) + (4.d0*3*rmu(3, 0)**2-9.d0*&
&                    rmu(2, 0)**2-3.d0*rmu(1, 0)**2)*temp335b13
                  rmub(2, 0) = rmub(2, 0) - 9.d0*rmu(3, 0)*2*rmu(2, 0)*&
&                    temp335b13
                  rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(3, 0)*2*rmu(1, 0)*&
&                    temp335b13
                ELSE
                  temp335b14 = -(cost2g*3.d0*zb(indorbp, indt+i))
                  temp335b15 = (rmu(1, 0)**2+rmu(2, 0)**2-4.d0*rmu(3, 0)&
&                    **2)*temp335b14
                  temp335b16 = fun0*rmu(2, 0)*temp335b14
                  fun0b = fun0b + rmu(2, 0)*temp335b15
                  rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp335b16 + &
&                    fun0*temp335b15
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp335b16
                  rmub(3, 0) = rmub(3, 0) - 4.d0*2*rmu(3, 0)*temp335b16
                END IF
              ELSE IF (branch .LT. 11) THEN
                temp335b17 = -(cost3g*4.d0*zb(indorbp, indt+i))
                temp335b18 = fun0*temp335b17
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(3, 0)&
&                  **2))*temp335b17
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp335b18
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(1, 0)*2*rmu(3, 0)*&
&                  temp335b18
              ELSE
                temp335b19 = cost3g*4.d0*zb(indorbp, indt+i)
                temp335b20 = fun0*temp335b19
                fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(2, 0)*rmu(3, 0)&
&                  **2))*temp335b19
                rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(3, 0)&
&                  **2)*temp335b20
                rmub(3, 0) = rmub(3, 0) - 3.d0*rmu(2, 0)*2*rmu(3, 0)*&
&                  temp335b20
              END IF
            ELSE IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                temp335b21 = cost3g*12.d0*zb(indorbp, indt+i)
                temp335b22 = fun0*rmu(3, 0)*temp335b21
                temp335b23 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp335b21
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp335b22
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp335b22
                fun0b = fun0b + rmu(3, 0)*temp335b23
                rmub(3, 0) = rmub(3, 0) + fun0*temp335b23
              ELSE
                temp335b24 = -(cost3g*2.d0*zb(indorbp, indt+i))
                temp335b25 = (3.d0*rmu(1, 0)**2+rmu(2, 0)**2-6.d0*rmu(3&
&                  , 0)**2)*temp335b24
                temp335b26 = fun0*rmu(2, 0)*temp335b24
                fun0b = fun0b + rmu(2, 0)*temp335b25
                rmub(2, 0) = rmub(2, 0) + 2*rmu(2, 0)*temp335b26 + fun0*&
&                  temp335b25
                rmub(1, 0) = rmub(1, 0) + 3.d0*2*rmu(1, 0)*temp335b26
                rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp335b26
              END IF
            ELSE
              temp335b27 = -(cost3g*2.d0*zb(indorbp, indt+i))
              temp335b28 = (rmu(1, 0)**2+3.d0*rmu(2, 0)**2-6.d0*rmu(3, 0&
&                )**2)*temp335b27
              temp335b29 = fun0*rmu(1, 0)*temp335b27
              fun0b = fun0b + rmu(1, 0)*temp335b28
              rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp335b29 + fun0*&
&                temp335b28
              rmub(2, 0) = rmub(2, 0) + 3.d0*2*rmu(2, 0)*temp335b29
              rmub(3, 0) = rmub(3, 0) - 6.d0*2*rmu(3, 0)*temp335b29
            END IF
          ELSE IF (branch .LT. 22) THEN
            IF (branch .LT. 19) THEN
              IF (branch .LT. 17) THEN
                IF (branch .LT. 16) THEN
                  temp335b30 = cost3g*24.d0*zb(indorbp, indt+i)
                  temp335b31 = rmu(2, 0)*rmu(3, 0)*temp335b30
                  temp335b32 = fun0*rmu(1, 0)*temp335b30
                  fun0b = fun0b + rmu(1, 0)*temp335b31
                  rmub(1, 0) = rmub(1, 0) + fun0*temp335b31
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp335b32
                  rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp335b32
                ELSE
                  temp335b33 = cost4g*3.d0*zb(indorbp, indt+i)
                  temp335b34 = fun0*rmu(3, 0)*temp335b33
                  temp335b35 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp335b33
                  rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp335b34
                  rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp335b34
                  fun0b = fun0b + rmu(3, 0)*temp335b35
                  rmub(3, 0) = rmub(3, 0) + fun0*temp335b35
                END IF
              ELSE IF (branch .LT. 18) THEN
                temp335b36 = -(cost4g*6.d0*zb(indorbp, indt+i))
                temp335b37 = rmu(2, 0)*rmu(3, 0)*temp335b36
                temp335b38 = fun0*rmu(1, 0)*temp335b36
                fun0b = fun0b + rmu(1, 0)*temp335b37
                rmub(1, 0) = rmub(1, 0) + fun0*temp335b37
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp335b38
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp335b38
              ELSE
                temp335b39 = cost4g*fun0*zb(indorbp, indt+i)
                fun0b = fun0b + cost4g*(rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu&
&                  (2, 0)**2))*zb(indorbp, indt+i)
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp335b39
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp335b39
              END IF
            ELSE IF (branch .LT. 21) THEN
              IF (branch .LT. 20) THEN
                temp335b40 = cost4g*6.d0*zb(indorbp, indt+i)
                temp335b41 = rmu(2, 0)*rmu(3, 0)*temp335b40
                temp335b42 = fun0*rmu(1, 0)*temp335b40
                fun0b = fun0b + rmu(1, 0)*temp335b41
                rmub(1, 0) = rmub(1, 0) + fun0*temp335b41
                rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*temp335b42
                rmub(3, 0) = rmub(3, 0) + rmu(2, 0)*temp335b42
              ELSE
                temp335b43 = cost4g*3.d0*zb(indorbp, indt+i)
                temp335b44 = fun0*rmu(3, 0)*temp335b43
                temp335b45 = (rmu(1, 0)**2-rmu(2, 0)**2)*temp335b43
                rmub(1, 0) = rmub(1, 0) + 2*rmu(1, 0)*temp335b44
                rmub(2, 0) = rmub(2, 0) - 2*rmu(2, 0)*temp335b44
                fun0b = fun0b + rmu(3, 0)*temp335b45
                rmub(3, 0) = rmub(3, 0) + fun0*temp335b45
              END IF
            ELSE
              temp335b46 = cost4g*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost4g*(3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(&
&                2, 0)**3)*zb(indorbp, indt+i)
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp335b46
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp335b46
            END IF
          ELSE IF (branch .LT. 26) THEN
            IF (branch .LT. 24) THEN
              IF (branch .LT. 23) THEN
                temp335b47 = cost5g*4.d0*zb(indorbp, indt+i)
                temp335b48 = fun0*temp335b47
                fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)&
&                  **2))*temp335b47
                rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)&
&                  **2)*temp335b48
                rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&                  temp335b48
              END IF
            ELSE IF (branch .LT. 25) THEN
              temp335b49 = cost5g*4.d0*zb(indorbp, indt+i)
              temp335b50 = fun0*temp335b49
              fun0b = fun0b + (rmu(2, 0)**3-3.d0*(rmu(1, 0)**2*rmu(2, 0)&
&                ))*temp335b49
              rmub(2, 0) = rmub(2, 0) + (3*rmu(2, 0)**2-3.d0*rmu(1, 0)**&
&                2)*temp335b50
              rmub(1, 0) = rmub(1, 0) - 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp335b50
            END IF
          ELSE IF (branch .LT. 28) THEN
            IF (branch .LT. 27) THEN
              temp335b51 = cost5g*4.d0*zb(indorbp, indt+i)
              temp335b52 = fun0*temp335b51
              fun0b = fun0b + (3.d0*(rmu(1, 0)**2*rmu(2, 0))-rmu(2, 0)**&
&                3)*temp335b51
              rmub(1, 0) = rmub(1, 0) + 3.d0*rmu(2, 0)*2*rmu(1, 0)*&
&                temp335b52
              rmub(2, 0) = rmub(2, 0) + (3.d0*rmu(1, 0)**2-3*rmu(2, 0)**&
&                2)*temp335b52
            END IF
          ELSE
            temp335b53 = cost5g*4.d0*zb(indorbp, indt+i)
            temp335b54 = fun0*temp335b53
            fun0b = fun0b + (rmu(1, 0)**3-3.d0*(rmu(1, 0)*rmu(2, 0)**2))&
&              *temp335b53
            rmub(1, 0) = rmub(1, 0) + (3*rmu(1, 0)**2-3.d0*rmu(2, 0)**2)&
&              *temp335b54
            rmub(2, 0) = rmub(2, 0) - 3.d0*rmu(1, 0)*2*rmu(2, 0)*&
&              temp335b54
          END IF
          temp335b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp335b
          funb0 = funb0 + rmu(i, 0)*temp335b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp334 = rp3**2
      temp333b = (4.d0*rp1-2.d0*rp2+4.d0*(rp1*rp2)+rp1**2-2.d0)*fun2b/&
&        temp334
      temp333 = dd1*distp(0, 1)/temp334
      temp333b0 = temp333*fun2b
      rp1b = (2*rp1+4.d0*rp2+4.d0)*temp333b0
      temp332b18 = -(distp(0, 1)*(rp2+2.d0)*funb0/rp3)
      dd1b = temp332b18 + r(0)**2*rp1b + distp(0, 1)*temp333b
      temp332 = dd1/rp3
      distpb(0, 1) = distpb(0, 1) + fun0b - temp332*(rp2+2.d0)*funb0 + &
&        dd1*temp333b
      rp3b = -(temp332*temp332b18) - temp333*2*rp3*temp333b
      rp2b = 2*(rp2+1.d0)*rp3b - temp332*distp(0, 1)*funb0 + (4.d0*rp1-&
&        2.d0)*temp333b0
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=9,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp332b0 = cost5g*4.d0*distpb(i, 10)
      temp332b1 = (rmu(1, i)**2-rmu(2, i)**2)*temp332b0
      temp332b2 = rmu(1, i)*rmu(2, i)*temp332b0
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp332b2 + rmu(2, i)*&
&        temp332b1
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp332b1 - 2*rmu(2, i)*&
&        temp332b2
      distpb(i, 10) = 0.0_8
      temp332b3 = cost5g*distpb(i, 9)
      rmub(1, i) = rmub(1, i) + (4*rmu(1, i)**3-6.d0*rmu(2, i)**2*2*rmu(&
&        1, i))*temp332b3
      distpb(i, 9) = 0.0_8
      temp332b4 = cost4g*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 8)
      temp332b5 = cost4g*rmu(2, i)*rmu(3, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp332b4 - 2*rmu(2, i)*&
&        temp332b5 + (4*rmu(2, i)**3-6.d0*rmu(1, i)**2*2*rmu(2, i))*&
&        temp332b3
      rmub(3, i) = rmub(3, i) + rmu(2, i)*temp332b4
      distpb(i, 8) = 0.0_8
      temp332b6 = cost4g*(rmu(1, i)**2-3.0*rmu(2, i)**2)*distpb(i, 7)
      temp332b7 = cost4g*rmu(1, i)*rmu(3, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp332b6 + 2*rmu(1, i)*&
&        temp332b7 + 3.d0*2*rmu(1, i)*temp332b5
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp332b6
      rmub(2, i) = rmub(2, i) - 3.0*2*rmu(2, i)*temp332b7
      distpb(i, 7) = 0.0_8
      temp332b8 = cost3g*2.d0*distpb(i, 6)
      temp332b9 = (7.d0*rmu(3, i)**2-r(i)**2)*temp332b8
      temp332b10 = rmu(1, i)*rmu(2, i)*temp332b8
      rmub(1, i) = rmub(1, i) + rmu(2, i)*temp332b9
      rmub(2, i) = rmub(2, i) + rmu(1, i)*temp332b9
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp332b10
      distpb(i, 6) = 0.0_8
      temp332b11 = cost3g*(7.d0*rmu(3, i)**2-r(i)**2)*distpb(i, 5)
      temp332b12 = cost3g*(rmu(1, i)**2-rmu(2, i)**2)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      temp332b13 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 4)
      temp332b14 = cost2g*rmu(2, i)*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      temp332b15 = cost2g*(7.d0*rmu(3, i)**2-3.d0*r(i)**2)*distpb(i, 3)
      temp332b16 = cost2g*rmu(1, i)*rmu(3, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp332b17 = cost1g*distpb(i, 2)
      rb(i) = rb(i) + (3.d0*4*r(i)**3-30.d0*rmu(3, i)**2*2*r(i))*&
&        temp332b17 - 3.d0*2*r(i)*temp332b16 - 2*r(i)*temp332b12 - 3.d0*2&
&        *r(i)*temp332b14 - 2*r(i)*temp332b10
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp332b11
      rmub(2, i) = rmub(2, i) - 2*rmu(2, i)*temp332b11
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp332b12
      rmub(2, i) = rmub(2, i) + rmu(3, i)*temp332b13
      rmub(3, i) = rmub(3, i) + 7.d0*2*rmu(3, i)*temp332b14 + rmu(2, i)*&
&        temp332b13
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp332b15
      rmub(3, i) = rmub(3, i) + (35.d0*4*rmu(3, i)**3-30.d0*r(i)**2*2*&
&        rmu(3, i))*temp332b17 + 7.d0*2*rmu(3, i)*temp332b16 + rmu(1, i)*&
&        temp332b15
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp331 = dd2*r(k) + 1.d0
      temp332b = costb/temp331
      temp331b0 = -(dd1*r(k)**2*temp332b/temp331)
      dd1b = dd1b + r(k)**2*temp332b
      rb(k) = rb(k) + dd2*temp331b0 + dd1*2*r(k)*temp332b
      dd2b = dd2b + r(k)*temp331b0
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocg*2.75d0*dd1**1.75D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocg*2.75d0*dd1**1.75D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (2100:2199) 
!     p gaussian  -r**(2*(npower+1))*exp(-alpha*r**2) derivative 1100
    npower = iopt + 1 - 2100
!        indorbp=indorb
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = -(r(k)**(2*npower)*DEXP(-(dd2*r(k)**2)))
    END DO
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      fun2 = (npower*(2.d0*npower-1.d0)-(1.d0+4.d0*npower)*dd2*rp1+2.d0*&
&        (dd2*rp1)**2)*distp(0, 1)*2.d0/rp1
!           indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!              if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp339b2 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp339b2
        fun2b = fun2b + temp339b2
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp339b1 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp339b1
          funb0 = funb0 + rmu(ic, 0)*temp339b1
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp338 = distp(0, 1)/rp1
      temp339b = 2.d0*temp338*fun2b
      temp339b0 = -((npower*4.d0+1.d0)*temp339b)
      temp338b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp337 = distp(0, 1)/rp1
      temp338b0 = 2.d0*temp337*funb0
      dd2b = rp1*temp339b0 - rp1*temp338b0 + 2.d0*rp1**2*2*dd2*temp339b
      temp337b = 2.d0*(npower-dd2*rp1)*funb0/rp1
      rp1b = dd2*temp339b0 - temp337*temp337b - temp338*temp338b - dd2*&
&        temp338b0 + 2.d0*dd2**2*2*rp1*temp339b
      distpb(0, 1) = temp337b + fun0b + temp338b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp336 = r(k)**2
      temp335 = 2*npower
      temp335b56 = -(r(k)**temp335*DEXP(-(dd2*temp336))*distpb(k, 1))
      IF (r(k) .LE. 0.0 .AND. (temp335 .EQ. 0.0 .OR. temp335 .NE. INT(&
&          temp335))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp335b56
      ELSE
        rb(k) = rb(k) - dd2*2*r(k)*temp335b56 - DEXP(-(dd2*temp336))*&
&          temp335*r(k)**(temp335-1)*distpb(k, 1)
      END IF
      dd2b = dd2b - temp336*temp335b56
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (72) 
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization  obtained by Mathematica
    c = dd1**3.25d0*0.79296269381073167718d0
!  C= dd1^13/4 /Sqrt[Integrate[x^12 Exp[-2 x^2],{x,0,Infinity}]]
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      DO k=1,5
        CALL PUSHREAL8(adr8ibuf,adr8buf,zv(k))
        zv(k) = rmu(3, i)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,yv(k))
        yv(k) = rmu(2, i)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,xv(k))
        xv(k) = rmu(1, i)**k
      END DO
      CALL PUSHREAL8(adr8ibuf,adr8buf,r2)
      r2 = xv(2) + yv(2) + zv(2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,r4)
      r4 = r2*r2
! lz=0
      distp(i, 2) = cost1h*(63.d0*zv(5)-70.d0*zv(3)*r2+15.d0*zv(1)*r4)
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 21.d0*zv(4) - 14.d0*zv(2)*r2 + r4
! lz=+/-1
      distp(i, 3) = cost2h*rmu(1, i)*cost
! lz=+/-1
      distp(i, 4) = cost2h*rmu(2, i)*cost
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 3.d0*zv(3) - zv(1)*r2
! lz=+/-2
      distp(i, 5) = cost3h*(xv(2)-yv(2))*cost
! lz=+/-2
      distp(i, 6) = 2.d0*cost3h*xv(1)*yv(1)*cost
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 9.d0*zv(2) - r2
! lz=+/-3
      distp(i, 7) = cost4h*(xv(3)-3.d0*xv(1)*yv(2))*cost
! lz=+/-3
      distp(i, 8) = -(cost4h*(yv(3)-3.d0*yv(1)*xv(2))*cost)
! lz=+/-4
      distp(i, 9) = cost5h*(xv(4)-6.d0*xv(2)*yv(2)+yv(4))*zv(1)
! lz=+/-4
      distp(i, 10) = cost5h*4.d0*(xv(3)*yv(1)-yv(3)*xv(1))*zv(1)
! lz=+/-5
      distp(i, 11) = cost6h*(xv(5)-10.d0*xv(3)*yv(2)+5.d0*xv(1)*yv(4))
! lz=+/-5
      distp(i, 12) = -(cost6h*(-(5.d0*xv(4)*yv(1))+10.d0*xv(2)*yv(3)-yv(&
&        5)))
    END DO
    DO ic=1,11
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      DO k=1,5
        CALL PUSHREAL8(adr8ibuf,adr8buf,zv(k))
        zv(k) = rmu(3, 0)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,yv(k))
        yv(k) = rmu(2, 0)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,xv(k))
        xv(k) = rmu(1, 0)**k
      END DO
      CALL PUSHREAL8(adr8ibuf,adr8buf,r2)
      r2 = xv(2) + yv(2) + zv(2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,r4)
      r4 = r2*r2
!              indorbp=indorb
      DO ic=1,11
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        ELSE IF (ic .EQ. 6) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE IF (ic .EQ. 7) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
        ELSE IF (ic .EQ. 8) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
        ELSE IF (ic .EQ. 9) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
        ELSE IF (ic .EQ. 10) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
        ELSE IF (ic .EQ. 11) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
        END IF
      END DO
      distpb = 0.0_8
      zvb = 0.0_8
      xvb = 0.0_8
      funb0 = 0.0_8
      yvb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      r2b = 0.0_8
      r4b = 0.0_8
      DO ic=11,1,-1
        temp340b61 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (12.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb0 = funb0 + 12.d0*temp340b61
        fun2b = fun2b + temp340b61
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 6) THEN
          IF (branch .LT. 3) THEN
            IF (branch .LT. 2) THEN
              IF (branch .LT. 1) THEN
                temp340b11 = cost1h*fun0*zb(indorbp, indt+3)
                temp340b12 = cost1h*20.d0*zb(indorbp, indt+2)
                temp340b13 = (3.d0*xv(2)+3.d0*yv(2)-4.d0*zv(2))*&
&                  temp340b12
                temp340b14 = cost1h*20.d0*zb(indorbp, indt+1)
                temp340b15 = (3.d0*xv(2)+3.d0*yv(2)-4.d0*zv(2))*&
&                  temp340b14
                fun0b = fun0b + zv(1)*yv(1)*temp340b13 + zv(1)*xv(1)*&
&                  temp340b15 + cost1h*(175.d0*zv(4)-150.d0*(zv(2)*r2)+&
&                  15.d0*r4)*zb(indorbp, indt+3)
                zvb(4) = zvb(4) + 175.d0*temp340b11
                zvb(2) = zvb(2) - 150.d0*r2*temp340b11
                r2b = r2b - 150.d0*zv(2)*temp340b11
                r4b = r4b + 15.d0*temp340b11
                temp340b16 = fun0*yv(1)*zv(1)*temp340b12
                yvb(1) = yvb(1) + zv(1)*fun0*temp340b13
                zvb(1) = zvb(1) + fun0*yv(1)*temp340b13
                xvb(2) = xvb(2) + 3.d0*temp340b16
                temp340b17 = fun0*xv(1)*zv(1)*temp340b14
                yvb(2) = yvb(2) + 3.d0*temp340b17 + 3.d0*temp340b16
                zvb(2) = zvb(2) - 4.d0*temp340b16
                xvb(1) = xvb(1) + zv(1)*fun0*temp340b15
                zvb(1) = zvb(1) + fun0*xv(1)*temp340b15
                xvb(2) = xvb(2) + 3.d0*temp340b17
                zvb(2) = zvb(2) - 4.d0*temp340b17
              ELSE
                temp340b18 = cost2h*fun0*zb(indorbp, indt+3)
                temp340b19 = -(24.d0*zv(1)*temp340b18)
                fun0b = fun0b + cost2h*(4.d0*(xv(3)*yv(1))+4.d0*(xv(1)*&
&                  yv(3))-24.d0*(xv(1)*yv(1)*zv(2)))*zb(indorbp, indt+2) &
&                  + cost2h*(5.d0*xv(4)+6.d0*(xv(2)*yv(2))+yv(4)+8.d0*zv(&
&                  4)-12.d0*(yv(2)*zv(2))-36.d0*(xv(2)*zv(2)))*zb(indorbp&
&                  , indt+1) + cost2h*(32.d0*(zv(3)*xv(1))-24.d0*(xv(1)*&
&                  yv(2)*zv(1))-24.d0*(xv(3)*zv(1)))*zb(indorbp, indt+3)
                zvb(3) = zvb(3) + 32.d0*xv(1)*temp340b18
                xvb(1) = xvb(1) + yv(2)*temp340b19 + 32.d0*zv(3)*&
&                  temp340b18
                yvb(2) = yvb(2) + xv(1)*temp340b19
                zvb(1) = zvb(1) + (-(24.d0*xv(3))-24.d0*xv(1)*yv(2))*&
&                  temp340b18
                temp340b20 = cost2h*fun0*zb(indorbp, indt+2)
                xvb(3) = xvb(3) + 4.d0*yv(1)*temp340b20 - 24.d0*zv(1)*&
&                  temp340b18
                temp340b21 = -(24.d0*zv(2)*temp340b20)
                yvb(1) = yvb(1) + xv(1)*temp340b21 + 4.d0*xv(3)*&
&                  temp340b20
                xvb(1) = xvb(1) + yv(1)*temp340b21 + 4.d0*yv(3)*&
&                  temp340b20
                yvb(3) = yvb(3) + 4.d0*xv(1)*temp340b20
                zvb(2) = zvb(2) - 24.d0*xv(1)*yv(1)*temp340b20
                temp340b22 = cost2h*fun0*zb(indorbp, indt+1)
                xvb(4) = xvb(4) + 5.d0*temp340b22
                xvb(2) = xvb(2) + (6.d0*yv(2)-36.d0*zv(2))*temp340b22
                yvb(2) = yvb(2) + (6.d0*xv(2)-12.d0*zv(2))*temp340b22
                yvb(4) = yvb(4) + temp340b22
                zvb(4) = zvb(4) + 8.d0*temp340b22
                zvb(2) = zvb(2) + (-(36.d0*xv(2))-12.d0*yv(2))*&
&                  temp340b22
              END IF
            ELSE
              temp340b23 = cost2h*fun0*zb(indorbp, indt+3)
              temp340b24 = -(24.d0*zv(1)*temp340b23)
              fun0b = fun0b + cost2h*(5.d0*yv(4)+6.d0*(xv(2)*yv(2))+xv(4&
&                )+8.d0*zv(4)-12.d0*(xv(2)*zv(2))-36.d0*(yv(2)*zv(2)))*zb&
&                (indorbp, indt+2) - cost2h*(24.d0*(xv(1)*yv(1)*zv(2))-&
&                4.d0*(xv(1)*yv(3))-4.d0*(xv(3)*yv(1)))*zb(indorbp, indt+&
&                1) + cost2h*(32.d0*(zv(3)*yv(1))-24.d0*(yv(1)*xv(2)*zv(1&
&                ))-24.d0*(yv(3)*zv(1)))*zb(indorbp, indt+3)
              zvb(3) = zvb(3) + 32.d0*yv(1)*temp340b23
              yvb(1) = yvb(1) + xv(2)*temp340b24 + 32.d0*zv(3)*&
&                temp340b23
              temp340b25 = cost2h*fun0*zb(indorbp, indt+2)
              xvb(2) = xvb(2) + (6.d0*yv(2)-12.d0*zv(2))*temp340b25 + yv&
&                (1)*temp340b24
              zvb(1) = zvb(1) + (-(24.d0*yv(3))-24.d0*yv(1)*xv(2))*&
&                temp340b23
              yvb(3) = yvb(3) - 24.d0*zv(1)*temp340b23
              yvb(4) = yvb(4) + 5.d0*temp340b25
              yvb(2) = yvb(2) + (6.d0*xv(2)-36.d0*zv(2))*temp340b25
              xvb(4) = xvb(4) + temp340b25
              zvb(4) = zvb(4) + 8.d0*temp340b25
              temp340b26 = -(cost2h*fun0*zb(indorbp, indt+1))
              zvb(2) = zvb(2) + 24.d0*xv(1)*yv(1)*temp340b26 + (-(36.d0*&
&                yv(2))-12.d0*xv(2))*temp340b25
              temp340b27 = 24.d0*zv(2)*temp340b26
              xvb(1) = xvb(1) + yv(1)*temp340b27 - 4.d0*yv(3)*temp340b26
              yvb(1) = yvb(1) + xv(1)*temp340b27 - 4.d0*xv(3)*temp340b26
              yvb(3) = yvb(3) - 4.d0*xv(1)*temp340b26
              xvb(3) = xvb(3) - 4.d0*yv(1)*temp340b26
            END IF
          ELSE IF (branch .LT. 5) THEN
            IF (branch .LT. 4) THEN
              temp340b28 = cost3h*fun0*zb(indorbp, indt+3)
              fun0b = fun0b + cost3h*(4.d0*(yv(3)*zv(1))-4.d0*(yv(1)*zv(&
&                3)))*zb(indorbp, indt+2) + cost3h*(4.d0*(xv(1)*zv(3))-&
&                4.d0*(xv(3)*zv(1)))*zb(indorbp, indt+1) + cost3h*(yv(4)-&
&                xv(4)+6.d0*(xv(2)*zv(2))-6.d0*(yv(2)*zv(2)))*zb(indorbp&
&                , indt+3)
              yvb(4) = yvb(4) + temp340b28
              xvb(4) = xvb(4) - temp340b28
              xvb(2) = xvb(2) + 6.d0*zv(2)*temp340b28
              zvb(2) = zvb(2) + (6.d0*xv(2)-6.d0*yv(2))*temp340b28
              yvb(2) = yvb(2) - 6.d0*zv(2)*temp340b28
              temp340b29 = cost3h*fun0*zb(indorbp, indt+2)
              yvb(3) = yvb(3) + 4.d0*zv(1)*temp340b29
              zvb(1) = zvb(1) + 4.d0*yv(3)*temp340b29
              yvb(1) = yvb(1) - 4.d0*zv(3)*temp340b29
              temp340b30 = cost3h*fun0*zb(indorbp, indt+1)
              zvb(3) = zvb(3) + 4.d0*xv(1)*temp340b30 - 4.d0*yv(1)*&
&                temp340b29
              xvb(1) = xvb(1) + 4.d0*zv(3)*temp340b30
              xvb(3) = xvb(3) - 4.d0*zv(1)*temp340b30
              zvb(1) = zvb(1) - 4.d0*xv(3)*temp340b30
            ELSE
              temp340b31 = -(cost3h*fun0*zb(indorbp, indt+3))
              temp340b32 = -(12.d0*zv(2)*temp340b31)
              fun0b = fun0b - cost3h*(2.d0*(xv(3)*zv(1))+6.d0*(xv(1)*yv(&
&                2)*zv(1))-4.d0*(xv(1)*zv(3)))*zb(indorbp, indt+2) - &
&                cost3h*(6.d0*(xv(2)*yv(1)*zv(1))+2.d0*(yv(3)*zv(1))-4.d0&
&                *(yv(1)*zv(3)))*zb(indorbp, indt+1) - cost3h*(2.d0*(xv(3&
&                )*yv(1))+2.d0*(xv(1)*yv(3))-12.d0*(xv(1)*yv(1)*zv(2)))*&
&                zb(indorbp, indt+3)
              xvb(3) = xvb(3) + 2.d0*yv(1)*temp340b31
              yvb(1) = yvb(1) + xv(1)*temp340b32 + 2.d0*xv(3)*temp340b31
              xvb(1) = xvb(1) + yv(1)*temp340b32 + 2.d0*yv(3)*temp340b31
              yvb(3) = yvb(3) + 2.d0*xv(1)*temp340b31
              zvb(2) = zvb(2) - 12.d0*xv(1)*yv(1)*temp340b31
              temp340b33 = -(cost3h*fun0*zb(indorbp, indt+2))
              temp340b34 = 6.d0*zv(1)*temp340b33
              xvb(3) = xvb(3) + 2.d0*zv(1)*temp340b33
              zvb(1) = zvb(1) + (6.d0*xv(1)*yv(2)+2.d0*xv(3))*temp340b33
              xvb(1) = xvb(1) + yv(2)*temp340b34 - 4.d0*zv(3)*temp340b33
              yvb(2) = yvb(2) + xv(1)*temp340b34
              zvb(3) = zvb(3) - 4.d0*xv(1)*temp340b33
              temp340b35 = -(cost3h*fun0*zb(indorbp, indt+1))
              temp340b36 = 6.d0*zv(1)*temp340b35
              xvb(2) = xvb(2) + yv(1)*temp340b36
              yvb(1) = yvb(1) + xv(2)*temp340b36 - 4.d0*zv(3)*temp340b35
              zvb(1) = zvb(1) + (2.d0*yv(3)+6.d0*xv(2)*yv(1))*temp340b35
              yvb(3) = yvb(3) + 2.d0*zv(1)*temp340b35
              zvb(3) = zvb(3) - 4.d0*yv(1)*temp340b35
            END IF
          ELSE
            temp340b37 = cost4h*fun0*zb(indorbp, indt+3)
            temp340b38 = -(48.d0*zv(1)*temp340b37)
            fun0b = fun0b + cost4h*(4.d0*(xv(3)*yv(1))+12.d0*(xv(1)*yv(3&
&              ))-48.d0*(xv(1)*yv(1)*zv(2)))*zb(indorbp, indt+2) + cost4h&
&              *(6.d0*(xv(2)*yv(2))-5.d0*xv(4)+3.d0*yv(4)+24.d0*(xv(2)*zv&
&              (2))-24.d0*(yv(2)*zv(2)))*zb(indorbp, indt+1) + cost4h*(&
&              16.d0*(xv(3)*zv(1))-48.d0*(xv(1)*yv(2)*zv(1)))*zb(indorbp&
&              , indt+3)
            xvb(3) = xvb(3) + 16.d0*zv(1)*temp340b37
            zvb(1) = zvb(1) + (16.d0*xv(3)-48.d0*xv(1)*yv(2))*temp340b37
            xvb(1) = xvb(1) + yv(2)*temp340b38
            yvb(2) = yvb(2) + xv(1)*temp340b38
            temp340b39 = cost4h*fun0*zb(indorbp, indt+2)
            temp340b40 = -(48.d0*zv(2)*temp340b39)
            xvb(3) = xvb(3) + 4.d0*yv(1)*temp340b39
            yvb(1) = yvb(1) + xv(1)*temp340b40 + 4.d0*xv(3)*temp340b39
            xvb(1) = xvb(1) + yv(1)*temp340b40 + 12.d0*yv(3)*temp340b39
            yvb(3) = yvb(3) + 12.d0*xv(1)*temp340b39
            temp340b41 = cost4h*fun0*zb(indorbp, indt+1)
            zvb(2) = zvb(2) + (24.d0*xv(2)-24.d0*yv(2))*temp340b41 - &
&              48.d0*xv(1)*yv(1)*temp340b39
            xvb(2) = xvb(2) + (24.d0*zv(2)+6.d0*yv(2))*temp340b41
            yvb(2) = yvb(2) + (6.d0*xv(2)-24.d0*zv(2))*temp340b41
            xvb(4) = xvb(4) - 5.d0*temp340b41
            yvb(4) = yvb(4) + 3.d0*temp340b41
          END IF
        ELSE IF (branch .LT. 9) THEN
          IF (branch .LT. 8) THEN
            IF (branch .LT. 7) THEN
              temp340b42 = -(cost4h*fun0*zb(indorbp, indt+3))
              temp340b43 = -(48.d0*zv(1)*temp340b42)
              fun0b = fun0b - cost4h*(3.d0*xv(4)+6.d0*(xv(2)*yv(2))-5.d0&
&                *yv(4)+24.d0*(yv(2)*zv(2))-24.d0*(xv(2)*zv(2)))*zb(&
&                indorbp, indt+2) - cost4h*(12.d0*(xv(3)*yv(1))+4.d0*(xv(&
&                1)*yv(3))-48.d0*(xv(1)*yv(1)*zv(2)))*zb(indorbp, indt+1)&
&                - cost4h*(16.d0*(yv(3)*zv(1))-48.d0*(xv(2)*yv(1)*zv(1)))&
&                *zb(indorbp, indt+3)
              yvb(3) = yvb(3) + 16.d0*zv(1)*temp340b42
              zvb(1) = zvb(1) + (16.d0*yv(3)-48.d0*xv(2)*yv(1))*&
&                temp340b42
              xvb(2) = xvb(2) + yv(1)*temp340b43
              yvb(1) = yvb(1) + xv(2)*temp340b43
              temp340b44 = -(cost4h*fun0*zb(indorbp, indt+2))
              xvb(4) = xvb(4) + 3.d0*temp340b44
              xvb(2) = xvb(2) + (6.d0*yv(2)-24.d0*zv(2))*temp340b44
              yvb(2) = yvb(2) + (24.d0*zv(2)+6.d0*xv(2))*temp340b44
              yvb(4) = yvb(4) - 5.d0*temp340b44
              temp340b45 = -(cost4h*fun0*zb(indorbp, indt+1))
              zvb(2) = zvb(2) + (24.d0*yv(2)-24.d0*xv(2))*temp340b44 - &
&                48.d0*xv(1)*yv(1)*temp340b45
              temp340b46 = -(48.d0*zv(2)*temp340b45)
              xvb(3) = xvb(3) + 12.d0*yv(1)*temp340b45
              yvb(1) = yvb(1) + xv(1)*temp340b46 + 12.d0*xv(3)*&
&                temp340b45
              xvb(1) = xvb(1) + yv(1)*temp340b46 + 4.d0*yv(3)*temp340b45
              yvb(3) = yvb(3) + 4.d0*xv(1)*temp340b45
            ELSE
              temp340b47 = cost5h*fun0*zb(indorbp, indt+3)
              fun0b = fun0b + cost5h*(4.d0*(yv(3)*zv(1))-12.d0*(xv(2)*yv&
&                (1)*zv(1)))*zb(indorbp, indt+2) + cost5h*(4.d0*(xv(3)*zv&
&                (1))-12.d0*(xv(1)*yv(2)*zv(1)))*zb(indorbp, indt+1) + &
&                cost5h*(xv(4)-6.d0*(xv(2)*yv(2))+yv(4))*zb(indorbp, indt&
&                +3)
              xvb(4) = xvb(4) + temp340b47
              temp340b48 = cost5h*fun0*zb(indorbp, indt+2)
              temp340b49 = -(12.d0*zv(1)*temp340b48)
              xvb(2) = xvb(2) + yv(1)*temp340b49 - 6.d0*yv(2)*temp340b47
              yvb(2) = yvb(2) - 6.d0*xv(2)*temp340b47
              yvb(4) = yvb(4) + temp340b47
              yvb(3) = yvb(3) + 4.d0*zv(1)*temp340b48
              temp340b50 = cost5h*fun0*zb(indorbp, indt+1)
              zvb(1) = zvb(1) + (4.d0*xv(3)-12.d0*xv(1)*yv(2))*&
&                temp340b50 + (4.d0*yv(3)-12.d0*xv(2)*yv(1))*temp340b48
              yvb(1) = yvb(1) + xv(2)*temp340b49
              temp340b51 = -(12.d0*zv(1)*temp340b50)
              xvb(3) = xvb(3) + 4.d0*zv(1)*temp340b50
              xvb(1) = xvb(1) + yv(2)*temp340b51
              yvb(2) = yvb(2) + xv(1)*temp340b51
            END IF
          ELSE
            temp340b52 = -(cost5h*fun0*zb(indorbp, indt+3))
            fun0b = fun0b - cost5h*(12.d0*(xv(1)*yv(2)*zv(1))-4.d0*(xv(3&
&              )*zv(1)))*zb(indorbp, indt+2) - cost5h*(4.d0*(yv(3)*zv(1))&
&              -12.d0*(xv(2)*yv(1)*zv(1)))*zb(indorbp, indt+1) - cost5h*(&
&              4.d0*(xv(1)*yv(3))-4.d0*(xv(3)*yv(1)))*zb(indorbp, indt+3)
            xvb(1) = xvb(1) + 4.d0*yv(3)*temp340b52
            yvb(3) = yvb(3) + 4.d0*xv(1)*temp340b52
            xvb(3) = xvb(3) - 4.d0*yv(1)*temp340b52
            yvb(1) = yvb(1) - 4.d0*xv(3)*temp340b52
            temp340b53 = -(cost5h*fun0*zb(indorbp, indt+2))
            temp340b54 = 12.d0*zv(1)*temp340b53
            xvb(1) = xvb(1) + yv(2)*temp340b54
            yvb(2) = yvb(2) + xv(1)*temp340b54
            temp340b55 = -(cost5h*fun0*zb(indorbp, indt+1))
            zvb(1) = zvb(1) + (4.d0*yv(3)-12.d0*xv(2)*yv(1))*temp340b55 &
&              + (12.d0*xv(1)*yv(2)-4.d0*xv(3))*temp340b53
            xvb(3) = xvb(3) - 4.d0*zv(1)*temp340b53
            temp340b56 = -(12.d0*zv(1)*temp340b55)
            yvb(3) = yvb(3) + 4.d0*zv(1)*temp340b55
            xvb(2) = xvb(2) + yv(1)*temp340b56
            yvb(1) = yvb(1) + xv(2)*temp340b56
          END IF
        ELSE IF (branch .LT. 11) THEN
          IF (branch .LT. 10) THEN
            temp340b57 = cost6h*fun0*zb(indorbp, indt+2)
            fun0b = fun0b + cost6h*(5.d0*xv(4)-30.d0*(xv(2)*yv(2))+5.d0*&
&              yv(4))*zb(indorbp, indt+1) + cost6h*(20.d0*(xv(1)*yv(3))-&
&              20.d0*(xv(3)*yv(1)))*zb(indorbp, indt+2)
            xvb(1) = xvb(1) + 20.d0*yv(3)*temp340b57
            yvb(3) = yvb(3) + 20.d0*xv(1)*temp340b57
            xvb(3) = xvb(3) - 20.d0*yv(1)*temp340b57
            yvb(1) = yvb(1) - 20.d0*xv(3)*temp340b57
            temp340b58 = cost6h*fun0*zb(indorbp, indt+1)
            xvb(4) = xvb(4) + 5.d0*temp340b58
            xvb(2) = xvb(2) - 30.d0*yv(2)*temp340b58
            yvb(2) = yvb(2) - 30.d0*xv(2)*temp340b58
            yvb(4) = yvb(4) + 5.d0*temp340b58
          END IF
        ELSE
          temp340b59 = -(cost6h*fun0*zb(indorbp, indt+2))
          fun0b = fun0b - cost6h*(20.d0*(xv(1)*yv(3))-20.d0*(xv(3)*yv(1)&
&            ))*zb(indorbp, indt+1) - cost6h*(30.d0*(xv(2)*yv(2))-5.d0*xv&
&            (4)-5.d0*yv(4))*zb(indorbp, indt+2)
          xvb(2) = xvb(2) + 30.d0*yv(2)*temp340b59
          yvb(2) = yvb(2) + 30.d0*xv(2)*temp340b59
          xvb(4) = xvb(4) - 5.d0*temp340b59
          yvb(4) = yvb(4) - 5.d0*temp340b59
          temp340b60 = -(cost6h*fun0*zb(indorbp, indt+1))
          xvb(1) = xvb(1) + 20.d0*yv(3)*temp340b60
          yvb(3) = yvb(3) + 20.d0*xv(1)*temp340b60
          xvb(3) = xvb(3) - 20.d0*yv(1)*temp340b60
          yvb(1) = yvb(1) - 20.d0*xv(3)*temp340b60
        END IF
        DO i=3,1,-1
          temp340b10 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp340b10
          funb0 = funb0 + rmu(i, 0)*temp340b10
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      CALL POPREAL8(adr8ibuf,adr8buf,r4)
      r2b = r2b + 2*r2*r4b
      CALL POPREAL8(adr8ibuf,adr8buf,r2)
      xvb(2) = xvb(2) + r2b
      yvb(2) = yvb(2) + r2b
      zvb(2) = zvb(2) + r2b
      DO k=5,1,-1
        CALL POPREAL8(adr8ibuf,adr8buf,xv(k))
        IF (.NOT.(rmu(1, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(1, 0) = rmub(1, 0) + k*rmu(1, 0)**(k-1)*xvb(k)
        xvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,yv(k))
        IF (.NOT.(rmu(2, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(2, 0) = rmub(2, 0) + k*rmu(2, 0)**(k-1)*yvb(k)
        yvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,zv(k))
        IF (.NOT.(rmu(3, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(3, 0) = rmub(3, 0) + k*rmu(3, 0)**(k-1)*zvb(k)
        zvb(k) = 0.0_8
      END DO
      temp340b9 = -(fun*2.d0*fun2b)
      funb0 = funb0 + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp340b9 - 2.d0*distp(0, 1)*funb0
      rb(0) = rb(0) + dd1*2*r(0)*temp340b9
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb0
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
      zvb = 0.0_8
      xvb = 0.0_8
      yvb = 0.0_8
    END IF
    DO ic=11,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp340b = -(cost6h*distpb(i, 12))
      xvb(2) = xvb(2) + 10.d0*yv(3)*temp340b
      yvb(3) = yvb(3) + 10.d0*xv(2)*temp340b
      xvb(4) = xvb(4) - 5.d0*yv(1)*temp340b
      yvb(1) = yvb(1) - 5.d0*xv(4)*temp340b
      yvb(5) = yvb(5) - temp340b
      distpb(i, 12) = 0.0_8
      temp340b0 = cost6h*distpb(i, 11)
      xvb(5) = xvb(5) + temp340b0
      xvb(3) = xvb(3) - 10.d0*yv(2)*temp340b0
      yvb(2) = yvb(2) - 10.d0*xv(3)*temp340b0
      xvb(1) = xvb(1) + 5.d0*yv(4)*temp340b0
      yvb(4) = yvb(4) + 5.d0*xv(1)*temp340b0
      distpb(i, 11) = 0.0_8
      temp340b1 = cost5h*4.d0*distpb(i, 10)
      temp340b2 = zv(1)*temp340b1
      xvb(3) = xvb(3) + yv(1)*temp340b2
      yvb(1) = yvb(1) + xv(3)*temp340b2
      yvb(3) = yvb(3) - xv(1)*temp340b2
      xvb(1) = xvb(1) - yv(3)*temp340b2
      distpb(i, 10) = 0.0_8
      zvb(1) = zvb(1) + cost5h*(xv(4)-6.d0*(xv(2)*yv(2))+yv(4))*distpb(i&
&        , 9) + (xv(3)*yv(1)-yv(3)*xv(1))*temp340b1
      temp340b3 = cost5h*zv(1)*distpb(i, 9)
      xvb(4) = xvb(4) + temp340b3
      distpb(i, 9) = 0.0_8
      temp340b4 = -(cost4h*cost*distpb(i, 8))
      xvb(2) = xvb(2) - 3.d0*yv(1)*temp340b4 - 6.d0*yv(2)*temp340b3
      yvb(2) = yvb(2) - 6.d0*xv(2)*temp340b3
      yvb(4) = yvb(4) + temp340b3
      yvb(3) = yvb(3) + temp340b4
      yvb(1) = yvb(1) - 3.d0*xv(2)*temp340b4
      costb = -(cost4h*(yv(3)-3.d0*(yv(1)*xv(2)))*distpb(i, 8))
      distpb(i, 8) = 0.0_8
      temp340b5 = cost4h*cost*distpb(i, 7)
      xvb(3) = xvb(3) + temp340b5
      costb = costb + cost4h*(xv(3)-3.d0*(xv(1)*yv(2)))*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp340b6 = cost3h*2.d0*distpb(i, 6)
      xvb(1) = xvb(1) + yv(1)*cost*temp340b6 - 3.d0*yv(2)*temp340b5
      yvb(2) = yvb(2) - 3.d0*xv(1)*temp340b5
      zvb(2) = zvb(2) + 9.d0*costb
      r2b = -costb
      distpb(i, 6) = 0.0_8
      temp340b7 = cost3h*distpb(i, 5)
      costb = (xv(2)-yv(2))*temp340b7 + yv(1)*xv(1)*temp340b6
      yvb(1) = yvb(1) + xv(1)*cost*temp340b6
      xvb(2) = xvb(2) + cost*temp340b7
      yvb(2) = yvb(2) - cost*temp340b7
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      zvb(3) = zvb(3) + 3.d0*costb
      zvb(1) = zvb(1) - r2*costb
      r2b = r2b - zv(1)*costb
      rmub(2, i) = rmub(2, i) + cost2h*cost*distpb(i, 4)
      costb = cost2h*rmu(2, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2h*cost*distpb(i, 3)
      costb = costb + cost2h*rmu(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      zvb(4) = zvb(4) + 21.d0*costb
      zvb(2) = zvb(2) - 14.d0*r2*costb
      temp340b8 = cost1h*distpb(i, 2)
      r4b = 15.d0*zv(1)*temp340b8 + costb
      r2b = r2b + 2*r2*r4b - 70.d0*zv(3)*temp340b8 - 14.d0*zv(2)*costb
      zvb(5) = zvb(5) + 63.d0*temp340b8
      zvb(3) = zvb(3) - 70.d0*r2*temp340b8
      zvb(1) = zvb(1) + 15.d0*r4*temp340b8
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,r4)
      CALL POPREAL8(adr8ibuf,adr8buf,r2)
      xvb(2) = xvb(2) + r2b
      yvb(2) = yvb(2) + r2b
      zvb(2) = zvb(2) + r2b
      DO k=5,1,-1
        CALL POPREAL8(adr8ibuf,adr8buf,xv(k))
        IF (.NOT.(rmu(1, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(1, i) = rmub(1, i) + k*rmu(1, i)**(k-1)*xvb(k)
        xvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,yv(k))
        IF (.NOT.(rmu(2, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(2, i) = rmub(2, i) + k*rmu(2, i)**(k-1)*yvb(k)
        yvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,zv(k))
        IF (.NOT.(rmu(3, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(3, i) = rmub(3, i) + k*rmu(3, i)**(k-1)*zvb(k)
        zvb(k) = 0.0_8
      END DO
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp339 = r(k)**2
      temp339b3 = c*DEXP(-(dd1*temp339))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp339))*distpb(k, 1)
      dd1b = dd1b - temp339*temp339b3
      rb(k) = rb(k) - dd1*2*r(k)*temp339b3
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.79296269381073167718d0*3.25d0*dd1**2.25D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (152) 
! 2s gaussian for pseudo
!     2s with cusp condition
!     ( r^3*exp(-dd2*r^2))  ! with no cusp condition
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))*r(k)
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2*dd2
      fun = (3.d0-2.d0*rp1)*distp(0, 1)
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      rp1b = (distp(0, 1)*4.d0*2*rp1-distp(0, 1)*14.d0)*fun2b - distp(0&
&        , 1)*2.d0*funb0
      distpb(0, 1) = (3.d0-2.d0*rp1)*funb0 + (4.d0*rp1**2-14.d0*rp1+6.d0&
&        )*fun2b
      rb(0) = rb(0) + dd2*2*r(0)*rp1b
      dd2b = r(0)**2*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp340 = r(k)**2
      temp340b62 = r(k)*DEXP(-(dd2*temp340))*distpb(k, 1)
      dd2b = dd2b - temp340*temp340b62
      rb(k) = rb(k) + DEXP(-(dd2*temp340))*distpb(k, 1) - dd2*2*r(k)*&
&        temp340b62
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (126) 
!     2s double exp  with constant
!     (dd3+ exp (-dd2 r)+dd4*exp(-dd5*r))
    dd2 = dd(indpar+1)
    dd4 = dd(indpar+3)
    dd5 = dd(indpar+4)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
      distp(k, 2) = DEXP(-(dd5*r(k)))
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)
!           endif
    IF (typec .NE. 1) THEN
      fun = -((dd2*distp(0, 1)+dd5*dd4*distp(0, 2))/r(0))
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp341b1 = dd5**2*fun2b
      temp341b2 = -(funb0/r(0))
      dd2b = distp(0, 1)*temp341b2 + distp(0, 1)*2*dd2*fun2b
      distpb(0, 1) = dd2**2*fun2b
      dd5b = distp(0, 2)*dd4*temp341b2 + dd4*distp(0, 2)*2*dd5*fun2b
      dd4b = distp(0, 2)*dd5*temp341b2 + distp(0, 2)*temp341b1
      distpb(0, 2) = dd4*temp341b1
      distpb(0, 1) = distpb(0, 1) + dd2*temp341b2
      distpb(0, 2) = distpb(0, 2) + dd5*dd4*temp341b2
      rb(0) = rb(0) - (dd2*distp(0, 1)+dd5*dd4*distp(0, 2))*temp341b2/r(&
&        0)
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp341b = DEXP(-(dd5*r(k)))*distpb(k, 2)
      dd5b = dd5b - r(k)*temp341b
      distpb(k, 2) = 0.0_8
      temp341b0 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp341b0 - dd5*temp341b
      dd2b = dd2b - r(k)*temp341b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+4) = ddb(indpar+4) + dd5b
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (153) 
!     2s with cusp condition
!     (-r^5*exp(-dd2*r^2))  ! derivative of 152
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))*r(k)**3
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp1 = dd2*r(0)**2
      fun = (-5.d0+2.d0*rp1)*distp(0, 1)
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      rp1b = distp(0, 1)*2.d0*funb0 + (distp(0, 1)*22.d0-distp(0, 1)*&
&        4.d0*2*rp1)*fun2b
      distpb(0, 1) = (2.d0*rp1-5.d0)*funb0 + (22.d0*rp1-4.d0*rp1**2-&
&        20.d0)*fun2b
      dd2b = r(0)**2*rp1b
      rb(0) = rb(0) + dd2*2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) - r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) - distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp341 = r(k)**2
      temp341b3 = r(k)**3*DEXP(-(dd2*temp341))*distpb(k, 1)
      dd2b = dd2b - temp341*temp341b3
      rb(k) = rb(k) + DEXP(-(dd2*temp341))*3*r(k)**2*distpb(k, 1) - dd2*&
&        2*r(k)*temp341b3
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (121) 
!     2p single exponential
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)/r(0))
      fun2 = dd2**2*distp(0, 1)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp343b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp343b0
        fun2b = fun2b + temp343b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp343b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp343b
          funb0 = funb0 + rmu(ic, 0)*temp343b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp342b0 = -(distp(0, 1)*funb0/r(0))
      dd2b = temp342b0 + distp(0, 1)*2*dd2*fun2b
      temp342 = dd2/r(0)
      distpb(0, 1) = fun0b - temp342*funb0 + dd2**2*fun2b
      rb(0) = rb(0) - temp342*temp342b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp342b = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp342b
      rb(k) = rb(k) - dd2*temp342b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (149) 
! derivative of 131 with respect z_1
! - r^4 exp(-z_1 r^2)
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun0 = dd2*r(0)**2
      fun = -(2.d0*r(0)**2*distp(0, 1)*(2.d0-fun0))
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp343b2 = -(2.d0*(2.d0*fun0**2-9.d0*fun0+6.d0)*fun2b)
      temp343b3 = -(2.d0*r(0)**2*distp(0, 1)*fun2b)
      temp343b4 = -(2.d0*r(0)**2*funb0)
      fun0b = (2.d0*2*fun0-9.d0)*temp343b3 - distp(0, 1)*temp343b4
      rb(0) = rb(0) + dd2*2*r(0)*fun0b - 2.d0*distp(0, 1)*(2.d0-fun0)*2*&
&        r(0)*funb0 + distp(0, 1)*2*r(0)*temp343b2
      distpb(0, 1) = (2.d0-fun0)*temp343b4 + r(0)**2*temp343b2
      dd2b = r(0)**2*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) - r(i)**4*zb(indorbp, i)
      rb(i) = rb(i) - distp(i, 1)*4*r(i)**3*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp343b1 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp343b1
      rb(k) = rb(k) - dd2*2*r(k)*temp343b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (147) 
! 3d single gaussian
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 3) = distp(i, 1)
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!            endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = ((2.d0*dd1*r(0))**2-2.d0*dd1)*distp(0, 1)
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        END IF
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp344b5 = distp(0, 3+ic)*zb(indorbp, indt+4)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 6.d0*temp344b5
        fun2b = fun2b + temp344b5
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 3) THEN
          IF (branch .LT. 2) THEN
            IF (branch .LT. 1) THEN
              temp344b0 = cost1d*4.d0*zb(indorbp, indt+3)
              rmub(3, 0) = rmub(3, 0) + fun0*temp344b0
              temp344b1 = -(cost1d*2.d0*zb(indorbp, indt+2))
              temp344b2 = -(cost1d*2.d0*zb(indorbp, indt+1))
              fun0b = fun0b + rmu(2, 0)*temp344b1 + rmu(1, 0)*temp344b2 &
&                + rmu(3, 0)*temp344b0
              rmub(2, 0) = rmub(2, 0) + fun0*temp344b1
              rmub(1, 0) = rmub(1, 0) + fun0*temp344b2
            ELSE
              temp344b3 = -(cost2d*2.d0*zb(indorbp, indt+2))
              rmub(2, 0) = rmub(2, 0) + fun0*temp344b3
              temp344b4 = cost2d*2.d0*zb(indorbp, indt+1)
              fun0b = fun0b + rmu(1, 0)*temp344b4 + rmu(2, 0)*temp344b3
              rmub(1, 0) = rmub(1, 0) + fun0*temp344b4
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+2)
            fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+1) + &
&              cost3d*rmu(1, 0)*zb(indorbp, indt+2)
            rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+1)
          END IF
        ELSE IF (branch .LT. 5) THEN
          IF (branch .LT. 4) THEN
            rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+3)
            fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+2) + &
&              cost3d*rmu(2, 0)*zb(indorbp, indt+3)
            rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+2)
          END IF
        ELSE
          rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+3)
          fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+1) + cost3d*&
&            rmu(1, 0)*zb(indorbp, indt+3)
          rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+1)
        END IF
        DO i=3,1,-1
          temp344b = distp(0, 3+ic)*zb(indorbp, indt+i)
          distpb(0, 3+ic) = distpb(0, 3+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp344b
          funb0 = funb0 + rmu(i, 0)*temp344b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp343 = 2.d0*dd1*r(0)
      temp343b6 = distp(0, 1)*2*temp343*2.d0*fun2b
      dd1b = r(0)*temp343b6 - distp(0, 1)*2.d0*fun2b - 2.d0*distp(0, 1)*&
&        funb0
      rb(0) = rb(0) + dd1*temp343b6
      distpb(0, 1) = distpb(0, 1) + (temp343**2-2.d0*dd1)*fun2b - 2.d0*&
&        dd1*funb0
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      distpb(i, 1) = distpb(i, 1) + distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp343b5 = DEXP(-(dd1*r(k)**2))*distpb(k, 1)
      dd1b = dd1b - r(k)**2*temp343b5
      rb(k) = rb(k) - dd1*2*r(k)*temp343b5
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (134) 
!     2p single exponential  r^3 e^{-z r}  !
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(3.d0-dd2*r(0))*r(0)
!           fun= derivative of fun0 respect to r divided dy r
      fun2 = distp(0, 1)*(dd2**2*r(0)**3-6*dd2*r(0)**2+6*r(0))
!           fun2= second derivative of fun0 respect to r
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp345b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp345b0
        fun2b = fun2b + temp345b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp345b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp345b
          funb0 = funb0 + rmu(ic, 0)*temp345b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp344 = r(0)**3
      temp344b8 = distp(0, 1)*fun2b
      temp344b9 = (3.d0-dd2*r(0))*funb0
      distpb(0, 1) = r(0)*temp344b9 + r(0)**3*fun0b + (dd2**2*temp344-6*&
&        (dd2*r(0)**2)+6*r(0))*fun2b
      temp344b10 = distp(0, 1)*r(0)*funb0
      dd2b = (temp344*2*dd2-6*r(0)**2)*temp344b8 - r(0)*temp344b10
      rb(0) = rb(0) + distp(0, 1)*temp344b9 - dd2*temp344b10 + distp(0, &
&        1)*3*r(0)**2*fun0b + (dd2**2*3*r(0)**2-6*dd2*2*r(0)+6)*temp344b8
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp344b7 = r(i)**3*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp344b7
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp344b7
        rb(i) = rb(i) + rmu(ic, i)*distp(i, 1)*3*r(i)**2*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp344b6 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp344b6
      rb(k) = rb(k) - dd2*temp344b6
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (146) 
!     2p single exponential  -r^2  e^{-z r^2}  ! derivative  of 103
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp2 = dd2*r(0)*r(0)
      fun = distp(0, 1)*(-2.d0+2.d0*rp2)
      fun2 = (-2.d0+10.d0*rp2-4.d0*rp2*rp2)*distp(0, 1)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp345b4 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp345b4
        fun2b = fun2b + temp345b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp345b3 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp345b3
          funb0 = funb0 + rmu(ic, 0)*temp345b3
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      rp2b = distp(0, 1)*2.d0*funb0 + (distp(0, 1)*10.d0-distp(0, 1)*&
&        4.d0*2*rp2)*fun2b
      distpb(0, 1) = (2.d0*rp2-2.d0)*funb0 - r(0)**2*fun0b + (10.d0*rp2-&
&        4.d0*rp2**2-2.d0)*fun2b
      rb(0) = rb(0) + dd2*2*r(0)*rp2b - distp(0, 1)*2*r(0)*fun0b
      dd2b = r(0)**2*rp2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp345b2 = -(r(i)**2*zb(indorbp, i))
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp345b2
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp345b2
        rb(i) = rb(i) - rmu(ic, i)*distp(i, 1)*2*r(i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp345b1 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp345b1
      rb(k) = rb(k) - dd2*2*r(k)*temp345b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (25) 
!     4p without cusp condition
!      r^2  ( e^{-z2 r } + z1 e^{-z3 r } )
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    dd3 = dd(indpar+3)
!        if(iflagnorm.gt.2) then
    c = 1.d0/2.d0/DSQRT(120960.d0*pi*(1.d0/(2.d0*dd1)**9+2.d0*dd3/(dd1+&
&      dd2)**9+dd3**2/(2.d0*dd2)**9))
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = r(i)**2*(distp(i, 1)+dd3*distp(i, 2))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = (2.d0*r(0)-dd1*r(0)**2)*distp(0, 1) + dd3*(2.d0*r(0)-dd2*r(0&
&        )**2)*distp(0, 2)
      fun2 = ((dd1*r(0))**2+2.d0-4.d0*dd1*r(0))*distp(0, 1) + dd3*((dd2*&
&        r(0))**2+2.d0-4.d0*dd2*r(0))*distp(0, 2)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp354 = fun/r(0)
        temp355b = rmu(ic, 0)*zb(indorbp, indt+4)
        temp354b = 4.d0*temp355b/r(0)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*temp354+fun2)*zb(indorbp, indt&
&          +4)
        funb0 = funb0 + temp354b
        rb(0) = rb(0) - temp354*temp354b
        fun2b = fun2b + temp355b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp353 = fun/r(0)
          temp353b10 = rmu(ic, 0)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          rmub(ic, 0) = rmub(ic, 0) + temp353*rmu(i, 0)*zb(indorbp, indt&
&            +i)
          rmub(i, 0) = rmub(i, 0) + temp353*rmu(ic, 0)*zb(indorbp, indt+&
&            i)
          funb0 = funb0 + temp353b10
          rb(0) = rb(0) - temp353*temp353b10
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp353b2 = distp(0, 1)*fun2b
      temp353b3 = 2*dd1*r(0)*temp353b2
      temp353b4 = dd3*distp(0, 2)*fun2b
      temp353b5 = 2*dd2*r(0)*temp353b4
      temp353b6 = ((dd2*r(0))**2-4.d0*(dd2*r(0))+2.d0)*fun2b
      temp353b7 = distp(0, 1)*funb0
      dd1b = r(0)*temp353b3 - 4.d0*r(0)*temp353b2 - r(0)**2*temp353b7
      temp353b8 = dd3*distp(0, 2)*funb0
      rb(0) = rb(0) + (2.d0-dd1*2*r(0))*temp353b7 + (2.d0-dd2*2*r(0))*&
&        temp353b8 - 4.d0*dd2*temp353b4 + dd2*temp353b5 - 4.d0*dd1*&
&        temp353b2 + dd1*temp353b3
      distpb(0, 1) = ((dd1*r(0))**2-4.d0*(dd1*r(0))+2.d0)*fun2b
      dd2b = r(0)*temp353b5 - 4.d0*r(0)*temp353b4 - r(0)**2*temp353b8
      temp353b9 = (2.d0*r(0)-dd2*r(0)**2)*funb0
      dd3b = distp(0, 2)*temp353b9 + distp(0, 2)*temp353b6
      distpb(0, 2) = dd3*temp353b6
      distpb(0, 1) = distpb(0, 1) + (2.d0*r(0)-dd1*r(0)**2)*funb0
      distpb(0, 2) = distpb(0, 2) + dd3*temp353b9
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      temp353b1 = r(i)**2*distpb(i, 3)
      rb(i) = rb(i) + (distp(i, 1)+dd3*distp(i, 2))*2*r(i)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + temp353b1
      dd3b = dd3b + distp(i, 2)*temp353b1
      distpb(i, 2) = distpb(i, 2) + dd3*temp353b1
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp353b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp353b
      distpb(k, 2) = 0.0_8
      temp353b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp353b0 - dd2*temp353b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp353b0
      distpb(k, 1) = 0.0_8
    END DO
    temp352 = 2.d0**9
    temp351 = temp352*dd2**9
    temp350 = dd3**2/temp351
    temp349 = (dd1+dd2)**9
    temp348 = 2.d0**9
    temp347 = temp348*dd1**9
    temp346 = 120960.d0*pi*(1.0/temp347+2.d0*dd3/temp349+temp350)
    temp345 = DSQRT(temp346)
    IF (temp346 .EQ. 0.0) THEN
      temp345b5 = 0.0
    ELSE
      temp345b5 = -(pi*120960.d0*cb/(2.d0*temp345**2*2.D0*DSQRT(temp346)&
&        ))
    END IF
    temp345b6 = 2.d0*temp345b5/temp349
    temp345b7 = -(dd3*9*(dd1+dd2)**8*temp345b6/temp349)
    dd1b = dd1b + temp345b7 - temp348*9*dd1**8*temp345b5/temp347**2
    dd3b = dd3b + 2*dd3*temp345b5/temp351 + temp345b6
    dd2b = dd2b + temp345b7 - temp350*temp352*9*dd2**8*temp345b5/temp351
    ddb(indpar+3) = ddb(indpar+3) + dd3b
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (32) 
! 2p triple zeta
!     3d without cusp condition triple Z
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
    dd3 = dd(indpar+4)
    peff2 = dd(indpar+5)
!        if(iflagnorm.gt.2) then
    c = 1/2.d0*DSQRT(5.d0/pi)/DSQRT(1/(2.d0*dd1)**7+2*peff/(dd1+dd2)**7+&
&      peff**2/(2.d0*dd2)**7+2*peff2/(dd1+dd3)**7+peff2**2/(2.d0*dd3)**7+&
&      2*peff*peff2/(dd2+dd3)**7)/DSQRT(720.d0)
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      distp(k, 2) = DEXP(-(dd2*r(k)))
      distp(k, 3) = DEXP(-(dd3*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = c*(distp(i, 1)+peff*distp(i, 2)+peff2*distp(i, 3))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
!lz=0
      distp(i, 5) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
!lz=+/-2
      distp(i, 6) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
! lz=+/- 2
      distp(i, 7) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
! lz=+/-1
      distp(i, 8) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 9))
! lz=+/-1
      distp(i, 9) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!        indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 4)
      fun = c*(-(dd1*distp(0, 1))-peff*dd2*distp(0, 2)-peff2*dd3*distp(0&
&        , 3))
      fun2 = c*(dd1**2*distp(0, 1)+peff*dd2**2*distp(0, 2)+peff2*dd3**2*&
&        distp(0, 3))
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp371 = fun/r(0)
        temp372b = distp(0, 4+ic)*zb(indorbp, indt+4)
        temp371b3 = 6.d0*temp372b/r(0)
        distpb(0, 4+ic) = distpb(0, 4+ic) + (6.d0*temp371+fun2)*zb(&
&          indorbp, indt+4)
        funb0 = funb0 + temp371b3
        rb(0) = rb(0) - temp371*temp371b3
        fun2b = fun2b + temp372b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp371b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp371b
                  fun0b = fun0b + rmu(i, 0)*temp371b
                ELSE
                  temp371b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp371b0
                  fun0b = fun0b + rmu(i, 0)*temp371b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp371b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp371b1
                fun0b = fun0b + rmu(i, 0)*temp371b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp371b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp371b2
                fun0b = fun0b + rmu(i, 0)*temp371b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp370 = fun/r(0)
          temp370b7 = distp(0, 4+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 4+ic) = distpb(0, 4+ic) + temp370*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp370*distp(0, 4+ic)*zb(indorbp, &
&            indt+i)
          funb0 = funb0 + temp370b7
          rb(0) = rb(0) - temp370*temp370b7
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp370b3 = c*fun2b
      temp370b4 = dd2**2*temp370b3
      temp370b5 = dd3**2*temp370b3
      cb = (-(dd1*distp(0, 1))-peff*dd2*distp(0, 2)-peff2*dd3*distp(0, 3&
&        ))*funb0 + (dd1**2*distp(0, 1)+dd2**2*(peff*distp(0, 2))+dd3**2*&
&        (peff2*distp(0, 3)))*fun2b
      temp370b6 = c*funb0
      dd1b = distp(0, 1)*2*dd1*temp370b3 - distp(0, 1)*temp370b6
      distpb(0, 1) = distpb(0, 1) + dd1**2*temp370b3
      dd2b = peff*distp(0, 2)*2*dd2*temp370b3 - distp(0, 2)*peff*&
&        temp370b6
      peffb = distp(0, 2)*temp370b4 - distp(0, 2)*dd2*temp370b6
      distpb(0, 2) = distpb(0, 2) + peff*temp370b4
      dd3b = peff2*distp(0, 3)*2*dd3*temp370b3 - distp(0, 3)*peff2*&
&        temp370b6
      peff2b = distp(0, 3)*temp370b5 - distp(0, 3)*dd3*temp370b6
      distpb(0, 3) = distpb(0, 3) + peff2*temp370b5
      distpb(0, 1) = distpb(0, 1) - dd1*temp370b6
      distpb(0, 2) = distpb(0, 2) - peff*dd2*temp370b6
      distpb(0, 3) = distpb(0, 3) - peff2*dd3*temp370b6
      distpb(0, 4) = distpb(0, 4) + fun0b
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      peff2b = 0.0_8
      cb = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 4+ic) = distpb(i, 4+ic) + distp(i, 4)*zb(indorbp, i)
        distpb(i, 4) = distpb(i, 4) + distp(i, 4+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 9))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 9)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 9)
      distpb(i, 9) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 7)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 5)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      temp370b2 = c*distpb(i, 4)
      cb = cb + (distp(i, 1)+peff*distp(i, 2)+peff2*distp(i, 3))*distpb(&
&        i, 4)
      distpb(i, 1) = distpb(i, 1) + temp370b2
      peffb = peffb + distp(i, 2)*temp370b2
      distpb(i, 2) = distpb(i, 2) + peff*temp370b2
      peff2b = peff2b + distp(i, 3)*temp370b2
      distpb(i, 3) = distpb(i, 3) + peff2*temp370b2
      distpb(i, 4) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp370b = DEXP(-(dd3*r(k)))*distpb(k, 3)
      dd3b = dd3b - r(k)*temp370b
      distpb(k, 3) = 0.0_8
      temp370b0 = DEXP(-(dd2*r(k)))*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      temp370b1 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp370b0 - dd1*temp370b1 - dd3*temp370b
      dd2b = dd2b - r(k)*temp370b0
      dd1b = dd1b - r(k)*temp370b1
      distpb(k, 1) = 0.0_8
    END DO
    temp369 = (dd2+dd3)**7
    temp355 = peff*peff2/temp369
    temp368 = 2.d0**7
    temp367 = temp368*dd3**7
    temp366 = peff2**2/temp367
    temp365 = (dd1+dd3)**7
    temp364 = 2.d0**7
    temp363 = temp364*dd2**7
    temp362 = peff**2/temp363
    temp361 = (dd1+dd2)**7
    temp360 = 2.d0**7
    temp359 = temp360*dd1**7
    temp356 = 1.0/temp359 + 2*(peff/temp361) + temp362 + 2*(peff2/&
&      temp365) + temp366 + 2*temp355
    temp358 = DSQRT(temp356)
    temp357 = 2.d0*DSQRT(720.d0)
    IF (temp356 .EQ. 0.0) THEN
      temp356b = 0.0
    ELSE
      temp356b = -(DSQRT(5.d0/pi)*cb/(temp357*temp358**2*2.D0*DSQRT(&
&        temp356)))
    END IF
    temp356b0 = 2*temp356b/temp361
    temp356b1 = -(peff*7*(dd1+dd2)**6*temp356b0/temp361)
    temp356b2 = 2*temp356b/temp365
    temp356b3 = -(peff2*7*(dd1+dd3)**6*temp356b2/temp365)
    temp355b0 = 2*temp356b/temp369
    temp355b1 = -(temp355*7*(dd2+dd3)**6*temp355b0)
    dd1b = dd1b + temp356b3 + temp356b1 - temp360*7*dd1**6*temp356b/&
&      temp359**2
    peffb = peffb + peff2*temp355b0 + 2*peff*temp356b/temp363 + &
&      temp356b0
    dd2b = dd2b + temp355b1 - temp362*temp364*7*dd2**6*temp356b/temp363 &
&      + temp356b1
    peff2b = peff2b + peff*temp355b0 + 2*peff2*temp356b/temp367 + &
&      temp356b2
    dd3b = dd3b + temp355b1 - temp366*temp368*7*dd3**6*temp356b/temp367 &
&      + temp356b3
    ddb(indpar+5) = ddb(indpar+5) + peff2b
    ddb(indpar+4) = ddb(indpar+4) + dd3b
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (145) 
!     2s without cusp condition  !derivative 100
!     -(r^2*exp(-dd2*r^2))
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun0 = dd2*r(0)**2
      fun = -(2.d0*distp(0, 1)*(1.d0-fun0))
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp372b1 = -(2.d0*distp(0, 1)*fun2b)
      distpb(0, 1) = -(2.d0*(1.d0-fun0)*funb0) - 2.d0*(2.d0*fun0**2-5.d0&
&        *fun0+1.d0)*fun2b
      fun0b = 2.d0*distp(0, 1)*funb0 + (2.d0*2*fun0-5.d0)*temp372b1
      dd2b = r(0)**2*fun0b
      rb(0) = rb(0) + dd2*2*r(0)*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) - r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) - distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp372b0 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp372b0
      rb(k) = rb(k) - dd2*2*r(k)*temp372b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (21) 
!     2p without cusp condition
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
    c = 0.5d0/DSQRT(8.d0*pi*(1.d0/(2.d0*dd1)**5+2.d0*peff/(dd1+dd2)**5+&
&      peff**2/(2.d0*dd2)**5))
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1) + peff*distp(i, 2)
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = (-(dd1*distp(0, 1))-dd2*peff*distp(0, 2))/r(0)
      fun2 = dd1**2*distp(0, 1) + peff*dd2**2*distp(0, 2)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp380b4 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp380b4
        fun2b = fun2b + temp380b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) distpb(0, 3) = distpb(0, 3) + zb(&
&              indorbp, indt+i)
          temp380b3 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp380b3
          funb0 = funb0 + rmu(ic, 0)*temp380b3
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp380b1 = dd2**2*fun2b
      temp380b2 = funb0/r(0)
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*temp380b2
      distpb(0, 1) = distpb(0, 1) + dd1**2*fun2b
      dd2b = peff*distp(0, 2)*2*dd2*fun2b - distp(0, 2)*peff*temp380b2
      peffb = distp(0, 2)*temp380b1 - distp(0, 2)*dd2*temp380b2
      distpb(0, 2) = distpb(0, 2) + peff*temp380b1
      distpb(0, 1) = distpb(0, 1) - dd1*temp380b2
      distpb(0, 2) = distpb(0, 2) - dd2*peff*temp380b2
      rb(0) = rb(0) - (-(dd1*distp(0, 1))-dd2*peff*distp(0, 2))*&
&        temp380b2/r(0)
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distpb(i, 1) = distpb(i, 1) + distpb(i, 3)
      peffb = peffb + distp(i, 2)*distpb(i, 3)
      distpb(i, 2) = distpb(i, 2) + peff*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp380b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp380b
      distpb(k, 2) = 0.0_8
      temp380b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp380b0 - dd2*temp380b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp380b0
      distpb(k, 1) = 0.0_8
    END DO
    temp379 = 2.d0**5
    temp378 = temp379*dd2**5
    temp377 = peff**2/temp378
    temp376 = (dd1+dd2)**5
    temp375 = 2.d0**5
    temp374 = temp375*dd1**5
    temp373 = 8.d0*pi*(1.0/temp374+2.d0*peff/temp376+temp377)
    temp372 = DSQRT(temp373)
    IF (temp373 .EQ. 0.0) THEN
      temp372b2 = 0.0
    ELSE
      temp372b2 = -(0.5d0*pi*8.d0*cb/(temp372**2*2.D0*DSQRT(temp373)))
    END IF
    temp372b3 = 2.d0*temp372b2/temp376
    temp372b4 = -(peff*5*(dd1+dd2)**4*temp372b3/temp376)
    dd1b = dd1b + temp372b4 - temp375*5*dd1**4*temp372b2/temp374**2
    peffb = peffb + 2*peff*temp372b2/temp378 + temp372b3
    dd2b = dd2b + temp372b4 - temp377*temp379*5*dd2**4*temp372b2/temp378
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (108) 
! 3p single zeta
!     2s double lorentian with constant  parent of 102
!     (dd3+ L(dd2 r^2)+dd4*L(dd5*r^2)) ;  L(x)=1/1+x^2
    dd2 = dd(indpar+1)
    dd4 = dd(indpar+3)
    dd5 = dd(indpar+4)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)*r(k))
      distp(k, 2) = 1.d0/(1.d0+dd5*r(k)*r(k))
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)
!           endif
    IF (typec .NE. 1) THEN
      fun = -(2.d0*(dd2*distp(0, 1)**2+dd5*dd4*distp(0, 2)**2))
      fun2b = zb(indorbp, indt+4)
      funb0 = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp383 = distp(0, 1)**3
      temp383b = 2.d0*(3.d0*(dd2*r(0)**2)-1.d0)*fun2b
      temp383b0 = 2.d0*dd2*temp383*3.d0*fun2b
      temp382 = distp(0, 2)**3
      temp382b = 2.d0*(3.d0*(dd5*r(0)**2)-1.d0)*fun2b
      temp382b0 = 2.d0*dd5*dd4*temp382*3.d0*fun2b
      temp382b1 = -(2.d0*funb0)
      dd2b = distp(0, 1)**2*temp382b1 + r(0)**2*temp383b0 + temp383*&
&        temp383b
      distpb(0, 1) = dd2*3*distp(0, 1)**2*temp383b
      rb(0) = rb(0) + dd5*2*r(0)*temp382b0 + dd2*2*r(0)*temp383b0
      temp382b2 = distp(0, 2)**2*temp382b1
      dd5b = dd4*temp382b2 + r(0)**2*temp382b0 + temp382*dd4*temp382b
      dd4b = dd5*temp382b2 + temp382*dd5*temp382b
      distpb(0, 2) = dd5*dd4*3*distp(0, 2)**2*temp382b
      distpb(0, 1) = distpb(0, 1) + dd2*2*distp(0, 1)*temp382b1
      distpb(0, 2) = distpb(0, 2) + dd5*dd4*2*distp(0, 2)*temp382b1
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp381 = dd5*r(k)**2 + 1.d0
      temp381b = -(distpb(k, 2)/temp381**2)
      dd5b = dd5b + r(k)**2*temp381b
      distpb(k, 2) = 0.0_8
      temp380 = dd2*r(k)**2 + 1.d0
      temp380b5 = -(distpb(k, 1)/temp380**2)
      rb(k) = rb(k) + dd2*2*r(k)*temp380b5 + dd5*2*r(k)*temp381b
      dd2b = dd2b + r(k)**2*temp380b5
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+4) = ddb(indpar+4) + dd5b
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (131) 
!     2s without cusp condition
!     dd1*(r^2*exp(-dd2*r^2))
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)*r(k)))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun0 = dd2*r(0)**2
      fun = 2.d0*distp(0, 1)*(1.d0-fun0)
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp384b0 = 2.d0*distp(0, 1)*fun2b
      distpb(0, 1) = 2.d0*(1.d0-fun0)*funb0 + 2.d0*(2.d0*fun0**2-5.d0*&
&        fun0+1.d0)*fun2b
      fun0b = (2.d0*2*fun0-5.d0)*temp384b0 - 2.d0*distp(0, 1)*funb0
      dd2b = r(0)**2*fun0b
      rb(0) = rb(0) + dd2*2*r(0)*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp384b = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp384b
      rb(k) = rb(k) - dd2*2*r(k)*temp384b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (133) 
!     4d  one parmater
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*r(i)
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!            endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = (1.d0-dd1*r(0))*distp(0, 1)
      fun2 = dd1*(dd1*r(0)-2.d0)*distp(0, 1)
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp385 = fun/r(0)
        temp386b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp385b3 = 6.d0*temp386b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp385+fun2)*zb(&
&          indorbp, indt+4)
        funb0 = funb0 + temp385b3
        rb(0) = rb(0) - temp385*temp385b3
        fun2b = fun2b + temp386b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp385b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp385b
                  fun0b = fun0b + rmu(i, 0)*temp385b
                ELSE
                  temp385b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp385b0
                  fun0b = fun0b + rmu(i, 0)*temp385b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp385b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp385b1
                fun0b = fun0b + rmu(i, 0)*temp385b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp385b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp385b2
                fun0b = fun0b + rmu(i, 0)*temp385b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp384 = fun/r(0)
          temp384b4 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp384*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp384*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb0 = funb0 + temp384b4
          rb(0) = rb(0) - temp384*temp384b4
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp384b2 = dd1*distp(0, 1)*fun2b
      temp384b3 = (dd1*r(0)-2.d0)*fun2b
      dd1b = distp(0, 1)*temp384b3 - distp(0, 1)*r(0)*funb0 + r(0)*&
&        temp384b2
      rb(0) = rb(0) + dd1*temp384b2 - distp(0, 1)*dd1*funb0
      distpb(0, 1) = distpb(0, 1) + (1.d0-dd1*r(0))*funb0 + dd1*&
&        temp384b3
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distpb(i, 1) = distpb(i, 1) + r(i)*distpb(i, 3)
      rb(i) = rb(i) + distp(i, 1)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp384b1 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp384b1
      rb(k) = rb(k) - dd1*temp384b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (66) 
!     derivative of 57 (orbital 1s STO regolarized for r->0)
!  dR(r)/dz    with    R(r)= C(z) * P(z*r) * exp(-z*r)
!     P(x) = (x+a)^n/(1+(x+a)^n)    with a so that P(0)==dP(0)/dx
!     C(z) = const * z^(3/2)       normalization
! the following definitions are in module constants
!     n         -> costSTO1s_n = 4
!     a         -> costSTO1s_a = 1.2263393530877080588
!     const(n)  -> costSTO1s_c = 0.58542132302621750732
!
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!             if(dd1.gt.0.) then
    c = coststo1s_c*dd1**1.5d0
!             else
!               c=1.d0
!             endif
!           endif
    DO i=indtmin,indtm
      distp(i, 1) = c*DEXP(-(dd1*r(i)))
    END DO
    DO i=i0,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
      rp1 = dd1*r(i) + coststo1s_a
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = rp1**coststo1s_n
    END DO
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
      rp1 = dd1*r(0) + coststo1s_a
      rp2 = rp1**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = rp1**coststo1s_n
      rp6 = rp4**2
!              the first derivative /r
      fun = distp(0, 1)*(dd1*rp4*(-(2.d0*coststo1s_a*(coststo1s_n**2*(-&
&        1.d0+rp4)+coststo1s_n*(1.d0+2.d0*rp1)*(1.d0+rp4)-rp2*(1.d0+rp4)&
&        **2))+rp1*(2*coststo1s_n**2*(-1+rp4)+coststo1s_n*(-3.d0+4.d0*rp1&
&        )*(1.d0+rp4)-rp1*(-5.d0+2.d0*rp1)*(1.d0+rp4)**2)))/(2.d0*rp2*(&
&        coststo1s_a-rp1)*(1.d0+rp4)**3)
!              fun=+distp(0,1)*rp4/(1.d0+rp4)*(1.5d0/dd1 + r(0)* &
!                                                            &(-1.d0+(costSTO1s_n)/(rp1*(1.d0+rp4))))               &
!                                                            &*(dd1*(2.d0 + 5.d0/(-dd1*r(0)) +                 &
!                                                            &(4.d0*costSTO1s_n**2)/(rp2*(1.d0+rp4)**2) +           &
!                                                            &(costSTO1s_n*((3.d0 - 2.d0*costSTO1s_n - 4.d0*rp1)*rp1&
!                                                            &+ 2.d0*costSTO1s_a*(1.d0+costSTO1s_n+2.d0*rp1)))/    &
!                                                            &(rp2*(dd1*r(0))*(1 + rp4))))/2.d0
!              the second derivative derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp410 = (rp4+1)**4
      temp397 = 2.d0*rp1*rp2
      temp398 = temp397*temp410
      temp409 = distp(0, 1)*dd1*rp4
      temp399 = temp409/temp398
      temp409b = -(temp399*fun2b)
      temp408 = coststo1s_n**3
      temp404 = 6.d0*rp2 - 8.d0*rp1 - 3.d0
      temp407 = (rp4+1.d0)**3
      temp406 = rp2*(2.d0*rp1-7.d0)
      temp405 = temp406*temp407 - coststo1s_n*temp404*(rp4+1.d0)**2 - &
&        coststo1s_n**2*(6.d0*rp1-1.d0)*(rp6-1.d0) - 2*temp408*(rp4*(rp4-&
&        4.d0)+1.d0)
      temp405b = rp1*temp409b
      temp404b = -(coststo1s_n*(rp4+1.d0)**2*temp405b)
      temp404b0 = -(coststo1s_n**2*temp405b)
      temp404b1 = -(temp408*2*temp405b)
      temp403 = coststo1s_n**3
      temp402 = 3.d0*rp1*(rp1+1.d0) + 2.d0
      temp401 = (rp4+1.d0)**3
      temp400 = 3.d0*coststo1s_n**2
      temp400b = coststo1s_a*2.d0*temp409b
      temp400b0 = coststo1s_n*(rp4+1.d0)**2*3.d0*temp400b
      temp399b = -((rp1*temp405+coststo1s_a*2.d0*(temp400*((rp1+1.d0)*(&
&        rp6-1.d0))-rp1*rp2*temp401+coststo1s_n*((rp4+1.d0)**2*temp402)+&
&        temp403*(rp4*(rp4-4.d0)+1.d0)))*fun2b/temp398)
      temp398b = -(temp399*temp399b)
      temp397b = temp410*temp398b
      temp396 = (rp4+1.d0)**3
      temp389 = 2.d0*rp2*(coststo1s_a-rp1)
      temp390 = temp389*temp396
      temp395 = distp(0, 1)*dd1*rp4
      temp391 = temp395/temp390
      temp395b = temp391*funb0
      temp394 = (rp4+1.d0)**2
      temp393 = rp1*(2.d0*rp1-5.d0)
      temp392 = 2*coststo1s_n**2*(rp4-1) + coststo1s_n*(4.d0*rp1-3.d0)*(&
&        rp4+1.d0) - temp393*temp394
      temp392b = -(coststo1s_a*2.d0*temp395b)
      temp391b = (rp1*temp392-coststo1s_a*2.d0*(coststo1s_n**2*(rp4-1.d0&
&        )+coststo1s_n*((2.d0*rp1+1.d0)*(rp4+1.d0))-rp2*(rp4+1.d0)**2))*&
&        funb0/temp390
      temp390b = -(temp391*temp391b)
      temp389b0 = temp396*temp390b
      rp2b = (coststo1s_a-rp1)*2.d0*temp389b0 - (rp4+1.d0)**2*temp392b +&
&        2.d0*rp1*temp397b - temp401*rp1*temp400b + 6.d0*temp404b + &
&        temp407*(2.d0*rp1-7.d0)*temp405b
      rp6b = temp400*(rp1+1.d0)*temp400b + (6.d0*rp1-1.d0)*temp404b0
      temp392b0 = rp1*temp395b
      rp4b = (coststo1s_n*(4.d0*rp1-3.d0)-temp393*2*(rp4+1.d0)+2*&
&        coststo1s_n**2)*temp392b0 + (coststo1s_n*(2.d0*rp1+1.d0)-rp2*2*(&
&        rp4+1.d0)+coststo1s_n**2)*temp392b + distp(0, 1)*dd1*temp391b + &
&        temp389*3*(rp4+1.d0)**2*temp390b + 2*rp4*rp6b + temp397*4*(rp4+1&
&        )**3*temp398b + distp(0, 1)*dd1*temp399b + (temp403*rp4+temp403*&
&        (rp4-4.d0)+coststo1s_n*temp402*2*(rp4+1.d0)-rp1*rp2*3*(rp4+1.d0)&
&        **2)*temp400b + (2*rp4-4.d0)*temp404b1 + (temp406*3*(rp4+1.d0)**&
&        2-coststo1s_n*temp404*2*(rp4+1.d0))*temp405b
      IF (rp1 .LE. 0.0 .AND. (coststo1s_n .EQ. 0.0 .OR. coststo1s_n .NE.&
&          INT(coststo1s_n))) THEN
        rp1b = temp392*temp395b + (coststo1s_n*(rp4+1.d0)*4.d0-temp394*(&
&          2.d0*rp1-5.d0)-temp394*rp1*2.d0)*temp392b0 + coststo1s_n*(rp4+&
&          1.d0)*2.d0*temp392b - 2.d0*rp2*temp389b0 + 2*rp1*rp2b + rp2*&
&          2.d0*temp397b + (2*rp1+1.d0)*temp400b0 + (temp400*(rp6-1.d0)-&
&          temp401*rp2)*temp400b + (rp6-1.d0)*6.d0*temp404b0 - 8.d0*&
&          temp404b + temp407*rp2*2.d0*temp405b + temp405*temp409b
      ELSE
        rp1b = temp392*temp395b + (coststo1s_n*(rp4+1.d0)*4.d0-temp394*(&
&          2.d0*rp1-5.d0)-temp394*rp1*2.d0)*temp392b0 + coststo1s_n*(rp4+&
&          1.d0)*2.d0*temp392b - 2.d0*rp2*temp389b0 + 2*rp1*rp2b + &
&          coststo1s_n*rp1**(coststo1s_n-1)*rp4b + rp2*2.d0*temp397b + (2&
&          *rp1+1.d0)*temp400b0 + (temp400*(rp6-1.d0)-temp401*rp2)*&
&          temp400b + (rp6-1.d0)*6.d0*temp404b0 - 8.d0*temp404b + temp407&
&          *rp2*2.d0*temp405b + temp405*temp409b
      END IF
      distpb(0, 1) = dd1*rp4*temp391b + dd1*rp4*temp399b
      dd1b = distp(0, 1)*rp4*temp391b + r(0)*rp1b + distp(0, 1)*rp4*&
&        temp399b
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      CALL POPREAL8(adr8ibuf,adr8buf,rp1)
      rb(0) = rb(0) + dd1*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp386 = rp4/(rp4+1.d0)
      temp389b = distp(i, 1)*temp386*zb(indorbp, i)
      temp387 = rp1*(rp4+1.d0)
      temp388 = coststo1s_n/temp387
      temp387b = -(r(i)*temp388*temp389b/temp387)
      temp387b0 = (1.5d0/dd1+r(i)*(temp388-1.d0))*zb(indorbp, i)
      temp386b1 = distp(i, 1)*temp387b0/(rp4+1.d0)
      rp4b = (1.0_8-temp386)*temp386b1 + rp1*temp387b
      IF (rp1 .LE. 0.0 .AND. (coststo1s_n .EQ. 0.0 .OR. coststo1s_n .NE.&
&          INT(coststo1s_n))) THEN
        rp1b = (rp4+1.d0)*temp387b
      ELSE
        rp1b = coststo1s_n*rp1**(coststo1s_n-1)*rp4b + (rp4+1.d0)*&
&          temp387b
      END IF
      dd1b = dd1b + r(i)*rp1b - 1.5d0*temp389b/dd1**2
      rb(i) = rb(i) + dd1*rp1b + (temp388-1.d0)*temp389b
      distpb(i, 1) = distpb(i, 1) + temp386*temp387b0
      zb(indorbp, i) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      CALL POPREAL8(adr8ibuf,adr8buf,rp1)
    END DO
    cb = 0.0_8
    DO i=indtm,indtmin,-1
      temp386b0 = c*DEXP(-(dd1*r(i)))*distpb(i, 1)
      cb = cb + DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp386b0
      rb(i) = rb(i) - dd1*temp386b0
      distpb(i, 1) = 0.0_8
    END DO
    dd1b = dd1b + coststo1s_c*1.5d0*dd1**0.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (57) 
!     orbital 1s (no cusp) - STO regolarized for r->0
! R(r)= C(z) * P(z*r) * exp(-z*r)
!     P(x) = (x+a)^n/(1+(x+a)^n)    with a so that P(0)==dP(0)/dx
!     C(z) = const * z^(3/2)       normalization
! the following definitions are in module constants
!     n         -> costSTO1s_n = 4
!     a         -> costSTO1s_a = 1.2263393530877080588
!     const(n)  -> costSTO1s_c = 0.58542132302621750732
!
!
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!             if(dd1.gt.0.) then
    c = coststo1s_c*dd1**1.5d0
!             else
!               c=1.d0
!             endif
!           endif
    DO i=indtmin,indtm
      distp(i, 1) = c*DEXP(-(dd1*r(i)))
    END DO
    DO i=i0,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = (dd1*r(i)+coststo1s_a)**coststo1s_n
    END DO
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0) + coststo1s_a
      rp2 = rp1**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = rp1**coststo1s_n
!              the first derivative /r
!fun=-z(indorbp,0)*((dd1**2*(-costSTO1s_n+rp1+rp1*rp4))/         &
!                                                            &(rp1*(-costSTO1s_a+rp1)*(1.d0+rp4)))
      fun = -(distp(0, 1)*rp4*(dd1**2*(-coststo1s_n+rp1+rp1*rp4)/(rp1*(-&
&        coststo1s_a+rp1)*(1.d0+rp4)**2)))
!              the second derivative derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp419 = (rp4+1.d0)**3
      temp416 = rp2*temp419
      temp417b = (rp2*(rp4+1.d0)**2-coststo1s_n*((2.d0*rp1+1.d0)*(rp4+&
&        1.d0))-coststo1s_n**2*(rp4-1.d0))*fun2b/temp416
      temp419b = dd1**2*temp417b
      temp418 = distp(0, 1)*rp4*dd1**2
      temp417 = temp418/temp416
      temp416b = -(temp417*temp417b)
      temp416b0 = temp417*fun2b
      temp415 = (rp4+1.d0)**2
      temp412 = rp1*(rp1-coststo1s_a)*temp415
      temp415b = -(funb0/temp412)
      temp413 = rp1 - coststo1s_n + rp1*rp4
      temp414b = temp413*temp415b
      temp415b0 = dd1**2*temp414b
      distpb(0, 1) = rp4*temp415b0 + rp4*temp419b
      temp414 = distp(0, 1)*rp4*dd1**2
      temp413b = temp414*temp415b
      temp412b = -(temp414*temp413*temp415b/temp412)
      rp4b = distp(0, 1)*temp415b0 + rp1*temp413b + rp1*(rp1-coststo1s_a&
&        )*2*(rp4+1.d0)*temp412b + (rp2*2*(rp4+1.d0)-coststo1s_n*(2.d0*&
&        rp1+1.d0)-coststo1s_n**2)*temp416b0 + rp2*3*(rp4+1.d0)**2*&
&        temp416b + distp(0, 1)*temp419b
      rp2b = (rp4+1.d0)**2*temp416b0 + temp419*temp416b
      IF (rp1 .LE. 0.0 .AND. (coststo1s_n .EQ. 0.0 .OR. coststo1s_n .NE.&
&          INT(coststo1s_n))) THEN
        rp1b = (rp4+1.0_8)*temp413b + (temp415*rp1+temp415*(rp1-&
&          coststo1s_a))*temp412b + 2*rp1*rp2b - coststo1s_n*(rp4+1.d0)*&
&          2.d0*temp416b0
      ELSE
        rp1b = (rp4+1.0_8)*temp413b + (temp415*rp1+temp415*(rp1-&
&          coststo1s_a))*temp412b + 2*rp1*rp2b + coststo1s_n*rp1**(&
&          coststo1s_n-1)*rp4b - coststo1s_n*(rp4+1.d0)*2.d0*temp416b0
      END IF
      dd1b = distp(0, 1)*rp4*2*dd1*temp414b + r(0)*rp1b + distp(0, 1)*&
&        rp4*2*dd1*temp417b
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      rb(0) = rb(0) + dd1*rp1b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp411 = rp4/(rp4+1.d0)
      temp411b0 = distp(i, 1)*zb(indorbp, i)/(rp4+1.d0)
      distpb(i, 1) = distpb(i, 1) + temp411*zb(indorbp, i)
      rp4b = (1.0_8-temp411)*temp411b0
      zb(indorbp, i) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      IF (coststo1s_a + dd1*r(i) .LE. 0.0 .AND. (coststo1s_n .EQ. 0.0 &
&          .OR. coststo1s_n .NE. INT(coststo1s_n))) THEN
        temp411b1 = 0.0
      ELSE
        temp411b1 = coststo1s_n*(coststo1s_a+dd1*r(i))**(coststo1s_n-1)*&
&          rp4b
      END IF
      dd1b = dd1b + r(i)*temp411b1
      rb(i) = rb(i) + dd1*temp411b1
    END DO
    cb = 0.0_8
    DO i=indtm,indtmin,-1
      temp411b = c*DEXP(-(dd1*r(i)))*distpb(i, 1)
      cb = cb + DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp411b
      rb(i) = rb(i) - dd1*temp411b
      distpb(i, 1) = 0.0_8
    END DO
    dd1b = dd1b + coststo1s_c*1.5d0*dd1**0.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (123) 
!     2p  double  exp
!       dd1 * x_mu  (exp(-dd2 r)+dd3 * exp(-dd4*r))
    dd2 = dd(indpar+1)
    dd3 = dd(indpar+2)
    dd4 = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
      distp(k, 2) = DEXP(-(dd4*r(k)))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -((dd2*distp(0, 1)+dd3*dd4*distp(0, 2))/r(0))
      fun2 = dd2**2*distp(0, 1) + dd3*dd4**2*distp(0, 2)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp420b5 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp420b5
        fun2b = fun2b + temp420b5
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp420b4 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp420b4
          funb0 = funb0 + rmu(ic, 0)*temp420b4
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp420b2 = dd4**2*fun2b
      temp420b3 = -(funb0/r(0))
      dd2b = distp(0, 1)*temp420b3 + distp(0, 1)*2*dd2*fun2b
      distpb(0, 1) = dd2**2*fun2b
      dd4b = distp(0, 2)*dd3*temp420b3 + dd3*distp(0, 2)*2*dd4*fun2b
      dd3b = distp(0, 2)*dd4*temp420b3 + distp(0, 2)*fun0b + distp(0, 2)&
&        *temp420b2
      distpb(0, 2) = dd3*temp420b2
      distpb(0, 1) = distpb(0, 1) + dd2*temp420b3
      distpb(0, 2) = distpb(0, 2) + dd3*dd4*temp420b3
      rb(0) = rb(0) - (dd2*distp(0, 1)+dd3*dd4*distp(0, 2))*temp420b3/r(&
&        0)
      distpb(0, 1) = distpb(0, 1) + fun0b
      distpb(0, 2) = distpb(0, 2) + dd3*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      dd4b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp420b1 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (distp(i, 1)+dd3*distp(i, 2))*zb(&
&          indorbp, i)
        distpb(i, 1) = distpb(i, 1) + temp420b1
        dd3b = dd3b + distp(i, 2)*temp420b1
        distpb(i, 2) = distpb(i, 2) + dd3*temp420b1
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp420b = DEXP(-(dd4*r(k)))*distpb(k, 2)
      dd4b = dd4b - r(k)*temp420b
      distpb(k, 2) = 0.0_8
      temp420b0 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd2*temp420b0 - dd4*temp420b
      dd2b = dd2b - r(k)*temp420b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (87) 
! f orbitals
! R(r)= c*exp(-z r^2)*(9/4/z-r^2)
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
    dd2 = DSQRT(dd1)
!        if(iflagnorm.gt.2) then
! overall normalization
!        c=8.d0/dsqrt(15.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)*ratiocf
    c = dd1**2.25d0*ratiocf
!        endif
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = cost1f*rmu(3, i)*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)
! lz=0
      distp(i, 3) = cost2f*rmu(1, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 4) = cost2f*rmu(2, i)*(5.d0*rmu(3, i)**2-r(i)**2)
! lz=+/-1
      distp(i, 5) = cost3f*rmu(3, i)*(rmu(1, i)**2-rmu(2, i)**2)
! lz=+/-2
      distp(i, 6) = cost3f*2.d0*rmu(3, i)*rmu(1, i)*rmu(2, i)
! lz=+/-2
      distp(i, 7) = cost4f*rmu(1, i)*(rmu(1, i)**2-3.d0*rmu(2, i)**2)
! lz=+/-3
      distp(i, 8) = cost4f*rmu(2, i)*(3.d0*rmu(1, i)**2-rmu(2, i)**2)
    END DO
! lz=+/-3
    DO ic=1,7
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
      DO k=i0,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
        cost = (1.d0+0.5d0*dd2*r(k))/(1.d0+dd2*r(k))**2
      END DO
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = (1.d0+0.5d0*rp2)/rp3
      fun0 = distp(0, 1)*(9.d0/4.d0/dd1-r(0)**2*cost)
      fun = 0.25d0*distp(0, 1)*(-26.d0-59.d0*rp2-36.d0*rp1-3.d0*rp1*rp2+&
&        2.d0*rp1**2)/rp3**2
      fun2 = 0.25d0*distp(0, 1)*(-26.d0-66.d0*rp2+22.d0*rp1+178.d0*rp1*&
&        rp2+165.d0*rp1**2+54.d0*rp1**2*rp2+rp1**3-2.d0*rp1**3*rp2)/rp3**&
&        3
!              indorbp=indorb
      DO ic=1,7
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,17)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,16)
            END IF
          ELSE IF (i .EQ. 1) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,18)
          ELSE IF (i .EQ. 2) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,20)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,19)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=7,1,-1
        temp431b23 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (8.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 8.d0*temp431b23
        fun2b = fun2b + temp431b23
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 11) THEN
            IF (branch .LT. 6) THEN
              IF (branch .LT. 4) THEN
                IF (branch .LT. 3) THEN
                  IF (.NOT.branch .LT. 2) THEN
                    temp431b2 = cost1f*zb(indorbp, indt+i)
                    fun0b = fun0b + (15.d0*rmu(i, 0)**2-3.d0*r(0)**2)*&
&                      temp431b2
                    rmub(i, 0) = rmub(i, 0) + fun0*15.d0*2*rmu(i, 0)*&
&                      temp431b2
                    rb(0) = rb(0) - fun0*3.d0*2*r(0)*temp431b2
                  END IF
                  temp431b0 = -(cost1f*6.d0*zb(indorbp, indt+i))
                  temp431b1 = rmu(i, 0)*temp431b0
                  rmub(i, 0) = rmub(i, 0) + fun0*rmu(3, 0)*temp431b0
                  fun0b = fun0b + rmu(3, 0)*temp431b1
                  rmub(3, 0) = rmub(3, 0) + fun0*temp431b1
                  GOTO 150
                ELSE
                  temp431b5 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp431b5
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp431b5
                  rb(0) = rb(0) - fun0*2*r(0)*temp431b5
                END IF
              ELSE IF (.NOT.branch .LT. 5) THEN
                temp431b6 = cost2f*10.d0*zb(indorbp, indt+i)
                temp431b7 = rmu(i, 0)*temp431b6
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp431b6
                fun0b = fun0b + rmu(1, 0)*temp431b7
                rmub(1, 0) = rmub(1, 0) + fun0*temp431b7
              END IF
              temp431b3 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp431b4 = rmu(i, 0)*temp431b3
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(1, 0)*temp431b3
              fun0b = fun0b + rmu(1, 0)*temp431b4
              rmub(1, 0) = rmub(1, 0) + fun0*temp431b4
            ELSE IF (branch .LT. 9) THEN
              IF (branch .LT. 8) THEN
                IF (branch .LT. 7) THEN
                  temp431b10 = cost2f*zb(indorbp, indt+i)
                  fun0b = fun0b + (5.d0*rmu(3, 0)**2-r(0)**2)*temp431b10
                  rmub(3, 0) = rmub(3, 0) + fun0*5.d0*2*rmu(3, 0)*&
&                    temp431b10
                  rb(0) = rb(0) - fun0*2*r(0)*temp431b10
                END IF
              ELSE
                temp431b11 = cost2f*10.d0*zb(indorbp, indt+i)
                temp431b12 = rmu(i, 0)*temp431b11
                rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp431b11
                fun0b = fun0b + rmu(2, 0)*temp431b12
                rmub(2, 0) = rmub(2, 0) + fun0*temp431b12
              END IF
              temp431b8 = -(cost2f*2.d0*zb(indorbp, indt+i))
              temp431b9 = rmu(i, 0)*temp431b8
              rmub(i, 0) = rmub(i, 0) + fun0*rmu(2, 0)*temp431b8
              fun0b = fun0b + rmu(2, 0)*temp431b9
              rmub(2, 0) = rmub(2, 0) + fun0*temp431b9
            ELSE IF (branch .LT. 10) THEN
              temp431b13 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp431b13
              rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp431b13
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp431b13
            ELSE
              temp431b14 = -(cost3f*2.d0*zb(indorbp, indt+i))
              fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp431b14
              rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp431b14
              rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp431b14
            END IF
          ELSE IF (branch .LT. 16) THEN
            IF (branch .LT. 14) THEN
              IF (branch .LT. 13) THEN
                IF (branch .LT. 12) THEN
                  temp431b15 = cost3f*zb(indorbp, indt+i)
                  fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp431b15
                  rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp431b15
                  rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp431b15
                ELSE
                  temp431b16 = cost3f*2.d0*zb(indorbp, indt+i)
                  fun0b = fun0b + rmu(3, 0)*rmu(2, 0)*temp431b16
                  rmub(2, 0) = rmub(2, 0) + rmu(3, 0)*fun0*temp431b16
                  rmub(3, 0) = rmub(3, 0) + fun0*rmu(2, 0)*temp431b16
                END IF
              ELSE
                temp431b17 = cost3f*2.d0*zb(indorbp, indt+i)
                fun0b = fun0b + rmu(3, 0)*rmu(1, 0)*temp431b17
                rmub(1, 0) = rmub(1, 0) + rmu(3, 0)*fun0*temp431b17
                rmub(3, 0) = rmub(3, 0) + fun0*rmu(1, 0)*temp431b17
              END IF
            ELSE IF (branch .LT. 15) THEN
              temp431b18 = cost3f*2.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp431b18
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp431b18
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp431b18
            ELSE
              temp431b19 = cost4f*3.d0*zb(indorbp, indt+i)
              fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp431b19
              rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp431b19
              rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp431b19
            END IF
          ELSE IF (branch .LT. 19) THEN
            IF (branch .LT. 18) THEN
              IF (.NOT.branch .LT. 17) THEN
                temp431b20 = -(cost4f*6.d0*zb(indorbp, indt+i))
                fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp431b20
                rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp431b20
                rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp431b20
              END IF
            ELSE
              temp431b21 = cost4f*6.d0*zb(indorbp, indt+i)
              fun0b = fun0b + rmu(2, 0)*rmu(1, 0)*temp431b21
              rmub(1, 0) = rmub(1, 0) + rmu(2, 0)*fun0*temp431b21
              rmub(2, 0) = rmub(2, 0) + fun0*rmu(1, 0)*temp431b21
            END IF
          ELSE IF (.NOT.branch .LT. 20) THEN
            temp431b22 = cost4f*3.d0*zb(indorbp, indt+i)
            fun0b = fun0b + (rmu(1, 0)**2-rmu(2, 0)**2)*temp431b22
            rmub(1, 0) = rmub(1, 0) + fun0*2*rmu(1, 0)*temp431b22
            rmub(2, 0) = rmub(2, 0) - fun0*2*rmu(2, 0)*temp431b22
          END IF
 150      temp431b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp431b
          funb0 = funb0 + rmu(i, 0)*temp431b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp430 = rp3**3
      temp428 = distp(0, 1)/temp430
      temp429 = rp1**3
      temp429b = 0.25d0*temp428*fun2b
      temp428b = 0.25d0*(22.d0*rp1-66.d0*rp2+178.d0*(rp1*rp2)+165.d0*rp1&
&        **2+54.d0*(rp1**2*rp2)+rp1**3-2.d0*(temp429*rp2)-26.d0)*fun2b/&
&        temp430
      temp427 = rp3**2
      temp426 = distp(0, 1)/temp427
      temp427b = 0.25d0*temp426*funb0
      rp1b = (2.d0*2*rp1-3.d0*rp2-36.d0)*temp427b + (3*rp1**2-2.d0*rp2*3&
&        *rp1**2+54.d0*rp2*2*rp1+165.d0*2*rp1+178.d0*rp2+22.d0)*temp429b
      temp426b = 0.25d0*(2.d0*rp1**2-36.d0*rp1-59.d0*rp2-3.d0*(rp1*rp2)-&
&        26.d0)*funb0/temp427
      temp424b0 = distp(0, 1)*fun0b
      costb = -(r(0)**2*temp424b0)
      rp3b = -(temp426*2*rp3*temp426b) - (0.5d0*rp2+1.d0)*costb/rp3**2 -&
&        temp428*3*rp3**2*temp428b
      rp2b = ((-59.d0)-3.d0*rp1)*temp427b + 2*(rp2+1.d0)*rp3b + 0.5d0*&
&        costb/rp3 + (54.d0*rp1**2-2.d0*temp429+178.d0*rp1-66.d0)*&
&        temp429b
      temp425 = 4.d0*dd1
      temp424 = 9.d0/temp425
      distpb(0, 1) = distpb(0, 1) + temp426b + (temp424-r(0)**2*cost)*&
&        fun0b + temp428b
      dd1b = r(0)**2*rp1b - temp424*4.d0*temp424b0/temp425
      rb(0) = rb(0) + dd2*rp2b + dd1*2*r(0)*rp1b - cost*2*r(0)*temp424b0
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      dd2b = r(0)*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=7,1,-1
      DO k=indtm,i0,-1
        temp424b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp423 = 4.d0*dd1
        temp422 = 9.d0/temp423
        temp422b = (temp422-r(k)**2*cost)*zb(indorbp, k)
        dd1b = dd1b - temp422*4.d0*temp424b/temp423
        costb = -(r(k)**2*temp424b)
        temp421 = dd2*r(k) + 1.d0
        temp422b0 = costb/temp421**2
        temp421b8 = -((0.5d0*(dd2*r(k))+1.d0)*2*temp422b0/temp421)
        rb(k) = rb(k) + 0.5d0*dd2*temp422b0 + dd2*temp421b8 - cost*2*r(k&
&          )*temp424b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp422b
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp422b
        zb(indorbp, k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,cost)
        dd2b = dd2b + r(k)*temp421b8 + 0.5d0*r(k)*temp422b0
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp421b0 = cost4f*rmu(2, i)*distpb(i, 8)
      rmub(2, i) = rmub(2, i) + cost4f*(3.d0*rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 8) - 2*rmu(2, i)*temp421b0
      distpb(i, 8) = 0.0_8
      temp421b1 = cost4f*rmu(1, i)*distpb(i, 7)
      rmub(1, i) = rmub(1, i) + cost4f*(rmu(1, i)**2-3.d0*rmu(2, i)**2)*&
&        distpb(i, 7) + 2*rmu(1, i)*temp421b1 + 3.d0*2*rmu(1, i)*&
&        temp421b0
      rmub(2, i) = rmub(2, i) - 3.d0*2*rmu(2, i)*temp421b1
      distpb(i, 7) = 0.0_8
      temp421b2 = cost3f*2.d0*distpb(i, 6)
      temp421b3 = rmu(2, i)*temp421b2
      rmub(3, i) = rmub(3, i) + rmu(1, i)*temp421b3
      rmub(1, i) = rmub(1, i) + rmu(3, i)*temp421b3
      rmub(2, i) = rmub(2, i) + rmu(3, i)*rmu(1, i)*temp421b2
      distpb(i, 6) = 0.0_8
      temp421b4 = cost3f*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3f*(rmu(1, i)**2-rmu(2, i)**2)*&
&        distpb(i, 5)
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*temp421b4
      distpb(i, 5) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 4) - 2*rmu(2, i)*temp421b4
      temp421b5 = cost2f*rmu(2, i)*distpb(i, 4)
      rmub(3, i) = rmub(3, i) + 5.d0*2*rmu(3, i)*temp421b5
      distpb(i, 4) = 0.0_8
      temp421b6 = cost2f*rmu(1, i)*distpb(i, 3)
      rmub(1, i) = rmub(1, i) + cost2f*(5.d0*rmu(3, i)**2-r(i)**2)*&
&        distpb(i, 3)
      distpb(i, 3) = 0.0_8
      temp421b7 = cost1f*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - 2*r(i)*temp421b6 - 3.d0*2*r(i)*temp421b7 - 2*r(i)*&
&        temp421b5
      rmub(3, i) = rmub(3, i) + cost1f*(5.d0*rmu(3, i)**2-3.d0*r(i)**2)*&
&        distpb(i, 2) + 5.d0*2*rmu(3, i)*temp421b7 + 5.d0*2*rmu(3, i)*&
&        temp421b6
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp420 = dd2*r(k) + 1.d0
      temp421b = costb/temp420
      temp420b6 = -(dd1*r(k)**2*temp421b/temp420)
      dd1b = dd1b + r(k)**2*temp421b
      rb(k) = rb(k) + dd2*temp420b6 + dd1*2*r(k)*temp421b
      dd2b = dd2b + r(k)*temp420b6
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocf*2.25d0*dd1**1.25D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocf*2.25d0*dd1**1.25D0*&
&        cb
    END IF
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (47) 
! d orbitals cartesian !!!
! R(r)= exp(-alpha r^2)
! each gaussian term is normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization
    c = dd1**1.75d0*1.64592278064948967213d0
!        c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = rmu(1, i)**2
      distp(i, 3) = rmu(2, i)**2
      distp(i, 4) = rmu(3, i)**2
! lz=+/-2
      distp(i, 5) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1
      distp(i, 7) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,6
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
!              indorbp=indorb
      DO ic=1,6
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .LE. 3) THEN
            IF (i .EQ. ic) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 6) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
          END IF
        END DO
!endif for ic
!enddo for i
        IF (ic .LE. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        END IF
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=6,1,-1
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 2) THEN
          temp432b1 = distp(0, 1+ic)*zb(indorbp, indt+4)
          distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp&
&            , indt+4)
          funb0 = funb0 + 6.d0*temp432b1
          fun2b = fun2b + temp432b1
          distpb(0, 1) = distpb(0, 1) + 2.d0*zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.0_8
        ELSE
          temp432b2 = distp(0, 1+ic)*zb(indorbp, indt+4)
          distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp&
&            , indt+4)
          funb0 = funb0 + 6.d0*temp432b2
          fun2b = fun2b + temp432b2
          zb(indorbp, indt+4) = 0.0_8
        END IF
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 7) THEN
            IF (branch .LT. 4) THEN
              IF (branch .LT. 3) THEN
                IF (.NOT.branch .LT. 2) THEN
                  rmub(i, 0) = rmub(i, 0) + 2.d0*fun0*zb(indorbp, indt+i&
&                    )
                  fun0b = fun0b + 2.d0*rmu(i, 0)*zb(indorbp, indt+i)
                END IF
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 6) THEN
              IF (.NOT.branch .LT. 5) THEN
                rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
              END IF
            ELSE
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 10) THEN
            IF (branch .LT. 9) THEN
              IF (.NOT.branch .LT. 8) THEN
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            END IF
          ELSE IF (branch .LT. 12) THEN
            IF (branch .LT. 11) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp432b0 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp432b0
          funb0 = funb0 + rmu(i, 0)*temp432b0
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp432b = -(fun*2.d0*fun2b)
      funb0 = funb0 + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp432b - 2.d0*distp(0, 1)*funb0
      rb(0) = rb(0) + dd1*2*r(0)*temp432b
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb0
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    DO ic=6,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(3, i) = rmub(3, i) + 2*rmu(3, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(2, i) = rmub(2, i) + 2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(1, i) = rmub(1, i) + 2*rmu(1, i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp431 = r(k)**2
      temp431b24 = c*DEXP(-(dd1*temp431))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp431))*distpb(k, 1)
      dd1b = dd1b - temp431*temp431b24
      rb(k) = rb(k) - dd1*2*r(k)*temp431b24
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.64592278064948967213d0*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (104) 
!     2p  double gaussian
!       dd1 * x_mu  (exp(-dd2 r^2)+dd3 * exp(-dd4*r^2))
    dd2 = dd(indpar+1)
    dd3 = dd(indpar+2)
    dd4 = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))
      distp(k, 2) = DEXP(-(dd4*r(k)**2))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = 2.d0*(-(dd2*distp(0, 1))-dd4*dd3*distp(0, 2))
      fun2 = 2.d0*(dd2*(-1.d0+2.d0*dd2*r(0)**2)*distp(0, 1)+dd4*dd3*(-&
&        1.d0+2.d0*dd4*r(0)**2)*distp(0, 2))
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp432b13 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp432b13
        fun2b = fun2b + temp432b13
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp432b12 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp432b12
          funb0 = funb0 + rmu(ic, 0)*temp432b12
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp432b6 = 2.d0*fun2b
      temp432b7 = dd2*distp(0, 1)*2.d0*temp432b6
      temp432b8 = (2.d0*(dd2*r(0)**2)-1.d0)*temp432b6
      temp432b9 = (2.d0*(dd4*r(0)**2)-1.d0)*temp432b6
      temp432b10 = dd4*dd3*distp(0, 2)*2.d0*temp432b6
      temp432b11 = 2.d0*funb0
      dd2b = distp(0, 1)*temp432b8 - distp(0, 1)*temp432b11 + r(0)**2*&
&        temp432b7
      rb(0) = rb(0) + dd4*2*r(0)*temp432b10 + dd2*2*r(0)*temp432b7
      distpb(0, 1) = dd2*temp432b8
      dd4b = r(0)**2*temp432b10 - distp(0, 2)*dd3*temp432b11 + distp(0, &
&        2)*dd3*temp432b9
      dd3b = distp(0, 2)*fun0b - distp(0, 2)*dd4*temp432b11 + distp(0, 2&
&        )*dd4*temp432b9
      distpb(0, 2) = dd4*dd3*temp432b9
      distpb(0, 1) = distpb(0, 1) - dd2*temp432b11
      distpb(0, 2) = distpb(0, 2) - dd4*dd3*temp432b11
      distpb(0, 1) = distpb(0, 1) + fun0b
      distpb(0, 2) = distpb(0, 2) + dd3*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      dd4b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp432b5 = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (distp(i, 1)+dd3*distp(i, 2))*zb(&
&          indorbp, i)
        distpb(i, 1) = distpb(i, 1) + temp432b5
        dd3b = dd3b + distp(i, 2)*temp432b5
        distpb(i, 2) = distpb(i, 2) + dd3*temp432b5
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp432b3 = DEXP(-(dd4*r(k)**2))*distpb(k, 2)
      dd4b = dd4b - r(k)**2*temp432b3
      distpb(k, 2) = 0.0_8
      temp432b4 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      rb(k) = rb(k) - dd2*2*r(k)*temp432b4 - dd4*2*r(k)*temp432b3
      dd2b = dd2b - r(k)**2*temp432b4
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (199) 
! derivative of 200 LA COSTANTE
    indorbp = indorb + 1
!           endif
    IF (typec .NE. 1) THEN
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        zb(indorbp, indt+i) = 0.0_8
      END DO
    END IF
    DO i=indtm,i0,-1
      zb(indorbp, i) = 0.0_8
    END DO
    distpb = 0.0_8
  CASE (11) 
! R(r)=r**2*(exp(-z1*r)+p*exp(-z2*r))
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
!           if(iflagnorm.gt.2) then
    c = 1.d0/2.d0/DSQRT(pi*720.d0*(1.d0/(2.d0*dd1)**7+2.d0*peff/(dd1+dd2&
&      )**7+peff**2/(2.d0*dd2)**7))
!           endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
      distp(k, 2) = c*DEXP(-(dd2*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
!              the first derivative
      fun = distp(0, 1)*(2.d0*r(0)-dd1*rp1) + peff*distp(0, 2)*(2.d0*r(0&
&        )-dd2*rp1)
!
!              the second derivative
      temp441b = 2.d0*zb(indorbp, indt+4)/r(0)
      funb0 = temp441b
      rb(0) = rb(0) - fun*temp441b/r(0)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp440 = fun/r(0)
        temp440b8 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp440*zb(indorbp, indt+i)
        funb0 = funb0 + temp440b8
        rb(0) = rb(0) - temp440*temp440b8
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp440b2 = distp(0, 1)*fun2b
      temp440b3 = (dd2**2*rp1-4.d0*(dd2*r(0))+2.d0)*fun2b
      temp440b4 = peff*distp(0, 2)*fun2b
      distpb(0, 1) = (dd1**2*rp1-4.d0*(dd1*r(0))+2.d0)*fun2b
      temp440b5 = distp(0, 1)*funb0
      dd1b = (rp1*2*dd1-4.d0*r(0))*temp440b2 - rp1*temp440b5
      temp440b6 = peff*distp(0, 2)*funb0
      rp1b = dd2**2*temp440b4 - dd2*temp440b6 - dd1*temp440b5 + dd1**2*&
&        temp440b2
      rb(0) = rb(0) + 2.d0*temp440b5 + 2.d0*temp440b6 + 2*r(0)*rp1b - &
&        4.d0*dd2*temp440b4 - 4.d0*dd1*temp440b2
      temp440b7 = (2.d0*r(0)-dd2*rp1)*funb0
      peffb = distp(0, 2)*temp440b7 + distp(0, 2)*temp440b3
      distpb(0, 2) = peff*temp440b3
      dd2b = (rp1*2*dd2-4.d0*r(0))*temp440b4 - rp1*temp440b6
      distpb(0, 1) = distpb(0, 1) + (2.d0*r(0)-dd1*rp1)*funb0
      distpb(0, 2) = distpb(0, 2) + peff*temp440b7
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp440b1 = r(i)**2*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp440b1
      peffb = peffb + distp(i, 2)*temp440b1
      distpb(i, 2) = distpb(i, 2) + peff*temp440b1
      rb(i) = rb(i) + (distp(i, 1)+peff*distp(i, 2))*2*r(i)*zb(indorbp, &
&        i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp440b = c*DEXP(-(dd2*r(k)))*distpb(k, 2)
      cb = cb + DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp440b
      distpb(k, 2) = 0.0_8
      temp440b0 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp440b0 - dd2*temp440b
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp440b0
      distpb(k, 1) = 0.0_8
    END DO
    temp439 = 2.d0**7
    temp438 = temp439*dd2**7
    temp437 = peff**2/temp438
    temp436 = (dd1+dd2)**7
    temp435 = 2.d0**7
    temp434 = temp435*dd1**7
    temp433 = 720.d0*pi*(1.0/temp434+2.d0*peff/temp436+temp437)
    temp432 = DSQRT(temp433)
    IF (temp433 .EQ. 0.0) THEN
      temp432b14 = 0.0
    ELSE
      temp432b14 = -(pi*720.d0*cb/(2.d0*temp432**2*2.D0*DSQRT(temp433)))
    END IF
    temp432b15 = 2.d0*temp432b14/temp436
    temp432b16 = -(peff*7*(dd1+dd2)**6*temp432b15/temp436)
    dd1b = dd1b + temp432b16 - temp435*7*dd1**6*temp432b14/temp434**2
    peffb = peffb + 2*peff*temp432b14/temp438 + temp432b15
    dd2b = dd2b + temp432b16 - temp437*temp439*7*dd2**6*temp432b14/&
&      temp438
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (39) 
! 4s single zeta
! R(r)=r**3*exp(-z1*r)
!
!       if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!           c=dsqrt((2*dd1)**9/40320.d0/pi)/2.d0
!           c=dsqrt((2*dd1)**7/720.d0/pi)/2.d0
    c = dd1**3.5d0*0.11894160774351807429d0
!           c=-c
!           endif
    c0 = -c
    c1 = 3.5d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)**3
      rp2 = r(0)**2
!              fun=(2.d0-dd1*r(0))*distp(0,1)
!              fun2=(2.d0-4*dd1*r(0)+(dd1*r(0))**2)*distp(0,1)
!
!c              the first derivative/r
      fun = distp(0, 1)*(c0*(3.d0*r(0)-dd1*rp2)+c1*(2.d0-dd1*r(0)))
!c
!c              the second derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp443 = (dd1*r(0))**2 - 4*(dd1*r(0)) + 2.d0
      temp444 = 6.d0*r(0) - 6.d0*dd1*rp2 + dd1**2*rp1
      temp445b = distp(0, 1)*fun2b
      temp444b = c0*temp445b
      temp443b = c1*temp445b
      temp443b0 = 2*dd1*r(0)*temp443b
      temp442 = 3.d0*r(0) - dd1*rp2
      distpb(0, 1) = (c0*temp442+c1*(2.d0-dd1*r(0)))*funb0 + (c0*temp444&
&        +c1*temp443)*fun2b
      temp443b1 = distp(0, 1)*funb0
      c0b = temp442*temp443b1 + temp444*temp445b
      temp442b0 = c0*temp443b1
      rp2b = -(dd1*temp442b0) - 6.d0*dd1*temp444b
      rp1b = dd1**2*temp444b
      rb(0) = rb(0) + 3.d0*temp442b0 - c1*dd1*temp443b1 + 3*r(0)**2*rp1b&
&        + 2*r(0)*rp2b - 4*dd1*temp443b + dd1*temp443b0 + 6.d0*temp444b
      dd1b = r(0)*temp443b0 - c1*r(0)*temp443b1 - 4*r(0)*temp443b - rp2*&
&        temp442b0 + (rp1*2*dd1-6.d0*rp2)*temp444b
      c1b = (2.d0-dd1*r(0))*temp443b1 + temp443*temp445b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp442b = distp(i, 1)*zb(indorbp, i)
      temp441 = r(i)**3
      c0b = c0b + temp441*temp442b
      rb(i) = rb(i) + (c1*2*r(i)+c0*3*r(i)**2)*temp442b
      c1b = c1b + r(i)**2*temp442b
      distpb(i, 1) = distpb(i, 1) + (c0*temp441+c1*r(i)**2)*zb(indorbp, &
&        i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp441b1 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp441b1
      rb(k) = rb(k) - dd1*temp441b1
      distpb(k, 1) = 0.0_8
    END DO
    temp441b0 = 3.5d0*c1b/dd1
    cb = temp441b0 - c0b
    dd1b = dd1b + 0.11894160774351807429d0*3.5d0*dd1**2.5D0*cb - c*&
&      temp441b0/dd1
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (132) 
!
! 3p single zeta
!     2s with cusp condition
!     ( r^3*exp(-dd2*r))  ! with no cusp condition
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))*r(k)
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = (3.d0-dd2*r(0))*distp(0, 1)
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp445b1 = distp(0, 1)*fun2b
      temp445b2 = 2*dd2*r(0)*temp445b1
      dd2b = r(0)*temp445b2 - 6*r(0)*temp445b1 - distp(0, 1)*r(0)*funb0
      rb(0) = rb(0) + dd2*temp445b2 - 6*dd2*temp445b1 - distp(0, 1)*dd2*&
&        funb0
      distpb(0, 1) = (3.d0-dd2*r(0))*funb0 + ((dd2*r(0))**2-6*(dd2*r(0))&
&        +6.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp445b0 = r(k)*DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp445b0
      rb(k) = rb(k) + DEXP(-(dd2*r(k)))*distpb(k, 1) - dd2*temp445b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (30) 
!     3d without cusp and one parmater
    dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then
!     c=                                                           &
!                                                              &1.d0/(2.d0**3*3.d0)*dsqrt(1.d0/pi)*(2.d0*dd1)**(7.d0/2.d0)
    c = dd1**3.5d0*0.26596152026762178d0
!         endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 3) = distp(i, 1)
! lz=0
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!            endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(dd1*distp(0, 1))
      fun2 = dd1**2*distp(0, 1)
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp446 = fun/r(0)
        temp447b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp446b3 = 6.d0*temp447b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp446+fun2)*zb(&
&          indorbp, indt+4)
        funb0 = funb0 + temp446b3
        rb(0) = rb(0) - temp446*temp446b3
        fun2b = fun2b + temp447b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp446b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp446b
                  fun0b = fun0b + rmu(i, 0)*temp446b
                ELSE
                  temp446b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp446b0
                  fun0b = fun0b + rmu(i, 0)*temp446b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp446b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp446b1
                fun0b = fun0b + rmu(i, 0)*temp446b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp446b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp446b2
                fun0b = fun0b + rmu(i, 0)*temp446b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp445 = fun/r(0)
          temp445b4 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp445*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp445*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb0 = funb0 + temp445b4
          rb(0) = rb(0) - temp445*temp445b4
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb0
      distpb(0, 1) = distpb(0, 1) + dd1**2*fun2b - dd1*funb0
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      distpb(i, 1) = distpb(i, 1) + distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp445b3 = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp445b3
      rb(k) = rb(k) - dd1*temp445b3
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.26596152026762178d0*3.5d0*dd1**2.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (73) 
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization  obtained by Mathematica
    c = dd1**3.75d0*0.43985656185609913955d0
!  C= dd1^15/4 /Sqrt[Integrate[x^14 Exp[-2 x^2],{x,0,Infinity}]]
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
      DO k=1,6
        CALL PUSHREAL8(adr8ibuf,adr8buf,zv(k))
        zv(k) = rmu(3, i)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,yv(k))
        yv(k) = rmu(2, i)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,xv(k))
        xv(k) = rmu(1, i)**k
      END DO
      CALL PUSHREAL8(adr8ibuf,adr8buf,r2)
      r2 = xv(2) + yv(2) + zv(2)
      CALL PUSHREAL8(adr8ibuf,adr8buf,r4)
      r4 = r2*r2
      r6 = r2*r4
! lz=0
      distp(i, 2) = cost1i*(231.d0*zv(6)-315.d0*zv(4)*r2+105.d0*zv(2)*r4&
&        -5.d0*r6)
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 33.d0*zv(5) - 30.d0*zv(3)*r2 + 5.d0*zv(1)*r4
! lz=+/-1
      distp(i, 3) = cost2i*rmu(1, i)*cost
! lz=+/-1
      distp(i, 4) = cost2i*rmu(2, i)*cost
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 33.d0*zv(4) - 18.d0*zv(2)*r2 + r4
! lz=+/-2
      distp(i, 5) = cost3i*(xv(2)-yv(2))*cost
! lz=+/-2
      distp(i, 6) = 2.d0*cost3i*xv(1)*yv(1)*cost
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 11.d0*zv(3) - 3.d0*zv(1)*r2
! lz=+/-3
      distp(i, 7) = cost4i*(xv(3)-3.d0*xv(1)*yv(2))*cost
! lz=+/-3
      distp(i, 8) = -(cost4i*(yv(3)-3.d0*yv(1)*xv(2))*cost)
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = 11.d0*zv(2) - r2
! lz=+/-4
      distp(i, 9) = cost5i*(xv(4)-6.d0*xv(2)*yv(2)+yv(4))*cost
! lz=+/-4
      distp(i, 10) = cost5i*4.d0*(xv(3)*yv(1)-yv(3)*xv(1))*cost
! lz=+/-5
      distp(i, 11) = cost6i*(xv(5)-10.d0*xv(3)*yv(2)+5.d0*xv(1)*yv(4))*&
&        zv(1)
! lz=+/-5
      distp(i, 12) = -(cost6i*(-(5.d0*xv(4)*yv(1))+10.d0*xv(2)*yv(3)-yv(&
&        5))*zv(1))
! lz=+/-6
      distp(i, 13) = cost7i*(xv(6)-15.d0*xv(4)*yv(2)+15.d0*xv(2)*yv(4)-&
&        yv(6))
! lz=+/-6
      distp(i, 14) = -(cost7i*(-(6.d0*xv(5)*yv(1))+20.d0*xv(3)*yv(3)-&
&        6.d0*yv(5)*xv(1)))
    END DO
    DO ic=1,13
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)
      fun = -(2.d0*dd1*distp(0, 1))
      fun2 = fun*(1.d0-2.d0*dd1*r(0)**2)
      DO k=1,6
        CALL PUSHREAL8(adr8ibuf,adr8buf,zv(k))
        zv(k) = rmu(3, 0)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,yv(k))
        yv(k) = rmu(2, 0)**k
        CALL PUSHREAL8(adr8ibuf,adr8buf,xv(k))
        xv(k) = rmu(1, 0)**k
      END DO
!              indorbp=indorb
      DO ic=1,13
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        IF (ic .EQ. 1) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
        ELSE IF (ic .EQ. 2) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
        ELSE IF (ic .EQ. 3) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
        ELSE IF (ic .EQ. 4) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
        ELSE IF (ic .EQ. 5) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
        ELSE IF (ic .EQ. 6) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
        ELSE IF (ic .EQ. 7) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
        ELSE IF (ic .EQ. 8) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
        ELSE IF (ic .EQ. 9) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
        ELSE IF (ic .EQ. 10) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
        ELSE IF (ic .EQ. 11) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
        ELSE IF (ic .EQ. 12) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
        ELSE IF (ic .EQ. 13) THEN
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
        ELSE
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
        END IF
      END DO
      distpb = 0.0_8
      zvb = 0.0_8
      xvb = 0.0_8
      funb0 = 0.0_8
      yvb = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=13,1,-1
        temp448b91 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (14.d0*fun+fun2)*zb(indorbp&
&          , indt+4)
        funb0 = funb0 + 14.d0*temp448b91
        fun2b = fun2b + temp448b91
        zb(indorbp, indt+4) = 0.0_8
        CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
        IF (branch .LT. 7) THEN
          IF (branch .LT. 4) THEN
            IF (branch .LT. 2) THEN
              IF (branch .LT. 1) THEN
                temp448b13 = cost1i*fun0*zb(indorbp, indt+3)
                temp448b14 = 360.d0*zv(1)*temp448b13
                fun0b = fun0b + cost1i*(360.d0*(xv(2)*yv(1)*zv(2))-60.d0&
&                  *(xv(2)*yv(3))-30.d0*yv(5)-30.d0*(xv(4)*yv(1))+360.d0*&
&                  (yv(3)*zv(2))-240.d0*(yv(1)*zv(4)))*zb(indorbp, indt+2&
&                  ) + cost1i*(360.d0*(xv(3)*zv(2))-60.d0*(xv(3)*yv(2))-&
&                  30.d0*(xv(1)*yv(4))-30.d0*xv(5)+360.d0*(xv(1)*yv(2)*zv&
&                  (2))-240.d0*(xv(1)*zv(4)))*zb(indorbp, indt+1) + &
&                  cost1i*(180.d0*(xv(4)*zv(1))+360.d0*(xv(2)*yv(2)*zv(1)&
&                  )+180.d0*(yv(4)*zv(1))+96.d0*zv(5)-480.d0*(yv(2)*zv(3)&
&                  )-480.d0*(xv(2)*zv(3)))*zb(indorbp, indt+3)
                xvb(4) = xvb(4) + 180.d0*zv(1)*temp448b13
                zvb(1) = zvb(1) + (180.d0*yv(4)+360.d0*xv(2)*yv(2)+&
&                  180.d0*xv(4))*temp448b13
                temp448b15 = cost1i*fun0*zb(indorbp, indt+2)
                temp448b16 = 360.d0*zv(2)*temp448b15
                xvb(2) = xvb(2) + yv(1)*temp448b16 - 60.d0*yv(3)*&
&                  temp448b15 - 480.d0*zv(3)*temp448b13 + yv(2)*&
&                  temp448b14
                yvb(2) = yvb(2) + xv(2)*temp448b14 - 480.d0*zv(3)*&
&                  temp448b13
                yvb(4) = yvb(4) + 180.d0*zv(1)*temp448b13
                zvb(5) = zvb(5) + 96.d0*temp448b13
                zvb(3) = zvb(3) + (-(480.d0*xv(2))-480.d0*yv(2))*&
&                  temp448b13
                yvb(1) = yvb(1) + (-(240.d0*zv(4))-30.d0*xv(4))*&
&                  temp448b15 + xv(2)*temp448b16
                zvb(2) = zvb(2) + (360.d0*yv(3)+360.d0*xv(2)*yv(1))*&
&                  temp448b15
                yvb(3) = yvb(3) + (360.d0*zv(2)-60.d0*xv(2))*temp448b15
                yvb(5) = yvb(5) - 30.d0*temp448b15
                xvb(4) = xvb(4) - 30.d0*yv(1)*temp448b15
                zvb(4) = zvb(4) - 240.d0*yv(1)*temp448b15
                temp448b17 = cost1i*fun0*zb(indorbp, indt+1)
                temp448b18 = 360.d0*zv(2)*temp448b17
                xvb(3) = xvb(3) + (360.d0*zv(2)-60.d0*yv(2))*temp448b17
                zvb(2) = zvb(2) + (360.d0*xv(1)*yv(2)+360.d0*xv(3))*&
&                  temp448b17
                yvb(2) = yvb(2) + xv(1)*temp448b18 - 60.d0*xv(3)*&
&                  temp448b17
                xvb(1) = xvb(1) + yv(2)*temp448b18 + (-(240.d0*zv(4))-&
&                  30.d0*yv(4))*temp448b17
                yvb(4) = yvb(4) - 30.d0*xv(1)*temp448b17
                xvb(5) = xvb(5) - 30.d0*temp448b17
                zvb(4) = zvb(4) - 240.d0*xv(1)*temp448b17
              ELSE
                temp448b19 = cost2i*fun0*zb(indorbp, indt+3)
                temp448b20 = -(60.d0*zv(2)*temp448b19)
                fun0b = fun0b + cost2i*(20.d0*(xv(3)*yv(1)*zv(1))+20.d0*&
&                  (xv(1)*yv(3)*zv(1))-40.d0*(xv(1)*yv(1)*zv(3)))*zb(&
&                  indorbp, indt+2) + cost2i*(25.d0*(xv(4)*zv(1))+30.d0*(&
&                  xv(2)*yv(2)*zv(1))+5.d0*(yv(4)*zv(1))+8.d0*zv(5)-20.d0&
&                  *(yv(2)*zv(3))-60.d0*(xv(2)*zv(3)))*zb(indorbp, indt+1&
&                  ) + cost2i*(5.d0*xv(5)+10.d0*(xv(3)*yv(2))+5.d0*(yv(4)&
&                  *xv(1))+40.d0*(xv(1)*zv(4))-60.d0*(xv(1)*yv(2)*zv(2))-&
&                  60.d0*(xv(3)*zv(2)))*zb(indorbp, indt+3)
                xvb(5) = xvb(5) + 5.d0*temp448b19
                xvb(3) = xvb(3) + (10.d0*yv(2)-60.d0*zv(2))*temp448b19
                yvb(2) = yvb(2) + xv(1)*temp448b20 + 10.d0*xv(3)*&
&                  temp448b19
                yvb(4) = yvb(4) + 5.d0*xv(1)*temp448b19
                xvb(1) = xvb(1) + yv(2)*temp448b20 + (40.d0*zv(4)+5.d0*&
&                  yv(4))*temp448b19
                zvb(4) = zvb(4) + 40.d0*xv(1)*temp448b19
                zvb(2) = zvb(2) + (-(60.d0*xv(3))-60.d0*xv(1)*yv(2))*&
&                  temp448b19
                temp448b21 = cost2i*fun0*zb(indorbp, indt+2)
                temp448b22 = 20.d0*zv(1)*temp448b21
                temp448b23 = 20.d0*zv(1)*temp448b21
                temp448b24 = -(40.d0*zv(3)*temp448b21)
                xvb(3) = xvb(3) + yv(1)*temp448b22
                yvb(1) = yvb(1) + xv(1)*temp448b24 + xv(3)*temp448b22
                zvb(1) = zvb(1) + (20.d0*xv(1)*yv(3)+20.d0*xv(3)*yv(1))*&
&                  temp448b21
                xvb(1) = xvb(1) + yv(1)*temp448b24 + yv(3)*temp448b23
                yvb(3) = yvb(3) + xv(1)*temp448b23
                zvb(3) = zvb(3) - 40.d0*xv(1)*yv(1)*temp448b21
                temp448b25 = cost2i*fun0*zb(indorbp, indt+1)
                temp448b26 = 30.d0*zv(1)*temp448b25
                xvb(4) = xvb(4) + 25.d0*zv(1)*temp448b25
                zvb(1) = zvb(1) + (5.d0*yv(4)+30.d0*xv(2)*yv(2)+25.d0*xv&
&                  (4))*temp448b25
                xvb(2) = xvb(2) + yv(2)*temp448b26 - 60.d0*zv(3)*&
&                  temp448b25
                yvb(2) = yvb(2) + xv(2)*temp448b26 - 20.d0*zv(3)*&
&                  temp448b25
                yvb(4) = yvb(4) + 5.d0*zv(1)*temp448b25
                zvb(5) = zvb(5) + 8.d0*temp448b25
                zvb(3) = zvb(3) + (-(60.d0*xv(2))-20.d0*yv(2))*&
&                  temp448b25
              END IF
            ELSE IF (branch .LT. 3) THEN
              temp448b27 = -(cost2i*fun0*zb(indorbp, indt+3))
              temp448b28 = 60.d0*zv(2)*temp448b27
              fun0b = fun0b - cost2i*(20.d0*(xv(2)*zv(3))-30.d0*(xv(2)*&
&                yv(2)*zv(1))-25.d0*(yv(4)*zv(1))-5.d0*(xv(4)*zv(1))+&
&                60.d0*(yv(2)*zv(3))-8.d0*zv(5))*zb(indorbp, indt+2) - &
&                cost2i*(40.d0*(xv(1)*yv(1)*zv(3))-20.d0*(xv(1)*yv(3)*zv(&
&                1))-20.d0*(xv(3)*yv(1)*zv(1)))*zb(indorbp, indt+1) - &
&                cost2i*(60.d0*(xv(2)*yv(1)*zv(2))-10.d0*(xv(2)*yv(3))-&
&                5.d0*yv(5)-5.d0*(xv(4)*yv(1))+60.d0*(yv(3)*zv(2))-40.d0*&
&                (yv(1)*zv(4)))*zb(indorbp, indt+3)
              xvb(2) = xvb(2) + yv(1)*temp448b28 - 10.d0*yv(3)*&
&                temp448b27
              yvb(1) = yvb(1) + (-(40.d0*zv(4))-5.d0*xv(4))*temp448b27 +&
&                xv(2)*temp448b28
              zvb(2) = zvb(2) + (60.d0*yv(3)+60.d0*xv(2)*yv(1))*&
&                temp448b27
              yvb(3) = yvb(3) + (60.d0*zv(2)-10.d0*xv(2))*temp448b27
              yvb(5) = yvb(5) - 5.d0*temp448b27
              xvb(4) = xvb(4) - 5.d0*yv(1)*temp448b27
              zvb(4) = zvb(4) - 40.d0*yv(1)*temp448b27
              temp448b29 = -(cost2i*fun0*zb(indorbp, indt+2))
              temp448b30 = -(30.d0*zv(1)*temp448b29)
              xvb(2) = xvb(2) + yv(2)*temp448b30 + 20.d0*zv(3)*&
&                temp448b29
              zvb(3) = zvb(3) + (60.d0*yv(2)+20.d0*xv(2))*temp448b29
              yvb(2) = yvb(2) + 60.d0*zv(3)*temp448b29 + xv(2)*&
&                temp448b30
              zvb(1) = zvb(1) + (-(5.d0*xv(4))-25.d0*yv(4)-30.d0*xv(2)*&
&                yv(2))*temp448b29
              yvb(4) = yvb(4) - 25.d0*zv(1)*temp448b29
              xvb(4) = xvb(4) - 5.d0*zv(1)*temp448b29
              zvb(5) = zvb(5) - 8.d0*temp448b29
              temp448b31 = -(cost2i*fun0*zb(indorbp, indt+1))
              temp448b32 = 40.d0*zv(3)*temp448b31
              temp448b33 = -(20.d0*zv(1)*temp448b31)
              temp448b34 = -(20.d0*zv(1)*temp448b31)
              xvb(1) = xvb(1) + yv(3)*temp448b33 + yv(1)*temp448b32
              yvb(1) = yvb(1) + xv(3)*temp448b34 + xv(1)*temp448b32
              zvb(3) = zvb(3) + 40.d0*xv(1)*yv(1)*temp448b31
              yvb(3) = yvb(3) + xv(1)*temp448b33
              zvb(1) = zvb(1) + (-(20.d0*xv(3)*yv(1))-20.d0*xv(1)*yv(3))&
&                *temp448b31
              xvb(3) = xvb(3) + yv(1)*temp448b34
            ELSE
              temp448b35 = cost3i*fun0*zb(indorbp, indt+3)
              fun0b = fun0b + cost3i*(2.d0*(xv(4)*yv(1))-4.d0*(xv(2)*yv(&
&                3))-6.d0*yv(5)+64.d0*(yv(3)*zv(2))-32.d0*(yv(1)*zv(4)))*&
&                zb(indorbp, indt+2) + cost3i*(6.d0*xv(5)+4.d0*(xv(3)*yv(&
&                2))-2.d0*(xv(1)*yv(4))+32.d0*(xv(1)*zv(4))-64.d0*(xv(3)*&
&                zv(2)))*zb(indorbp, indt+1) + cost3i*(32.d0*(yv(4)*zv(1)&
&                )-32.d0*(xv(4)*zv(1))+64.d0*(xv(2)*zv(3))-64.d0*(yv(2)*&
&                zv(3)))*zb(indorbp, indt+3)
              yvb(4) = yvb(4) + 32.d0*zv(1)*temp448b35
              zvb(1) = zvb(1) + (32.d0*yv(4)-32.d0*xv(4))*temp448b35
              xvb(4) = xvb(4) - 32.d0*zv(1)*temp448b35
              xvb(2) = xvb(2) + 64.d0*zv(3)*temp448b35
              zvb(3) = zvb(3) + (64.d0*xv(2)-64.d0*yv(2))*temp448b35
              yvb(2) = yvb(2) - 64.d0*zv(3)*temp448b35
              temp448b36 = cost3i*fun0*zb(indorbp, indt+2)
              xvb(4) = xvb(4) + 2.d0*yv(1)*temp448b36
              yvb(1) = yvb(1) + (2.d0*xv(4)-32.d0*zv(4))*temp448b36
              xvb(2) = xvb(2) - 4.d0*yv(3)*temp448b36
              yvb(3) = yvb(3) + (64.d0*zv(2)-4.d0*xv(2))*temp448b36
              yvb(5) = yvb(5) - 6.d0*temp448b36
              zvb(2) = zvb(2) + 64.d0*yv(3)*temp448b36
              temp448b37 = cost3i*fun0*zb(indorbp, indt+1)
              zvb(4) = zvb(4) + 32.d0*xv(1)*temp448b37 - 32.d0*yv(1)*&
&                temp448b36
              xvb(5) = xvb(5) + 6.d0*temp448b37
              xvb(3) = xvb(3) + (4.d0*yv(2)-64.d0*zv(2))*temp448b37
              yvb(2) = yvb(2) + 4.d0*xv(3)*temp448b37
              xvb(1) = xvb(1) + (32.d0*zv(4)-2.d0*yv(4))*temp448b37
              yvb(4) = yvb(4) - 2.d0*xv(1)*temp448b37
              zvb(2) = zvb(2) - 64.d0*xv(3)*temp448b37
            END IF
          ELSE IF (branch .LT. 6) THEN
            IF (branch .LT. 5) THEN
              temp448b38 = -(cost3i*fun0*zb(indorbp, indt+3))
              temp448b39 = 64.d0*zv(1)*temp448b38
              temp448b40 = 64.d0*zv(1)*temp448b38
              temp448b41 = -(128.d0*zv(3)*temp448b38)
              fun0b = fun0b - cost3i*(32.d0*(xv(3)*zv(2))-12.d0*(xv(3)*&
&                yv(2))-10.d0*(xv(1)*yv(4))-2.d0*xv(5)+96.d0*(xv(1)*yv(2)&
&                *zv(2))-32.d0*(xv(1)*zv(4)))*zb(indorbp, indt+2) - &
&                cost3i*(96.d0*(xv(2)*yv(1)*zv(2))-12.d0*(xv(2)*yv(3))-&
&                2.d0*yv(5)-10.d0*(xv(4)*yv(1))+32.d0*(yv(3)*zv(2))-32.d0&
&                *(yv(1)*zv(4)))*zb(indorbp, indt+1) - cost3i*(64.d0*(xv(&
&                3)*yv(1)*zv(1))+64.d0*(xv(1)*yv(3)*zv(1))-128.d0*(xv(1)*&
&                yv(1)*zv(3)))*zb(indorbp, indt+3)
              xvb(3) = xvb(3) + yv(1)*temp448b39
              yvb(1) = yvb(1) + xv(1)*temp448b41 + xv(3)*temp448b39
              zvb(1) = zvb(1) + (64.d0*xv(1)*yv(3)+64.d0*xv(3)*yv(1))*&
&                temp448b38
              xvb(1) = xvb(1) + yv(1)*temp448b41 + yv(3)*temp448b40
              yvb(3) = yvb(3) + xv(1)*temp448b40
              zvb(3) = zvb(3) - 128.d0*xv(1)*yv(1)*temp448b38
              temp448b42 = -(cost3i*fun0*zb(indorbp, indt+2))
              temp448b43 = 96.d0*zv(2)*temp448b42
              xvb(3) = xvb(3) + (32.d0*zv(2)-12.d0*yv(2))*temp448b42
              zvb(2) = zvb(2) + (96.d0*xv(1)*yv(2)+32.d0*xv(3))*&
&                temp448b42
              yvb(2) = yvb(2) + xv(1)*temp448b43 - 12.d0*xv(3)*&
&                temp448b42
              xvb(1) = xvb(1) + yv(2)*temp448b43 + (-(32.d0*zv(4))-10.d0&
&                *yv(4))*temp448b42
              yvb(4) = yvb(4) - 10.d0*xv(1)*temp448b42
              xvb(5) = xvb(5) - 2.d0*temp448b42
              zvb(4) = zvb(4) - 32.d0*xv(1)*temp448b42
              temp448b44 = -(cost3i*fun0*zb(indorbp, indt+1))
              temp448b45 = 96.d0*zv(2)*temp448b44
              xvb(2) = xvb(2) + yv(1)*temp448b45 - 12.d0*yv(3)*&
&                temp448b44
              yvb(1) = yvb(1) + (-(32.d0*zv(4))-10.d0*xv(4))*temp448b44 &
&                + xv(2)*temp448b45
              zvb(2) = zvb(2) + (32.d0*yv(3)+96.d0*xv(2)*yv(1))*&
&                temp448b44
              yvb(3) = yvb(3) + (32.d0*zv(2)-12.d0*xv(2))*temp448b44
              yvb(5) = yvb(5) - 2.d0*temp448b44
              xvb(4) = xvb(4) - 10.d0*yv(1)*temp448b44
              zvb(4) = zvb(4) - 32.d0*yv(1)*temp448b44
            ELSE
              temp448b46 = cost4i*fun0*zb(indorbp, indt+3)
              temp448b47 = -(72.d0*zv(2)*temp448b46)
              fun0b = fun0b + cost4i*(12.d0*(xv(3)*yv(1)*zv(1))+36.d0*(&
&                xv(1)*yv(3)*zv(1))-48.d0*(xv(1)*yv(1)*zv(3)))*zb(indorbp&
&                , indt+2) + cost4i*(18.d0*(xv(2)*yv(2)*zv(1))-15.d0*(xv(&
&                4)*zv(1))+9.d0*(yv(4)*zv(1))+24.d0*(xv(2)*zv(3))-24.d0*(&
&                yv(2)*zv(3)))*zb(indorbp, indt+1) + cost4i*(6.d0*(xv(3)*&
&                yv(2))-3.d0*xv(5)+9.d0*(xv(1)*yv(4))+24.d0*(xv(3)*zv(2))&
&                -72.d0*(xv(1)*yv(2)*zv(2)))*zb(indorbp, indt+3)
              xvb(3) = xvb(3) + (24.d0*zv(2)+6.d0*yv(2))*temp448b46
              yvb(2) = yvb(2) + xv(1)*temp448b47 + 6.d0*xv(3)*temp448b46
              xvb(5) = xvb(5) - 3.d0*temp448b46
              xvb(1) = xvb(1) + yv(2)*temp448b47 + 9.d0*yv(4)*temp448b46
              yvb(4) = yvb(4) + 9.d0*xv(1)*temp448b46
              zvb(2) = zvb(2) + (24.d0*xv(3)-72.d0*xv(1)*yv(2))*&
&                temp448b46
              temp448b48 = cost4i*fun0*zb(indorbp, indt+2)
              temp448b49 = 12.d0*zv(1)*temp448b48
              temp448b50 = 36.d0*zv(1)*temp448b48
              temp448b51 = -(48.d0*zv(3)*temp448b48)
              xvb(3) = xvb(3) + yv(1)*temp448b49
              yvb(1) = yvb(1) + xv(1)*temp448b51 + xv(3)*temp448b49
              zvb(1) = zvb(1) + (36.d0*xv(1)*yv(3)+12.d0*xv(3)*yv(1))*&
&                temp448b48
              xvb(1) = xvb(1) + yv(1)*temp448b51 + yv(3)*temp448b50
              yvb(3) = yvb(3) + xv(1)*temp448b50
              zvb(3) = zvb(3) - 48.d0*xv(1)*yv(1)*temp448b48
              temp448b52 = cost4i*fun0*zb(indorbp, indt+1)
              temp448b53 = 18.d0*zv(1)*temp448b52
              xvb(2) = xvb(2) + 24.d0*zv(3)*temp448b52 + yv(2)*&
&                temp448b53
              yvb(2) = yvb(2) + xv(2)*temp448b53 - 24.d0*zv(3)*&
&                temp448b52
              zvb(1) = zvb(1) + (9.d0*yv(4)-15.d0*xv(4)+18.d0*xv(2)*yv(2&
&                ))*temp448b52
              xvb(4) = xvb(4) - 15.d0*zv(1)*temp448b52
              yvb(4) = yvb(4) + 9.d0*zv(1)*temp448b52
              zvb(3) = zvb(3) + (24.d0*xv(2)-24.d0*yv(2))*temp448b52
            END IF
          ELSE
            temp448b54 = -(cost4i*fun0*zb(indorbp, indt+3))
            temp448b55 = -(72.d0*zv(2)*temp448b54)
            fun0b = fun0b - cost4i*(9.d0*(xv(4)*zv(1))+18.d0*(xv(2)*yv(2&
&              )*zv(1))-15.d0*(yv(4)*zv(1))+24.d0*(yv(2)*zv(3))-24.d0*(xv&
&              (2)*zv(3)))*zb(indorbp, indt+2) - cost4i*(36.d0*(xv(3)*yv(&
&              1)*zv(1))+12.d0*(xv(1)*yv(3)*zv(1))-48.d0*(xv(1)*yv(1)*zv(&
&              3)))*zb(indorbp, indt+1) - cost4i*(9.d0*(xv(4)*yv(1))+6.d0&
&              *(xv(2)*yv(3))-3.d0*yv(5)+24.d0*(yv(3)*zv(2))-72.d0*(xv(2)&
&              *yv(1)*zv(2)))*zb(indorbp, indt+3)
            xvb(4) = xvb(4) + 9.d0*yv(1)*temp448b54
            yvb(1) = yvb(1) + xv(2)*temp448b55 + 9.d0*xv(4)*temp448b54
            xvb(2) = xvb(2) + yv(1)*temp448b55 + 6.d0*yv(3)*temp448b54
            yvb(3) = yvb(3) + (24.d0*zv(2)+6.d0*xv(2))*temp448b54
            yvb(5) = yvb(5) - 3.d0*temp448b54
            zvb(2) = zvb(2) + (24.d0*yv(3)-72.d0*xv(2)*yv(1))*temp448b54
            temp448b56 = -(cost4i*fun0*zb(indorbp, indt+2))
            temp448b57 = 18.d0*zv(1)*temp448b56
            xvb(4) = xvb(4) + 9.d0*zv(1)*temp448b56
            zvb(1) = zvb(1) + (18.d0*xv(2)*yv(2)-15.d0*yv(4)+9.d0*xv(4))&
&              *temp448b56
            xvb(2) = xvb(2) + yv(2)*temp448b57 - 24.d0*zv(3)*temp448b56
            yvb(2) = yvb(2) + 24.d0*zv(3)*temp448b56 + xv(2)*temp448b57
            yvb(4) = yvb(4) - 15.d0*zv(1)*temp448b56
            zvb(3) = zvb(3) + (24.d0*yv(2)-24.d0*xv(2))*temp448b56
            temp448b58 = -(cost4i*fun0*zb(indorbp, indt+1))
            temp448b59 = 36.d0*zv(1)*temp448b58
            temp448b60 = 12.d0*zv(1)*temp448b58
            temp448b61 = -(48.d0*zv(3)*temp448b58)
            xvb(3) = xvb(3) + yv(1)*temp448b59
            yvb(1) = yvb(1) + xv(1)*temp448b61 + xv(3)*temp448b59
            zvb(1) = zvb(1) + (12.d0*xv(1)*yv(3)+36.d0*xv(3)*yv(1))*&
&              temp448b58
            xvb(1) = xvb(1) + yv(1)*temp448b61 + yv(3)*temp448b60
            yvb(3) = yvb(3) + xv(1)*temp448b60
            zvb(3) = zvb(3) - 48.d0*xv(1)*yv(1)*temp448b58
          END IF
        ELSE IF (branch .LT. 11) THEN
          IF (branch .LT. 9) THEN
            IF (branch .LT. 8) THEN
              temp448b62 = cost5i*fun0*zb(indorbp, indt+3)
              temp448b63 = -(120.d0*zv(1)*temp448b62)
              fun0b = fun0b + cost5i*(10.d0*(xv(4)*yv(1))+20.d0*(xv(2)*&
&                yv(3))-6.d0*yv(5)+40.d0*(yv(3)*zv(2))-120.d0*(xv(2)*yv(1&
&                )*zv(2)))*zb(indorbp, indt+2) + cost5i*(20.d0*(xv(3)*yv(&
&                2))-6.d0*xv(5)+10.d0*(xv(1)*yv(4))+40.d0*(xv(3)*zv(2))-&
&                120.d0*(xv(1)*yv(2)*zv(2)))*zb(indorbp, indt+1) + cost5i&
&                *(20.d0*(xv(4)*zv(1))-120.d0*(xv(2)*yv(2)*zv(1))+20.d0*(&
&                yv(4)*zv(1)))*zb(indorbp, indt+3)
              xvb(4) = xvb(4) + 20.d0*zv(1)*temp448b62
              zvb(1) = zvb(1) + (20.d0*yv(4)-120.d0*xv(2)*yv(2)+20.d0*xv&
&                (4))*temp448b62
              xvb(2) = xvb(2) + yv(2)*temp448b63
              yvb(2) = yvb(2) + xv(2)*temp448b63
              yvb(4) = yvb(4) + 20.d0*zv(1)*temp448b62
              temp448b64 = cost5i*fun0*zb(indorbp, indt+2)
              temp448b65 = -(120.d0*zv(2)*temp448b64)
              xvb(4) = xvb(4) + 10.d0*yv(1)*temp448b64
              yvb(1) = yvb(1) + xv(2)*temp448b65 + 10.d0*xv(4)*&
&                temp448b64
              xvb(2) = xvb(2) + yv(1)*temp448b65 + 20.d0*yv(3)*&
&                temp448b64
              yvb(3) = yvb(3) + (40.d0*zv(2)+20.d0*xv(2))*temp448b64
              yvb(5) = yvb(5) - 6.d0*temp448b64
              temp448b66 = cost5i*fun0*zb(indorbp, indt+1)
              zvb(2) = zvb(2) + (40.d0*xv(3)-120.d0*xv(1)*yv(2))*&
&                temp448b66 + (40.d0*yv(3)-120.d0*xv(2)*yv(1))*temp448b64
              temp448b67 = -(120.d0*zv(2)*temp448b66)
              xvb(3) = xvb(3) + (40.d0*zv(2)+20.d0*yv(2))*temp448b66
              yvb(2) = yvb(2) + xv(1)*temp448b67 + 20.d0*xv(3)*&
&                temp448b66
              xvb(5) = xvb(5) - 6.d0*temp448b66
              xvb(1) = xvb(1) + yv(2)*temp448b67 + 10.d0*yv(4)*&
&                temp448b66
              yvb(4) = yvb(4) + 10.d0*xv(1)*temp448b66
            ELSE
              temp448b68 = -(cost5i*fun0*zb(indorbp, indt+3))
              temp448b69 = 80.d0*zv(1)*temp448b68
              temp448b70 = -(80.d0*zv(1)*temp448b68)
              fun0b = fun0b - cost5i*(4.d0*xv(5)-20.d0*(xv(1)*yv(4))+&
&                120.d0*(xv(1)*yv(2)*zv(2))-40.d0*(xv(3)*zv(2)))*zb(&
&                indorbp, indt+2) - cost5i*(20.d0*(xv(4)*yv(1))-4.d0*yv(5&
&                )+40.d0*(yv(3)*zv(2))-120.d0*(xv(2)*yv(1)*zv(2)))*zb(&
&                indorbp, indt+1) - cost5i*(80.d0*(xv(1)*yv(3)*zv(1))-&
&                80.d0*(xv(3)*yv(1)*zv(1)))*zb(indorbp, indt+3)
              xvb(1) = xvb(1) + yv(3)*temp448b69
              yvb(3) = yvb(3) + xv(1)*temp448b69
              zvb(1) = zvb(1) + (80.d0*xv(1)*yv(3)-80.d0*xv(3)*yv(1))*&
&                temp448b68
              xvb(3) = xvb(3) + yv(1)*temp448b70
              yvb(1) = yvb(1) + xv(3)*temp448b70
              temp448b71 = -(cost5i*fun0*zb(indorbp, indt+2))
              temp448b72 = 120.d0*zv(2)*temp448b71
              xvb(5) = xvb(5) + 4.d0*temp448b71
              xvb(1) = xvb(1) + yv(2)*temp448b72 - 20.d0*yv(4)*&
&                temp448b71
              yvb(4) = yvb(4) - 20.d0*xv(1)*temp448b71
              yvb(2) = yvb(2) + xv(1)*temp448b72
              temp448b73 = -(cost5i*fun0*zb(indorbp, indt+1))
              zvb(2) = zvb(2) + (40.d0*yv(3)-120.d0*xv(2)*yv(1))*&
&                temp448b73 + (120.d0*xv(1)*yv(2)-40.d0*xv(3))*temp448b71
              xvb(3) = xvb(3) - 40.d0*zv(2)*temp448b71
              temp448b74 = -(120.d0*zv(2)*temp448b73)
              xvb(4) = xvb(4) + 20.d0*yv(1)*temp448b73
              yvb(1) = yvb(1) + xv(2)*temp448b74 + 20.d0*xv(4)*&
&                temp448b73
              yvb(5) = yvb(5) - 4.d0*temp448b73
              yvb(3) = yvb(3) + 40.d0*zv(2)*temp448b73
              xvb(2) = xvb(2) + yv(1)*temp448b74
            END IF
          ELSE IF (branch .LT. 10) THEN
            temp448b75 = cost6i*fun0*zb(indorbp, indt+3)
            fun0b = fun0b + cost6i*(20.d0*(xv(1)*yv(3)*zv(1))-20.d0*(xv(&
&              3)*yv(1)*zv(1)))*zb(indorbp, indt+2) + cost6i*(5.d0*(xv(4)&
&              *zv(1))-30.d0*(xv(2)*yv(2)*zv(1))+5.d0*(yv(4)*zv(1)))*zb(&
&              indorbp, indt+1) + cost6i*(xv(5)-10.d0*(xv(3)*yv(2))+5.d0*&
&              (xv(1)*yv(4)))*zb(indorbp, indt+3)
            xvb(5) = xvb(5) + temp448b75
            xvb(3) = xvb(3) - 10.d0*yv(2)*temp448b75
            yvb(2) = yvb(2) - 10.d0*xv(3)*temp448b75
            temp448b76 = cost6i*fun0*zb(indorbp, indt+2)
            temp448b77 = 20.d0*zv(1)*temp448b76
            xvb(1) = xvb(1) + yv(3)*temp448b77 + 5.d0*yv(4)*temp448b75
            yvb(4) = yvb(4) + 5.d0*xv(1)*temp448b75
            temp448b78 = -(20.d0*zv(1)*temp448b76)
            yvb(3) = yvb(3) + xv(1)*temp448b77
            temp448b79 = cost6i*fun0*zb(indorbp, indt+1)
            zvb(1) = zvb(1) + (5.d0*yv(4)-30.d0*xv(2)*yv(2)+5.d0*xv(4))*&
&              temp448b79 + (20.d0*xv(1)*yv(3)-20.d0*xv(3)*yv(1))*&
&              temp448b76
            xvb(3) = xvb(3) + yv(1)*temp448b78
            yvb(1) = yvb(1) + xv(3)*temp448b78
            temp448b80 = -(30.d0*zv(1)*temp448b79)
            xvb(4) = xvb(4) + 5.d0*zv(1)*temp448b79
            xvb(2) = xvb(2) + yv(2)*temp448b80
            yvb(2) = yvb(2) + xv(2)*temp448b80
            yvb(4) = yvb(4) + 5.d0*zv(1)*temp448b79
          ELSE
            temp448b81 = -(cost6i*fun0*zb(indorbp, indt+3))
            fun0b = fun0b - cost6i*(30.d0*(xv(2)*yv(2)*zv(1))-5.d0*(xv(4&
&              )*zv(1))-5.d0*(yv(4)*zv(1)))*zb(indorbp, indt+2) - cost6i*&
&              (20.d0*(xv(1)*yv(3)*zv(1))-20.d0*(xv(3)*yv(1)*zv(1)))*zb(&
&              indorbp, indt+1) - cost6i*(10.d0*(xv(2)*yv(3))-5.d0*(xv(4)&
&              *yv(1))-yv(5))*zb(indorbp, indt+3)
            xvb(2) = xvb(2) + 10.d0*yv(3)*temp448b81
            yvb(3) = yvb(3) + 10.d0*xv(2)*temp448b81
            xvb(4) = xvb(4) - 5.d0*yv(1)*temp448b81
            yvb(1) = yvb(1) - 5.d0*xv(4)*temp448b81
            yvb(5) = yvb(5) - temp448b81
            temp448b82 = -(cost6i*fun0*zb(indorbp, indt+2))
            temp448b83 = 30.d0*zv(1)*temp448b82
            xvb(2) = xvb(2) + yv(2)*temp448b83
            yvb(2) = yvb(2) + xv(2)*temp448b83
            temp448b84 = -(cost6i*fun0*zb(indorbp, indt+1))
            zvb(1) = zvb(1) + (20.d0*xv(1)*yv(3)-20.d0*xv(3)*yv(1))*&
&              temp448b84 + (30.d0*xv(2)*yv(2)-5.d0*xv(4)-5.d0*yv(4))*&
&              temp448b82
            xvb(4) = xvb(4) - 5.d0*zv(1)*temp448b82
            yvb(4) = yvb(4) - 5.d0*zv(1)*temp448b82
            temp448b85 = 20.d0*zv(1)*temp448b84
            temp448b86 = -(20.d0*zv(1)*temp448b84)
            xvb(1) = xvb(1) + yv(3)*temp448b85
            yvb(3) = yvb(3) + xv(1)*temp448b85
            xvb(3) = xvb(3) + yv(1)*temp448b86
            yvb(1) = yvb(1) + xv(3)*temp448b86
          END IF
        ELSE IF (branch .LT. 13) THEN
          IF (branch .LT. 12) THEN
            temp448b87 = cost7i*fun0*zb(indorbp, indt+2)
            fun0b = fun0b + cost7i*(6.d0*xv(5)-60.d0*(xv(3)*yv(2))+30.d0&
&              *(xv(1)*yv(4)))*zb(indorbp, indt+1) + cost7i*(60.d0*(xv(2)&
&              *yv(3))-30.d0*(xv(4)*yv(1))-6.d0*yv(5))*zb(indorbp, indt+2&
&              )
            xvb(2) = xvb(2) + 60.d0*yv(3)*temp448b87
            yvb(3) = yvb(3) + 60.d0*xv(2)*temp448b87
            xvb(4) = xvb(4) - 30.d0*yv(1)*temp448b87
            yvb(1) = yvb(1) - 30.d0*xv(4)*temp448b87
            yvb(5) = yvb(5) - 6.d0*temp448b87
            temp448b88 = cost7i*fun0*zb(indorbp, indt+1)
            xvb(5) = xvb(5) + 6.d0*temp448b88
            xvb(3) = xvb(3) - 60.d0*yv(2)*temp448b88
            yvb(2) = yvb(2) - 60.d0*xv(3)*temp448b88
            xvb(1) = xvb(1) + 30.d0*yv(4)*temp448b88
            yvb(4) = yvb(4) + 30.d0*xv(1)*temp448b88
          END IF
        ELSE
          temp448b89 = -(cost7i*fun0*zb(indorbp, indt+2))
          fun0b = fun0b - cost7i*(60.d0*(xv(2)*yv(3))-30.d0*(xv(4)*yv(1)&
&            )-6.d0*yv(5))*zb(indorbp, indt+1) - cost7i*(60.d0*(xv(3)*yv(&
&            2))-6.d0*xv(5)-30.d0*(xv(1)*yv(4)))*zb(indorbp, indt+2)
          xvb(3) = xvb(3) + 60.d0*yv(2)*temp448b89
          yvb(2) = yvb(2) + 60.d0*xv(3)*temp448b89
          xvb(5) = xvb(5) - 6.d0*temp448b89
          xvb(1) = xvb(1) - 30.d0*yv(4)*temp448b89
          yvb(4) = yvb(4) - 30.d0*xv(1)*temp448b89
          temp448b90 = -(cost7i*fun0*zb(indorbp, indt+1))
          xvb(2) = xvb(2) + 60.d0*yv(3)*temp448b90
          yvb(3) = yvb(3) + 60.d0*xv(2)*temp448b90
          xvb(4) = xvb(4) - 30.d0*yv(1)*temp448b90
          yvb(1) = yvb(1) - 30.d0*xv(4)*temp448b90
          yvb(5) = yvb(5) - 6.d0*temp448b90
        END IF
        DO i=3,1,-1
          temp448b12 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp448b12
          funb0 = funb0 + rmu(i, 0)*temp448b12
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      DO k=6,1,-1
        CALL POPREAL8(adr8ibuf,adr8buf,xv(k))
        IF (.NOT.(rmu(1, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(1, 0) = rmub(1, 0) + k*rmu(1, 0)**(k-1)*xvb(k)
        xvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,yv(k))
        IF (.NOT.(rmu(2, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(2, 0) = rmub(2, 0) + k*rmu(2, 0)**(k-1)*yvb(k)
        yvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,zv(k))
        IF (.NOT.(rmu(3, 0) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(3, 0) = rmub(3, 0) + k*rmu(3, 0)**(k-1)*zvb(k)
        zvb(k) = 0.0_8
      END DO
      temp448b11 = -(fun*2.d0*fun2b)
      funb0 = funb0 + (1.d0-2.d0*(dd1*r(0)**2))*fun2b
      dd1b = r(0)**2*temp448b11 - 2.d0*distp(0, 1)*funb0
      rb(0) = rb(0) + dd1*2*r(0)*temp448b11
      distpb(0, 1) = distpb(0, 1) + fun0b - 2.d0*dd1*funb0
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
      zvb = 0.0_8
      xvb = 0.0_8
      yvb = 0.0_8
    END IF
    DO ic=13,1,-1
      DO k=indtm,i0,-1
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*zb(indorbp, k)
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*zb(indorbp, k)
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      temp448b = -(cost7i*distpb(i, 14))
      xvb(3) = xvb(3) + 20.d0*yv(3)*temp448b
      yvb(3) = yvb(3) + 20.d0*xv(3)*temp448b
      xvb(5) = xvb(5) - 6.d0*yv(1)*temp448b
      yvb(1) = yvb(1) - 6.d0*xv(5)*temp448b
      yvb(5) = yvb(5) - 6.d0*xv(1)*temp448b
      xvb(1) = xvb(1) - 6.d0*yv(5)*temp448b
      distpb(i, 14) = 0.0_8
      temp448b0 = cost7i*distpb(i, 13)
      xvb(6) = xvb(6) + temp448b0
      xvb(4) = xvb(4) - 15.d0*yv(2)*temp448b0
      yvb(2) = yvb(2) - 15.d0*xv(4)*temp448b0
      distpb(i, 13) = 0.0_8
      temp448b1 = -(cost6i*zv(1)*distpb(i, 12))
      xvb(2) = xvb(2) + 10.d0*yv(3)*temp448b1 + 15.d0*yv(4)*temp448b0
      yvb(4) = yvb(4) + 15.d0*xv(2)*temp448b0
      yvb(6) = yvb(6) - temp448b0
      yvb(3) = yvb(3) + 10.d0*xv(2)*temp448b1
      xvb(4) = xvb(4) - 5.d0*yv(1)*temp448b1
      yvb(1) = yvb(1) - 5.d0*xv(4)*temp448b1
      yvb(5) = yvb(5) - temp448b1
      zvb(1) = zvb(1) - cost6i*(10.d0*(xv(2)*yv(3))-5.d0*(xv(4)*yv(1))-&
&        yv(5))*distpb(i, 12)
      distpb(i, 12) = 0.0_8
      temp448b2 = cost6i*zv(1)*distpb(i, 11)
      xvb(5) = xvb(5) + temp448b2
      xvb(3) = xvb(3) - 10.d0*yv(2)*temp448b2
      yvb(2) = yvb(2) - 10.d0*xv(3)*temp448b2
      xvb(1) = xvb(1) + 5.d0*yv(4)*temp448b2
      yvb(4) = yvb(4) + 5.d0*xv(1)*temp448b2
      zvb(1) = zvb(1) + cost6i*(xv(5)-10.d0*(xv(3)*yv(2))+5.d0*(xv(1)*yv&
&        (4)))*distpb(i, 11)
      distpb(i, 11) = 0.0_8
      temp448b3 = cost5i*4.d0*distpb(i, 10)
      temp448b4 = cost*temp448b3
      xvb(3) = xvb(3) + yv(1)*temp448b4
      yvb(1) = yvb(1) + xv(3)*temp448b4
      yvb(3) = yvb(3) - xv(1)*temp448b4
      xvb(1) = xvb(1) - yv(3)*temp448b4
      distpb(i, 10) = 0.0_8
      costb = cost5i*(xv(4)-6.d0*(xv(2)*yv(2))+yv(4))*distpb(i, 9) + (xv&
&        (3)*yv(1)-yv(3)*xv(1))*temp448b3
      temp448b5 = cost5i*cost*distpb(i, 9)
      xvb(4) = xvb(4) + temp448b5
      distpb(i, 9) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp448b6 = -(cost4i*cost*distpb(i, 8))
      xvb(2) = xvb(2) - 3.d0*yv(1)*temp448b6 - 6.d0*yv(2)*temp448b5
      yvb(2) = yvb(2) - 6.d0*xv(2)*temp448b5
      yvb(4) = yvb(4) + temp448b5
      zvb(2) = zvb(2) + 11.d0*costb
      r2b = -costb
      yvb(3) = yvb(3) + temp448b6
      yvb(1) = yvb(1) - 3.d0*xv(2)*temp448b6
      costb = -(cost4i*(yv(3)-3.d0*(yv(1)*xv(2)))*distpb(i, 8))
      distpb(i, 8) = 0.0_8
      temp448b7 = cost4i*cost*distpb(i, 7)
      xvb(3) = xvb(3) + temp448b7
      costb = costb + cost4i*(xv(3)-3.d0*(xv(1)*yv(2)))*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp448b8 = cost3i*2.d0*distpb(i, 6)
      xvb(1) = xvb(1) + yv(1)*cost*temp448b8 - 3.d0*yv(2)*temp448b7
      yvb(2) = yvb(2) - 3.d0*xv(1)*temp448b7
      zvb(3) = zvb(3) + 11.d0*costb
      zvb(1) = zvb(1) - 3.d0*r2*costb
      r2b = r2b - 3.d0*zv(1)*costb
      distpb(i, 6) = 0.0_8
      temp448b9 = cost3i*distpb(i, 5)
      costb = (xv(2)-yv(2))*temp448b9 + yv(1)*xv(1)*temp448b8
      yvb(1) = yvb(1) + xv(1)*cost*temp448b8
      xvb(2) = xvb(2) + cost*temp448b9
      yvb(2) = yvb(2) - cost*temp448b9
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      zvb(4) = zvb(4) + 33.d0*costb
      zvb(2) = zvb(2) - 18.d0*r2*costb
      r2b = r2b - 18.d0*zv(2)*costb
      r4b = costb
      rmub(2, i) = rmub(2, i) + cost2i*cost*distpb(i, 4)
      costb = cost2i*rmu(2, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2i*cost*distpb(i, 3)
      costb = costb + cost2i*rmu(1, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      zvb(5) = zvb(5) + 33.d0*costb
      zvb(3) = zvb(3) - 30.d0*r2*costb
      temp448b10 = cost1i*distpb(i, 2)
      r6b = -(5.d0*temp448b10)
      r4b = r4b + 105.d0*zv(2)*temp448b10 + r2*r6b + 5.d0*zv(1)*costb
      r2b = r2b + 2*r2*r4b - 315.d0*zv(4)*temp448b10 + r4*r6b - 30.d0*zv&
&        (3)*costb
      zvb(1) = zvb(1) + 5.d0*r4*costb
      zvb(6) = zvb(6) + 231.d0*temp448b10
      zvb(4) = zvb(4) - 315.d0*r2*temp448b10
      zvb(2) = zvb(2) + r2b + 105.d0*r4*temp448b10
      distpb(i, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,r4)
      CALL POPREAL8(adr8ibuf,adr8buf,r2)
      xvb(2) = xvb(2) + r2b
      yvb(2) = yvb(2) + r2b
      DO k=6,1,-1
        CALL POPREAL8(adr8ibuf,adr8buf,xv(k))
        IF (.NOT.(rmu(1, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(1, i) = rmub(1, i) + k*rmu(1, i)**(k-1)*xvb(k)
        xvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,yv(k))
        IF (.NOT.(rmu(2, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(2, i) = rmub(2, i) + k*rmu(2, i)**(k-1)*yvb(k)
        yvb(k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,zv(k))
        IF (.NOT.(rmu(3, i) .LE. 0.0 .AND. (k .EQ. 0.0 .OR. k .NE. INT(k&
&            )))) rmub(3, i) = rmub(3, i) + k*rmu(3, i)**(k-1)*zvb(k)
        zvb(k) = 0.0_8
      END DO
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp447 = r(k)**2
      temp447b0 = c*DEXP(-(dd1*temp447))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp447))*distpb(k, 1)
      dd1b = dd1b - temp447*temp447b0
      rb(k) = rb(k) - dd1*2*r(k)*temp447b0
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 0.43985656185609913955d0*3.75d0*dd1**2.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (65) 
! 2s gaussian for pseudo
! d orbitals
! R(r)= c0 r^3  exp(-alpha r^2)+ c1 r exp(-alpha r^2)
! each gaussian term is normalized
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization to be done
!        c=8.d0/dsqrt(21.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(9.d0/4.d0)
    c = dd1**2.25d0*1.24420067280413253d0
!        endif
    c0 = -c
    c1 = 2.25d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
! lz=0
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      rp1 = 2.d0*dd1*r(0)
      rp2 = rp1*r(0)
      fun0 = distp(0, 1)*(c1*r(0)+c0*r(0)**3)
      fun = (c1*(1.d0-rp2)+c0*r(0)**2*(3.d0-rp2))*distp(0, 1)/r(0)
      fun2 = distp(0, 1)*(c1*rp1*(rp2-3.d0)+c0*r(0)*(3.d0-3.5d0*rp2+&
&        0.5d0*rp2**2))
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp455b4 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 6.d0*temp455b4
        fun2b = fun2b + temp455b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp455b0 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp455b0
                  fun0b = fun0b + rmu(i, 0)*temp455b0
                ELSE
                  temp455b1 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp455b1
                  fun0b = fun0b + rmu(i, 0)*temp455b1
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp455b2 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp455b2
                fun0b = fun0b + rmu(i, 0)*temp455b2
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp455b3 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp455b3
                fun0b = fun0b + rmu(i, 0)*temp455b3
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp455b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp455b
          funb0 = funb0 + rmu(i, 0)*temp455b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp454 = 0.5d0*rp2**2 - 3.5d0*rp2 + 3.d0
      temp453 = c0*r(0)
      temp453b = distp(0, 1)*fun2b
      temp452b = (c1*(1.d0-rp2)+r(0)**2*(c0*(3.d0-rp2)))*funb0/r(0)
      temp451 = r(0)**3
      distpb(0, 1) = distpb(0, 1) + temp452b + (c1*r(0)+c0*temp451)*&
&        fun0b + (c1*rp1*(rp2-3.d0)+temp453*temp454)*fun2b
      temp452 = distp(0, 1)/r(0)
      temp453b0 = temp452*funb0
      temp451b = distp(0, 1)*fun0b
      c1b = (1.d0-rp2)*temp453b0 + r(0)*temp451b + (rp2-3.d0)*rp1*&
&        temp453b
      temp453b1 = r(0)**2*temp453b0
      rp2b = (temp453*0.5d0*2*rp2-temp453*3.5d0+c1*rp1)*temp453b - c0*&
&        temp453b1 - c1*temp453b0
      rp1b = r(0)*rp2b + (rp2-3.d0)*c1*temp453b
      c0b = (3.d0-rp2)*temp453b1 + temp451*temp451b + temp454*r(0)*&
&        temp453b
      rb(0) = rb(0) + c0*(3.d0-rp2)*2*r(0)*temp453b0 - temp452*temp452b &
&        + rp1*rp2b + 2.d0*dd1*rp1b + (c0*3*r(0)**2+c1)*temp451b + &
&        temp454*c0*temp453b
      dd1b = 2.d0*r(0)*rp1b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        temp450 = r(k)**3
        temp449 = c0*distp(k, 1+ic)
        temp449b = distp(k, 1)*zb(indorbp, k)
        distpb(k, 1) = distpb(k, 1) + (temp449*temp450+c1*r(k))*zb(&
&          indorbp, k)
        c0b = c0b + temp450*distp(k, 1+ic)*temp449b
        distpb(k, 1+ic) = distpb(k, 1+ic) + temp450*c0*temp449b
        rb(k) = rb(k) + (c1+temp449*3*r(k)**2)*temp449b
        c1b = c1b + r(k)*temp449b
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    dd1b = 0.0_8
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp448 = r(k)**2
      temp448b93 = c*DEXP(-(dd1*temp448))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp448))*distpb(k, 1)
      dd1b = dd1b - temp448*temp448b93
      rb(k) = rb(k) - dd1*2*r(k)*temp448b93
      distpb(k, 1) = 0.0_8
    END DO
    temp448b92 = 2.25d0*c1b/dd1
    cb = cb + temp448b92 - c0b
    dd1b = dd1b + 1.24420067280413253d0*2.25d0*dd1**1.25D0*cb - c*&
&      temp448b92/dd1
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (82) 
! ******************* END GAUSSIAN BASIS ************************
! ** ** ** ** ** ** **  JASTROW ORBITALS ** ** ** ** ** ** ** ** *
    dd1 = dd(indpar+1)
    dd2 = DSQRT(dd1)
!        if(iflagnorm.gt.2) then
!        ratiocp--> ratiocp*dsqrt(2.d0)*pi**(-0.75d0)*2**1.25
!        c=dsqrt(2.d0)*pi**(-0.75d0)*(2.d0*dd1)**1.25d0*ratiocp
    c = dd1**1.25d0*ratiocp
!        endif
    DO k=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,cost)
      cost = dd1*r(k)**2/(1.d0+dd2*r(k))
      distp(k, 1) = c*DEXP(-cost)
    END DO
! indorbp=indorb
!
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
      indorbp = indorb + ic
    END DO
    IF (typec .NE. 1) THEN
! fun=-2.d0*dd1*distp(0,1)
! fun2=fun*(1.d0-2.d0*dd1*r(0)**2)
      rp1 = dd1*r(0)**2
      rp2 = dd2*r(0)
      rp3 = (1.d0+rp2)**2
      fun = -(dd1*distp(0, 1)*(2.d0+rp2)/rp3)
! the second derivative
      fun2 = dd1*distp(0, 1)*(-2.d0-2.d0*rp2+4.d0*rp1+4.d0*rp1*rp2+rp1**&
&        2)/rp3**2
! indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
! if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp459b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp459b0
        fun2b = fun2b + temp459b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp459b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp459b
          funb0 = funb0 + rmu(ic, 0)*temp459b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp458 = rp3**2
      temp457b = (4.d0*rp1-2.d0*rp2+4.d0*(rp1*rp2)+rp1**2-2.d0)*fun2b/&
&        temp458
      temp457 = dd1*distp(0, 1)/temp458
      temp457b0 = temp457*fun2b
      rp1b = (2*rp1+4.d0*rp2+4.d0)*temp457b0
      temp456b0 = -(distp(0, 1)*(rp2+2.d0)*funb0/rp3)
      dd1b = temp456b0 + r(0)**2*rp1b + distp(0, 1)*temp457b
      temp456 = dd1/rp3
      distpb(0, 1) = fun0b - temp456*(rp2+2.d0)*funb0 + dd1*temp457b
      rp3b = -(temp456*temp456b0) - temp457*2*rp3*temp457b
      rp2b = 2*(rp2+1.d0)*rp3b - temp456*distp(0, 1)*funb0 + (4.d0*rp1-&
&        2.d0)*temp457b0
      dd2b = r(0)*rp2b
      rb(0) = rb(0) + dd1*2*r(0)*rp1b + dd2*rp2b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      cb = cb + DEXP(-cost)*distpb(k, 1)
      costb = -(c*DEXP(-cost)*distpb(k, 1))
      distpb(k, 1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,cost)
      temp455 = dd2*r(k) + 1.d0
      temp456b = costb/temp455
      temp455b5 = -(dd1*r(k)**2*temp456b/temp455)
      dd1b = dd1b + r(k)**2*temp456b
      rb(k) = rb(k) + dd2*temp455b5 + dd1*2*r(k)*temp456b
      dd2b = dd2b + r(k)*temp455b5
    END DO
    IF (dd1 .EQ. 0.0) THEN
      dd1b = dd1b + ratiocp*1.25d0*dd1**0.25D0*cb
    ELSE
      dd1b = dd1b + dd2b/(2.D0*DSQRT(dd1)) + ratiocp*1.25d0*dd1**0.25D0*&
&        cb
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (111) 
!     2p single   r_mu/(1+b r^3)   parent of 103
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)**3)
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2*distp(0, 1)**2*3.d0*r(0))
      fun2 = fun*distp(0, 1)*(2.d0-4.d0*dd2*r(0)**3)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp461b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp461b0
        fun2b = fun2b + temp461b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp461b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp461b
          funb0 = funb0 + rmu(ic, 0)*temp461b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp460 = r(0)**3
      temp460b = (2.d0-4.d0*(dd2*temp460))*fun2b
      temp460b0 = -(fun*distp(0, 1)*4.d0*fun2b)
      funb0 = funb0 + distp(0, 1)*temp460b
      distpb(0, 1) = fun0b - 3.d0*dd2*r(0)*2*distp(0, 1)*funb0 + fun*&
&        temp460b
      temp460b1 = -(3.d0*distp(0, 1)**2*funb0)
      dd2b = r(0)*temp460b1 + temp460*temp460b0
      rb(0) = rb(0) + dd2*temp460b1 + dd2*3*r(0)**2*temp460b0
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp459 = r(k)**3
      temp459b1 = -(distpb(k, 1)/(dd2*temp459+1.d0)**2)
      dd2b = dd2b + temp459*temp459b1
      rb(k) = rb(k) + dd2*3*r(k)**2*temp459b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (62) 
    dd1 = dd(indpar+1)
!        if(iflagnorm.gt.2) then
!        c=2.d0/pi**0.75d0*(2.d0*dd1)**1.75d0/dsqrt(5.d0)
    c = dd1**1.75d0*1.2749263037197753d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
!        indorbp=indorb
!
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 1)*r(0)
      cost = 2.d0*dd1*r(0)**2
      fun = distp(0, 1)*(1.d0-cost)/r(0)
      fun2 = 2.d0*dd1*fun0*(cost-3.d0)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp463b1 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp463b1
        fun2b = fun2b + temp463b1
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp463b0 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp463b0
          funb0 = funb0 + rmu(ic, 0)*temp463b0
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp463b = 2.d0*(cost-3.d0)*fun2b
      temp462b0 = distp(0, 1)*funb0/r(0)
      costb = 2.d0*dd1*fun0*fun2b - temp462b0
      dd1b = 2.d0*r(0)**2*costb + fun0*temp463b
      fun0b = fun0b + dd1*temp463b
      distpb = 0.0_8
      temp462 = (-cost+1.d0)/r(0)
      distpb(0, 1) = r(0)*fun0b + temp462*funb0
      rb(0) = rb(0) + 2.d0*dd1*2*r(0)*costb + distp(0, 1)*fun0b - &
&        temp462*temp462b0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp462b = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*r(i)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + r(i)*temp462b
        rb(i) = rb(i) + distp(i, 1)*temp462b
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp461 = r(k)**2
      temp461b1 = c*DEXP(-(dd1*temp461))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp461))*distpb(k, 1)
      dd1b = dd1b - temp461*temp461b1
      rb(k) = rb(k) - dd1*2*r(k)*temp461b1
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.2749263037197753d0*1.75d0*dd1**0.75D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (42) 
! derivative of 62 with respect zeta
!     4d without cusp and one parmater derivative of 30
    dd1 = dd(indpar+1)
!         if(iflagnorm.gt.2) then
!     c=                                                           &
!                                                              &1.d0/(2.d0**3*3.d0)*dsqrt(1.d0/pi)*(2.d0*dd1)**(7.d0/2.d0)
    c = dd1**3.5d0*0.26596152026762178d0
!     c=
!                                                                  &1.d0/(2.d0**3*3.d0)/dsqrt(56.d0*pi)*(2.d0*dd1)**(9.d0/2.d0)
!         endif
    c0 = -c
    c1 = 3.5d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 3))
      distp(i, 3) = distp(i, 1)*(c0*r(i)+c1)
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 4))
! lz=0
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 5))
! lz=+/
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 6))
! lz=+/-2
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 7))
! lz=+/-1
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(i, 8))
! lz=+/-1
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!            endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(dd1*distp(0, 3)) + c0*distp(0, 1)
      fun2 = dd1**2*distp(0, 3) - 2.d0*dd1*c0*distp(0, 1)
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp464 = fun/r(0)
        temp465b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp464b3 = 6.d0*temp465b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp464+fun2)*zb(&
&          indorbp, indt+4)
        funb0 = funb0 + temp464b3
        rb(0) = rb(0) - temp464*temp464b3
        fun2b = fun2b + temp465b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp464b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp464b
                  fun0b = fun0b + rmu(i, 0)*temp464b
                ELSE
                  temp464b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp464b0
                  fun0b = fun0b + rmu(i, 0)*temp464b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp464b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp464b1
                fun0b = fun0b + rmu(i, 0)*temp464b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp464b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp464b2
                fun0b = fun0b + rmu(i, 0)*temp464b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp463 = fun/r(0)
          temp463b6 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp463*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp463*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb0 = funb0 + temp463b6
          rb(0) = rb(0) - temp463*temp463b6
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp463b5 = -(2.d0*distp(0, 1)*fun2b)
      dd1b = c0*temp463b5 - distp(0, 3)*funb0 + distp(0, 3)*2*dd1*fun2b
      distpb(0, 3) = distpb(0, 3) + dd1**2*fun2b
      c0b = distp(0, 1)*funb0 + dd1*temp463b5
      distpb(0, 1) = distpb(0, 1) + c0*funb0 - 2.d0*dd1*c0*fun2b
      distpb(0, 3) = distpb(0, 3) + fun0b - dd1*funb0
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    c1b = 0.0_8
    DO i=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 8))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 7))
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 6))
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 5))
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 4))
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(i, 3))
      temp463b4 = distp(i, 1)*distpb(i, 3)
      distpb(i, 1) = distpb(i, 1) + (c0*r(i)+c1)*distpb(i, 3)
      c0b = c0b + r(i)*temp463b4
      rb(i) = rb(i) + c0*temp463b4
      c1b = c1b + temp463b4
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp463b3 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp463b3
      rb(k) = rb(k) - dd1*temp463b3
      distpb(k, 1) = 0.0_8
    END DO
    temp463b2 = 3.5d0*c1b/dd1
    cb = temp463b2 - c0b
    dd1b = dd1b + 0.26596152026762178d0*3.5d0*dd1**2.5D0*cb - c*&
&      temp463b2/dd1
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (4) 
! normalized
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
!           if(iflagnorm.gt.2) then
    c = dd1**2.5d0/DSQRT(3.d0*pi*(1.d0+dd2**2/3.d0))
!           endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      fun = distp(0, 1)*(1.d0-dd1*r(0))
      funp = -(dd2*dd1*distp(0, 1)*rmu(3, 0))
      temp468b = zb(indorbp, indt+4)/r(0)
      funb0 = 2.d0*temp468b
      funpb = 4.d0*temp468b
      rb(0) = rb(0) - (2.d0*fun+4.d0*funp)*temp468b/r(0)
      fun2b = zb(indorbp, indt+4)
      fun2pb = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      distpb = 0.0_8
      dd2b = distp(0, 1)*zb(indorbp, indt+3)
      distpb(0, 1) = dd2*zb(indorbp, indt+3)
      DO i=3,1,-1
        temp467b6 = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        temp467 = (fun+funp)/r(0)
        funb0 = funb0 + temp467b6
        funpb = funpb + temp467b6
        rb(0) = rb(0) - temp467*temp467b6
        rmub(i, 0) = rmub(i, 0) + temp467*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp467b1 = dd2*distp(0, 1)*fun2pb
      temp467b2 = dd1**2*rmu(3, 0)*fun2pb
      temp467b3 = distp(0, 1)*fun2b
      temp467b4 = -(distp(0, 1)*rmu(3, 0)*funpb)
      dd1b = (r(0)*2*dd1-2.d0)*temp467b3 - distp(0, 1)*r(0)*funb0 + dd2*&
&        temp467b4 + rmu(3, 0)*2*dd1*temp467b1
      temp467b5 = -(dd2*dd1*funpb)
      rmub(3, 0) = rmub(3, 0) + distp(0, 1)*temp467b5 + dd1**2*temp467b1
      dd2b = dd2b + dd1*temp467b4 + distp(0, 1)*temp467b2
      distpb(0, 1) = distpb(0, 1) + (dd1**2*r(0)-2.d0*dd1)*fun2b + (1.d0&
&        -dd1*r(0))*funb0 + rmu(3, 0)*temp467b5 + dd2*temp467b2
      rb(0) = rb(0) + dd1**2*temp467b3 - distp(0, 1)*dd1*funb0
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp467b0 = distp(i, 1)*zb(indorbp, i)
      rb(i) = rb(i) + temp467b0
      dd2b = dd2b + rmu(3, i)*temp467b0
      rmub(3, i) = rmub(3, i) + dd2*temp467b0
      distpb(i, 1) = distpb(i, 1) + (r(i)+dd2*rmu(3, i))*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp467b = c*DEXP(-(dd1*r(k)))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp467b
      rb(k) = rb(k) - dd1*temp467b
      distpb(k, 1) = 0.0_8
    END DO
    temp466 = 3.d0*pi*(dd2**2/3.d0+1.d0)
    temp465 = DSQRT(temp466)
    dd1b = dd1b + 2.5d0*dd1**1.5D0*cb/temp465
    IF (.NOT.temp466 .EQ. 0.0) dd2b = dd2b - dd1**2.5d0*pi*2*dd2*cb/(&
&        temp465**2*2.D0*DSQRT(temp466))
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (137) 
! 2s single Z NO CUSP
!     2s with cusp condition
!     dd1*(exp(-dd2*r)*(1+dd2*r))
    dd2 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!           c=1.d0/dsqrt(1/4.d0/dd2**3+12*dd2/(2.d0*dd2)**4+
!                                                                    &3*dd2**2/4/dd2**5)/dsqrt(4.0*pi)
!           endif
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2**2*distp(0, 1))
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      funb0 = funb0 + (1.d0-dd2*r(0))*fun2b
      dd2b = -(distp(0, 1)*2*dd2*funb0) - fun*r(0)*fun2b
      rb(0) = rb(0) - fun*dd2*fun2b
      distpb = 0.0_8
      distpb(0, 1) = -(dd2**2*funb0)
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp468b1 = distp(i, 1)*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + (dd2*r(i)+1.d0)*zb(indorbp, i)
      dd2b = dd2b + r(i)*temp468b1
      rb(i) = rb(i) + dd2*temp468b1
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp468b0 = DEXP(-(dd2*r(k)))*distpb(k, 1)
      dd2b = dd2b - r(k)*temp468b0
      rb(k) = rb(k) - dd2*temp468b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (8) 
! s orbital
! 
! - angmom = 0
! - type = Gaussian
! - normalized = yes
! - angtype = spherical
! - npar = 2
! - multiplicity = 1
!
! = exp(-dd1*r) + (dd1-zeta) * r * exp(-dd2*r)
!
! 2s double Z WITH CUSP
!
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd1 - zeta(1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
      distp(k, 2) = DEXP(-(dd2*r(k)))
    END DO
    c = 1.d0/DSQRT(1.d0/4.d0/dd1**3+12.d0*peff/(dd1+dd2)**4+3*peff**2/4/&
&      dd2**5)/DSQRT(4.0*pi)
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1)) + peff*distp(0, 2)*(1.d0-dd2*r(0))
      fun2 = distp(0, 1)*dd1**2 + peff*distp(0, 2)*(dd2**2*r(0)-2.d0*dd2&
&        )
      temp476 = fun/r(0)
      temp476b = c*2.d0*zb(indorbp, indt+4)/r(0)
      cb = (2.d0*temp476+fun2)*zb(indorbp, indt+4)
      funb0 = temp476b
      rb(0) = rb(0) - temp476*temp476b
      fun2b = c*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        temp475 = rmu(i, 0)/r(0)
        temp475b5 = fun*c*zb(indorbp, indt+i)/r(0)
        funb0 = funb0 + temp475*c*zb(indorbp, indt+i)
        cb = cb + temp475*fun*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + temp475b5
        rb(0) = rb(0) - temp475*temp475b5
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp475b1 = (dd2**2*r(0)-2.d0*dd2)*fun2b
      temp475b2 = peff*distp(0, 2)*fun2b
      distpb(0, 1) = dd1**2*fun2b
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb0
      temp475b3 = (1.d0-dd2*r(0))*funb0
      peffb = distp(0, 2)*temp475b3 + distp(0, 2)*temp475b1
      distpb(0, 2) = peff*temp475b3 + peff*temp475b1
      temp475b4 = peff*distp(0, 2)*funb0
      dd2b = (r(0)*2*dd2-2.d0)*temp475b2 - r(0)*temp475b4
      rb(0) = rb(0) + dd2**2*temp475b2 - dd2*temp475b4
      distpb(0, 1) = distpb(0, 1) - dd1*funb0
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
      cb = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp475b = c*zb(indorbp, i)
      temp475b0 = distp(i, 2)*temp475b
      cb = cb + (distp(i, 1)+r(i)*peff*distp(i, 2))*zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + temp475b
      rb(i) = rb(i) + peff*temp475b0
      peffb = peffb + r(i)*temp475b0
      distpb(i, 2) = distpb(i, 2) + r(i)*peff*temp475b
      zb(indorbp, i) = 0.0_8
    END DO
    temp474 = 4*dd2**5
    temp468 = peff**2/temp474
    temp473 = (dd1+dd2)**4
    temp472 = 4.d0*dd1**3
    temp469 = 1.0/temp472 + 12.d0*peff/temp473 + 3*temp468
    temp471 = DSQRT(temp469)
    temp470 = DSQRT(4.0*pi)
    IF (temp469 .EQ. 0.0) THEN
      temp469b = 0.0
    ELSE
      temp469b = -(cb/(temp470*temp471**2*2.D0*DSQRT(temp469)))
    END IF
    temp469b0 = 12.d0*temp469b/temp473
    temp469b1 = -(peff*4*(dd1+dd2)**3*temp469b0/temp473)
    temp468b4 = 3*temp469b/temp474
    dd1b = dd1b + temp469b1 - 4.d0*3*dd1**2*temp469b/temp472**2
    peffb = peffb + 2*peff*temp468b4 + temp469b0
    dd2b = dd2b + temp469b1 - temp468*4*5*dd2**4*temp468b4
    DO k=indtm,indtmin,-1
      temp468b2 = DEXP(-(dd2*r(k)))*distpb(k, 2)
      dd2b = dd2b - r(k)*temp468b2
      distpb(k, 2) = 0.0_8
      temp468b3 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) - dd1*temp468b3 - dd2*temp468b2
      dd1b = dd1b - r(k)*temp468b3
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (109) 
!     2p  double  Lorentian
!       dd1 * x_mu  (L(dd2 r^2)+dd3 * L(dd4*r^2)) ; L(x)=1/(1+x^2)
    dd2 = dd(indpar+1)
    dd3 = dd(indpar+2)
    dd4 = dd(indpar+3)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k)**2)
      distp(k, 2) = 1.d0/(1.d0+dd4*r(k)**2)
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = 2.d0*(-(dd2*distp(0, 1)**2)-dd4*dd3*distp(0, 2)**2)
!     fun2=2.d0*(dd2*(-1.d0+2.d0*dd2*r(0)**2)*distp(0,1)
!    1+dd4*dd3*(-1.d0+2.d0*dd4*r(0)**2)*distp(0,2))
      fun2 = 2*dd2*distp(0, 1)**3*(-1.d0+3.d0*dd2*r(0)**2) + 2*dd3*dd4*&
&        distp(0, 2)**3*(-1.d0+3.d0*dd4*r(0)**2)
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp481b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp481b0
        fun2b = fun2b + temp481b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp481b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp481b
          funb0 = funb0 + rmu(ic, 0)*temp481b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp480 = distp(0, 1)**3
      temp480b = 2*(3.d0*(dd2*r(0)**2)-1.d0)*fun2b
      temp480b0 = 2*dd2*temp480*3.d0*fun2b
      temp479 = distp(0, 2)**3
      temp479b0 = 2*(3.d0*(dd4*r(0)**2)-1.d0)*fun2b
      temp479b1 = 2*dd3*dd4*temp479*3.d0*fun2b
      temp479b2 = 2.d0*funb0
      dd2b = r(0)**2*temp480b0 - distp(0, 1)**2*temp479b2 + temp480*&
&        temp480b
      distpb(0, 1) = dd2*3*distp(0, 1)**2*temp480b
      rb(0) = rb(0) + dd4*2*r(0)*temp479b1 + dd2*2*r(0)*temp480b0
      temp479b3 = -(distp(0, 2)**2*temp479b2)
      dd3b = dd4*temp479b3 + distp(0, 2)*fun0b + temp479*dd4*temp479b0
      dd4b = dd3*temp479b3 + r(0)**2*temp479b1 + temp479*dd3*temp479b0
      distpb(0, 2) = dd3*dd4*3*distp(0, 2)**2*temp479b0
      distpb(0, 1) = distpb(0, 1) - dd2*2*distp(0, 1)*temp479b2
      distpb(0, 2) = distpb(0, 2) - dd4*dd3*2*distp(0, 2)*temp479b2
      distpb(0, 1) = distpb(0, 1) + fun0b
      distpb(0, 2) = distpb(0, 2) + dd3*fun0b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd3b = 0.0_8
      dd4b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp479b = rmu(ic, i)*zb(indorbp, i)
        rmub(ic, i) = rmub(ic, i) + (distp(i, 1)+dd3*distp(i, 2))*zb(&
&          indorbp, i)
        distpb(i, 1) = distpb(i, 1) + temp479b
        dd3b = dd3b + distp(i, 2)*temp479b
        distpb(i, 2) = distpb(i, 2) + dd3*temp479b
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp478 = dd4*r(k)**2 + 1.d0
      temp478b = -(distpb(k, 2)/temp478**2)
      dd4b = dd4b + r(k)**2*temp478b
      distpb(k, 2) = 0.0_8
      temp477 = dd2*r(k)**2 + 1.d0
      temp477b = -(distpb(k, 1)/temp477**2)
      rb(k) = rb(k) + dd2*2*r(k)*temp477b + dd4*2*r(k)*temp478b
      dd2b = dd2b + r(k)**2*temp477b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (112) 
!     2p single   r_mu/(1+b r)^3   parent of 103
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = 1.d0/(1.d0+dd2*r(k))**3
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = -(3.d0*dd2*distp(0, 1)/(r(0)*(1.d0+dd2*r(0))))
      fun2 = 12.d0*dd2**2/(1.+dd2*r(0))**5
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp485b0 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp485b0
        fun2b = fun2b + temp485b0
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp485b = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp485b
          funb0 = funb0 + rmu(ic, 0)*temp485b
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp484 = (dd2*r(0)+1.)**5
      temp484b = 12.d0*fun2b/temp484
      temp484b0 = -(dd2**2*5*(dd2*r(0)+1.)**4*temp484b/temp484)
      temp483 = dd2*r(0) + 1.d0
      temp483b = -(3.d0*funb0/(r(0)*temp483))
      temp483b0 = -(dd2*distp(0, 1)*temp483b/(r(0)*temp483))
      dd2b = distp(0, 1)*temp483b + r(0)**2*temp483b0 + r(0)*temp484b0 +&
&        2*dd2*temp484b
      rb(0) = rb(0) + (r(0)*dd2+temp483)*temp483b0 + dd2*temp484b0
      distpb = 0.0_8
      distpb(0, 1) = fun0b + dd2*temp483b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp481 = dd2*r(k) + 1.d0
      temp482 = temp481**3
      temp481b1 = -(3*temp481**2*distpb(k, 1)/temp482**2)
      dd2b = dd2b + r(k)*temp481b1
      rb(k) = rb(k) + dd2*temp481b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (151) 
!     2p single exponential  -r^3  e^{-z r^2}  ! parent of 150
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd2*r(k)**2))
    END DO
!        indorbp=indorb
    DO ic=1,3
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      cost = dd2*r(0)**2
      fun = distp(0, 1)*(-3.d0+2.d0*cost)*r(0)
      fun2 = -(2.d0*distp(0, 1)*r(0)*(3.d0-7.d0*cost+2.d0*cost**2))
!              indorbp=indorb
      DO ic=1,3
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (i .EQ. ic) THEN
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
          END IF
        END DO
      END DO
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=3,1,-1
        temp485b7 = rmu(ic, 0)*zb(indorbp, indt+4)
        rmub(ic, 0) = rmub(ic, 0) + (4.d0*fun+fun2)*zb(indorbp, indt+4)
        funb0 = funb0 + 4.d0*temp485b7
        fun2b = fun2b + temp485b7
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (.NOT.branch .LT. 2) fun0b = fun0b + zb(indorbp, indt+i)
          temp485b6 = rmu(i, 0)*zb(indorbp, indt+i)
          rmub(ic, 0) = rmub(ic, 0) + fun*temp485b6
          funb0 = funb0 + rmu(ic, 0)*temp485b6
          rmub(i, 0) = rmub(i, 0) + rmu(ic, 0)*fun*zb(indorbp, indt+i)
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      distpb = 0.0_8
      temp485b3 = -(2.d0*(2.d0*cost**2-7.d0*cost+3.d0)*fun2b)
      temp485b4 = -(2.d0*distp(0, 1)*r(0)*fun2b)
      temp485b5 = (2.d0*cost-3.d0)*funb0
      distpb(0, 1) = r(0)*temp485b5 - r(0)**3*fun0b + r(0)*temp485b3
      costb = distp(0, 1)*r(0)*2.d0*funb0 + (2.d0*2*cost-7.d0)*temp485b4
      rb(0) = rb(0) + distp(0, 1)*temp485b5 - distp(0, 1)*3*r(0)**2*&
&        fun0b + dd2*2*r(0)*costb + distp(0, 1)*temp485b3
      dd2b = r(0)**2*costb
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=3,1,-1
      DO i=indtm,i0,-1
        temp485b2 = -(r(i)**3*zb(indorbp, i))
        rmub(ic, i) = rmub(ic, i) + distp(i, 1)*temp485b2
        distpb(i, 1) = distpb(i, 1) + rmu(ic, i)*temp485b2
        rb(i) = rb(i) - rmu(ic, i)*distp(i, 1)*3*r(i)**2*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO k=indtm,indtmin,-1
      temp485b1 = DEXP(-(dd2*r(k)**2))*distpb(k, 1)
      dd2b = dd2b - r(k)**2*temp485b1
      rb(k) = rb(k) - dd2*2*r(k)*temp485b1
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (127) 
!     3d without cusp and one parmater
    dd1 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = DEXP(-(dd1*r(k)))
    END DO
    DO i=indtmin,indtm
      distp(i, 3) = distp(i, 1)
      distp(i, 4) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      distp(i, 5) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      distp(i, 6) = rmu(1, i)*rmu(2, i)*cost3d
      distp(i, 7) = rmu(2, i)*rmu(3, i)*cost3d
      distp(i, 8) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
!         indorbp=indorb
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!            if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!            endif
    IF (typec .NE. 1) THEN
      fun0 = distp(0, 3)
      fun = -(dd1*distp(0, 1))
      fun2 = dd1**2*distp(0, 1)
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp486 = fun/r(0)
        temp487b = distp(0, 3+ic)*zb(indorbp, indt+4)
        temp486b3 = 6.d0*temp487b/r(0)
        distpb(0, 3+ic) = distpb(0, 3+ic) + (6.d0*temp486+fun2)*zb(&
&          indorbp, indt+4)
        funb0 = funb0 + temp486b3
        rb(0) = rb(0) - temp486*temp486b3
        fun2b = fun2b + temp487b
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp486b = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp486b
                  fun0b = fun0b + rmu(i, 0)*temp486b
                ELSE
                  temp486b0 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp486b0
                  fun0b = fun0b + rmu(i, 0)*temp486b0
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp486b1 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp486b1
                fun0b = fun0b + rmu(i, 0)*temp486b1
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp486b2 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp486b2
                fun0b = fun0b + rmu(i, 0)*temp486b2
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp485 = fun/r(0)
          temp485b9 = distp(0, 3+ic)*rmu(i, 0)*zb(indorbp, indt+i)/r(0)
          distpb(0, 3+ic) = distpb(0, 3+ic) + temp485*rmu(i, 0)*zb(&
&            indorbp, indt+i)
          rmub(i, 0) = rmub(i, 0) + temp485*distp(0, 3+ic)*zb(indorbp, &
&            indt+i)
          funb0 = funb0 + temp485b9
          rb(0) = rb(0) - temp485*temp485b9
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      dd1b = distp(0, 1)*2*dd1*fun2b - distp(0, 1)*funb0
      distpb(0, 1) = distpb(0, 1) + dd1**2*fun2b - dd1*funb0
      distpb(0, 3) = distpb(0, 3) + fun0b
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 3+ic) = distpb(i, 3+ic) + distp(i, 3)*zb(indorbp, i)
        distpb(i, 3) = distpb(i, 3) + distp(i, 3+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 8)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 8)
      distpb(i, 8) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 7)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 7)
      distpb(i, 7) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 6)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 5)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 4)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      distpb(i, 1) = distpb(i, 1) + distpb(i, 3)
      distpb(i, 3) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp485b8 = DEXP(-(dd1*r(k)))*distpb(k, 1)
      dd1b = dd1b - r(k)*temp485b8
      rb(k) = rb(k) - dd1*temp485b8
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (139) 
!     2s with cusp condition
!     ( r^3*exp(-dd2*r))  !  der of 128
    dd2 = dd(indpar+1)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 1) = -(DEXP(-(dd2*r(k)))*r(k))
    END DO
!           endif
    IF (typec .NE. 1) THEN
      fun = (3.d0-dd2*r(0))*distp(0, 1)
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp487b1 = distp(0, 1)*fun2b
      temp487b2 = 2*dd2*r(0)*temp487b1
      dd2b = r(0)*temp487b2 - 6*r(0)*temp487b1 - distp(0, 1)*r(0)*funb0
      rb(0) = rb(0) + dd2*temp487b2 - 6*dd2*temp487b1 - distp(0, 1)*dd2*&
&        funb0
      distpb(0, 1) = (3.d0-dd2*r(0))*funb0 + ((dd2*r(0))**2-6*(dd2*r(0))&
&        +6.d0)*fun2b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + r(i)**2*zb(indorbp, i)
      rb(i) = rb(i) + distp(i, 1)*2*r(i)*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp487b0 = -(r(k)*DEXP(-(dd2*r(k)))*distpb(k, 1))
      dd2b = dd2b - r(k)*temp487b0
      rb(k) = rb(k) - DEXP(-(dd2*r(k)))*distpb(k, 1) - dd2*temp487b0
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (45, 69) 
! d orbitals
! R(r)= c*exp(-z r^2)*(7/4/z-r^2)
!        indorbp=indorb
    indparp = indpar + 1
    dd1 = dd(indparp)
!        if(iflagnorm.gt.2) then
! overall normalization
!        c=4.d0/dsqrt(3.d0)*(2.d0/pi)**(3.d0/4.d0)*dd1**(7.d0/4.d0)
    c = dd1**1.75d0*1.64592278064948967213d0
!        endif
    DO k=indtmin,indtm
      distp(k, 1) = c*DEXP(-(dd1*r(k)**2))
    END DO
    DO i=indtmin,indtm
! lz=0
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
! lz=+/-2
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
! lz=+/-2
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
! lz=+/-1
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
! lz=+/-1
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,dd1)
      dd1 = dd(indparp)
      fun0 = distp(0, 1)*(7.d0/4.d0/dd1-r(0)**2)
      fun = distp(0, 1)*(2.d0*dd1*r(0)**2-11.d0/2.d0)
      fun2 = distp(0, 1)*(-(4.d0*dd1**2*r(0)**4)+17.d0*dd1*r(0)**2-11.d0&
&        /2.d0)
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp493b4 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 6.d0*temp493b4
        fun2b = fun2b + temp493b4
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp493b0 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp493b0
                  fun0b = fun0b + rmu(i, 0)*temp493b0
                ELSE
                  temp493b1 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp493b1
                  fun0b = fun0b + rmu(i, 0)*temp493b1
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp493b2 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp493b2
                fun0b = fun0b + rmu(i, 0)*temp493b2
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp493b3 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp493b3
                fun0b = fun0b + rmu(i, 0)*temp493b3
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp493b = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp493b
          funb0 = funb0 + rmu(i, 0)*temp493b
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp492 = r(0)**4
      temp492b = distp(0, 1)*fun2b
      temp491 = 4.d0*dd1
      temp490 = 7.d0/temp491
      distpb(0, 1) = distpb(0, 1) + (2.d0*(dd1*r(0)**2)-11.d0/2.d0)*&
&        funb0 + (temp490-r(0)**2)*fun0b + (17.d0*(dd1*r(0)**2)-11.d0/&
&        2.d0-4.d0*(dd1**2*temp492))*fun2b
      temp492b0 = distp(0, 1)*2.d0*funb0
      dd1b = r(0)**2*temp492b0 - distp(0, 1)*temp490*4.d0*fun0b/temp491 &
&        + (17.d0*r(0)**2-4.d0*temp492*2*dd1)*temp492b
      rb(0) = rb(0) + dd1*2*r(0)*temp492b0 - distp(0, 1)*2*r(0)*fun0b + &
&        (17.d0*dd1*2*r(0)-4.d0*dd1**2*4*r(0)**3)*temp492b
      CALL POPREAL8(adr8ibuf,adr8buf,dd1)
      ddb(indparp) = ddb(indparp) + dd1b
    ELSE
      distpb = 0.0_8
    END IF
    dd1b = 0.0_8
    DO ic=5,1,-1
      DO k=indtm,i0,-1
        temp490b = distp(k, 1)*distp(k, 1+ic)*zb(indorbp, k)
        temp489 = 4.d0*dd1
        temp488 = 7.d0/temp489
        temp488b = (temp488-r(k)**2)*zb(indorbp, k)
        dd1b = dd1b - temp488*4.d0*temp490b/temp489
        rb(k) = rb(k) - 2*r(k)*temp490b
        distpb(k, 1) = distpb(k, 1) + distp(k, 1+ic)*temp488b
        distpb(k, 1+ic) = distpb(k, 1+ic) + distp(k, 1)*temp488b
        zb(indorbp, k) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    cb = 0.0_8
    DO k=indtm,indtmin,-1
      temp487 = r(k)**2
      temp487b3 = c*DEXP(-(dd1*temp487))*distpb(k, 1)
      cb = cb + DEXP(-(dd1*temp487))*distpb(k, 1)
      dd1b = dd1b - temp487*temp487b3
      rb(k) = rb(k) - dd1*2*r(k)*temp487b3
      distpb(k, 1) = 0.0_8
    END DO
    dd1b = dd1b + 1.64592278064948967213d0*1.75d0*dd1**0.75D0*cb
    ddb(indparp) = ddb(indparp) + dd1b
  CASE (1200:1299) 
! derivative of 17 with respect to z
!     d gaussian  r**(2*npower)*exp(-alpha*r**2)
    npower = iopt - 1200
!        indorbp=indorb
    dd2 = dd(indpar+1)
    DO k=indtmin,indtm
      distp(k, 1) = r(k)**(2*npower)*DEXP(-(dd2*r(k)**2))
    END DO
    DO i=indtmin,indtm
      distp(i, 2) = (3.d0*rmu(3, i)**2-r(i)**2)*cost1d
      distp(i, 3) = (rmu(1, i)**2-rmu(2, i)**2)*cost2d
      distp(i, 4) = rmu(1, i)*rmu(2, i)*cost3d
      distp(i, 5) = rmu(2, i)*rmu(3, i)*cost3d
      distp(i, 6) = rmu(1, i)*rmu(3, i)*cost3d
    END DO
    DO ic=1,5
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!           if(iocc(indshell+ic).eq.1) then
      indorbp = indorb + ic
    END DO
!           endif
    IF (typec .NE. 1) THEN
      rp1 = r(0)**2
      fun0 = distp(0, 1)
      fun = (npower-dd2*rp1)*distp(0, 1)*2.d0/rp1
      fun2 = (npower*(2.d0*npower-1.d0)-(1.d0+4.d0*npower)*dd2*rp1+2.d0*&
&        (dd2*rp1)**2)*distp(0, 1)*2.d0/rp1
!              indorbp=indorb
      DO ic=1,5
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,indorbp)
!                 if(iocc(indshell+ic).eq.1) then
        indorbp = indorb + ic
        DO i=1,3
          IF (ic .EQ. 1) THEN
            IF (i .NE. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
            END IF
          ELSE IF (ic .EQ. 2) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,5)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
            END IF
          ELSE IF (ic .EQ. 3) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,6)
            ELSE IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,8)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,7)
            END IF
          ELSE IF (ic .EQ. 4) THEN
            IF (i .EQ. 2) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,9)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,11)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,10)
            END IF
          ELSE IF (ic .EQ. 5) THEN
            IF (i .EQ. 1) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,13)
            ELSE IF (i .EQ. 3) THEN
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,15)
            ELSE
              CALL PUSHINTEGER4(adi4ibuf,adi4buf,14)
            END IF
          ELSE
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,12)
          END IF
        END DO
      END DO
      distpb = 0.0_8
      funb0 = 0.0_8
      fun0b = 0.0_8
      fun2b = 0.0_8
      DO ic=5,1,-1
        temp497b6 = distp(0, 1+ic)*zb(indorbp, indt+4)
        distpb(0, 1+ic) = distpb(0, 1+ic) + (6.d0*fun+fun2)*zb(indorbp, &
&          indt+4)
        funb0 = funb0 + 6.d0*temp497b6
        fun2b = fun2b + temp497b6
        zb(indorbp, indt+4) = 0.0_8
        DO i=3,1,-1
          CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
          IF (branch .LT. 9) THEN
            IF (branch .LT. 5) THEN
              IF (branch .LT. 3) THEN
                IF (branch .LT. 2) THEN
                  temp497b2 = -(cost1d*2.d0*zb(indorbp, indt+i))
                  rmub(i, 0) = rmub(i, 0) + fun0*temp497b2
                  fun0b = fun0b + rmu(i, 0)*temp497b2
                ELSE
                  temp497b3 = cost1d*4.d0*zb(indorbp, indt+i)
                  rmub(i, 0) = rmub(i, 0) + fun0*temp497b3
                  fun0b = fun0b + rmu(i, 0)*temp497b3
                END IF
              ELSE IF (branch .LT. 4) THEN
                temp497b4 = cost2d*2.d0*zb(indorbp, indt+i)
                rmub(i, 0) = rmub(i, 0) + fun0*temp497b4
                fun0b = fun0b + rmu(i, 0)*temp497b4
              END IF
            ELSE IF (branch .LT. 7) THEN
              IF (branch .LT. 6) THEN
                temp497b5 = -(cost2d*2.d0*zb(indorbp, indt+i))
                rmub(i, 0) = rmub(i, 0) + fun0*temp497b5
                fun0b = fun0b + rmu(i, 0)*temp497b5
              ELSE
                rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (.NOT.branch .LT. 8) THEN
              rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 13) THEN
            IF (branch .LT. 11) THEN
              IF (branch .LT. 10) THEN
                rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i&
&                  )
                fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
              END IF
            ELSE IF (branch .LT. 12) THEN
              rmub(2, 0) = rmub(2, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(2, 0)*zb(indorbp, indt+i)
            END IF
          ELSE IF (branch .LT. 15) THEN
            IF (branch .LT. 14) THEN
              rmub(3, 0) = rmub(3, 0) + cost3d*fun0*zb(indorbp, indt+i)
              fun0b = fun0b + cost3d*rmu(3, 0)*zb(indorbp, indt+i)
            END IF
          ELSE
            rmub(1, 0) = rmub(1, 0) + cost3d*fun0*zb(indorbp, indt+i)
            fun0b = fun0b + cost3d*rmu(1, 0)*zb(indorbp, indt+i)
          END IF
          temp497b1 = distp(0, 1+ic)*zb(indorbp, indt+i)
          distpb(0, 1+ic) = distpb(0, 1+ic) + rmu(i, 0)*fun*zb(indorbp, &
&            indt+i)
          rmub(i, 0) = rmub(i, 0) + fun*temp497b1
          funb0 = funb0 + rmu(i, 0)*temp497b1
          zb(indorbp, indt+i) = 0.0_8
        END DO
        CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
      END DO
      temp496 = distp(0, 1)/rp1
      temp497b = 2.d0*temp496*fun2b
      temp497b0 = -((npower*4.d0+1.d0)*temp497b)
      temp496b = 2.d0*(npower*(npower*2.d0-1.d0)+2.d0*(dd2**2*rp1**2)-(&
&        npower*4.d0+1.d0)*(dd2*rp1))*fun2b/rp1
      temp495 = distp(0, 1)/rp1
      temp496b0 = 2.d0*temp495*funb0
      dd2b = rp1*temp497b0 - rp1*temp496b0 + 2.d0*rp1**2*2*dd2*temp497b
      temp495b = 2.d0*(npower-dd2*rp1)*funb0/rp1
      rp1b = dd2*temp497b0 - temp495*temp495b - temp496*temp496b - dd2*&
&        temp496b0 + 2.d0*dd2**2*2*rp1*temp497b
      distpb(0, 1) = distpb(0, 1) + temp495b + fun0b + temp496b
      rb(0) = rb(0) + 2*r(0)*rp1b
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
    END IF
    DO ic=5,1,-1
      DO i=indtm,i0,-1
        distpb(i, 1+ic) = distpb(i, 1+ic) + distp(i, 1)*zb(indorbp, i)
        distpb(i, 1) = distpb(i, 1) + distp(i, 1+ic)*zb(indorbp, i)
        zb(indorbp, i) = 0.0_8
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,indorbp)
    END DO
    DO i=indtm,indtmin,-1
      rmub(1, i) = rmub(1, i) + cost3d*rmu(3, i)*distpb(i, 6)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(1, i)*distpb(i, 6)
      distpb(i, 6) = 0.0_8
      rmub(2, i) = rmub(2, i) + cost3d*rmu(3, i)*distpb(i, 5)
      rmub(3, i) = rmub(3, i) + cost3d*rmu(2, i)*distpb(i, 5)
      distpb(i, 5) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost3d*rmu(2, i)*distpb(i, 4)
      rmub(2, i) = rmub(2, i) + cost3d*rmu(1, i)*distpb(i, 4)
      distpb(i, 4) = 0.0_8
      rmub(1, i) = rmub(1, i) + cost2d*2*rmu(1, i)*distpb(i, 3)
      rmub(2, i) = rmub(2, i) - cost2d*2*rmu(2, i)*distpb(i, 3)
      distpb(i, 3) = 0.0_8
      rmub(3, i) = rmub(3, i) + cost1d*3.d0*2*rmu(3, i)*distpb(i, 2)
      rb(i) = rb(i) - cost1d*2*r(i)*distpb(i, 2)
      distpb(i, 2) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp494 = r(k)**2
      temp493 = 2*npower
      temp493b5 = r(k)**temp493*DEXP(-(dd2*temp494))*distpb(k, 1)
      IF (r(k) .LE. 0.0 .AND. (temp493 .EQ. 0.0 .OR. temp493 .NE. INT(&
&          temp493))) THEN
        rb(k) = rb(k) - dd2*2*r(k)*temp493b5
      ELSE
        rb(k) = rb(k) + DEXP(-(dd2*temp494))*temp493*r(k)**(temp493-1)*&
&          distpb(k, 1) - dd2*2*r(k)*temp493b5
      END IF
      dd2b = dd2b - temp494*temp493b5
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (90:99) 
! cartesian orbitals
! 
! - angmom := iopt - 90
! - type = Gaussian
! - normalized = yes
! - angtype = cartesian
! - npar = 1
! - multiplicity := (iopt - 90 + 2) * (iopt - 90  + 1) // 2
!
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    multiplicity = (iopt-90+2)*(iopt-90+1)/2
    powers(:, -2, :) = 0.0d0
    powers(:, -1, :) = 0.0d0
    powers(:, 0, :) = 1.0d0
    DO ii=1,iopt-90
      DO k=indtmin,indtm
        CALL PUSHREAL8(adr8ibuf,adr8buf,powers(1, ii, k))
        powers(1, ii, k) = powers(1, ii-1, k)*rmu(1, k)
        CALL PUSHREAL8(adr8ibuf,adr8buf,powers(2, ii, k))
        powers(2, ii, k) = powers(2, ii-1, k)*rmu(2, k)
        CALL PUSHREAL8(adr8ibuf,adr8buf,powers(3, ii, k))
        powers(3, ii, k) = powers(3, ii-1, k)*rmu(3, k)
      END DO
    END DO
! * 2.829
    c = 0.712705470354990_8*dd1**0.75_8
    IF (iopt - 90 .NE. 0) THEN
      CALL PUSHREAL8(adr8ibuf,adr8buf,c)
      c = c*(8_4*dd1)**((iopt-90)/2.0_8)
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    DO k=i0,indtm
      distp(k, 1) = DEXP(-(1.0_8*dd1*r(k)*r(k)))*c
    END DO
    DO k=i0,indtm
      count = 0
      DO ii=iopt-90,0,-1
        ad_from = iopt - 90 - ii
        DO jj=ad_from,0,-1
          kk = iopt - 90 - ii - jj
          z(indorbp+count, k) = 1.0_8
          CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
          rp1 = 1.0_8
          DO i=ii+1,2*ii
            rp1 = rp1*i
          END DO
          z(indorbp+count, k) = z(indorbp+count, k)/DSQRT(rp1)
          CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
          rp1 = 1.0_8
          DO i=jj+1,2*jj
            rp1 = rp1*i
          END DO
          z(indorbp+count, k) = z(indorbp+count, k)/DSQRT(rp1)
          CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
          rp1 = 1.0_8
          DO i=kk+1,2*kk
            rp1 = rp1*i
          END DO
          z(indorbp+count, k) = z(indorbp+count, k)/DSQRT(rp1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,count)
          count = count + 1
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,ad_from)
      END DO
    END DO
! We need to calculate it again for derivatives, it could not be done in previous loop because of case if i0 /= indtmin
    IF (typec .NE. 1) THEN
      count = 0
      DO ii=iopt-90,0,-1
        ad_from0 = iopt - 90 - ii
        DO jj=ad_from0,0,-1
          kk = iopt - 90 - ii - jj
          z(indorbp+count, indt+1) = 1.0_8
          z(indorbp+count, indt+2) = 1.0_8
          z(indorbp+count, indt+3) = 1.0_8
          z(indorbp+count, indt+4) = 1.0_8
          CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
          rp1 = 1.0_8
          DO i=ii+1,2*ii
            rp1 = rp1*i
          END DO
          z(indorbp+count, indt+1) = z(indorbp+count, indt+1)/DSQRT(rp1)
          z(indorbp+count, indt+2) = z(indorbp+count, indt+2)/DSQRT(rp1)
          z(indorbp+count, indt+3) = z(indorbp+count, indt+3)/DSQRT(rp1)
          z(indorbp+count, indt+4) = z(indorbp+count, indt+4)/DSQRT(rp1)
          CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
          rp1 = 1.0_8
          DO i=jj+1,2*jj
            rp1 = rp1*i
          END DO
          z(indorbp+count, indt+1) = z(indorbp+count, indt+1)/DSQRT(rp1)
          z(indorbp+count, indt+2) = z(indorbp+count, indt+2)/DSQRT(rp1)
          z(indorbp+count, indt+3) = z(indorbp+count, indt+3)/DSQRT(rp1)
          z(indorbp+count, indt+4) = z(indorbp+count, indt+4)/DSQRT(rp1)
          CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
          rp1 = 1.0_8
          DO i=kk+1,2*kk
            rp1 = rp1*i
          END DO
          z(indorbp+count, indt+1) = z(indorbp+count, indt+1)/DSQRT(rp1)
          z(indorbp+count, indt+2) = z(indorbp+count, indt+2)/DSQRT(rp1)
          z(indorbp+count, indt+3) = z(indorbp+count, indt+3)/DSQRT(rp1)
          z(indorbp+count, indt+4) = z(indorbp+count, indt+4)/DSQRT(rp1)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,count)
          count = count + 1
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,ad_from0)
      END DO
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
! Initialize gradients and laplacians (radial part)
    IF (typec .NE. 1) THEN
      tmp = -(2.0d0*dd1*rmu(1, 0)*distp(0, 1))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(indt+1, 1))
      distp(indt+1, 1) = tmp
      tmp0 = -(2.0d0*dd1*rmu(2, 0)*distp(0, 1))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(indt+2, 1))
      distp(indt+2, 1) = tmp0
      tmp1 = -(2.0d0*dd1*rmu(3, 0)*distp(0, 1))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(indt+3, 1))
      distp(indt+3, 1) = tmp1
      tmp2 = dd1*(4.0d0*dd1*(r(0)*r(0))-6.0d0)*distp(0, 1)
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(indt+4, 1))
      distp(indt+4, 1) = tmp2
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
    DO k=i0,indtm
      count = 0
      DO ii=iopt-90,0,-1
        ad_from1 = iopt - 90 - ii
        DO jj=ad_from1,0,-1
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,kk)
          kk = iopt - 90 - ii - jj
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, k))
          z(indorbp+count, k) = z(indorbp+count, k)*powers(1, ii, k)
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, k))
          z(indorbp+count, k) = z(indorbp+count, k)*powers(2, jj, k)
          CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, k))
          z(indorbp+count, k) = z(indorbp+count, k)*powers(3, kk, k)
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,count)
          count = count + 1
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,ad_from1)
      END DO
    END DO
    IF (typec .NE. 1) THEN
! Solve ang_mom = 0, 1 separately
      IF (iopt - 90 .EQ. 0) THEN
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+1))
        z(indorbp, indt+1) = distp(indt+1, 1)
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+2))
        z(indorbp, indt+2) = distp(indt+2, 1)
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+3))
        z(indorbp, indt+3) = distp(indt+3, 1)
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
        z(indorbp, indt+4) = distp(indt+4, 1)
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,1)
      ELSE IF (iopt - 90 .EQ. 1) THEN
        CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
        rp1 = DSQRT(2.0_8)
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+1))
        z(indorbp, indt+1) = (distp(indt+1, 1)*rmu(1, indtmin)+distp(0, &
&          1))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+2))
        z(indorbp, indt+2) = distp(indt+2, 1)*rmu(1, indtmin)/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+3))
        z(indorbp, indt+3) = distp(indt+3, 1)*rmu(1, indtmin)/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+1))
        z(indorbp+1, indt+1) = distp(indt+1, 1)*rmu(2, indtmin)/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+2))
        z(indorbp+1, indt+2) = (distp(indt+2, 1)*rmu(2, indtmin)+distp(0&
&          , 1))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+3))
        z(indorbp+1, indt+3) = distp(indt+3, 1)*rmu(2, indtmin)/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+1))
        z(indorbp+2, indt+1) = distp(indt+1, 1)*rmu(3, indtmin)/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+2))
        z(indorbp+2, indt+2) = distp(indt+2, 1)*rmu(3, indtmin)/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+3))
        z(indorbp+2, indt+3) = (distp(indt+3, 1)*rmu(3, indtmin)+distp(0&
&          , 1))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
        z(indorbp, indt+4) = (distp(indt+4, 1)*rmu(1, indtmin)+2.0d0*&
&          distp(indt+1, 1))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+4))
        z(indorbp+1, indt+4) = (distp(indt+4, 1)*rmu(2, indtmin)+2.0d0*&
&          distp(indt+2, 1))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+4))
        z(indorbp+2, indt+4) = (distp(indt+4, 1)*rmu(3, indtmin)+2.0d0*&
&          distp(indt+3, 1))/rp1
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,2)
      ELSE IF (iopt - 90 .EQ. 2) THEN
        CALL PUSHREAL8(adr8ibuf,adr8buf,rp1)
        rp1 = 2.0_8
        rp2 = DSQRT(12.0_8)
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+1))
        z(indorbp, indt+1) = (distp(indt+1, 1)*rmu(1, indtmin)*rmu(1, &
&          indtmin)+2*rmu(1, indtmin)*distp(0, 1))/rp2
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+2))
        z(indorbp, indt+2) = distp(indt+2, 1)*rmu(1, indtmin)*rmu(1, &
&          indtmin)/rp2
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+3))
        z(indorbp, indt+3) = distp(indt+3, 1)*rmu(1, indtmin)*rmu(1, &
&          indtmin)/rp2
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+1))
        z(indorbp+1, indt+1) = (distp(indt+1, 1)*rmu(1, indtmin)*rmu(2, &
&          indtmin)+rmu(2, indtmin)*distp(0, 1))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+2))
        z(indorbp+1, indt+2) = (distp(indt+2, 1)*rmu(1, indtmin)*rmu(2, &
&          indtmin)+rmu(1, indtmin)*distp(0, 1))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+3))
        z(indorbp+1, indt+3) = distp(indt+3, 1)*rmu(1, indtmin)*rmu(2, &
&          indtmin)/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+1))
        z(indorbp+2, indt+1) = (distp(indt+1, 1)*rmu(1, indtmin)*rmu(3, &
&          indtmin)+rmu(3, indtmin)*distp(0, 1))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+2))
        z(indorbp+2, indt+2) = distp(indt+2, 1)*rmu(1, indtmin)*rmu(3, &
&          indtmin)/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+3))
        z(indorbp+2, indt+3) = distp(indt+3, 1)*rmu(1, indtmin)*rmu(3, &
&          indtmin) + rmu(1, indtmin)*distp(0, 1)/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+3, indt+1))
        z(indorbp+3, indt+1) = distp(indt+1, 1)*rmu(2, indtmin)*rmu(2, &
&          indtmin)/rp2
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+3, indt+2))
        z(indorbp+3, indt+2) = (distp(indt+2, 1)*rmu(2, indtmin)*rmu(2, &
&          indtmin)+2*rmu(2, indtmin)*distp(0, 1))/rp2
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+3, indt+3))
        z(indorbp+3, indt+3) = distp(indt+3, 1)*rmu(2, indtmin)*rmu(2, &
&          indtmin)/rp2
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+4, indt+1))
        z(indorbp+4, indt+1) = distp(indt+1, 1)*rmu(2, indtmin)*rmu(3, &
&          indtmin)/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+4, indt+2))
        z(indorbp+4, indt+2) = (distp(indt+2, 1)*rmu(2, indtmin)*rmu(3, &
&          indtmin)+rmu(3, indtmin)*distp(0, 1))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+4, indt+3))
        z(indorbp+4, indt+3) = (distp(indt+3, 1)*rmu(2, indtmin)*rmu(3, &
&          indtmin)+rmu(2, indtmin)*distp(0, 1))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+5, indt+1))
        z(indorbp+5, indt+1) = distp(indt+1, 1)*rmu(3, indtmin)*rmu(3, &
&          indtmin)/rp2
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+5, indt+2))
        z(indorbp+5, indt+2) = distp(indt+2, 1)*rmu(3, indtmin)*rmu(3, &
&          indtmin)/rp2
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+5, indt+3))
        z(indorbp+5, indt+3) = (distp(indt+3, 1)*rmu(3, indtmin)*rmu(3, &
&          indtmin)+2*rmu(3, indtmin)*distp(0, 1))/rp2
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
        z(indorbp, indt+4) = (1.0d0*distp(indt+4, 1)*rmu(1, indtmin)*rmu&
&          (1, indtmin)+4.0d0*distp(indt+1, 1)*rmu(1, indtmin)+2.0d0*&
&          distp(0, 1))/rp2
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+4))
        z(indorbp+1, indt+4) = (1.0d0*distp(indt+4, 1)*rmu(1, indtmin)*&
&          rmu(2, indtmin)+2.0d0*distp(indt+2, 1)*rmu(1, indtmin)+2.0d0*&
&          distp(indt+1, 1)*rmu(2, indtmin))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+4))
        z(indorbp+2, indt+4) = (1.0d0*distp(indt+4, 1)*rmu(1, indtmin)*&
&          rmu(3, indtmin)+2.0d0*distp(indt+3, 1)*rmu(1, indtmin)+2.0d0*&
&          distp(indt+1, 1)*rmu(3, indtmin))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+3, indt+4))
        z(indorbp+3, indt+4) = (1.0d0*distp(indt+4, 1)*rmu(2, indtmin)*&
&          rmu(2, indtmin)+4.0d0*distp(indt+2, 1)*rmu(2, indtmin)+2.0d0*&
&          distp(0, 1))/rp2
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+4, indt+4))
        z(indorbp+4, indt+4) = (1.0d0*distp(indt+4, 1)*rmu(2, indtmin)*&
&          rmu(3, indtmin)+2.0d0*distp(indt+3, 1)*rmu(2, indtmin)+2.0d0*&
&          distp(indt+2, 1)*rmu(3, indtmin))/rp1
        CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+5, indt+4))
        z(indorbp+5, indt+4) = (1.0d0*distp(indt+4, 1)*rmu(3, indtmin)*&
&          rmu(3, indtmin)+4.0d0*distp(indt+3, 1)*rmu(3, indtmin)+2.0d0*&
&          distp(0, 1))/rp2
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,3)
      ELSE
        count = 0
        DO ii=iopt-90,0,-1
          ad_from2 = iopt - 90 - ii
          DO jj=ad_from2,0,-1
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,kk)
            kk = iopt - 90 - ii - jj
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+1))
! First store polynomial part into respective places
! Then solve full laplacian using using lower derivatives
! Then do the same thing for gradients
! Then finally the values
            z(indorbp+count, indt+1) = z(indorbp+count, indt+1)*powers(1&
&              , ii-1, 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+1))
            z(indorbp+count, indt+1) = z(indorbp+count, indt+1)*powers(2&
&              , jj, 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+1))
            z(indorbp+count, indt+1) = z(indorbp+count, indt+1)*powers(3&
&              , kk, 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+1))
            z(indorbp+count, indt+1) = z(indorbp+count, indt+1)*ii
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+2))
            z(indorbp+count, indt+2) = z(indorbp+count, indt+2)*powers(1&
&              , ii, 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+2))
            z(indorbp+count, indt+2) = z(indorbp+count, indt+2)*powers(2&
&              , jj-1, 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+2))
            z(indorbp+count, indt+2) = z(indorbp+count, indt+2)*powers(3&
&              , kk, 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+2))
            z(indorbp+count, indt+2) = z(indorbp+count, indt+2)*jj
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+3))
            z(indorbp+count, indt+3) = z(indorbp+count, indt+3)*powers(1&
&              , ii, 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+3))
            z(indorbp+count, indt+3) = z(indorbp+count, indt+3)*powers(2&
&              , jj, 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+3))
            z(indorbp+count, indt+3) = z(indorbp+count, indt+3)*powers(3&
&              , kk-1, 0)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+3))
            z(indorbp+count, indt+3) = z(indorbp+count, indt+3)*kk
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+4))
            z(indorbp+count, indt+4) = z(indorbp+count, indt+4)*(powers(&
&              1, ii-2, 0)*powers(2, jj, 0)*powers(3, kk, 0)*ii*(ii-1)+&
&              powers(1, ii, 0)*powers(2, jj-2, 0)*powers(3, kk, 0)*jj*(&
&              jj-1)+powers(1, ii, 0)*powers(2, jj, 0)*powers(3, kk-2, 0)&
&              *kk*(kk-1))
! All polynomial parts are now stored
! Now solve laplacian
            tmp3 = z(indorbp+count, indt+4)*distp(0, 1) + 2.0_8*z(&
&              indorbp+count, indt+1)*distp(indt+1, 1) + 2.0_8*z(indorbp+&
&              count, indt+2)*distp(indt+2, 1) + 2.0_8*z(indorbp+count, &
&              indt+3)*distp(indt+3, 1) + z(indorbp+count, indtmin)*distp&
&              (indt+4, 1)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+4))
            z(indorbp+count, indt+4) = tmp3
! Now solve gradients
            tmp4 = z(indorbp+count, indt+1)*distp(0, 1) + z(indorbp+&
&              count, indtmin)*distp(indt+1, 1)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+1))
            z(indorbp+count, indt+1) = tmp4
            tmp5 = z(indorbp+count, indt+2)*distp(0, 1) + z(indorbp+&
&              count, indtmin)*distp(indt+2, 1)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+2))
            z(indorbp+count, indt+2) = tmp5
            tmp6 = z(indorbp+count, indt+3)*distp(0, 1) + z(indorbp+&
&              count, indtmin)*distp(indt+3, 1)
            CALL PUSHREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+3))
            z(indorbp+count, indt+3) = tmp6
            CALL PUSHINTEGER4(adi4ibuf,adi4buf,count)
            count = count + 1
          END DO
          CALL PUSHINTEGER4(adi4ibuf,adi4buf,ad_from2)
        END DO
        CALL PUSHINTEGER4(adi4ibuf,adi4buf,4)
      END IF
    ELSE
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,0)
    END IF
! Multiply by radial part for values
    DO ii=1,multiplicity
      CALL PUSHINTEGER4(adi4ibuf,adi4buf,kk)
    END DO
    distpb = 0.0_8
    DO ii=multiplicity,1,-1
      DO kk=indtm,i0,-1
        distpb(kk, 1) = distpb(kk, 1) + z(indorbp+ii-1, kk)*zb(indorbp+&
&          ii-1, kk)
        zb(indorbp+ii-1, kk) = distp(kk, 1)*zb(indorbp+ii-1, kk)
      END DO
      CALL POPINTEGER4(adi4ibuf,adi4buf,kk)
    END DO
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (branch .LT. 3) THEN
      IF (branch .LT. 2) THEN
        IF (branch .LT. 1) THEN
          powersb = 0.0_8
        ELSE
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
          distpb(indt+4, 1) = distpb(indt+4, 1) + zb(indorbp, indt+4)
          zb(indorbp, indt+4) = 0.0_8
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+3))
          distpb(indt+3, 1) = distpb(indt+3, 1) + zb(indorbp, indt+3)
          zb(indorbp, indt+3) = 0.0_8
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+2))
          distpb(indt+2, 1) = distpb(indt+2, 1) + zb(indorbp, indt+2)
          zb(indorbp, indt+2) = 0.0_8
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+1))
          distpb(indt+1, 1) = distpb(indt+1, 1) + zb(indorbp, indt+1)
          zb(indorbp, indt+1) = 0.0_8
          powersb = 0.0_8
        END IF
      ELSE
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+4))
        temp499b4 = zb(indorbp+2, indt+4)/rp1
        distpb(indt+4, 1) = distpb(indt+4, 1) + rmu(3, indtmin)*&
&          temp499b4
        rmub(3, indtmin) = rmub(3, indtmin) + distp(indt+4, 1)*temp499b4
        distpb(indt+3, 1) = distpb(indt+3, 1) + 2.0d0*temp499b4
        zb(indorbp+2, indt+4) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+4))
        temp499b5 = zb(indorbp+1, indt+4)/rp1
        distpb(indt+4, 1) = distpb(indt+4, 1) + rmu(2, indtmin)*&
&          temp499b5
        rmub(2, indtmin) = rmub(2, indtmin) + distp(indt+4, 1)*temp499b5
        distpb(indt+2, 1) = distpb(indt+2, 1) + 2.0d0*temp499b5
        zb(indorbp+1, indt+4) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
        temp499b6 = zb(indorbp, indt+4)/rp1
        distpb(indt+4, 1) = distpb(indt+4, 1) + rmu(1, indtmin)*&
&          temp499b6
        rmub(1, indtmin) = rmub(1, indtmin) + distp(indt+4, 1)*temp499b6
        distpb(indt+1, 1) = distpb(indt+1, 1) + 2.0d0*temp499b6
        zb(indorbp, indt+4) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+3))
        temp499b7 = zb(indorbp+2, indt+3)/rp1
        distpb(indt+3, 1) = distpb(indt+3, 1) + rmu(3, indtmin)*&
&          temp499b7
        zb(indorbp+2, indt+3) = 0.0_8
        rmub(3, indtmin) = rmub(3, indtmin) + distp(indt+2, 1)*zb(&
&          indorbp+2, indt+2)/rp1 + distp(indt+3, 1)*temp499b7
        distpb(0, 1) = distpb(0, 1) + temp499b7
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+2))
        distpb(indt+2, 1) = distpb(indt+2, 1) + rmu(3, indtmin)*zb(&
&          indorbp+2, indt+2)/rp1
        zb(indorbp+2, indt+2) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+1))
        distpb(indt+1, 1) = distpb(indt+1, 1) + rmu(3, indtmin)*zb(&
&          indorbp+2, indt+1)/rp1
        rmub(3, indtmin) = rmub(3, indtmin) + distp(indt+1, 1)*zb(&
&          indorbp+2, indt+1)/rp1
        zb(indorbp+2, indt+1) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+3))
        distpb(indt+3, 1) = distpb(indt+3, 1) + rmu(2, indtmin)*zb(&
&          indorbp+1, indt+3)/rp1
        rmub(2, indtmin) = rmub(2, indtmin) + distp(indt+3, 1)*zb(&
&          indorbp+1, indt+3)/rp1
        zb(indorbp+1, indt+3) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+2))
        temp499b8 = zb(indorbp+1, indt+2)/rp1
        distpb(indt+2, 1) = distpb(indt+2, 1) + rmu(2, indtmin)*&
&          temp499b8
        zb(indorbp+1, indt+2) = 0.0_8
        rmub(2, indtmin) = rmub(2, indtmin) + distp(indt+1, 1)*zb(&
&          indorbp+1, indt+1)/rp1 + distp(indt+2, 1)*temp499b8
        distpb(0, 1) = distpb(0, 1) + temp499b8
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+1))
        distpb(indt+1, 1) = distpb(indt+1, 1) + rmu(2, indtmin)*zb(&
&          indorbp+1, indt+1)/rp1
        zb(indorbp+1, indt+1) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+3))
        distpb(indt+3, 1) = distpb(indt+3, 1) + rmu(1, indtmin)*zb(&
&          indorbp, indt+3)/rp1
        rmub(1, indtmin) = rmub(1, indtmin) + distp(indt+3, 1)*zb(&
&          indorbp, indt+3)/rp1
        zb(indorbp, indt+3) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+2))
        distpb(indt+2, 1) = distpb(indt+2, 1) + rmu(1, indtmin)*zb(&
&          indorbp, indt+2)/rp1
        rmub(1, indtmin) = rmub(1, indtmin) + distp(indt+2, 1)*zb(&
&          indorbp, indt+2)/rp1
        zb(indorbp, indt+2) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+1))
        temp499b9 = zb(indorbp, indt+1)/rp1
        distpb(indt+1, 1) = distpb(indt+1, 1) + rmu(1, indtmin)*&
&          temp499b9
        rmub(1, indtmin) = rmub(1, indtmin) + distp(indt+1, 1)*temp499b9
        distpb(0, 1) = distpb(0, 1) + temp499b9
        zb(indorbp, indt+1) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,rp1)
        powersb = 0.0_8
      END IF
    ELSE IF (branch .LT. 4) THEN
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+5, indt+4))
      temp499b10 = zb(indorbp+5, indt+4)/rp2
      distpb(indt+4, 1) = distpb(indt+4, 1) + rmu(3, indtmin)**2*&
&        temp499b10
      rmub(3, indtmin) = rmub(3, indtmin) + (4.0d0*distp(indt+3, 1)+&
&        distp(indt+4, 1)*2*rmu(3, indtmin))*temp499b10
      distpb(indt+3, 1) = distpb(indt+3, 1) + 4.0d0*rmu(3, indtmin)*&
&        temp499b10
      distpb(0, 1) = distpb(0, 1) + 2.0d0*temp499b10
      zb(indorbp+5, indt+4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+4, indt+4))
      temp499b11 = zb(indorbp+4, indt+4)/rp1
      temp499b12 = distp(indt+4, 1)*temp499b11
      distpb(indt+4, 1) = distpb(indt+4, 1) + rmu(2, indtmin)*rmu(3, &
&        indtmin)*temp499b11
      rmub(2, indtmin) = rmub(2, indtmin) + 2.0d0*distp(indt+3, 1)*&
&        temp499b11 + rmu(3, indtmin)*temp499b12
      rmub(3, indtmin) = rmub(3, indtmin) + 2.0d0*distp(indt+2, 1)*&
&        temp499b11 + rmu(2, indtmin)*temp499b12
      distpb(indt+3, 1) = distpb(indt+3, 1) + 2.0d0*rmu(2, indtmin)*&
&        temp499b11
      distpb(indt+2, 1) = distpb(indt+2, 1) + 2.0d0*rmu(3, indtmin)*&
&        temp499b11
      zb(indorbp+4, indt+4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+3, indt+4))
      temp499b13 = zb(indorbp+3, indt+4)/rp2
      distpb(indt+4, 1) = distpb(indt+4, 1) + rmu(2, indtmin)**2*&
&        temp499b13
      rmub(2, indtmin) = rmub(2, indtmin) + (4.0d0*distp(indt+2, 1)+&
&        distp(indt+4, 1)*2*rmu(2, indtmin))*temp499b13
      distpb(indt+2, 1) = distpb(indt+2, 1) + 4.0d0*rmu(2, indtmin)*&
&        temp499b13
      distpb(0, 1) = distpb(0, 1) + 2.0d0*temp499b13
      zb(indorbp+3, indt+4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+4))
      temp499b14 = zb(indorbp+2, indt+4)/rp1
      temp499b15 = distp(indt+4, 1)*temp499b14
      distpb(indt+4, 1) = distpb(indt+4, 1) + rmu(1, indtmin)*rmu(3, &
&        indtmin)*temp499b14
      rmub(1, indtmin) = rmub(1, indtmin) + 2.0d0*distp(indt+3, 1)*&
&        temp499b14 + rmu(3, indtmin)*temp499b15
      rmub(3, indtmin) = rmub(3, indtmin) + 2.0d0*distp(indt+1, 1)*&
&        temp499b14 + rmu(1, indtmin)*temp499b15
      distpb(indt+3, 1) = distpb(indt+3, 1) + 2.0d0*rmu(1, indtmin)*&
&        temp499b14
      distpb(indt+1, 1) = distpb(indt+1, 1) + 2.0d0*rmu(3, indtmin)*&
&        temp499b14
      zb(indorbp+2, indt+4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+4))
      temp499b16 = zb(indorbp+1, indt+4)/rp1
      temp499b17 = distp(indt+4, 1)*temp499b16
      distpb(indt+4, 1) = distpb(indt+4, 1) + rmu(1, indtmin)*rmu(2, &
&        indtmin)*temp499b16
      rmub(1, indtmin) = rmub(1, indtmin) + 2.0d0*distp(indt+2, 1)*&
&        temp499b16 + rmu(2, indtmin)*temp499b17
      rmub(2, indtmin) = rmub(2, indtmin) + 2.0d0*distp(indt+1, 1)*&
&        temp499b16 + rmu(1, indtmin)*temp499b17
      distpb(indt+2, 1) = distpb(indt+2, 1) + 2.0d0*rmu(1, indtmin)*&
&        temp499b16
      distpb(indt+1, 1) = distpb(indt+1, 1) + 2.0d0*rmu(2, indtmin)*&
&        temp499b16
      zb(indorbp+1, indt+4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+4))
      temp499b18 = zb(indorbp, indt+4)/rp2
      distpb(indt+4, 1) = distpb(indt+4, 1) + rmu(1, indtmin)**2*&
&        temp499b18
      rmub(1, indtmin) = rmub(1, indtmin) + (4.0d0*distp(indt+1, 1)+&
&        distp(indt+4, 1)*2*rmu(1, indtmin))*temp499b18
      distpb(indt+1, 1) = distpb(indt+1, 1) + 4.0d0*rmu(1, indtmin)*&
&        temp499b18
      distpb(0, 1) = distpb(0, 1) + 2.0d0*temp499b18
      zb(indorbp, indt+4) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+5, indt+3))
      temp499b19 = zb(indorbp+5, indt+3)/rp2
      distpb(indt+3, 1) = distpb(indt+3, 1) + rmu(3, indtmin)**2*&
&        temp499b19
      zb(indorbp+5, indt+3) = 0.0_8
      rmub(3, indtmin) = rmub(3, indtmin) + distp(indt+2, 1)*2*rmu(3, &
&        indtmin)*zb(indorbp+5, indt+2)/rp2 + (2*distp(0, 1)+distp(indt+3&
&        , 1)*2*rmu(3, indtmin))*temp499b19
      distpb(0, 1) = distpb(0, 1) + 2*rmu(3, indtmin)*temp499b19
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+5, indt+2))
      distpb(indt+2, 1) = distpb(indt+2, 1) + rmu(3, indtmin)**2*zb(&
&        indorbp+5, indt+2)/rp2
      zb(indorbp+5, indt+2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+5, indt+1))
      distpb(indt+1, 1) = distpb(indt+1, 1) + rmu(3, indtmin)**2*zb(&
&        indorbp+5, indt+1)/rp2
      rmub(3, indtmin) = rmub(3, indtmin) + distp(indt+1, 1)*2*rmu(3, &
&        indtmin)*zb(indorbp+5, indt+1)/rp2
      zb(indorbp+5, indt+1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+4, indt+3))
      temp499b20 = zb(indorbp+4, indt+3)/rp1
      temp499b21 = distp(indt+3, 1)*temp499b20
      distpb(indt+3, 1) = distpb(indt+3, 1) + rmu(2, indtmin)*rmu(3, &
&        indtmin)*temp499b20
      rmub(2, indtmin) = rmub(2, indtmin) + distp(0, 1)*temp499b20 + rmu&
&        (3, indtmin)*temp499b21
      rmub(3, indtmin) = rmub(3, indtmin) + rmu(2, indtmin)*temp499b21
      distpb(0, 1) = distpb(0, 1) + rmu(2, indtmin)*temp499b20
      zb(indorbp+4, indt+3) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+4, indt+2))
      temp499b22 = zb(indorbp+4, indt+2)/rp1
      temp499b23 = distp(indt+2, 1)*temp499b22
      distpb(indt+2, 1) = distpb(indt+2, 1) + rmu(2, indtmin)*rmu(3, &
&        indtmin)*temp499b22
      rmub(2, indtmin) = rmub(2, indtmin) + rmu(3, indtmin)*temp499b23
      zb(indorbp+4, indt+2) = 0.0_8
      temp499b24 = rmu(2, indtmin)*zb(indorbp+4, indt+1)/rp1
      rmub(3, indtmin) = rmub(3, indtmin) + distp(indt+1, 1)*temp499b24 &
&        + distp(0, 1)*temp499b22 + rmu(2, indtmin)*temp499b23
      distpb(0, 1) = distpb(0, 1) + rmu(3, indtmin)*temp499b22
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+4, indt+1))
      distpb(indt+1, 1) = distpb(indt+1, 1) + rmu(3, indtmin)*temp499b24
      rmub(2, indtmin) = rmub(2, indtmin) + distp(indt+1, 1)*rmu(3, &
&        indtmin)*zb(indorbp+4, indt+1)/rp1
      zb(indorbp+4, indt+1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+3, indt+3))
      distpb(indt+3, 1) = distpb(indt+3, 1) + rmu(2, indtmin)**2*zb(&
&        indorbp+3, indt+3)/rp2
      rmub(2, indtmin) = rmub(2, indtmin) + distp(indt+3, 1)*2*rmu(2, &
&        indtmin)*zb(indorbp+3, indt+3)/rp2
      zb(indorbp+3, indt+3) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+3, indt+2))
      temp499b25 = zb(indorbp+3, indt+2)/rp2
      distpb(indt+2, 1) = distpb(indt+2, 1) + rmu(2, indtmin)**2*&
&        temp499b25
      zb(indorbp+3, indt+2) = 0.0_8
      rmub(2, indtmin) = rmub(2, indtmin) + distp(indt+1, 1)*2*rmu(2, &
&        indtmin)*zb(indorbp+3, indt+1)/rp2 + (2*distp(0, 1)+distp(indt+2&
&        , 1)*2*rmu(2, indtmin))*temp499b25
      distpb(0, 1) = distpb(0, 1) + 2*rmu(2, indtmin)*temp499b25
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+3, indt+1))
      distpb(indt+1, 1) = distpb(indt+1, 1) + rmu(2, indtmin)**2*zb(&
&        indorbp+3, indt+1)/rp2
      zb(indorbp+3, indt+1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+3))
      temp499b26 = distp(indt+3, 1)*zb(indorbp+2, indt+3)
      distpb(indt+3, 1) = distpb(indt+3, 1) + rmu(1, indtmin)*rmu(3, &
&        indtmin)*zb(indorbp+2, indt+3)
      rmub(1, indtmin) = rmub(1, indtmin) + distp(0, 1)*zb(indorbp+2, &
&        indt+3)/rp1 + rmu(3, indtmin)*temp499b26
      distpb(0, 1) = distpb(0, 1) + rmu(1, indtmin)*zb(indorbp+2, indt+3&
&        )/rp1
      zb(indorbp+2, indt+3) = 0.0_8
      temp499b27 = rmu(1, indtmin)*zb(indorbp+2, indt+2)/rp1
      rmub(3, indtmin) = rmub(3, indtmin) + distp(indt+2, 1)*temp499b27 &
&        + rmu(1, indtmin)*temp499b26
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+2))
      distpb(indt+2, 1) = distpb(indt+2, 1) + rmu(3, indtmin)*temp499b27
      rmub(1, indtmin) = rmub(1, indtmin) + distp(indt+2, 1)*rmu(3, &
&        indtmin)*zb(indorbp+2, indt+2)/rp1
      zb(indorbp+2, indt+2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+2, indt+1))
      temp499b28 = zb(indorbp+2, indt+1)/rp1
      temp499b29 = distp(indt+1, 1)*temp499b28
      distpb(indt+1, 1) = distpb(indt+1, 1) + rmu(1, indtmin)*rmu(3, &
&        indtmin)*temp499b28
      rmub(1, indtmin) = rmub(1, indtmin) + rmu(3, indtmin)*temp499b29
      rmub(3, indtmin) = rmub(3, indtmin) + distp(0, 1)*temp499b28 + rmu&
&        (1, indtmin)*temp499b29
      distpb(0, 1) = distpb(0, 1) + rmu(3, indtmin)*temp499b28
      zb(indorbp+2, indt+1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+3))
      temp499b30 = rmu(1, indtmin)*zb(indorbp+1, indt+3)/rp1
      distpb(indt+3, 1) = distpb(indt+3, 1) + rmu(2, indtmin)*temp499b30
      rmub(2, indtmin) = rmub(2, indtmin) + distp(indt+3, 1)*temp499b30
      rmub(1, indtmin) = rmub(1, indtmin) + distp(indt+3, 1)*rmu(2, &
&        indtmin)*zb(indorbp+1, indt+3)/rp1
      zb(indorbp+1, indt+3) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+2))
      temp499b31 = zb(indorbp+1, indt+2)/rp1
      temp499b32 = distp(indt+2, 1)*temp499b31
      distpb(indt+2, 1) = distpb(indt+2, 1) + rmu(1, indtmin)*rmu(2, &
&        indtmin)*temp499b31
      rmub(1, indtmin) = rmub(1, indtmin) + distp(0, 1)*temp499b31 + rmu&
&        (2, indtmin)*temp499b32
      rmub(2, indtmin) = rmub(2, indtmin) + rmu(1, indtmin)*temp499b32
      distpb(0, 1) = distpb(0, 1) + rmu(1, indtmin)*temp499b31
      zb(indorbp+1, indt+2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+1, indt+1))
      temp499b33 = zb(indorbp+1, indt+1)/rp1
      temp499b34 = distp(indt+1, 1)*temp499b33
      distpb(indt+1, 1) = distpb(indt+1, 1) + rmu(1, indtmin)*rmu(2, &
&        indtmin)*temp499b33
      rmub(1, indtmin) = rmub(1, indtmin) + rmu(2, indtmin)*temp499b34
      rmub(2, indtmin) = rmub(2, indtmin) + distp(0, 1)*temp499b33 + rmu&
&        (1, indtmin)*temp499b34
      distpb(0, 1) = distpb(0, 1) + rmu(2, indtmin)*temp499b33
      zb(indorbp+1, indt+1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+3))
      distpb(indt+3, 1) = distpb(indt+3, 1) + rmu(1, indtmin)**2*zb(&
&        indorbp, indt+3)/rp2
      rmub(1, indtmin) = rmub(1, indtmin) + distp(indt+3, 1)*2*rmu(1, &
&        indtmin)*zb(indorbp, indt+3)/rp2
      zb(indorbp, indt+3) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+2))
      distpb(indt+2, 1) = distpb(indt+2, 1) + rmu(1, indtmin)**2*zb(&
&        indorbp, indt+2)/rp2
      rmub(1, indtmin) = rmub(1, indtmin) + distp(indt+2, 1)*2*rmu(1, &
&        indtmin)*zb(indorbp, indt+2)/rp2
      zb(indorbp, indt+2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp, indt+1))
      temp499b35 = zb(indorbp, indt+1)/rp2
      distpb(indt+1, 1) = distpb(indt+1, 1) + rmu(1, indtmin)**2*&
&        temp499b35
      rmub(1, indtmin) = rmub(1, indtmin) + (2*distp(0, 1)+distp(indt+1&
&        , 1)*2*rmu(1, indtmin))*temp499b35
      distpb(0, 1) = distpb(0, 1) + 2*rmu(1, indtmin)*temp499b35
      zb(indorbp, indt+1) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp1)
      powersb = 0.0_8
    ELSE
      powersb = 0.0_8
      DO ii=0,iopt-90,1
        CALL POPINTEGER4(adi4ibuf,adi4buf,ad_from2)
        DO jj=0,ad_from2,1
          CALL POPINTEGER4(adi4ibuf,adi4buf,count)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+3))
          tmp6b = zb(indorbp+count, indt+3)
          zb(indorbp+count, indt+3) = distp(0, 1)*tmp6b
          distpb(0, 1) = distpb(0, 1) + z(indorbp+count, indt+3)*tmp6b
          zb(indorbp+count, indtmin) = zb(indorbp+count, indtmin) + &
&            distp(indt+3, 1)*tmp6b
          distpb(indt+3, 1) = distpb(indt+3, 1) + z(indorbp+count, &
&            indtmin)*tmp6b
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+2))
          tmp5b = zb(indorbp+count, indt+2)
          zb(indorbp+count, indt+2) = distp(0, 1)*tmp5b
          distpb(0, 1) = distpb(0, 1) + z(indorbp+count, indt+2)*tmp5b
          zb(indorbp+count, indtmin) = zb(indorbp+count, indtmin) + &
&            distp(indt+2, 1)*tmp5b
          distpb(indt+2, 1) = distpb(indt+2, 1) + z(indorbp+count, &
&            indtmin)*tmp5b
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+1))
          tmp4b = zb(indorbp+count, indt+1)
          zb(indorbp+count, indt+1) = distp(0, 1)*tmp4b
          distpb(0, 1) = distpb(0, 1) + z(indorbp+count, indt+1)*tmp4b
          zb(indorbp+count, indtmin) = zb(indorbp+count, indtmin) + &
&            distp(indt+1, 1)*tmp4b
          distpb(indt+1, 1) = distpb(indt+1, 1) + z(indorbp+count, &
&            indtmin)*tmp4b
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+4))
          tmp3b = zb(indorbp+count, indt+4)
          zb(indorbp+count, indt+4) = distp(0, 1)*tmp3b
          distpb(0, 1) = distpb(0, 1) + z(indorbp+count, indt+4)*tmp3b
          zb(indorbp+count, indt+1) = zb(indorbp+count, indt+1) + 2.0_8*&
&            distp(indt+1, 1)*tmp3b
          distpb(indt+1, 1) = distpb(indt+1, 1) + 2.0_8*z(indorbp+count&
&            , indt+1)*tmp3b
          zb(indorbp+count, indt+2) = zb(indorbp+count, indt+2) + 2.0_8*&
&            distp(indt+2, 1)*tmp3b
          distpb(indt+2, 1) = distpb(indt+2, 1) + 2.0_8*z(indorbp+count&
&            , indt+2)*tmp3b
          zb(indorbp+count, indt+3) = zb(indorbp+count, indt+3) + 2.0_8*&
&            distp(indt+3, 1)*tmp3b
          distpb(indt+3, 1) = distpb(indt+3, 1) + 2.0_8*z(indorbp+count&
&            , indt+3)*tmp3b
          zb(indorbp+count, indtmin) = zb(indorbp+count, indtmin) + &
&            distp(indt+4, 1)*tmp3b
          distpb(indt+4, 1) = distpb(indt+4, 1) + z(indorbp+count, &
&            indtmin)*tmp3b
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+4))
          temp502 = powers(3, kk-2, 0)
          temp501 = powers(1, ii, 0)*powers(2, jj, 0)
          temp499 = powers(1, ii, 0)*powers(3, kk, 0)
          temp500 = powers(2, jj, 0)*powers(3, kk, 0)
          temp501b = z(indorbp+count, indt+4)*zb(indorbp+count, indt+4)
          temp501b0 = ii*(ii-1)*temp501b
          temp500b = powers(1, ii-2, 0)*temp501b0
          temp500b0 = jj*(jj-1)*temp501b
          temp499b36 = powers(2, jj-2, 0)*temp500b0
          temp499b37 = kk*(kk-1)*temp501b
          powersb(1, ii-2, 0) = powersb(1, ii-2, 0) + temp500*temp501b0
          powersb(2, jj, 0) = powersb(2, jj, 0) + temp502*powers(1, ii, &
&            0)*temp499b37 + powers(3, kk, 0)*temp500b
          powersb(3, kk, 0) = powersb(3, kk, 0) + powers(1, ii, 0)*&
&            temp499b36 + powers(2, jj, 0)*temp500b
          powersb(2, jj-2, 0) = powersb(2, jj-2, 0) + temp499*temp500b0
          powersb(1, ii, 0) = powersb(1, ii, 0) + temp502*powers(2, jj, &
&            0)*temp499b37 + powers(3, kk, 0)*temp499b36
          powersb(3, kk-2, 0) = powersb(3, kk-2, 0) + temp501*temp499b37
          zb(indorbp+count, indt+4) = (ii*(ii-1)*(powers(1, ii-2, 0)*&
&            temp500)+jj*(jj-1)*(powers(2, jj-2, 0)*temp499)+kk*(kk-1)*(&
&            temp501*temp502))*zb(indorbp+count, indt+4)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+3))
          zb(indorbp+count, indt+3) = kk*zb(indorbp+count, indt+3)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+3))
          powersb(3, kk-1, 0) = powersb(3, kk-1, 0) + z(indorbp+count, &
&            indt+3)*zb(indorbp+count, indt+3)
          zb(indorbp+count, indt+3) = powers(3, kk-1, 0)*zb(indorbp+&
&            count, indt+3)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+3))
          powersb(2, jj, 0) = powersb(2, jj, 0) + z(indorbp+count, indt+&
&            3)*zb(indorbp+count, indt+3)
          zb(indorbp+count, indt+3) = powers(2, jj, 0)*zb(indorbp+count&
&            , indt+3)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+3))
          powersb(1, ii, 0) = powersb(1, ii, 0) + z(indorbp+count, indt+&
&            3)*zb(indorbp+count, indt+3)
          zb(indorbp+count, indt+3) = powers(1, ii, 0)*zb(indorbp+count&
&            , indt+3)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+2))
          zb(indorbp+count, indt+2) = jj*zb(indorbp+count, indt+2)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+2))
          powersb(3, kk, 0) = powersb(3, kk, 0) + z(indorbp+count, indt+&
&            2)*zb(indorbp+count, indt+2)
          zb(indorbp+count, indt+2) = powers(3, kk, 0)*zb(indorbp+count&
&            , indt+2)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+2))
          powersb(2, jj-1, 0) = powersb(2, jj-1, 0) + z(indorbp+count, &
&            indt+2)*zb(indorbp+count, indt+2)
          zb(indorbp+count, indt+2) = powers(2, jj-1, 0)*zb(indorbp+&
&            count, indt+2)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+2))
          powersb(1, ii, 0) = powersb(1, ii, 0) + z(indorbp+count, indt+&
&            2)*zb(indorbp+count, indt+2)
          zb(indorbp+count, indt+2) = powers(1, ii, 0)*zb(indorbp+count&
&            , indt+2)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+1))
          zb(indorbp+count, indt+1) = ii*zb(indorbp+count, indt+1)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+1))
          powersb(3, kk, 0) = powersb(3, kk, 0) + z(indorbp+count, indt+&
&            1)*zb(indorbp+count, indt+1)
          zb(indorbp+count, indt+1) = powers(3, kk, 0)*zb(indorbp+count&
&            , indt+1)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+1))
          powersb(2, jj, 0) = powersb(2, jj, 0) + z(indorbp+count, indt+&
&            1)*zb(indorbp+count, indt+1)
          zb(indorbp+count, indt+1) = powers(2, jj, 0)*zb(indorbp+count&
&            , indt+1)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, indt+1))
          powersb(1, ii-1, 0) = powersb(1, ii-1, 0) + z(indorbp+count, &
&            indt+1)*zb(indorbp+count, indt+1)
          zb(indorbp+count, indt+1) = powers(1, ii-1, 0)*zb(indorbp+&
&            count, indt+1)
          CALL POPINTEGER4(adi4ibuf,adi4buf,kk)
        END DO
      END DO
    END IF
    DO k=indtm,i0,-1
      DO ii=0,iopt-90,1
        CALL POPINTEGER4(adi4ibuf,adi4buf,ad_from1)
        DO jj=0,ad_from1,1
          CALL POPINTEGER4(adi4ibuf,adi4buf,count)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, k))
          powersb(3, kk, k) = powersb(3, kk, k) + z(indorbp+count, k)*zb&
&            (indorbp+count, k)
          zb(indorbp+count, k) = powers(3, kk, k)*zb(indorbp+count, k)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, k))
          powersb(2, jj, k) = powersb(2, jj, k) + z(indorbp+count, k)*zb&
&            (indorbp+count, k)
          zb(indorbp+count, k) = powers(2, jj, k)*zb(indorbp+count, k)
          CALL POPREAL8(adr8ibuf,adr8buf,z(indorbp+count, k))
          powersb(1, ii, k) = powersb(1, ii, k) + z(indorbp+count, k)*zb&
&            (indorbp+count, k)
          zb(indorbp+count, k) = powers(1, ii, k)*zb(indorbp+count, k)
          CALL POPINTEGER4(adi4ibuf,adi4buf,kk)
        END DO
      END DO
    END DO
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (branch .LT. 1) THEN
      dd1b = 0.0_8
    ELSE
      CALL POPREAL8(adr8ibuf,adr8buf,distp(indt+4, 1))
      tmp2b = distpb(indt+4, 1)
      distpb(indt+4, 1) = 0.0_8
      temp499b = dd1*distp(0, 1)*4.0d0*tmp2b
      temp499b0 = (4.0d0*(dd1*r(0)**2)-6.0d0)*tmp2b
      dd1b = distp(0, 1)*temp499b0 + r(0)**2*temp499b
      rb(0) = rb(0) + dd1*2*r(0)*temp499b
      distpb(0, 1) = distpb(0, 1) + dd1*temp499b0
      CALL POPREAL8(adr8ibuf,adr8buf,distp(indt+3, 1))
      tmp1b = distpb(indt+3, 1)
      distpb(indt+3, 1) = 0.0_8
      temp499b1 = -(2.0d0*distp(0, 1)*tmp1b)
      distpb(0, 1) = distpb(0, 1) - 2.0d0*dd1*rmu(3, 0)*tmp1b
      CALL POPREAL8(adr8ibuf,adr8buf,distp(indt+2, 1))
      tmp0b = distpb(indt+2, 1)
      distpb(indt+2, 1) = 0.0_8
      temp499b2 = -(2.0d0*distp(0, 1)*tmp0b)
      distpb(0, 1) = distpb(0, 1) - 2.0d0*dd1*rmu(2, 0)*tmp0b
      CALL POPREAL8(adr8ibuf,adr8buf,distp(indt+1, 1))
      tmpb = distpb(indt+1, 1)
      temp499b3 = -(2.0d0*distp(0, 1)*tmpb)
      dd1b = dd1b + rmu(2, 0)*temp499b2 + rmu(1, 0)*temp499b3 + rmu(3, 0&
&        )*temp499b1
      rmub(3, 0) = rmub(3, 0) + dd1*temp499b1
      rmub(2, 0) = rmub(2, 0) + dd1*temp499b2
      distpb(indt+1, 1) = 0.0_8
      rmub(1, 0) = rmub(1, 0) + dd1*temp499b3
      distpb(0, 1) = distpb(0, 1) - 2.0d0*dd1*rmu(1, 0)*tmpb
    END IF
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      DO ii=0,iopt-90,1
        CALL POPINTEGER4(adi4ibuf,adi4buf,ad_from0)
        DO jj=0,ad_from0,1
          CALL POPINTEGER4(adi4ibuf,adi4buf,count)
          zb(indorbp+count, indt+4) = zb(indorbp+count, indt+4)/DSQRT(&
&            rp1)
          zb(indorbp+count, indt+3) = zb(indorbp+count, indt+3)/DSQRT(&
&            rp1)
          zb(indorbp+count, indt+2) = zb(indorbp+count, indt+2)/DSQRT(&
&            rp1)
          zb(indorbp+count, indt+1) = zb(indorbp+count, indt+1)/DSQRT(&
&            rp1)
          CALL POPREAL8(adr8ibuf,adr8buf,rp1)
          zb(indorbp+count, indt+4) = zb(indorbp+count, indt+4)/DSQRT(&
&            rp1)
          zb(indorbp+count, indt+3) = zb(indorbp+count, indt+3)/DSQRT(&
&            rp1)
          zb(indorbp+count, indt+2) = zb(indorbp+count, indt+2)/DSQRT(&
&            rp1)
          zb(indorbp+count, indt+1) = zb(indorbp+count, indt+1)/DSQRT(&
&            rp1)
          CALL POPREAL8(adr8ibuf,adr8buf,rp1)
          zb(indorbp+count, indt+4) = zb(indorbp+count, indt+4)/DSQRT(&
&            rp1)
          zb(indorbp+count, indt+3) = zb(indorbp+count, indt+3)/DSQRT(&
&            rp1)
          zb(indorbp+count, indt+2) = zb(indorbp+count, indt+2)/DSQRT(&
&            rp1)
          zb(indorbp+count, indt+1) = zb(indorbp+count, indt+1)/DSQRT(&
&            rp1)
          CALL POPREAL8(adr8ibuf,adr8buf,rp1)
          zb(indorbp+count, indt+4) = 0.0_8
          zb(indorbp+count, indt+3) = 0.0_8
          zb(indorbp+count, indt+2) = 0.0_8
          zb(indorbp+count, indt+1) = 0.0_8
        END DO
      END DO
    END IF
    DO k=indtm,i0,-1
      DO ii=0,iopt-90,1
        CALL POPINTEGER4(adi4ibuf,adi4buf,ad_from)
        DO jj=0,ad_from,1
          CALL POPINTEGER4(adi4ibuf,adi4buf,count)
          zb(indorbp+count, k) = zb(indorbp+count, k)/DSQRT(rp1)
          CALL POPREAL8(adr8ibuf,adr8buf,rp1)
          zb(indorbp+count, k) = zb(indorbp+count, k)/DSQRT(rp1)
          CALL POPREAL8(adr8ibuf,adr8buf,rp1)
          zb(indorbp+count, k) = zb(indorbp+count, k)/DSQRT(rp1)
          CALL POPREAL8(adr8ibuf,adr8buf,rp1)
          zb(indorbp+count, k) = 0.0_8
        END DO
      END DO
    END DO
    cb = 0.0_8
    DO k=indtm,i0,-1
      temp498 = r(k)**2
      temp498b = c*DEXP(-(dd1*temp498))*distpb(k, 1)
      dd1b = dd1b - temp498*temp498b
      rb(k) = rb(k) - dd1*2*r(k)*temp498b
      cb = cb + DEXP(-(dd1*temp498))*distpb(k, 1)
      distpb(k, 1) = 0.0_8
    END DO
    CALL POPINTEGER4(adi4ibuf,adi4buf,branch)
    IF (.NOT.branch .LT. 1) THEN
      CALL POPREAL8(adr8ibuf,adr8buf,c)
      temp497 = (iopt-90)/2.0_8
      IF (.NOT.(8_4*dd1 .LE. 0.0 .AND. (temp497 .EQ. 0.0 .OR. temp497 &
&          .NE. INT(temp497)))) dd1b = dd1b + c*temp497*(8_4*dd1)**(&
&          temp497-1)*8_4*cb
      cb = (8_4*dd1)**temp497*cb
    END IF
    dd1b = dd1b + 0.712705470354990_8*0.75_8*dd1**(-0.242)*cb
    DO ii=iopt-90,1,-1
      DO k=indtm,indtmin,-1
        CALL POPREAL8(adr8ibuf,adr8buf,powers(3, ii, k))
        powersb(3, ii-1, k) = powersb(3, ii-1, k) + rmu(3, k)*powersb(3&
&          , ii, k)
        rmub(3, k) = rmub(3, k) + powers(3, ii-1, k)*powersb(3, ii, k)
        powersb(3, ii, k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,powers(2, ii, k))
        powersb(2, ii-1, k) = powersb(2, ii-1, k) + rmu(2, k)*powersb(2&
&          , ii, k)
        rmub(2, k) = rmub(2, k) + powers(2, ii-1, k)*powersb(2, ii, k)
        powersb(2, ii, k) = 0.0_8
        CALL POPREAL8(adr8ibuf,adr8buf,powers(1, ii, k))
        powersb(1, ii-1, k) = powersb(1, ii-1, k) + rmu(1, k)*powersb(1&
&          , ii, k)
        rmub(1, k) = rmub(1, k) + powers(1, ii-1, k)*powersb(1, ii, k)
        powersb(1, ii, k) = 0.0_8
      END DO
    END DO
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (117) 
!     2s double lorentian with constant  parent of 102
!     (dd3+r^3/(1+dd5*r)^4;
    dd5 = dd(indpar+2)
    indorbp = indorb + 1
!              write(6,*) ' function inside = ',z(indorbp,i)
!           endif
    IF (typec .NE. 1) THEN
      fun = -(r(0)*(-3.d0+dd5*r(0))/(1.d0+dd5*r(0))**5)
      fun2b = zb(indorbp, indt+4)
      funb0 = 2.d0*zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      temp507 = (dd5*r(0)+1.d0)**6
      temp506 = r(0)/temp507
      temp507b = 2.d0*temp506*fun2b
      temp507b0 = 2*dd5*r(0)*temp507b
      temp506b = 2.d0*((dd5*r(0))**2-6.d0*(dd5*r(0))+3.d0)*fun2b/temp507
      temp506b0 = -(temp506*6*(dd5*r(0)+1.d0)**5*temp506b)
      temp505 = (dd5*r(0)+1.d0)**5
      temp505b = -(funb0/temp505)
      temp505b0 = -(r(0)*(dd5*r(0)-3.d0)*5*(dd5*r(0)+1.d0)**4*temp505b/&
&        temp505)
      dd5b = r(0)**2*temp505b + r(0)*temp505b0 + r(0)*temp506b0 - 6.d0*r&
&        (0)*temp507b + r(0)*temp507b0
      rb(0) = rb(0) + (r(0)*dd5+dd5*r(0)-3.d0)*temp505b + dd5*temp505b0 &
&        + dd5*temp506b0 + temp506b - 6.d0*dd5*temp507b + dd5*temp507b0
    ELSE
      dd5b = 0.0_8
    END IF
    distpb = 0.0_8
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      dd3b = dd3b + zb(indorbp, i)
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp503 = dd5*r(k) + 1.d0
      temp504 = temp503**4
      temp503b = -(r(k)**3*4*temp503**3*distpb(k, 1)/temp504**2)
      rb(k) = rb(k) + dd5*temp503b + 3*r(k)**2*distpb(k, 1)/temp504
      dd5b = dd5b + r(k)*temp503b
      distpb(k, 1) = 0.0_8
    END DO
    ddb(indpar+2) = ddb(indpar+2) + dd5b
    ddb(indpar+1) = ddb(indpar+1) + dd3b
  CASE (50) 
! R(r)=(c0*r**4+c1*r**3)*exp(-z1*r)
!
!       if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
    c = DSQRT((2*dd1)**9/40320.d0/pi)/2.d0
!           endif
    c0 = -c
    c1 = 4.5d0*c/dd1
    DO k=indtmin,indtm
      distp(k, 1) = r(k)*DEXP(-(dd1*r(k)))
    END DO
    IF (typec .NE. 1) THEN
      rp1 = r(0)*dd1
      rp2 = rp1*rp1
!c              the first derivative/r
      fun = -(distp(0, 1)*(c0*r(0)*(rp1-4.d0)+c1*(rp1-3.d0)))
!c
!c              the second derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp511 = rp2 - 8.d0*rp1 + 12.d0
      temp510 = c0*r(0)
      temp510b0 = distp(0, 1)*fun2b
      distpb(0, 1) = (temp510*temp511+c1*(rp2-6*rp1+6.d0))*fun2b - (c0*r&
&        (0)*(rp1-4.d0)+c1*(rp1-3.d0))*funb0
      temp510b1 = -(distp(0, 1)*funb0)
      c0b = (rp1-4.d0)*r(0)*temp510b1 + temp511*r(0)*temp510b0
      rp2b = (c1+temp510)*temp510b0
      rp1b = (c1+c0*r(0))*temp510b1 + 2*rp1*rp2b + ((-6)*c1-temp510*8.d0&
&        )*temp510b0
      rb(0) = rb(0) + (rp1-4.d0)*c0*temp510b1 + dd1*rp1b + temp511*c0*&
&        temp510b0
      c1b = (rp1-3.d0)*temp510b1 + (rp2-6*rp1+6.d0)*temp510b0
      dd1b = r(0)*rp1b
    ELSE
      distpb = 0.0_8
      c0b = 0.0_8
      c1b = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp510b = distp(i, 1)*zb(indorbp, i)
      temp509 = r(i)**3
      c0b = c0b + temp509*temp510b
      rb(i) = rb(i) + (c1*2*r(i)+c0*3*r(i)**2)*temp510b
      c1b = c1b + r(i)**2*temp510b
      distpb(i, 1) = distpb(i, 1) + (c0*temp509+c1*r(i)**2)*zb(indorbp, &
&        i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      temp509b0 = r(k)*DEXP(-(dd1*r(k)))*distpb(k, 1)
      rb(k) = rb(k) + DEXP(-(dd1*r(k)))*distpb(k, 1) - dd1*temp509b0
      dd1b = dd1b - r(k)*temp509b0
      distpb(k, 1) = 0.0_8
    END DO
    temp509b = 4.5d0*c1b/dd1
    cb = temp509b - c0b
    temp508 = 2**9
    IF (temp508*(dd1**9/(40320.d0*pi)) .EQ. 0.0) THEN
      dd1b = dd1b - c*temp509b/dd1
    ELSE
      dd1b = dd1b + temp508*9*dd1**8*cb/(2.d0*2.D0*DSQRT(temp508*(dd1**9&
&        /(40320.d0*pi)))*40320.d0*pi) - c*temp509b/dd1
    END IF
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (3) 
!
!
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
    dd2 = dd(indpar+2)
    peff = dd(indpar+3)
!           if(iflagnorm.gt.2) then
    c = 1.d0/2.d0/DSQRT(2.d0*pi*(1.d0/(2.d0*dd1)**3+2.d0*peff/(dd1+dd2)&
&      **3+peff**2/(2.d0*dd2)**3))
    ad_from3 = indpar + 1
!           endif
    DO i=ad_from3,indpar+2
      DO k=indtmin,indtm
        distp(k, i-indpar) = c*DEXP(-(dd(i)*r(k)))
      END DO
    END DO
    CALL PUSHINTEGER4(adi4ibuf,adi4buf,i - 1)
    CALL PUSHINTEGER4(adi4ibuf,adi4buf,ad_from3)
    IF (typec .NE. 1) THEN
      fun = -(dd1*distp(0, 1)) - peff*dd2*distp(0, 2)
      distpb = 0.0_8
      temp521 = dd1/r(0)
      temp521b = -(distp(0, 1)*2.d0*zb(indorbp, indt+4)/r(0))
      temp521b0 = peff*distp(0, 2)*zb(indorbp, indt+4)
      temp520 = dd2/r(0)
      temp520b = -(2.d0*temp521b0/r(0))
      temp520b0 = (dd2**2-2.d0*temp520)*zb(indorbp, indt+4)
      dd1b = temp521b + distp(0, 1)*2*dd1*zb(indorbp, indt+4)
      rb(0) = rb(0) - temp520*temp520b - temp521*temp521b
      distpb(0, 1) = (dd1**2-2.d0*temp521)*zb(indorbp, indt+4)
      dd2b = temp520b + 2*dd2*temp521b0
      peffb = distp(0, 2)*temp520b0
      distpb(0, 2) = peff*temp520b0
      zb(indorbp, indt+4) = 0.0_8
      funb0 = 0.0_8
      DO i=3,1,-1
        temp519 = fun/r(0)
        temp519b = rmu(i, 0)*zb(indorbp, indt+i)/r(0)
        rmub(i, 0) = rmub(i, 0) + temp519*zb(indorbp, indt+i)
        funb0 = funb0 + temp519b
        rb(0) = rb(0) - temp519*temp519b
        zb(indorbp, indt+i) = 0.0_8
      END DO
      dd1b = dd1b - distp(0, 1)*funb0
      distpb(0, 1) = distpb(0, 1) - dd1*funb0
      peffb = peffb - distp(0, 2)*dd2*funb0
      dd2b = dd2b - distp(0, 2)*peff*funb0
      distpb(0, 2) = distpb(0, 2) - peff*dd2*funb0
    ELSE
      distpb = 0.0_8
      peffb = 0.0_8
      dd1b = 0.0_8
      dd2b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      peffb = peffb + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + peff*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    cb = 0.0_8
    CALL POPINTEGER4(adi4ibuf,adi4buf,ad_from3)
    CALL POPINTEGER4(adi4ibuf,adi4buf,ad_to)
    DO i=ad_to,ad_from3,-1
      DO k=indtm,indtmin,-1
        temp518 = -(dd(i)*r(k))
        temp518b = c*DEXP(temp518)*distpb(k, i-indpar)
        cb = cb + DEXP(temp518)*distpb(k, i-indpar)
        ddb(i) = ddb(i) - r(k)*temp518b
        rb(k) = rb(k) - dd(i)*temp518b
        distpb(k, i-indpar) = 0.0_8
      END DO
    END DO
    temp517 = 2.d0**3*dd2**3
    temp516 = peff**2/temp517
    temp515 = (dd1+dd2)**3
    temp514 = 2.d0**3*dd1**3
    temp513 = 2.d0*pi*(1.0/temp514+2.d0*peff/temp515+temp516)
    temp512 = DSQRT(temp513)
    IF (temp513 .EQ. 0.0) THEN
      temp512b = 0.0
    ELSE
      temp512b = -(pi*cb/(temp512**2*2.D0*DSQRT(temp513)))
    END IF
    temp512b0 = 2.d0*temp512b/temp515
    temp512b1 = -(peff*3*(dd1+dd2)**2*temp512b0/temp515)
    dd1b = dd1b + temp512b1 - 2.d0**3*3*dd1**2*temp512b/temp514**2
    peffb = peffb + 2*peff*temp512b/temp517 + temp512b0
    dd2b = dd2b + temp512b1 - temp516*2.d0**3*3*dd2**2*temp512b/temp517
    ddb(indpar+3) = ddb(indpar+3) + peffb
    ddb(indpar+2) = ddb(indpar+2) + dd2b
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE (124) 
! 2s 2pz Hybryd single Z
!     2s double exp  with constant and cusp cond.
!     (dd3+ exp (-dd2 r)*(1+dd2*r)+dd4*exp(-dd5*r)*(1+dd5*r))
    dd2 = dd(indpar+1)
    dd4 = dd(indpar+3)
    dd5 = dd(indpar+4)
    indorbp = indorb + 1
    DO k=indtmin,indtm
      distp(k, 3) = DEXP(-(dd2*r(k)))
      distp(k, 4) = DEXP(-(dd5*r(k)))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(k, 1))
      distp(k, 1) = distp(k, 3)*(1.d0+dd2*r(k))
      CALL PUSHREAL8(adr8ibuf,adr8buf,distp(k, 2))
      distp(k, 2) = distp(k, 4)*(1.d0+dd5*r(k))
    END DO
!              write(6,*) ' function inside = ',z(indorbp,i)
!           endif
    IF (typec .NE. 1) THEN
      fun = -(dd2**2*distp(0, 3)) - dd5**2*dd4*distp(0, 4)
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp522b3 = -((1.d0-dd2*r(0))*fun2b)
      temp522b4 = -(dd2**2*distp(0, 3)*fun2b)
      temp522b5 = -((1.d0-dd5*r(0))*fun2b)
      temp522b6 = dd5**2*temp522b5
      temp522b7 = -(dd5**2*dd4*distp(0, 4)*fun2b)
      dd2b = distp(0, 3)*2*dd2*temp522b3 - r(0)*temp522b4 - distp(0, 3)*&
&        2*dd2*funb0
      distpb(0, 3) = dd2**2*temp522b3
      rb(0) = rb(0) - dd5*temp522b7 - dd2*temp522b4
      dd5b = dd4*distp(0, 4)*2*dd5*temp522b5 - r(0)*temp522b7 - dd4*&
&        distp(0, 4)*2*dd5*funb0
      temp522b8 = -(dd5**2*funb0)
      dd4b = distp(0, 4)*temp522b8 + distp(0, 4)*temp522b6
      distpb(0, 4) = dd4*temp522b6
      distpb(0, 3) = distpb(0, 3) - dd2**2*funb0
      distpb(0, 4) = distpb(0, 4) + dd4*temp522b8
    ELSE
      distpb = 0.0_8
      dd2b = 0.0_8
      dd4b = 0.0_8
      dd5b = 0.0_8
    END IF
    dd3b = 0.0_8
    DO i=indtm,i0,-1
      distpb(i, 1) = distpb(i, 1) + zb(indorbp, i)
      dd3b = dd3b + zb(indorbp, i)
      dd4b = dd4b + distp(i, 2)*zb(indorbp, i)
      distpb(i, 2) = distpb(i, 2) + dd4*zb(indorbp, i)
      zb(indorbp, i) = 0.0_8
    END DO
    DO k=indtm,indtmin,-1
      CALL POPREAL8(adr8ibuf,adr8buf,distp(k, 2))
      temp522b = distp(k, 4)*distpb(k, 2)
      distpb(k, 4) = distpb(k, 4) + (dd5*r(k)+1.d0)*distpb(k, 2)
      distpb(k, 2) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,distp(k, 1))
      temp522b0 = distp(k, 3)*distpb(k, 1)
      distpb(k, 3) = distpb(k, 3) + (dd2*r(k)+1.d0)*distpb(k, 1)
      distpb(k, 1) = 0.0_8
      temp522b1 = DEXP(-(dd5*r(k)))*distpb(k, 4)
      dd5b = dd5b + r(k)*temp522b - r(k)*temp522b1
      distpb(k, 4) = 0.0_8
      temp522b2 = DEXP(-(dd2*r(k)))*distpb(k, 3)
      rb(k) = rb(k) + dd2*temp522b0 - dd2*temp522b2 - dd5*temp522b1 + &
&        dd5*temp522b
      dd2b = dd2b + r(k)*temp522b0 - r(k)*temp522b2
      distpb(k, 3) = 0.0_8
    END DO
    ddb(indpar+4) = ddb(indpar+4) + dd5b
    ddb(indpar+3) = ddb(indpar+3) + dd4b
    ddb(indpar+2) = ddb(indpar+2) + dd3b
    ddb(indpar+1) = ddb(indpar+1) + dd2b
  CASE (28) 
! R(r)=(Z*b*r)^4/(1+(Z*b*r)^4)*exp(-z*r)     orbital 1s (no cusp)
! d -> b1s (defined in module constants)
! normadization: cost1s, depends on b1s
!        if(iocc(indshellp).eq.1) then
    indorbp = indorb + 1
    dd1 = dd(indpar+1)
!           if(iflagnorm.gt.2) then
!             if(dd1.gt.0.) then
    c = cost1s*dd1**1.5d0
!             else
!               c=1.d0
!             endif
!           endif
    DO i=indtmin,indtm
      distp(i, 1) = c*DEXP(-(dd1*r(i)))
    END DO
    DO i=i0,indtm
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = (dd1*b1s*r(i))**4
    END DO
    IF (typec .NE. 1) THEN
      rp1 = dd1*b1s*r(0)
      rp2 = rp1**2
      CALL PUSHREAL8(adr8ibuf,adr8buf,rp4)
      rp4 = rp2**2
      rp5 = r(0)*dd1
      rp6 = (b1s*dd1)**2*rp2
!              the first derivative /r
      fun = -(distp(0, 1)*rp6*(-4.d0+rp5+rp4*rp5)/(1.d0+rp4)**2)
!              the second derivative derivative
      funb0 = 2.d0*zb(indorbp, indt+4)
      fun2b = zb(indorbp, indt+4)
      zb(indorbp, indt+4) = 0.0_8
      DO i=3,1,-1
        funb0 = funb0 + rmu(i, 0)*zb(indorbp, indt+i)
        rmub(i, 0) = rmub(i, 0) + fun*zb(indorbp, indt+i)
        zb(indorbp, indt+i) = 0.0_8
      END DO
      distpb = 0.0_8
      temp526 = (rp4+1.d0)**3
      temp525 = distp(0, 1)*rp6/temp526
      temp526b = temp525*fun2b
      temp526b0 = 2*rp4*rp5*temp526b
      temp525b = (rp5**2-8*rp5-20*rp4+2*(rp4*rp5**2)-8*(rp4*rp5)+(rp4*&
&        rp5)**2+12.d0)*fun2b/temp526
      temp524 = (rp4+1.d0)**2
      temp523 = distp(0, 1)*rp6/temp524
      temp523b = -(temp523*funb0)
      rp5b = (rp4+1.0_8)*temp523b + rp4*temp526b0 + (2**2*rp4*rp5-8*rp4+&
&        2*rp5-8)*temp526b
      temp523b0 = -((rp5+rp4*rp5-4.d0)*funb0/temp524)
      rp4b = rp5*temp523b - temp523*2*(rp4+1.d0)*temp523b0 - temp525*3*(&
&        rp4+1.d0)**2*temp525b + rp5*temp526b0 + (2*rp5**2-8*rp5-20)*&
&        temp526b
      distpb(0, 1) = rp6*temp523b0 + rp6*temp525b
      rp6b = distp(0, 1)*temp523b0 + distp(0, 1)*temp525b
      temp523b1 = b1s**2*rp6b
      rp2b = 2*rp2*rp4b + dd1**2*temp523b1
      rp1b = 2*rp1*rp2b
      dd1b = r(0)*rp5b + b1s*r(0)*rp1b + rp2*2*dd1*temp523b1
      rb(0) = rb(0) + b1s*dd1*rp1b + dd1*rp5b
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
    ELSE
      distpb = 0.0_8
      dd1b = 0.0_8
    END IF
    DO i=indtm,i0,-1
      temp522 = rp4/(rp4+1.d0)
      temp522b10 = distp(i, 1)*zb(indorbp, i)/(rp4+1.d0)
      distpb(i, 1) = distpb(i, 1) + temp522*zb(indorbp, i)
      rp4b = (1.0_8-temp522)*temp522b10
      zb(indorbp, i) = 0.0_8
      CALL POPREAL8(adr8ibuf,adr8buf,rp4)
      temp522b11 = 4*b1s**4*dd1**3*r(i)**3*rp4b
      dd1b = dd1b + r(i)*temp522b11
      rb(i) = rb(i) + dd1*temp522b11
    END DO
    cb = 0.0_8
    DO i=indtm,indtmin,-1
      temp522b9 = c*DEXP(-(dd1*r(i)))*distpb(i, 1)
      cb = cb + DEXP(-(dd1*r(i)))*distpb(i, 1)
      dd1b = dd1b - r(i)*temp522b9
      rb(i) = rb(i) - dd1*temp522b9
      distpb(i, 1) = 0.0_8
    END DO
    dd1b = dd1b + cost1s*1.5d0*dd1**0.5D0*cb
    ddb(indpar+1) = ddb(indpar+1) + dd1b
  CASE DEFAULT
    distpb = 0.0_8
  END SELECT
END SUBROUTINE MAKEFUN_B
