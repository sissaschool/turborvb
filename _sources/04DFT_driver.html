<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Initializations of Wavefunctions &mdash; TurboRVB userguides Updated on 26/06/2023 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/my_theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/roles.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Wavefunction conversions" href="05conversions.html" />
    <link rel="prev" title="Wavefunction" href="03wavefunction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            TurboRVB userguides
          </a>
              <div class="version">
                Updated on 26/06/2023
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01nutshell.html">TurboRVB in a nutshell</a></li>
<li class="toctree-l1"><a class="reference internal" href="03wavefunction.html">Wavefunction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Initializations of Wavefunctions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#external-quantum-chemistry-and-dft-codes-gaussian-gamess-and-pyscf">External quantum chemistry and DFT codes (Gaussian, GAMESS, and pySCF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#built-in-dft-code-prep-x">Built-in DFT code (prep.x)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simulation-section">Simulation section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pseudo-section">Pseudo section</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#optimization-section">Optimization section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#readio-section">Readio section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters-section">Parameters section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#molecule-section">Molecule section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kpoints-section">Kpoints section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dft-section">DFT section</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="05conversions.html">Wavefunction conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="06qmc_driver.html">Quantum Monte Carlo calculations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TurboRVB userguides</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Initializations of Wavefunctions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/04DFT_driver.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="initializations-of-wavefunctions">
<h1>Initializations of Wavefunctions<a class="headerlink" href="#initializations-of-wavefunctions" title="Permalink to this heading">¶</a></h1>
<section id="external-quantum-chemistry-and-dft-codes-gaussian-gamess-and-pyscf">
<h2>External quantum chemistry and DFT codes (Gaussian, GAMESS, and pySCF)<a class="headerlink" href="#external-quantum-chemistry-and-dft-codes-gaussian-gamess-and-pyscf" title="Permalink to this heading">¶</a></h2>
<p>You can use external quantum chemistry and DFT codes such as Gaussian, GAMESS, and pySCF to generate a trail wavefunction. Please refer to the TurboGenius tutorial [<a class="reference external" href="https://github.com/kousuke-nakano/turbotutorials">https://github.com/kousuke-nakano/turbotutorials</a>].</p>
</section>
<section id="built-in-dft-code-prep-x">
<h2>Built-in DFT code (prep.x)<a class="headerlink" href="#built-in-dft-code-prep-x" title="Permalink to this heading">¶</a></h2>
<p>In this section, we describe the INPUT file that controls DFT calculation. The input file is built using Fortran namelists. Keywords are divided into different sections according to their meanings.</p>
<section id="simulation-section">
<h3>Simulation section<a class="headerlink" href="#simulation-section" title="Permalink to this heading">¶</a></h3>
<p>The sections and the main parameters are listed and shortly described in the following. Keywords that are not required can be omitted in the input file: they will assume a default value.</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Simulation section</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>itest4</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">itest4</span> <span class="pre">=</span> <span class="pre">-4</span></code>: Standard DFT run.
<code class="docutils literal notranslate"><span class="pre">itest4</span> <span class="pre">=</span> <span class="pre">-8</span></code>: DFT calculation with twice larger
basis for the Hartree potential.</p></td>
</tr>
<tr class="row-odd"><td><p>iopt</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">iopt</span> <span class="pre">=</span> <span class="pre">1</span></code>: Initialize with no potential (no
Hartree, xc, correlation).
<code class="docutils literal notranslate"><span class="pre">iopt</span> <span class="pre">=</span> <span class="pre">0</span></code>: Continuation, starting from
wavefunctions read from <code class="docutils literal notranslate"><span class="pre">fort.10_new</span></code> and
occupation read from <code class="docutils literal notranslate"><span class="pre">occupationlevels.dat</span></code> (both
generated after <code class="docutils literal notranslate"><span class="pre">iopt</span> <span class="pre">=</span> <span class="pre">1</span></code> run).
<code class="docutils literal notranslate"><span class="pre">iopt</span> <span class="pre">=</span> <span class="pre">2</span></code>: Same as <code class="docutils literal notranslate"><span class="pre">iopt</span> <span class="pre">=</span> <span class="pre">0</span></code>, but write main
matrices (basis set/Hamiltonian overlaps, charge/spin
density).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="pseudo-section">
<h3>Pseudo section<a class="headerlink" href="#pseudo-section" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Pseudo section (summary)</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nintpsa</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Number of integer points for pseudopotential if present.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pseudorandom</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Use a random integration mesh for pseudo with the algorithm for QMC
by R. Fahy.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">npsamax</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Multiplication factor for the number of pseudo integration points.
Note that, use <code class="docutils literal notranslate"><span class="pre">npsmax</span> <span class="pre">&gt;</span> <span class="pre">2</span></code> if the code terminates with the error
‘Increase npsamax’.</p></td>
</tr>
</tbody>
</table>
<section id="optimization-section">
<h4>Optimization section<a class="headerlink" href="#optimization-section" title="Permalink to this heading">¶</a></h4>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Optimization section</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">molopt</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Do not change this value, as DFT works with
molecular orbitals only.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="readio-section">
<h4>Readio section<a class="headerlink" href="#readio-section" title="Permalink to this heading">¶</a></h4>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Readio section</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>parameter name</p></th>
<th class="head"><p>datatype</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>writescratch</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">writescratch</span> <span class="pre">=</span> <span class="pre">0</span></code>: Writes binary scratch files on disk to speed up continuation and allow non-self-consistent calculations and post-processing tools. The following files are written:</p>
<ul class="simple">
<li><p><strong>tmp000xxx:</strong> One for each processor. These files contain basis/Hamiltonian overlap matrix elements in the first record. In the second record, they contain charge/spin density distributed matrices.</p></li>
<li><p><strong>total_densities.sav:</strong> A single file containing the total (i.e., not distributed over the real space integration grid) charge density in the first record and the total spin density in the second record (in the case of LSDA calculations).</p></li>
<li><p><strong>wavefunction.sav:</strong> A single file containing the final Kohn-Sham eigenvectors for all the bands. If k-points are present, each record contains the eigenvectors for a single k-point in the order as they appear in the <strong>occupationlevels.dat</strong> file.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">writescratch</span> <span class="pre">=</span> <span class="pre">1</span></code>: Does not write any scratch file on disk. Continuing from previous runs and non-self-consistent calculations will not be possible.</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="parameters-section">
<h4>Parameters section<a class="headerlink" href="#parameters-section" title="Permalink to this heading">¶</a></h4>
<table class="docutils align-default" id="id5">
<caption><span class="caption-text">Parameters section</span><a class="headerlink" href="#id5" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">decoupled_run</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">.true.</span></code> the code starts a k-independent calculation. When k-points are activated, this option allows performing an
independent self-consistent cycle for each k-point without performing the k-points average of electronic density. To be used
before a twist average calculation in QMC.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yes_kpoints</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Set it to <code class="docutils literal notranslate"><span class="pre">.true.</span></code> if you plan to do a calculation with k-points sampling. In this case, the phase of the wavefunction
fort.10 is disregarded.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">epsbas</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Real space cutoff for the periodic basis set (keyword PBC_C in the first record of the wave function fort.10). Note that, if
DFT energy is different from what is expected, then try decreasing the cutoff.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="molecule-section">
<h4>Molecule section<a class="headerlink" href="#molecule-section" title="Permalink to this heading">¶</a></h4>
<table class="docutils align-default" id="id6">
<caption><span class="caption-text">Molecule section</span><a class="headerlink" href="#id6" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>parameter name</p></th>
<th class="head"><p>datatype</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>nx</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Number of lattice points for the real space integration grid in the <span class="math">x</span> direction. By default, <code class="docutils literal notranslate"><span class="pre">nx</span> <span class="pre">=</span> <span class="pre">ny</span> <span class="pre">=</span> <span class="pre">nz</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ax</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Space (a.u.) for an open system in the <span class="math">x</span> direction; for periodic systems, it is chosen as the cell parameter in the same direction and need not be specified. By default, <code class="docutils literal notranslate"><span class="pre">ax</span> <span class="pre">=</span> <span class="pre">ay</span> <span class="pre">=</span> <span class="pre">az</span></code></p></td>
</tr>
<tr class="row-even"><td><p>nbufd</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Input value for the buffer dimension. Note that, in the complex code, the buffer dimension is automatically doubled. In this case, consider decreasing the buffer dimension if you have a memory problem.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="kpoints-section">
<h4>Kpoints section<a class="headerlink" href="#kpoints-section" title="Permalink to this heading">¶</a></h4>
<table class="docutils align-default" id="id7">
<caption><span class="caption-text">Kpoints section</span><a class="headerlink" href="#id7" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>parameter name</p></th>
<th class="head"><p>datatype</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>kp_type</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>This integer specifies the type of k-points which will be chosen in the calculation.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">kp_type</span> <span class="pre">=</span> <span class="pre">0</span></code>: Do not perform any k-points sampling and use the phase specified in the <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> as the unique k-point.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">kp_type</span> <span class="pre">=</span> <span class="pre">1</span></code>: Use the Monkhorst-Pack algorithm to generate equally-spaced k-points in the first Brillouin zone. The size of the grid in the three Cartesian directions is determined by the integers <code class="docutils literal notranslate"><span class="pre">nk1,</span> <span class="pre">nk2,</span> <span class="pre">nk3</span></code>. Note that <code class="docutils literal notranslate"><span class="pre">nk1</span></code> must be set to a value &gt; 0. If <code class="docutils literal notranslate"><span class="pre">nk2,</span> <span class="pre">nk3</span></code> are not set, then they are taken to be equal to <code class="docutils literal notranslate"><span class="pre">nk1</span></code>. Also, if skip_equivalence (see below) is set to <code class="docutils literal notranslate"><span class="pre">.false.</span></code> the number of k-points might be reduced.</dt><dd><p>In this case, run the tool <code class="docutils literal notranslate"><span class="pre">find_kpoints.x</span></code> with the desired input in order to know how many processors must be allocated.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kp_type</span> <span class="pre">=</span> <span class="pre">2</span></code>: When this is used, k-points are set by the user and their number is specified by the integer <code class="docutils literal notranslate"><span class="pre">nk1</span></code>. In this case, the section <strong>KPOINTS</strong> is needed (see below).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kp_type</span> <span class="pre">=</span> <span class="pre">3</span></code>: Generates k-points path along high-symmetry lines in the first Brillouin zone. The initial and final points of these segments are specified in the section <strong>KPOINTS</strong> (see below). The number of extremal points is specified by the integer <code class="docutils literal notranslate"><span class="pre">nk1</span></code> and the number of points in each segment is specified by the integer <code class="docutils literal notranslate"><span class="pre">nk2</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kp_type</span> <span class="pre">=</span> <span class="pre">4</span></code>: Generate k-points randomly within the first Brillouin zone. The number of k-points is specified by <code class="docutils literal notranslate"><span class="pre">nk1</span></code>. <strong>KPOINTS</strong> section is not needed.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>nk1, nk2, nk3</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Meanings depend on the value of <code class="docutils literal notranslate"><span class="pre">kp_type</span></code>, see above for a detailed explanation.</p></td>
</tr>
<tr class="row-even"><td><p>k1, k2, k3</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>For <code class="docutils literal notranslate"><span class="pre">kp_type</span> <span class="pre">=</span> <span class="pre">1</span></code>, set <code class="docutils literal notranslate"><span class="pre">k1,</span> <span class="pre">k2,</span> <span class="pre">k3</span></code> equal to 1 in order to apply an offset to the k-point grid generated by the Monkhorst-Pack algorithm. In some cases, this can help to reach</p></td>
</tr>
</tbody>
</table>
<p>Additional information:</p>
<ul>
<li><p>Monkhorst-Pack mesh:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="p">&amp;</span>kpoints
<span class="nv">kp_type</span><span class="o">=</span><span class="m">1</span>
<span class="nv">nk1</span><span class="o">=</span><span class="m">4</span>
<span class="nv">nk2</span><span class="o">=</span><span class="m">4</span>
<span class="nv">nk3</span><span class="o">=</span><span class="m">4</span>
<span class="nv">skip_equivalence</span><span class="o">=</span>.false.
<span class="nv">double_kpgrid</span><span class="o">=</span>.true.
</pre></div>
</div>
</li>
<li><p>User-defined k-points are written in the following manner.
<code class="docutils literal notranslate"><span class="pre">wkp(i)</span></code> denotes the weight corresponding to the kpoint
<code class="docutils literal notranslate"><span class="pre">xkp(:,i)</span></code> if the total weight is different from one.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wkp<span class="o">(</span>i<span class="o">)</span><span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>weight<span class="w"> </span>corresponding<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>the<span class="w"> </span>kpoint<span class="w"> </span>xkp<span class="o">(</span>:,i<span class="o">)</span>.
!<span class="w"> </span>NB:<span class="w"> </span><span class="k">if</span><span class="w"> </span>the<span class="w"> </span>total<span class="w"> </span>weight<span class="w"> </span>is<span class="w"> </span>different<span class="w"> </span>from<span class="w"> </span>on
!<span class="w"> </span>xkp<span class="o">(</span><span class="m">1</span>,1<span class="o">)</span><span class="w"> </span>xkp<span class="o">(</span><span class="m">2</span>,1<span class="o">)</span><span class="w"> </span>xkp<span class="o">(</span><span class="m">3</span>,1<span class="o">)</span><span class="w"> </span>wkp<span class="o">(</span><span class="m">1</span><span class="o">)</span>
!<span class="w"> </span>xkp<span class="o">(</span><span class="m">1</span>,2<span class="o">)</span><span class="w"> </span>xkp<span class="o">(</span><span class="m">2</span>,2<span class="o">)</span><span class="w"> </span>xkp<span class="o">(</span><span class="m">3</span>,2<span class="o">)</span><span class="w"> </span>wkp<span class="o">(</span><span class="m">2</span><span class="o">)</span>
!<span class="w"> </span>......
KPOINTS
<span class="m">0</span>.1667<span class="w"> </span><span class="m">0</span>.1667<span class="w"> </span><span class="m">0</span>.5000<span class="w">  </span><span class="m">0</span>.5
<span class="m">0</span>.5000<span class="w"> </span><span class="m">0</span>.5000<span class="w"> </span><span class="m">0</span>.5000<span class="w">  </span><span class="m">0</span>.5
<span class="c1"># blank line and after k-points for spin down electrons</span>
-0.1667<span class="w"> </span>-0.1667<span class="w"> </span>-0.5000<span class="w">  </span><span class="m">0</span>.5
-0.5000<span class="w"> </span>-0.5000<span class="w"> </span>-0.5000<span class="w">  </span><span class="m">0</span>.5
</pre></div>
</div>
</li>
</ul>
</section>
<section id="dft-section">
<h4>DFT section<a class="headerlink" href="#dft-section" title="Permalink to this heading">¶</a></h4>
<table class="docutils align-default" id="id8">
<caption><span class="caption-text">Parameter List</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>contracted_on</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">.true.</span></code> it acts on the contracted basis (considerably faster).</p></td>
</tr>
<tr class="row-odd"><td><p>maxit</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Maximum number of iterations in the self-consistent cycle.</p></td>
</tr>
<tr class="row-even"><td><p>epsdft</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Tolerance in the convergence of total energy.</p></td>
</tr>
<tr class="row-odd"><td><p>typeopt</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">typeopt</span> <span class="pre">=</span> <span class="pre">0</span></code>: Use self consistency method with standard mixing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typeopt</span> <span class="pre">=</span> <span class="pre">2</span></code>: Linear mixing scheme.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typeopt</span> <span class="pre">=</span> <span class="pre">3</span></code>: Conjugate gradients method with SR acceleration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typeopt</span> <span class="pre">=</span> <span class="pre">4</span></code>: Anderson mixing scheme with Jacobian acceleration, no use of mixing is made; this method looks to be the
faster and therefore the preferred among the available ones. For information on the algorithm see doc/tex/parbcs.tex,
Ch. V</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>mixing</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Choose a small value for better convergence. If even in this way it does not converge, switch on the smearing technique
setting <code class="docutils literal notranslate"><span class="pre">optocc=1</span></code> (suggested for open shell systems). Alternatively you can change iteration method with <code class="docutils literal notranslate"><span class="pre">typeopt=3</span></code>
(conjugate gradients) which will certainly converge for mixing small enough. In these cases mixing means just the maximum
amplitude in the step.</p></td>
</tr>
<tr class="row-odd"><td><p>mixingder (abbr)</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><ul class="simple">
<li><p>Case 1 (<code class="docutils literal notranslate"><span class="pre">typeopt</span> <span class="pre">=</span> <span class="pre">3</span></code>): Used to evaluate numerically the first and second derivatives.</p></li>
<li><p>Case 2 (<code class="docutils literal notranslate"><span class="pre">typeopt</span> <span class="pre">=</span> <span class="pre">4</span></code>): Used to be closer to the linear regime for the evaluation of the Jacobian (<code class="docutils literal notranslate"><span class="pre">mixingder</span></code> &lt;&lt; 1).</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>tfcut</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Used only with <code class="docutils literal notranslate"><span class="pre">typeopt</span> <span class="pre">=</span> <span class="pre">0/2/4</span></code>. It is used for preconditioning to improve convergence of small q charge fluctuations.
Suggested value of <code class="docutils literal notranslate"><span class="pre">tfcut</span></code> <span class="math">= \frac{1}{{xi_{TF}}^2}</span>  where <span class="math">xi</span> is the Thomas-Fermi length expressed in a.u.</p></td>
</tr>
<tr class="row-odd"><td><p>orthodiag</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.false.</span></code> the Kohn-Sham eigenvectors are not orthogonalized after each Hamiltonian diagonalization.</p></td>
</tr>
<tr class="row-even"><td><p>maxold</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>The number of previous iterations to be considered in the numerical evaluation of Jacobian with <code class="docutils literal notranslate"><span class="pre">typeopt</span> <span class="pre">=</span> <span class="pre">4</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>typedft</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">typedft</span> <span class="pre">=</span> <span class="pre">0</span></code>: DFT calculation with Hartree potential only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typedft</span> <span class="pre">=</span> <span class="pre">1</span></code>: LDA (PZ 1981).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typedft</span> <span class="pre">=</span> <span class="pre">2</span></code>: LDA (OB 1994).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typedft</span> <span class="pre">=</span> <span class="pre">-1,-2</span></code>: Same as the two above, but with the corresponding fit performed by imposing continuity in the
correlation energy at <span class="math">rs = 1</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typedft</span> <span class="pre">=</span> <span class="pre">3</span></code>: KZK finite volume DFT: should be more accurate for finite volume.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typedft</span> <span class="pre">=</span> <span class="pre">-3</span></code>: Different fitting procedure, suitable for open systems. Could be used with periodic systems too, but it
is less stable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typedft</span> <span class="pre">=</span> <span class="pre">4</span></code>: Standard LSDA.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typedft</span> <span class="pre">=</span> <span class="pre">-4</span></code>: Standard LSDA, but with the corresponding fit performed by imposing continuity in the correlation energy
at <span class="math">rs = 1</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typedft</span> <span class="pre">=</span> <span class="pre">5</span></code>: LSDA + KZK (not applied on spin) (<code class="docutils literal notranslate"><span class="pre">typedft</span> <span class="pre">=</span> <span class="pre">-5</span></code> similar to <code class="docutils literal notranslate"><span class="pre">typedft</span> <span class="pre">=</span> <span class="pre">-3</span></code>).</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>weightvh</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Weight of the hartree potential. Setting <code class="docutils literal notranslate"><span class="pre">weightvh</span></code> <span class="math">\neq 1</span> is used just for testing.</p></td>
</tr>
<tr class="row-odd"><td><p>weightxc</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Weight of the exchange energy. When <code class="docutils literal notranslate"><span class="pre">weightxc</span></code> <span class="math">= 0</span> no exchange and when <span class="math">weightcorr = 1</span> standard LDA is used.</p></td>
</tr>
<tr class="row-even"><td><p>weightcorr</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Weight of the correlation energy, e.g. <code class="docutils literal notranslate"><span class="pre">weightcorr</span></code> <span class="math">= 0</span> no correlation, <code class="docutils literal notranslate"><span class="pre">weightcorr</span></code> <span class="math">= 1</span> standard LDA.</p></td>
</tr>
<tr class="row-odd"><td><p>optocc</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">optocc</span> <span class="pre">=</span> <span class="pre">0</span></code>: Use standard occupation of levels. It works well only for closed shell systems (insulators or special cases).
Occupations are read from standard input (see below); the number of occupations read is chosen by the parameter <code class="docutils literal notranslate"><span class="pre">nelocc</span></code>
(<code class="docutils literal notranslate"><span class="pre">neloccdo</span></code> for down spin electrons) which must be specified in input. In this case we have <code class="docutils literal notranslate"><span class="pre">occupations(1:nelocc)</span> <span class="pre">=</span> <span class="pre">2</span></code>
for LDA; <code class="docutils literal notranslate"><span class="pre">occupations(1:nelocc)</span> <span class="pre">=</span> <span class="pre">1</span></code> &amp;&amp; <code class="docutils literal notranslate"><span class="pre">occupationdo(1:neloccdo)</span> <span class="pre">=</span> <span class="pre">1</span></code> for LSDA.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">optocc</span> <span class="pre">=</span> <span class="pre">1</span></code>: Use a smeared Fermi distribution with a spread given by the parameter <code class="docutils literal notranslate"><span class="pre">epsshell</span></code> (see below). In this
case:  <span class="math">occupations(i) = \exp{ \frac{eig(i)-ef}{epsshell}+1}</span> where the Fermi energy <span class="math">ef</span> is determined by the
constraint, sum(occupations(1:bands)) = no. of electrons via bisection method . For LSDA (<code class="docutils literal notranslate"><span class="pre">|typedft|</span> <span class="pre">=</span> <span class="pre">4,</span> <span class="pre">5</span></code>) two Fermi
distributions are introduced for up and down electrons. In the case of k-points sampling, the Fermi energy is determined
by averaging over <span class="math">ef</span> computed for each k-point.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>epsshell</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Spread of the Fermi distribution used when <code class="docutils literal notranslate"><span class="pre">optocc</span> <span class="pre">=</span> <span class="pre">1</span></code>. The unit is Ha.</p></td>
</tr>
<tr class="row-odd"><td><p>memlarge</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Optimize speed at the cost of much greater memory requirements. The whole basis set is saved on disk!</p></td>
</tr>
<tr class="row-even"><td><p>epsover</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Minimum tolerance for the lowest eigenvalues of the overlap matrix. If <code class="docutils literal notranslate"><span class="pre">epsover</span></code> &lt; 0  no orthogonalization is implemented
(faster but less stable).</p></td>
</tr>
<tr class="row-odd"><td><p>mincond</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Disregard the first <code class="docutils literal notranslate"><span class="pre">mincond</span></code>-1 direction regardless of the condition number limited by <code class="docutils literal notranslate"><span class="pre">epsover</span></code>. This is useful to have
better cancellation errors as a function e.g. of pressure.</p></td>
</tr>
<tr class="row-even"><td><p>maxcg</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>With <code class="docutils literal notranslate"><span class="pre">typeopt</span> <span class="pre">=</span> <span class="pre">3</span></code> (conjugate gradient) each <code class="docutils literal notranslate"><span class="pre">maxcg</span></code> steps restart the conj. grad. procedure. If <code class="docutils literal notranslate"><span class="pre">maxcg</span> <span class="pre">=</span> <span class="pre">0</span></code> no
restarting is performed (discouraged since numerically unstable).</p></td>
</tr>
<tr class="row-odd"><td><p>bands</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>The number of lowest eigenvalues of Khon-Sham equations to be evaluated. By default <code class="docutils literal notranslate"><span class="pre">bands</span> <span class="pre">=</span> <span class="pre">nelup</span> <span class="pre">+</span> <span class="pre">7</span></code> where <code class="docutils literal notranslate"><span class="pre">nelup</span></code>
is the number of spin up electrons. This corresponds to assuming at most an 8-fold degenerancy in the last occupied shell.</p></td>
</tr>
<tr class="row-even"><td><p>nelocc</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">nelocc</span></code> &gt; 0, it is the number of occupations that are read in the last record of the input file. Occupation values can
only be (0,2] (paired orbitals), -1 (unpaired at the end) or 0 (unoccupied). If <code class="docutils literal notranslate"><span class="pre">nxs</span></code> <span class="math">\times</span> <code class="docutils literal notranslate"><span class="pre">nys</span></code> <span class="math">\times</span>
<code class="docutils literal notranslate"><span class="pre">nzs</span></code> &gt; 0 this record is just after the ones to read the input magnetization (see below).</p></td>
</tr>
<tr class="row-odd"><td><p>neloccdo</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>It is similar to <code class="docutils literal notranslate"><span class="pre">nelocc</span></code> but for the spin down electrons which are assumed with no unpaired orbitals. Another record with
<code class="docutils literal notranslate"><span class="pre">neloccdo</span></code> integers be written below. Note that, in this case occupations for up spin can take values 1 (occupied paired
orbital), -1 (unpaired), 0 (unoccupied orbital). Instead occupations for down spin electrons can take values 1 (occupied
paired orbital) and 0 (unoccupied orbital).</p></td>
</tr>
<tr class="row-even"><td><p>randspin</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Used for initializing magnetization. If <code class="docutils literal notranslate"><span class="pre">randspin</span></code> &gt; 0, add random component to the orbitals. If <code class="docutils literal notranslate"><span class="pre">randspin</span></code> &lt; 0
initialize with maximum possible spin given density and grid (see below). If zero no action.</p></td>
</tr>
<tr class="row-odd"><td><p>jaccond</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Minimum threshold for the condition matrix in the self-consistent approach <code class="docutils literal notranslate"><span class="pre">typeopt</span> <span class="pre">=</span> <span class="pre">4</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>nxs
nys
nzs</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Dimension of the grid where the magnetization is defined along the <span class="math">x</span>, <span class="math">y</span>, <span class="math">z</span> direction. The format is
written below.</p></td>
</tr>
<tr class="row-odd"><td><p>h_field</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">h\_field</span></code> &gt; (&lt;) 0 put a magnetic field increasing (decreasing) the magnetization with the staggering given by the table
sxyz defined for <code class="docutils literal notranslate"><span class="pre">randspin</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>optimize_overs</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">.true.</span></code> optimize the overlap matrices calculation if the phase for spin down electrons is equal or opposite to the
phase for up spin electrons. Otherwise it is automatically set to <code class="docutils literal notranslate"><span class="pre">.false.</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>write_den</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">.true.</span></code> write the overlap matrix elements for effective Hamiltonian calculations to the disk.</p></td>
</tr>
<tr class="row-even"><td><p>zero_jas</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">.true.</span></code> set the one-body Jastrow to zero at the end of the DFT calculation.</p></td>
</tr>
<tr class="row-odd"><td><p>fix_density</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>If the flag <code class="docutils literal notranslate"><span class="pre">decoupled_run</span></code> is set to <code class="docutils literal notranslate"><span class="pre">.true.</span></code> (&amp;parameters card) as well as the <code class="docutils literal notranslate"><span class="pre">yes_kpoints</span></code> flag (&amp;kpoints card),
the k-points are evolved independently but using the averaged electronic density.</p></td>
</tr>
</tbody>
</table>
<p>Additional information:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">nxs</span></code> <code class="docutils literal notranslate"><span class="pre">nys</span></code> <code class="docutils literal notranslate"><span class="pre">nzs</span></code></p>
<p>Dimension of the grid where the magnetization is defined along the <span class="math">x</span>, <span class="math">y</span>, <span class="math">z</span> direction:
The format is</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>!<span class="w">  </span>After<span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span>or<span class="w"> </span><span class="s2">&quot;occupation list&quot;</span>
!<span class="w"> </span><span class="c1"># empty line</span>
!<span class="w"> </span>s111<span class="w"> </span>s211<span class="w"> </span>s311<span class="w"> </span>...<span class="w"> </span>snxs11
!<span class="w"> </span>s121<span class="w"> </span>s221<span class="w"> </span>s321<span class="w"> </span>...<span class="w"> </span>snxs11
!<span class="w"> </span>s1nys1<span class="w"> </span>...<span class="w"> </span>...<span class="w"> </span>...<span class="w"> </span>snxsnys1
!<span class="w"> </span><span class="c1"># empty line</span>
!<span class="w"> </span>s112<span class="w"> </span>s212<span class="w"> </span>s312<span class="w"> </span>...<span class="w"> </span>snxs12
!<span class="w"> </span>...
!<span class="w"> </span><span class="c1"># empty line</span>
!<span class="w"> </span>s11nzs<span class="w"> </span>s21nzs<span class="w"> </span>s31nzs<span class="w"> </span>...<span class="w"> </span>snxs1nzs
!<span class="w"> </span>...
!<span class="w"> </span>s1nysnzs<span class="w"> </span>...<span class="w"> </span>...<span class="w"> </span>...<span class="w"> </span>snxsnysnzs
</pre></div>
</div>
</li>
</ul>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="03wavefunction.html" class="btn btn-neutral float-left" title="Wavefunction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="05conversions.html" class="btn btn-neutral float-right" title="Wavefunction conversions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Kosuke Nakano (NIMS) and collaborators..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>