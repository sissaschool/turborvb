<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wavefunction &mdash; TurboRVB userguides Updated on 26/06/2023 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/my_theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/roles.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Initializations of Wavefunctions" href="04DFT_driver.html" />
    <link rel="prev" title="TurboRVB in a nutshell" href="01nutshell.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            TurboRVB userguides
          </a>
              <div class="version">
                Updated on 26/06/2023
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01nutshell.html">TurboRVB in a nutshell</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Wavefunction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#wavefunction-file-format-fort-10">Wavefunction file format (fort.10)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-header">The Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-coordinates">The Coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-ionic-forces">The Ionic Forces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-2b-jastrow">The 2B Jastrow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-basis-set-for-determinant">The Basis Set for Determinant</a></li>
<li class="toctree-l3"><a class="reference internal" href="#molecular-orbital">Molecular orbital</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hybrid-orbital">Hybrid orbital</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-basis-set-for-3b-jastrow">The Basis Set for 3B Jastrow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#occupation-determinant-orbitals">Occupation Determinant Orbitals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#occupation-jastrow-orbitals">Occupation Jastrow Orbitals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coefficient-of-the-determinant-a-matrix-different-from-zero">Coefficient of the Determinant <span class="math">A</span> Matrix different from zero</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jsagps">JsAGPs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jagpu">JAGPu</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jagp-jpf">JAGP (JPf)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#symmetries-of-the-determinant-a-matrix">Symmetries of the Determinant <span class="math">A</span> matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coefficient-of-the-jastrow-different-from-zero">Coefficient of the Jastrow different from zero</a></li>
<li class="toctree-l3"><a class="reference internal" href="#symmetries-of-the-jastrow-m-matrix">Symmetries of the Jastrow <span class="math">M</span> matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#symmetries-on-the-z-coefficients-in-the-determinant-basis">Symmetries on the Z coefficients in the Determinant Basis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#symmetries-on-the-z-coefficients-in-the-jastrow-basis">Symmetries on the Z coefficients in the Jastrow Basis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#generate-a-wavefunction-file-makefort10-x">Generate a Wavefunction file (makefort10.x)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#system-section">system section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#electron-section">electron section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#symmetry-section">symmetry section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#atomic-positions">ATOMIC_POSITIONS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basis-set">Basis set</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="04DFT_driver.html">Initializations of Wavefunctions</a></li>
<li class="toctree-l1"><a class="reference internal" href="05conversions.html">Wavefunction conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="06qmc_driver.html">Quantum Monte Carlo calculations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TurboRVB userguides</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Wavefunction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/03wavefunction.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wavefunction">
<h1>Wavefunction<a class="headerlink" href="#wavefunction" title="Permalink to this heading">¶</a></h1>
<p>TurboRVB employs a many-body WF ansatz <span class="math">\Psi</span> which can be written as the product of two terms:</p>
<div class="math">
<p><span class="math">\Psi  =  \Phi _\text{AS} \times \exp J \,,</span></p>
</div><p>where the term <span class="math">\exp J</span>, conventionally dubbed Jastrow factor, is symmetric under electron exchange, and the term <span class="math">\Phi _\text{AS}</span>, also referred to as the determinant part of the WF, is antisymmetric.
The resulting WF <span class="math">\Psi</span> is antisymmetric, thus fermionic.</p>
<p>The Jastrow factor (<span class="math">\exp J</span>) plays an important role
in improving the correlation of the WF and in fulfilling Kato’s cusp conditions.
TurboRVB implements the Jastrow term composed of one-body, two-body, and three/four-body factors (<span class="math">J = {J_1}+{J_2}+{J_{3/4}}</span>).</p>
<section id="wavefunction-file-format-fort-10">
<h2>Wavefunction file format (fort.10)<a class="headerlink" href="#wavefunction-file-format-fort-10" title="Permalink to this heading">¶</a></h2>
<p>In TurboRVB, <code class="docutils literal notranslate"><span class="pre">fort.10</span></code> is a fundamental file that contains all information about the nuclear positions and the wave function (WF) details and parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># fort.10 of the C2-dimer (the Pfaffian ansatz with the Filippi pseudo potential.)</span>
<span class="c1"># Nelup  #Nel  # Ion</span>
        <span class="mi">4</span>          <span class="o">-</span><span class="mi">8</span>           <span class="mi">2</span>
<span class="c1"># Shell Det.   # Shell Jas.</span>
        <span class="mi">50</span>          <span class="mi">43</span>
<span class="c1"># Jas 2body  # Det   #  3 body atomic par.</span>
        <span class="o">-</span><span class="mi">22</span>        <span class="mi">1482</span>          <span class="mi">42</span>
<span class="c1"># Det mat. =/0  # Jas mat. =/0</span>
        <span class="mi">120</span>        <span class="mi">8370</span>
<span class="c1"># Eq. Det atomic par.  # Eq. 3 body atomic. par.</span>
        <span class="mi">741</span>          <span class="mi">21</span>
<span class="c1"># unconstrained iesfree,iessw,ieskinr,I/O flag</span>
        <span class="mi">8370</span>         <span class="mi">120</span>           <span class="mi">6</span>           <span class="mi">0</span>
<span class="c1"># Ion coordinates</span>
<span class="mf">4.00000000000000</span>        <span class="mf">6.00000000000000</span>       <span class="mf">0.000000000000000E+000</span>
<span class="mf">0.000000000000000E+000</span>  <span class="o">-</span><span class="mf">1.14999954166875</span>
<span class="mf">4.00000000000000</span>        <span class="mf">6.00000000000000</span>       <span class="mf">0.000000000000000E+000</span>
<span class="mf">0.000000000000000E+000</span>   <span class="mf">1.14999954166875</span>
<span class="c1">#  Constraints for forces: ion - coordinate</span>
        <span class="mi">1</span>           <span class="mi">1</span>           <span class="mi">1</span>
        <span class="mi">1</span>           <span class="mi">1</span>           <span class="mi">2</span>
        <span class="mi">1</span>           <span class="mi">1</span>           <span class="mi">3</span>
        <span class="mi">1</span>           <span class="mi">2</span>           <span class="mi">1</span>
        <span class="mi">1</span>           <span class="mi">2</span>           <span class="mi">2</span>
        <span class="mi">1</span>           <span class="mi">2</span>           <span class="mi">3</span>
<span class="c1">#          Parameters Jastrow two body</span>
        <span class="o">-</span><span class="mi">1</span>  <span class="mf">0.342214663461764</span>
<span class="o">...</span>
</pre></div>
</div>
<p>In the following each part of the file will be described. The file is divided in different sections and it contains numbers (in a
free format) as well as comment lines (which start with #).</p>
<section id="the-header">
<h3>The Header<a class="headerlink" href="#the-header" title="Permalink to this heading">¶</a></h3>
<p>This part accounts for the first twelve lines of the file.
It contains general information about the system (such as number
of electrons and nuclei), wavefunction general characteristic (such as
the number of parameters and symmetry information between them).
Here we report an header example and then we shortly describe the
keywords.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nelup  #Nel  # Ion</span>
          <span class="mi">2</span>           <span class="mi">4</span>           <span class="mi">1</span>
<span class="c1"># Shell Det.   # Shell Jas.</span>
          <span class="mi">3</span>           <span class="mi">3</span>
<span class="c1"># Jas 2body  # Det   #  3 body atomic par.</span>
         <span class="o">-</span><span class="mi">8</span>          <span class="mi">16</span>           <span class="mi">8</span>
<span class="c1"># Det mat. =/0  # Jas mat. =/0</span>
          <span class="mi">6</span>           <span class="mi">6</span>
<span class="c1"># Eq. Det atomic par.  # Eq. 3 body atomic. par.</span>
         <span class="mi">13</span>           <span class="mi">8</span>
<span class="c1"># unconstrained iesfree,iessw,ieskinr,I/O flag</span>
          <span class="mi">4</span>           <span class="mi">4</span>           <span class="mi">0</span>           <span class="mi">0</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">NELUP</span></code> Number of spin up electrons in the system.</p>
<p><code class="docutils literal notranslate"><span class="pre">NEL</span></code> Total number of electrons in the system.</p>
<p><code class="docutils literal notranslate"><span class="pre">ION</span></code> Number of nuclei in the system.</p>
<p><code class="docutils literal notranslate"><span class="pre">SHELL</span> <span class="pre">DET</span></code> Number of shells  used to describe the determinantal term of the AGP wavefunction.</p>
<p><code class="docutils literal notranslate"><span class="pre">SHELL</span> <span class="pre">JAS</span></code> Number of shells used to describe the Jastrow term of the wavefunction.</p>
<p><code class="docutils literal notranslate"><span class="pre">JAS</span> <span class="pre">2BODY</span></code> Type of the Jastrow 2B/1B term used to satisfy the electron-electron, electron-ion cusp conditions, respectively.</p>
<p>The one-body Jastrow factor <span class="math">J_1</span> is the sum of two parts, the homogeneous part (enforcing the electron-ion cusp condition) and the corresponding inhomogeneous parts.</p>
<p>The homogenenous part reads</p>
<div class="math">
<p><span class="math">J_1^h \left( \mathbf{r}_1,\ldots,\mathbf{r}_N \right) = \sum_{i=1}^N \sum_{a=1}^{N_\text{at}} \left( { { - {{\left( {2{Z_a}} \right)}^{3/4}}u_a\left( {(2{Z_a})^{1/4}\left| {{\mathbf{r}_i} - {{\mathbf{R}}_a}} \right|} \right)} } \right),</span></p>
</div><p>where the most common choice for <span class="math">u_a</span> in turborvb is:</p>
<div class="math">
<p><span class="math">u_a\left( r \right) = \frac{ 1 }{2 b_{\text{e}a}} \left( {1 - {e^{ - r b_{\text{e}a}}}} \right)</span></p>
</div><p>depending on a single variational parameter <span class="math">b_{\text{e}a}</span>, that may be optimized
independently for each atomic species, but we can choose several different forms as described below.</p>
<p>The two-body Jastrow factor is defined as:</p>
<div class="math">
<p><span class="math">{J_2}\left( {{{\mathbf{r}}_1}{\sigma _1}, \ldots, {{\mathbf{r}}_N}{\sigma _N}} \right) =  {\sum\limits_{i &lt; j} {{v_{{\sigma _i},{\sigma _j}}}\left( {\left| {{{\mathbf{r}}_i} - {{\mathbf{r}}_j}} \right|} \right)} },</span></p>
</div><p>where <span class="math">v_{{\sigma _i},{\sigma _j}}</span> is another  simple bounded  function. There are several possible choices for <span class="math">v_{{\sigma _i},{\sigma _j}}</span> implemented in turborvb (all listed as below), and one of them is, for instance, the following spin-dependent form:</p>
<div class="math">
<p><span class="math">{v_{{\sigma _i},{\sigma _j}}}\left( {{r_{i,j}}} \right) =
\begin{cases}
    \cfrac{{{r_{i,j}}}}{4} \cdot {\left( {1 + b_{\rm{ee}}^{\rm{para}} \cdot {{r_{i,j}}}} \right)^{ - 1}} &amp; ({\sigma _i} = {\sigma _j}) \\
    \cfrac{{{r_{i,j}}}}{2} \cdot {\left( {1 + b_{\rm{ee}}^{\rm{anti}} \cdot {{r_{i,j}}}} \right)^{ - 1}} &amp; ({\sigma _i} \neq {\sigma _j})
\end{cases},</span></p>
</div><p>where <span class="math">{r_{i,j}} = \left| {{{\mathbf{r}}_i} - {{\mathbf{r}}_j}} \right|</span>, and <span class="math">b_{\rm{ee}}^{\rm{para}}</span> and <span class="math">b_{\rm{ee}}^{\rm{anti}}</span> are variational parameters.</p>
<p>Different functional form of the Jastrow one and two body terms are available and each one is identified with an integer number code iesdrr (the leftmost integer below the line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Jas 2body  # Det   #  3 body atomic par.</span>
</pre></div>
</div>
<p>, i.e. -8 in the above example)  that selects also the number of parameters <span class="math">p</span> used for the two body Jastrow part only. The input consists of one line below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#          Parameters Jastrow two body</span>
<span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span>  <span class="mi">2</span>  <span class="mf">1.0</span> <span class="mf">1.0</span>
</pre></div>
</div>
<p>There are two body Jastrow defined with a number <span class="math">p</span> of parameters larger than one, that are put in order from left to right in the input line according to the alphabetic order, <span class="math">a,b,c \cdots</span> . The absolute value of the integer in the record  indicates the number of parameters <span class="math">niesd=p+p_{obebody}</span>, where <span class="math">p_{onebody}</span> is the number of parameters used in the one body Jastrow. From left to right in the record the first <span class="math">p</span> parameters refer to the two-body Jastwow and the remaining ones to the one body Jastrow. The one body form is assumed to have at most one parameter for each atomic
species and its default form is given by a rescaled (-4, see below) in order to satisfy the electron-ion cusp.There are only three possible values allowed for <span class="math">niesd</span>:</p>
<blockquote>
<div><p><span class="math">p_{onebody} = 0</span> the one body parameter is set equal to the last parameter of the record for all the atomic species.</p>
<p><span class="math">p_{onebody} = 1</span> the one body parameter is set equal to the last parameter of the record for all the atomic species, but is independent of the two body parameters.</p>
<p><span class="math">p_{onebody} = \#</span> different atoms as above, the one body parameters act independently on each atomic species, for instance in water there are two independent atomic species (two Hydrogen and one Oxygen) and the one-body is defined by two parameters. In this case the one body parameters are sorted in the record according to the atomic number, the leftmost corresponding to the lightest atomic number.</p>
</div></blockquote>
<p>Be careful with this number, as its allowed value is not tested in the input (yet).
The following values of the two body Jastrow (iesdrr) are allowed:</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Jastrow <code class="docutils literal notranslate"><span class="pre">iesdrr</span></code> summary</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>iesdrr</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>No two body and one body, 3B Jastrow may be on.</p></td>
</tr>
<tr class="row-odd"><td><p>-5</p></td>
<td><p>Two body <span class="math">\frac{r}{2(1+ar)}</span> one body rescaled same form.</p></td>
</tr>
<tr class="row-even"><td><p>-1</p></td>
<td><p>Two body <span class="math">\frac{r}{2(1+ar)}</span> for opposite spins and  <span class="math">\frac{r}{4(1+ar)}</span> for parallel spins, one body rescaled same form.</p></td>
</tr>
<tr class="row-odd"><td><p>-4</p></td>
<td><p>Two body <span class="math">\frac{1}{2a} (1 - e^{-ar})</span> one body rescaled. Not spin contaminated.</p></td>
</tr>
<tr class="row-even"><td><p>-7, -6</p></td>
<td><p>Two body <span class="math">\frac{1}{2a} (1 - e^{-ar})</span> one body rescaled, +cusp for parallel spins (divided by two).</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Two parameters Jastrow improved version of -1 with an independent parameter for the parellel spins, <span class="math">\frac{r}{4(1 + br)}</span> for (anti-)parallel spins, spin contaminated.</p></td>
</tr>
<tr class="row-even"><td><p>-8</p></td>
<td><p>Two body <span class="math">\frac{1}{2a} (1 - e^{-ar})</span> one body rescaled, + cusp for (anti-)parallel spins + 3B Jastrow Sz.</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>Two body <span class="math">\frac{1}{a} (1 - e^{-ar^3})</span> for pseudo soft.</p></td>
</tr>
<tr class="row-even"><td><p>-9</p></td>
<td><p>Two body <span class="math">-A \ln(1 + a{(1 - \frac{r}{b})}^2)</span> for RVB wavefunction, with <span class="math">A = \frac{b(1 + a)}{4a}</span> , to satisfy the cusp conditions for opposite spin electrons. Two parameters <span class="math">niesd \geq 2</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>Two parameters RVB two-body Jastrow. Two body <span class="math">-A \ln(1 + a{(1 - \frac{r}{b})}^2)</span> for RVB wavefunction, with <span class="math">A = \frac{r_0(1 + b)}{4b}</span> , to satisfy the cusp conditions for opposite spin electrons.</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>Two parameters RVB two-body Jastrow. Two body <span class="math">-A \ln(1 + a{(1 - \frac{r}{b})}^2)</span> for RVB wavefunction, with <span class="math">A = \frac{r_0(1 + b)}{4b}</span> , to satisfy the cusp conditions for opposite spin electrons. Rescaled <span class="math">r \to \frac{r}{2}</span> to satisfy the cusp condition for parallel spins.</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>Three parameters <span class="math">\frac{1}{a + b*c} (1+c-\exp(-ar)-c\exp(-br))</span> improved version of -6. Warning! Implemented only for open systems.</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>Two parameters, the second is used to rescale the electron-electron distance <span class="math">r_s = \frac{1-\exp(-br)}{r}</span> and the Jastrow is defined by <span class="math">J_{ee}=\frac{r_s}{2(1+ar_s)}</span> , no spin contamination and cusp condition for opposite spin electrons.</p></td>
</tr>
<tr class="row-odd"><td><p>-2</p></td>
<td><p>Two parameter Jastrow <span class="math">r_z = \sqrt{a^2(x^2+y^2) + {(bz)}^2}</span> , and <span class="math">J_2 = \frac{1}{2} \frac{r}{1+r_z}</span> + cusp for (anti-)parallel spins for anisotropic phases. Warning! Implemented only for open systems.</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Three parameters correction to <span class="math">-5</span> <span class="math">J_2 = \frac{r}{2}(\frac{1}{1+ar} + \frac{cr}{{(1+br)}^2})</span> + cusp for (anti-)parallel spins.</p></td>
</tr>
<tr class="row-odd"><td><p>-9</p></td>
<td><p>Two body <span class="math">\frac{1}{2b} (1 - e^{-br})</span> one body rescaled, + cusp for (anti-)parallel spins + 3B + 1B Jastrow Sz (for studying magnetic phases).</p></td>
</tr>
<tr class="row-even"><td><p>-10</p></td>
<td><p>No two body and one body, 3B Jastrow and Jastrow Sz is on.</p></td>
</tr>
<tr class="row-odd"><td><p>-11</p></td>
<td><p>No two body and one body, 3B+1B Jastrow and Jastrow Sz are on (for studying magnetic phases).</p></td>
</tr>
<tr class="row-even"><td><p>-12</p></td>
<td><p>General spin-density Jastrow, one body and two body as -15, namely without spin dependent cusp condition.</p></td>
</tr>
<tr class="row-odd"><td><p>-15</p></td>
<td><p>Long range two body <span class="math">\frac{r}{2(1+br)}</span> ; short range one body <span class="math">\frac{1}{2b} (1-e^{-br})</span> .</p></td>
</tr>
<tr class="row-even"><td><p>-20</p></td>
<td><p>Two parameters, spin dependent (as -7) long range two body <span class="math">\frac{r}{2(1+ar)}</span> ; short range one body <span class="math">\frac{1}{2b} (1-e^{-br})</span> .</p></td>
</tr>
<tr class="row-odd"><td><p>-21</p></td>
<td><p>Three parameters, first two same as Jastrow number 2; short range one body <span class="math">\frac{1}{2c} (1-e^{-cr})</span>.</p></td>
</tr>
<tr class="row-even"><td><p>-22</p></td>
<td><p>General spin-density Jastrow one body and two body as -20, with spin dependent cusp condition, more appropriate in this case, as the spin contamination is already implied by the three and four body term.</p></td>
</tr>
<tr class="row-odd"><td><p>-26</p></td>
<td><p>General spin-density Jastrow one body and two body as -7, with spin dependent cusp condition, without long range power law tails.</p></td>
</tr>
<tr class="row-even"><td><p>-27</p></td>
<td><p>General spin-density Jastrow one body and two body as -21, with spin dependent cusp condition.NB <span class="math">p=2</span> in this case, so one can put niesd=3 safely. Warning! If you put niesd&gt;2, it is recommended to set niesd equal to 2 + # different atomic species, e.g. niesd=4 for benzene. In this way,
all different atomic species will have a different one-body term.</p></td>
</tr>
<tr class="row-odd"><td><p>-30</p></td>
<td><p>General spin-density Jastrow one body and two as 10, with spin dependent cusp condition. NB <span class="math">p=2</span> in this case, so one can put niesd=3 safely.</p></td>
</tr>
<tr class="row-even"><td><p>-31</p></td>
<td><p>General spin-density Jastrow one body and two body as 10, with spin dependent cusp condition. NB <span class="math">p=2</span> in this case, so one can put niesd=3 safely.</p></td>
</tr>
<tr class="row-odd"><td><p>-18</p></td>
<td><p>same as <span class="math">iesdrr=-8</span> but with two body <span class="math">\frac{r}{2(1+br)}</span> .</p></td>
</tr>
<tr class="row-even"><td><p>-19</p></td>
<td><p>same as <span class="math">iesdrr=-9</span> but with two body <span class="math">\frac{r}{2(1+br)}</span> as -7.</p></td>
</tr>
<tr class="row-odd"><td><p>-28</p></td>
<td><p>same as <span class="math">iesdrr=-8</span> but with two body/one body as -20.</p></td>
</tr>
<tr class="row-even"><td><p>-29</p></td>
<td><p>same as <span class="math">iesdrr=-9</span> but with two body/one body as -20.</p></td>
</tr>
<tr class="row-odd"><td><p>-16</p></td>
<td><p>same as <span class="math">iesdrr=-19</span> but with spin independent two body as -5.</p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">DET</span></code> Total number of atomic variational parameters used for the description of the determinant part of the JAGP. The atomic variational parameters are all parameters describing the shell used to expand the WF (i.e. gaussian coefficient and gaussian exponents). For example, if a shell is described by a single Gaussian function, <span class="math">\phi(r) \sim \exp(-Zr^2)</span> there is only one atomic parameter, the Z exponent of the Gaussian. If the shell is described by a contraacted orbital of two Gaussians, <span class="math">\psi = \alpha_1 \exp(-Z_1 r^2) + \alpha_2 \exp(-Z_2 r^2)</span> then there are four atomic parameters, <span class="math">Z_1</span> and <span class="math">Z_2</span> and the coefficients <span class="math">\alpha_1</span> and <span class="math">\alpha_2</span> of the linear combination.</p>
<p><code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">BODY</span> <span class="pre">ATOMIC</span> <span class="pre">PAR</span></code> Total number of atomic parameters used to describe the Jastrow part of the JAGP. It is analogous to <strong>DET</strong> but for the Jastrow orbitals.</p>
<p><code class="docutils literal notranslate"><span class="pre">DET</span> <span class="pre">MAT</span> <span class="pre">=/0</span></code> Number of coefficients <span class="math">\{\lambda_{ij}\}</span> of the determinant that are different from zero. Note that the <span class="math">\Lambda</span> matrix is symmetric and only <span class="math">\lambda_{ij}</span> for <span class="math">i \geq j</span> are provided in the data file. This number corresponds to the number of lines read afterwards.</p>
<p><code class="docutils literal notranslate"><span class="pre">JAS</span> <span class="pre">MAT</span> <span class="pre">=/0</span></code> Number of coefficients <span class="math">\{\lambda_{ij}\}</span> in the 3B Jastrow that will be considered different from zero. This number corresponds to the number of lines that will be read afterwards.</p>
<p><code class="docutils literal notranslate"><span class="pre">EQ</span> <span class="pre">DET</span> <span class="pre">ATOMIC</span> <span class="pre">PAR</span></code> Number of symmetries involving the variational atomic parameters of the determinant. This number corresponds to the number of lines that will be read afterwards.</p>
<p><code class="docutils literal notranslate"><span class="pre">EQ</span> <span class="pre">3</span> <span class="pre">BODY</span> <span class="pre">ATOMIC</span> <span class="pre">PAR</span></code> Number of symmetries involving the variational atomic parameters of the 3B Jastrow. This number corresponds to the number of lines that will be read afterwards.</p>
<p><code class="docutils literal notranslate"><span class="pre">UNCONSTRAINED</span> <span class="pre">IESFREE</span></code> Number of independent coefficients <span class="math">\{\lambda\}</span> of the Jastrow. This number corresponds to the number of lines to be read when the symmetries for the Jastrow <span class="math">\{\Lambda\}</span> matrix are described.</p>
<p><code class="docutils literal notranslate"><span class="pre">IESWW</span></code> Number of independent coefficients <span class="math">\{\lambda\}</span> of the determinant. This number corresponds to the number of lines to be read when the symmetries for the determinant are described.</p>
<p><code class="docutils literal notranslate"><span class="pre">IESKINR</span></code> Number of cartesian nuclear components to be optimized. This number corresponds to the number of lines to be read in the relative section of the file.</p>
<p><code class="docutils literal notranslate"><span class="pre">I\O</span> <span class="pre">FLAG</span></code> It describes how to read the FORT.10 file. If ‘0’ the file is read and all the information is used. If ‘1’, at the end of the file, an extra part is expected where new parameters (for example averaged from previous simulations) are provided in free format.</p>
<p>In case the system has periodic boundary conditions (PBC), two additional lines appear as first lines at the beginning of the header. Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#   PBC rs, Ly/Lx, Lz/Lx</span>
    <span class="mf">1.3100</span>         <span class="mf">1.0000</span>       <span class="mf">1.0000</span>          <span class="mf">0.5</span>     <span class="mf">0.0</span>     <span class="mf">0.0</span>
</pre></div>
</div>
<p>The first line is a comment line required to switch on the use of PBC and the second line lists the cell dimension in <span class="math">x</span> direction <span class="math">Lx</span>, the ratio between <span class="math">Ly</span> and <span class="math">Lx</span> and the ratio between <span class="math">Lz</span> and <span class="math">Lx</span> . The last three numbers correspond to the phase of the wave-function along the direction <span class="math">x</span> , <span class="math">y</span> , <span class="math">z</span> . Zero is used for a periodic wavefunction and 0.5 for an antiperiodic along a given direction.</p>
</section>
<section id="the-coordinates">
<h3>The Coordinates<a class="headerlink" href="#the-coordinates" title="Permalink to this heading">¶</a></h3>
<p>After the header the coordinates of the nuclei are provided
in the same line. Starting from the left the first number is the
number of valence electron in the atom (atomic number <span class="math">Z</span> - number of core electrons considered in the pseudopotential), whereas the second number
is the atomic number <span class="math">Z</span> of the
atom (<span class="math">N \ne Z</span> with pseudopotential calculation).
The data are free format.
The coordinates are in atomic units (BOHR). For example for <span class="math">n</span> nuclei:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ion coordinates</span>
 <span class="n">N1</span> <span class="n">Z1</span>                <span class="n">x1</span>     <span class="n">y1</span>     <span class="n">z1</span>
 <span class="n">N2</span> <span class="n">Z2</span>                <span class="n">x2</span>     <span class="n">y2</span>     <span class="n">z2</span>
   <span class="o">..</span>                <span class="o">..</span>     <span class="o">..</span>     <span class="o">..</span>
 <span class="n">Nn</span> <span class="n">Zn</span>                <span class="n">xn</span>     <span class="n">yn</span>     <span class="n">zn</span>
</pre></div>
</div>
</section>
<section id="the-ionic-forces">
<h3>The Ionic Forces<a class="headerlink" href="#the-ionic-forces" title="Permalink to this heading">¶</a></h3>
<p>This part of FORT.10 lists the cartesian components of the nuclear forces that will be calculated and used for the structural optimazation or dynamics. The number of lines to be read is defined by the <strong>N.FORCES</strong> in the <strong>HEADER</strong>. If <strong>N.FORCES=0</strong> in the header, no line will be read. At the same time, it can eventually specify symmetries to be enforced on the nuclear coordinates. To identify a force component, two numbers have to be specified: the atom number (according to the ion coordinate list) and the cartesian component (1 for X, 2 for Y and 3 for Z). For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constraints for forces: ion - coordinate</span>
           <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">3</span>
</pre></div>
</div>
<p>The first number specifies that there is only one cartesian component in this line. The component is therefore independent of others (no symmetry). The component corresponds to atom 1, <span class="math">z</span> (i.e. 3) coordinate. In the following example, symmetry is specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constraints for forces: ion - coordinate</span>
           <span class="mi">2</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">2</span>      <span class="o">-</span><span class="mi">3</span>
</pre></div>
</div>
<p>The first number indicates that two components have to be read afterwards, forming a symmetry constraint. For each component as usual, two numbers are expected: the ion index followed by the kind of component (x, y or z). In the above case, the <span class="math">x</span> coordinate of nucleus number 1 and the <span class="math">z</span> coordinate of nucleus number 2 are set to have opposite values because the coordinate index for nucleus number 2 is negative (-3). If negative sign is not used, the two components would be set to be equal, i.e. with the following simpler input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constraints for forces: ion - coordinate</span>
           <span class="mi">2</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">2</span>      <span class="mi">3</span>
</pre></div>
</div>
</section>
<section id="the-2b-jastrow">
<h3>The 2B Jastrow<a class="headerlink" href="#the-2b-jastrow" title="Permalink to this heading">¶</a></h3>
<p>The parameter(s) of the 2B Jastrow are listed in one line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#      Parameters Jastrow two body</span>
       <span class="mi">1</span>  <span class="mf">0.549835086466315</span>
</pre></div>
</div>
<p>The absolute value of the first number, dubbed as <span class="math">iesd</span> in the code, indicates how many parameters have to be read (they depend on the Jastrow type) for iesdrr different from zero. The subsequent numbers in the same record are the 2B Jastrow parameters. If the first integer is negative the AGP function is not assumed to be symmetric. If no one-two body Jastrow is used (iesdrr=0) the records:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#           Parameters Jastrow two body</span>
            <span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<p>means AGP is not symmetric whereas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#           Parameters Jastrow two body</span>
            <span class="mi">0</span>
</pre></div>
</div>
<p>would be the standard symmetric case (not spin contaminated). In other cases (iesdrr not equal to zero) the sign of the first integer number determines the AGP symmetry as before, and its absolute value determines the following possibilities:</p>
<blockquote>
<div><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">iesd</span> <span class="pre">=</span> <span class="pre">1</span></code> the one body and two body Jastrow share the same variational parameter.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">iesd</span> <span class="pre">=</span> <span class="pre">2</span></code> there are two independent variational parameters one for the one-body Jastrow and one for the two-body Jastrow.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">iesd</span> <span class="pre">&gt;</span> <span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">iesd</span></code> should be equal to the number different atomic species in the system plus one (e.g. in water <span class="math">iesd = 3</span> because of two atomic species corresponding to H and O), because for each atomic species, we assume an independent variational parameter for the one-body Jastrow. The variational parameters are ordered from left to right in this record, in the order of increasing atomic number (e.g. in the water for example, the first one corresponds to the two-body term, the second to the Hydrogen one body parameter, and the third to the Oxygen one).</p></li>
</ul>
</div></blockquote>
</section>
<section id="the-basis-set-for-determinant">
<h3>The Basis Set for Determinant<a class="headerlink" href="#the-basis-set-for-determinant" title="Permalink to this heading">¶</a></h3>
<p>In this section the Basis Set used for expanding the JAGP determinant is described. There are a fixed number of lines to be read (2*NSHELL). Each shell of the determinant is described by two lines. The first one contains the multiplicity, the number of variational parameters of the shell function and the code describing the function. The code numbers and the description of the corresponding shell are described in the file makefun.f90 of the source code. The multiplicity depends on the shell type: Shells S, P and D have the multiplicities of 1, 3 and 5 respectively. In the second line the index of the nucleus on which the shell is centered is first indicated. Then the parameter values are listed. Keep in mind that the number of parameters to be read is given in the first line.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#            Parameters atomic wf</span>
<span class="n">Shell_Multiplicity</span>      <span class="n">Number</span> <span class="n">of</span> <span class="n">par</span><span class="o">.</span>               <span class="n">Shell</span> <span class="n">code</span>
<span class="n">Ion</span> <span class="n">index</span>               <span class="p">[</span><span class="n">par</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUMBER</span> <span class="n">OF</span> <span class="n">PAR</span><span class="o">.</span><span class="p">)]</span>

<span class="c1">#            Parameters atomic wf</span>
             <span class="mi">1</span>           <span class="mi">1</span>          <span class="mi">16</span>
             <span class="mi">1</span>  <span class="mf">0.500000000000000</span>
             <span class="mi">3</span>           <span class="mi">1</span>          <span class="mi">36</span>
             <span class="mi">1</span>   <span class="mf">1.00000000000000</span>
             <span class="mi">1</span>           <span class="mi">1</span>          <span class="mi">16</span>
             <span class="mi">2</span>  <span class="mf">0.300000000000000</span>
             <span class="mi">1</span>           <span class="mi">1</span>          <span class="mi">16</span>
             <span class="mi">3</span>  <span class="mf">0.300000000000000</span>
             <span class="mi">1</span>           <span class="mi">1</span>          <span class="mi">16</span>
             <span class="mi">4</span>  <span class="mf">0.300000000000000</span>
             <span class="mi">1</span>           <span class="mi">1</span>          <span class="mi">16</span>
             <span class="mi">5</span>  <span class="mf">0.300000000000000</span>
</pre></div>
</div>
<p>All primitive orbitals are written in the source file makefun.f90 (open boundary), makefun_pbc.f90 (pbc) and makefun_bump.f90 (finite range orbitals).</p>
<p>TurboRVB also implements standard contracted orbitals written  as a linear combination of <span class="math">p</span> primitive orbitals. The definitions are easily found (and can be easily implemented) in the fortran file: ioptorbcontr.f90. In this case, the number corresponding to “Number of par.” is equal to <span class="math">2p</span>. In the next line, one writes these extra coefficients, <span class="math">C_i, i = 1,...2p:</span> the coefficient <span class="math">C_{i+p}</span> acts on the orbital number defined by the contracted orbital written in “Shell code”, with exponent <span class="math">Z_i = C_i</span> (we omit the normalization, each orbital is assumed to be normalized), for instance a <span class="math">2s</span> contracted orbital:</p>
<div class="math">
<p><span class="math">\phi(r) = 3.231 \cdot \exp(-2.0 \cdot r^2) + 7.54 \cdot \exp(-1.0 \cdot r^2)</span></p>
</div><p>is written as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#       Parameters atomic wf</span>
     <span class="mi">1</span>             <span class="mi">4</span>         <span class="mi">300</span>
     <span class="mi">1</span>       <span class="mf">2.0</span>   <span class="mf">1.0</span>  <span class="mf">3.231</span>  <span class="mf">7.54</span>
</pre></div>
</div>
<p>Shell code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">16</span> <span class="o">-&gt;</span> <span class="n">s</span> <span class="n">orbital</span>
<span class="mi">36</span> <span class="o">-&gt;</span> <span class="n">p</span> <span class="n">orbital</span>
<span class="mi">68</span> <span class="o">-&gt;</span> <span class="n">d</span> <span class="n">orbital</span>
<span class="mi">48</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">orbital</span>
<span class="mi">51</span> <span class="o">-&gt;</span> <span class="n">g</span> <span class="n">orbital</span>
<span class="mi">72</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="n">orbital</span>
<span class="mi">73</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="n">orbital</span>
</pre></div>
</div>
</section>
<section id="molecular-orbital">
<h3>Molecular orbital<a class="headerlink" href="#molecular-orbital" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">convertfort10mol.x</span></code> can add molecular orbitals to <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>.</p>
<div class="math">
<p><span class="math">\tilde \Phi_k=\sum_{i=1}^{N_{\rm basis}}c_{i,k} \cdot \phi_i \left({\bm r} \right)</span></p>
</div><p>In <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>, <code class="docutils literal notranslate"><span class="pre">1000000</span></code> indicates a molecular orbital.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       <span class="c1">#always 1,   the number of components, 100000</span>
       <span class="c1">#index of basis [1,2,....]</span>
       <span class="c1">#coefficients for basis [1,2,....]</span>
        <span class="mi">1</span>         <span class="mi">180</span>     <span class="mi">1000000</span>
        <span class="mi">1</span>           <span class="mi">1</span>           <span class="mi">2</span>           <span class="mi">3</span>           <span class="mi">4</span>           <span class="mi">5</span>
        <span class="mi">6</span>           <span class="mi">7</span>           <span class="mi">8</span>           <span class="mi">9</span>          <span class="mi">10</span>          <span class="mi">11</span>
        <span class="mi">12</span>          <span class="mi">13</span>          <span class="mi">14</span>          <span class="mi">15</span>          <span class="mi">16</span>          <span class="mi">17</span>
        <span class="mi">18</span>          <span class="mi">19</span>          <span class="mi">20</span>          <span class="mi">21</span>          <span class="mi">22</span>          <span class="mi">23</span>
        <span class="mi">24</span>          <span class="mi">25</span>          <span class="mi">26</span>          <span class="mi">27</span>          <span class="mi">28</span>          <span class="mi">29</span>
        <span class="mi">30</span>          <span class="mi">31</span>          <span class="mi">32</span>          <span class="mi">33</span>          <span class="mi">34</span>          <span class="mi">35</span>
        <span class="mi">36</span>          <span class="mi">37</span>          <span class="mi">38</span>          <span class="mi">39</span>          <span class="mi">40</span>          <span class="mi">41</span>
        <span class="mi">42</span>          <span class="mi">43</span>          <span class="mi">44</span>          <span class="mi">45</span>          <span class="mi">46</span>          <span class="mi">47</span>
        <span class="mi">48</span>          <span class="mi">49</span>          <span class="mi">50</span>          <span class="mi">51</span>          <span class="mi">52</span>          <span class="mi">53</span>
        <span class="mi">54</span>          <span class="mi">55</span>          <span class="mi">56</span>          <span class="mi">57</span>          <span class="mi">58</span>          <span class="mi">59</span>
        <span class="mi">60</span>          <span class="mi">61</span>          <span class="mi">62</span>          <span class="mi">63</span>          <span class="mi">64</span>          <span class="mi">65</span>
        <span class="mi">66</span>          <span class="mi">67</span>          <span class="mi">68</span>          <span class="mi">69</span>          <span class="mi">70</span>          <span class="mi">71</span>
        <span class="mi">72</span>          <span class="mi">73</span>          <span class="mi">74</span>          <span class="mi">75</span>          <span class="mi">76</span>          <span class="mi">77</span>
        <span class="mi">78</span>          <span class="mi">79</span>          <span class="mi">80</span>          <span class="mi">81</span>          <span class="mi">82</span>          <span class="mi">83</span>
        <span class="mi">84</span>          <span class="mi">85</span>          <span class="mi">86</span>          <span class="mi">87</span>          <span class="mi">88</span>          <span class="mi">89</span>
        <span class="mi">90</span>  <span class="mf">0.438271164894104</span>      <span class="o">-</span><span class="mf">4.608166217803955E-002</span>
<span class="mf">0.189550578594208</span>       <span class="mf">7.299757003784180E-002</span> <span class="o">-</span><span class="mf">0.129178702831268</span>
<span class="o">-</span><span class="mf">0.241831779479980</span>      <span class="o">-</span><span class="mf">7.793867588043213E-002</span> <span class="o">-</span><span class="mf">0.143670558929443</span>
<span class="o">-</span><span class="mf">0.181271851062775</span>      <span class="o">-</span><span class="mf">0.265352427959442</span>       <span class="mf">0.374841809272766</span>
<span class="o">-</span><span class="mf">5.072158575057983E-002</span> <span class="o">-</span><span class="mf">0.286649286746979</span>       <span class="mf">0.421764492988586</span>
<span class="o">-</span><span class="mf">0.147124171257019</span>       <span class="mf">0.281676769256592</span>       <span class="mf">0.136297583580017</span>
<span class="o">-</span><span class="mf">6.065595149993896E-002</span> <span class="o">-</span><span class="mf">0.442295849323273</span>       <span class="mf">6.872278451919556E-002</span>
<span class="o">-</span><span class="mf">0.382538557052612</span>       <span class="mf">0.445110499858856</span>       <span class="mf">0.338095664978027</span>
<span class="o">-</span><span class="mf">6.700992584228516E-002</span> <span class="o">-</span><span class="mf">0.306204080581665</span>      <span class="o">-</span><span class="mf">0.206682741641998</span>
<span class="o">-</span><span class="mf">0.368851244449615</span>      <span class="o">-</span><span class="mf">0.185477197170258</span>       <span class="mf">0.275709867477417</span>
<span class="mf">4.901111125946045E-003</span> <span class="o">-</span><span class="mf">0.484303355216980</span>      <span class="o">-</span><span class="mf">0.346608221530914</span>
<span class="mf">0.117953181266785</span>      <span class="o">-</span><span class="mf">9.146583080291748E-002</span> <span class="o">-</span><span class="mf">0.450106739997864</span>
<span class="o">-</span><span class="mf">0.420913279056549</span>      <span class="o">-</span><span class="mf">5.812942981719971E-002</span>  <span class="mf">6.194984912872314E-002</span>
<span class="o">-</span><span class="mf">0.185146868228912</span>       <span class="mf">9.111911058425903E-002</span> <span class="o">-</span><span class="mf">0.494102835655212</span>
<span class="o">-</span><span class="mf">0.187083423137665</span>       <span class="mf">0.336221218109131</span>       <span class="mf">0.465211153030396</span>
<span class="o">-</span><span class="mf">0.328829050064087</span>       <span class="mf">0.109235763549805</span>      <span class="o">-</span><span class="mf">0.194452404975891</span>
<span class="mf">0.369445860385895</span>       <span class="mf">0.259138166904449</span>       <span class="mf">0.417137503623962</span>
<span class="mf">0.273341476917267</span>       <span class="mf">0.424752712249756</span>       <span class="mf">0.248025238513947</span>
<span class="o">-</span><span class="mf">0.142549693584442</span>       <span class="mf">0.235680162906647</span>       <span class="mf">0.194104492664337</span>
<span class="o">-</span><span class="mf">0.394946813583374</span>       <span class="mf">0.418918550014496</span>       <span class="mf">0.286247551441193</span>
<span class="o">-</span><span class="mf">0.165200054645538</span>      <span class="o">-</span><span class="mf">0.198730885982513</span>      <span class="o">-</span><span class="mf">0.141955792903900</span>
<span class="mf">0.255677580833435</span>       <span class="mf">0.398207664489746</span>      <span class="o">-</span><span class="mf">0.194129884243011</span>
<span class="o">-</span><span class="mf">0.355173707008362</span>      <span class="o">-</span><span class="mf">0.489923000335693</span>      <span class="o">-</span><span class="mf">0.488654732704163</span>
<span class="mf">0.106894016265869</span>       <span class="mf">6.377434730529785E-002</span> <span class="o">-</span><span class="mf">0.169396936893463</span>
<span class="o">-</span><span class="mf">7.532972097396851E-002</span>  <span class="mf">5.515247583389282E-002</span>  <span class="mf">0.329569637775421</span>
<span class="mf">4.597079753875732E-002</span>  <span class="mf">0.160456597805023</span>      <span class="o">-</span><span class="mf">0.421718478202820</span>
<span class="mf">0.326750636100769</span>       <span class="mf">0.339765250682831</span>       <span class="mf">0.246131539344788</span>
<span class="mf">6.178361177444458E-002</span>  <span class="mf">0.332796216011047</span>      <span class="o">-</span><span class="mf">9.556728601455688E-002</span>
<span class="mf">0.266949594020844</span>      <span class="o">-</span><span class="mf">5.606234073638916E-002</span> <span class="o">-</span><span class="mf">0.166017174720764</span>
<span class="mf">0.363827764987946</span>       <span class="mf">0.222376465797424</span>       <span class="mf">0.321450889110565</span>
<span class="mf">0.293389737606049</span>
</pre></div>
</div>
<p>Note that the paring function is represented by molecular orbitals as follows:</p>
<div class="math">
<p><span class="math">f\left( {{{\mathbf{r}}_i},{{\mathbf{r}}_j}} \right) = \sum\limits_{k=1}^{M} {{{\lambda}_{k}}{\tilde \Phi _{k}}\left( {{{\mathbf{r}}_i}} \right){\tilde \Phi _{k}}\left( {{{\mathbf{r}}_j}} \right)}</span></p>
</div><p>We recover the standard Slater determinant by using <span class="math">M = N_{\rm electron}/2</span>.</p>
</section>
<section id="hybrid-orbital">
<h3>Hybrid orbital<a class="headerlink" href="#hybrid-orbital" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">convertfort10.x</span></code> can add hybrid orbitals to <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>.</p>
<div class="math">
<p><span class="math">\tilde{\Phi}_{k}^{a}=\sum_{i}^{N_{basis}^{a}}c_{i,k}^{a} \cdot \phi_{i}^{a} \left({\bm r} \right)</span></p>
</div><p>In <code class="docutils literal notranslate"><span class="pre">fort.10</span></code>, <code class="docutils literal notranslate"><span class="pre">900000</span></code> indicates a hybrid orbital.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="c1">#atom index,   the number of components, 900000</span>
          <span class="c1">#index of basis [1,2,....]</span>
          <span class="c1">#coefficients for basis [1,2,....]</span>
          <span class="mi">1</span>          <span class="mi">90</span>      <span class="mi">900000</span>
          <span class="mi">1</span>           <span class="mi">1</span>           <span class="mi">2</span>           <span class="mi">3</span>           <span class="mi">4</span>           <span class="mi">5</span>
          <span class="mi">6</span>           <span class="mi">7</span>           <span class="mi">8</span>           <span class="mi">9</span>          <span class="mi">10</span>          <span class="mi">11</span>
         <span class="mi">12</span>          <span class="mi">13</span>          <span class="mi">14</span>          <span class="mi">15</span>          <span class="mi">16</span>          <span class="mi">17</span>
         <span class="mi">18</span>          <span class="mi">19</span>          <span class="mi">20</span>          <span class="mi">21</span>          <span class="mi">22</span>          <span class="mi">23</span>
         <span class="mi">24</span>          <span class="mi">25</span>          <span class="mi">26</span>          <span class="mi">27</span>          <span class="mi">28</span>          <span class="mi">29</span>
         <span class="mi">30</span>          <span class="mi">31</span>          <span class="mi">32</span>          <span class="mi">33</span>          <span class="mi">34</span>          <span class="mi">35</span>
         <span class="mi">36</span>          <span class="mi">37</span>          <span class="mi">38</span>          <span class="mi">39</span>          <span class="mi">40</span>          <span class="mi">41</span>
         <span class="mi">42</span>          <span class="mi">43</span>          <span class="mi">44</span>          <span class="mi">45</span>  <span class="mf">4.415629124781804E-004</span>
<span class="o">-</span><span class="mf">2.665471779107012E-003</span>  <span class="mf">6.462432564128138E-003</span> <span class="o">-</span><span class="mf">2.835419348050690E-002</span>
<span class="o">-</span><span class="mf">1.801631060924397E-003</span>  <span class="mf">0.000000000000000E+000</span>  <span class="mf">0.488607316300470</span>
 <span class="o">-</span><span class="mf">1.08438499459258</span>        <span class="mf">1.00000000000000</span>      <span class="o">-</span><span class="mf">8.862166918962697E-002</span>
<span class="o">-</span><span class="mf">3.585186058053676E-006</span>  <span class="mf">1.336604741376926E-005</span> <span class="o">-</span><span class="mf">1.034531513737405E-002</span>
<span class="o">-</span><span class="mf">9.682848944243672E-005</span>  <span class="mf">7.780031865084339E-005</span> <span class="o">-</span><span class="mf">2.330742724611005E-002</span>
 <span class="mf">2.406091695918141E-004</span> <span class="o">-</span><span class="mf">1.314165271323025E-004</span> <span class="o">-</span><span class="mf">1.383980745357883E-002</span>
<span class="o">-</span><span class="mf">8.265782808695380E-005</span>  <span class="mf">6.484551172622954E-005</span> <span class="o">-</span><span class="mf">6.461899158835088E-002</span>
<span class="o">-</span><span class="mf">1.224707476287876E-003</span>  <span class="mf">3.784895470189310E-004</span> <span class="o">-</span><span class="mf">0.150215939301643</span>
 <span class="mf">3.279641185411990E-003</span>  <span class="mf">4.146447536354074E-004</span> <span class="o">-</span><span class="mf">5.370349262603082E-002</span>
<span class="o">-</span><span class="mf">2.867011651206949E-003</span> <span class="o">-</span><span class="mf">6.433419048360544E-004</span> <span class="o">-</span><span class="mf">0.169339132045330</span>
 <span class="mf">0.000000000000000E+000</span>  <span class="mf">0.000000000000000E+000</span>  <span class="mf">5.388221636070670E-002</span>
 <span class="mf">3.865987502185416E-004</span>  <span class="mf">1.537139475756473E-004</span> <span class="o">-</span><span class="mf">0.134079774055112</span>
<span class="o">-</span><span class="mf">4.310821717930281E-004</span> <span class="o">-</span><span class="mf">2.609351310060059E-004</span>  <span class="mf">2.739963165919702E-002</span>
 <span class="mf">2.693581696773797E-002</span> <span class="o">-</span><span class="mf">3.679623706959143E-005</span>  <span class="mf">1.393726496455493E-004</span>
<span class="o">-</span><span class="mf">1.728876043016380E-004</span>  <span class="mf">1.648834534792205E-004</span>
</pre></div>
</div>
</section>
<section id="the-basis-set-for-3b-jastrow">
<h3>The Basis Set for 3B Jastrow<a class="headerlink" href="#the-basis-set-for-3b-jastrow" title="Permalink to this heading">¶</a></h3>
<p>This section describes the Basis Set used to expand the 3B Jastrow. The data are organized as in the section <strong>Basis Set for Determinant</strong>. The code number for the shells used for expanding the 3B Jastrow is also described in makefun.f90.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#       Parameters atomic Jastrow wf</span>
    <span class="mi">1</span>              <span class="mi">0</span>      <span class="mi">200</span>
        <span class="mi">1</span>
        <span class="mi">1</span>          <span class="mi">1</span>       <span class="mi">1000</span>
        <span class="mi">1</span>  <span class="mf">0.993536719652206</span>
</pre></div>
</div>
<p>Similar to the determinantal case, one can insert contracted orbitals in the Jastrow basis (see ioptorbcontr.f90 for the definition/implementation). The only difference is that, in this case, the orbitals are not normalized. Also, when working with periodic boundary conditions, they are periodized always without any twist, as it should. The <span class="math">2s</span> contraction defined above reads in the Jastrow basis section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#      Parameters atomic Jastrow wf</span>
       <span class="mi">1</span>           <span class="mi">4</span>          <span class="mi">3000</span>
   <span class="mi">1</span>      <span class="mf">2.0</span>  <span class="mf">1.0</span> <span class="mf">3.231</span>  <span class="mf">7.54</span>
</pre></div>
</div>
</section>
<section id="occupation-determinant-orbitals">
<h3>Occupation Determinant Orbitals<a class="headerlink" href="#occupation-determinant-orbitals" title="Permalink to this heading">¶</a></h3>
<p>This part provides the occupation state of the determinant orbitals. The number of lines is <span class="math">\sum_{i}^{NSHELL} shell\_multiplicity(i)</span>. If occupied the orbital takes value of one, and otherwise zero. The orbitals are numbered as in the <strong>Basis Set for Determinant</strong>. Keep in mind that a shell P counts for three orbitals  and a shell D counts five orbitals:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#    Occupation atomic orbitals</span>
       <span class="mi">1</span>
       <span class="mi">1</span>
       <span class="mi">1</span>
       <span class="mi">1</span>
       <span class="mi">1</span>
       <span class="mi">1</span>
       <span class="mi">1</span>
       <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="occupation-jastrow-orbitals">
<h3>Occupation Jastrow Orbitals<a class="headerlink" href="#occupation-jastrow-orbitals" title="Permalink to this heading">¶</a></h3>
<p>This part provides the occupation state of the Jastrow orbitals. See above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#    Occupation atomic orbitals Jastrow</span>
       <span class="mi">1</span>
       <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="coefficient-of-the-determinant-a-matrix-different-from-zero">
<h3>Coefficient of the Determinant <span class="math">A</span> Matrix different from zero<a class="headerlink" href="#coefficient-of-the-determinant-a-matrix-different-from-zero" title="Permalink to this heading">¶</a></h3>
<p>For simplicity, we consider a system with an even number <span class="math">N</span> of electrons here.
The WF, written in terms of pairing functions, is</p>
<div class="math">
<p><span class="math">\Phi_\text{AS} (\mathbf{1},\ldots,\mathbf{N}) = {\cal A} \left\{ g(\mathbf{1},\mathbf{2}) g(\mathbf{3},\mathbf{4}) \ldots g(\mathbf{N-1},\mathbf{N}) \right\},</span></p>
</div><p>where <span class="math">{\cal A}</span> is the antisymmetrization operator</p>
<div class="math">
<p><span class="math">{\cal A} \equiv {1\over N!} \sum_{P\in S_N} \epsilon_P \hat P,</span></p>
</div><p><span class="math">S_N</span> the permutation group of <span class="math">N</span> elements, <span class="math">\hat P</span> the operator corresponding to the generic permutation <span class="math">P</span>, and <span class="math">\epsilon_P</span> its sign.</p>
<p>Let us define <span class="math">G</span> the <span class="math">N\times N</span> matrix with elements <span class="math">G_{i,j} = g(\mathbf{i},\mathbf{j})</span>.Notice that</p>
<div class="math">
<p><span class="math">g(\mathbf{i},\mathbf{j}) = -g(\mathbf{j},\mathbf{i}) \; (\text{and} \; G_{i,j} = -G_{j,i}),</span></p>
</div><p>as a consequence of the statistics of fermionic particles, thus <span class="math">G</span> is skew-symmetric ({it i.e.}, <span class="math">G^T = -G</span>, being <span class="math">^T</span> the transpose operator), so the diagonal is zero and the number of independent entries is <span class="math">\sum_{n=1}^{N-1} n = N(N-1)/2</span>.</p>
<p>The most general representation of a many-body wavefunction in TurboRVB is
the Pfaffian of a <span class="math">N\times N</span> skew-symmetrix matrix <span class="math">G</span> is defined as</p>
<div class="math">
<p><span class="math">\Phi_\text{Pf} = \text{Pf}(G) \equiv {1\over 2^{N/2} (N/2)!} \sum_{P\in S_N} \epsilon_P G_{P(1),P(2)} \cdots G_{P(N-1),P(N)}</span></p>
</div><p>Notice that the <span class="math">\Phi_\text{Pf}</span> here defined allows the description of  any system with <span class="math">N_u</span> electrons with spin-up and <span class="math">N_d</span> electrons with spin-down, provided that <span class="math">N=N_u+N_d</span> is even. Indeed, with no loss of generality, we can assume that electrons <span class="math">i=1,\ldots,N_u</span> have <span class="math">\sigma_i=1/2</span> and electrons with <span class="math">i=N_u+1,\ldots,N</span> have <span class="math">\sigma_i=-1/2</span>.
Thus, the <span class="math">N\times N</span> skew-symmetric matrix <span class="math">G</span> is written as:</p>
<div class="math">
<p><span class="math">G = \left[\begin{array}{c|c} G_{uu} &amp; G_{ud} \\ \hline
G_{du} &amp; G_{dd}\end{array}\right]</span></p>
</div><p>where,</p>
<ul class="simple">
<li><p><span class="math">G_{uu}</span> is a <span class="math">N_u\times N_u</span> skew-symmetric matrix with elements <span class="math">g_{uu}(\mathbf{i},\mathbf{j})</span>,</p></li>
<li><p><span class="math">G_{dd}</span> is a <span class="math">N_d\times N_d</span> skew-symmetric matrix with elements <span class="math">g_{dd}(\mathbf{i},\mathbf{j})</span>,</p></li>
<li><p><span class="math">G_{ud}</span> is a <span class="math">N_u\times N_d</span> matrix with elements <span class="math">g_{ud}(\mathbf{i},\mathbf{j})</span>, and</p></li>
<li><p><span class="math">G_{du} = -{G_{ud}}^T</span>, i.e., <span class="math">g_{du}(\mathbf{i},\mathbf{j})=-g_{ud}(\mathbf{j},\mathbf{i})</span>.</p></li>
</ul>
<p><span class="math">g_{uu}</span> describes the pairing between a pair of electrons with spin-up:</p>
<div class="math">
<p><span class="math">g_{uu}(\mathbf{i},\mathbf{j}) = f_{uu}({\bf r}_i,{\bf r}_j) \left| \uparrow  \uparrow \right\rangle</span></p>
</div><p>where the function <span class="math">f_{uu}</span> describes the spatial dependence on the coordinates <span class="math">{\bf r}_i,{\bf r}_j</span> for <span class="math">i,j\le N_u</span>. The spin part <span class="math">\left| \uparrow  \uparrow \right\rangle</span> describes a system with unit total spin  and spin projection along the z-axis,  and will be indicated by <span class="math">\left| 1, +1 \right\rangle</span>.</p>
<p>Similarly, <span class="math">g_{dd}</span> describes the pairing between pairs of electrons with spin-down for <span class="math">i,j&gt; N_u</span>:</p>
<div class="math">
<p><span class="math">g_{dd}(\mathbf{i},\mathbf{j}) = f_{dd}({\bf r}_i,{\bf r}_j) \left| \downarrow  \downarrow \right\rangle</span></p>
</div><p>with <span class="math">f_{dd}({\bf r}_j,{\bf r}_i) = - f_{dd}({\bf r}_i,{\bf r}_j) , and the spin part :math:</span>left| downarrow  downarrow rightrangle` describes a system with total unit spin  and negative spin projection along the z-axis, indicated with <span class="math">\left| 1, -1 \right\rangle</span>.</p>
<p><span class="math">g_{ud}</span> describes the pairing between pairs of electrons with unlike spins.
Since two electrons with unlike spins can form a singlet
<span class="math">\left| 0,0 \right\rangle = { {\left| \uparrow  \downarrow \right\rangle - \left| \downarrow  \uparrow \right\rangle}\over \sqrt{2}}</span>
or a triplet <span class="math">\left| 1,0 \right\rangle = { {\left| \uparrow  \downarrow \right\rangle + \left| \downarrow  \uparrow \right\rangle}\over \sqrt{2}}</span>, in the general case
the pairing function <span class="math">g_{ud}</span> will be a linear combination of the the two components:</p>
<div class="math">
<p><span class="math">g_{ud}(\mathbf{i},\mathbf{j}) = f_{S}({\bf r}_i,{\bf r}_j) { {\left| \uparrow  \downarrow \right\rangle - \left| \downarrow  \uparrow \right\rangle}\over \sqrt{2}} + f_{T}({\bf r}_i,{\bf r}_j) { {\left| \uparrow  \downarrow \right\rangle + \left| \downarrow  \uparrow \right\rangle}\over \sqrt{2}}</span></p>
</div><p>where <span class="math">f_{S}({\bf r}_i,{\bf r}_j) = f_{S}({\bf r}_j,{\bf r}_i)</span> describes the spatial dependence of the singlet part of <span class="math">g_{ud}</span>, and <span class="math">f_{T}({\bf r}_i,{\bf r}_j) = -f_{T}({\bf r}_j,{\bf r}_i)</span> describes the spatial dependence of the triplet part.</p>
<p>Indeed, the generic pairing function <span class="math">g(\mathbf{i},\mathbf{j})</span> is the sum of  all the four components mentioned above, namely :</p>
<div class="math">
<p><span class="math">\begin{split}
g\left( \mathbf{i},\mathbf{j} \right)
&amp;= f_{S}({\bf r}_i,{\bf r}_j) \left| 0,0 \right\rangle + f_{T}({\bf r}_i,{\bf r}_j) \left| 1,0 \right\rangle \\
&amp;+ f_{uu}({\bf r}_i,{\bf r}_j) \left| 1,+1 \right\rangle + f_{dd}({\bf r}_i,{\bf r}_j) \left| 1,-1 \right\rangle \,.
\end{split}</span></p>
</div><p>The pairing functions <span class="math">f_{S}</span>, <span class="math">f_{T}</span>, <span class="math">f_{uu}</span>, and <span class="math">f_{dd}</span> are expanded over atomic orbitals Say, for a generic pairing function <span class="math">f</span> we have</p>
<div class="math">
<p><span class="math">f\left( {{{\mathbf{r}}_i},{{\mathbf{r}}_j}} \right) = \sum\limits_{l,m,a,b} {{{A}_{\left\{ {a,l} \right\},\left\{ {b,m} \right\}}}{\psi _{a,l}}\left( {{{\mathbf{r}}_i}} \right){\psi _{b,m}}\left( {{{\mathbf{r}}_j}} \right)},</span></p>
</div><p>where <span class="math">{\psi_{a,l}}</span> and <span class="math">{\psi_{b,m}}</span> are primitive or contracted atomic orbitals, their indices <span class="math">l</span> and <span class="math">m</span> indicate different orbitals centered on atoms <span class="math">a</span> and <span class="math">b</span>, while <span class="math">i</span> and <span class="math">j</span> label the electron coordinates.</p>
<p>Symmetries on the system, or properties of the underlying pairing function <span class="math">f</span> imply constraints on the coefficients. For instance, the coefficients of <span class="math">f_{S}</span> are such that <span class="math">A_{\left\{ {a,l} \right\},\left\{ {b,m} \right\}} = A_{\left\{ {b,m} \right\},\left\{ {a,l} \right\}}</span> because <span class="math">f_{S}({\bf r}_i,{\bf r}_j) = f_{S}({\bf r}_j,{\bf r}_i)</span>, whereas <span class="math">A_{\left\{ {a,l} \right\},\left\{ {b,m} \right\}} = -A_{\left\{ {b,m} \right\},\left\{ {a,l} \right\}}</span> for <span class="math">f_{T}</span>, <span class="math">f_{uu}</span>, and <span class="math">f_{dd}</span>.</p>
<p>In this part, all the values <span class="math">{A}_{\left\{ {a,l} \right\}}</span> different from zero are listed. The first two numbers indicate the orbital indices of the determinant <span class="math">A</span> matrix, the third number is the value for <span class="math">{A}_{\left\{ {a,l} \right\}}</span>. The number of elements different from zero is indicated in the <strong>Header</strong>: see <span class="math">DET \neq 0</span>.</p>
</section>
<section id="jsagps">
<h3>JsAGPs<a class="headerlink" href="#jsagps" title="Permalink to this heading">¶</a></h3>
<p>The simplest choice of considering only the case of a pairing function <span class="math">g(\mathbf{i},\mathbf{j})</span> that is a spin singlet (namely, <span class="math">f_{uu}</span>, <span class="math">f_{dd}</span> <span class="math">f_{T}</span> are set to zero, yielding <span class="math">g(\mathbf{i},\mathbf{j})=f_{S}({\bf r}_i,{\bf r}_j) \left| 0,0 \right\rangle</span>) then we obtain the singlet Antisymmetrized Geminal Power.</p>
<p>In this case, the matrices <span class="math">G_{uu}</span> and <span class="math">G_{dd}</span> defined are both zero matrices of size <span class="math">N/2\times N/2</span>, and the matrix <span class="math">G_{ud}</span> has only the contribution coming from the singlet, that we dub <span class="math">G_S</span> with <span class="math">G_S^T=G_S</span>.</p>
<p>The antisymmetrization operator implies the computation of</p>
<div class="math">
<p><span class="math">{\text{Pf}\left({\begin{array}{c|c} 0 &amp; G_{S} \\ \hline
               -G_{S}^T &amp; 0\end{array}}\right)}
= (-1)^{N/2\times (N/2-1)\over 2} \det(G_S)</span></p>
</div><p>where the equality follows from a property of the Pfaffian.
The overall sign is arbitrary for a WF; thus the antisymmetrized product of singlet pairs (geminals) is indeed equivalent to the computation of the determinant of the matrix <span class="math">G_S</span>:</p>
<div class="math">
<p><span class="math">\Phi_\text{AGPs} = \det(G_S) \,.</span></p>
</div><p>This is called <code class="docutils literal notranslate"><span class="pre">JsAGPs</span></code>. Indeed, we consider only the singlet part of the paring function:</p>
<div class="math">
<p><span class="math">g_{ud}(\mathbf{i},\mathbf{j}) \equiv g_{s}(\mathbf{i},\mathbf{j}) = f_{S}({\bf r}_i,{\bf r}_j) { {\left| \uparrow  \downarrow \right\rangle - \left| \downarrow  \uparrow \right\rangle}\over \sqrt{2}},</span></p>
</div><p>where</p>
<div class="math">
<p><span class="math">f_{S}\left( {{{\mathbf{r}}_i},{{\mathbf{r}}_j}} \right) = \sum\limits_{l,m,a,b} {{{A}_{\left\{ {a,l} \right\},\left\{ {b,m} \right\}}}{\psi _{a,l}}\left( {{{\mathbf{r}}_i}} \right){\psi _{b,m}}\left( {{{\mathbf{r}}_j}} \right)}.</span></p>
</div><p>We have assumed the <span class="math">A</span> matrix is symmetric for the AGPs WF, only <span class="math">A_{ij}</span> for <span class="math">i \le j</span> are provided in this section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#          Nonzero values of detmat</span>
           <span class="mi">1</span>       <span class="mi">5</span>      <span class="mf">9.421753101774391E-002</span>
           <span class="mi">1</span>       <span class="mi">6</span>      <span class="mf">9.421753101774391E-002</span>
           <span class="mi">1</span>       <span class="mi">7</span>      <span class="mf">9.421753101774391E-002</span>
</pre></div>
</div>
<div class="math">
<p><span class="math">A =
\begin{pmatrix}
A_{11}          &amp; A_{12} &amp; \dots  &amp; A_{1n} \\
                &amp; A_{22} &amp; \dots  &amp; A_{2n} \\
                &amp;        &amp; \ddots &amp; \vdots \\
                &amp;        &amp;        &amp; A_{nn}
\end{pmatrix}</span></p>
</div><p>Please note that all <span class="math">A</span> parameters that are not explicitly declared in these lines are set to zero and are never optimized.</p>
</section>
<section id="jagpu">
<h3>JAGPu<a class="headerlink" href="#jagpu" title="Permalink to this heading">¶</a></h3>
<p>It should be noticed that it is not necessary that the matrix <span class="math">G_{ud}</span> is symmetric to reduce the Pfaffian to a single determinant evaluation. As long as the matrices <span class="math">G_{uu}</span> and <span class="math">G_{dd}</span> are zero, the Pfaffian is indeed equivalent to <span class="math">\det(G_{ud})</span> and describes an antisymmetric WF. However, if <span class="math">G_{ud}</span> is not symmetric the function</p>
<div class="math">
<p><span class="math">\Phi_\text{AGP} = \det(G_{ud})</span></p>
</div><p>is not an eigenstate of the spin. In other terms, there is a spin contamination, similarly to the case of unrestricted HF calculations. This is called <code class="docutils literal notranslate"><span class="pre">JAGPu</span></code>. Indeed, we consider both singlet and triplet functions</p>
<div class="math">
<p><span class="math">g_{ud}(\mathbf{i},\mathbf{j}) = f_{S}({\bf r}_i,{\bf r}_j) { {\left| \uparrow  \downarrow \right\rangle - \left| \downarrow  \uparrow \right\rangle}\over \sqrt{2}} + f_{T}({\bf r}_i,{\bf r}_j) { {\left| \uparrow  \downarrow \right\rangle + \left| \downarrow  \uparrow \right\rangle}\over \sqrt{2}},</span></p>
</div><p>where</p>
<div class="math">
<p><span class="math">f_{X=S,T}\left( {{{\mathbf{r}}_i},{{\mathbf{r}}_j}} \right) = \sum\limits_{l,m,a,b} {{{A}_{\left\{ {a,l} \right\},\left\{ {b,m} \right\}}}{\psi _{a,l}}\left( {{{\mathbf{r}}_i}} \right){\psi _{b,m}}\left( {{{\mathbf{r}}_j}} \right)},</span></p>
</div><p>As written above, <span class="math">A</span> matrix is symmetric and skew-symmetric for the singlet part (<span class="math">f_{S}</span>) and the triplet parts (<span class="math">f_{T}</span>) respectively. So <span class="math">A_{ij}</span> for <span class="math">i \le j</span> and <span class="math">A_{ij}</span> for <span class="math">i &gt; j</span> are the coefficients of the singlet and the triplet parts, respectively (i.e., the element <span class="math">i = j</span> of the skew-symmetric matrix should be zero):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#          Nonzero values of detmat</span>
         <span class="mi">1</span>       <span class="mi">1</span>       <span class="mf">8.321544938822982E-001</span> <span class="o">&lt;-</span> <span class="n">singlet</span>
         <span class="o">....</span>
         <span class="mi">1</span>       <span class="mi">5</span>       <span class="mf">9.421753101774391E-002</span> <span class="o">&lt;-</span> <span class="n">singlet</span>
         <span class="mi">1</span>       <span class="mi">6</span>       <span class="mf">9.421753101774391E-002</span>
         <span class="mi">1</span>       <span class="mi">7</span>       <span class="mf">9.421753101774391E-002</span>
         <span class="mi">2</span>       <span class="mi">1</span>       <span class="mf">3.485892384239842E-003</span> <span class="o">&lt;-</span> <span class="n">triplet</span>
         <span class="mi">2</span>       <span class="mi">2</span>       <span class="mf">3.589529849283749E-001</span> <span class="o">&lt;-</span> <span class="n">singlet</span>
         <span class="mi">2</span>       <span class="mi">3</span>       <span class="mf">2.489548797987997E-002</span> <span class="o">&lt;-</span> <span class="n">singlet</span>
         <span class="mi">3</span>       <span class="mi">1</span>       <span class="mf">1.112333456889842E-003</span> <span class="o">&lt;-</span> <span class="n">triplet</span>
         <span class="mi">3</span>       <span class="mi">2</span>       <span class="mf">2.585777744345490E-001</span> <span class="o">&lt;-</span> <span class="n">triplet</span>
         <span class="mi">3</span>       <span class="mi">3</span>       <span class="mf">3.936485649473937E-002</span> <span class="o">&lt;-</span> <span class="n">singlet</span>
</pre></div>
</div>
<div class="math">
<p><span class="math">A_S =
\begin{pmatrix}
A_{11}          &amp; A_{12} &amp; \dots  &amp; A_{1n} \\
                &amp; A_{22} &amp; \dots  &amp; A_{2n} \\
                &amp;        &amp; \ddots &amp; \vdots \\
                &amp;        &amp;        &amp; A_{nn}
\end{pmatrix}</span></p>
</div><div class="math">
<p><span class="math">A_T=
\begin{pmatrix}
0      &amp; -A_{21} &amp; \dots  &amp; -A_{n1} \\
A_{21} &amp; 0       &amp; \dots  &amp; -A_{n2} \\
\vdots &amp; \vdots  &amp; \ddots &amp; \vdots \\
A_{n1} &amp; A_{n2}  &amp; \dots  &amp; 0
\end{pmatrix}</span></p>
</div></section>
<section id="jagp-jpf">
<h3>JAGP (JPf)<a class="headerlink" href="#jagp-jpf" title="Permalink to this heading">¶</a></h3>
<p>The most general case is the Pfaffian ansatz, which is called <code class="docutils literal notranslate"><span class="pre">JAGP</span></code> or <code class="docutils literal notranslate"><span class="pre">JPf</span></code> in TurboRVB.
<span class="math">A_{ij}</span> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is a C2-dimer case</span>
<span class="c1"># The number of basis set for each carbon is 4</span>

<span class="c1">#       Nonzero values of detmat</span>
                                               <span class="o">&lt;-</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="ow">is</span> <span class="n">always</span> <span class="n">zero</span> <span class="p">(</span><span class="n">G</span> <span class="ow">is</span> <span class="n">skew</span><span class="o">-</span><span class="n">symmetric</span><span class="p">)</span><span class="o">.</span>
        <span class="mi">1</span>           <span class="mi">2</span> <span class="o">-</span><span class="mf">2.917621798712210E-002</span>  <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">up</span><span class="p">},</span> <span class="n">triplet</span>
        <span class="mi">1</span>           <span class="mi">3</span>  <span class="mf">8.326474500954891E-003</span>  <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">up</span><span class="p">},</span> <span class="n">triplet</span>
        <span class="mi">1</span>           <span class="mi">4</span> <span class="o">-</span><span class="mf">0.228326252284219</span>       <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">up</span><span class="p">},</span> <span class="n">triplet</span>
        <span class="mi">1</span>           <span class="mi">5</span>  <span class="mf">0.470855192339553</span>       <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">up</span><span class="p">},</span> <span class="n">triplet</span>
        <span class="mi">1</span>           <span class="mi">6</span> <span class="o">-</span><span class="mf">3.285258904186700E-002</span>  <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">up</span><span class="p">},</span> <span class="n">triplet</span>
        <span class="mi">1</span>           <span class="mi">7</span> <span class="o">-</span><span class="mf">5.097409720647310E-003</span>  <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">up</span><span class="p">},</span> <span class="n">triplet</span>
        <span class="mi">1</span>           <span class="mi">8</span>  <span class="mf">5.679495868355650E-002</span>  <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">up</span><span class="p">},</span> <span class="n">triplet</span>
        <span class="mi">1</span>           <span class="mi">9</span>  <span class="mf">0.684164602152446</span>       <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">dn</span><span class="p">},</span> <span class="n">singlet</span>
        <span class="o">....</span>
        <span class="mi">1</span>          <span class="mi">16</span> <span class="o">-</span><span class="mf">0.104285811627841</span>       <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">dn</span><span class="p">},</span> <span class="n">singlet</span>
        <span class="mi">2</span>           <span class="mi">3</span> <span class="o">-</span><span class="mf">2.076224374212450E-002</span>  <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">up</span><span class="p">},</span> <span class="n">triplet</span>
        <span class="o">...</span>
        <span class="mi">2</span>           <span class="mi">8</span> <span class="o">-</span><span class="mf">4.145465677435435E-003</span>  <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">up</span><span class="p">},</span> <span class="n">triplet</span>
        <span class="mi">2</span>           <span class="mi">9</span>  <span class="mf">3.735515724267560E-003</span>  <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">dn</span><span class="p">},</span> <span class="n">triplet</span>
        <span class="mi">2</span>          <span class="mi">10</span>  <span class="mf">0.520587530210701</span>       <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">dn</span><span class="p">},</span> <span class="n">singlet</span>
        <span class="o">...</span>
        <span class="mi">2</span>          <span class="mi">16</span>  <span class="mf">4.428757569068110E-003</span>  <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">up</span><span class="p">,</span><span class="n">dn</span><span class="p">},</span> <span class="n">singlet</span>
        <span class="o">...</span>
        <span class="mi">9</span>          <span class="mi">10</span>  <span class="mf">4.813787735439980E-003</span>  <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">dn</span><span class="p">,</span><span class="n">dn</span><span class="p">},</span> <span class="n">triplet</span>
        <span class="o">...</span>
       <span class="mi">15</span>          <span class="mi">16</span>  <span class="mf">9.827312227017149E-003</span>  <span class="o">&lt;-</span> <span class="n">A_</span><span class="p">{</span><span class="n">dn</span><span class="p">,</span><span class="n">dn</span><span class="p">},</span> <span class="n">triplet</span>
</pre></div>
</div>
<div class="math">
<p><span class="math">\begin{align*}
    A = \left[\begin{array}{c|c} A_{\text{up}-\text{up}} &amp; A_{\text{up}-\text{dn}} \\ \hline
    A_{\text{dn}-\text{up}} &amp; A_{\text{dn}-\text{dn}}\end{array}\right]
\end{align*}</span></p>
</div><p>where</p>
<div class="math">
<p><span class="math">A_{\text{up}-\text{up}}=
\begin{pmatrix}
0      &amp; A_{1,2}  &amp; \dots  &amp; A_{1,8} \\
-A_{1,2} &amp; 0       &amp; \dots  &amp; A_{2,8} \\
\vdots &amp; \vdots  &amp; \ddots &amp; \vdots \\
-A_{1,8} &amp; -A_{2,8}  &amp; \dots  &amp; 0
\end{pmatrix}</span></p>
</div><div class="math">
<p><span class="math">A_{\text{dn}-\text{dn}}=
\begin{pmatrix}
0      &amp; A_{9,10}  &amp; \dots  &amp; A_{9,16} \\
-A_{9,10} &amp; 0       &amp; \dots  &amp; A_{10,16} \\
\vdots &amp; \vdots  &amp; \ddots &amp; \vdots \\
-A_{9,16} &amp; -A_{10,16}  &amp; \dots  &amp; 0
\end{pmatrix}</span></p>
</div><p>and for the <span class="math">A_{\text{up}-\text{dn}}</span> part,</p>
<div class="math">
<p><span class="math">A_S =
\begin{pmatrix}
A_{1,9}         &amp; A_{1,10} &amp; \dots  &amp; A_{1,16} \\
                &amp; A_{2,10} &amp; \dots  &amp; A_{2,16} \\
                &amp;        &amp; \ddots &amp; \vdots \\
                &amp;        &amp;        &amp; A_{8,16}
\end{pmatrix}</span></p>
</div><div class="math">
<p><span class="math">A_T=
\begin{pmatrix}
0       &amp; -A_{2,9} &amp; \dots  &amp; -A_{8,9} \\
A_{2,9} &amp; 0        &amp; \dots  &amp; -A_{8,10} \\
\vdots &amp; \vdots    &amp; \ddots &amp; \vdots \\
A_{8,9} &amp; A_{8,10}  &amp; \dots  &amp; 0
\end{pmatrix}</span></p>
</div></section>
<section id="symmetries-of-the-determinant-a-matrix">
<h3>Symmetries of the Determinant <span class="math">A</span> matrix<a class="headerlink" href="#symmetries-of-the-determinant-a-matrix" title="Permalink to this heading">¶</a></h3>
<p>This part lists all the symmetries involving the elements of the Determinant <span class="math">A</span> matrix. Each line indicates a symmetry (see <strong>DET_L (iessw)</strong>) in the <strong>Header</strong>. The first number sets the number of elements involved in the symmetry. Then the indices (i-j) of the <span class="math">A</span> matrix elements involved in the symmetry are listed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">NUMBER</span> <span class="n">of</span> <span class="n">Symmetric</span> <span class="n">elements</span><span class="p">]</span>     <span class="p">[(</span><span class="n">I</span><span class="o">-</span><span class="n">J</span><span class="p">)</span>       <span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="n">K</span><span class="p">)</span>  <span class="p">[</span><span class="o">..</span><span class="p">]</span>        <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">M</span><span class="p">)]</span>
</pre></div>
</div>
<p>In the first line of the following example, there are four symmetric elements indicated (1-5) (1-6) (1-7) (1-8); in the second line, three symmetric elements (2-2) (3-3) (4-4) and in the last line one symmetric element (1-1). This means that <span class="math">A_{15} = A_{16} = A_{17} = A_{18}, A_{22} = A_{33} = A_{44}.</span> If an element is not symmetric to others, the syntax will be as in the last line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#         Grouped par. in the chosen ordered basis</span>
          <span class="mi">4</span>       <span class="mi">1</span>       <span class="mi">5</span>          <span class="mi">1</span>       <span class="mi">6</span>       <span class="mi">1</span>
          <span class="mi">7</span>       <span class="mi">1</span>       <span class="mi">8</span>
          <span class="mi">3</span>       <span class="mi">2</span>       <span class="mi">2</span>          <span class="mi">3</span>       <span class="mi">3</span>       <span class="mi">4</span>
          <span class="mi">4</span>
          <span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">1</span>
</pre></div>
</div>
<p>The symmetries allow to reduce the dimension of the space of parameters and then speed up the optimization. It is also possible to freeze a set of parameters. In this case, these parameters will not be optimized. This can be done using the negative value for the number of the symmetric elements. For example, the matrix elements <span class="math">A_{15} = A_{16} = A_{17} = A_{18}</span> can be kept constant during optimization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#          Grouped par. in the chosen ordered basis</span>
           <span class="o">-</span><span class="mi">4</span>      <span class="mi">1</span>   <span class="mi">5</span>   <span class="mi">1</span>   <span class="mi">6</span>   <span class="mi">1</span>   <span class="mi">7</span>   <span class="mi">1</span>   <span class="mi">8</span>
</pre></div>
</div>
<p>Keep in mind that the elements listed in this part are the ones that are effectively optimized, so you must list all the <span class="math">\lambda</span> s different from zero. Finally, note that at least one element must be kept frozen during the optimization. For convenience, this element is <span class="math">\lambda_{11}</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mi">1</span>       <span class="mi">1</span>      <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="coefficient-of-the-jastrow-different-from-zero">
<h3>Coefficient of the Jastrow different from zero<a class="headerlink" href="#coefficient-of-the-jastrow-different-from-zero" title="Permalink to this heading">¶</a></h3>
<p>The three/four-body Jastrow factor reads:</p>
<div class="math">
<p><span class="math">J_{3/4}\left( {{{\mathbf{r}}_1}{\sigma _1}, \ldots, {{\mathbf{r}}_N}{\sigma _N}} \right) =
\sum_{i &lt; j}
\left(
\sum_{a,l} \sum_{b,m}
M_{a,l,b,m}^{{\sigma _i},{\sigma _j}}
\chi _{a,l}( \mathbf{r}_i )
\chi _{b,m}( \mathbf{r}_j )
\right),</span></p>
</div><p>where the indices <span class="math">l</span> and <span class="math">m</span> again indicate different orbitals centered on
corresponding atoms <span class="math">a</span> and <span class="math">b</span>,
and <span class="math">\{ M_{a,l,b,m}^{\sigma _i,\sigma_j} \}</span> are variational parameters.
If the three/four-body jastrow parts are spin-independent, which depends on <code class="docutils literal notranslate"><span class="pre">JAS_2BODY</span></code>, the matrix elements for <span class="math">\sigma _i \neq \sigma_j</span> are set 0.</p>
<p>Sometimes it is convenient to set to zero part of the coefficients of the four-body Jastrow factor, namely those corresponding to <span class="math">a \ne b</span>, as they increase the overall variational space significantly and make the optimization more challenging, without being much more effective in improving the variational WF.</p>
<p>As the one-body Jastrow factor <span class="math">J_1</span> is the sum of two parts, the homogeneous part (enforcing the electron-ion cusp condition) and inhomogeneous parts. The inhomogeneous part reads:</p>
<div class="math">
<p><span class="math">{J_1^{inh}}\left( {{{\mathbf{r}}_1}{\sigma _1}, \ldots, {{\mathbf{r}}_N}{\sigma _N}} \right) =  \sum_{i=1}^N \sum_{a=1}^{N_\text{at}} \left( {\sum\limits_{l} {M_{a,l}^{{\sigma _i}} \chi_{a,l}\left( {{{\mathbf{r}}_i}} \right)} } \right) ,</span></p>
</div><p>where <span class="math">{{{\mathbf{r}}_i}}:math:</span> are the electron positions, <span class="math">{{{\mathbf{R}}_a}}</span> are the atomic positions with corresponding atomic number <span class="math">Z_a</span>, <span class="math">l</span> runs over atomic orbitals <span class="math">\chi _{a,l}</span> ({it e.g.}, GTO) centered on the atom <span class="math">a</span>, <span class="math">{{\sigma _i}}</span> represents the electron spin (<span class="math">\uparrow</span> or <span class="math">\downarrow</span>), <span class="math">\{ M_{a,l}^{\sigma _i} \}</span> are variational parameters. The matrix elements of the inhomogeneous are also written in this section.</p>
<p>Similar to the section (<strong>Coefficient of the determinant different from zero</strong>), in this section, the elements of the Jastrow <span class="math">M</span> matrix that are different from zero are listed. The number of lines is provided in the <strong>Header</strong>: see <strong>JAS_L</strong> <span class="math">\neq 0</span>.</p>
<p>If the three/four body jastrows are spin-independent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#          Nonzero values of  jasmat</span>
         <span class="mi">1</span>           <span class="mi">1</span>  <span class="mf">9.892797458899720E-003</span>    <span class="o">&lt;-</span> <span class="n">up</span><span class="o">-</span><span class="n">up</span> <span class="p">(</span><span class="n">dn</span><span class="o">-</span><span class="n">dn</span><span class="p">)</span>
         <span class="mi">1</span>           <span class="mi">2</span> <span class="o">-</span><span class="mf">1.895931999217210E-002</span>
         <span class="o">....</span>
         <span class="mi">1</span>          <span class="mi">45</span> <span class="o">-</span><span class="mf">2.042711544366610E-004</span>
         <span class="mi">1</span>          <span class="mi">91</span> <span class="o">-</span><span class="mf">6.994272320227231E-004</span>    <span class="o">&lt;-</span> <span class="n">inhomogeneous</span> <span class="n">onebody</span> <span class="n">M</span><span class="o">.</span>
</pre></div>
</div>
<p>If the three/four body jastrows are spin-dependent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#          Nonzero values of  jasmat</span>
         <span class="mi">1</span>           <span class="mi">1</span>  <span class="mf">1.861662710209880E-003</span>    <span class="o">&lt;-</span> <span class="n">up</span><span class="o">-</span><span class="n">up</span> <span class="p">(</span><span class="n">dn</span><span class="o">-</span><span class="n">dn</span><span class="p">)</span>
         <span class="mi">1</span>           <span class="mi">2</span> <span class="o">-</span><span class="mf">1.200055730317670E-002</span>
         <span class="o">...</span>
         <span class="mi">1</span>          <span class="mi">45</span> <span class="o">-</span><span class="mf">9.409004718340540E-004</span>    <span class="o">&lt;-</span> <span class="n">up</span><span class="o">-</span><span class="n">up</span> <span class="p">(</span><span class="n">dn</span><span class="o">-</span><span class="n">dn</span><span class="p">)</span>
         <span class="mi">1</span>          <span class="mi">92</span>  <span class="mf">6.998162994255180E-003</span>    <span class="o">&lt;-</span> <span class="n">up</span><span class="o">-</span><span class="n">dn</span> <span class="p">(</span><span class="n">dn</span><span class="o">-</span><span class="n">up</span><span class="p">)</span>
         <span class="mi">1</span>          <span class="mi">93</span> <span class="o">-</span><span class="mf">1.494759322340230E-002</span>
         <span class="o">...</span>
         <span class="mi">1</span>         <span class="mi">136</span> <span class="o">-</span><span class="mf">4.067067721217150E-004</span>
         <span class="mi">1</span>         <span class="mi">182</span>  <span class="mf">3.207558596898210E-003</span>    <span class="o">&lt;-</span> <span class="n">inhomogeneous</span> <span class="n">onebody</span> <span class="n">M</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="symmetries-of-the-jastrow-m-matrix">
<h3>Symmetries of the Jastrow <span class="math">M</span> matrix<a class="headerlink" href="#symmetries-of-the-jastrow-m-matrix" title="Permalink to this heading">¶</a></h3>
<p>Here the symmetries involving the elements of the Jastrow <span class="math">M</span> matrix are listed. The syntax is as explained for the determinant. The number of symmetries read is given by <strong>UNCONSTRAINED IESFREE</strong> in the <strong>Header</strong>.</p>
</section>
<section id="symmetries-on-the-z-coefficients-in-the-determinant-basis">
<h3>Symmetries on the Z coefficients in the Determinant Basis<a class="headerlink" href="#symmetries-on-the-z-coefficients-in-the-determinant-basis" title="Permalink to this heading">¶</a></h3>
<p>In this section, the set of symmetries involving the atomic variational parameters of the basis set used for expanding the determinant are listed. The number of these symmetries is provided in the <strong>Header</strong>: see <strong>DET SYMM</strong>. In each line, the first number indicates the elements involved in the symmetry, and then the elements are listed. The numbering depends upon the ordering of the basis set functions (see <strong>The Basis Set for the Determinant</strong>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#        Eq. par. in the atomic Det par. in the chosen basis</span>
             <span class="mi">1</span>       <span class="mi">1</span>
             <span class="mi">1</span>       <span class="mi">2</span>
             <span class="mi">4</span>       <span class="mi">3</span>          <span class="mi">4</span>       <span class="mi">5</span>       <span class="mi">6</span>
</pre></div>
</div>
<p>As described before, the elements that must be optimized must be listed and it is possible to freeze some parameters. In the latter case, the syntax is the same as in the other sections (use ‘-’ sign).</p>
</section>
<section id="symmetries-on-the-z-coefficients-in-the-jastrow-basis">
<h3>Symmetries on the Z coefficients in the Jastrow Basis<a class="headerlink" href="#symmetries-on-the-z-coefficients-in-the-jastrow-basis" title="Permalink to this heading">¶</a></h3>
<p>The number of symmetries is provided in the <strong>Header: 3 BODY ATOMIC PAR SYMM (Eq. 3 body atomic. par.)</strong>. The syntax is as described before.</p>
</section>
</section>
<section id="generate-a-wavefunction-file-makefort10-x">
<h2>Generate a Wavefunction file (makefort10.x)<a class="headerlink" href="#generate-a-wavefunction-file-makefort10-x" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">makefort10.x</span></code> is a tool for generating a template JAGP WF(fort.10) from makefort10.input. Here, we show an example of <code class="docutils literal notranslate"><span class="pre">makefort10.input</span></code></p>
<section id="system-section">
<h3>system section<a class="headerlink" href="#system-section" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Parameter List</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">posunits</span></code></p></td>
<td><p>str</p></td>
<td><p>NA</p></td>
<td><p>units for atomic positions (bohr| angstrom | crystal)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">natoms</span></code></p></td>
<td><p>int</p></td>
<td><p>NA</p></td>
<td><p>Total number of electrons in the system.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ntyp</span></code></p></td>
<td><p>int</p></td>
<td><p>NA</p></td>
<td><p>Total number of element types in the system.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">complexfort10</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>it generates a complex fort.10 if it is .true.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pbcfort10</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>it generates a fort.10 for PBC if it is .true.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yes_pfaff</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>it generates pfaffian WF it it is .true.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">celldm(1-6)</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>they specify lattice vectors following Quantum Espresso’s
convention.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yes_tilted</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>non-orthorombic cell if it is .true. # specify celldm(4-6).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">nxyz(1-3)</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>repetition of the cell in the three direction. Use this option
for exploiting translational symmetries.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">phase(1-3)</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>phase factors for up electrons</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">phasedo(1-3)</span></code></p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>phase factors for down electrons</p></td>
</tr>
</tbody>
</table>
</section>
<section id="electron-section">
<h3>electron section<a class="headerlink" href="#electron-section" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Parameter List</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>filling</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">filling</span> <span class="pre">=</span> <span class="pre">diagonal</span></code>: Fill the initial detmat(:,:)
and jasmat(:,:) with 1.d0 on the diagonal.
<code class="docutils literal notranslate"><span class="pre">filling</span> <span class="pre">=</span> <span class="pre">random</span></code>: Fill with random numbers
between (0,1.d0).
<code class="docutils literal notranslate"><span class="pre">filling</span> <span class="pre">=</span> <span class="pre">semidiagonal</span></code>: Fill off-diagonal
elements with random numbers between (0,0.1d0) and
diagonal elements with 1.d0.</p></td>
</tr>
<tr class="row-odd"><td><p>orbtype</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">orbtype</span> <span class="pre">=</span> <span class="pre">normal</span></code>: Use normal orbitals.
<code class="docutils literal notranslate"><span class="pre">orbtype</span> <span class="pre">=</span> <span class="pre">mixed</span></code>: Use mixed orbitals.
<code class="docutils literal notranslate"><span class="pre">orbtype</span> <span class="pre">=</span> <span class="pre">tempered</span></code>: Use tempered orbitals.
The same applies for Jastrow orbitals with
<code class="docutils literal notranslate"><span class="pre">jorbtype</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>twobody</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Type of the Jastrow 2B/1B term used to satisfy the
electron-electron, electron-ion cusp conditions.</p></td>
</tr>
<tr class="row-odd"><td><p>twobodypar</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Twobody parameter, <span class="math">p</span></p></td>
</tr>
<tr class="row-even"><td><p>onebodypar</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Onebody parameter, <span class="math">b</span></p></td>
</tr>
<tr class="row-odd"><td><p>yes_crystal</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Use the crystal basis for the determinant part.
The default is <code class="docutils literal notranslate"><span class="pre">.true.</span></code> for a PBC case.</p></td>
</tr>
<tr class="row-even"><td><p>yes_crystalj</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Use the crystal basis for the jastrow part.
The default is <code class="docutils literal notranslate"><span class="pre">.true.</span></code> for a PBC case.</p></td>
</tr>
<tr class="row-odd"><td><p>no_4body_jas</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>Does not use the 4-body jastrow factors when it is
true.</p></td>
</tr>
<tr class="row-even"><td><p>neldiff</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>The difference in the number of up and down
electrons.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="symmetry-section">
<h3>symmetry section<a class="headerlink" href="#symmetry-section" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Parameter List</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>nosym</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">nosym</span> <span class="pre">=</span> <span class="pre">.true.</span></code>, do not use symmetry, but only identity
and inversion symmetries. The default is <code class="docutils literal notranslate"><span class="pre">.false.</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>eqatoms</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">eqatoms</span> <span class="pre">=</span> <span class="pre">.true.</span></code>, set the same value for all the
exponents of the atomic basis if acting on the same type of
atom. If <code class="docutils literal notranslate"><span class="pre">eqatoms</span> <span class="pre">=</span> <span class="pre">.false.</span></code>, exponents corresponding to
different atomic positions are equal only if related by
spatial symmetries.</p></td>
</tr>
<tr class="row-even"><td><p>rot_det</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>This flag is used to exclude rotation symmetries from the
lambda matrix of the determinant. If <code class="docutils literal notranslate"><span class="pre">rot_det</span> <span class="pre">=</span> <span class="pre">.false.</span></code>,
makefort10.x uses only translations and inversion symmetry,
if present. Note that the rotation symmetries are still used
to determine the relation between the parameters of the
orbitals, so the result is slightly different from
<code class="docutils literal notranslate"><span class="pre">nosym</span> <span class="pre">=</span> <span class="pre">.true.</span></code> that does not use rotation for everything.</p></td>
</tr>
<tr class="row-odd"><td><p>symmagp</p></td>
<td><p>NA</p></td>
<td><p>NA</p></td>
<td><p>If <code class="docutils literal notranslate"><span class="pre">symmagp</span> <span class="pre">=</span> <span class="pre">.false.</span></code>, create a fort.10 file with a lambda
matrix that is not symmetric (e.g., JAGPu ansatz).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="atomic-positions">
<h3>ATOMIC_POSITIONS<a class="headerlink" href="#atomic-positions" title="Permalink to this heading">¶</a></h3>
<p>The unit is specified with <code class="docutils literal notranslate"><span class="pre">posunits</span></code> in the <code class="docutils literal notranslate"><span class="pre">&amp;system</span></code> section.</p>
<p>ATOMIC_POSITIONS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">4.0</span>  <span class="mf">6.0</span>  <span class="mf">0.31842955585522</span>  <span class="mf">0.63686011171043</span>  <span class="mf">0.00000000000000</span>
<span class="mf">4.0</span>  <span class="mf">6.0</span>  <span class="mf">0.68157044414478</span>  <span class="mf">0.36313988828957</span>  <span class="mf">0.00000000000000</span>

<span class="c1"># Ion coordinates</span>
<span class="n">N1</span>  <span class="n">Z1</span>                <span class="n">x1</span>     <span class="n">y1</span>     <span class="n">z1</span>
<span class="n">N2</span>  <span class="n">Z2</span>                <span class="n">x2</span>     <span class="n">y2</span>     <span class="n">z2</span>
    <span class="o">..</span>                <span class="o">..</span>     <span class="o">..</span>     <span class="o">..</span>
<span class="n">Nn</span>  <span class="n">Zn</span>                <span class="n">xn</span>     <span class="n">yn</span>     <span class="n">zn</span>
</pre></div>
</div>
</section>
<section id="basis-set">
<h3>Basis set<a class="headerlink" href="#basis-set" title="Permalink to this heading">¶</a></h3>
<p>Basis Sets used for expanding the determinant and jastrow are described. Each shell of the determinant is described by two lines. The first one contains the multiplicity, the number of variational parameters of the shell function and the code describing the function. The code numbers and the description of the corresponding shell are described in the file makefun.f90 of the source code. The multiplicity depends on the shell type: Shells S, P and D have the multiplicities of 1, 3 and 5 respectively. In the second line the index of the nucleus on which the shell is centered is first indicated. Then the parameter values are listed. Keep in mind that the number of parameters to be read is given in the first line.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ATOM_6
&amp;shells
nshelldet=18
nshelljas=10
!ndet_hyb=0
/
1   1   16
1   13.073594000000
1   1   16
1   6.541187000000
1   1   16
1   3.272791000000
1   1   16
1   1.637494000000
1   1   16
1   0.819297000000
1   1   16
1   0.409924000000
1   1   16
1   0.205100000000
1   1   16
1   0.127852000000
1   1   16
1   0.102619000000
3   1   36
1   7.480076000000
3   1   36
1   3.741035000000
3   1   36
1   1.871016000000
3   1   36
1   0.935757000000
3   1   36
1   0.468003000000
3   1   36
1   0.234064000000
3   1   36
1   0.149161000000
3   1   36
1   0.117063000000
5   1   68
1   0.561160000000
#  Parameters atomic Jastrow wf
1   1   16
1   1.637494000000
1   1   16
1   0.846879000000
1   1   16
1   0.409924000000
1   1   16
1   0.269659000000
1   1   16
1   0.109576000000
3   1   36
1   1.871016000000
3   1   36
1   0.935757000000
3   1   36
1   0.468003000000
3   1   36
1   0.117063000000
5   1   68
1   2.013760000000
</pre></div>
</div>
<p>All primitive orbitals are written in the source file makefun.f90 (open boundary), makefun_pbc.f90 (pbc) and makefun_bump.f90 (finite range orbitals). TurboRVB also implements standard contracted orbitals written  as a linear combination of <span class="math">p</span> primitive orbitals. The definitions are easily found (and can be easily implemented) in the fortran file: ioptorbcontr.f90. In this case, the number corresponding to “Number of par.” is equal to <span class="math">2p</span>. In the next line, one writes these extra coefficients, <span class="math">C_i, i = 1,...2p:</span> the coefficient <span class="math">C_{i+p}</span> acts on the orbital number defined by the contracted orbital written in “Shell code”, with exponent <span class="math">Z_i = C_i</span> (we omit the normalization, each orbital is assumed to be normalized), for instance a <span class="math">2s</span> contracted orbital:</p>
<div class="math">
<p><span class="math">\phi(r) = 3.231 \exp(-2r^2) + 7.54 \exp(-r^2)</span></p>
</div><p>is written as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#       Parameters atomic wf</span>
        <span class="mi">1</span>          <span class="mi">4</span>         <span class="mi">300</span>
        <span class="mi">1</span>    <span class="mf">2.0</span>   <span class="mf">1.0</span>  <span class="mf">3.231</span>  <span class="mf">7.54</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ndet_hyb</span></code> is the number of hybrid orbitals:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ATOM_6</span>
<span class="o">&amp;</span><span class="n">shells</span>
<span class="n">nshelldet</span><span class="o">=</span><span class="mi">18</span>
<span class="n">nshelljas</span><span class="o">=</span><span class="mi">10</span>
<span class="n">ndet_hyb</span><span class="o">=</span><span class="mi">4</span>
<span class="o">/</span>
<span class="mi">1</span>   <span class="mi">1</span>   <span class="mi">16</span>
<span class="mi">1</span>   <span class="mf">13.073594000000</span>
<span class="mi">1</span>   <span class="mi">1</span>   <span class="mi">16</span>
<span class="mi">1</span>   <span class="mf">6.541187000000</span>
<span class="mi">1</span>   <span class="mi">1</span>   <span class="mi">16</span>
<span class="mi">1</span>   <span class="mf">3.272791000000</span>
<span class="o">....</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="01nutshell.html" class="btn btn-neutral float-left" title="TurboRVB in a nutshell" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="04DFT_driver.html" class="btn btn-neutral float-right" title="Initializations of Wavefunctions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Kosuke Nakano (NIMS) and collaborators..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>